(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{"+K+b":function(Ue,g,o){var E=o("JHRd");function p(X){var F=new X.constructor(X.byteLength);return new E(F).set(new E(X)),F}Ue.exports=p},"+Qka":function(Ue,g,o){var E=o("fmRc"),p=o("t2Dn"),X=o("cq/+"),F=o("T1AV"),i=o("GoyQ"),Z=o("mTTR"),D=o("itsj");function J(ee,ce,Y,ze,Xe){if(ee===ce)return;X(ce,function(be,Se){if(Xe||(Xe=new E),i(be))F(ee,ce,Se,Y,J,ze,Xe);else{var mt=ze?ze(D(ee,Se),be,Se+"",ee,ce,Xe):void 0;mt===void 0&&(mt=be),p(ee,Se,mt)}},Z)}Ue.exports=J},"+VLl":function(Ue,g,o){"use strict";o.d(g,"a",function(){return be});var E=o("lSNA"),p=o.n(E),X=o("J4zp"),F=o.n(X),i=o("Hel2"),Z=Math.PI/3,D=[0,Z,2*Z,3*Z,4*Z,5*Z];function J(Se){return Se[0]}function ee(Se){return Se[1]}var ce=function(){var Se=0,mt=0,Le=1,St=1,Ye=J,dt=ee,Je,wt,At;function Ie(Ve){var ct={},Me=[],ht,Wt=Ve.length;for(ht=0;ht<Wt;++ht){if(isNaN(ur=+Ye.call(null,Qt=Ve[ht],ht,Ve))||isNaN(oe=+dt.call(null,Qt,ht,Ve)))continue;var Qt,ur,oe,$=Math.round(oe=oe/At),H=Math.round(ur=ur/wt-($&1)/2),Ae=oe-$;if(Math.abs(Ae)*3>1){var ye=ur-H,Te=H+(ur<H?-1:1)/2,pe=$+(oe<$?-1:1),it=ur-Te,qt=oe-pe;ye*ye+Ae*Ae>it*it+qt*qt&&(H=Te+($&1?1:-1)/2,$=pe)}var Pt=H+"-"+$,me=ct[Pt];me?me.push(Qt):(Me.push(me=ct[Pt]=[Qt]),me.x=(H+($&1)/2)*wt,me.y=$*At)}return Me}function Ne(Ve){var ct=0,Me=0;return D.map(function(ht){var Wt=Math.sin(ht)*Ve,Qt=-Math.cos(ht)*Ve,ur=Wt-ct,oe=Qt-Me;return ct=Wt,Me=Qt,[ur,oe]})}return Ie.hexagon=function(Ve){return"m"+Ne(Ve==null?Je:+Ve).join("l")+"z"},Ie.centers=function(){for(var Ve=[],ct=Math.round(mt/At),Me=Math.round(Se/wt),ht=ct*At;ht<St+Je;ht+=At,++ct)for(var Wt=Me*wt+(ct&1)*wt/2;Wt<Le+wt/2;Wt+=wt)Ve.push([Wt,ht]);return Ve},Ie.mesh=function(){var Ve=Ne(Je).slice(0,4).join("l");return Ie.centers().map(function(ct){return"M"+ct+"m"+Ve}).join("")},Ie.x=function(Ve){return arguments.length?(Ye=Ve,Ie):Ye},Ie.y=function(Ve){return arguments.length?(dt=Ve,Ie):dt},Ie.radius=function(Ve){return arguments.length?(Je=+Ve,wt=Je*2*Math.sin(Z),At=Je*1.5,Ie):Je},Ie.size=function(Ve){return arguments.length?(Se=mt=0,Le=+Ve[0],St=+Ve[1],Ie):[Le-Se,St-mt]},Ie.extent=function(Ve){return arguments.length?(Se=+Ve[0][0],mt=+Ve[0][1],Le=+Ve[1][0],St=+Ve[1][1],Ie):[[Se,mt],[Le,St]]},Ie.radius(1)};function Y(Se,mt){var Le=Object.keys(Se);if(Object.getOwnPropertySymbols){var St=Object.getOwnPropertySymbols(Se);mt&&(St=St.filter(function(Ye){return Object.getOwnPropertyDescriptor(Se,Ye).enumerable})),Le.push.apply(Le,St)}return Le}function ze(Se){for(var mt=1;mt<arguments.length;mt++){var Le=arguments[mt]!=null?arguments[mt]:{};mt%2?Y(Object(Le),!0).forEach(function(St){p()(Se,St,Le[St])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Se,Object.getOwnPropertyDescriptors(Le)):Y(Object(Le)).forEach(function(St){Object.defineProperty(Se,St,Object.getOwnPropertyDescriptor(Le,St))})}return Se}var Xe=6378e3;function be(Se,mt){var Le=Se.dataArray,St=mt.size,Ye=St===void 0?10:St,dt=mt.method,Je=dt===void 0?"sum":dt,wt=Ye/(2*Math.PI*Xe)*(256<<20)/2,At=Le.map(function(ct){var Me=Object(i.d)(ct.coordinates),ht=F()(Me,2),Wt=ht[0],Qt=ht[1];return ze(ze({},ct),{},{coordinates:[Wt,Qt]})}),Ie=ce().radius(wt).x(function(ct){return ct.coordinates[0]}).y(function(ct){return ct.coordinates[1]}),Ne=Ie(At),Ve={dataArray:Ne.map(function(ct,Me){var ht;if(mt.field&&Je){var Wt=i.c.getColumn(ct,mt.field);ct[Je]=i.c.statMap[Je](Wt)}return ht={},p()(ht,mt.method,ct[Je]),p()(ht,"count",ct.length),p()(ht,"rawData",ct),p()(ht,"coordinates",[ct.x,ct.y]),p()(ht,"_id",Me),ht}),radius:wt,xOffset:wt,yOffset:wt,type:"hexagon"};return Ve}},"+em5":function(Ue,g,o){"use strict";o.d(g,"a",function(){return oe});var E=o("lSNA"),p=o.n(E),X=o("yG8O"),F=o.n(X),i=o("lwsE"),Z=o.n(i),D=o("W8MJ"),J=o.n(D),ee=o("U+yc"),ce=o.n(ee),Y=o("1ABj"),ze=o.n(Y),Xe=o("gQMU"),be=o.n(Xe),Se=o("J2iB"),mt=o.n(Se),Le=o("u6S6"),St=o.n(Le),Ye=o("4cb6"),dt=o.n(Ye),Je=o("h1nZ"),wt=o("bB6j"),At=o("bPkA"),Ie,Ne,Ve,ct,Me,ht;function Wt($,H){var Ae=Object.keys($);if(Object.getOwnPropertySymbols){var ye=Object.getOwnPropertySymbols($);H&&(ye=ye.filter(function(Te){return Object.getOwnPropertyDescriptor($,Te).enumerable})),Ae.push.apply(Ae,ye)}return Ae}function Qt($){for(var H=1;H<arguments.length;H++){var Ae=arguments[H]!=null?arguments[H]:{};H%2?Wt(Object(Ae),!0).forEach(function(ye){p()($,ye,Ae[ye])}):Object.getOwnPropertyDescriptors?Object.defineProperties($,Object.getOwnPropertyDescriptors(Ae)):Wt(Object(Ae)).forEach(function(ye){Object.defineProperty($,ye,Object.getOwnPropertyDescriptor(Ae,ye))})}return $}var ur=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,oe=(Ie=Object(Ye.injectable)(),Ne=Object(Ye.inject)(wt.a.IShaderModuleService),Ie(Ve=(ct=(ht=function(){function $(){Z()(this,$),F()(this,"shaderModuleService",Me,this),this.rendererService=void 0,this.config=void 0,this.quad=ur,this.enabled=!0,this.renderToScreen=!1,this.model=void 0,this.name=void 0,this.optionsToUpdate={}}return J()($,[{key:"getName",value:function(){return this.name}},{key:"setName",value:function(Ae){this.name=Ae}},{key:"getType",value:function(){return At.a.PostProcessing}},{key:"init",value:function(Ae,ye){this.config=ye,this.rendererService=Ae.getContainer().get(wt.a.IRendererService);var Te=this.rendererService,pe=Te.createAttribute,it=Te.createBuffer,qt=Te.createModel,Pt=this.setupShaders(),me=Pt.vs,ve=Pt.fs,Ge=Pt.uniforms;this.model=qt({vs:me,fs:ve,attributes:{a_Position:pe({buffer:it({data:[-4,-4,4,-4,0,4],type:Je.gl.FLOAT}),size:2})},uniforms:Qt(Qt({u_Texture:null},Ge),this.config&&this.convertOptionsToUniforms(this.config)),depth:{enable:!1},count:3,blend:{enable:this.getName()==="copy"}})}},{key:"render",value:function(Ae){var ye=this,Te=Ae.multiPassRenderer.getPostProcessor(),pe=this.rendererService,it=pe.useFramebuffer,qt=pe.getViewportSize,Pt=pe.clear,me=qt(),ve=me.width,Ge=me.height;it(this.renderToScreen?null:Te.getWriteFBO(),function(){Pt({framebuffer:Te.getWriteFBO(),color:[0,0,0,0],depth:1,stencil:0}),ye.model.draw({uniforms:Qt({u_Texture:Te.getReadFBO(),u_ViewportSize:[ve,Ge]},ye.convertOptionsToUniforms(ye.optionsToUpdate))})})}},{key:"isEnabled",value:function(){return this.enabled}},{key:"setEnabled",value:function(Ae){this.enabled=Ae}},{key:"setRenderToScreen",value:function(Ae){this.renderToScreen=Ae}},{key:"updateOptions",value:function(Ae){this.optionsToUpdate=Qt(Qt({},this.optionsToUpdate),Ae)}},{key:"setupShaders",value:function(){throw new Error("Method not implemented.")}},{key:"convertOptionsToUniforms",value:function(Ae){var ye={};return Object.keys(Ae).forEach(function(Te){mt()(Ae[Te])||(ye["u_".concat(be()(St()(Te)))]=Ae[Te])}),ye}}]),$}(),ht),Me=ce()(ct.prototype,"shaderModuleService",[Ne],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ct))||Ve)},"+iFO":function(Ue,g,o){var E=o("dTAl"),p=o("LcsW"),X=o("6sVZ");function F(i){return typeof i.constructor=="function"&&!X(i)?E(p(i)):{}}Ue.exports=F},"/33/":function(Ue,g){},"/Uc5":function(Ue,g){},"/ezw":function(Ue,g,o){"use strict";var E=o("lSNA"),p=o.n(E),X=o("pVnL"),F=o.n(X),i=o("cDf5"),Z=o.n(i),D=o("q1tI"),J=o("TSYQ"),ee=o.n(J),ce=function(ye){var Te=ye.prefixCls,pe=ye.className,it=ye.width,qt=ye.style;return D.createElement("h3",{className:ee()(Te,pe),style:F()({width:it},qt)})},Y=ce,ze=o("RIqP"),Xe=o.n(ze),be=function(ye){var Te=function(Ge){var st=ye.width,Oe=ye.rows,gt=Oe===void 0?2:Oe;return Array.isArray(st)?st[Ge]:gt-1===Ge?st:void 0},pe=ye.prefixCls,it=ye.className,qt=ye.style,Pt=ye.rows,me=Xe()(Array(Pt)).map(function(ve,Ge){return D.createElement("li",{key:Ge,style:{width:Te(Ge)}})});return D.createElement("ul",{className:ee()(pe,it),style:qt},me)},Se=be,mt=o("H84U"),Le=function(ye){var Te,pe,it=ye.prefixCls,qt=ye.className,Pt=ye.style,me=ye.size,ve=ye.shape,Ge=ee()((Te={},p()(Te,"".concat(it,"-lg"),me==="large"),p()(Te,"".concat(it,"-sm"),me==="small"),Te)),st=ee()((pe={},p()(pe,"".concat(it,"-circle"),ve==="circle"),p()(pe,"".concat(it,"-square"),ve==="square"),p()(pe,"".concat(it,"-round"),ve==="round"),pe)),Oe=typeof me=="number"?{width:me,height:me,lineHeight:"".concat(me,"px")}:{};return D.createElement("span",{className:ee()(it,Ge,st,qt),style:F()(F()({},Oe),Pt)})},St=Le,Ye=o("BGR+"),dt=function(ye){var Te=function(it){var qt=it.getPrefixCls,Pt=ye.prefixCls,me=ye.className,ve=ye.active,Ge=qt("skeleton",Pt),st=Object(Ye.a)(ye,["prefixCls"]),Oe=ee()(Ge,"".concat(Ge,"-element"),p()({},"".concat(Ge,"-active"),ve),me);return D.createElement("div",{className:Oe},D.createElement(St,F()({prefixCls:"".concat(Ge,"-avatar")},st)))};return D.createElement(mt.a,null,Te)};dt.defaultProps={size:"default",shape:"circle"};var Je=dt,wt=function(ye){var Te=function(it){var qt=it.getPrefixCls,Pt=ye.prefixCls,me=ye.className,ve=ye.active,Ge=qt("skeleton",Pt),st=Object(Ye.a)(ye,["prefixCls"]),Oe=ee()(Ge,"".concat(Ge,"-element"),p()({},"".concat(Ge,"-active"),ve),me);return D.createElement("div",{className:Oe},D.createElement(St,F()({prefixCls:"".concat(Ge,"-button")},st)))};return D.createElement(mt.a,null,Te)};wt.defaultProps={size:"default"};var At=wt,Ie=function(ye){var Te=function(it){var qt=it.getPrefixCls,Pt=ye.prefixCls,me=ye.className,ve=ye.active,Ge=qt("skeleton",Pt),st=Object(Ye.a)(ye,["prefixCls"]),Oe=ee()(Ge,"".concat(Ge,"-element"),p()({},"".concat(Ge,"-active"),ve),me);return D.createElement("div",{className:Oe},D.createElement(St,F()({prefixCls:"".concat(Ge,"-input")},st)))};return D.createElement(mt.a,null,Te)};Ie.defaultProps={size:"default"};var Ne=Ie,Ve="M365.714286 329.142857q0 45.714286-32.036571 77.677714t-77.677714 32.036571-77.677714-32.036571-32.036571-77.677714 32.036571-77.677714 77.677714-32.036571 77.677714 32.036571 32.036571 77.677714zM950.857143 548.571429l0 256-804.571429 0 0-109.714286 182.857143-182.857143 91.428571 91.428571 292.571429-292.571429zM1005.714286 146.285714l-914.285714 0q-7.460571 0-12.873143 5.412571t-5.412571 12.873143l0 694.857143q0 7.460571 5.412571 12.873143t12.873143 5.412571l914.285714 0q7.460571 0 12.873143-5.412571t5.412571-12.873143l0-694.857143q0-7.460571-5.412571-12.873143t-12.873143-5.412571zM1097.142857 164.571429l0 694.857143q0 37.741714-26.843429 64.585143t-64.585143 26.843429l-914.285714 0q-37.741714 0-64.585143-26.843429t-26.843429-64.585143l0-694.857143q0-37.741714 26.843429-64.585143t64.585143-26.843429l914.285714 0q37.741714 0 64.585143 26.843429t26.843429 64.585143z",ct=function(ye){var Te=function(it){var qt=it.getPrefixCls,Pt=ye.prefixCls,me=ye.className,ve=ye.style,Ge=qt("skeleton",Pt),st=ee()(Ge,"".concat(Ge,"-element"),me);return D.createElement("div",{className:st},D.createElement("div",{className:ee()("".concat(Ge,"-image"),me),style:ve},D.createElement("svg",{viewBox:"0 0 1098 1024",xmlns:"http://www.w3.org/2000/svg",className:"".concat(Ge,"-image-svg")},D.createElement("path",{d:Ve,className:"".concat(Ge,"-image-path")}))))};return D.createElement(mt.a,null,Te)},Me=ct;function ht(Ae){return Ae&&Z()(Ae)==="object"?Ae:{}}function Wt(Ae,ye){return Ae&&!ye?{size:"large",shape:"square"}:{size:"large",shape:"circle"}}function Qt(Ae,ye){return!Ae&&ye?{width:"38%"}:Ae&&ye?{width:"50%"}:{}}function ur(Ae,ye){var Te={};return(!Ae||!ye)&&(Te.width="61%"),!Ae&&ye?Te.rows=3:Te.rows=2,Te}var oe=function(ye){var Te=function(it){var qt=it.getPrefixCls,Pt=it.direction,me=ye.prefixCls,ve=ye.loading,Ge=ye.className,st=ye.children,Oe=ye.avatar,gt=ye.title,C=ye.paragraph,R=ye.active,q=ye.round,fe=qt("skeleton",me);if(ve||!("loading"in ye)){var He,et=!!Oe,_t=!!gt,ot=!!C,Ut;if(et){var K=F()(F()({prefixCls:"".concat(fe,"-avatar")},Wt(_t,ot)),ht(Oe));Ut=D.createElement("div",{className:"".concat(fe,"-header")},D.createElement(St,K))}var qe;if(_t||ot){var ae;if(_t){var tt=F()(F()({prefixCls:"".concat(fe,"-title")},Qt(et,ot)),ht(gt));ae=D.createElement(Y,tt)}var kt;if(ot){var pr=F()(F()({prefixCls:"".concat(fe,"-paragraph")},ur(et,_t)),ht(C));kt=D.createElement(Se,pr)}qe=D.createElement("div",{className:"".concat(fe,"-content")},ae,kt)}var Ke=ee()(fe,(He={},p()(He,"".concat(fe,"-with-avatar"),et),p()(He,"".concat(fe,"-active"),R),p()(He,"".concat(fe,"-rtl"),Pt==="rtl"),p()(He,"".concat(fe,"-round"),q),He),Ge);return D.createElement("div",{className:Ke},Ut,qe)}return st};return D.createElement(mt.a,null,Te)};oe.defaultProps={avatar:!1,title:!0,paragraph:!0},oe.Button=At,oe.Avatar=Je,oe.Input=Ne,oe.Image=Me;var $=oe,H=g.a=$},"/rf6":function(Ue,g,o){"use strict";Object.defineProperty(g,"__esModule",{value:!0}),g.earthRadius=63710088e-1,g.factors={centimeters:g.earthRadius*100,centimetres:g.earthRadius*100,degrees:g.earthRadius/111325,feet:g.earthRadius*3.28084,inches:g.earthRadius*39.37,kilometers:g.earthRadius/1e3,kilometres:g.earthRadius/1e3,meters:g.earthRadius,metres:g.earthRadius,miles:g.earthRadius/1609.344,millimeters:g.earthRadius*1e3,millimetres:g.earthRadius*1e3,nauticalmiles:g.earthRadius/1852,radians:1,yards:g.earthRadius/1.0936},g.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/g.earthRadius,yards:1/1.0936},g.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function E($,H,Ae){Ae===void 0&&(Ae={});var ye={type:"Feature"};return(Ae.id===0||Ae.id)&&(ye.id=Ae.id),Ae.bbox&&(ye.bbox=Ae.bbox),ye.properties=H||{},ye.geometry=$,ye}g.feature=E;function p($,H,Ae){Ae===void 0&&(Ae={});switch($){case"Point":return X(H).geometry;case"LineString":return D(H).geometry;case"Polygon":return i(H).geometry;case"MultiPoint":return Y(H).geometry;case"MultiLineString":return ce(H).geometry;case"MultiPolygon":return ze(H).geometry;default:throw new Error($+" is invalid")}}g.geometry=p;function X($,H,Ae){Ae===void 0&&(Ae={});var ye={type:"Point",coordinates:$};return E(ye,H,Ae)}g.point=X;function F($,H,Ae){return Ae===void 0&&(Ae={}),ee($.map(function(ye){return X(ye,H)}),Ae)}g.points=F;function i($,H,Ae){Ae===void 0&&(Ae={});for(var ye=0,Te=$;ye<Te.length;ye++){var pe=Te[ye];if(pe.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var it=0;it<pe[pe.length-1].length;it++)if(pe[pe.length-1][it]!==pe[0][it])throw new Error("First and last Position are not equivalent.")}var qt={type:"Polygon",coordinates:$};return E(qt,H,Ae)}g.polygon=i;function Z($,H,Ae){return Ae===void 0&&(Ae={}),ee($.map(function(ye){return i(ye,H)}),Ae)}g.polygons=Z;function D($,H,Ae){if(Ae===void 0&&(Ae={}),$.length<2)throw new Error("coordinates must be an array of two or more positions");var ye={type:"LineString",coordinates:$};return E(ye,H,Ae)}g.lineString=D;function J($,H,Ae){return Ae===void 0&&(Ae={}),ee($.map(function(ye){return D(ye,H)}),Ae)}g.lineStrings=J;function ee($,H){H===void 0&&(H={});var Ae={type:"FeatureCollection"};return H.id&&(Ae.id=H.id),H.bbox&&(Ae.bbox=H.bbox),Ae.features=$,Ae}g.featureCollection=ee;function ce($,H,Ae){Ae===void 0&&(Ae={});var ye={type:"MultiLineString",coordinates:$};return E(ye,H,Ae)}g.multiLineString=ce;function Y($,H,Ae){Ae===void 0&&(Ae={});var ye={type:"MultiPoint",coordinates:$};return E(ye,H,Ae)}g.multiPoint=Y;function ze($,H,Ae){Ae===void 0&&(Ae={});var ye={type:"MultiPolygon",coordinates:$};return E(ye,H,Ae)}g.multiPolygon=ze;function Xe($,H,Ae){Ae===void 0&&(Ae={});var ye={type:"GeometryCollection",geometries:$};return E(ye,H,Ae)}g.geometryCollection=Xe;function be($,H){if(H===void 0&&(H=0),H&&!(H>=0))throw new Error("precision must be a positive number");var Ae=Math.pow(10,H||0);return Math.round($*Ae)/Ae}g.round=be;function Se($,H){H===void 0&&(H="kilometers");var Ae=g.factors[H];if(!Ae)throw new Error(H+" units is invalid");return $*Ae}g.radiansToLength=Se;function mt($,H){H===void 0&&(H="kilometers");var Ae=g.factors[H];if(!Ae)throw new Error(H+" units is invalid");return $/Ae}g.lengthToRadians=mt;function Le($,H){return Ye(mt($,H))}g.lengthToDegrees=Le;function St($){var H=$%360;return H<0&&(H+=360),H}g.bearingToAzimuth=St;function Ye($){var H=$%(2*Math.PI);return H*180/Math.PI}g.radiansToDegrees=Ye;function dt($){var H=$%360;return H*Math.PI/180}g.degreesToRadians=dt;function Je($,H,Ae){if(H===void 0&&(H="kilometers"),Ae===void 0&&(Ae="kilometers"),!($>=0))throw new Error("length must be a positive number");return Se(mt($,H),Ae)}g.convertLength=Je;function wt($,H,Ae){if(H===void 0&&(H="meters"),Ae===void 0&&(Ae="kilometers"),!($>=0))throw new Error("area must be a positive number");var ye=g.areaFactors[H];if(!ye)throw new Error("invalid original units");var Te=g.areaFactors[Ae];if(!Te)throw new Error("invalid final units");return $/ye*Te}g.convertArea=wt;function At($){return!isNaN($)&&$!==null&&!Array.isArray($)&&!/^\s*$/.test($)}g.isNumber=At;function Ie($){return!!$&&$.constructor===Object}g.isObject=Ie;function Ne($){if(!$)throw new Error("bbox is required");if(!Array.isArray($))throw new Error("bbox must be an Array");if($.length!==4&&$.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");$.forEach(function(H){if(!At(H))throw new Error("bbox must only contain numbers")})}g.validateBBox=Ne;function Ve($){if(!$)throw new Error("id is required");if(["string","number"].indexOf(typeof $)===-1)throw new Error("id must be a number or a string")}g.validateId=Ve;function ct(){throw new Error("method has been renamed to `radiansToDegrees`")}g.radians2degrees=ct;function Me(){throw new Error("method has been renamed to `degreesToRadians`")}g.degrees2radians=Me;function ht(){throw new Error("method has been renamed to `lengthToDegrees`")}g.distanceToDegrees=ht;function Wt(){throw new Error("method has been renamed to `lengthToRadians`")}g.distanceToRadians=Wt;function Qt(){throw new Error("method has been renamed to `radiansToLength`")}g.radiansToDistance=Qt;function ur(){throw new Error("method has been renamed to `bearingToAzimuth`")}g.bearingToAngle=ur;function oe(){throw new Error("method has been renamed to `convertLength`")}g.convertDistance=oe},"0JQy":function(Ue,g){var o="\\ud800-\\udfff",E="\\u0300-\\u036f",p="\\ufe20-\\ufe2f",X="\\u20d0-\\u20ff",F=E+p+X,i="\\ufe0e\\ufe0f",Z="["+o+"]",D="["+F+"]",J="\\ud83c[\\udffb-\\udfff]",ee="(?:"+D+"|"+J+")",ce="[^"+o+"]",Y="(?:\\ud83c[\\udde6-\\uddff]){2}",ze="[\\ud800-\\udbff][\\udc00-\\udfff]",Xe="\\u200d",be=ee+"?",Se="["+i+"]?",mt="(?:"+Xe+"(?:"+[ce,Y,ze].join("|")+")"+Se+be+")*",Le=Se+be+mt,St="(?:"+[ce+D+"?",D,Y,ze,Z].join("|")+")",Ye=RegExp(J+"(?="+J+")|"+St+Le,"g");function dt(Je){return Je.match(Ye)||[]}Ue.exports=dt},"0ZTe":function(Ue,g,o){var E=o("wy8a"),p=o("quyA"),X=o("Em2t"),F=o("dt0z");function i(Z){return function(D){D=F(D);var J=p(D)?X(D):void 0,ee=J?J[0]:D.charAt(0),ce=J?E(J,1).join(""):D.slice(1);return ee[Z]()+ce}}Ue.exports=i},"0eqD":function(Ue,g){},"0gSV":function(Ue,g,o){"use strict";Object.defineProperty(g,"__esModule",{value:!0}),g.tagged=void 0;var E=o("GXnB"),p=o("Ztfv");function X(F,i){return function(Z,D,J){var ee=new E.Metadata(F,i);typeof J=="number"?p.tagParameter(Z,D,J,ee):p.tagProperty(Z,D,ee)}}g.tagged=X},"1+5i":function(Ue,g,o){var E=o("w/wX"),p=o("sEf8"),X=o("mdPL"),F=X&&X.isSet,i=F?p(F):E;Ue.exports=i},"14J3":function(Ue,g,o){"use strict";var E=o("cIOH"),p=o("1GLa")},"1ABj":function(Ue,g){function o(E,p){throw new Error("Decorating class property failed. Please ensure that proposal-class-properties is enabled and runs after the decorators transform.")}Ue.exports=o},"1gqn":function(Ue,g){Ue.exports=function(E){return E&&typeof E=="object"&&typeof E.copy=="function"&&typeof E.fill=="function"&&typeof E.readUInt8=="function"}},"1jvM":function(Ue,g){},2:function(Ue,g){},"2ajD":function(Ue,g){function o(E){return E!==E}Ue.exports=o},"3DfO":function(Ue,g){function o(E){return E==null}Ue.exports=o},"3L66":function(Ue,g,o){var E=o("MMmD"),p=o("ExA7");function X(F){return p(F)&&E(F)}Ue.exports=X},"3cYt":function(Ue,g){function o(E){return function(p){return E==null?void 0:E[p]}}Ue.exports=o},"406g":function(Ue,g,o){"use strict";Object.defineProperty(g,"__esModule",{value:!0}),g.BindingOnSyntax=void 0;var E=o("z4Hk"),p=function(){function X(F){this._binding=F}return X.prototype.onActivation=function(F){return this._binding.onActivation=F,new E.BindingWhenSyntax(this._binding)},X}();g.BindingOnSyntax=p},"4U9+":function(Ue,g,o){"use strict";Object.defineProperty(g,"__esModule",{value:!0}),g.default=function(Se){return(0,p.default)((0,J.default)(Se)&&Se.length>=1,"Must merge at least 1 JSON schema."),F.default.apply(void 0,[{}].concat(be(Se),[function(mt,Le,St){if((0,Z.default)(mt))return;if(St==="required")return(0,ce.default)(mt.concat(Le));if((0,ze.default)(mt)){if(!(0,ze.default)(Le))throw new Error('Failed to merge schemas because "'+St+'" has different values.');return}p.default.deepEqual(mt,Le,'Failed to merge schemas because "'+St+'" has different values: '+JSON.stringify(mt)+" and "+JSON.stringify(Le)+".")}]))};var E=o("9lTW"),p=Xe(E),X=o("qd8s"),F=Xe(X),i=o("3DfO"),Z=Xe(i),D=o("WFAs"),J=Xe(D),ee=o("w26f"),ce=Xe(ee),Y=o("zZPE"),ze=Xe(Y);function Xe(Se){return Se&&Se.__esModule?Se:{default:Se}}function be(Se){if(Array.isArray(Se)){for(var mt=0,Le=Array(Se.length);mt<Se.length;mt++)Le[mt]=Se[mt];return Le}else return Array.from(Se)}Ue.exports=g.default},"4ZJM":function(Ue,g,o){(function(E,p){Ue.exports=p()})(this,function(){"use strict";var E,p,X;function F(i,Z){if(!E)E=Z;else if(!p)p=Z;else{var D="var sharedChunk = {}; ("+E+")(sharedChunk); ("+p+")(sharedChunk);",J={};E(J),X=Z(J),typeof window!="undefined"&&(X.workerUrl=window.URL.createObjectURL(new Blob([D],{type:"text/javascript"})))}}return F(["exports"],function(i){"use strict";function Z(e,t){return e(t={exports:{}},t.exports),t.exports}var D=J;function J(e,t,r,u){this.cx=3*e,this.bx=3*(r-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(u-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=u,this.p2x=r,this.p2y=u}J.prototype.sampleCurveX=function(e){return((this.ax*e+this.bx)*e+this.cx)*e},J.prototype.sampleCurveY=function(e){return((this.ay*e+this.by)*e+this.cy)*e},J.prototype.sampleCurveDerivativeX=function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},J.prototype.solveCurveX=function(e,t){var r,u,f,m,S;for(t===void 0&&(t=1e-6),f=e,S=0;S<8;S++){if(m=this.sampleCurveX(f)-e,Math.abs(m)<t)return f;var P=this.sampleCurveDerivativeX(f);if(Math.abs(P)<1e-6)break;f-=m/P}if((f=e)<(r=0))return r;if(f>(u=1))return u;for(;r<u;){if(m=this.sampleCurveX(f),Math.abs(m-e)<t)return f;e>m?r=f:u=f,f=.5*(u-r)+r}return f},J.prototype.solve=function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))};var ee=ce;function ce(e,t){this.x=e,this.y=t}ce.prototype={clone:function(){return new ce(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,r){return this.clone()._rotateAround(t,r)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var r=t.x-this.x,u=t.y-this.y;return r*r+u*u},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,r){return Math.atan2(this.x*r-this.y*t,this.x*t+this.y*r)},_matMult:function(t){var r=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=r,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var r=Math.cos(t),u=Math.sin(t),f=u*this.x+r*this.y;return this.x=r*this.x-u*this.y,this.y=f,this},_rotateAround:function(t,r){var u=Math.cos(t),f=Math.sin(t),m=r.y+f*(this.x-r.x)+u*(this.y-r.y);return this.x=r.x+u*(this.x-r.x)-f*(this.y-r.y),this.y=m,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},ce.convert=function(e){return e instanceof ce?e:Array.isArray(e)?new ce(e[0],e[1]):e};var Y=typeof self!="undefined"?self:{},ze=Math.pow(2,53)-1;function Xe(e,t,r,u){var f=new D(e,t,r,u);return function(m){return f.solve(m)}}var be=Xe(.25,.1,.25,1);function Se(e,t,r){return Math.min(r,Math.max(t,e))}function mt(e,t,r){var u=r-t,f=((e-t)%u+u)%u+t;return f===t?r:f}function Le(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];for(var u=0,f=t;u<f.length;u+=1){var m=f[u];for(var S in m)e[S]=m[S]}return e}var St=1;function Ye(){return St++}function dt(){return function e(t){return t?(t^16*Math.random()>>t/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,e)}()}function Je(e){return!!e&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)}function wt(e,t){e.forEach(function(r){t[r]&&(t[r]=t[r].bind(t))})}function At(e,t){return e.indexOf(t,e.length-t.length)!==-1}function Ie(e,t,r){var u={};for(var f in e)u[f]=t.call(r||this,e[f],f,e);return u}function Ne(e,t,r){var u={};for(var f in e)t.call(r||this,e[f],f,e)&&(u[f]=e[f]);return u}function Ve(e){return Array.isArray(e)?e.map(Ve):typeof e=="object"&&e?Ie(e,Ve):e}var ct={};function Me(e){ct[e]||(typeof console!="undefined"&&console.warn(e),ct[e]=!0)}function ht(e,t,r){return(r.y-e.y)*(t.x-e.x)>(t.y-e.y)*(r.x-e.x)}function Wt(e){for(var t=0,r=0,u=e.length,f=u-1,m=void 0,S=void 0;r<u;f=r++)t+=((S=e[f]).x-(m=e[r]).x)*(m.y+S.y);return t}function Qt(){return typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope}function ur(e){var t={};if(e.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(u,f,m,S){var P=m||S;return t[f]=!P||P.toLowerCase(),""}),t["max-age"]){var r=parseInt(t["max-age"],10);isNaN(r)?delete t["max-age"]:t["max-age"]=r}return t}var oe=null;function $(e){if(oe==null){var t=e.navigator?e.navigator.userAgent:null;oe=!!e.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return oe}function H(e){try{var t=Y[e];return t.setItem("_mapbox_test_",1),t.removeItem("_mapbox_test_"),!0}catch(r){return!1}}var Ae,ye,Te,pe,it=Y.performance&&Y.performance.now?Y.performance.now.bind(Y.performance):Date.now.bind(Date),qt=Y.requestAnimationFrame||Y.mozRequestAnimationFrame||Y.webkitRequestAnimationFrame||Y.msRequestAnimationFrame,Pt=Y.cancelAnimationFrame||Y.mozCancelAnimationFrame||Y.webkitCancelAnimationFrame||Y.msCancelAnimationFrame,me={now:it,frame:function(t){var r=qt(t);return{cancel:function(){return Pt(r)}}},getImageData:function(t,r){r===void 0&&(r=0);var u=Y.document.createElement("canvas"),f=u.getContext("2d");if(!f)throw new Error("failed to create canvas 2d context");return u.width=t.width,u.height=t.height,f.drawImage(t,0,0,t.width,t.height),f.getImageData(-r,-r,t.width+2*r,t.height+2*r)},resolveURL:function(t){return Ae||(Ae=Y.document.createElement("a")),Ae.href=t,Ae.href},hardwareConcurrency:Y.navigator&&Y.navigator.hardwareConcurrency||4,get devicePixelRatio(){return Y.devicePixelRatio},get prefersReducedMotion(){return!!Y.matchMedia&&(ye==null&&(ye=Y.matchMedia("(prefers-reduced-motion: reduce)")),ye.matches)}},ve={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},Ge={supported:!1,testSupport:function(t){!st&&pe&&(Oe?gt(t):Te=t)}},st=!1,Oe=!1;function gt(e){var t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t);try{if(e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,pe),e.isContextLost())return;Ge.supported=!0}catch(r){}e.deleteTexture(t),st=!0}Y.document&&((pe=Y.document.createElement("img")).onload=function(){Te&&gt(Te),Te=null,Oe=!0},pe.onerror=function(){st=!0,Te=null},pe.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var C="01",R=function(t,r){this._transformRequestFn=t,this._customAccessToken=r,this._createSkuToken()};function q(e){return e.indexOf("mapbox:")===0}R.prototype._createSkuToken=function(){var e=function(){for(var t="",r=0;r<10;r++)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",C,t].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=e.token,this._skuTokenExpiresAt=e.tokenExpiresAt},R.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},R.prototype.transformRequest=function(e,t){return this._transformRequestFn&&this._transformRequestFn(e,t)||{url:e}},R.prototype.normalizeStyleURL=function(e,t){if(!q(e))return e;var r=_t(e);return r.path="/styles/v1"+r.path,this._makeAPIURL(r,this._customAccessToken||t)},R.prototype.normalizeGlyphsURL=function(e,t){if(!q(e))return e;var r=_t(e);return r.path="/fonts/v1"+r.path,this._makeAPIURL(r,this._customAccessToken||t)},R.prototype.normalizeSourceURL=function(e,t){if(!q(e))return e;var r=_t(e);return r.path="/v4/"+r.authority+".json",r.params.push("secure"),this._makeAPIURL(r,this._customAccessToken||t)},R.prototype.normalizeSpriteURL=function(e,t,r,u){var f=_t(e);return q(e)?(f.path="/styles/v1"+f.path+"/sprite"+t+r,this._makeAPIURL(f,this._customAccessToken||u)):(f.path+=""+t+r,ot(f))},R.prototype.normalizeTileURL=function(e,t){if(this._isSkuTokenExpired()&&this._createSkuToken(),e&&!q(e))return e;var r=_t(e);r.path=r.path.replace(/(\.(png|jpg)\d*)(?=$)/,(me.devicePixelRatio>=2||t===512?"@2x":"")+(Ge.supported?".webp":"$1")),r.path=r.path.replace(/^.+\/v4\//,"/"),r.path="/v4"+r.path;var u=this._customAccessToken||function(f){for(var m=0,S=f;m<S.length;m+=1){var P=S[m].match(/^access_token=(.*)$/);if(P)return P[1]}return null}(r.params)||ve.ACCESS_TOKEN;return ve.REQUIRE_ACCESS_TOKEN&&u&&this._skuToken&&r.params.push("sku="+this._skuToken),this._makeAPIURL(r,u)},R.prototype.canonicalizeTileURL=function(e,t){var r=_t(e);if(!r.path.match(/(^\/v4\/)/)||!r.path.match(/\.[\w]+$/))return e;var u="mapbox://tiles/";u+=r.path.replace("/v4/","");var f=r.params;return t&&(f=f.filter(function(m){return!m.match(/^access_token=/)})),f.length&&(u+="?"+f.join("&")),u},R.prototype.canonicalizeTileset=function(e,t){for(var r=!!t&&q(t),u=[],f=0,m=e.tiles||[];f<m.length;f+=1){var S=m[f];He(S)?u.push(this.canonicalizeTileURL(S,r)):u.push(S)}return u},R.prototype._makeAPIURL=function(e,t){var r="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",u=_t(ve.API_URL);if(e.protocol=u.protocol,e.authority=u.authority,e.protocol==="http"){var f=e.params.indexOf("secure");f>=0&&e.params.splice(f,1)}if(u.path!=="/"&&(e.path=""+u.path+e.path),!ve.REQUIRE_ACCESS_TOKEN)return ot(e);if(!(t=t||ve.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+r);if(t[0]==="s")throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+r);return e.params=e.params.filter(function(m){return m.indexOf("access_token")===-1}),e.params.push("access_token="+t),ot(e)};var fe=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function He(e){return fe.test(e)}var et=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function _t(e){var t=e.match(et);if(!t)throw new Error("Unable to parse URL object");return{protocol:t[1],authority:t[2],path:t[3]||"/",params:t[4]?t[4].split("&"):[]}}function ot(e){var t=e.params.length?"?"+e.params.join("&"):"";return e.protocol+"://"+e.authority+e.path+t}function Ut(e){if(!e)return null;var t=e.split(".");if(!t||t.length!==3)return null;try{return JSON.parse(decodeURIComponent(Y.atob(t[1]).split("").map(function(r){return"%"+("00"+r.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch(r){return null}}var K=function(t){this.type=t,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};K.prototype.getStorageKey=function(e){var t,r=Ut(ve.ACCESS_TOKEN);return t=r&&r.u?Y.btoa(encodeURIComponent(r.u).replace(/%([0-9A-F]{2})/g,function(u,f){return String.fromCharCode(Number("0x"+f))})):ve.ACCESS_TOKEN||"",e?"mapbox.eventData."+e+":"+t:"mapbox.eventData:"+t},K.prototype.fetchEventData=function(){var e=H("localStorage"),t=this.getStorageKey(),r=this.getStorageKey("uuid");if(e)try{var u=Y.localStorage.getItem(t);u&&(this.eventData=JSON.parse(u));var f=Y.localStorage.getItem(r);f&&(this.anonId=f)}catch(m){Me("Unable to read from LocalStorage")}},K.prototype.saveEventData=function(){var e=H("localStorage"),t=this.getStorageKey(),r=this.getStorageKey("uuid");if(e)try{Y.localStorage.setItem(r,this.anonId),Object.keys(this.eventData).length>=1&&Y.localStorage.setItem(t,JSON.stringify(this.eventData))}catch(u){Me("Unable to write to LocalStorage")}},K.prototype.processRequests=function(e){},K.prototype.postEvent=function(e,t,r,u){var f=this;if(ve.EVENTS_URL){var m=_t(ve.EVENTS_URL);m.params.push("access_token="+(u||ve.ACCESS_TOKEN||""));var S={event:this.type,created:new Date(e).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.13.0",skuId:C,userId:this.anonId},P=t?Le(S,t):S,V={url:ot(m),headers:{"Content-Type":"text/plain"},body:JSON.stringify([P])};this.pendingRequest=Cn(V,function(re){f.pendingRequest=null,r(re),f.saveEventData(),f.processRequests(u)})}},K.prototype.queueRequest=function(e,t){this.queue.push(e),this.processRequests(t)};var qe,ae,tt=function(e){function t(){e.call(this,"map.load"),this.success={},this.skuToken=""}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.postMapLoadEvent=function(r,u,f,m){this.skuToken=f,(ve.EVENTS_URL&&m||ve.ACCESS_TOKEN&&Array.isArray(r)&&r.some(function(S){return q(S)||He(S)}))&&this.queueRequest({id:u,timestamp:Date.now()},m)},t.prototype.processRequests=function(r){var u=this;if(!this.pendingRequest&&this.queue.length!==0){var f=this.queue.shift(),m=f.id,S=f.timestamp;m&&this.success[m]||(this.anonId||this.fetchEventData(),Je(this.anonId)||(this.anonId=dt()),this.postEvent(S,{skuToken:this.skuToken},function(P){P||m&&(u.success[m]=!0)},r))}},t}(K),kt=new(function(e){function t(r){e.call(this,"appUserTurnstile"),this._customAccessToken=r}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.postTurnstileEvent=function(r,u){ve.EVENTS_URL&&ve.ACCESS_TOKEN&&Array.isArray(r)&&r.some(function(f){return q(f)||He(f)})&&this.queueRequest(Date.now(),u)},t.prototype.processRequests=function(r){var u=this;if(!this.pendingRequest&&this.queue.length!==0){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var f=Ut(ve.ACCESS_TOKEN),m=f?f.u:ve.ACCESS_TOKEN,S=m!==this.eventData.tokenU;Je(this.anonId)||(this.anonId=dt(),S=!0);var P=this.queue.shift();if(this.eventData.lastSuccess){var V=new Date(this.eventData.lastSuccess),re=new Date(P),he=(P-this.eventData.lastSuccess)/864e5;S=S||he>=1||he<-1||V.getDate()!==re.getDate()}else S=!0;if(!S)return this.processRequests();this.postEvent(P,{"enabled.telemetry":!1},function(_e){_e||(u.eventData.lastSuccess=P,u.eventData.tokenU=m)},r)}},t}(K)),pr=kt.postTurnstileEvent.bind(kt),Ke=new tt,xt=Ke.postMapLoadEvent.bind(Ke),bt=500,Et=50;function Fe(){Y.caches&&!qe&&(qe=Y.caches.open("mapbox-tiles"))}function pt(e){var t=e.indexOf("?");return t<0?e:e.slice(0,t)}var yt,Ht=1/0;function hr(){return yt==null&&(yt=Y.OffscreenCanvas&&new Y.OffscreenCanvas(1,1).getContext("2d")&&typeof Y.createImageBitmap=="function"),yt}var Zr={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(Zr);var yr=function(e){function t(r,u,f){u===401&&He(f)&&(r+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),e.call(this,r),this.status=u,this.url=f,this.name=this.constructor.name,this.message=r}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},t}(Error),Vn=Qt()?function(){return self.worker&&self.worker.referrer}:function(){return(Y.location.protocol==="blob:"?Y.parent:Y).location.href},zn,oa,$n=function(t,r){if(!(/^file:/.test(u=t.url)||/^file:/.test(Vn())&&!/^\w+:/.test(u))){if(Y.fetch&&Y.Request&&Y.AbortController&&Y.Request.prototype.hasOwnProperty("signal"))return function(f,m){var S,P=new Y.AbortController,V=new Y.Request(f.url,{method:f.method||"GET",body:f.body,credentials:f.credentials,headers:f.headers,referrer:Vn(),signal:P.signal}),re=!1,he=!1,_e=(S=V.url).indexOf("sku=")>0&&He(S);f.type==="json"&&V.headers.set("Accept","application/json");var we=function(Ct,$t,Xt){if(!he){if(Ct&&Ct.message!=="SecurityError"&&Me(Ct),$t&&Xt)return lt($t);var ir=Date.now();Y.fetch(V).then(function(br){if(br.ok){var Sr=_e?br.clone():null;return lt(br,Sr,ir)}return m(new yr(br.statusText,br.status,f.url))}).catch(function(br){br.code!==20&&m(new Error(br.message))})}},lt=function(Ct,$t,Xt){(f.type==="arrayBuffer"?Ct.arrayBuffer():f.type==="json"?Ct.json():Ct.text()).then(function(ir){he||($t&&Xt&&function(br,Sr,Fr){if(Fe(),qe){var Nr={status:Sr.status,statusText:Sr.statusText,headers:new Y.Headers};Sr.headers.forEach(function(hn,Ln){return Nr.headers.set(Ln,hn)});var mn=ur(Sr.headers.get("Cache-Control")||"");mn["no-store"]||(mn["max-age"]&&Nr.headers.set("Expires",new Date(Fr+1e3*mn["max-age"]).toUTCString()),new Date(Nr.headers.get("Expires")).getTime()-Fr<42e4||function(hn,Ln){if(ae===void 0)try{new Response(new ReadableStream),ae=!0}catch(Qn){ae=!1}ae?Ln(hn.body):hn.blob().then(Ln)}(Sr,function(hn){var Ln=new Y.Response(hn,Nr);Fe(),qe&&qe.then(function(Qn){return Qn.put(pt(br.url),Ln)}).catch(function(Qn){return Me(Qn.message)})}))}}(V,$t,Xt),re=!0,m(null,ir,Ct.headers.get("Cache-Control"),Ct.headers.get("Expires")))}).catch(function(ir){he||m(new Error(ir.message))})};return _e?function(Lt,Ct){if(Fe(),!qe)return Ct(null);var $t=pt(Lt.url);qe.then(function(Xt){Xt.match($t).then(function(ir){var br=function(Sr){if(!Sr)return!1;var Fr=new Date(Sr.headers.get("Expires")||0),Nr=ur(Sr.headers.get("Cache-Control")||"");return Fr>Date.now()&&!Nr["no-cache"]}(ir);Xt.delete($t),br&&Xt.put($t,ir.clone()),Ct(null,ir,br)}).catch(Ct)}).catch(Ct)}(V,we):we(null,null),{cancel:function(){he=!0,re||P.abort()}}}(t,r);if(Qt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",t,r,void 0,!0)}var u;return function(f,m){var S=new Y.XMLHttpRequest;for(var P in S.open(f.method||"GET",f.url,!0),f.type==="arrayBuffer"&&(S.responseType="arraybuffer"),f.headers)S.setRequestHeader(P,f.headers[P]);return f.type==="json"&&(S.responseType="text",S.setRequestHeader("Accept","application/json")),S.withCredentials=f.credentials==="include",S.onerror=function(){m(new Error(S.statusText))},S.onload=function(){if((S.status>=200&&S.status<300||S.status===0)&&S.response!==null){var V=S.response;if(f.type==="json")try{V=JSON.parse(S.response)}catch(re){return m(re)}m(null,V,S.getResponseHeader("Cache-Control"),S.getResponseHeader("Expires"))}else m(new yr(S.statusText,S.status,f.url))},S.send(f.body),{cancel:function(){return S.abort()}}}(t,r)},Kn=function(t,r){return $n(Le(t,{type:"arrayBuffer"}),r)},Cn=function(t,r){return $n(Le(t,{method:"POST"}),r)},z="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";zn=[],oa=0;var W=function e(t,r){if(Ge.supported&&(t.headers||(t.headers={}),t.headers.accept="image/webp,*/*"),oa>=ve.MAX_PARALLEL_IMAGE_REQUESTS){var u={requestParameters:t,callback:r,cancelled:!1,cancel:function(){this.cancelled=!0}};return zn.push(u),u}oa++;var f=!1,m=function(){if(!f)for(f=!0,oa--;zn.length&&oa<ve.MAX_PARALLEL_IMAGE_REQUESTS;){var V=zn.shift();V.cancelled||(V.cancel=e(V.requestParameters,V.callback).cancel)}},S=Kn(t,function(P,V,re,he){m(),P?r(P):V&&(hr()?function(_e,we){var lt=new Y.Blob([new Uint8Array(_e)],{type:"image/png"});Y.createImageBitmap(lt).then(function(Lt){we(null,Lt)}).catch(function(Lt){we(new Error("Could not load image because of "+Lt.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})}(V,r):function(_e,we,lt,Lt){var Ct=new Y.Image,$t=Y.URL;Ct.onload=function(){we(null,Ct),$t.revokeObjectURL(Ct.src),Ct.onload=null,Ct.src=z},Ct.onerror=function(){return we(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var Xt=new Y.Blob([new Uint8Array(_e)],{type:"image/png"});Ct.cacheControl=lt,Ct.expires=Lt,Ct.src=_e.byteLength?$t.createObjectURL(Xt):z}(V,r,re,he))});return{cancel:function(){S.cancel(),m()}}};function le(e,t,r){r[e]&&r[e].indexOf(t)!==-1||(r[e]=r[e]||[],r[e].push(t))}function xe(e,t,r){if(r&&r[e]){var u=r[e].indexOf(t);u!==-1&&r[e].splice(u,1)}}var ut=function(t,r){r===void 0&&(r={}),Le(this,r),this.type=t},Ot=function(e){function t(r,u){u===void 0&&(u={}),e.call(this,"error",Le({error:r},u))}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(ut),Bt=function(){};Bt.prototype.on=function(e,t){return this._listeners=this._listeners||{},le(e,t,this._listeners),this},Bt.prototype.off=function(e,t){return xe(e,t,this._listeners),xe(e,t,this._oneTimeListeners),this},Bt.prototype.once=function(e,t){return this._oneTimeListeners=this._oneTimeListeners||{},le(e,t,this._oneTimeListeners),this},Bt.prototype.fire=function(e,t){typeof e=="string"&&(e=new ut(e,t||{}));var r=e.type;if(this.listens(r)){e.target=this;for(var u=0,f=this._listeners&&this._listeners[r]?this._listeners[r].slice():[];u<f.length;u+=1)f[u].call(this,e);for(var m=0,S=this._oneTimeListeners&&this._oneTimeListeners[r]?this._oneTimeListeners[r].slice():[];m<S.length;m+=1){var P=S[m];xe(r,P,this._oneTimeListeners),P.call(this,e)}var V=this._eventedParent;V&&(Le(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),V.fire(e))}else e instanceof Ot&&console.error(e.error);return this},Bt.prototype.listens=function(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)},Bt.prototype.setEventedParent=function(e,t){return this._eventedParent=e,this._eventedParentData=t,this};var Ze={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},Rt=function(t,r,u,f){this.message=(t?t+": ":"")+u,f&&(this.identifier=f),r!=null&&r.__line__&&(this.line=r.__line__)};function lr(e){var t=e.value;return t?[new Rt(e.key,t,"constants have been deprecated as of v8")]:[]}function Ur(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];for(var u=0,f=t;u<f.length;u+=1){var m=f[u];for(var S in m)e[S]=m[S]}return e}function Gr(e){return e instanceof Number||e instanceof String||e instanceof Boolean?e.valueOf():e}function cr(e){if(Array.isArray(e))return e.map(cr);if(e instanceof Object&&!(e instanceof Number||e instanceof String||e instanceof Boolean)){var t={};for(var r in e)t[r]=cr(e[r]);return t}return Gr(e)}var Br=function(e){function t(r,u){e.call(this,u),this.message=u,this.key=r}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Error),wn=function(t,r){r===void 0&&(r=[]),this.parent=t,this.bindings={};for(var u=0,f=r;u<f.length;u+=1){var m=f[u];this.bindings[m[0]]=m[1]}};wn.prototype.concat=function(e){return new wn(this,e)},wn.prototype.get=function(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(e+" not found in scope.")},wn.prototype.has=function(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)};var fn={kind:"null"},tr={kind:"number"},rn={kind:"string"},dn={kind:"boolean"},En={kind:"color"},bn={kind:"object"},gn={kind:"value"},Mn={kind:"collator"},Ga={kind:"formatted"},ga={kind:"resolvedImage"};function Ma(e,t){return{kind:"array",itemType:e,N:t}}function Ia(e){if(e.kind==="array"){var t=Ia(e.itemType);return typeof e.N=="number"?"array<"+t+", "+e.N+">":e.itemType.kind==="value"?"array":"array<"+t+">"}return e.kind}var Wi=[fn,tr,rn,dn,En,Ga,bn,Ma(gn),ga];function da(e,t){if(t.kind==="error")return null;if(e.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!da(e.itemType,t.itemType))&&(typeof e.N!="number"||e.N===t.N))return null}else{if(e.kind===t.kind)return null;if(e.kind==="value"){for(var r=0,u=Wi;r<u.length;r+=1)if(!da(u[r],t))return null}}return"Expected "+Ia(e)+" but found "+Ia(t)+" instead."}function vi(e,t){return t.some(function(r){return r.kind===e.kind})}function ya(e,t){return t.some(function(r){return r==="null"?e===null:r==="array"?Array.isArray(e):r==="object"?e&&!Array.isArray(e)&&typeof e=="object":r===typeof e})}var ba=Z(function(e,t){var r={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function u(P){return(P=Math.round(P))<0?0:P>255?255:P}function f(P){return u(P[P.length-1]==="%"?parseFloat(P)/100*255:parseInt(P))}function m(P){return(V=P[P.length-1]==="%"?parseFloat(P)/100:parseFloat(P))<0?0:V>1?1:V;var V}function S(P,V,re){return re<0?re+=1:re>1&&(re-=1),6*re<1?P+(V-P)*re*6:2*re<1?V:3*re<2?P+(V-P)*(2/3-re)*6:P}try{t.parseCSSColor=function(P){var V,re=P.replace(/ /g,"").toLowerCase();if(re in r)return r[re].slice();if(re[0]==="#")return re.length===4?(V=parseInt(re.substr(1),16))>=0&&V<=4095?[(3840&V)>>4|(3840&V)>>8,240&V|(240&V)>>4,15&V|(15&V)<<4,1]:null:re.length===7&&(V=parseInt(re.substr(1),16))>=0&&V<=16777215?[(16711680&V)>>16,(65280&V)>>8,255&V,1]:null;var he=re.indexOf("("),_e=re.indexOf(")");if(he!==-1&&_e+1===re.length){var we=re.substr(0,he),lt=re.substr(he+1,_e-(he+1)).split(","),Lt=1;switch(we){case"rgba":if(lt.length!==4)return null;Lt=m(lt.pop());case"rgb":return lt.length!==3?null:[f(lt[0]),f(lt[1]),f(lt[2]),Lt];case"hsla":if(lt.length!==4)return null;Lt=m(lt.pop());case"hsl":if(lt.length!==3)return null;var Ct=(parseFloat(lt[0])%360+360)%360/360,$t=m(lt[1]),Xt=m(lt[2]),ir=Xt<=.5?Xt*($t+1):Xt+$t-Xt*$t,br=2*Xt-ir;return[u(255*S(br,ir,Ct+1/3)),u(255*S(br,ir,Ct)),u(255*S(br,ir,Ct-1/3)),Lt];default:return null}}return null}}catch(P){}}).parseCSSColor,ha=function(t,r,u,f){f===void 0&&(f=1),this.r=t,this.g=r,this.b=u,this.a=f};ha.parse=function(e){if(e){if(e instanceof ha)return e;if(typeof e=="string"){var t=ba(e);if(t)return new ha(t[0]/255*t[3],t[1]/255*t[3],t[2]/255*t[3],t[3])}}},ha.prototype.toString=function(){var e=this.toArray(),t=e[1],r=e[2],u=e[3];return"rgba("+Math.round(e[0])+","+Math.round(t)+","+Math.round(r)+","+u+")"},ha.prototype.toArray=function(){var e=this.a;return e===0?[0,0,0,0]:[255*this.r/e,255*this.g/e,255*this.b/e,e]},ha.black=new ha(0,0,0,1),ha.white=new ha(1,1,1,1),ha.transparent=new ha(0,0,0,0),ha.red=new ha(1,0,0,1);var wi=function(t,r,u){this.sensitivity=t?r?"variant":"case":r?"accent":"base",this.locale=u,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};wi.prototype.compare=function(e,t){return this.collator.compare(e,t)},wi.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var is=function(t,r,u,f,m){this.text=t,this.image=r,this.scale=u,this.fontStack=f,this.textColor=m},Xi=function(t){this.sections=t};Xi.fromString=function(e){return new Xi([new is(e,null,null,null,null)])},Xi.prototype.isEmpty=function(){return this.sections.length===0||!this.sections.some(function(e){return e.text.length!==0||e.image&&e.image.name.length!==0})},Xi.factory=function(e){return e instanceof Xi?e:Xi.fromString(e)},Xi.prototype.toString=function(){return this.sections.length===0?"":this.sections.map(function(e){return e.text}).join("")},Xi.prototype.serialize=function(){for(var e=["format"],t=0,r=this.sections;t<r.length;t+=1){var u=r[t];if(u.image)e.push(["image",u.image.name]);else{e.push(u.text);var f={};u.fontStack&&(f["text-font"]=["literal",u.fontStack.split(",")]),u.scale&&(f["font-scale"]=u.scale),u.textColor&&(f["text-color"]=["rgba"].concat(u.textColor.toArray())),e.push(f)}}return e};var Xo=function(t){this.name=t.name,this.available=t.available};function Du(e,t,r,u){return typeof e=="number"&&e>=0&&e<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof r=="number"&&r>=0&&r<=255?u===void 0||typeof u=="number"&&u>=0&&u<=1?null:"Invalid rgba value ["+[e,t,r,u].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+(typeof u=="number"?[e,t,r,u]:[e,t,r]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function Ha(e){if(e===null)return!0;if(typeof e=="string")return!0;if(typeof e=="boolean")return!0;if(typeof e=="number")return!0;if(e instanceof ha)return!0;if(e instanceof wi)return!0;if(e instanceof Xi)return!0;if(e instanceof Xo)return!0;if(Array.isArray(e)){for(var t=0,r=e;t<r.length;t+=1)if(!Ha(r[t]))return!1;return!0}if(typeof e=="object"){for(var u in e)if(!Ha(e[u]))return!1;return!0}return!1}function Oi(e){if(e===null)return fn;if(typeof e=="string")return rn;if(typeof e=="boolean")return dn;if(typeof e=="number")return tr;if(e instanceof ha)return En;if(e instanceof wi)return Mn;if(e instanceof Xi)return Ga;if(e instanceof Xo)return ga;if(Array.isArray(e)){for(var t,r=e.length,u=0,f=e;u<f.length;u+=1){var m=Oi(f[u]);if(t){if(t===m)continue;t=gn;break}t=m}return Ma(t||gn,r)}return bn}function Jo(e){var t=typeof e;return e===null?"":t==="string"||t==="number"||t==="boolean"?String(e):e instanceof ha||e instanceof Xi||e instanceof Xo?e.toString():JSON.stringify(e)}Xo.prototype.toString=function(){return this.name},Xo.fromString=function(e){return e?new Xo({name:e,available:!1}):null},Xo.prototype.serialize=function(){return["image",this.name]};var ui=function(t,r){this.type=t,this.value=r};ui.parse=function(e,t){if(e.length!==2)return t.error("'literal' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(!Ha(e[1]))return t.error("invalid value");var r=e[1],u=Oi(r),f=t.expectedType;return u.kind!=="array"||u.N!==0||!f||f.kind!=="array"||typeof f.N=="number"&&f.N!==0||(u=f),new ui(u,r)},ui.prototype.evaluate=function(){return this.value},ui.prototype.eachChild=function(){},ui.prototype.outputDefined=function(){return!0},ui.prototype.serialize=function(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof ha?["rgba"].concat(this.value.toArray()):this.value instanceof Xi?this.value.serialize():this.value};var Yi=function(t){this.name="ExpressionEvaluationError",this.message=t};Yi.prototype.toJSON=function(){return this.message};var Oo={string:rn,number:tr,boolean:dn,object:bn},Za=function(t,r){this.type=t,this.args=r};Za.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var r,u=1,f=e[0];if(f==="array"){var m,S;if(e.length>2){var P=e[1];if(typeof P!="string"||!(P in Oo)||P==="object")return t.error('The item type argument of "array" must be one of string, number, boolean',1);m=Oo[P],u++}else m=gn;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return t.error('The length argument to "array" must be a positive integer literal',2);S=e[2],u++}r=Ma(m,S)}else r=Oo[f];for(var V=[];u<e.length;u++){var re=t.parse(e[u],u,gn);if(!re)return null;V.push(re)}return new Za(r,V)},Za.prototype.evaluate=function(e){for(var t=0;t<this.args.length;t++){var r=this.args[t].evaluate(e);if(!da(this.type,Oi(r)))return r;if(t===this.args.length-1)throw new Yi("Expected value to be of type "+Ia(this.type)+", but found "+Ia(Oi(r))+" instead.")}return null},Za.prototype.eachChild=function(e){this.args.forEach(e)},Za.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},Za.prototype.serialize=function(){var e=this.type,t=[e.kind];if(e.kind==="array"){var r=e.itemType;if(r.kind==="string"||r.kind==="number"||r.kind==="boolean"){t.push(r.kind);var u=e.N;(typeof u=="number"||this.args.length>1)&&t.push(u)}}return t.concat(this.args.map(function(f){return f.serialize()}))};var oo=function(t){this.type=Ga,this.sections=t};oo.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var r=e[1];if(!Array.isArray(r)&&typeof r=="object")return t.error("First argument must be an image or text section.");for(var u=[],f=!1,m=1;m<=e.length-1;++m){var S=e[m];if(f&&typeof S=="object"&&!Array.isArray(S)){f=!1;var P=null;if(S["font-scale"]&&!(P=t.parse(S["font-scale"],1,tr)))return null;var V=null;if(S["text-font"]&&!(V=t.parse(S["text-font"],1,Ma(rn))))return null;var re=null;if(S["text-color"]&&!(re=t.parse(S["text-color"],1,En)))return null;var he=u[u.length-1];he.scale=P,he.font=V,he.textColor=re}else{var _e=t.parse(e[m],1,gn);if(!_e)return null;var we=_e.type.kind;if(we!=="string"&&we!=="value"&&we!=="null"&&we!=="resolvedImage")return t.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");f=!0,u.push({content:_e,scale:null,font:null,textColor:null})}}return new oo(u)},oo.prototype.evaluate=function(e){return new Xi(this.sections.map(function(t){var r=t.content.evaluate(e);return Oi(r)===ga?new is("",r,null,null,null):new is(Jo(r),null,t.scale?t.scale.evaluate(e):null,t.font?t.font.evaluate(e).join(","):null,t.textColor?t.textColor.evaluate(e):null)}))},oo.prototype.eachChild=function(e){for(var t=0,r=this.sections;t<r.length;t+=1){var u=r[t];e(u.content),u.scale&&e(u.scale),u.font&&e(u.font),u.textColor&&e(u.textColor)}},oo.prototype.outputDefined=function(){return!1},oo.prototype.serialize=function(){for(var e=["format"],t=0,r=this.sections;t<r.length;t+=1){var u=r[t];e.push(u.content.serialize());var f={};u.scale&&(f["font-scale"]=u.scale.serialize()),u.font&&(f["text-font"]=u.font.serialize()),u.textColor&&(f["text-color"]=u.textColor.serialize()),e.push(f)}return e};var so=function(t){this.type=ga,this.input=t};so.parse=function(e,t){if(e.length!==2)return t.error("Expected two arguments.");var r=t.parse(e[1],1,rn);return r?new so(r):t.error("No image name provided.")},so.prototype.evaluate=function(e){var t=this.input.evaluate(e),r=Xo.fromString(t);return r&&e.availableImages&&(r.available=e.availableImages.indexOf(t)>-1),r},so.prototype.eachChild=function(e){e(this.input)},so.prototype.outputDefined=function(){return!1},so.prototype.serialize=function(){return["image",this.input.serialize()]};var bu={"to-boolean":dn,"to-color":En,"to-number":tr,"to-string":rn},Qo=function(t,r){this.type=t,this.args=r};Qo.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var r=e[0];if((r==="to-boolean"||r==="to-string")&&e.length!==2)return t.error("Expected one argument.");for(var u=bu[r],f=[],m=1;m<e.length;m++){var S=t.parse(e[m],m,gn);if(!S)return null;f.push(S)}return new Qo(u,f)},Qo.prototype.evaluate=function(e){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(e));if(this.type.kind==="color"){for(var t,r,u=0,f=this.args;u<f.length;u+=1){if(r=null,(t=f[u].evaluate(e))instanceof ha)return t;if(typeof t=="string"){var m=e.parseColor(t);if(m)return m}else if(Array.isArray(t)&&!(r=t.length<3||t.length>4?"Invalid rbga value "+JSON.stringify(t)+": expected an array containing either three or four numeric values.":Du(t[0],t[1],t[2],t[3])))return new ha(t[0]/255,t[1]/255,t[2]/255,t[3])}throw new Yi(r||"Could not parse color from value '"+(typeof t=="string"?t:String(JSON.stringify(t)))+"'")}if(this.type.kind==="number"){for(var S=null,P=0,V=this.args;P<V.length;P+=1){if((S=V[P].evaluate(e))===null)return 0;var re=Number(S);if(!isNaN(re))return re}throw new Yi("Could not convert "+JSON.stringify(S)+" to number.")}return this.type.kind==="formatted"?Xi.fromString(Jo(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?Xo.fromString(Jo(this.args[0].evaluate(e))):Jo(this.args[0].evaluate(e))},Qo.prototype.eachChild=function(e){this.args.forEach(e)},Qo.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},Qo.prototype.serialize=function(){if(this.type.kind==="formatted")return new oo([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new so(this.args[0]).serialize();var e=["to-"+this.type.kind];return this.eachChild(function(t){e.push(t.serialize())}),e};var Xl=["Unknown","Point","LineString","Polygon"],js=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};js.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},js.prototype.geometryType=function(){return this.feature?typeof this.feature.type=="number"?Xl[this.feature.type]:this.feature.type:null},js.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},js.prototype.canonicalID=function(){return this.canonical},js.prototype.properties=function(){return this.feature&&this.feature.properties||{}},js.prototype.parseColor=function(e){var t=this._parseColorCache[e];return t||(t=this._parseColorCache[e]=ha.parse(e)),t};var ho=function(t,r,u,f){this.name=t,this.type=r,this._evaluate=u,this.args=f};ho.prototype.evaluate=function(e){return this._evaluate(e,this.args)},ho.prototype.eachChild=function(e){this.args.forEach(e)},ho.prototype.outputDefined=function(){return!1},ho.prototype.serialize=function(){return[this.name].concat(this.args.map(function(e){return e.serialize()}))},ho.parse=function(e,t){var r,u=e[0],f=ho.definitions[u];if(!f)return t.error('Unknown expression "'+u+'". If you wanted a literal array, use ["literal", [...]].',0);for(var m=Array.isArray(f)?f[0]:f.type,S=Array.isArray(f)?[[f[1],f[2]]]:f.overloads,P=S.filter(function(Yn){var Nn=Yn[0];return!Array.isArray(Nn)||Nn.length===e.length-1}),V=null,re=0,he=P;re<he.length;re+=1){var _e=he[re],we=_e[0],lt=_e[1];V=new Ks(t.registry,t.path,null,t.scope);for(var Lt=[],Ct=!1,$t=1;$t<e.length;$t++){var Xt=e[$t],ir=Array.isArray(we)?we[$t-1]:we.type,br=V.parse(Xt,1+Lt.length,ir);if(!br){Ct=!0;break}Lt.push(br)}if(!Ct)if(Array.isArray(we)&&we.length!==Lt.length)V.error("Expected "+we.length+" arguments, but found "+Lt.length+" instead.");else{for(var Sr=0;Sr<Lt.length;Sr++){var Fr=Array.isArray(we)?we[Sr]:we.type,Nr=Lt[Sr];V.concat(Sr+1).checkSubtype(Fr,Nr.type)}if(V.errors.length===0)return new ho(u,m,lt,Lt)}}if(P.length===1)(r=t.errors).push.apply(r,V.errors);else{for(var mn=(P.length?P:S).map(function(Yn){var Nn;return Nn=Yn[0],Array.isArray(Nn)?"("+Nn.map(Ia).join(", ")+")":"("+Ia(Nn.type)+"...)"}).join(" | "),hn=[],Ln=1;Ln<e.length;Ln++){var Qn=t.parse(e[Ln],1+hn.length);if(!Qn)return null;hn.push(Ia(Qn.type))}t.error("Expected arguments of type "+mn+", but found ("+hn.join(", ")+") instead.")}return null},ho.register=function(e,t){for(var r in ho.definitions=t,t)e[r]=ho};var Vt=function(t,r,u){this.type=Mn,this.locale=u,this.caseSensitive=t,this.diacriticSensitive=r};function Re(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[0]),e[3]=Math.max(e[3],t[1])}function Dt(e,t){return!(e[0]<=t[0]||e[2]>=t[2]||e[1]<=t[1]||e[3]>=t[3])}function vr(e,t){var r=(180+e[0])/360,u=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e[1]*Math.PI/360)))/360,f=Math.pow(2,t.z);return[Math.round(r*f*8192),Math.round(u*f*8192)]}function en(e,t,r){return t[1]>e[1]!=r[1]>e[1]&&e[0]<(r[0]-t[0])*(e[1]-t[1])/(r[1]-t[1])+t[0]}function Tn(e,t){for(var r,u,f,m,S,P,V,re=!1,he=0,_e=t.length;he<_e;he++)for(var we=t[he],lt=0,Lt=we.length;lt<Lt-1;lt++){if((m=(r=e)[0]-(u=we[lt])[0])*(V=r[1]-(f=we[lt+1])[1])-(P=r[0]-f[0])*(S=r[1]-u[1])==0&&m*P<=0&&S*V<=0)return!1;en(e,we[lt],we[lt+1])&&(re=!re)}return re}function Gn(e,t){for(var r=0;r<t.length;r++)if(Tn(e,t[r]))return!0;return!1}function Mi(e,t,r,u){var f=u[0]-r[0],m=u[1]-r[1],S=(e[0]-r[0])*m-f*(e[1]-r[1]),P=(t[0]-r[0])*m-f*(t[1]-r[1]);return S>0&&P<0||S<0&&P>0}function po(e,t,r){for(var u=0,f=r;u<f.length;u+=1)for(var m=f[u],S=0;S<m.length-1;++S)if((_e=[(he=m[S+1])[0]-(re=m[S])[0],he[1]-re[1]])[0]*(we=[(V=t)[0]-(P=e)[0],V[1]-P[1]])[1]-_e[1]*we[0]!=0&&Mi(P,V,re,he)&&Mi(re,he,P,V))return!0;var P,V,re,he,_e,we;return!1}function mo(e,t){for(var r=0;r<e.length;++r)if(!Tn(e[r],t))return!1;for(var u=0;u<e.length-1;++u)if(po(e[u],e[u+1],t))return!1;return!0}function Mo(e,t){for(var r=0;r<t.length;r++)if(mo(e,t[r]))return!0;return!1}function Nu(e,t,r){for(var u=[],f=0;f<e.length;f++){for(var m=[],S=0;S<e[f].length;S++){var P=vr(e[f][S],r);Re(t,P),m.push(P)}u.push(m)}return u}function Ol(e,t,r){for(var u=[],f=0;f<e.length;f++){var m=Nu(e[f],t,r);u.push(m)}return u}function Ts(e,t,r,u){if(e[0]<r[0]||e[0]>r[2]){var f=.5*u,m=e[0]-r[0]>f?-u:r[0]-e[0]>f?u:0;m===0&&(m=e[0]-r[2]>f?-u:r[2]-e[0]>f?u:0),e[0]+=m}Re(t,e)}function pc(e,t,r,u){for(var f=8192*Math.pow(2,u.z),m=[8192*u.x,8192*u.y],S=[],P=0,V=e;P<V.length;P+=1)for(var re=0,he=V[P];re<he.length;re+=1){var _e=he[re],we=[_e.x+m[0],_e.y+m[1]];Ts(we,t,r,f),S.push(we)}return S}function xu(e,t,r,u){for(var f,m=8192*Math.pow(2,u.z),S=[8192*u.x,8192*u.y],P=[],V=0,re=e;V<re.length;V+=1){for(var he=[],_e=0,we=re[V];_e<we.length;_e+=1){var lt=we[_e],Lt=[lt.x+S[0],lt.y+S[1]];Re(t,Lt),he.push(Lt)}P.push(he)}if(t[2]-t[0]<=m/2){(f=t)[0]=f[1]=1/0,f[2]=f[3]=-1/0;for(var Ct=0,$t=P;Ct<$t.length;Ct+=1)for(var Xt=0,ir=$t[Ct];Xt<ir.length;Xt+=1)Ts(ir[Xt],t,r,m)}return P}Vt.parse=function(e,t){if(e.length!==2)return t.error("Expected one argument.");var r=e[1];if(typeof r!="object"||Array.isArray(r))return t.error("Collator options argument must be an object.");var u=t.parse(r["case-sensitive"]!==void 0&&r["case-sensitive"],1,dn);if(!u)return null;var f=t.parse(r["diacritic-sensitive"]!==void 0&&r["diacritic-sensitive"],1,dn);if(!f)return null;var m=null;return r.locale&&!(m=t.parse(r.locale,1,rn))?null:new Vt(u,f,m)},Vt.prototype.evaluate=function(e){return new wi(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)},Vt.prototype.eachChild=function(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)},Vt.prototype.outputDefined=function(){return!1},Vt.prototype.serialize=function(){var e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]};var Po=function(t,r){this.type=dn,this.geojson=t,this.geometries=r};function ku(e){if(e instanceof ho){if(e.name==="get"&&e.args.length===1)return!1;if(e.name==="feature-state")return!1;if(e.name==="has"&&e.args.length===1)return!1;if(e.name==="properties"||e.name==="geometry-type"||e.name==="id")return!1;if(/^filter-/.test(e.name))return!1}if(e instanceof Po)return!1;var t=!0;return e.eachChild(function(r){t&&!ku(r)&&(t=!1)}),t}function _o(e){if(e instanceof ho&&e.name==="feature-state")return!1;var t=!0;return e.eachChild(function(r){t&&!_o(r)&&(t=!1)}),t}function zi(e,t){if(e instanceof ho&&t.indexOf(e.name)>=0)return!1;var r=!0;return e.eachChild(function(u){r&&!zi(u,t)&&(r=!1)}),r}Po.parse=function(e,t){if(e.length!==2)return t.error("'within' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(Ha(e[1])){var r=e[1];if(r.type==="FeatureCollection")for(var u=0;u<r.features.length;++u){var f=r.features[u].geometry.type;if(f==="Polygon"||f==="MultiPolygon")return new Po(r,r.features[u].geometry)}else if(r.type==="Feature"){var m=r.geometry.type;if(m==="Polygon"||m==="MultiPolygon")return new Po(r,r.geometry)}else if(r.type==="Polygon"||r.type==="MultiPolygon")return new Po(r,r)}return t.error("'within' expression requires valid geojson object that contains polygon geometry type.")},Po.prototype.evaluate=function(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(t,r){var u=[1/0,1/0,-1/0,-1/0],f=[1/0,1/0,-1/0,-1/0],m=t.canonicalID();if(r.type==="Polygon"){var S=Nu(r.coordinates,f,m),P=pc(t.geometry(),u,f,m);if(!Dt(u,f))return!1;for(var V=0,re=P;V<re.length;V+=1)if(!Tn(re[V],S))return!1}if(r.type==="MultiPolygon"){var he=Ol(r.coordinates,f,m),_e=pc(t.geometry(),u,f,m);if(!Dt(u,f))return!1;for(var we=0,lt=_e;we<lt.length;we+=1)if(!Gn(lt[we],he))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(t,r){var u=[1/0,1/0,-1/0,-1/0],f=[1/0,1/0,-1/0,-1/0],m=t.canonicalID();if(r.type==="Polygon"){var S=Nu(r.coordinates,f,m),P=xu(t.geometry(),u,f,m);if(!Dt(u,f))return!1;for(var V=0,re=P;V<re.length;V+=1)if(!mo(re[V],S))return!1}if(r.type==="MultiPolygon"){var he=Ol(r.coordinates,f,m),_e=xu(t.geometry(),u,f,m);if(!Dt(u,f))return!1;for(var we=0,lt=_e;we<lt.length;we+=1)if(!Mo(lt[we],he))return!1}return!0}(e,this.geometries)}return!1},Po.prototype.eachChild=function(){},Po.prototype.outputDefined=function(){return!0},Po.prototype.serialize=function(){return["within",this.geojson]};var Ys=function(t,r){this.type=r.type,this.name=t,this.boundExpression=r};Ys.parse=function(e,t){if(e.length!==2||typeof e[1]!="string")return t.error("'var' expression requires exactly one string literal argument.");var r=e[1];return t.scope.has(r)?new Ys(r,t.scope.get(r)):t.error('Unknown variable "'+r+'". Make sure "'+r+'" has been bound in an enclosing "let" expression before using it.',1)},Ys.prototype.evaluate=function(e){return this.boundExpression.evaluate(e)},Ys.prototype.eachChild=function(){},Ys.prototype.outputDefined=function(){return!1},Ys.prototype.serialize=function(){return["var",this.name]};var Ks=function(t,r,u,f,m){r===void 0&&(r=[]),f===void 0&&(f=new wn),m===void 0&&(m=[]),this.registry=t,this.path=r,this.key=r.map(function(S){return"["+S+"]"}).join(""),this.scope=f,this.errors=m,this.expectedType=u};function Fs(e,t){for(var r,u=e.length-1,f=0,m=u,S=0;f<=m;)if((r=e[S=Math.floor((f+m)/2)])<=t){if(S===u||t<e[S+1])return S;f=S+1}else{if(!(r>t))throw new Yi("Input is not a number.");m=S-1}return 0}Ks.prototype.parse=function(e,t,r,u,f){return f===void 0&&(f={}),t?this.concat(t,r,u)._parse(e,f):this._parse(e,f)},Ks.prototype._parse=function(e,t){function r(re,he,_e){return _e==="assert"?new Za(he,[re]):_e==="coerce"?new Qo(he,[re]):re}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var u=e[0];if(typeof u!="string")return this.error("Expression name must be a string, but found "+typeof u+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var f=this.registry[u];if(f){var m=f.parse(e,this);if(!m)return null;if(this.expectedType){var S=this.expectedType,P=m.type;if(S.kind!=="string"&&S.kind!=="number"&&S.kind!=="boolean"&&S.kind!=="object"&&S.kind!=="array"||P.kind!=="value")if(S.kind!=="color"&&S.kind!=="formatted"&&S.kind!=="resolvedImage"||P.kind!=="value"&&P.kind!=="string"){if(this.checkSubtype(S,P))return null}else m=r(m,S,t.typeAnnotation||"coerce");else m=r(m,S,t.typeAnnotation||"assert")}if(!(m instanceof ui)&&m.type.kind!=="resolvedImage"&&function re(he){if(he instanceof Ys)return re(he.boundExpression);if(he instanceof ho&&he.name==="error")return!1;if(he instanceof Vt)return!1;if(he instanceof Po)return!1;var _e=he instanceof Qo||he instanceof Za,we=!0;return he.eachChild(function(lt){we=_e?we&&re(lt):we&&lt instanceof ui}),!!we&&ku(he)&&zi(he,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(m)){var V=new js;try{m=new ui(m.type,m.evaluate(V))}catch(re){return this.error(re.message),null}}return m}return this.error('Unknown expression "'+u+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof e+" instead.")},Ks.prototype.concat=function(e,t,r){var u=typeof e=="number"?this.path.concat(e):this.path,f=r?this.scope.concat(r):this.scope;return new Ks(this.registry,u,t||null,f,this.errors)},Ks.prototype.error=function(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];var u=""+this.key+t.map(function(f){return"["+f+"]"}).join("");this.errors.push(new Br(u,e))},Ks.prototype.checkSubtype=function(e,t){var r=da(e,t);return r&&this.error(r),r};var Ii=function(t,r,u){this.type=t,this.input=r,this.labels=[],this.outputs=[];for(var f=0,m=u;f<m.length;f+=1){var S=m[f],P=S[1];this.labels.push(S[0]),this.outputs.push(P)}};function Gi(e,t,r){return e*(1-r)+t*r}Ii.parse=function(e,t){if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");var r=t.parse(e[1],1,tr);if(!r)return null;var u=[],f=null;t.expectedType&&t.expectedType.kind!=="value"&&(f=t.expectedType);for(var m=1;m<e.length;m+=2){var S=m===1?-1/0:e[m],P=e[m+1],V=m,re=m+1;if(typeof S!="number")return t.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',V);if(u.length&&u[u.length-1][0]>=S)return t.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',V);var he=t.parse(P,re,f);if(!he)return null;f=f||he.type,u.push([S,he])}return new Ii(f,r,u)},Ii.prototype.evaluate=function(e){var t=this.labels,r=this.outputs;if(t.length===1)return r[0].evaluate(e);var u=this.input.evaluate(e);if(u<=t[0])return r[0].evaluate(e);var f=t.length;return u>=t[f-1]?r[f-1].evaluate(e):r[Fs(t,u)].evaluate(e)},Ii.prototype.eachChild=function(e){e(this.input);for(var t=0,r=this.outputs;t<r.length;t+=1)e(r[t])},Ii.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},Ii.prototype.serialize=function(){for(var e=["step",this.input.serialize()],t=0;t<this.labels.length;t++)t>0&&e.push(this.labels[t]),e.push(this.outputs[t].serialize());return e};var _s=Object.freeze({__proto__:null,number:Gi,color:function(t,r,u){return new ha(Gi(t.r,r.r,u),Gi(t.g,r.g,u),Gi(t.b,r.b,u),Gi(t.a,r.a,u))},array:function(t,r,u){return t.map(function(f,m){return Gi(f,r[m],u)})}}),ml=6/29*3*(6/29),$u=Math.PI/180,It=180/Math.PI;function fr(e){return e>.008856451679035631?Math.pow(e,1/3):e/ml+4/29}function Pr(e){return e>6/29?e*e*e:ml*(e-4/29)}function Wn(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function Ya(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function xi(e){var t=Ya(e.r),r=Ya(e.g),u=Ya(e.b),f=fr((.4124564*t+.3575761*r+.1804375*u)/.95047),m=fr((.2126729*t+.7151522*r+.072175*u)/1);return{l:116*m-16,a:500*(f-m),b:200*(m-fr((.0193339*t+.119192*r+.9503041*u)/1.08883)),alpha:e.a}}function Ki(e){var t=(e.l+16)/116,r=isNaN(e.a)?t:t+e.a/500,u=isNaN(e.b)?t:t-e.b/200;return t=1*Pr(t),r=.95047*Pr(r),u=1.08883*Pr(u),new ha(Wn(3.2404542*r-1.5371385*t-.4985314*u),Wn(-.969266*r+1.8760108*t+.041556*u),Wn(.0556434*r-.2040259*t+1.0572252*u),e.alpha)}function Ka(e,t,r){var u=t-e;return e+r*(u>180||u<-180?u-360*Math.round(u/360):u)}var Di={forward:xi,reverse:Ki,interpolate:function(t,r,u){return{l:Gi(t.l,r.l,u),a:Gi(t.a,r.a,u),b:Gi(t.b,r.b,u),alpha:Gi(t.alpha,r.alpha,u)}}},Yo={forward:function(t){var r=xi(t),u=r.l,f=r.a,m=r.b,S=Math.atan2(m,f)*It;return{h:S<0?S+360:S,c:Math.sqrt(f*f+m*m),l:u,alpha:t.a}},reverse:function(t){var r=t.h*$u,u=t.c;return Ki({l:t.l,a:Math.cos(r)*u,b:Math.sin(r)*u,alpha:t.alpha})},interpolate:function(t,r,u){return{h:Ka(t.h,r.h,u),c:Gi(t.c,r.c,u),l:Gi(t.l,r.l,u),alpha:Gi(t.alpha,r.alpha,u)}}},Ps=Object.freeze({__proto__:null,lab:Di,hcl:Yo}),gi=function(t,r,u,f,m){this.type=t,this.operator=r,this.interpolation=u,this.input=f,this.labels=[],this.outputs=[];for(var S=0,P=m;S<P.length;S+=1){var V=P[S],re=V[1];this.labels.push(V[0]),this.outputs.push(re)}};function Ml(e,t,r,u){var f=u-r,m=e-r;return f===0?0:t===1?m/f:(Math.pow(t,m)-1)/(Math.pow(t,f)-1)}gi.interpolationFactor=function(e,t,r,u){var f=0;if(e.name==="exponential")f=Ml(t,e.base,r,u);else if(e.name==="linear")f=Ml(t,1,r,u);else if(e.name==="cubic-bezier"){var m=e.controlPoints;f=new D(m[0],m[1],m[2],m[3]).solve(Ml(t,1,r,u))}return f},gi.parse=function(e,t){var r=e[0],u=e[1],f=e[2],m=e.slice(3);if(!Array.isArray(u)||u.length===0)return t.error("Expected an interpolation type expression.",1);if(u[0]==="linear")u={name:"linear"};else if(u[0]==="exponential"){var S=u[1];if(typeof S!="number")return t.error("Exponential interpolation requires a numeric base.",1,1);u={name:"exponential",base:S}}else{if(u[0]!=="cubic-bezier")return t.error("Unknown interpolation type "+String(u[0]),1,0);var P=u.slice(1);if(P.length!==4||P.some(function($t){return typeof $t!="number"||$t<0||$t>1}))return t.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);u={name:"cubic-bezier",controlPoints:P}}if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");if(!(f=t.parse(f,2,tr)))return null;var V=[],re=null;r==="interpolate-hcl"||r==="interpolate-lab"?re=En:t.expectedType&&t.expectedType.kind!=="value"&&(re=t.expectedType);for(var he=0;he<m.length;he+=2){var _e=m[he],we=m[he+1],lt=he+3,Lt=he+4;if(typeof _e!="number")return t.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',lt);if(V.length&&V[V.length-1][0]>=_e)return t.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',lt);var Ct=t.parse(we,Lt,re);if(!Ct)return null;re=re||Ct.type,V.push([_e,Ct])}return re.kind==="number"||re.kind==="color"||re.kind==="array"&&re.itemType.kind==="number"&&typeof re.N=="number"?new gi(re,r,u,f,V):t.error("Type "+Ia(re)+" is not interpolatable.")},gi.prototype.evaluate=function(e){var t=this.labels,r=this.outputs;if(t.length===1)return r[0].evaluate(e);var u=this.input.evaluate(e);if(u<=t[0])return r[0].evaluate(e);var f=t.length;if(u>=t[f-1])return r[f-1].evaluate(e);var m=Fs(t,u),S=gi.interpolationFactor(this.interpolation,u,t[m],t[m+1]),P=r[m].evaluate(e),V=r[m+1].evaluate(e);return this.operator==="interpolate"?_s[this.type.kind.toLowerCase()](P,V,S):this.operator==="interpolate-hcl"?Yo.reverse(Yo.interpolate(Yo.forward(P),Yo.forward(V),S)):Di.reverse(Di.interpolate(Di.forward(P),Di.forward(V),S))},gi.prototype.eachChild=function(e){e(this.input);for(var t=0,r=this.outputs;t<r.length;t+=1)e(r[t])},gi.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},gi.prototype.serialize=function(){var e;e=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var t=[this.operator,e,this.input.serialize()],r=0;r<this.labels.length;r++)t.push(this.labels[r],this.outputs[r].serialize());return t};var $s=function(t,r){this.type=t,this.args=r};$s.parse=function(e,t){if(e.length<2)return t.error("Expectected at least one argument.");var r=null,u=t.expectedType;u&&u.kind!=="value"&&(r=u);for(var f=[],m=0,S=e.slice(1);m<S.length;m+=1){var P=t.parse(S[m],1+f.length,r,void 0,{typeAnnotation:"omit"});if(!P)return null;r=r||P.type,f.push(P)}var V=u&&f.some(function(re){return da(u,re.type)});return new $s(V?gn:r,f)},$s.prototype.evaluate=function(e){for(var t,r=null,u=0,f=0,m=this.args;f<m.length&&(u++,(r=m[f].evaluate(e))&&r instanceof Xo&&!r.available&&(t||(t=r.name),r=null,u===this.args.length&&(r=t)),r===null);f+=1);return r},$s.prototype.eachChild=function(e){this.args.forEach(e)},$s.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},$s.prototype.serialize=function(){var e=["coalesce"];return this.eachChild(function(t){e.push(t.serialize())}),e};var Ss=function(t,r){this.type=r.type,this.bindings=[].concat(t),this.result=r};Ss.prototype.evaluate=function(e){return this.result.evaluate(e)},Ss.prototype.eachChild=function(e){for(var t=0,r=this.bindings;t<r.length;t+=1)e(r[t][1]);e(this.result)},Ss.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found "+(e.length-1)+" instead.");for(var r=[],u=1;u<e.length-1;u+=2){var f=e[u];if(typeof f!="string")return t.error("Expected string, but found "+typeof f+" instead.",u);if(/[^a-zA-Z0-9_]/.test(f))return t.error("Variable names must contain only alphanumeric characters or '_'.",u);var m=t.parse(e[u+1],u+1);if(!m)return null;r.push([f,m])}var S=t.parse(e[e.length-1],e.length-1,t.expectedType,r);return S?new Ss(r,S):null},Ss.prototype.outputDefined=function(){return this.result.outputDefined()},Ss.prototype.serialize=function(){for(var e=["let"],t=0,r=this.bindings;t<r.length;t+=1){var u=r[t];e.push(u[0],u[1].serialize())}return e.push(this.result.serialize()),e};var vl=function(t,r,u){this.type=t,this.index=r,this.input=u};vl.parse=function(e,t){if(e.length!==3)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,tr),u=t.parse(e[2],2,Ma(t.expectedType||gn));return r&&u?new vl(u.type.itemType,r,u):null},vl.prototype.evaluate=function(e){var t=this.index.evaluate(e),r=this.input.evaluate(e);if(t<0)throw new Yi("Array index out of bounds: "+t+" < 0.");if(t>=r.length)throw new Yi("Array index out of bounds: "+t+" > "+(r.length-1)+".");if(t!==Math.floor(t))throw new Yi("Array index must be an integer, but found "+t+" instead.");return r[t]},vl.prototype.eachChild=function(e){e(this.index),e(this.input)},vl.prototype.outputDefined=function(){return!1},vl.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var cu=function(t,r){this.type=dn,this.needle=t,this.haystack=r};cu.parse=function(e,t){if(e.length!==3)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,gn),u=t.parse(e[2],2,gn);return r&&u?vi(r.type,[dn,rn,tr,fn,gn])?new cu(r,u):t.error("Expected first argument to be of type boolean, string, number or null, but found "+Ia(r.type)+" instead"):null},cu.prototype.evaluate=function(e){var t=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!r)return!1;if(!ya(t,["boolean","string","number","null"]))throw new Yi("Expected first argument to be of type boolean, string, number or null, but found "+Ia(Oi(t))+" instead.");if(!ya(r,["string","array"]))throw new Yi("Expected second argument to be of type array or string, but found "+Ia(Oi(r))+" instead.");return r.indexOf(t)>=0},cu.prototype.eachChild=function(e){e(this.needle),e(this.haystack)},cu.prototype.outputDefined=function(){return!0},cu.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var Eu=function(t,r,u){this.type=tr,this.needle=t,this.haystack=r,this.fromIndex=u};Eu.parse=function(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,gn),u=t.parse(e[2],2,gn);if(!r||!u)return null;if(!vi(r.type,[dn,rn,tr,fn,gn]))return t.error("Expected first argument to be of type boolean, string, number or null, but found "+Ia(r.type)+" instead");if(e.length===4){var f=t.parse(e[3],3,tr);return f?new Eu(r,u,f):null}return new Eu(r,u)},Eu.prototype.evaluate=function(e){var t=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!ya(t,["boolean","string","number","null"]))throw new Yi("Expected first argument to be of type boolean, string, number or null, but found "+Ia(Oi(t))+" instead.");if(!ya(r,["string","array"]))throw new Yi("Expected second argument to be of type array or string, but found "+Ia(Oi(r))+" instead.");if(this.fromIndex){var u=this.fromIndex.evaluate(e);return r.indexOf(t,u)}return r.indexOf(t)},Eu.prototype.eachChild=function(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)},Eu.prototype.outputDefined=function(){return!1},Eu.prototype.serialize=function(){if(this.fromIndex!=null&&this.fromIndex!==void 0){var e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var fu=function(t,r,u,f,m,S){this.inputType=t,this.type=r,this.input=u,this.cases=f,this.outputs=m,this.otherwise=S};fu.parse=function(e,t){if(e.length<5)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if(e.length%2!=1)return t.error("Expected an even number of arguments.");var r,u;t.expectedType&&t.expectedType.kind!=="value"&&(u=t.expectedType);for(var f={},m=[],S=2;S<e.length-1;S+=2){var P=e[S],V=e[S+1];Array.isArray(P)||(P=[P]);var re=t.concat(S);if(P.length===0)return re.error("Expected at least one branch label.");for(var he=0,_e=P;he<_e.length;he+=1){var we=_e[he];if(typeof we!="number"&&typeof we!="string")return re.error("Branch labels must be numbers or strings.");if(typeof we=="number"&&Math.abs(we)>Number.MAX_SAFE_INTEGER)return re.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if(typeof we=="number"&&Math.floor(we)!==we)return re.error("Numeric branch labels must be integer values.");if(r){if(re.checkSubtype(r,Oi(we)))return null}else r=Oi(we);if(f[String(we)]!==void 0)return re.error("Branch labels must be unique.");f[String(we)]=m.length}var lt=t.parse(V,S,u);if(!lt)return null;u=u||lt.type,m.push(lt)}var Lt=t.parse(e[1],1,gn);if(!Lt)return null;var Ct=t.parse(e[e.length-1],e.length-1,u);return Ct?Lt.type.kind!=="value"&&t.concat(1).checkSubtype(r,Lt.type)?null:new fu(r,u,Lt,f,m,Ct):null},fu.prototype.evaluate=function(e){var t=this.input.evaluate(e);return(Oi(t)===this.inputType&&this.outputs[this.cases[t]]||this.otherwise).evaluate(e)},fu.prototype.eachChild=function(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)},fu.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})&&this.otherwise.outputDefined()},fu.prototype.serialize=function(){for(var e=this,t=["match",this.input.serialize()],r=[],u={},f=0,m=Object.keys(this.cases).sort();f<m.length;f+=1){var S=m[f];(_e=u[this.cases[S]])===void 0?(u[this.cases[S]]=r.length,r.push([this.cases[S],[S]])):r[_e][1].push(S)}for(var P=function(Lt){return e.inputType.kind==="number"?Number(Lt):Lt},V=0,re=r;V<re.length;V+=1){var he=re[V],_e=he[0],we=he[1];t.push(we.length===1?P(we[0]):we.map(P)),t.push(this.outputs[outputIndex$1].serialize())}return t.push(this.otherwise.serialize()),t};var ju=function(t,r,u){this.type=t,this.branches=r,this.otherwise=u};ju.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found only "+(e.length-1)+".");if(e.length%2!=0)return t.error("Expected an odd number of arguments.");var r;t.expectedType&&t.expectedType.kind!=="value"&&(r=t.expectedType);for(var u=[],f=1;f<e.length-1;f+=2){var m=t.parse(e[f],f,dn);if(!m)return null;var S=t.parse(e[f+1],f+1,r);if(!S)return null;u.push([m,S]),r=r||S.type}var P=t.parse(e[e.length-1],e.length-1,r);return P?new ju(r,u,P):null},ju.prototype.evaluate=function(e){for(var t=0,r=this.branches;t<r.length;t+=1){var u=r[t],f=u[1];if(u[0].evaluate(e))return f.evaluate(e)}return this.otherwise.evaluate(e)},ju.prototype.eachChild=function(e){for(var t=0,r=this.branches;t<r.length;t+=1){var u=r[t],f=u[1];e(u[0]),e(f)}e(this.otherwise)},ju.prototype.outputDefined=function(){return this.branches.every(function(e){return e[1].outputDefined()})&&this.otherwise.outputDefined()},ju.prototype.serialize=function(){var e=["case"];return this.eachChild(function(t){e.push(t.serialize())}),e};var Js=function(t,r,u,f){this.type=t,this.input=r,this.beginIndex=u,this.endIndex=f};function Mc(e,t){return e==="=="||e==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function hf(e,t,r,u){return u.compare(t,r)===0}function pi(e,t,r){var u=e!=="=="&&e!=="!=";return function(){function f(m,S,P){this.type=dn,this.lhs=m,this.rhs=S,this.collator=P,this.hasUntypedArgument=m.type.kind==="value"||S.type.kind==="value"}return f.parse=function(m,S){if(m.length!==3&&m.length!==4)return S.error("Expected two or three arguments.");var P=m[0],V=S.parse(m[1],1,gn);if(!V)return null;if(!Mc(P,V.type))return S.concat(1).error('"'+P+`" comparisons are not supported for type '`+Ia(V.type)+"'.");var re=S.parse(m[2],2,gn);if(!re)return null;if(!Mc(P,re.type))return S.concat(2).error('"'+P+`" comparisons are not supported for type '`+Ia(re.type)+"'.");if(V.type.kind!==re.type.kind&&V.type.kind!=="value"&&re.type.kind!=="value")return S.error("Cannot compare types '"+Ia(V.type)+"' and '"+Ia(re.type)+"'.");u&&(V.type.kind==="value"&&re.type.kind!=="value"?V=new Za(re.type,[V]):V.type.kind!=="value"&&re.type.kind==="value"&&(re=new Za(V.type,[re])));var he=null;if(m.length===4){if(V.type.kind!=="string"&&re.type.kind!=="string"&&V.type.kind!=="value"&&re.type.kind!=="value")return S.error("Cannot use collator to compare non-string types.");if(!(he=S.parse(m[3],3,Mn)))return null}return new f(V,re,he)},f.prototype.evaluate=function(m){var S=this.lhs.evaluate(m),P=this.rhs.evaluate(m);if(u&&this.hasUntypedArgument){var V=Oi(S),re=Oi(P);if(V.kind!==re.kind||V.kind!=="string"&&V.kind!=="number")throw new Yi('Expected arguments for "'+e+'" to be (string, string) or (number, number), but found ('+V.kind+", "+re.kind+") instead.")}if(this.collator&&!u&&this.hasUntypedArgument){var he=Oi(S),_e=Oi(P);if(he.kind!=="string"||_e.kind!=="string")return t(m,S,P)}return this.collator?r(m,S,P,this.collator.evaluate(m)):t(m,S,P)},f.prototype.eachChild=function(m){m(this.lhs),m(this.rhs),this.collator&&m(this.collator)},f.prototype.outputDefined=function(){return!0},f.prototype.serialize=function(){var m=[e];return this.eachChild(function(S){m.push(S.serialize())}),m},f}()}Js.parse=function(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,gn),u=t.parse(e[2],2,tr);if(!r||!u)return null;if(!vi(r.type,[Ma(gn),rn,gn]))return t.error("Expected first argument to be of type array or string, but found "+Ia(r.type)+" instead");if(e.length===4){var f=t.parse(e[3],3,tr);return f?new Js(r.type,r,u,f):null}return new Js(r.type,r,u)},Js.prototype.evaluate=function(e){var t=this.input.evaluate(e),r=this.beginIndex.evaluate(e);if(!ya(t,["string","array"]))throw new Yi("Expected first argument to be of type array or string, but found "+Ia(Oi(t))+" instead.");if(this.endIndex){var u=this.endIndex.evaluate(e);return t.slice(r,u)}return t.slice(r)},Js.prototype.eachChild=function(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)},Js.prototype.outputDefined=function(){return!1},Js.prototype.serialize=function(){if(this.endIndex!=null&&this.endIndex!==void 0){var e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var Pc=pi("==",function(e,t,r){return t===r},hf),mc=pi("!=",function(e,t,r){return t!==r},function(e,t,r,u){return!hf(0,t,r,u)}),$c=pi("<",function(e,t,r){return t<r},function(e,t,r,u){return u.compare(t,r)<0}),gl=pi(">",function(e,t,r){return t>r},function(e,t,r,u){return u.compare(t,r)>0}),Jc=pi("<=",function(e,t,r){return t<=r},function(e,t,r,u){return u.compare(t,r)<=0}),$i=pi(">=",function(e,t,r){return t>=r},function(e,t,r,u){return u.compare(t,r)>=0}),Tu=function(t,r,u,f,m){this.type=rn,this.number=t,this.locale=r,this.currency=u,this.minFractionDigits=f,this.maxFractionDigits=m};Tu.parse=function(e,t){if(e.length!==3)return t.error("Expected two arguments.");var r=t.parse(e[1],1,tr);if(!r)return null;var u=e[2];if(typeof u!="object"||Array.isArray(u))return t.error("NumberFormat options argument must be an object.");var f=null;if(u.locale&&!(f=t.parse(u.locale,1,rn)))return null;var m=null;if(u.currency&&!(m=t.parse(u.currency,1,rn)))return null;var S=null;if(u["min-fraction-digits"]&&!(S=t.parse(u["min-fraction-digits"],1,tr)))return null;var P=null;return u["max-fraction-digits"]&&!(P=t.parse(u["max-fraction-digits"],1,tr))?null:new Tu(r,f,m,S,P)},Tu.prototype.evaluate=function(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))},Tu.prototype.eachChild=function(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)},Tu.prototype.outputDefined=function(){return!1},Tu.prototype.serialize=function(){var e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]};var yl=function(t){this.type=tr,this.input=t};yl.parse=function(e,t){if(e.length!==2)return t.error("Expected 1 argument, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1);return r?r.type.kind!=="array"&&r.type.kind!=="string"&&r.type.kind!=="value"?t.error("Expected argument of type string or array, but found "+Ia(r.type)+" instead."):new yl(r):null},yl.prototype.evaluate=function(e){var t=this.input.evaluate(e);if(typeof t=="string")return t.length;if(Array.isArray(t))return t.length;throw new Yi("Expected value to be of type string or array, but found "+Ia(Oi(t))+" instead.")},yl.prototype.eachChild=function(e){e(this.input)},yl.prototype.outputDefined=function(){return!1},yl.prototype.serialize=function(){var e=["length"];return this.eachChild(function(t){e.push(t.serialize())}),e};var os={"==":Pc,"!=":mc,">":gl,"<":$c,">=":$i,"<=":Jc,array:Za,at:vl,boolean:Za,case:ju,coalesce:$s,collator:Vt,format:oo,image:so,in:cu,"index-of":Eu,interpolate:gi,"interpolate-hcl":gi,"interpolate-lab":gi,length:yl,let:Ss,literal:ui,match:fu,number:Za,"number-format":Tu,object:Za,slice:Js,step:Ii,string:Za,"to-boolean":Qo,"to-color":Qo,"to-number":Qo,"to-string":Qo,var:Ys,within:Po};function Lc(e,t){var r=t[0],u=t[1],f=t[2],m=t[3];r=r.evaluate(e),u=u.evaluate(e),f=f.evaluate(e);var S=m?m.evaluate(e):1,P=Du(r,u,f,S);if(P)throw new Yi(P);return new ha(r/255*S,u/255*S,f/255*S,S)}function vc(e,t){return e in t}function Pl(e,t){var r=t[e];return r===void 0?null:r}function Ju(e){return{type:e}}function Rc(e){return{result:"success",value:e}}function hu(e){return{result:"error",value:e}}function _u(e){return e["property-type"]==="data-driven"||e["property-type"]==="cross-faded-data-driven"}function Qc(e){return!!e.expression&&e.expression.parameters.indexOf("zoom")>-1}function Yl(e){return!!e.expression&&e.expression.interpolated}function Si(e){return e instanceof Number?"number":e instanceof String?"string":e instanceof Boolean?"boolean":Array.isArray(e)?"array":e===null?"null":typeof e}function qc(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}function df(e){return e}function Kl(e,t,r){return e!==void 0?e:t!==void 0?t:r!==void 0?r:void 0}function Ic(e,t,r,u,f){return Kl(typeof r===f?u[r]:void 0,e.default,t.default)}function $l(e,t,r){if(Si(r)!=="number")return Kl(e.default,t.default);var u=e.stops.length;if(u===1)return e.stops[0][1];if(r<=e.stops[0][0])return e.stops[0][1];if(r>=e.stops[u-1][0])return e.stops[u-1][1];var f=Fs(e.stops.map(function(m){return m[0]}),r);return e.stops[f][1]}function Qu(e,t,r){var u=e.base!==void 0?e.base:1;if(Si(r)!=="number")return Kl(e.default,t.default);var f=e.stops.length;if(f===1)return e.stops[0][1];if(r<=e.stops[0][0])return e.stops[0][1];if(r>=e.stops[f-1][0])return e.stops[f-1][1];var m=Fs(e.stops.map(function(_e){return _e[0]}),r),S=function(_e,we,lt,Lt){var Ct=Lt-lt,$t=_e-lt;return Ct===0?0:we===1?$t/Ct:(Math.pow(we,$t)-1)/(Math.pow(we,Ct)-1)}(r,u,e.stops[m][0],e.stops[m+1][0]),P=e.stops[m][1],V=e.stops[m+1][1],re=_s[t.type]||df;if(e.colorSpace&&e.colorSpace!=="rgb"){var he=Ps[e.colorSpace];re=function(we,lt){return he.reverse(he.interpolate(he.forward(we),he.forward(lt),S))}}return typeof P.evaluate=="function"?{evaluate:function(){for(var we=[],lt=arguments.length;lt--;)we[lt]=arguments[lt];var Lt=P.evaluate.apply(void 0,we),Ct=V.evaluate.apply(void 0,we);if(Lt!==void 0&&Ct!==void 0)return re(Lt,Ct,S)}}:re(P,V,S)}function Fu(e,t,r){return t.type==="color"?r=ha.parse(r):t.type==="formatted"?r=Xi.fromString(r.toString()):t.type==="resolvedImage"?r=Xo.fromString(r.toString()):Si(r)===t.type||t.type==="enum"&&t.values[r]||(r=void 0),Kl(r,e.default,t.default)}ho.register(os,{error:[{kind:"error"},[rn],function(e,t){throw new Yi(t[0].evaluate(e))}],typeof:[rn,[gn],function(e,t){return Ia(Oi(t[0].evaluate(e)))}],"to-rgba":[Ma(tr,4),[En],function(e,t){return t[0].evaluate(e).toArray()}],rgb:[En,[tr,tr,tr],Lc],rgba:[En,[tr,tr,tr,tr],Lc],has:{type:dn,overloads:[[[rn],function(e,t){return vc(t[0].evaluate(e),e.properties())}],[[rn,bn],function(e,t){var r=t[1];return vc(t[0].evaluate(e),r.evaluate(e))}]]},get:{type:gn,overloads:[[[rn],function(e,t){return Pl(t[0].evaluate(e),e.properties())}],[[rn,bn],function(e,t){var r=t[1];return Pl(t[0].evaluate(e),r.evaluate(e))}]]},"feature-state":[gn,[rn],function(e,t){return Pl(t[0].evaluate(e),e.featureState||{})}],properties:[bn,[],function(e){return e.properties()}],"geometry-type":[rn,[],function(e){return e.geometryType()}],id:[gn,[],function(e){return e.id()}],zoom:[tr,[],function(e){return e.globals.zoom}],"heatmap-density":[tr,[],function(e){return e.globals.heatmapDensity||0}],"line-progress":[tr,[],function(e){return e.globals.lineProgress||0}],accumulated:[gn,[],function(e){return e.globals.accumulated===void 0?null:e.globals.accumulated}],"+":[tr,Ju(tr),function(e,t){for(var r=0,u=0,f=t;u<f.length;u+=1)r+=f[u].evaluate(e);return r}],"*":[tr,Ju(tr),function(e,t){for(var r=1,u=0,f=t;u<f.length;u+=1)r*=f[u].evaluate(e);return r}],"-":{type:tr,overloads:[[[tr,tr],function(e,t){var r=t[1];return t[0].evaluate(e)-r.evaluate(e)}],[[tr],function(e,t){return-t[0].evaluate(e)}]]},"/":[tr,[tr,tr],function(e,t){var r=t[1];return t[0].evaluate(e)/r.evaluate(e)}],"%":[tr,[tr,tr],function(e,t){var r=t[1];return t[0].evaluate(e)%r.evaluate(e)}],ln2:[tr,[],function(){return Math.LN2}],pi:[tr,[],function(){return Math.PI}],e:[tr,[],function(){return Math.E}],"^":[tr,[tr,tr],function(e,t){var r=t[1];return Math.pow(t[0].evaluate(e),r.evaluate(e))}],sqrt:[tr,[tr],function(e,t){return Math.sqrt(t[0].evaluate(e))}],log10:[tr,[tr],function(e,t){return Math.log(t[0].evaluate(e))/Math.LN10}],ln:[tr,[tr],function(e,t){return Math.log(t[0].evaluate(e))}],log2:[tr,[tr],function(e,t){return Math.log(t[0].evaluate(e))/Math.LN2}],sin:[tr,[tr],function(e,t){return Math.sin(t[0].evaluate(e))}],cos:[tr,[tr],function(e,t){return Math.cos(t[0].evaluate(e))}],tan:[tr,[tr],function(e,t){return Math.tan(t[0].evaluate(e))}],asin:[tr,[tr],function(e,t){return Math.asin(t[0].evaluate(e))}],acos:[tr,[tr],function(e,t){return Math.acos(t[0].evaluate(e))}],atan:[tr,[tr],function(e,t){return Math.atan(t[0].evaluate(e))}],min:[tr,Ju(tr),function(e,t){return Math.min.apply(Math,t.map(function(r){return r.evaluate(e)}))}],max:[tr,Ju(tr),function(e,t){return Math.max.apply(Math,t.map(function(r){return r.evaluate(e)}))}],abs:[tr,[tr],function(e,t){return Math.abs(t[0].evaluate(e))}],round:[tr,[tr],function(e,t){var r=t[0].evaluate(e);return r<0?-Math.round(-r):Math.round(r)}],floor:[tr,[tr],function(e,t){return Math.floor(t[0].evaluate(e))}],ceil:[tr,[tr],function(e,t){return Math.ceil(t[0].evaluate(e))}],"filter-==":[dn,[rn,gn],function(e,t){var r=t[0],u=t[1];return e.properties()[r.value]===u.value}],"filter-id-==":[dn,[gn],function(e,t){var r=t[0];return e.id()===r.value}],"filter-type-==":[dn,[rn],function(e,t){var r=t[0];return e.geometryType()===r.value}],"filter-<":[dn,[rn,gn],function(e,t){var r=t[0],u=t[1],f=e.properties()[r.value],m=u.value;return typeof f==typeof m&&f<m}],"filter-id-<":[dn,[gn],function(e,t){var r=t[0],u=e.id(),f=r.value;return typeof u==typeof f&&u<f}],"filter->":[dn,[rn,gn],function(e,t){var r=t[0],u=t[1],f=e.properties()[r.value],m=u.value;return typeof f==typeof m&&f>m}],"filter-id->":[dn,[gn],function(e,t){var r=t[0],u=e.id(),f=r.value;return typeof u==typeof f&&u>f}],"filter-<=":[dn,[rn,gn],function(e,t){var r=t[0],u=t[1],f=e.properties()[r.value],m=u.value;return typeof f==typeof m&&f<=m}],"filter-id-<=":[dn,[gn],function(e,t){var r=t[0],u=e.id(),f=r.value;return typeof u==typeof f&&u<=f}],"filter->=":[dn,[rn,gn],function(e,t){var r=t[0],u=t[1],f=e.properties()[r.value],m=u.value;return typeof f==typeof m&&f>=m}],"filter-id->=":[dn,[gn],function(e,t){var r=t[0],u=e.id(),f=r.value;return typeof u==typeof f&&u>=f}],"filter-has":[dn,[gn],function(e,t){return t[0].value in e.properties()}],"filter-has-id":[dn,[],function(e){return e.id()!==null&&e.id()!==void 0}],"filter-type-in":[dn,[Ma(rn)],function(e,t){return t[0].value.indexOf(e.geometryType())>=0}],"filter-id-in":[dn,[Ma(gn)],function(e,t){return t[0].value.indexOf(e.id())>=0}],"filter-in-small":[dn,[rn,Ma(gn)],function(e,t){var r=t[0];return t[1].value.indexOf(e.properties()[r.value])>=0}],"filter-in-large":[dn,[rn,Ma(gn)],function(e,t){var r=t[0],u=t[1];return function(f,m,S,P){for(;S<=P;){var V=S+P>>1;if(m[V]===f)return!0;m[V]>f?P=V-1:S=V+1}return!1}(e.properties()[r.value],u.value,0,u.value.length-1)}],all:{type:dn,overloads:[[[dn,dn],function(e,t){var r=t[1];return t[0].evaluate(e)&&r.evaluate(e)}],[Ju(dn),function(e,t){for(var r=0,u=t;r<u.length;r+=1)if(!u[r].evaluate(e))return!1;return!0}]]},any:{type:dn,overloads:[[[dn,dn],function(e,t){var r=t[1];return t[0].evaluate(e)||r.evaluate(e)}],[Ju(dn),function(e,t){for(var r=0,u=t;r<u.length;r+=1)if(u[r].evaluate(e))return!0;return!1}]]},"!":[dn,[dn],function(e,t){return!t[0].evaluate(e)}],"is-supported-script":[dn,[rn],function(e,t){var r=e.globals&&e.globals.isSupportedScript;return!r||r(t[0].evaluate(e))}],upcase:[rn,[rn],function(e,t){return t[0].evaluate(e).toUpperCase()}],downcase:[rn,[rn],function(e,t){return t[0].evaluate(e).toLowerCase()}],concat:[rn,Ju(gn),function(e,t){return t.map(function(r){return Jo(r.evaluate(e))}).join("")}],"resolved-locale":[rn,[Mn],function(e,t){return t[0].evaluate(e).resolvedLocale()}]});var bl=function(t,r){this.expression=t,this._warningHistory={},this._evaluator=new js,this._defaultValue=r?function(u){return u.type==="color"&&qc(u.default)?new ha(0,0,0,0):u.type==="color"?ha.parse(u.default)||null:u.default===void 0?null:u.default}(r):null,this._enumValues=r&&r.type==="enum"?r.values:null};function Lo(e){return Array.isArray(e)&&e.length>0&&typeof e[0]=="string"&&e[0]in os}function Jl(e,t){var r=new Ks(os,[],t?function(f){var m={color:En,string:rn,number:tr,enum:rn,boolean:dn,formatted:Ga,resolvedImage:ga};return f.type==="array"?Ma(m[f.value]||gn,f.length):m[f.type]}(t):void 0),u=r.parse(e,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return u?Rc(new bl(u,t)):hu(r.errors)}bl.prototype.evaluateWithoutErrorHandling=function(e,t,r,u,f,m){return this._evaluator.globals=e,this._evaluator.feature=t,this._evaluator.featureState=r,this._evaluator.canonical=u,this._evaluator.availableImages=f||null,this._evaluator.formattedSection=m,this.expression.evaluate(this._evaluator)},bl.prototype.evaluate=function(e,t,r,u,f,m){this._evaluator.globals=e,this._evaluator.feature=t||null,this._evaluator.featureState=r||null,this._evaluator.canonical=u,this._evaluator.availableImages=f||null,this._evaluator.formattedSection=m||null;try{var S=this.expression.evaluate(this._evaluator);if(S==null||typeof S=="number"&&S!=S)return this._defaultValue;if(this._enumValues&&!(S in this._enumValues))throw new Yi("Expected value to be one of "+Object.keys(this._enumValues).map(function(P){return JSON.stringify(P)}).join(", ")+", but found "+JSON.stringify(S)+" instead.");return S}catch(P){return this._warningHistory[P.message]||(this._warningHistory[P.message]=!0,typeof console!="undefined"&&console.warn(P.message)),this._defaultValue}};var Ll=function(t,r){this.kind=t,this._styleExpression=r,this.isStateDependent=t!=="constant"&&!_o(r.expression)};Ll.prototype.evaluateWithoutErrorHandling=function(e,t,r,u,f,m){return this._styleExpression.evaluateWithoutErrorHandling(e,t,r,u,f,m)},Ll.prototype.evaluate=function(e,t,r,u,f,m){return this._styleExpression.evaluate(e,t,r,u,f,m)};var Rl=function(t,r,u,f){this.kind=t,this.zoomStops=u,this._styleExpression=r,this.isStateDependent=t!=="camera"&&!_o(r.expression),this.interpolationType=f};function Dc(e,t){if((e=Jl(e,t)).result==="error")return e;var r=e.value.expression,u=ku(r);if(!u&&!_u(t))return hu([new Br("","data expressions not supported")]);var f=zi(r,["zoom"]);if(!f&&!Qc(t))return hu([new Br("","zoom expressions not supported")]);var m=function S(P){var V=null;if(P instanceof Ss)V=S(P.result);else if(P instanceof $s)for(var re=0,he=P.args;re<he.length&&!(V=S(he[re]));re+=1);else(P instanceof Ii||P instanceof gi)&&P.input instanceof ho&&P.input.name==="zoom"&&(V=P);return V instanceof Br||P.eachChild(function(_e){var we=S(_e);we instanceof Br?V=we:!V&&we?V=new Br("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):V&&we&&V!==we&&(V=new Br("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),V}(r);return m||f?m instanceof Br?hu([m]):m instanceof gi&&!Yl(t)?hu([new Br("",'"interpolate" expressions cannot be used with this property')]):Rc(m?new Rl(u?"camera":"composite",e.value,m.labels,m instanceof gi?m.interpolation:void 0):new Ll(u?"constant":"source",e.value)):hu([new Br("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}Rl.prototype.evaluateWithoutErrorHandling=function(e,t,r,u,f,m){return this._styleExpression.evaluateWithoutErrorHandling(e,t,r,u,f,m)},Rl.prototype.evaluate=function(e,t,r,u,f,m){return this._styleExpression.evaluate(e,t,r,u,f,m)},Rl.prototype.interpolationFactor=function(e,t,r){return this.interpolationType?gi.interpolationFactor(this.interpolationType,e,t,r):0};var xl=function(t,r){this._parameters=t,this._specification=r,Ur(this,function u(f,m){var S,P,V,re=m.type==="color",he=f.stops&&typeof f.stops[0][0]=="object",_e=he||!(he||f.property!==void 0),we=f.type||(Yl(m)?"exponential":"interval");if(re&&((f=Ur({},f)).stops&&(f.stops=f.stops.map(function(Yn){return[Yn[0],ha.parse(Yn[1])]})),f.default=ha.parse(f.default?f.default:m.default)),f.colorSpace&&f.colorSpace!=="rgb"&&!Ps[f.colorSpace])throw new Error("Unknown color space: "+f.colorSpace);if(we==="exponential")S=Qu;else if(we==="interval")S=$l;else if(we==="categorical"){S=Ic,P=Object.create(null);for(var lt=0,Lt=f.stops;lt<Lt.length;lt+=1){var Ct=Lt[lt];P[Ct[0]]=Ct[1]}V=typeof f.stops[0][0]}else{if(we!=="identity")throw new Error('Unknown function type "'+we+'"');S=Fu}if(he){for(var $t={},Xt=[],ir=0;ir<f.stops.length;ir++){var br=f.stops[ir],Sr=br[0].zoom;$t[Sr]===void 0&&($t[Sr]={zoom:Sr,type:f.type,property:f.property,default:f.default,stops:[]},Xt.push(Sr)),$t[Sr].stops.push([br[0].value,br[1]])}for(var Fr=[],Nr=0,mn=Xt;Nr<mn.length;Nr+=1){var hn=mn[Nr];Fr.push([$t[hn].zoom,u($t[hn],m)])}var Ln={name:"linear"};return{kind:"composite",interpolationType:Ln,interpolationFactor:gi.interpolationFactor.bind(void 0,Ln),zoomStops:Fr.map(function(Yn){return Yn[0]}),evaluate:function(Nn,_a){var fa=Nn.zoom;return Qu({stops:Fr,base:f.base},m,fa).evaluate(fa,_a)}}}if(_e){var Qn=we==="exponential"?{name:"exponential",base:f.base!==void 0?f.base:1}:null;return{kind:"camera",interpolationType:Qn,interpolationFactor:gi.interpolationFactor.bind(void 0,Qn),zoomStops:f.stops.map(function(Yn){return Yn[0]}),evaluate:function(Nn){return S(f,m,Nn.zoom,P,V)}}}return{kind:"source",evaluate:function(Nn,_a){var fa=_a&&_a.properties?_a.properties[f.property]:void 0;return fa===void 0?Kl(f.default,m.default):S(f,m,fa,P,V)}}}(this._parameters,this._specification))};function Qs(e){var t=e.key,r=e.value,u=e.valueSpec||{},f=e.objectElementValidators||{},m=e.style,S=e.styleSpec,P=[],V=Si(r);if(V!=="object")return[new Rt(t,r,"object expected, "+V+" found")];for(var re in r){var he=re.split(".")[0],_e=u[he]||u["*"],we=void 0;if(f[he])we=f[he];else if(u[he])we=kn;else if(f["*"])we=f["*"];else{if(!u["*"]){P.push(new Rt(t,r[re],'unknown property "'+re+'"'));continue}we=kn}P=P.concat(we({key:(t&&t+".")+re,value:r[re],valueSpec:_e,style:m,styleSpec:S,object:r,objectKey:re},r))}for(var lt in u)f[lt]||u[lt].required&&u[lt].default===void 0&&r[lt]===void 0&&P.push(new Rt(t,r,'missing required property "'+lt+'"'));return P}function eo(e){var t=e.value,r=e.valueSpec,u=e.style,f=e.styleSpec,m=e.key,S=e.arrayElementValidator||kn;if(Si(t)!=="array")return[new Rt(m,t,"array expected, "+Si(t)+" found")];if(r.length&&t.length!==r.length)return[new Rt(m,t,"array length "+r.length+" expected, length "+t.length+" found")];if(r["min-length"]&&t.length<r["min-length"])return[new Rt(m,t,"array length at least "+r["min-length"]+" expected, length "+t.length+" found")];var P={type:r.value,values:r.values};f.$version<7&&(P.function=r.function),Si(r.value)==="object"&&(P=r.value);for(var V=[],re=0;re<t.length;re++)V=V.concat(S({array:t,arrayIndex:re,value:t[re],valueSpec:P,style:u,styleSpec:f,key:m+"["+re+"]"}));return V}function pf(e){var t=e.key,r=e.value,u=e.valueSpec,f=Si(r);return f==="number"&&r!=r&&(f="NaN"),f!=="number"?[new Rt(t,r,"number expected, "+f+" found")]:"minimum"in u&&r<u.minimum?[new Rt(t,r,r+" is less than the minimum value "+u.minimum)]:"maximum"in u&&r>u.maximum?[new Rt(t,r,r+" is greater than the maximum value "+u.maximum)]:[]}function mf(e){var t,r,u,f=e.valueSpec,m=Gr(e.value.type),S={},P=m!=="categorical"&&e.value.property===void 0,V=!P,re=Si(e.value.stops)==="array"&&Si(e.value.stops[0])==="array"&&Si(e.value.stops[0][0])==="object",he=Qs({key:e.key,value:e.value,valueSpec:e.styleSpec.function,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{stops:function(Lt){if(m==="identity")return[new Rt(Lt.key,Lt.value,'identity function may not have a "stops" property')];var Ct=[],$t=Lt.value;return Ct=Ct.concat(eo({key:Lt.key,value:$t,valueSpec:Lt.valueSpec,style:Lt.style,styleSpec:Lt.styleSpec,arrayElementValidator:_e})),Si($t)==="array"&&$t.length===0&&Ct.push(new Rt(Lt.key,$t,"array must have at least one stop")),Ct},default:function(Lt){return kn({key:Lt.key,value:Lt.value,valueSpec:f,style:Lt.style,styleSpec:Lt.styleSpec})}}});return m==="identity"&&P&&he.push(new Rt(e.key,e.value,'missing required property "property"')),m==="identity"||e.value.stops||he.push(new Rt(e.key,e.value,'missing required property "stops"')),m==="exponential"&&e.valueSpec.expression&&!Yl(e.valueSpec)&&he.push(new Rt(e.key,e.value,"exponential functions not supported")),e.styleSpec.$version>=8&&(V&&!_u(e.valueSpec)?he.push(new Rt(e.key,e.value,"property functions not supported")):P&&!Qc(e.valueSpec)&&he.push(new Rt(e.key,e.value,"zoom functions not supported"))),m!=="categorical"&&!re||e.value.property!==void 0||he.push(new Rt(e.key,e.value,'"property" property is required')),he;function _e(lt){var Lt=[],Ct=lt.value,$t=lt.key;if(Si(Ct)!=="array")return[new Rt($t,Ct,"array expected, "+Si(Ct)+" found")];if(Ct.length!==2)return[new Rt($t,Ct,"array length 2 expected, length "+Ct.length+" found")];if(re){if(Si(Ct[0])!=="object")return[new Rt($t,Ct,"object expected, "+Si(Ct[0])+" found")];if(Ct[0].zoom===void 0)return[new Rt($t,Ct,"object stop key must have zoom")];if(Ct[0].value===void 0)return[new Rt($t,Ct,"object stop key must have value")];if(u&&u>Gr(Ct[0].zoom))return[new Rt($t,Ct[0].zoom,"stop zoom values must appear in ascending order")];Gr(Ct[0].zoom)!==u&&(u=Gr(Ct[0].zoom),r=void 0,S={}),Lt=Lt.concat(Qs({key:$t+"[0]",value:Ct[0],valueSpec:{zoom:{}},style:lt.style,styleSpec:lt.styleSpec,objectElementValidators:{zoom:pf,value:we}}))}else Lt=Lt.concat(we({key:$t+"[0]",value:Ct[0],valueSpec:{},style:lt.style,styleSpec:lt.styleSpec},Ct));return Lo(cr(Ct[1]))?Lt.concat([new Rt($t+"[1]",Ct[1],"expressions are not allowed in function stops.")]):Lt.concat(kn({key:$t+"[1]",value:Ct[1],valueSpec:f,style:lt.style,styleSpec:lt.styleSpec}))}function we(lt,Lt){var Ct=Si(lt.value),$t=Gr(lt.value),Xt=lt.value!==null?lt.value:Lt;if(t){if(Ct!==t)return[new Rt(lt.key,Xt,Ct+" stop domain type must match previous stop domain type "+t)]}else t=Ct;if(Ct!=="number"&&Ct!=="string"&&Ct!=="boolean")return[new Rt(lt.key,Xt,"stop domain value must be a number, string, or boolean")];if(Ct!=="number"&&m!=="categorical"){var ir="number expected, "+Ct+" found";return _u(f)&&m===void 0&&(ir+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Rt(lt.key,Xt,ir)]}return m!=="categorical"||Ct!=="number"||isFinite($t)&&Math.floor($t)===$t?m!=="categorical"&&Ct==="number"&&r!==void 0&&$t<r?[new Rt(lt.key,Xt,"stop domain values must appear in ascending order")]:(r=$t,m==="categorical"&&$t in S?[new Rt(lt.key,Xt,"stop domain values must be unique")]:(S[$t]=!0,[])):[new Rt(lt.key,Xt,"integer expected, found "+$t)]}}function El(e){var t=(e.expressionContext==="property"?Dc:Jl)(cr(e.value),e.valueSpec);if(t.result==="error")return t.value.map(function(u){return new Rt(""+e.key+u.key,e.value,u.message)});var r=t.value.expression||t.value._styleExpression.expression;if(e.expressionContext==="property"&&e.propertyKey==="text-font"&&!r.outputDefined())return[new Rt(e.key,e.value,'Invalid data expression for "'+e.propertyKey+'". Output values must be contained as literals within the expression.')];if(e.expressionContext==="property"&&e.propertyType==="layout"&&!_o(r))return[new Rt(e.key,e.value,'"feature-state" data expressions are not supported with layout properties.')];if(e.expressionContext==="filter"&&!_o(r))return[new Rt(e.key,e.value,'"feature-state" data expressions are not supported with filters.')];if(e.expressionContext&&e.expressionContext.indexOf("cluster")===0){if(!zi(r,["zoom","feature-state"]))return[new Rt(e.key,e.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(e.expressionContext==="cluster-initial"&&!ku(r))return[new Rt(e.key,e.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Ql(e){var t=e.key,r=e.value,u=e.valueSpec,f=[];return Array.isArray(u.values)?u.values.indexOf(Gr(r))===-1&&f.push(new Rt(t,r,"expected one of ["+u.values.join(", ")+"], "+JSON.stringify(r)+" found")):Object.keys(u.values).indexOf(Gr(r))===-1&&f.push(new Rt(t,r,"expected one of ["+Object.keys(u.values).join(", ")+"], "+JSON.stringify(r)+" found")),f}function qu(e){if(e===!0||e===!1)return!0;if(!Array.isArray(e)||e.length===0)return!1;switch(e[0]){case"has":return e.length>=2&&e[1]!=="$id"&&e[1]!=="$type";case"in":return e.length>=3&&(typeof e[1]!="string"||Array.isArray(e[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return e.length!==3||Array.isArray(e[1])||Array.isArray(e[2]);case"any":case"all":for(var t=0,r=e.slice(1);t<r.length;t+=1){var u=r[t];if(!qu(u)&&typeof u!="boolean")return!1}return!0;default:return!0}}xl.deserialize=function(e){return new xl(e._parameters,e._specification)},xl.serialize=function(e){return{_parameters:e._parameters,_specification:e._specification}};var Il={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function gc(e){if(e==null)return{filter:function(){return!0},needGeometry:!1};qu(e)||(e=el(e));var t=Jl(e,Il);if(t.result==="error")throw new Error(t.value.map(function(r){return r.key+": "+r.message}).join(", "));return{filter:function(u,f,m){return t.value.evaluate(u,f,{},m)},needGeometry:function r(u){if(!Array.isArray(u))return!1;if(u[0]==="within")return!0;for(var f=1;f<u.length;f++)if(r(u[f]))return!0;return!1}(e)}}function yc(e,t){return e<t?-1:e>t?1:0}function el(e){if(!e)return!0;var t,r=e[0];return e.length<=1?r!=="any":r==="=="?ef(e[1],e[2],"=="):r==="!="?Tl(ef(e[1],e[2],"==")):r==="<"||r===">"||r==="<="||r===">="?ef(e[1],e[2],r):r==="any"?(t=e.slice(1),["any"].concat(t.map(el))):r==="all"?["all"].concat(e.slice(1).map(el)):r==="none"?["all"].concat(e.slice(1).map(el).map(Tl)):r==="in"?tl(e[1],e.slice(2)):r==="!in"?Tl(tl(e[1],e.slice(2))):r==="has"?qs(e[1]):r==="!has"?Tl(qs(e[1])):r!=="within"||e}function ef(e,t,r){switch(e){case"$type":return["filter-type-"+r,t];case"$id":return["filter-id-"+r,t];default:return["filter-"+r,e,t]}}function tl(e,t){if(t.length===0)return!1;switch(e){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(function(r){return typeof r!=typeof t[0]})?["filter-in-large",e,["literal",t.sort(yc)]]:["filter-in-small",e,["literal",t]]}}function qs(e){switch(e){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",e]}}function Tl(e){return["!",e]}function ql(e){return qu(cr(e.value))?El(Ur({},e,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function t(r){var u=r.value,f=r.key;if(Si(u)!=="array")return[new Rt(f,u,"array expected, "+Si(u)+" found")];var m,S=r.styleSpec,P=[];if(u.length<1)return[new Rt(f,u,"filter array must have at least 1 element")];switch(P=P.concat(Ql({key:f+"[0]",value:u[0],valueSpec:S.filter_operator,style:r.style,styleSpec:r.styleSpec})),Gr(u[0])){case"<":case"<=":case">":case">=":u.length>=2&&Gr(u[1])==="$type"&&P.push(new Rt(f,u,'"$type" cannot be use with operator "'+u[0]+'"'));case"==":case"!=":u.length!==3&&P.push(new Rt(f,u,'filter array for operator "'+u[0]+'" must have 3 elements'));case"in":case"!in":u.length>=2&&(m=Si(u[1]))!=="string"&&P.push(new Rt(f+"[1]",u[1],"string expected, "+m+" found"));for(var V=2;V<u.length;V++)m=Si(u[V]),Gr(u[1])==="$type"?P=P.concat(Ql({key:f+"["+V+"]",value:u[V],valueSpec:S.geometry_type,style:r.style,styleSpec:r.styleSpec})):m!=="string"&&m!=="number"&&m!=="boolean"&&P.push(new Rt(f+"["+V+"]",u[V],"string, number, or boolean expected, "+m+" found"));break;case"any":case"all":case"none":for(var re=1;re<u.length;re++)P=P.concat(t({key:f+"["+re+"]",value:u[re],style:r.style,styleSpec:r.styleSpec}));break;case"has":case"!has":m=Si(u[1]),u.length!==2?P.push(new Rt(f,u,'filter array for "'+u[0]+'" operator must have 2 elements')):m!=="string"&&P.push(new Rt(f+"[1]",u[1],"string expected, "+m+" found"));break;case"within":m=Si(u[1]),u.length!==2?P.push(new Rt(f,u,'filter array for "'+u[0]+'" operator must have 2 elements')):m!=="object"&&P.push(new Rt(f+"[1]",u[1],"object expected, "+m+" found"))}return P}(e)}function Nc(e,t){var r=e.key,u=e.style,f=e.styleSpec,m=e.value,S=e.objectKey,P=f[t+"_"+e.layerType];if(!P)return[];var V=S.match(/^(.*)-transition$/);if(t==="paint"&&V&&P[V[1]]&&P[V[1]].transition)return kn({key:r,value:m,valueSpec:f.transition,style:u,styleSpec:f});var re,he=e.valueSpec||P[S];if(!he)return[new Rt(r,m,'unknown property "'+S+'"')];if(Si(m)==="string"&&_u(he)&&!he.tokens&&(re=/^{([^}]+)}$/.exec(m)))return[new Rt(r,m,'"'+S+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(re[1])+" }`.")];var _e=[];return e.layerType==="symbol"&&(S==="text-field"&&u&&!u.glyphs&&_e.push(new Rt(r,m,'use of "text-field" requires a style "glyphs" property')),S==="text-font"&&qc(cr(m))&&Gr(m.type)==="identity"&&_e.push(new Rt(r,m,'"text-font" does not support identity functions'))),_e.concat(kn({key:e.key,value:m,valueSpec:he,style:u,styleSpec:f,expressionContext:"property",propertyType:t,propertyKey:S}))}function tf(e){return Nc(e,"paint")}function zs(e){return Nc(e,"layout")}function vf(e){var t=[],r=e.value,u=e.key,f=e.style,m=e.styleSpec;r.type||r.ref||t.push(new Rt(u,r,'either "type" or "ref" is required'));var S,P=Gr(r.type),V=Gr(r.ref);if(r.id)for(var re=Gr(r.id),he=0;he<e.arrayIndex;he++){var _e=f.layers[he];Gr(_e.id)===re&&t.push(new Rt(u,r.id,'duplicate layer id "'+r.id+'", previously used at line '+_e.id.__line__))}if("ref"in r)["type","source","source-layer","filter","layout"].forEach(function(Lt){Lt in r&&t.push(new Rt(u,r[Lt],'"'+Lt+'" is prohibited for ref layers'))}),f.layers.forEach(function(Lt){Gr(Lt.id)===V&&(S=Lt)}),S?S.ref?t.push(new Rt(u,r.ref,"ref cannot reference another ref layer")):P=Gr(S.type):t.push(new Rt(u,r.ref,'ref layer "'+V+'" not found'));else if(P!=="background")if(r.source){var we=f.sources&&f.sources[r.source],lt=we&&Gr(we.type);we?lt==="vector"&&P==="raster"?t.push(new Rt(u,r.source,'layer "'+r.id+'" requires a raster source')):lt==="raster"&&P!=="raster"?t.push(new Rt(u,r.source,'layer "'+r.id+'" requires a vector source')):lt!=="vector"||r["source-layer"]?lt==="raster-dem"&&P!=="hillshade"?t.push(new Rt(u,r.source,"raster-dem source can only be used with layer type 'hillshade'.")):P!=="line"||!r.paint||!r.paint["line-gradient"]||lt==="geojson"&&we.lineMetrics||t.push(new Rt(u,r,'layer "'+r.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):t.push(new Rt(u,r,'layer "'+r.id+'" must specify a "source-layer"')):t.push(new Rt(u,r.source,'source "'+r.source+'" not found'))}else t.push(new Rt(u,r,'missing required property "source"'));return t=t.concat(Qs({key:u,value:r,valueSpec:m.layer,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return kn({key:u+".type",value:r.type,valueSpec:m.layer.type,style:e.style,styleSpec:e.styleSpec,object:r,objectKey:"type"})},filter:ql,layout:function(Ct){return Qs({layer:r,key:Ct.key,value:Ct.value,style:Ct.style,styleSpec:Ct.styleSpec,objectElementValidators:{"*":function(Xt){return zs(Ur({layerType:P},Xt))}}})},paint:function(Ct){return Qs({layer:r,key:Ct.key,value:Ct.value,style:Ct.style,styleSpec:Ct.styleSpec,objectElementValidators:{"*":function(Xt){return tf(Ur({layerType:P},Xt))}}})}}}))}function rl(e){var t=e.value,r=e.key,u=Si(t);return u!=="string"?[new Rt(r,t,"string expected, "+u+" found")]:[]}var Pi={promoteId:function(t){var r=t.key,u=t.value;if(Si(u)==="string")return rl({key:r,value:u});var f=[];for(var m in u)f.push.apply(f,rl({key:r+"."+m,value:u[m]}));return f}};function nl(e){var t=e.value,r=e.key,u=e.styleSpec,f=e.style;if(!t.type)return[new Rt(r,t,'"type" is required')];var m,S=Gr(t.type);switch(S){case"vector":case"raster":case"raster-dem":return Qs({key:r,value:t,valueSpec:u["source_"+S.replace("-","_")],style:e.style,styleSpec:u,objectElementValidators:Pi});case"geojson":if(m=Qs({key:r,value:t,valueSpec:u.source_geojson,style:f,styleSpec:u,objectElementValidators:Pi}),t.cluster)for(var P in t.clusterProperties){var V=t.clusterProperties[P],re=V[0],he=typeof re=="string"?[re,["accumulated"],["get",P]]:re;m.push.apply(m,El({key:r+"."+P+".map",value:V[1],expressionContext:"cluster-map"})),m.push.apply(m,El({key:r+"."+P+".reduce",value:he,expressionContext:"cluster-reduce"}))}return m;case"video":return Qs({key:r,value:t,valueSpec:u.source_video,style:f,styleSpec:u});case"image":return Qs({key:r,value:t,valueSpec:u.source_image,style:f,styleSpec:u});case"canvas":return[new Rt(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Ql({key:r+".type",value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:f,styleSpec:u})}}function zu(e){var t=e.value,r=e.styleSpec,u=r.light,f=e.style,m=[],S=Si(t);if(t===void 0)return m;if(S!=="object")return m.concat([new Rt("light",t,"object expected, "+S+" found")]);for(var P in t){var V=P.match(/^(.*)-transition$/);m=m.concat(V&&u[V[1]]&&u[V[1]].transition?kn({key:P,value:t[P],valueSpec:r.transition,style:f,styleSpec:r}):u[P]?kn({key:P,value:t[P],valueSpec:u[P],style:f,styleSpec:r}):[new Rt(P,t[P],'unknown property "'+P+'"')])}return m}var fi={"*":function(){return[]},array:eo,boolean:function(t){var r=t.value,u=t.key,f=Si(r);return f!=="boolean"?[new Rt(u,r,"boolean expected, "+f+" found")]:[]},number:pf,color:function(t){var r=t.key,u=t.value,f=Si(u);return f!=="string"?[new Rt(r,u,"color expected, "+f+" found")]:ba(u)===null?[new Rt(r,u,'color expected, "'+u+'" found')]:[]},constants:lr,enum:Ql,filter:ql,function:mf,layer:vf,object:Qs,source:nl,light:zu,string:rl,formatted:function(t){return rl(t).length===0?[]:El(t)},resolvedImage:function(t){return rl(t).length===0?[]:El(t)}};function kn(e){var t=e.value,r=e.valueSpec,u=e.styleSpec;return r.expression&&qc(Gr(t))?mf(e):r.expression&&Lo(cr(t))?El(e):r.type&&fi[r.type]?fi[r.type](e):Qs(Ur({},e,{valueSpec:r.type?u[r.type]:r}))}function Li(e){var t=e.value,r=e.key,u=rl(e);return u.length||(t.indexOf("{fontstack}")===-1&&u.push(new Rt(r,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&u.push(new Rt(r,t,'"glyphs" url must include a "{range}" token'))),u}function Ls(e,t){t===void 0&&(t=Ze);var r=[];return r=r.concat(kn({key:"",value:e,valueSpec:t.$root,styleSpec:t,style:e,objectElementValidators:{glyphs:Li,"*":function(){return[]}}})),e.constants&&(r=r.concat(lr({key:"constants",value:e.constants,style:e,styleSpec:t}))),Dl(r)}function Dl(e){return[].concat(e).sort(function(t,r){return t.line-r.line})}function Uu(e){return function(){for(var t=[],r=arguments.length;r--;)t[r]=arguments[r];return Dl(e.apply(this,t))}}Ls.source=Uu(nl),Ls.light=Uu(zu),Ls.layer=Uu(vf),Ls.filter=Uu(ql),Ls.paintProperty=Uu(tf),Ls.layoutProperty=Uu(zs);var al=Ls,gf=al.light,ss=al.paintProperty,_l=al.layoutProperty;function il(e,t){var r=!1;if(t&&t.length)for(var u=0,f=t;u<f.length;u+=1)e.fire(new Ot(new Error(f[u].message))),r=!0;return r}var ol=Ui;function Ui(e,t,r){var u=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;var f=new Int32Array(this.arrayBuffer);e=f[0],this.d=(t=f[1])+2*(r=f[2]);for(var m=0;m<this.d*this.d;m++){var S=f[3+m],P=f[3+m+1];u.push(S===P?null:f.subarray(S,P))}var V=f[3+u.length+1];this.keys=f.subarray(f[3+u.length],V),this.bboxes=f.subarray(V),this.insert=this._insertReadonly}else{this.d=t+2*r;for(var re=0;re<this.d*this.d;re++)u.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=e,this.padding=r,this.scale=t/e,this.uid=0;var he=r/t*e;this.min=-he,this.max=e+he}Ui.prototype.insert=function(e,t,r,u,f){this._forEachCell(t,r,u,f,this._insertCell,this.uid++),this.keys.push(e),this.bboxes.push(t),this.bboxes.push(r),this.bboxes.push(u),this.bboxes.push(f)},Ui.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Ui.prototype._insertCell=function(e,t,r,u,f,m){this.cells[f].push(m)},Ui.prototype.query=function(e,t,r,u,f){var m=this.min,S=this.max;if(e<=m&&t<=m&&S<=r&&S<=u&&!f)return Array.prototype.slice.call(this.keys);var P=[];return this._forEachCell(e,t,r,u,this._queryCell,P,{},f),P},Ui.prototype._queryCell=function(e,t,r,u,f,m,S,P){var V=this.cells[f];if(V!==null)for(var re=this.keys,he=this.bboxes,_e=0;_e<V.length;_e++){var we=V[_e];if(S[we]===void 0){var lt=4*we;(P?P(he[lt+0],he[lt+1],he[lt+2],he[lt+3]):e<=he[lt+2]&&t<=he[lt+3]&&r>=he[lt+0]&&u>=he[lt+1])?(S[we]=!0,m.push(re[we])):S[we]=!1}}},Ui.prototype._forEachCell=function(e,t,r,u,f,m,S,P){for(var V=this._convertToCellCoord(e),re=this._convertToCellCoord(t),he=this._convertToCellCoord(r),_e=this._convertToCellCoord(u),we=V;we<=he;we++)for(var lt=re;lt<=_e;lt++){var Lt=this.d*lt+we;if((!P||P(this._convertFromCellCoord(we),this._convertFromCellCoord(lt),this._convertFromCellCoord(we+1),this._convertFromCellCoord(lt+1)))&&f.call(this,e,t,r,u,Lt,m,S,P))return}},Ui.prototype._convertFromCellCoord=function(e){return(e-this.padding)/this.scale},Ui.prototype._convertToCellCoord=function(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))},Ui.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var e=this.cells,t=3+this.cells.length+1+1,r=0,u=0;u<this.cells.length;u++)r+=this.cells[u].length;var f=new Int32Array(t+r+this.keys.length+this.bboxes.length);f[0]=this.extent,f[1]=this.n,f[2]=this.padding;for(var m=t,S=0;S<e.length;S++){var P=e[S];f[3+S]=m,f.set(P,m),m+=P.length}return f[3+e.length]=m,f.set(this.keys,m),f[3+e.length+1]=m+=this.keys.length,f.set(this.bboxes,m),m+=this.bboxes.length,f.buffer};var As=Y.ImageData,Nl=Y.ImageBitmap,to={};function Rn(e,t,r){r===void 0&&(r={}),Object.defineProperty(t,"_classRegistryKey",{value:e,writeable:!1}),to[e]={klass:t,omit:r.omit||[],shallow:r.shallow||[]}}for(var Us in Rn("Object",Object),ol.serialize=function(e,t){var r=e.toArrayBuffer();return t&&t.push(r),{buffer:r}},ol.deserialize=function(e){return new ol(e.buffer)},Rn("Grid",ol),Rn("Color",ha),Rn("Error",Error),Rn("ResolvedImage",Xo),Rn("StylePropertyFunction",xl),Rn("StyleExpression",bl,{omit:["_evaluator"]}),Rn("ZoomDependentExpression",Rl),Rn("ZoomConstantExpression",Ll),Rn("CompoundExpression",ho,{omit:["_evaluate"]}),os)os[Us]._classRegistryKey||Rn("Expression_"+Us,os[Us]);function ni(e){return e&&typeof ArrayBuffer!="undefined"&&(e instanceof ArrayBuffer||e.constructor&&e.constructor.name==="ArrayBuffer")}function kl(e){return Nl&&e instanceof Nl}function du(e,t){if(e==null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp)return e;if(ni(e)||kl(e))return t&&t.push(e),e;if(ArrayBuffer.isView(e)){var r=e;return t&&t.push(r.buffer),r}if(e instanceof As)return t&&t.push(e.data.buffer),e;if(Array.isArray(e)){for(var u=[],f=0,m=e;f<m.length;f+=1)u.push(du(m[f],t));return u}if(typeof e=="object"){var S=e.constructor,P=S._classRegistryKey;if(!P)throw new Error("can't serialize object of unregistered class");var V=S.serialize?S.serialize(e,t):{};if(!S.serialize){for(var re in e)if(e.hasOwnProperty(re)&&!(to[P].omit.indexOf(re)>=0)){var he=e[re];V[re]=to[P].shallow.indexOf(re)>=0?he:du(he,t)}e instanceof Error&&(V.message=e.message)}if(V.$name)throw new Error("$name property is reserved for worker serialization logic.");return P!=="Object"&&(V.$name=P),V}throw new Error("can't serialize object of type "+typeof e)}function Bs(e){if(e==null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||ni(e)||kl(e)||ArrayBuffer.isView(e)||e instanceof As)return e;if(Array.isArray(e))return e.map(Bs);if(typeof e=="object"){var t=e.$name||"Object",r=to[t].klass;if(!r)throw new Error("can't deserialize unregistered class "+t);if(r.deserialize)return r.deserialize(e);for(var u=Object.create(r.prototype),f=0,m=Object.keys(e);f<m.length;f+=1){var S=m[f];if(S!=="$name"){var P=e[S];u[S]=to[t].shallow.indexOf(S)>=0?P:Bs(P)}}return u}throw new Error("can't deserialize object of type "+typeof e)}var sl=function(){this.first=!0};sl.prototype.update=function(e,t){var r=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=r,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=r,!0):(this.lastFloorZoom>r?(this.lastIntegerZoom=r+1,this.lastIntegerZoomTime=t):this.lastFloorZoom<r&&(this.lastIntegerZoom=r,this.lastIntegerZoomTime=t),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=r,!0))};var tn={"Latin-1 Supplement":function(t){return t>=128&&t<=255},Arabic:function(t){return t>=1536&&t<=1791},"Arabic Supplement":function(t){return t>=1872&&t<=1919},"Arabic Extended-A":function(t){return t>=2208&&t<=2303},"Hangul Jamo":function(t){return t>=4352&&t<=4607},"Unified Canadian Aboriginal Syllabics":function(t){return t>=5120&&t<=5759},Khmer:function(t){return t>=6016&&t<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(t){return t>=6320&&t<=6399},"General Punctuation":function(t){return t>=8192&&t<=8303},"Letterlike Symbols":function(t){return t>=8448&&t<=8527},"Number Forms":function(t){return t>=8528&&t<=8591},"Miscellaneous Technical":function(t){return t>=8960&&t<=9215},"Control Pictures":function(t){return t>=9216&&t<=9279},"Optical Character Recognition":function(t){return t>=9280&&t<=9311},"Enclosed Alphanumerics":function(t){return t>=9312&&t<=9471},"Geometric Shapes":function(t){return t>=9632&&t<=9727},"Miscellaneous Symbols":function(t){return t>=9728&&t<=9983},"Miscellaneous Symbols and Arrows":function(t){return t>=11008&&t<=11263},"CJK Radicals Supplement":function(t){return t>=11904&&t<=12031},"Kangxi Radicals":function(t){return t>=12032&&t<=12255},"Ideographic Description Characters":function(t){return t>=12272&&t<=12287},"CJK Symbols and Punctuation":function(t){return t>=12288&&t<=12351},Hiragana:function(t){return t>=12352&&t<=12447},Katakana:function(t){return t>=12448&&t<=12543},Bopomofo:function(t){return t>=12544&&t<=12591},"Hangul Compatibility Jamo":function(t){return t>=12592&&t<=12687},Kanbun:function(t){return t>=12688&&t<=12703},"Bopomofo Extended":function(t){return t>=12704&&t<=12735},"CJK Strokes":function(t){return t>=12736&&t<=12783},"Katakana Phonetic Extensions":function(t){return t>=12784&&t<=12799},"Enclosed CJK Letters and Months":function(t){return t>=12800&&t<=13055},"CJK Compatibility":function(t){return t>=13056&&t<=13311},"CJK Unified Ideographs Extension A":function(t){return t>=13312&&t<=19903},"Yijing Hexagram Symbols":function(t){return t>=19904&&t<=19967},"CJK Unified Ideographs":function(t){return t>=19968&&t<=40959},"Yi Syllables":function(t){return t>=40960&&t<=42127},"Yi Radicals":function(t){return t>=42128&&t<=42191},"Hangul Jamo Extended-A":function(t){return t>=43360&&t<=43391},"Hangul Syllables":function(t){return t>=44032&&t<=55215},"Hangul Jamo Extended-B":function(t){return t>=55216&&t<=55295},"Private Use Area":function(t){return t>=57344&&t<=63743},"CJK Compatibility Ideographs":function(t){return t>=63744&&t<=64255},"Arabic Presentation Forms-A":function(t){return t>=64336&&t<=65023},"Vertical Forms":function(t){return t>=65040&&t<=65055},"CJK Compatibility Forms":function(t){return t>=65072&&t<=65103},"Small Form Variants":function(t){return t>=65104&&t<=65135},"Arabic Presentation Forms-B":function(t){return t>=65136&&t<=65279},"Halfwidth and Fullwidth Forms":function(t){return t>=65280&&t<=65519}};function bc(e){for(var t=0,r=e;t<r.length;t+=1)if(us(r[t].charCodeAt(0)))return!0;return!1}function us(e){return!(e!==746&&e!==747&&(e<4352||!(tn["Bopomofo Extended"](e)||tn.Bopomofo(e)||tn["CJK Compatibility Forms"](e)&&!(e>=65097&&e<=65103)||tn["CJK Compatibility Ideographs"](e)||tn["CJK Compatibility"](e)||tn["CJK Radicals Supplement"](e)||tn["CJK Strokes"](e)||!(!tn["CJK Symbols and Punctuation"](e)||e>=12296&&e<=12305||e>=12308&&e<=12319||e===12336)||tn["CJK Unified Ideographs Extension A"](e)||tn["CJK Unified Ideographs"](e)||tn["Enclosed CJK Letters and Months"](e)||tn["Hangul Compatibility Jamo"](e)||tn["Hangul Jamo Extended-A"](e)||tn["Hangul Jamo Extended-B"](e)||tn["Hangul Jamo"](e)||tn["Hangul Syllables"](e)||tn.Hiragana(e)||tn["Ideographic Description Characters"](e)||tn.Kanbun(e)||tn["Kangxi Radicals"](e)||tn["Katakana Phonetic Extensions"](e)||tn.Katakana(e)&&e!==12540||!(!tn["Halfwidth and Fullwidth Forms"](e)||e===65288||e===65289||e===65293||e>=65306&&e<=65310||e===65339||e===65341||e===65343||e>=65371&&e<=65503||e===65507||e>=65512&&e<=65519)||!(!tn["Small Form Variants"](e)||e>=65112&&e<=65118||e>=65123&&e<=65126)||tn["Unified Canadian Aboriginal Syllabics"](e)||tn["Unified Canadian Aboriginal Syllabics Extended"](e)||tn["Vertical Forms"](e)||tn["Yijing Hexagram Symbols"](e)||tn["Yi Syllables"](e)||tn["Yi Radicals"](e))))}function ro(e){return!(us(e)||function(t){return!!(tn["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||tn["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||tn["Letterlike Symbols"](t)||tn["Number Forms"](t)||tn["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||tn["Control Pictures"](t)&&t!==9251||tn["Optical Character Recognition"](t)||tn["Enclosed Alphanumerics"](t)||tn["Geometric Shapes"](t)||tn["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||tn["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||tn["CJK Symbols and Punctuation"](t)||tn.Katakana(t)||tn["Private Use Area"](t)||tn["CJK Compatibility Forms"](t)||tn["Small Form Variants"](t)||tn["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(e))}function qo(e){return e>=1424&&e<=2303||tn["Arabic Presentation Forms-A"](e)||tn["Arabic Presentation Forms-B"](e)}function Rs(e,t){return!(!t&&qo(e)||e>=2304&&e<=3583||e>=3840&&e<=4255||tn.Khmer(e))}function jl(e){for(var t=0,r=e;t<r.length;t+=1)if(qo(r[t].charCodeAt(0)))return!0;return!1}var kc=null,Vs="unavailable",Su=null,Fl=function(t){t&&typeof t=="string"&&t.indexOf("NetworkError")>-1&&(Vs="error"),kc&&kc(t)};function zl(){rf.fire(new ut("pluginStateChange",{pluginStatus:Vs,pluginURL:Su}))}var rf=new Bt,jc=function(){return Vs},Ro=function(){if(Vs!=="deferred"||!Su)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Vs="loading",zl(),Su&&Kn({url:Su},function(t){t?Fl(t):(Vs="loaded",zl())})},ls={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return Vs==="loaded"||ls.applyArabicShaping!=null},isLoading:function(){return Vs==="loading"},setState:function(t){Vs=t.pluginStatus,Su=t.pluginURL},isParsed:function(){return ls.applyArabicShaping!=null&&ls.processBidirectionalText!=null&&ls.processStyledBidirectionalText!=null},getPluginURL:function(){return Su}},Pa=function(t,r){this.zoom=t,r?(this.now=r.now,this.fadeDuration=r.fadeDuration,this.zoomHistory=r.zoomHistory,this.transition=r.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new sl,this.transition={})};Pa.prototype.isSupportedScript=function(e){return function(t,r){for(var u=0,f=t;u<f.length;u+=1)if(!Rs(f[u].charCodeAt(0),r))return!1;return!0}(e,ls.isLoaded())},Pa.prototype.crossFadingFactor=function(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},Pa.prototype.getCrossfadeParameters=function(){var e=this.zoom,t=e-Math.floor(e),r=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:t+(1-t)*r}:{fromScale:.5,toScale:1,t:1-(1-r)*t}};var eu=function(t,r){this.property=t,this.value=r,this.expression=function(u,f){if(qc(u))return new xl(u,f);if(Lo(u)){var m=Dc(u,f);if(m.result==="error")throw new Error(m.value.map(function(P){return P.key+": "+P.message}).join(", "));return m.value}var S=u;return typeof u=="string"&&f.type==="color"&&(S=ha.parse(u)),{kind:"constant",evaluate:function(){return S}}}(r===void 0?t.specification.default:r,t.specification)};eu.prototype.isDataDriven=function(){return this.expression.kind==="source"||this.expression.kind==="composite"},eu.prototype.possiblyEvaluate=function(e,t,r){return this.property.possiblyEvaluate(this,e,t,r)};var Io=function(t){this.property=t,this.value=new eu(t,void 0)};Io.prototype.transitioned=function(e,t){return new Sl(this.property,this.value,t,Le({},e.transition,this.transition),e.now)},Io.prototype.untransitioned=function(){return new Sl(this.property,this.value,null,{},0)};var So=function(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)};So.prototype.getValue=function(e){return Ve(this._values[e].value.value)},So.prototype.setValue=function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new Io(this._values[e].property)),this._values[e].value=new eu(this._values[e].property,t===null?void 0:Ve(t))},So.prototype.getTransition=function(e){return Ve(this._values[e].transition)},So.prototype.setTransition=function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new Io(this._values[e].property)),this._values[e].transition=Ve(t)||void 0},So.prototype.serialize=function(){for(var e={},t=0,r=Object.keys(this._values);t<r.length;t+=1){var u=r[t],f=this.getValue(u);f!==void 0&&(e[u]=f);var m=this.getTransition(u);m!==void 0&&(e[u+"-transition"]=m)}return e},So.prototype.transitioned=function(e,t){for(var r=new ul(this._properties),u=0,f=Object.keys(this._values);u<f.length;u+=1){var m=f[u];r._values[m]=this._values[m].transitioned(e,t._values[m])}return r},So.prototype.untransitioned=function(){for(var e=new ul(this._properties),t=0,r=Object.keys(this._values);t<r.length;t+=1){var u=r[t];e._values[u]=this._values[u].untransitioned()}return e};var Sl=function(t,r,u,f,m){this.property=t,this.value=r,this.begin=m+f.delay||0,this.end=this.begin+f.duration||0,t.specification.transition&&(f.delay||f.duration)&&(this.prior=u)};Sl.prototype.possiblyEvaluate=function(e,t,r){var u=e.now||0,f=this.value.possiblyEvaluate(e,t,r),m=this.prior;if(m){if(u>this.end)return this.prior=null,f;if(this.value.isDataDriven())return this.prior=null,f;if(u<this.begin)return m.possiblyEvaluate(e,t,r);var S=(u-this.begin)/(this.end-this.begin);return this.property.interpolate(m.possiblyEvaluate(e,t,r),f,function(P){if(P<=0)return 0;if(P>=1)return 1;var V=P*P,re=V*P;return 4*(P<.5?re:3*(P-V)+re-.75)}(S))}return f};var ul=function(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)};ul.prototype.possiblyEvaluate=function(e,t,r){for(var u=new xc(this._properties),f=0,m=Object.keys(this._values);f<m.length;f+=1){var S=m[f];u._values[S]=this._values[S].possiblyEvaluate(e,t,r)}return u},ul.prototype.hasTransition=function(){for(var e=0,t=Object.keys(this._values);e<t.length;e+=1)if(this._values[t[e]].prior)return!0;return!1};var pu=function(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)};pu.prototype.getValue=function(e){return Ve(this._values[e].value)},pu.prototype.setValue=function(e,t){this._values[e]=new eu(this._values[e].property,t===null?void 0:Ve(t))},pu.prototype.serialize=function(){for(var e={},t=0,r=Object.keys(this._values);t<r.length;t+=1){var u=r[t],f=this.getValue(u);f!==void 0&&(e[u]=f)}return e},pu.prototype.possiblyEvaluate=function(e,t,r){for(var u=new xc(this._properties),f=0,m=Object.keys(this._values);f<m.length;f+=1){var S=m[f];u._values[S]=this._values[S].possiblyEvaluate(e,t,r)}return u};var Cs=function(t,r,u){this.property=t,this.value=r,this.parameters=u};Cs.prototype.isConstant=function(){return this.value.kind==="constant"},Cs.prototype.constantOr=function(e){return this.value.kind==="constant"?this.value.value:e},Cs.prototype.evaluate=function(e,t,r,u){return this.property.evaluate(this.value,this.parameters,e,t,r,u)};var xc=function(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)};xc.prototype.get=function(e){return this._values[e]};var Jn=function(t){this.specification=t};Jn.prototype.possiblyEvaluate=function(e,t){return e.expression.evaluate(t)},Jn.prototype.interpolate=function(e,t,r){var u=_s[this.specification.type];return u?u(e,t,r):e};var jn=function(t,r){this.specification=t,this.overrides=r};jn.prototype.possiblyEvaluate=function(e,t,r,u){return new Cs(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(t,null,{},r,u)}:e.expression,t)},jn.prototype.interpolate=function(e,t,r){if(e.value.kind!=="constant"||t.value.kind!=="constant")return e;if(e.value.value===void 0||t.value.value===void 0)return new Cs(this,{kind:"constant",value:void 0},e.parameters);var u=_s[this.specification.type];return u?new Cs(this,{kind:"constant",value:u(e.value.value,t.value.value,r)},e.parameters):e},jn.prototype.evaluate=function(e,t,r,u,f,m){return e.kind==="constant"?e.value:e.evaluate(t,r,u,f,m)};var Ec=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.possiblyEvaluate=function(r,u,f,m){if(r.value===void 0)return new Cs(this,{kind:"constant",value:void 0},u);if(r.expression.kind==="constant"){var S=r.expression.evaluate(u,null,{},f,m),P=r.property.specification.type==="resolvedImage"&&typeof S!="string"?S.name:S,V=this._calculate(P,P,P,u);return new Cs(this,{kind:"constant",value:V},u)}if(r.expression.kind==="camera"){var re=this._calculate(r.expression.evaluate({zoom:u.zoom-1}),r.expression.evaluate({zoom:u.zoom}),r.expression.evaluate({zoom:u.zoom+1}),u);return new Cs(this,{kind:"constant",value:re},u)}return new Cs(this,r.expression,u)},t.prototype.evaluate=function(r,u,f,m,S,P){if(r.kind==="source"){var V=r.evaluate(u,f,m,S,P);return this._calculate(V,V,V,u)}return r.kind==="composite"?this._calculate(r.evaluate({zoom:Math.floor(u.zoom)-1},f,m),r.evaluate({zoom:Math.floor(u.zoom)},f,m),r.evaluate({zoom:Math.floor(u.zoom)+1},f,m),u):r.value},t.prototype._calculate=function(r,u,f,m){return m.zoom>m.zoomHistory.lastIntegerZoom?{from:r,to:u}:{from:f,to:u}},t.prototype.interpolate=function(r){return r},t}(jn),cs=function(t){this.specification=t};cs.prototype.possiblyEvaluate=function(e,t,r,u){if(e.value!==void 0){if(e.expression.kind==="constant"){var f=e.expression.evaluate(t,null,{},r,u);return this._calculate(f,f,f,t)}return this._calculate(e.expression.evaluate(new Pa(Math.floor(t.zoom-1),t)),e.expression.evaluate(new Pa(Math.floor(t.zoom),t)),e.expression.evaluate(new Pa(Math.floor(t.zoom+1),t)),t)}},cs.prototype._calculate=function(e,t,r,u){return u.zoom>u.zoomHistory.lastIntegerZoom?{from:e,to:t}:{from:r,to:t}},cs.prototype.interpolate=function(e){return e};var Do=function(t){this.specification=t};Do.prototype.possiblyEvaluate=function(e,t,r,u){return!!e.expression.evaluate(t,null,{},r,u)},Do.prototype.interpolate=function(){return!1};var vo=function(t){for(var r in this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],t){var u=t[r];u.specification.overridable&&this.overridableProperties.push(r);var f=this.defaultPropertyValues[r]=new eu(u,void 0),m=this.defaultTransitionablePropertyValues[r]=new Io(u);this.defaultTransitioningPropertyValues[r]=m.untransitioned(),this.defaultPossiblyEvaluatedValues[r]=f.possiblyEvaluate({})}};Rn("DataDrivenProperty",jn),Rn("DataConstantProperty",Jn),Rn("CrossFadedDataDrivenProperty",Ec),Rn("CrossFadedProperty",cs),Rn("ColorRampProperty",Do);var ws=function(e){function t(r,u){if(e.call(this),this.id=r.id,this.type=r.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},r.type!=="custom"&&(this.metadata=(r=r).metadata,this.minzoom=r.minzoom,this.maxzoom=r.maxzoom,r.type!=="background"&&(this.source=r.source,this.sourceLayer=r["source-layer"],this.filter=r.filter),u.layout&&(this._unevaluatedLayout=new pu(u.layout)),u.paint)){for(var f in this._transitionablePaint=new So(u.paint),r.paint)this.setPaintProperty(f,r.paint[f],{validate:!1});for(var m in r.layout)this.setLayoutProperty(m,r.layout[m],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new xc(u.paint)}}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},t.prototype.getLayoutProperty=function(r){return r==="visibility"?this.visibility:this._unevaluatedLayout.getValue(r)},t.prototype.setLayoutProperty=function(r,u,f){f===void 0&&(f={}),u!=null&&this._validate(_l,"layers."+this.id+".layout."+r,r,u,f)||(r!=="visibility"?this._unevaluatedLayout.setValue(r,u):this.visibility=u)},t.prototype.getPaintProperty=function(r){return At(r,"-transition")?this._transitionablePaint.getTransition(r.slice(0,-"-transition".length)):this._transitionablePaint.getValue(r)},t.prototype.setPaintProperty=function(r,u,f){if(f===void 0&&(f={}),u!=null&&this._validate(ss,"layers."+this.id+".paint."+r,r,u,f))return!1;if(At(r,"-transition"))return this._transitionablePaint.setTransition(r.slice(0,-"-transition".length),u||void 0),!1;var m=this._transitionablePaint._values[r],S=m.property.specification["property-type"]==="cross-faded-data-driven",P=m.value.isDataDriven(),V=m.value;this._transitionablePaint.setValue(r,u),this._handleSpecialPaintPropertyUpdate(r);var re=this._transitionablePaint._values[r].value;return re.isDataDriven()||P||S||this._handleOverridablePaintPropertyUpdate(r,V,re)},t.prototype._handleSpecialPaintPropertyUpdate=function(r){},t.prototype._handleOverridablePaintPropertyUpdate=function(r,u,f){return!1},t.prototype.isHidden=function(r){return!!(this.minzoom&&r<this.minzoom)||!!(this.maxzoom&&r>=this.maxzoom)||this.visibility==="none"},t.prototype.updateTransitions=function(r){this._transitioningPaint=this._transitionablePaint.transitioned(r,this._transitioningPaint)},t.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},t.prototype.recalculate=function(r,u){r.getCrossfadeParameters&&(this._crossfadeParameters=r.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(r,void 0,u)),this.paint=this._transitioningPaint.possiblyEvaluate(r,void 0,u)},t.prototype.serialize=function(){var r={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(r.layout=r.layout||{},r.layout.visibility=this.visibility),Ne(r,function(u,f){return!(u===void 0||f==="layout"&&!Object.keys(u).length||f==="paint"&&!Object.keys(u).length)})},t.prototype._validate=function(r,u,f,m,S){return S===void 0&&(S={}),(!S||S.validate!==!1)&&il(this,r.call(al,{key:u,layerType:this.type,objectKey:f,value:m,styleSpec:Ze,style:{glyphs:!0,sprite:!0}}))},t.prototype.is3D=function(){return!1},t.prototype.isTileClipped=function(){return!1},t.prototype.hasOffscreenPass=function(){return!1},t.prototype.resize=function(){},t.prototype.isStateDependent=function(){for(var r in this.paint._values){var u=this.paint.get(r);if(u instanceof Cs&&_u(u.property.specification)&&(u.value.kind==="source"||u.value.kind==="composite")&&u.value.isStateDependent)return!0}return!1},t}(Bt),Au={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},ec=function(t,r){this._structArray=t,this._pos1=r*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},$a=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function no(e,t){t===void 0&&(t=1);var r=0,u=0;return{members:e.map(function(f){var m=Au[f.type].BYTES_PER_ELEMENT,S=r=ll(r,Math.max(t,m)),P=f.components||1;return u=Math.max(u,m),r+=m*P,{name:f.name,type:f.type,components:P,offset:S}}),size:ll(r,Math.max(u,t)),alignment:t}}function ll(e,t){return Math.ceil(e/t)*t}$a.serialize=function(e,t){return e._trim(),t&&(e.isTransferred=!0,t.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}},$a.deserialize=function(e){var t=Object.create(this.prototype);return t.arrayBuffer=e.arrayBuffer,t.length=e.length,t.capacity=e.arrayBuffer.byteLength/t.bytesPerElement,t._refreshViews(),t},$a.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},$a.prototype.clear=function(){this.length=0},$a.prototype.resize=function(e){this.reserve(e),this.length=e},$a.prototype.reserve=function(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var t=this.uint8;this._refreshViews(),t&&this.uint8.set(t)}},$a.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var mu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u){var f=this.length;return this.resize(f+1),this.emplace(f,r,u)},t.prototype.emplace=function(r,u,f){var m=2*r;return this.int16[m+0]=u,this.int16[m+1]=f,r},t}($a);mu.prototype.bytesPerElement=4,Rn("StructArrayLayout2i4",mu);var cl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f,m){var S=this.length;return this.resize(S+1),this.emplace(S,r,u,f,m)},t.prototype.emplace=function(r,u,f,m,S){var P=4*r;return this.int16[P+0]=u,this.int16[P+1]=f,this.int16[P+2]=m,this.int16[P+3]=S,r},t}($a);cl.prototype.bytesPerElement=8,Rn("StructArrayLayout4i8",cl);var Cu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f,m,S,P){var V=this.length;return this.resize(V+1),this.emplace(V,r,u,f,m,S,P)},t.prototype.emplace=function(r,u,f,m,S,P,V){var re=6*r;return this.int16[re+0]=u,this.int16[re+1]=f,this.int16[re+2]=m,this.int16[re+3]=S,this.int16[re+4]=P,this.int16[re+5]=V,r},t}($a);Cu.prototype.bytesPerElement=12,Rn("StructArrayLayout2i4i12",Cu);var Is=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f,m,S,P){var V=this.length;return this.resize(V+1),this.emplace(V,r,u,f,m,S,P)},t.prototype.emplace=function(r,u,f,m,S,P,V){var re=4*r,he=8*r;return this.int16[re+0]=u,this.int16[re+1]=f,this.uint8[he+4]=m,this.uint8[he+5]=S,this.uint8[he+6]=P,this.uint8[he+7]=V,r},t}($a);Is.prototype.bytesPerElement=8,Rn("StructArrayLayout2i4ub8",Is);var Fc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u){var f=this.length;return this.resize(f+1),this.emplace(f,r,u)},t.prototype.emplace=function(r,u,f){var m=2*r;return this.float32[m+0]=u,this.float32[m+1]=f,r},t}($a);Fc.prototype.bytesPerElement=8,Rn("StructArrayLayout2f8",Fc);var Gs=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f,m,S,P,V,re,he,_e){var we=this.length;return this.resize(we+1),this.emplace(we,r,u,f,m,S,P,V,re,he,_e)},t.prototype.emplace=function(r,u,f,m,S,P,V,re,he,_e,we){var lt=10*r;return this.uint16[lt+0]=u,this.uint16[lt+1]=f,this.uint16[lt+2]=m,this.uint16[lt+3]=S,this.uint16[lt+4]=P,this.uint16[lt+5]=V,this.uint16[lt+6]=re,this.uint16[lt+7]=he,this.uint16[lt+8]=_e,this.uint16[lt+9]=we,r},t}($a);Gs.prototype.bytesPerElement=20,Rn("StructArrayLayout10ui20",Gs);var yf=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f,m,S,P,V,re,he,_e,we,lt){var Lt=this.length;return this.resize(Lt+1),this.emplace(Lt,r,u,f,m,S,P,V,re,he,_e,we,lt)},t.prototype.emplace=function(r,u,f,m,S,P,V,re,he,_e,we,lt,Lt){var Ct=12*r;return this.int16[Ct+0]=u,this.int16[Ct+1]=f,this.int16[Ct+2]=m,this.int16[Ct+3]=S,this.uint16[Ct+4]=P,this.uint16[Ct+5]=V,this.uint16[Ct+6]=re,this.uint16[Ct+7]=he,this.int16[Ct+8]=_e,this.int16[Ct+9]=we,this.int16[Ct+10]=lt,this.int16[Ct+11]=Lt,r},t}($a);yf.prototype.bytesPerElement=24,Rn("StructArrayLayout4i4ui4i24",yf);var Ul=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f){var m=this.length;return this.resize(m+1),this.emplace(m,r,u,f)},t.prototype.emplace=function(r,u,f,m){var S=3*r;return this.float32[S+0]=u,this.float32[S+1]=f,this.float32[S+2]=m,r},t}($a);Ul.prototype.bytesPerElement=12,Rn("StructArrayLayout3f12",Ul);var Bl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r){var u=this.length;return this.resize(u+1),this.emplace(u,r)},t.prototype.emplace=function(r,u){return this.uint32[1*r+0]=u,r},t}($a);Bl.prototype.bytesPerElement=4,Rn("StructArrayLayout1ul4",Bl);var Tc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f,m,S,P,V,re,he){var _e=this.length;return this.resize(_e+1),this.emplace(_e,r,u,f,m,S,P,V,re,he)},t.prototype.emplace=function(r,u,f,m,S,P,V,re,he,_e){var we=10*r,lt=5*r;return this.int16[we+0]=u,this.int16[we+1]=f,this.int16[we+2]=m,this.int16[we+3]=S,this.int16[we+4]=P,this.int16[we+5]=V,this.uint32[lt+3]=re,this.uint16[we+8]=he,this.uint16[we+9]=_e,r},t}($a);Tc.prototype.bytesPerElement=20,Rn("StructArrayLayout6i1ul2ui20",Tc);var fs=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f,m,S,P){var V=this.length;return this.resize(V+1),this.emplace(V,r,u,f,m,S,P)},t.prototype.emplace=function(r,u,f,m,S,P,V){var re=6*r;return this.int16[re+0]=u,this.int16[re+1]=f,this.int16[re+2]=m,this.int16[re+3]=S,this.int16[re+4]=P,this.int16[re+5]=V,r},t}($a);fs.prototype.bytesPerElement=12,Rn("StructArrayLayout2i2i2i12",fs);var Bu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f,m,S){var P=this.length;return this.resize(P+1),this.emplace(P,r,u,f,m,S)},t.prototype.emplace=function(r,u,f,m,S,P){var V=4*r,re=8*r;return this.float32[V+0]=u,this.float32[V+1]=f,this.float32[V+2]=m,this.int16[re+6]=S,this.int16[re+7]=P,r},t}($a);Bu.prototype.bytesPerElement=16,Rn("StructArrayLayout2f1f2i16",Bu);var zc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f,m){var S=this.length;return this.resize(S+1),this.emplace(S,r,u,f,m)},t.prototype.emplace=function(r,u,f,m,S){var P=12*r,V=3*r;return this.uint8[P+0]=u,this.uint8[P+1]=f,this.float32[V+1]=m,this.float32[V+2]=S,r},t}($a);zc.prototype.bytesPerElement=12,Rn("StructArrayLayout2ub2f12",zc);var Al=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f){var m=this.length;return this.resize(m+1),this.emplace(m,r,u,f)},t.prototype.emplace=function(r,u,f,m){var S=3*r;return this.uint16[S+0]=u,this.uint16[S+1]=f,this.uint16[S+2]=m,r},t}($a);Al.prototype.bytesPerElement=6,Rn("StructArrayLayout3ui6",Al);var Vu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f,m,S,P,V,re,he,_e,we,lt,Lt,Ct,$t,Xt,ir){var br=this.length;return this.resize(br+1),this.emplace(br,r,u,f,m,S,P,V,re,he,_e,we,lt,Lt,Ct,$t,Xt,ir)},t.prototype.emplace=function(r,u,f,m,S,P,V,re,he,_e,we,lt,Lt,Ct,$t,Xt,ir,br){var Sr=24*r,Fr=12*r,Nr=48*r;return this.int16[Sr+0]=u,this.int16[Sr+1]=f,this.uint16[Sr+2]=m,this.uint16[Sr+3]=S,this.uint32[Fr+2]=P,this.uint32[Fr+3]=V,this.uint32[Fr+4]=re,this.uint16[Sr+10]=he,this.uint16[Sr+11]=_e,this.uint16[Sr+12]=we,this.float32[Fr+7]=lt,this.float32[Fr+8]=Lt,this.uint8[Nr+36]=Ct,this.uint8[Nr+37]=$t,this.uint8[Nr+38]=Xt,this.uint32[Fr+10]=ir,this.int16[Sr+22]=br,r},t}($a);Vu.prototype.bytesPerElement=48,Rn("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Vu);var tc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f,m,S,P,V,re,he,_e,we,lt,Lt,Ct,$t,Xt,ir,br,Sr,Fr,Nr,mn,hn,Ln,Qn,Yn,Nn,_a){var fa=this.length;return this.resize(fa+1),this.emplace(fa,r,u,f,m,S,P,V,re,he,_e,we,lt,Lt,Ct,$t,Xt,ir,br,Sr,Fr,Nr,mn,hn,Ln,Qn,Yn,Nn,_a)},t.prototype.emplace=function(r,u,f,m,S,P,V,re,he,_e,we,lt,Lt,Ct,$t,Xt,ir,br,Sr,Fr,Nr,mn,hn,Ln,Qn,Yn,Nn,_a,fa){var ra=34*r,Ja=17*r;return this.int16[ra+0]=u,this.int16[ra+1]=f,this.int16[ra+2]=m,this.int16[ra+3]=S,this.int16[ra+4]=P,this.int16[ra+5]=V,this.int16[ra+6]=re,this.int16[ra+7]=he,this.uint16[ra+8]=_e,this.uint16[ra+9]=we,this.uint16[ra+10]=lt,this.uint16[ra+11]=Lt,this.uint16[ra+12]=Ct,this.uint16[ra+13]=$t,this.uint16[ra+14]=Xt,this.uint16[ra+15]=ir,this.uint16[ra+16]=br,this.uint16[ra+17]=Sr,this.uint16[ra+18]=Fr,this.uint16[ra+19]=Nr,this.uint16[ra+20]=mn,this.uint16[ra+21]=hn,this.uint16[ra+22]=Ln,this.uint32[Ja+12]=Qn,this.float32[Ja+13]=Yn,this.float32[Ja+14]=Nn,this.float32[Ja+15]=_a,this.float32[Ja+16]=fa,r},t}($a);tc.prototype.bytesPerElement=68,Rn("StructArrayLayout8i15ui1ul4f68",tc);var Gu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r){var u=this.length;return this.resize(u+1),this.emplace(u,r)},t.prototype.emplace=function(r,u){return this.float32[1*r+0]=u,r},t}($a);Gu.prototype.bytesPerElement=4,Rn("StructArrayLayout1f4",Gu);var Ds=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f){var m=this.length;return this.resize(m+1),this.emplace(m,r,u,f)},t.prototype.emplace=function(r,u,f,m){var S=3*r;return this.int16[S+0]=u,this.int16[S+1]=f,this.int16[S+2]=m,r},t}($a);Ds.prototype.bytesPerElement=6,Rn("StructArrayLayout3i6",Ds);var nf=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f){var m=this.length;return this.resize(m+1),this.emplace(m,r,u,f)},t.prototype.emplace=function(r,u,f,m){var S=4*r;return this.uint32[2*r+0]=u,this.uint16[S+2]=f,this.uint16[S+3]=m,r},t}($a);nf.prototype.bytesPerElement=8,Rn("StructArrayLayout1ul2ui8",nf);var rc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u){var f=this.length;return this.resize(f+1),this.emplace(f,r,u)},t.prototype.emplace=function(r,u,f){var m=2*r;return this.uint16[m+0]=u,this.uint16[m+1]=f,r},t}($a);rc.prototype.bytesPerElement=4,Rn("StructArrayLayout2ui4",rc);var nc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r){var u=this.length;return this.resize(u+1),this.emplace(u,r)},t.prototype.emplace=function(r,u){return this.uint16[1*r+0]=u,r},t}($a);nc.prototype.bytesPerElement=2,Rn("StructArrayLayout1ui2",nc);var ac=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,u,f,m){var S=this.length;return this.resize(S+1),this.emplace(S,r,u,f,m)},t.prototype.emplace=function(r,u,f,m,S){var P=4*r;return this.float32[P+0]=u,this.float32[P+1]=f,this.float32[P+2]=m,this.float32[P+3]=S,r},t}($a);ac.prototype.bytesPerElement=16,Rn("StructArrayLayout4f16",ac);var s=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return r.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},r.x1.get=function(){return this._structArray.int16[this._pos2+2]},r.y1.get=function(){return this._structArray.int16[this._pos2+3]},r.x2.get=function(){return this._structArray.int16[this._pos2+4]},r.y2.get=function(){return this._structArray.int16[this._pos2+5]},r.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},r.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},r.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},r.anchorPoint.get=function(){return new ee(this.anchorPointX,this.anchorPointY)},Object.defineProperties(t.prototype,r),t}(ec);s.prototype.size=20;var a=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(r){return new s(this,r)},t}(Tc);Rn("CollisionBoxArray",a);var n=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return r.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},r.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},r.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},r.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},r.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},r.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},r.segment.get=function(){return this._structArray.uint16[this._pos2+10]},r.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},r.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},r.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},r.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},r.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},r.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},r.placedOrientation.set=function(u){this._structArray.uint8[this._pos1+37]=u},r.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},r.hidden.set=function(u){this._structArray.uint8[this._pos1+38]=u},r.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},r.crossTileID.set=function(u){this._structArray.uint32[this._pos4+10]=u},r.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(t.prototype,r),t}(ec);n.prototype.size=48;var l=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(r){return new n(this,r)},t}(Vu);Rn("PlacedSymbolArray",l);var v=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return r.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},r.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},r.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},r.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},r.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},r.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},r.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},r.key.get=function(){return this._structArray.uint16[this._pos2+8]},r.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},r.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},r.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},r.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},r.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},r.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},r.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},r.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},r.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},r.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},r.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},r.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},r.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},r.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},r.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},r.crossTileID.set=function(u){this._structArray.uint32[this._pos4+12]=u},r.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},r.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},r.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},r.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(t.prototype,r),t}(ec);v.prototype.size=68;var O=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(r){return new v(this,r)},t}(tc);Rn("SymbolInstanceArray",O);var L=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getoffsetX=function(r){return this.float32[1*r+0]},t}(Gu);Rn("GlyphOffsetArray",L);var j=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getx=function(r){return this.int16[3*r+0]},t.prototype.gety=function(r){return this.int16[3*r+1]},t.prototype.gettileUnitDistanceFromAnchor=function(r){return this.int16[3*r+2]},t}(Ds);Rn("SymbolLineVertexArray",j);var ue=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return r.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},r.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},r.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(t.prototype,r),t}(ec);ue.prototype.size=8;var Ee=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(r){return new ue(this,r)},t}(nf);Rn("FeatureIndexArray",Ee);var $e=no([{name:"a_pos",components:2,type:"Int16"}],4).members,nt=function(t){t===void 0&&(t=[]),this.segments=t};function at(e,t){return 256*(e=Se(Math.floor(e),0,255))+Se(Math.floor(t),0,255)}nt.prototype.prepareSegment=function(e,t,r,u){var f=this.segments[this.segments.length-1];return e>nt.MAX_VERTEX_ARRAY_LENGTH&&Me("Max vertices per segment is "+nt.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+e),(!f||f.vertexLength+e>nt.MAX_VERTEX_ARRAY_LENGTH||f.sortKey!==u)&&(f={vertexOffset:t.length,primitiveOffset:r.length,vertexLength:0,primitiveLength:0},u!==void 0&&(f.sortKey=u),this.segments.push(f)),f},nt.prototype.get=function(){return this.segments},nt.prototype.destroy=function(){for(var e=0,t=this.segments;e<t.length;e+=1){var r=t[e];for(var u in r.vaos)r.vaos[u].destroy()}},nt.simpleSegment=function(e,t,r,u){return new nt([{vertexOffset:e,primitiveOffset:t,vertexLength:r,primitiveLength:u,vaos:{},sortKey:0}])},nt.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Rn("SegmentVector",nt);var Ft=no([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),Nt=Z(function(e){e.exports=function(t,r){var u,f,m,S,P,V,re,he;for(f=t.length-(u=3&t.length),m=r,P=3432918353,V=461845907,he=0;he<f;)re=255&t.charCodeAt(he)|(255&t.charCodeAt(++he))<<8|(255&t.charCodeAt(++he))<<16|(255&t.charCodeAt(++he))<<24,++he,m=27492+(65535&(S=5*(65535&(m=(m^=re=(65535&(re=(re=(65535&re)*P+(((re>>>16)*P&65535)<<16)&4294967295)<<15|re>>>17))*V+(((re>>>16)*V&65535)<<16)&4294967295)<<13|m>>>19))+((5*(m>>>16)&65535)<<16)&4294967295))+((58964+(S>>>16)&65535)<<16);switch(re=0,u){case 3:re^=(255&t.charCodeAt(he+2))<<16;case 2:re^=(255&t.charCodeAt(he+1))<<8;case 1:m^=re=(65535&(re=(re=(65535&(re^=255&t.charCodeAt(he)))*P+(((re>>>16)*P&65535)<<16)&4294967295)<<15|re>>>17))*V+(((re>>>16)*V&65535)<<16)&4294967295}return m^=t.length,m=2246822507*(65535&(m^=m>>>16))+((2246822507*(m>>>16)&65535)<<16)&4294967295,m=3266489909*(65535&(m^=m>>>13))+((3266489909*(m>>>16)&65535)<<16)&4294967295,(m^=m>>>16)>>>0}}),Jt=Z(function(e){e.exports=function(t,r){for(var u,f=t.length,m=r^f,S=0;f>=4;)u=1540483477*(65535&(u=255&t.charCodeAt(S)|(255&t.charCodeAt(++S))<<8|(255&t.charCodeAt(++S))<<16|(255&t.charCodeAt(++S))<<24))+((1540483477*(u>>>16)&65535)<<16),m=1540483477*(65535&m)+((1540483477*(m>>>16)&65535)<<16)^(u=1540483477*(65535&(u^=u>>>24))+((1540483477*(u>>>16)&65535)<<16)),f-=4,++S;switch(f){case 3:m^=(255&t.charCodeAt(S+2))<<16;case 2:m^=(255&t.charCodeAt(S+1))<<8;case 1:m=1540483477*(65535&(m^=255&t.charCodeAt(S)))+((1540483477*(m>>>16)&65535)<<16)}return m=1540483477*(65535&(m^=m>>>13))+((1540483477*(m>>>16)&65535)<<16),(m^=m>>>15)>>>0}}),jt=Nt,Gt=Jt;jt.murmur3=Nt,jt.murmur2=Gt;var ar=function(){this.ids=[],this.positions=[],this.indexed=!1};ar.prototype.add=function(e,t,r,u){this.ids.push(Rr(e)),this.positions.push(t,r,u)},ar.prototype.getPositions=function(e){for(var t=Rr(e),r=0,u=this.ids.length-1;r<u;){var f=r+u>>1;this.ids[f]>=t?u=f:r=f+1}for(var m=[];this.ids[r]===t;)m.push({index:this.positions[3*r],start:this.positions[3*r+1],end:this.positions[3*r+2]}),r++;return m},ar.serialize=function(e,t){var r=new Float64Array(e.ids),u=new Uint32Array(e.positions);return function f(m,S,P,V){for(;P<V;){for(var re=m[P+V>>1],he=P-1,_e=V+1;;){do he++;while(m[he]<re);do _e--;while(m[_e]>re);if(he>=_e)break;gr(m,he,_e),gr(S,3*he,3*_e),gr(S,3*he+1,3*_e+1),gr(S,3*he+2,3*_e+2)}_e-P<V-_e?(f(m,S,P,_e),P=_e+1):(f(m,S,_e+1,V),V=_e)}}(r,u,0,r.length-1),t&&t.push(r.buffer,u.buffer),{ids:r,positions:u}},ar.deserialize=function(e){var t=new ar;return t.ids=e.ids,t.positions=e.positions,t.indexed=!0,t};var nr=Math.pow(2,53)-1;function Rr(e){var t=+e;return!isNaN(t)&&t<=nr?t:jt(String(e))}function gr(e,t,r){var u=e[t];e[t]=e[r],e[r]=u}Rn("FeaturePositionMap",ar);var Ar=function(t,r){this.gl=t.gl,this.location=r},Cr=function(e){function t(r,u){e.call(this,r,u),this.current=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){this.current!==r&&(this.current=r,this.gl.uniform1i(this.location,r))},t}(Ar),an=function(e){function t(r,u){e.call(this,r,u),this.current=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){this.current!==r&&(this.current=r,this.gl.uniform1f(this.location,r))},t}(Ar),Yr=function(e){function t(r,u){e.call(this,r,u),this.current=[0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){r[0]===this.current[0]&&r[1]===this.current[1]||(this.current=r,this.gl.uniform2f(this.location,r[0],r[1]))},t}(Ar),vn=function(e){function t(r,u){e.call(this,r,u),this.current=[0,0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]||(this.current=r,this.gl.uniform3f(this.location,r[0],r[1],r[2]))},t}(Ar),Pn=function(e){function t(r,u){e.call(this,r,u),this.current=[0,0,0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]&&r[3]===this.current[3]||(this.current=r,this.gl.uniform4f(this.location,r[0],r[1],r[2],r[3]))},t}(Ar),qn=function(e){function t(r,u){e.call(this,r,u),this.current=ha.transparent}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){r.r===this.current.r&&r.g===this.current.g&&r.b===this.current.b&&r.a===this.current.a||(this.current=r,this.gl.uniform4f(this.location,r.r,r.g,r.b,r.a))},t}(Ar),sa=new Float32Array(16),Aa=function(e){function t(r,u){e.call(this,r,u),this.current=sa}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){if(r[12]!==this.current[12]||r[0]!==this.current[0])return this.current=r,void this.gl.uniformMatrix4fv(this.location,!1,r);for(var u=1;u<16;u++)if(r[u]!==this.current[u]){this.current=r,this.gl.uniformMatrix4fv(this.location,!1,r);break}},t}(Ar);function Wa(e){return[at(255*e.r,255*e.g),at(255*e.b,255*e.a)]}var _n=function(t,r,u){this.value=t,this.uniformNames=r.map(function(f){return"u_"+f}),this.type=u};_n.prototype.setUniform=function(e,t,r){e.set(r.constantOr(this.value))},_n.prototype.getBinding=function(e,t,r){return this.type==="color"?new qn(e,t):new an(e,t)};var ua=function(t,r){this.uniformNames=r.map(function(u){return"u_"+u}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};ua.prototype.setConstantPatternPositions=function(e,t){this.pixelRatioFrom=t.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=t.tlbr,this.patternTo=e.tlbr},ua.prototype.setUniform=function(e,t,r,u){var f=u==="u_pattern_to"?this.patternTo:u==="u_pattern_from"?this.patternFrom:u==="u_pixel_ratio_to"?this.pixelRatioTo:u==="u_pixel_ratio_from"?this.pixelRatioFrom:null;f&&e.set(f)},ua.prototype.getBinding=function(e,t,r){return r.substr(0,9)==="u_pattern"?new Pn(e,t):new an(e,t)};var xa=function(t,r,u,f){this.expression=t,this.type=u,this.maxValue=0,this.paintVertexAttributes=r.map(function(m){return{name:"a_"+m,type:"Float32",components:u==="color"?2:1,offset:0}}),this.paintVertexArray=new f};xa.prototype.populatePaintArray=function(e,t,r,u,f){var m=this.paintVertexArray.length,S=this.expression.evaluate(new Pa(0),t,{},u,[],f);this.paintVertexArray.resize(e),this._setPaintValue(m,e,S)},xa.prototype.updatePaintArray=function(e,t,r,u){var f=this.expression.evaluate({zoom:0},r,u);this._setPaintValue(e,t,f)},xa.prototype._setPaintValue=function(e,t,r){if(this.type==="color")for(var u=Wa(r),f=e;f<t;f++)this.paintVertexArray.emplace(f,u[0],u[1]);else{for(var m=e;m<t;m++)this.paintVertexArray.emplace(m,r);this.maxValue=Math.max(this.maxValue,Math.abs(r))}},xa.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},xa.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var Zn=function(t,r,u,f,m,S){this.expression=t,this.uniformNames=r.map(function(P){return"u_"+P+"_t"}),this.type=u,this.useIntegerZoom=f,this.zoom=m,this.maxValue=0,this.paintVertexAttributes=r.map(function(P){return{name:"a_"+P,type:"Float32",components:u==="color"?4:2,offset:0}}),this.paintVertexArray=new S};Zn.prototype.populatePaintArray=function(e,t,r,u,f){var m=this.expression.evaluate(new Pa(this.zoom),t,{},u,[],f),S=this.expression.evaluate(new Pa(this.zoom+1),t,{},u,[],f),P=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(P,e,m,S)},Zn.prototype.updatePaintArray=function(e,t,r,u){var f=this.expression.evaluate({zoom:this.zoom},r,u),m=this.expression.evaluate({zoom:this.zoom+1},r,u);this._setPaintValue(e,t,f,m)},Zn.prototype._setPaintValue=function(e,t,r,u){if(this.type==="color")for(var f=Wa(r),m=Wa(u),S=e;S<t;S++)this.paintVertexArray.emplace(S,f[0],f[1],m[0],m[1]);else{for(var P=e;P<t;P++)this.paintVertexArray.emplace(P,r,u);this.maxValue=Math.max(this.maxValue,Math.abs(r),Math.abs(u))}},Zn.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Zn.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},Zn.prototype.setUniform=function(e,t){var r=this.useIntegerZoom?Math.floor(t.zoom):t.zoom,u=Se(this.expression.interpolationFactor(r,this.zoom,this.zoom+1),0,1);e.set(u)},Zn.prototype.getBinding=function(e,t,r){return new an(e,t)};var Ca=function(t,r,u,f,m,S){this.expression=t,this.type=r,this.useIntegerZoom=u,this.zoom=f,this.layerId=S,this.zoomInPaintVertexArray=new m,this.zoomOutPaintVertexArray=new m};Ca.prototype.populatePaintArray=function(e,t,r){var u=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(u,e,t.patterns&&t.patterns[this.layerId],r)},Ca.prototype.updatePaintArray=function(e,t,r,u,f){this._setPaintValues(e,t,r.patterns&&r.patterns[this.layerId],f)},Ca.prototype._setPaintValues=function(e,t,r,u){if(u&&r){var f=u[r.min],m=u[r.mid],S=u[r.max];if(f&&m&&S)for(var P=e;P<t;P++)this.zoomInPaintVertexArray.emplace(P,m.tl[0],m.tl[1],m.br[0],m.br[1],f.tl[0],f.tl[1],f.br[0],f.br[1],m.pixelRatio,f.pixelRatio),this.zoomOutPaintVertexArray.emplace(P,m.tl[0],m.tl[1],m.br[0],m.br[1],S.tl[0],S.tl[1],S.br[0],S.br[1],m.pixelRatio,S.pixelRatio)}},Ca.prototype.upload=function(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,Ft.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,Ft.members,this.expression.isStateDependent))},Ca.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var ia=function(t,r,u){this.binders={},this._buffers=[];var f=[];for(var m in t.paint._values)if(u(m)){var S=t.paint.get(m);if(S instanceof Cs&&_u(S.property.specification)){var P=za(m,t.type),V=S.value,re=S.property.specification.type,he=S.property.useIntegerZoom,_e=S.property.specification["property-type"],we=_e==="cross-faded"||_e==="cross-faded-data-driven";if(V.kind==="constant")this.binders[m]=we?new ua(V.value,P):new _n(V.value,P,re),f.push("/u_"+m);else if(V.kind==="source"||we){var lt=Hi(m,re,"source");this.binders[m]=we?new Ca(V,re,he,r,lt,t.id):new xa(V,P,re,lt),f.push("/a_"+m)}else{var Lt=Hi(m,re,"composite");this.binders[m]=new Zn(V,P,re,he,r,Lt),f.push("/z_"+m)}}}this.cacheKey=f.sort().join("")};ia.prototype.getMaxValue=function(e){var t=this.binders[e];return t instanceof xa||t instanceof Zn?t.maxValue:0},ia.prototype.populatePaintArrays=function(e,t,r,u,f){for(var m in this.binders){var S=this.binders[m];(S instanceof xa||S instanceof Zn||S instanceof Ca)&&S.populatePaintArray(e,t,r,u,f)}},ia.prototype.setConstantPatternPositions=function(e,t){for(var r in this.binders){var u=this.binders[r];u instanceof ua&&u.setConstantPatternPositions(e,t)}},ia.prototype.updatePaintArrays=function(e,t,r,u,f){var m=!1;for(var S in e)for(var P=0,V=t.getPositions(S);P<V.length;P+=1){var re=V[P],he=r.feature(re.index);for(var _e in this.binders){var we=this.binders[_e];if((we instanceof xa||we instanceof Zn||we instanceof Ca)&&we.expression.isStateDependent===!0){var lt=u.paint.get(_e);we.expression=lt.value,we.updatePaintArray(re.start,re.end,he,e[S],f),m=!0}}}return m},ia.prototype.defines=function(){var e=[];for(var t in this.binders){var r=this.binders[t];(r instanceof _n||r instanceof ua)&&e.push.apply(e,r.uniformNames.map(function(u){return"#define HAS_UNIFORM_"+u}))}return e},ia.prototype.getBinderAttributes=function(){var e=[];for(var t in this.binders){var r=this.binders[t];if(r instanceof xa||r instanceof Zn)for(var u=0;u<r.paintVertexAttributes.length;u++)e.push(r.paintVertexAttributes[u].name);else if(r instanceof Ca)for(var f=0;f<Ft.members.length;f++)e.push(Ft.members[f].name)}return e},ia.prototype.getBinderUniforms=function(){var e=[];for(var t in this.binders){var r=this.binders[t];if(r instanceof _n||r instanceof ua||r instanceof Zn)for(var u=0,f=r.uniformNames;u<f.length;u+=1)e.push(f[u])}return e},ia.prototype.getPaintVertexBuffers=function(){return this._buffers},ia.prototype.getUniforms=function(e,t){var r=[];for(var u in this.binders){var f=this.binders[u];if(f instanceof _n||f instanceof ua||f instanceof Zn)for(var m=0,S=f.uniformNames;m<S.length;m+=1){var P=S[m];if(t[P]){var V=f.getBinding(e,t[P],P);r.push({name:P,property:u,binding:V})}}}return r},ia.prototype.setUniforms=function(e,t,r,u){for(var f=0,m=t;f<m.length;f+=1){var S=m[f],P=S.name,V=S.property;this.binders[V].setUniform(S.binding,u,r.get(V),P)}},ia.prototype.updatePaintBuffers=function(e){for(var t in this._buffers=[],this.binders){var r=this.binders[t];if(e&&r instanceof Ca){var u=e.fromScale===2?r.zoomInPaintVertexBuffer:r.zoomOutPaintVertexBuffer;u&&this._buffers.push(u)}else(r instanceof xa||r instanceof Zn)&&r.paintVertexBuffer&&this._buffers.push(r.paintVertexBuffer)}},ia.prototype.upload=function(e){for(var t in this.binders){var r=this.binders[t];(r instanceof xa||r instanceof Zn||r instanceof Ca)&&r.upload(e)}this.updatePaintBuffers()},ia.prototype.destroy=function(){for(var e in this.binders){var t=this.binders[e];(t instanceof xa||t instanceof Zn||t instanceof Ca)&&t.destroy()}};var La=function(t,r,u){u===void 0&&(u=function(){return!0}),this.programConfigurations={};for(var f=0,m=t;f<m.length;f+=1){var S=m[f];this.programConfigurations[S.id]=new ia(S,r,u)}this.needsUpload=!1,this._featureMap=new ar,this._bufferOffset=0};function za(e,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[e]||[e.replace(t+"-","").replace(/-/g,"_")]}function Hi(e,t,r){var u={color:{source:Fc,composite:ac},number:{source:Gu,composite:Fc}},f=function(m){return{"line-pattern":{source:Gs,composite:Gs},"fill-pattern":{source:Gs,composite:Gs},"fill-extrusion-pattern":{source:Gs,composite:Gs}}[m]}(e);return f&&f[r]||u[t][r]}La.prototype.populatePaintArrays=function(e,t,r,u,f,m){for(var S in this.programConfigurations)this.programConfigurations[S].populatePaintArrays(e,t,u,f,m);t.id!==void 0&&this._featureMap.add(t.id,r,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0},La.prototype.updatePaintArrays=function(e,t,r,u){for(var f=0,m=r;f<m.length;f+=1){var S=m[f];this.needsUpload=this.programConfigurations[S.id].updatePaintArrays(e,this._featureMap,t,S,u)||this.needsUpload}},La.prototype.get=function(e){return this.programConfigurations[e]},La.prototype.upload=function(e){if(this.needsUpload){for(var t in this.programConfigurations)this.programConfigurations[t].upload(e);this.needsUpload=!1}},La.prototype.destroy=function(){for(var e in this.programConfigurations)this.programConfigurations[e].destroy()},Rn("ConstantBinder",_n),Rn("CrossFadedConstantBinder",ua),Rn("SourceExpressionBinder",xa),Rn("CrossFadedCompositeBinder",Ca),Rn("CompositeExpressionBinder",Zn),Rn("ProgramConfiguration",ia,{omit:["_buffers"]}),Rn("ProgramConfigurationSet",La);var Ai=Math.pow(2,14)-1,Ni=-Ai-1;function Ei(e){for(var t=8192/e.extent,r=e.loadGeometry(),u=0;u<r.length;u++)for(var f=r[u],m=0;m<f.length;m++){var S=f[m],P=Math.round(S.x*t),V=Math.round(S.y*t);S.x=Se(P,Ni,Ai),S.y=Se(V,Ni,Ai),(P<S.x||P>S.x+1||V<S.y||V>S.y+1)&&Me("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return r}function Bi(e,t){return{type:e.type,id:e.id,properties:e.properties,geometry:t?Ei(e):[]}}function es(e,t,r,u,f){e.emplaceBack(2*t+(u+1)/2,2*r+(f+1)/2)}var ts=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(r){return r.id}),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new mu,this.indexArray=new Al,this.segments=new nt,this.programConfigurations=new La(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(function(r){return r.isStateDependent()}).map(function(r){return r.id})};function vu(e,t){for(var r=0;r<e.length;r++)if(ru(t,e[r]))return!0;for(var u=0;u<t.length;u++)if(ru(e,t[u]))return!0;return!!Ou(e,t)}function wu(e,t,r){return!!ru(e,t)||!!tu(t,e,r)}function hs(e,t){if(e.length===1)return oc(t,e[0]);for(var r=0;r<t.length;r++)for(var u=t[r],f=0;f<u.length;f++)if(ru(e,u[f]))return!0;for(var m=0;m<e.length;m++)if(oc(t,e[m]))return!0;for(var S=0;S<t.length;S++)if(Ou(e,t[S]))return!0;return!1}function Hs(e,t,r){if(e.length>1){if(Ou(e,t))return!0;for(var u=0;u<t.length;u++)if(tu(t[u],e,r))return!0}for(var f=0;f<e.length;f++)if(tu(e[f],t,r))return!0;return!1}function Ou(e,t){if(e.length===0||t.length===0)return!1;for(var r=0;r<e.length-1;r++)for(var u=e[r],f=e[r+1],m=0;m<t.length-1;m++)if(ic(u,f,t[m],t[m+1]))return!0;return!1}function ic(e,t,r,u){return ht(e,r,u)!==ht(t,r,u)&&ht(e,t,r)!==ht(e,t,u)}function tu(e,t,r){var u=r*r;if(t.length===1)return e.distSqr(t[0])<u;for(var f=1;f<t.length;f++)if(Hu(e,t[f-1],t[f])<u)return!0;return!1}function Hu(e,t,r){var u=t.distSqr(r);if(u===0)return e.distSqr(t);var f=((e.x-t.x)*(r.x-t.x)+(e.y-t.y)*(r.y-t.y))/u;return e.distSqr(f<0?t:f>1?r:r.sub(t)._mult(f)._add(t))}function oc(e,t){for(var r,u,f,m=!1,S=0;S<e.length;S++)for(var P=0,V=(r=e[S]).length-1;P<r.length;V=P++)(u=r[P]).y>t.y!=(f=r[V]).y>t.y&&t.x<(f.x-u.x)*(t.y-u.y)/(f.y-u.y)+u.x&&(m=!m);return m}function ru(e,t){for(var r=!1,u=0,f=e.length-1;u<e.length;f=u++){var m=e[u],S=e[f];m.y>t.y!=S.y>t.y&&t.x<(S.x-m.x)*(t.y-m.y)/(S.y-m.y)+m.x&&(r=!r)}return r}function Mu(e,t,r){var u=r[0],f=r[2];if(e.x<u.x&&t.x<u.x||e.x>f.x&&t.x>f.x||e.y<u.y&&t.y<u.y||e.y>f.y&&t.y>f.y)return!1;var m=ht(e,t,r[0]);return m!==ht(e,t,r[1])||m!==ht(e,t,r[2])||m!==ht(e,t,r[3])}function ds(e,t,r){var u=t.paint.get(e).value;return u.kind==="constant"?u.value:r.programConfigurations.get(t.id).getMaxValue(e)}function ao(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function Zu(e,t,r,u,f){if(!t[0]&&!t[1])return e;var m=ee.convert(t)._mult(f);r==="viewport"&&m._rotate(-u);for(var S=[],P=0;P<e.length;P++)S.push(e[P].sub(m));return S}ts.prototype.populate=function(e,t,r){var u=this.layers[0],f=[],m=null;u.type==="circle"&&(m=u.layout.get("circle-sort-key"));for(var S=0,P=e;S<P.length;S+=1){var V=P[S],re=V.feature,he=V.id,_e=V.index,we=V.sourceLayerIndex,lt=this.layers[0]._featureFilter.needGeometry,Lt=Bi(re,lt);if(this.layers[0]._featureFilter.filter(new Pa(this.zoom),Lt,r)){var Ct=m?m.evaluate(Lt,{},r):void 0,$t={id:he,properties:re.properties,type:re.type,sourceLayerIndex:we,index:_e,geometry:lt?Lt.geometry:Ei(re),patterns:{},sortKey:Ct};f.push($t)}}m&&f.sort(function(hn,Ln){return hn.sortKey-Ln.sortKey});for(var Xt=0,ir=f;Xt<ir.length;Xt+=1){var br=ir[Xt],Sr=br.geometry,Fr=br.index,Nr=br.sourceLayerIndex,mn=e[Fr].feature;this.addFeature(br,Sr,Fr,r),t.featureIndex.insert(mn,Sr,Fr,Nr,this.index)}},ts.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},ts.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},ts.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},ts.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,$e),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},ts.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},ts.prototype.addFeature=function(e,t,r,u){for(var f=0,m=t;f<m.length;f+=1)for(var S=0,P=m[f];S<P.length;S+=1){var V=P[S],re=V.x,he=V.y;if(!(re<0||re>=8192||he<0||he>=8192)){var _e=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),we=_e.vertexLength;es(this.layoutVertexArray,re,he,-1,-1),es(this.layoutVertexArray,re,he,1,-1),es(this.layoutVertexArray,re,he,1,1),es(this.layoutVertexArray,re,he,-1,1),this.indexArray.emplaceBack(we,we+1,we+2),this.indexArray.emplaceBack(we,we+3,we+2),_e.vertexLength+=4,_e.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,{},u)},Rn("CircleBucket",ts,{omit:["layers"]});var Vl=new vo({"circle-sort-key":new jn(Ze.layout_circle["circle-sort-key"])}),ps={paint:new vo({"circle-radius":new jn(Ze.paint_circle["circle-radius"]),"circle-color":new jn(Ze.paint_circle["circle-color"]),"circle-blur":new jn(Ze.paint_circle["circle-blur"]),"circle-opacity":new jn(Ze.paint_circle["circle-opacity"]),"circle-translate":new Jn(Ze.paint_circle["circle-translate"]),"circle-translate-anchor":new Jn(Ze.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Jn(Ze.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Jn(Ze.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new jn(Ze.paint_circle["circle-stroke-width"]),"circle-stroke-color":new jn(Ze.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new jn(Ze.paint_circle["circle-stroke-opacity"])}),layout:Vl},No=typeof Float32Array!="undefined"?Float32Array:Array;function ko(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Ko(e,t,r){var u=t[0],f=t[1],m=t[2],S=t[3],P=t[4],V=t[5],re=t[6],he=t[7],_e=t[8],we=t[9],lt=t[10],Lt=t[11],Ct=t[12],$t=t[13],Xt=t[14],ir=t[15],br=r[0],Sr=r[1],Fr=r[2],Nr=r[3];return e[0]=br*u+Sr*P+Fr*_e+Nr*Ct,e[1]=br*f+Sr*V+Fr*we+Nr*$t,e[2]=br*m+Sr*re+Fr*lt+Nr*Xt,e[3]=br*S+Sr*he+Fr*Lt+Nr*ir,e[4]=(br=r[4])*u+(Sr=r[5])*P+(Fr=r[6])*_e+(Nr=r[7])*Ct,e[5]=br*f+Sr*V+Fr*we+Nr*$t,e[6]=br*m+Sr*re+Fr*lt+Nr*Xt,e[7]=br*S+Sr*he+Fr*Lt+Nr*ir,e[8]=(br=r[8])*u+(Sr=r[9])*P+(Fr=r[10])*_e+(Nr=r[11])*Ct,e[9]=br*f+Sr*V+Fr*we+Nr*$t,e[10]=br*m+Sr*re+Fr*lt+Nr*Xt,e[11]=br*S+Sr*he+Fr*Lt+Nr*ir,e[12]=(br=r[12])*u+(Sr=r[13])*P+(Fr=r[14])*_e+(Nr=r[15])*Ct,e[13]=br*f+Sr*V+Fr*we+Nr*$t,e[14]=br*m+Sr*re+Fr*lt+Nr*Xt,e[15]=br*S+Sr*he+Fr*Lt+Nr*ir,e}Math.hypot||(Math.hypot=function(){for(var e=arguments,t=0,r=arguments.length;r--;)t+=e[r]*e[r];return Math.sqrt(t)});var Ao,uo=Ko;function Ns(e,t,r){var u=t[0],f=t[1],m=t[2],S=t[3];return e[0]=r[0]*u+r[4]*f+r[8]*m+r[12]*S,e[1]=r[1]*u+r[5]*f+r[9]*m+r[13]*S,e[2]=r[2]*u+r[6]*f+r[10]*m+r[14]*S,e[3]=r[3]*u+r[7]*f+r[11]*m+r[15]*S,e}Ao=new No(3),No!=Float32Array&&(Ao[0]=0,Ao[1]=0,Ao[2]=0),function(){var e=new No(4);No!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0)}();var nu=(function(){var e=new No(2);No!=Float32Array&&(e[0]=0,e[1]=0)}(),function(e){function t(r){e.call(this,r,ps)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(r){return new ts(r)},t.prototype.queryRadius=function(r){var u=r;return ds("circle-radius",this,u)+ds("circle-stroke-width",this,u)+ao(this.paint.get("circle-translate"))},t.prototype.queryIntersectsFeature=function(r,u,f,m,S,P,V,re){for(var he=Zu(r,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),P.angle,V),_e=this.paint.get("circle-radius").evaluate(u,f)+this.paint.get("circle-stroke-width").evaluate(u,f),we=this.paint.get("circle-pitch-alignment")==="map",lt=we?he:function(mn,hn){return mn.map(function(Ln){return Gl(Ln,hn)})}(he,re),Lt=we?_e*V:_e,Ct=0,$t=m;Ct<$t.length;Ct+=1)for(var Xt=0,ir=$t[Ct];Xt<ir.length;Xt+=1){var br=ir[Xt],Sr=we?br:Gl(br,re),Fr=Lt,Nr=Ns([],[br.x,br.y,0,1],re);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?Fr*=Nr[3]/P.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(Fr*=P.cameraToCenterDistance/Nr[3]),wu(lt,Sr,Fr))return!0}return!1},t}(ws));function Gl(e,t){var r=Ns([],[e.x,e.y,0,1],t);return new ee(r[0]/r[3],r[1]/r[3])}var Uc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(ts);function fl(e,t,r,u){var f=t.width,m=t.height;if(u){if(u instanceof Uint8ClampedArray)u=new Uint8Array(u.buffer);else if(u.length!==f*m*r)throw new RangeError("mismatched image size")}else u=new Uint8Array(f*m*r);return e.width=f,e.height=m,e.data=u,e}function sc(e,t,r){var u=t.width,f=t.height;if(u!==e.width||f!==e.height){var m=fl({},{width:u,height:f},r);hl(e,m,{x:0,y:0},{x:0,y:0},{width:Math.min(e.width,u),height:Math.min(e.height,f)},r),e.width=u,e.height=f,e.data=m.data}}function hl(e,t,r,u,f,m){if(f.width===0||f.height===0)return t;if(f.width>e.width||f.height>e.height||r.x>e.width-f.width||r.y>e.height-f.height)throw new RangeError("out of range source coordinates for image copy");if(f.width>t.width||f.height>t.height||u.x>t.width-f.width||u.y>t.height-f.height)throw new RangeError("out of range destination coordinates for image copy");for(var S=e.data,P=t.data,V=0;V<f.height;V++)for(var re=((r.y+V)*e.width+r.x)*m,he=((u.y+V)*t.width+u.x)*m,_e=0;_e<f.width*m;_e++)P[he+_e]=S[re+_e];return t}Rn("HeatmapBucket",Uc,{omit:["layers"]});var ks=function(t,r){fl(this,t,1,r)};ks.prototype.resize=function(e){sc(this,e,1)},ks.prototype.clone=function(){return new ks({width:this.width,height:this.height},new Uint8Array(this.data))},ks.copy=function(e,t,r,u,f){hl(e,t,r,u,f,1)};var go=function(t,r){fl(this,t,4,r)};go.prototype.resize=function(e){sc(this,e,4)},go.prototype.replace=function(e,t){t?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e},go.prototype.clone=function(){return new go({width:this.width,height:this.height},new Uint8Array(this.data))},go.copy=function(e,t,r,u,f){hl(e,t,r,u,f,4)},Rn("AlphaImage",ks),Rn("RGBAImage",go);var _c={paint:new vo({"heatmap-radius":new jn(Ze.paint_heatmap["heatmap-radius"]),"heatmap-weight":new jn(Ze.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Jn(Ze.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Do(Ze.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Jn(Ze.paint_heatmap["heatmap-opacity"])})};function ms(e){var t={},r=e.resolution||256,u=e.clips?e.clips.length:1,f=e.image||new go({width:r,height:u}),m=function(Ct,$t,Xt){t[e.evaluationKey]=Xt;var ir=e.expression.evaluate(t);f.data[Ct+$t+0]=Math.floor(255*ir.r/ir.a),f.data[Ct+$t+1]=Math.floor(255*ir.g/ir.a),f.data[Ct+$t+2]=Math.floor(255*ir.b/ir.a),f.data[Ct+$t+3]=Math.floor(255*ir.a)};if(e.clips)for(var S=0,P=0;S<u;++S,P+=4*r)for(var V=0,re=0;V<r;V++,re+=4){var he=V/(r-1),_e=e.clips[S];m(P,re,_e.start*(1-he)+_e.end*he)}else for(var we=0,lt=0;we<r;we++,lt+=4)m(0,lt,we/(r-1));return f}var af=function(e){function t(r){e.call(this,r,_c),this._updateColorRamp()}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(r){return new Uc(r)},t.prototype._handleSpecialPaintPropertyUpdate=function(r){r==="heatmap-color"&&this._updateColorRamp()},t.prototype._updateColorRamp=function(){this.colorRamp=ms({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null},t.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t.prototype.hasOffscreenPass=function(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"},t}(ws),Sf={paint:new vo({"hillshade-illumination-direction":new Jn(Ze.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Jn(Ze.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Jn(Ze.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Jn(Ze.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Jn(Ze.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Jn(Ze.paint_hillshade["hillshade-accent-color"])})},Af=function(e){function t(r){e.call(this,r,Sf)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.hasOffscreenPass=function(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"},t}(ws),Sc=no([{name:"a_pos",components:2,type:"Int16"}],4).members,Wu=of,bf=of;function of(e,t,r){r=r||2;var u,f,m,S,P,V,re,he=t&&t.length,_e=he?t[0]*r:e.length,we=Cf(e,0,_e,r,!0),lt=[];if(!we||we.next===we.prev)return lt;if(he&&(we=function(Ct,$t,Xt,ir){var br,Sr,Fr,Nr=[];for(br=0,Sr=$t.length;br<Sr;br++)(Fr=Cf(Ct,$t[br]*ir,br<Sr-1?$t[br+1]*ir:Ct.length,ir,!1))===Fr.next&&(Fr.steiner=!0),Nr.push(eh(Fr));for(Nr.sort(Jf),br=0;br<Nr.length;br++)Qf(Nr[br],Xt),Xt=Pu(Xt,Xt.next);return Xt}(e,t,we,r)),e.length>80*r){u=m=e[0],f=S=e[1];for(var Lt=r;Lt<_e;Lt+=r)(P=e[Lt])<u&&(u=P),(V=e[Lt+1])<f&&(f=V),P>m&&(m=P),V>S&&(S=V);re=(re=Math.max(m-u,S-f))!==0?1/re:0}return uc(we,lt,r,u,f,re),lt}function Cf(e,t,r,u,f){var m,S;if(f===Gc(e,t,r,u)>0)for(m=t;m<r;m+=u)S=Df(m,e[m],e[m+1],S);else for(m=r-u;m>=t;m-=u)S=Df(m,e[m],e[m+1],S);return S&&lc(S,S.next)&&(Vc(S),S=S.next),S}function Pu(e,t){if(!e)return e;t||(t=e);var r,u=e;do if(r=!1,u.steiner||!lc(u,u.next)&&io(u.prev,u,u.next)!==0)u=u.next;else{if(Vc(u),(u=t=u.prev)===u.next)break;r=!0}while(r||u!==t);return t}function uc(e,t,r,u,f,m,S){if(e){!S&&m&&function(he,_e,we,lt){var Lt=he;do Lt.z===null&&(Lt.z=wf(Lt.x,Lt.y,_e,we,lt)),Lt.prevZ=Lt.prev,Lt.nextZ=Lt.next,Lt=Lt.next;while(Lt!==he);Lt.prevZ.nextZ=null,Lt.prevZ=null,function(Ct){var $t,Xt,ir,br,Sr,Fr,Nr,mn,hn=1;do{for(Xt=Ct,Ct=null,Sr=null,Fr=0;Xt;){for(Fr++,ir=Xt,Nr=0,$t=0;$t<hn&&(Nr++,ir=ir.nextZ);$t++);for(mn=hn;Nr>0||mn>0&&ir;)Nr!==0&&(mn===0||!ir||Xt.z<=ir.z)?(br=Xt,Xt=Xt.nextZ,Nr--):(br=ir,ir=ir.nextZ,mn--),Sr?Sr.nextZ=br:Ct=br,br.prevZ=Sr,Sr=br;Xt=ir}Sr.nextZ=null,hn*=2}while(Fr>1)}(Lt)}(e,u,f,m);for(var P,V,re=e;e.prev!==e.next;)if(P=e.prev,V=e.next,m?Bc(e,u,f,m):If(e))t.push(P.i/r),t.push(e.i/r),t.push(V.i/r),Vc(e),e=V.next,re=V.next;else if((e=V)===re){S?S===1?uc(e=Ac(Pu(e),t,r),t,r,u,f,m,2):S===2&&$f(e,t,r,u,f,m):uc(Pu(e),t,r,u,f,m,1);break}}}function If(e){var t=e.prev,r=e,u=e.next;if(io(t,r,u)>=0)return!1;for(var f=e.next.next;f!==e.prev;){if(Hl(t.x,t.y,r.x,r.y,u.x,u.y,f.x,f.y)&&io(f.prev,f,f.next)>=0)return!1;f=f.next}return!0}function Bc(e,t,r,u){var f=e.prev,m=e,S=e.next;if(io(f,m,S)>=0)return!1;for(var P=f.x>m.x?f.x>S.x?f.x:S.x:m.x>S.x?m.x:S.x,V=f.y>m.y?f.y>S.y?f.y:S.y:m.y>S.y?m.y:S.y,re=wf(f.x<m.x?f.x<S.x?f.x:S.x:m.x<S.x?m.x:S.x,f.y<m.y?f.y<S.y?f.y:S.y:m.y<S.y?m.y:S.y,t,r,u),he=wf(P,V,t,r,u),_e=e.prevZ,we=e.nextZ;_e&&_e.z>=re&&we&&we.z<=he;){if(_e!==e.prev&&_e!==e.next&&Hl(f.x,f.y,m.x,m.y,S.x,S.y,_e.x,_e.y)&&io(_e.prev,_e,_e.next)>=0)return!1;if(_e=_e.prevZ,we!==e.prev&&we!==e.next&&Hl(f.x,f.y,m.x,m.y,S.x,S.y,we.x,we.y)&&io(we.prev,we,we.next)>=0)return!1;we=we.nextZ}for(;_e&&_e.z>=re;){if(_e!==e.prev&&_e!==e.next&&Hl(f.x,f.y,m.x,m.y,S.x,S.y,_e.x,_e.y)&&io(_e.prev,_e,_e.next)>=0)return!1;_e=_e.prevZ}for(;we&&we.z<=he;){if(we!==e.prev&&we!==e.next&&Hl(f.x,f.y,m.x,m.y,S.x,S.y,we.x,we.y)&&io(we.prev,we,we.next)>=0)return!1;we=we.nextZ}return!0}function Ac(e,t,r){var u=e;do{var f=u.prev,m=u.next.next;!lc(f,m)&&xf(f,u,u.next,m)&&Cl(f,m)&&Cl(m,f)&&(t.push(f.i/r),t.push(u.i/r),t.push(m.i/r),Vc(u),Vc(u.next),u=e=m),u=u.next}while(u!==e);return Pu(u)}function $f(e,t,r,u,f,m){var S=e;do{for(var P=S.next.next;P!==S.prev;){if(S.i!==P.i&&sf(S,P)){var V=Ef(S,P);return S=Pu(S,S.next),V=Pu(V,V.next),uc(S,t,r,u,f,m),void uc(V,t,r,u,f,m)}P=P.next}S=S.next}while(S!==e)}function Jf(e,t){return e.x-t.x}function Qf(e,t){if(t=function(u,f){var m,S=f,P=u.x,V=u.y,re=-1/0;do{if(V<=S.y&&V>=S.next.y&&S.next.y!==S.y){var he=S.x+(V-S.y)*(S.next.x-S.x)/(S.next.y-S.y);if(he<=P&&he>re){if(re=he,he===P){if(V===S.y)return S;if(V===S.next.y)return S.next}m=S.x<S.next.x?S:S.next}}S=S.next}while(S!==f);if(!m)return null;if(P===re)return m;var _e,we=m,lt=m.x,Lt=m.y,Ct=1/0;S=m;do P>=S.x&&S.x>=lt&&P!==S.x&&Hl(V<Lt?P:re,V,lt,Lt,V<Lt?re:P,V,S.x,S.y)&&(_e=Math.abs(V-S.y)/(P-S.x),Cl(S,u)&&(_e<Ct||_e===Ct&&(S.x>m.x||S.x===m.x&&qf(m,S)))&&(m=S,Ct=_e)),S=S.next;while(S!==we);return m}(e,t)){var r=Ef(t,e);Pu(t,t.next),Pu(r,r.next)}}function qf(e,t){return io(e.prev,e,t.prev)<0&&io(t.next,e,e.next)<0}function wf(e,t,r,u,f){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*f)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-u)*f)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function eh(e){var t=e,r=e;do(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next;while(t!==e);return r}function Hl(e,t,r,u,f,m,S,P){return(f-S)*(t-P)-(e-S)*(m-P)>=0&&(e-S)*(u-P)-(r-S)*(t-P)>=0&&(r-S)*(m-P)-(f-S)*(u-P)>=0}function sf(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(r,u){var f=r;do{if(f.i!==r.i&&f.next.i!==r.i&&f.i!==u.i&&f.next.i!==u.i&&xf(f,f.next,r,u))return!0;f=f.next}while(f!==r);return!1}(e,t)&&(Cl(e,t)&&Cl(t,e)&&function(r,u){var f=r,m=!1,S=(r.x+u.x)/2,P=(r.y+u.y)/2;do f.y>P!=f.next.y>P&&f.next.y!==f.y&&S<(f.next.x-f.x)*(P-f.y)/(f.next.y-f.y)+f.x&&(m=!m),f=f.next;while(f!==r);return m}(e,t)&&(io(e.prev,e,t.prev)||io(e,t.prev,t))||lc(e,t)&&io(e.prev,e,e.next)>0&&io(t.prev,t,t.next)>0)}function io(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function lc(e,t){return e.x===t.x&&e.y===t.y}function xf(e,t,r,u){var f=au(io(e,t,r)),m=au(io(e,t,u)),S=au(io(r,u,e)),P=au(io(r,u,t));return f!==m&&S!==P||!(f!==0||!Cc(e,r,t))||!(m!==0||!Cc(e,u,t))||!(S!==0||!Cc(r,e,u))||!(P!==0||!Cc(r,t,u))}function Cc(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function au(e){return e>0?1:e<0?-1:0}function Cl(e,t){return io(e.prev,e,e.next)<0?io(e,t,e.next)>=0&&io(e,e.prev,t)>=0:io(e,t,e.prev)<0||io(e,e.next,t)<0}function Ef(e,t){var r=new uf(e.i,e.x,e.y),u=new uf(t.i,t.x,t.y),f=e.next,m=t.prev;return e.next=t,t.prev=e,r.next=f,f.prev=r,u.next=r,r.prev=u,m.next=u,u.prev=m,u}function Df(e,t,r,u){var f=new uf(e,t,r);return u?(f.next=u.next,f.prev=u,u.next.prev=f,u.next=f):(f.prev=f,f.next=f),f}function Vc(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function uf(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Gc(e,t,r,u){for(var f=0,m=t,S=r-u;m<r;m+=u)f+=(e[S]-e[m])*(e[m+1]+e[S+1]),S=m;return f}function dl(e,t,r,u,f){!function m(S,P,V,re,he){for(;re>V;){if(re-V>600){var _e=re-V+1,we=P-V+1,lt=Math.log(_e),Lt=.5*Math.exp(2*lt/3),Ct=.5*Math.sqrt(lt*Lt*(_e-Lt)/_e)*(we-_e/2<0?-1:1);m(S,P,Math.max(V,Math.floor(P-we*Lt/_e+Ct)),Math.min(re,Math.floor(P+(_e-we)*Lt/_e+Ct)),he)}var $t=S[P],Xt=V,ir=re;for(ne(S,V,P),he(S[re],$t)>0&&ne(S,V,re);Xt<ir;){for(ne(S,Xt,ir),Xt++,ir--;he(S[Xt],$t)<0;)Xt++;for(;he(S[ir],$t)>0;)ir--}he(S[V],$t)===0?ne(S,V,ir):ne(S,++ir,re),ir<=P&&(V=ir+1),P<=ir&&(re=ir-1)}}(e,t,r||0,u||e.length-1,f||se)}function ne(e,t,r){var u=e[t];e[t]=e[r],e[r]=u}function se(e,t){return e<t?-1:e>t?1:0}function N(e,t){var r=e.length;if(r<=1)return[e];for(var u,f,m=[],S=0;S<r;S++){var P=Wt(e[S]);P!==0&&(e[S].area=Math.abs(P),f===void 0&&(f=P<0),f===P<0?(u&&m.push(u),u=[e[S]]):u.push(e[S]))}if(u&&m.push(u),t>1)for(var V=0;V<m.length;V++)m[V].length<=t||(dl(m[V],t,1,m[V].length-1,G),m[V]=m[V].slice(0,t));return m}function G(e,t){return t.area-e.area}function Ce(e,t,r){for(var u=r.patternDependencies,f=!1,m=0,S=t;m<S.length;m+=1){var P=S[m].paint.get(e+"-pattern");P.isConstant()||(f=!0);var V=P.constantOr(null);V&&(f=!0,u[V.to]=!0,u[V.from]=!0)}return f}function ft(e,t,r,u,f){for(var m=f.patternDependencies,S=0,P=t;S<P.length;S+=1){var V=P[S],re=V.paint.get(e+"-pattern").value;if(re.kind!=="constant"){var he=re.evaluate({zoom:u-1},r,{},f.availableImages),_e=re.evaluate({zoom:u},r,{},f.availableImages),we=re.evaluate({zoom:u+1},r,{},f.availableImages);_e=_e&&_e.name?_e.name:_e,we=we&&we.name?we.name:we,m[he=he&&he.name?he.name:he]=!0,m[_e]=!0,m[we]=!0,r.patterns[V.id]={min:he,mid:_e,max:we}}}return r}of.deviation=function(e,t,r,u){var f=t&&t.length,m=Math.abs(Gc(e,0,f?t[0]*r:e.length,r));if(f)for(var S=0,P=t.length;S<P;S++)m-=Math.abs(Gc(e,t[S]*r,S<P-1?t[S+1]*r:e.length,r));var V=0;for(S=0;S<u.length;S+=3){var re=u[S]*r,he=u[S+1]*r,_e=u[S+2]*r;V+=Math.abs((e[re]-e[_e])*(e[he+1]-e[re+1])-(e[re]-e[he])*(e[_e+1]-e[re+1]))}return m===0&&V===0?0:Math.abs((V-m)/m)},of.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},u=0,f=0;f<e.length;f++){for(var m=0;m<e[f].length;m++)for(var S=0;S<t;S++)r.vertices.push(e[f][m][S]);f>0&&r.holes.push(u+=e[f-1].length)}return r},Wu.default=bf;var Yt=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(r){return r.id}),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new mu,this.indexArray=new Al,this.indexArray2=new rc,this.programConfigurations=new La(t.layers,t.zoom),this.segments=new nt,this.segments2=new nt,this.stateDependentLayerIds=this.layers.filter(function(r){return r.isStateDependent()}).map(function(r){return r.id})};Yt.prototype.populate=function(e,t,r){this.hasPattern=Ce("fill",this.layers,t);for(var u=this.layers[0].layout.get("fill-sort-key"),f=[],m=0,S=e;m<S.length;m+=1){var P=S[m],V=P.feature,re=P.id,he=P.index,_e=P.sourceLayerIndex,we=this.layers[0]._featureFilter.needGeometry,lt=Bi(V,we);if(this.layers[0]._featureFilter.filter(new Pa(this.zoom),lt,r)){var Lt=u?u.evaluate(lt,{},r,t.availableImages):void 0,Ct={id:re,properties:V.properties,type:V.type,sourceLayerIndex:_e,index:he,geometry:we?lt.geometry:Ei(V),patterns:{},sortKey:Lt};f.push(Ct)}}u&&f.sort(function(mn,hn){return mn.sortKey-hn.sortKey});for(var $t=0,Xt=f;$t<Xt.length;$t+=1){var ir=Xt[$t],br=ir.geometry,Sr=ir.index,Fr=ir.sourceLayerIndex;if(this.hasPattern){var Nr=ft("fill",this.layers,ir,this.zoom,t);this.patternFeatures.push(Nr)}else this.addFeature(ir,br,Sr,r,{});t.featureIndex.insert(e[Sr].feature,br,Sr,Fr,this.index)}},Yt.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},Yt.prototype.addFeatures=function(e,t,r){for(var u=0,f=this.patternFeatures;u<f.length;u+=1){var m=f[u];this.addFeature(m,m.geometry,m.index,t,r)}},Yt.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Yt.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Yt.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Sc),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0},Yt.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},Yt.prototype.addFeature=function(e,t,r,u,f){for(var m=0,S=N(t,500);m<S.length;m+=1){for(var P=S[m],V=0,re=0,he=P;re<he.length;re+=1)V+=he[re].length;for(var _e=this.segments.prepareSegment(V,this.layoutVertexArray,this.indexArray),we=_e.vertexLength,lt=[],Lt=[],Ct=0,$t=P;Ct<$t.length;Ct+=1){var Xt=$t[Ct];if(Xt.length!==0){Xt!==P[0]&&Lt.push(lt.length/2);var ir=this.segments2.prepareSegment(Xt.length,this.layoutVertexArray,this.indexArray2),br=ir.vertexLength;this.layoutVertexArray.emplaceBack(Xt[0].x,Xt[0].y),this.indexArray2.emplaceBack(br+Xt.length-1,br),lt.push(Xt[0].x),lt.push(Xt[0].y);for(var Sr=1;Sr<Xt.length;Sr++)this.layoutVertexArray.emplaceBack(Xt[Sr].x,Xt[Sr].y),this.indexArray2.emplaceBack(br+Sr-1,br+Sr),lt.push(Xt[Sr].x),lt.push(Xt[Sr].y);ir.vertexLength+=Xt.length,ir.primitiveLength+=Xt.length}}for(var Fr=Wu(lt,Lt),Nr=0;Nr<Fr.length;Nr+=3)this.indexArray.emplaceBack(we+Fr[Nr],we+Fr[Nr+1],we+Fr[Nr+2]);_e.vertexLength+=V,_e.primitiveLength+=Fr.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,f,u)},Rn("FillBucket",Yt,{omit:["layers","patternFeatures"]});var sr=new vo({"fill-sort-key":new jn(Ze.layout_fill["fill-sort-key"])}),or={paint:new vo({"fill-antialias":new Jn(Ze.paint_fill["fill-antialias"]),"fill-opacity":new jn(Ze.paint_fill["fill-opacity"]),"fill-color":new jn(Ze.paint_fill["fill-color"]),"fill-outline-color":new jn(Ze.paint_fill["fill-outline-color"]),"fill-translate":new Jn(Ze.paint_fill["fill-translate"]),"fill-translate-anchor":new Jn(Ze.paint_fill["fill-translate-anchor"]),"fill-pattern":new Ec(Ze.paint_fill["fill-pattern"])}),layout:sr},Dr=function(e){function t(r){e.call(this,r,or)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.recalculate=function(r,u){e.prototype.recalculate.call(this,r,u);var f=this.paint._values["fill-outline-color"];f.value.kind==="constant"&&f.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},t.prototype.createBucket=function(r){return new Yt(r)},t.prototype.queryRadius=function(){return ao(this.paint.get("fill-translate"))},t.prototype.queryIntersectsFeature=function(r,u,f,m,S,P,V){return hs(Zu(r,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),P.angle,V),m)},t.prototype.isTileClipped=function(){return!0},t}(ws),sn=no([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,Hn=ea;function ea(e,t,r,u,f){this.properties={},this.extent=r,this.type=0,this._pbf=e,this._geometry=-1,this._keys=u,this._values=f,e.readFields(la,this,t)}function la(e,t,r){e==1?t.id=r.readVarint():e==2?function(u,f){for(var m=u.readVarint()+u.pos;u.pos<m;){var S=f._keys[u.readVarint()],P=f._values[u.readVarint()];f.properties[S]=P}}(r,t):e==3?t.type=r.readVarint():e==4&&(t._geometry=r.pos)}function ti(e){for(var t,r,u=0,f=0,m=e.length,S=m-1;f<m;S=f++)u+=((r=e[S]).x-(t=e[f]).x)*(t.y+r.y);return u}ea.types=["Unknown","Point","LineString","Polygon"],ea.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var t,r=e.readVarint()+e.pos,u=1,f=0,m=0,S=0,P=[];e.pos<r;){if(f<=0){var V=e.readVarint();u=7&V,f=V>>3}if(f--,u===1||u===2)m+=e.readSVarint(),S+=e.readSVarint(),u===1&&(t&&P.push(t),t=[]),t.push(new ee(m,S));else{if(u!==7)throw new Error("unknown command "+u);t&&t.push(t[0].clone())}}return t&&P.push(t),P},ea.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,r=1,u=0,f=0,m=0,S=1/0,P=-1/0,V=1/0,re=-1/0;e.pos<t;){if(u<=0){var he=e.readVarint();r=7&he,u=he>>3}if(u--,r===1||r===2)(f+=e.readSVarint())<S&&(S=f),f>P&&(P=f),(m+=e.readSVarint())<V&&(V=m),m>re&&(re=m);else if(r!==7)throw new Error("unknown command "+r)}return[S,V,P,re]},ea.prototype.toGeoJSON=function(e,t,r){var u,f,m=this.extent*Math.pow(2,r),S=this.extent*e,P=this.extent*t,V=this.loadGeometry(),re=ea.types[this.type];function he(lt){for(var Lt=0;Lt<lt.length;Lt++){var Ct=lt[Lt];lt[Lt]=[360*(Ct.x+S)/m-180,360/Math.PI*Math.atan(Math.exp((180-360*(Ct.y+P)/m)*Math.PI/180))-90]}}switch(this.type){case 1:var _e=[];for(u=0;u<V.length;u++)_e[u]=V[u][0];he(V=_e);break;case 2:for(u=0;u<V.length;u++)he(V[u]);break;case 3:for(V=function(lt){var Lt=lt.length;if(Lt<=1)return[lt];for(var Ct,$t,Xt=[],ir=0;ir<Lt;ir++){var br=ti(lt[ir]);br!==0&&($t===void 0&&($t=br<0),$t===br<0?(Ct&&Xt.push(Ct),Ct=[lt[ir]]):Ct.push(lt[ir]))}return Ct&&Xt.push(Ct),Xt}(V),u=0;u<V.length;u++)for(f=0;f<V[u].length;f++)he(V[u][f])}V.length===1?V=V[0]:re="Multi"+re;var we={type:"Feature",geometry:{type:re,coordinates:V},properties:this.properties};return"id"in this&&(we.id=this.id),we};var ja=Ti;function Ti(e,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(Qa,this,t),this.length=this._features.length}function Qa(e,t,r){e===15?t.version=r.readVarint():e===1?t.name=r.readString():e===5?t.extent=r.readVarint():e===2?t._features.push(r.pos):e===3?t._keys.push(r.readString()):e===4&&t._values.push(function(u){for(var f=null,m=u.readVarint()+u.pos;u.pos<m;){var S=u.readVarint()>>3;f=S===1?u.readString():S===2?u.readFloat():S===3?u.readDouble():S===4?u.readVarint64():S===5?u.readVarint():S===6?u.readSVarint():S===7?u.readBoolean():null}return f}(r))}function Vi(e,t,r){if(e===3){var u=new ja(r,r.readVarint()+r.pos);u.length&&(t[u.name]=u)}}Ti.prototype.feature=function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var t=this._pbf.readVarint()+this._pbf.pos;return new Hn(this._pbf,t,this.extent,this._keys,this._values)};var Co={VectorTile:function(t,r){this.layers=t.readFields(Vi,{},r)},VectorTileFeature:Hn,VectorTileLayer:ja},yo=Co.VectorTileFeature.types,Zi=Math.pow(2,13);function jo(e,t,r,u,f,m,S,P){e.emplaceBack(t,r,2*Math.floor(u*Zi)+S,f*Zi*2,m*Zi*2,Math.round(P))}var qa=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(r){return r.id}),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Cu,this.indexArray=new Al,this.programConfigurations=new La(t.layers,t.zoom),this.segments=new nt,this.stateDependentLayerIds=this.layers.filter(function(r){return r.isStateDependent()}).map(function(r){return r.id})};function lo(e,t){return e.x===t.x&&(e.x<0||e.x>8192)||e.y===t.y&&(e.y<0||e.y>8192)}qa.prototype.populate=function(e,t,r){this.features=[],this.hasPattern=Ce("fill-extrusion",this.layers,t);for(var u=0,f=e;u<f.length;u+=1){var m=f[u],S=m.feature,P=m.id,V=m.index,re=m.sourceLayerIndex,he=this.layers[0]._featureFilter.needGeometry,_e=Bi(S,he);if(this.layers[0]._featureFilter.filter(new Pa(this.zoom),_e,r)){var we={id:P,sourceLayerIndex:re,index:V,geometry:he?_e.geometry:Ei(S),properties:S.properties,type:S.type,patterns:{}};this.hasPattern?this.features.push(ft("fill-extrusion",this.layers,we,this.zoom,t)):this.addFeature(we,we.geometry,V,r,{}),t.featureIndex.insert(S,we.geometry,V,re,this.index,!0)}}},qa.prototype.addFeatures=function(e,t,r){for(var u=0,f=this.features;u<f.length;u+=1){var m=f[u];this.addFeature(m,m.geometry,m.index,t,r)}},qa.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},qa.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},qa.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},qa.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,sn),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},qa.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},qa.prototype.addFeature=function(e,t,r,u,f){for(var m=0,S=N(t,500);m<S.length;m+=1){for(var P=S[m],V=0,re=0,he=P;re<he.length;re+=1)V+=he[re].length;for(var _e=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),we=0,lt=P;we<lt.length;we+=1){var Lt=lt[we];if(Lt.length!==0&&!((Ja=Lt).every(function(Da){return Da.x<0})||Ja.every(function(Da){return Da.x>8192})||Ja.every(function(Da){return Da.y<0})||Ja.every(function(Da){return Da.y>8192})))for(var Ct=0,$t=0;$t<Lt.length;$t++){var Xt=Lt[$t];if($t>=1){var ir=Lt[$t-1];if(!lo(Xt,ir)){_e.vertexLength+4>nt.MAX_VERTEX_ARRAY_LENGTH&&(_e=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var br=Xt.sub(ir)._perp()._unit(),Sr=ir.dist(Xt);Ct+Sr>32768&&(Ct=0),jo(this.layoutVertexArray,Xt.x,Xt.y,br.x,br.y,0,0,Ct),jo(this.layoutVertexArray,Xt.x,Xt.y,br.x,br.y,0,1,Ct),jo(this.layoutVertexArray,ir.x,ir.y,br.x,br.y,0,0,Ct+=Sr),jo(this.layoutVertexArray,ir.x,ir.y,br.x,br.y,0,1,Ct);var Fr=_e.vertexLength;this.indexArray.emplaceBack(Fr,Fr+2,Fr+1),this.indexArray.emplaceBack(Fr+1,Fr+2,Fr+3),_e.vertexLength+=4,_e.primitiveLength+=2}}}}if(_e.vertexLength+V>nt.MAX_VERTEX_ARRAY_LENGTH&&(_e=this.segments.prepareSegment(V,this.layoutVertexArray,this.indexArray)),yo[e.type]==="Polygon"){for(var Nr=[],mn=[],hn=_e.vertexLength,Ln=0,Qn=P;Ln<Qn.length;Ln+=1){var Yn=Qn[Ln];if(Yn.length!==0){Yn!==P[0]&&mn.push(Nr.length/2);for(var Nn=0;Nn<Yn.length;Nn++){var _a=Yn[Nn];jo(this.layoutVertexArray,_a.x,_a.y,0,0,1,1,0),Nr.push(_a.x),Nr.push(_a.y)}}}for(var fa=Wu(Nr,mn),ra=0;ra<fa.length;ra+=3)this.indexArray.emplaceBack(hn+fa[ra],hn+fa[ra+2],hn+fa[ra+1]);_e.primitiveLength+=fa.length/3,_e.vertexLength+=V}}var Ja;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,f,u)},Rn("FillExtrusionBucket",qa,{omit:["layers","features"]});var iu={paint:new vo({"fill-extrusion-opacity":new Jn(Ze["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new jn(Ze["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Jn(Ze["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Jn(Ze["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Ec(Ze["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new jn(Ze["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new jn(Ze["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Jn(Ze["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},_i=function(e){function t(r){e.call(this,r,iu)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(r){return new qa(r)},t.prototype.queryRadius=function(){return ao(this.paint.get("fill-extrusion-translate"))},t.prototype.is3D=function(){return!0},t.prototype.queryIntersectsFeature=function(r,u,f,m,S,P,V,re){var he=Zu(r,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),P.angle,V),_e=this.paint.get("fill-extrusion-height").evaluate(u,f),we=this.paint.get("fill-extrusion-base").evaluate(u,f),lt=function(Ct,$t,Xt,ir){for(var br=[],Sr=0,Fr=Ct;Sr<Fr.length;Sr+=1){var Nr=Fr[Sr],mn=[Nr.x,Nr.y,0,1];Ns(mn,mn,$t),br.push(new ee(mn[0]/mn[3],mn[1]/mn[3]))}return br}(he,re),Lt=function(Ct,$t,Xt,ir){for(var br=[],Sr=[],Fr=ir[8]*$t,Nr=ir[9]*$t,mn=ir[10]*$t,hn=ir[11]*$t,Ln=ir[8]*Xt,Qn=ir[9]*Xt,Yn=ir[10]*Xt,Nn=ir[11]*Xt,_a=0,fa=Ct;_a<fa.length;_a+=1){for(var ra=[],Ja=[],Da=0,ji=fa[_a];Da<ji.length;Da+=1){var va=ji[Da],ai=va.x,Go=va.y,bi=ir[0]*ai+ir[4]*Go+ir[12],Ho=ir[1]*ai+ir[5]*Go+ir[13],Zo=ir[2]*ai+ir[6]*Go+ir[14],ns=ir[3]*ai+ir[7]*Go+ir[15],gu=Zo+mn,as=ns+hn,Yu=bi+Ln,su=Ho+Qn,Ku=Zo+Yn,uu=ns+Nn,Ws=new ee((bi+Fr)/as,(Ho+Nr)/as);Ws.z=gu/as,ra.push(Ws);var lu=new ee(Yu/uu,su/uu);lu.z=Ku/uu,Ja.push(lu)}br.push(ra),Sr.push(Ja)}return[br,Sr]}(m,we,_e,re);return function(Ct,$t,Xt){var ir=1/0;hs(Xt,$t)&&(ir=Ea(Xt,$t[0]));for(var br=0;br<$t.length;br++)for(var Sr=$t[br],Fr=Ct[br],Nr=0;Nr<Sr.length-1;Nr++){var mn=Sr[Nr],hn=[mn,Sr[Nr+1],Fr[Nr+1],Fr[Nr],mn];vu(Xt,hn)&&(ir=Math.min(ir,Ea(Xt,hn)))}return ir!==1/0&&ir}(Lt[0],Lt[1],lt)},t}(ws);function ki(e,t){return e.x*t.x+e.y*t.y}function Ea(e,t){if(e.length===1){for(var r,u=0,f=t[u++];!r||f.equals(r);)if(!(r=t[u++]))return 1/0;for(;u<t.length;u++){var m=t[u],S=e[0],P=r.sub(f),V=m.sub(f),re=S.sub(f),he=ki(P,P),_e=ki(P,V),we=ki(V,V),lt=ki(re,P),Lt=ki(re,V),Ct=he*we-_e*_e,$t=(we*lt-_e*Lt)/Ct,Xt=(he*Lt-_e*lt)/Ct,ir=f.z*(1-$t-Xt)+r.z*$t+m.z*Xt;if(isFinite(ir))return ir}return 1/0}for(var br=1/0,Sr=0,Fr=t;Sr<Fr.length;Sr+=1)br=Math.min(br,Fr[Sr].z);return br}var wo=no([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,cc=no([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,Nf=Co.VectorTileFeature.types,oh=Math.cos(Math.PI/180*37.5),kf=Math.pow(2,14)/.5,Lu=function(t){var r=this;this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(u){return u.id}),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(function(u){r.gradients[u.id]={}}),this.layoutVertexArray=new Is,this.layoutVertexArray2=new Fc,this.indexArray=new Al,this.programConfigurations=new La(t.layers,t.zoom),this.segments=new nt,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(function(u){return u.isStateDependent()}).map(function(u){return u.id})};Lu.prototype.populate=function(e,t,r){this.hasPattern=Ce("line",this.layers,t);for(var u=this.layers[0].layout.get("line-sort-key"),f=[],m=0,S=e;m<S.length;m+=1){var P=S[m],V=P.feature,re=P.id,he=P.index,_e=P.sourceLayerIndex,we=this.layers[0]._featureFilter.needGeometry,lt=Bi(V,we);if(this.layers[0]._featureFilter.filter(new Pa(this.zoom),lt,r)){var Lt=u?u.evaluate(lt,{},r):void 0,Ct={id:re,properties:V.properties,type:V.type,sourceLayerIndex:_e,index:he,geometry:we?lt.geometry:Ei(V),patterns:{},sortKey:Lt};f.push(Ct)}}u&&f.sort(function(mn,hn){return mn.sortKey-hn.sortKey});for(var $t=0,Xt=f;$t<Xt.length;$t+=1){var ir=Xt[$t],br=ir.geometry,Sr=ir.index,Fr=ir.sourceLayerIndex;if(this.hasPattern){var Nr=ft("line",this.layers,ir,this.zoom,t);this.patternFeatures.push(Nr)}else this.addFeature(ir,br,Sr,r,{});t.featureIndex.insert(e[Sr].feature,br,Sr,Fr,this.index)}},Lu.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},Lu.prototype.addFeatures=function(e,t,r){for(var u=0,f=this.patternFeatures;u<f.length;u+=1){var m=f[u];this.addFeature(m,m.geometry,m.index,t,r)}},Lu.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Lu.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Lu.prototype.upload=function(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,cc)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,wo),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},Lu.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Lu.prototype.lineFeatureClips=function(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}},Lu.prototype.addFeature=function(e,t,r,u,f){var m=this.layers[0].layout,S=m.get("line-join").evaluate(e,{}),P=m.get("line-cap"),V=m.get("line-miter-limit"),re=m.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(var he=0,_e=t;he<_e.length;he+=1)this.addLine(_e[he],e,S,P,V,re);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,f,u)},Lu.prototype.addLine=function(e,t,r,u,f,m){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var S=0;S<e.length-1;S++)this.totalDistance+=e[S].dist(e[S+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var P=Nf[t.type]==="Polygon",V=e.length;V>=2&&e[V-1].equals(e[V-2]);)V--;for(var re=0;re<V-1&&e[re].equals(e[re+1]);)re++;if(!(V<(P?3:2))){r==="bevel"&&(f=1.05);var he,_e=this.overscaling<=16?122880/(512*this.overscaling):0,we=this.segments.prepareSegment(10*V,this.layoutVertexArray,this.indexArray),lt=void 0,Lt=void 0,Ct=void 0,$t=void 0;this.e1=this.e2=-1,P&&($t=e[re].sub(he=e[V-2])._unit()._perp());for(var Xt=re;Xt<V;Xt++)if(!(Lt=Xt===V-1?P?e[re+1]:void 0:e[Xt+1])||!e[Xt].equals(Lt)){$t&&(Ct=$t),he&&(lt=he),he=e[Xt],$t=Lt?Lt.sub(he)._unit()._perp():Ct;var ir=(Ct=Ct||$t).add($t);ir.x===0&&ir.y===0||ir._unit();var br=Ct.x*$t.x+Ct.y*$t.y,Sr=ir.x*$t.x+ir.y*$t.y,Fr=Sr!==0?1/Sr:1/0,Nr=2*Math.sqrt(2-2*Sr),mn=Sr<oh&&lt&&Lt,hn=Ct.x*$t.y-Ct.y*$t.x>0;if(mn&&Xt>re){var Ln=he.dist(lt);if(Ln>2*_e){var Qn=he.sub(he.sub(lt)._mult(_e/Ln)._round());this.updateDistance(lt,Qn),this.addCurrentVertex(Qn,Ct,0,0,we),lt=Qn}}var Yn=lt&&Lt,Nn=Yn?r:P?"butt":u;if(Yn&&Nn==="round"&&(Fr<m?Nn="miter":Fr<=2&&(Nn="fakeround")),Nn==="miter"&&Fr>f&&(Nn="bevel"),Nn==="bevel"&&(Fr>2&&(Nn="flipbevel"),Fr<f&&(Nn="miter")),lt&&this.updateDistance(lt,he),Nn==="miter")ir._mult(Fr),this.addCurrentVertex(he,ir,0,0,we);else if(Nn==="flipbevel"){if(Fr>100)ir=$t.mult(-1);else{var _a=Fr*Ct.add($t).mag()/Ct.sub($t).mag();ir._perp()._mult(_a*(hn?-1:1))}this.addCurrentVertex(he,ir,0,0,we),this.addCurrentVertex(he,ir.mult(-1),0,0,we)}else if(Nn==="bevel"||Nn==="fakeround"){var fa=-Math.sqrt(Fr*Fr-1),ra=hn?fa:0,Ja=hn?0:fa;if(lt&&this.addCurrentVertex(he,Ct,ra,Ja,we),Nn==="fakeround")for(var Da=Math.round(180*Nr/Math.PI/20),ji=1;ji<Da;ji++){var va=ji/Da;if(va!==.5){var ai=va-.5;va+=va*ai*(va-1)*((1.0904+br*(br*(3.55645-1.43519*br)-3.2452))*ai*ai+(.848013+br*(.215638*br-1.06021)))}var Go=$t.sub(Ct)._mult(va)._add(Ct)._unit()._mult(hn?-1:1);this.addHalfVertex(he,Go.x,Go.y,!1,hn,0,we)}Lt&&this.addCurrentVertex(he,$t,-ra,-Ja,we)}else if(Nn==="butt")this.addCurrentVertex(he,ir,0,0,we);else if(Nn==="square"){var bi=lt?1:-1;this.addCurrentVertex(he,ir,bi,bi,we)}else Nn==="round"&&(lt&&(this.addCurrentVertex(he,Ct,0,0,we),this.addCurrentVertex(he,Ct,1,1,we,!0)),Lt&&(this.addCurrentVertex(he,$t,-1,-1,we,!0),this.addCurrentVertex(he,$t,0,0,we)));if(mn&&Xt<V-1){var Ho=he.dist(Lt);if(Ho>2*_e){var Zo=he.add(Lt.sub(he)._mult(_e/Ho)._round());this.updateDistance(he,Zo),this.addCurrentVertex(Zo,$t,0,0,we),he=Zo}}}}},Lu.prototype.addCurrentVertex=function(e,t,r,u,f,m){m===void 0&&(m=!1);var S=t.y*u-t.x,P=-t.y-t.x*u;this.addHalfVertex(e,t.x+t.y*r,t.y-t.x*r,m,!1,r,f),this.addHalfVertex(e,S,P,m,!0,-u,f),this.distance>kf/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(e,t,r,u,f,m))},Lu.prototype.addHalfVertex=function(e,t,r,u,f,m,S){var P=.5*(this.lineClips?this.scaledDistance*(kf-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((e.x<<1)+(u?1:0),(e.y<<1)+(f?1:0),Math.round(63*t)+128,Math.round(63*r)+128,1+(m===0?0:m<0?-1:1)|(63&P)<<2,P>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);var V=S.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,V),S.primitiveLength++),f?this.e2=V:this.e1=V},Lu.prototype.updateScaledDistance=function(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance},Lu.prototype.updateDistance=function(e,t){this.distance+=e.dist(t),this.updateScaledDistance()},Rn("LineBucket",Lu,{omit:["layers","patternFeatures"]});var jf=new vo({"line-cap":new Jn(Ze.layout_line["line-cap"]),"line-join":new jn(Ze.layout_line["line-join"]),"line-miter-limit":new Jn(Ze.layout_line["line-miter-limit"]),"line-round-limit":new Jn(Ze.layout_line["line-round-limit"]),"line-sort-key":new jn(Ze.layout_line["line-sort-key"])}),lf={paint:new vo({"line-opacity":new jn(Ze.paint_line["line-opacity"]),"line-color":new jn(Ze.paint_line["line-color"]),"line-translate":new Jn(Ze.paint_line["line-translate"]),"line-translate-anchor":new Jn(Ze.paint_line["line-translate-anchor"]),"line-width":new jn(Ze.paint_line["line-width"]),"line-gap-width":new jn(Ze.paint_line["line-gap-width"]),"line-offset":new jn(Ze.paint_line["line-offset"]),"line-blur":new jn(Ze.paint_line["line-blur"]),"line-dasharray":new cs(Ze.paint_line["line-dasharray"]),"line-pattern":new Ec(Ze.paint_line["line-pattern"]),"line-gradient":new Do(Ze.paint_line["line-gradient"])}),layout:jf},Ff=new(function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.possiblyEvaluate=function(r,u){return u=new Pa(Math.floor(u.zoom),{now:u.now,fadeDuration:u.fadeDuration,zoomHistory:u.zoomHistory,transition:u.transition}),e.prototype.possiblyEvaluate.call(this,r,u)},t.prototype.evaluate=function(r,u,f,m){return u=Le({},u,{zoom:Math.floor(u.zoom)}),e.prototype.evaluate.call(this,r,u,f,m)},t}(jn))(lf.paint.properties["line-width"].specification);Ff.useIntegerZoom=!0;var Eh=function(e){function t(r){e.call(this,r,lf),this.gradientVersion=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._handleSpecialPaintPropertyUpdate=function(r){r==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof Ii,this.gradientVersion=(this.gradientVersion+1)%ze)},t.prototype.gradientExpression=function(){return this._transitionablePaint._values["line-gradient"].value.expression},t.prototype.recalculate=function(r,u){e.prototype.recalculate.call(this,r,u),this.paint._values["line-floorwidth"]=Ff.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,r)},t.prototype.createBucket=function(r){return new Lu(r)},t.prototype.queryRadius=function(r){var u=r,f=sh(ds("line-width",this,u),ds("line-gap-width",this,u)),m=ds("line-offset",this,u);return f/2+Math.abs(m)+ao(this.paint.get("line-translate"))},t.prototype.queryIntersectsFeature=function(r,u,f,m,S,P,V){var re=Zu(r,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),P.angle,V),he=V/2*sh(this.paint.get("line-width").evaluate(u,f),this.paint.get("line-gap-width").evaluate(u,f)),_e=this.paint.get("line-offset").evaluate(u,f);return _e&&(m=function(we,lt){for(var Lt=[],Ct=new ee(0,0),$t=0;$t<we.length;$t++){for(var Xt=we[$t],ir=[],br=0;br<Xt.length;br++){var Sr=Xt[br],Fr=Xt[br+1],Nr=br===0?Ct:Sr.sub(Xt[br-1])._unit()._perp(),mn=br===Xt.length-1?Ct:Fr.sub(Sr)._unit()._perp(),hn=Nr._add(mn)._unit();hn._mult(1/(hn.x*mn.x+hn.y*mn.y)),ir.push(hn._mult(lt)._add(Sr))}Lt.push(ir)}return Lt}(m,_e*V)),function(we,lt,Lt){for(var Ct=0;Ct<lt.length;Ct++){var $t=lt[Ct];if(we.length>=3){for(var Xt=0;Xt<$t.length;Xt++)if(ru(we,$t[Xt]))return!0}if(Hs(we,$t,Lt))return!0}return!1}(re,m,he)},t.prototype.isTileClipped=function(){return!0},t}(ws);function sh(e,t){return t>0?t+2*e:e}var Tf=no([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),zf=no([{name:"a_projected_pos",components:3,type:"Float32"}],4),Uf=(no([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),no([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),uh=(no([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),no([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),Bf=no([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Of(e,t,r){return e.sections.forEach(function(u){u.text=function(f,m,S){var P=m.layout.get("text-transform").evaluate(S,{});return P==="uppercase"?f=f.toLocaleUpperCase():P==="lowercase"&&(f=f.toLocaleLowerCase()),ls.applyArabicShaping&&(f=ls.applyArabicShaping(f)),f}(u.text,t,r)}),e}no([{name:"triangle",components:3,type:"Uint16"}]),no([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),no([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),no([{type:"Float32",name:"offsetX"}]),no([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var Zl={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"},Ih=function(t,r,u,f,m){var S,P,V=8*m-f-1,re=(1<<V)-1,he=re>>1,_e=-7,we=u?m-1:0,lt=u?-1:1,Lt=t[r+we];for(we+=lt,S=Lt&(1<<-_e)-1,Lt>>=-_e,_e+=V;_e>0;S=256*S+t[r+we],we+=lt,_e-=8);for(P=S&(1<<-_e)-1,S>>=-_e,_e+=f;_e>0;P=256*P+t[r+we],we+=lt,_e-=8);if(S===0)S=1-he;else{if(S===re)return P?NaN:1/0*(Lt?-1:1);P+=Math.pow(2,f),S-=he}return(Lt?-1:1)*P*Math.pow(2,S-f)},ge=function(t,r,u,f,m,S){var P,V,re,he=8*S-m-1,_e=(1<<he)-1,we=_e>>1,lt=m===23?Math.pow(2,-24)-Math.pow(2,-77):0,Lt=f?0:S-1,Ct=f?1:-1,$t=r<0||r===0&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(V=isNaN(r)?1:0,P=_e):(P=Math.floor(Math.log(r)/Math.LN2),r*(re=Math.pow(2,-P))<1&&(P--,re*=2),(r+=P+we>=1?lt/re:lt*Math.pow(2,1-we))*re>=2&&(P++,re/=2),P+we>=_e?(V=0,P=_e):P+we>=1?(V=(r*re-1)*Math.pow(2,m),P+=we):(V=r*Math.pow(2,we-1)*Math.pow(2,m),P=0));m>=8;t[u+Lt]=255&V,Lt+=Ct,V/=256,m-=8);for(P=P<<m|V,he+=m;he>0;t[u+Lt]=255&P,Lt+=Ct,P/=256,he-=8);t[u+Lt-Ct]|=128*$t},je=Mt;function Mt(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}Mt.Varint=0,Mt.Fixed64=1,Mt.Bytes=2,Mt.Fixed32=5;var Er=typeof TextDecoder=="undefined"?null:new TextDecoder("utf8");function Lr(e){return e.type===Mt.Bytes?e.readVarint()+e.pos:e.pos+1}function wr(e,t,r){return r?4294967296*t+(e>>>0):4294967296*(t>>>0)+(e>>>0)}function Tr(e,t,r){var u=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));r.realloc(u);for(var f=r.pos-1;f>=e;f--)r.buf[f+u]=r.buf[f]}function Wr(e,t){for(var r=0;r<e.length;r++)t.writeVarint(e[r])}function un(e,t){for(var r=0;r<e.length;r++)t.writeSVarint(e[r])}function Jr(e,t){for(var r=0;r<e.length;r++)t.writeFloat(e[r])}function Qr(e,t){for(var r=0;r<e.length;r++)t.writeDouble(e[r])}function ln(e,t){for(var r=0;r<e.length;r++)t.writeBoolean(e[r])}function Sn(e,t){for(var r=0;r<e.length;r++)t.writeFixed32(e[r])}function pn(e,t){for(var r=0;r<e.length;r++)t.writeSFixed32(e[r])}function nn(e,t){for(var r=0;r<e.length;r++)t.writeFixed64(e[r])}function _r(e,t){for(var r=0;r<e.length;r++)t.writeSFixed64(e[r])}function xr(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+16777216*e[t+3]}function Xr(e,t,r){e[r]=t,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24}function On(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}function Ir(e,t,r){e===1&&r.readMessage(ta,t)}function ta(e,t,r){if(e===3){var u=r.readMessage(qr,{}),f=u.width,m=u.height,S=u.left,P=u.top,V=u.advance;t.push({id:u.id,bitmap:new ks({width:f+6,height:m+6},u.bitmap),metrics:{width:f,height:m,left:S,top:P,advance:V}})}}function qr(e,t,r){e===1?t.id=r.readVarint():e===2?t.bitmap=r.readBytes():e===3?t.width=r.readVarint():e===4?t.height=r.readVarint():e===5?t.left=r.readSVarint():e===6?t.top=r.readSVarint():e===7&&(t.advance=r.readVarint())}function zr(e){for(var t=0,r=0,u=0,f=e;u<f.length;u+=1){var m=f[u];t+=m.w*m.h,r=Math.max(r,m.w)}e.sort(function(Ct,$t){return $t.h-Ct.h});for(var S=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),r),h:1/0}],P=0,V=0,re=0,he=e;re<he.length;re+=1)for(var _e=he[re],we=S.length-1;we>=0;we--){var lt=S[we];if(!(_e.w>lt.w||_e.h>lt.h)){if(_e.x=lt.x,_e.y=lt.y,V=Math.max(V,_e.y+_e.h),P=Math.max(P,_e.x+_e.w),_e.w===lt.w&&_e.h===lt.h){var Lt=S.pop();we<S.length&&(S[we]=Lt)}else _e.h===lt.h?(lt.x+=_e.w,lt.w-=_e.w):_e.w===lt.w?(lt.y+=_e.h,lt.h-=_e.h):(S.push({x:lt.x+_e.w,y:lt.y,w:lt.w-_e.w,h:_e.h}),lt.y+=_e.h,lt.h-=_e.h);break}}return{w:P,h:V,fill:t/(P*V)||0}}Mt.prototype={destroy:function(){this.buf=null},readFields:function(t,r,u){for(u=u||this.length;this.pos<u;){var f=this.readVarint(),m=f>>3,S=this.pos;this.type=7&f,t(m,r,this),this.pos===S&&this.skip(f)}return r},readMessage:function(t,r){return this.readFields(t,r,this.readVarint()+this.pos)},readFixed32:function(){var t=xr(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=On(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=xr(this.buf,this.pos)+4294967296*xr(this.buf,this.pos+4);return this.pos+=8,t},readSFixed64:function(){var t=xr(this.buf,this.pos)+4294967296*On(this.buf,this.pos+4);return this.pos+=8,t},readFloat:function(){var t=Ih(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=Ih(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var r,u,f=this.buf;return r=127&(u=f[this.pos++]),u<128?r:(r|=(127&(u=f[this.pos++]))<<7,u<128?r:(r|=(127&(u=f[this.pos++]))<<14,u<128?r:(r|=(127&(u=f[this.pos++]))<<21,u<128?r:function(m,S,P){var V,re,he=P.buf;if(V=(112&(re=he[P.pos++]))>>4,re<128)return wr(m,V,S);if(V|=(127&(re=he[P.pos++]))<<3,re<128)return wr(m,V,S);if(V|=(127&(re=he[P.pos++]))<<10,re<128)return wr(m,V,S);if(V|=(127&(re=he[P.pos++]))<<17,re<128)return wr(m,V,S);if(V|=(127&(re=he[P.pos++]))<<24,re<128)return wr(m,V,S);if(V|=(1&(re=he[P.pos++]))<<31,re<128)return wr(m,V,S);throw new Error("Expected varint not more than 10 bytes")}(r|=(15&(u=f[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,r=this.pos;return this.pos=t,t-r>=12&&Er?function(u,f,m){return Er.decode(u.subarray(f,m))}(this.buf,r,t):function(u,f,m){for(var S="",P=f;P<m;){var V,re,he,_e=u[P],we=null,lt=_e>239?4:_e>223?3:_e>191?2:1;if(P+lt>m)break;lt===1?_e<128&&(we=_e):lt===2?(192&(V=u[P+1]))==128&&(we=(31&_e)<<6|63&V)<=127&&(we=null):lt===3?(re=u[P+2],(192&(V=u[P+1]))==128&&(192&re)==128&&((we=(15&_e)<<12|(63&V)<<6|63&re)<=2047||we>=55296&&we<=57343)&&(we=null)):lt===4&&(re=u[P+2],he=u[P+3],(192&(V=u[P+1]))==128&&(192&re)==128&&(192&he)==128&&((we=(15&_e)<<18|(63&V)<<12|(63&re)<<6|63&he)<=65535||we>=1114112)&&(we=null)),we===null?(we=65533,lt=1):we>65535&&(we-=65536,S+=String.fromCharCode(we>>>10&1023|55296),we=56320|1023&we),S+=String.fromCharCode(we),P+=lt}return S}(this.buf,r,t)},readBytes:function(){var t=this.readVarint()+this.pos,r=this.buf.subarray(this.pos,t);return this.pos=t,r},readPackedVarint:function(t,r){if(this.type!==Mt.Bytes)return t.push(this.readVarint(r));var u=Lr(this);for(t=t||[];this.pos<u;)t.push(this.readVarint(r));return t},readPackedSVarint:function(t){if(this.type!==Mt.Bytes)return t.push(this.readSVarint());var r=Lr(this);for(t=t||[];this.pos<r;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==Mt.Bytes)return t.push(this.readBoolean());var r=Lr(this);for(t=t||[];this.pos<r;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==Mt.Bytes)return t.push(this.readFloat());var r=Lr(this);for(t=t||[];this.pos<r;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==Mt.Bytes)return t.push(this.readDouble());var r=Lr(this);for(t=t||[];this.pos<r;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==Mt.Bytes)return t.push(this.readFixed32());var r=Lr(this);for(t=t||[];this.pos<r;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==Mt.Bytes)return t.push(this.readSFixed32());var r=Lr(this);for(t=t||[];this.pos<r;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==Mt.Bytes)return t.push(this.readFixed64());var r=Lr(this);for(t=t||[];this.pos<r;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==Mt.Bytes)return t.push(this.readSFixed64());var r=Lr(this);for(t=t||[];this.pos<r;)t.push(this.readSFixed64());return t},skip:function(t){var r=7&t;if(r===Mt.Varint)for(;this.buf[this.pos++]>127;);else if(r===Mt.Bytes)this.pos=this.readVarint()+this.pos;else if(r===Mt.Fixed32)this.pos+=4;else{if(r!==Mt.Fixed64)throw new Error("Unimplemented type: "+r);this.pos+=8}},writeTag:function(t,r){this.writeVarint(t<<3|r)},realloc:function(t){for(var r=this.length||16;r<this.pos+t;)r*=2;if(r!==this.length){var u=new Uint8Array(r);u.set(this.buf),this.buf=u,this.length=r}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),Xr(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),Xr(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),Xr(this.buf,-1&t,this.pos),Xr(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),Xr(this.buf,-1&t,this.pos),Xr(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(r,u){var f,m;if(r>=0?(f=r%4294967296|0,m=r/4294967296|0):(m=~(-r/4294967296),4294967295^(f=~(-r%4294967296))?f=f+1|0:(f=0,m=m+1|0)),r>=18446744073709552e3||r<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");u.realloc(10),function(S,P,V){V.buf[V.pos++]=127&S|128,S>>>=7,V.buf[V.pos++]=127&S|128,S>>>=7,V.buf[V.pos++]=127&S|128,S>>>=7,V.buf[V.pos++]=127&S|128,V.buf[V.pos]=127&(S>>>=7)}(f,0,u),function(S,P){var V=(7&S)<<4;P.buf[P.pos++]|=V|((S>>>=3)?128:0),S&&(P.buf[P.pos++]=127&S|((S>>>=7)?128:0),S&&(P.buf[P.pos++]=127&S|((S>>>=7)?128:0),S&&(P.buf[P.pos++]=127&S|((S>>>=7)?128:0),S&&(P.buf[P.pos++]=127&S|((S>>>=7)?128:0),S&&(P.buf[P.pos++]=127&S)))))}(m,u)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var r=this.pos;this.pos=function(f,m,S){for(var P,V,re=0;re<m.length;re++){if((P=m.charCodeAt(re))>55295&&P<57344){if(!V){P>56319||re+1===m.length?(f[S++]=239,f[S++]=191,f[S++]=189):V=P;continue}if(P<56320){f[S++]=239,f[S++]=191,f[S++]=189,V=P;continue}P=V-55296<<10|P-56320|65536,V=null}else V&&(f[S++]=239,f[S++]=191,f[S++]=189,V=null);P<128?f[S++]=P:(P<2048?f[S++]=P>>6|192:(P<65536?f[S++]=P>>12|224:(f[S++]=P>>18|240,f[S++]=P>>12&63|128),f[S++]=P>>6&63|128),f[S++]=63&P|128)}return S}(this.buf,t,this.pos);var u=this.pos-r;u>=128&&Tr(r,u,this),this.pos=r-1,this.writeVarint(u),this.pos+=u},writeFloat:function(t){this.realloc(4),ge(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),ge(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var r=t.length;this.writeVarint(r),this.realloc(r);for(var u=0;u<r;u++)this.buf[this.pos++]=t[u]},writeRawMessage:function(t,r){this.pos++;var u=this.pos;t(r,this);var f=this.pos-u;f>=128&&Tr(u,f,this),this.pos=u-1,this.writeVarint(f),this.pos+=f},writeMessage:function(t,r,u){this.writeTag(t,Mt.Bytes),this.writeRawMessage(r,u)},writePackedVarint:function(t,r){r.length&&this.writeMessage(t,Wr,r)},writePackedSVarint:function(t,r){r.length&&this.writeMessage(t,un,r)},writePackedBoolean:function(t,r){r.length&&this.writeMessage(t,ln,r)},writePackedFloat:function(t,r){r.length&&this.writeMessage(t,Jr,r)},writePackedDouble:function(t,r){r.length&&this.writeMessage(t,Qr,r)},writePackedFixed32:function(t,r){r.length&&this.writeMessage(t,Sn,r)},writePackedSFixed32:function(t,r){r.length&&this.writeMessage(t,pn,r)},writePackedFixed64:function(t,r){r.length&&this.writeMessage(t,nn,r)},writePackedSFixed64:function(t,r){r.length&&this.writeMessage(t,_r,r)},writeBytesField:function(t,r){this.writeTag(t,Mt.Bytes),this.writeBytes(r)},writeFixed32Field:function(t,r){this.writeTag(t,Mt.Fixed32),this.writeFixed32(r)},writeSFixed32Field:function(t,r){this.writeTag(t,Mt.Fixed32),this.writeSFixed32(r)},writeFixed64Field:function(t,r){this.writeTag(t,Mt.Fixed64),this.writeFixed64(r)},writeSFixed64Field:function(t,r){this.writeTag(t,Mt.Fixed64),this.writeSFixed64(r)},writeVarintField:function(t,r){this.writeTag(t,Mt.Varint),this.writeVarint(r)},writeSVarintField:function(t,r){this.writeTag(t,Mt.Varint),this.writeSVarint(r)},writeStringField:function(t,r){this.writeTag(t,Mt.Bytes),this.writeString(r)},writeFloatField:function(t,r){this.writeTag(t,Mt.Fixed32),this.writeFloat(r)},writeDoubleField:function(t,r){this.writeTag(t,Mt.Fixed64),this.writeDouble(r)},writeBooleanField:function(t,r){this.writeVarintField(t,Boolean(r))}};var Vr=function(t,r){var u=r.pixelRatio,f=r.version,m=r.stretchX,S=r.stretchY,P=r.content;this.paddedRect=t,this.pixelRatio=u,this.stretchX=m,this.stretchY=S,this.content=P,this.version=f},Kr={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};Kr.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},Kr.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},Kr.tlbr.get=function(){return this.tl.concat(this.br)},Kr.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(Vr.prototype,Kr);var Xn=function(t,r){var u={},f={};this.haveRenderCallbacks=[];var m=[];this.addImages(t,u,m),this.addImages(r,f,m);var S=zr(m),P=new go({width:S.w||1,height:S.h||1});for(var V in t){var re=t[V],he=u[V].paddedRect;go.copy(re.data,P,{x:0,y:0},{x:he.x+1,y:he.y+1},re.data)}for(var _e in r){var we=r[_e],lt=f[_e].paddedRect,Lt=lt.x+1,Ct=lt.y+1,$t=we.data.width,Xt=we.data.height;go.copy(we.data,P,{x:0,y:0},{x:Lt,y:Ct},we.data),go.copy(we.data,P,{x:0,y:Xt-1},{x:Lt,y:Ct-1},{width:$t,height:1}),go.copy(we.data,P,{x:0,y:0},{x:Lt,y:Ct+Xt},{width:$t,height:1}),go.copy(we.data,P,{x:$t-1,y:0},{x:Lt-1,y:Ct},{width:1,height:Xt}),go.copy(we.data,P,{x:0,y:0},{x:Lt+$t,y:Ct},{width:1,height:Xt})}this.image=P,this.iconPositions=u,this.patternPositions=f};Xn.prototype.addImages=function(e,t,r){for(var u in e){var f=e[u],m={x:0,y:0,w:f.data.width+2,h:f.data.height+2};r.push(m),t[u]=new Vr(m,f),f.hasRenderCallback&&this.haveRenderCallbacks.push(u)}},Xn.prototype.patchUpdatedImages=function(e,t){for(var r in e.dispatchRenderCallbacks(this.haveRenderCallbacks),e.updatedImages)this.patchUpdatedImage(this.iconPositions[r],e.getImage(r),t),this.patchUpdatedImage(this.patternPositions[r],e.getImage(r),t)},Xn.prototype.patchUpdatedImage=function(e,t,r){if(e&&t&&e.version!==t.version){e.version=t.version;var u=e.tl;r.update(t.data,void 0,{x:u[0],y:u[1]})}},Rn("ImagePosition",Vr),Rn("ImageAtlas",Xn);var na={horizontal:1,vertical:2,horizontalOnly:3},cn=function(){this.scale=1,this.fontStack="",this.imageName=null};cn.forText=function(e,t){var r=new cn;return r.scale=e||1,r.fontStack=t,r},cn.forImage=function(e){var t=new cn;return t.imageName=e,t};var Hr=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function jr(e,t,r,u,f,m,S,P,V,re,he,_e,we,lt,Lt,Ct){var $t,Xt=Hr.fromFeature(e,f);_e===na.vertical&&Xt.verticalizePunctuation();var ir=ls.processBidirectionalText,br=ls.processStyledBidirectionalText;if(ir&&Xt.sections.length===1){$t=[];for(var Sr=0,Fr=ir(Xt.toString(),hi(Xt,re,m,t,u,lt,Lt));Sr<Fr.length;Sr+=1){var Nr=Fr[Sr],mn=new Hr;mn.text=Nr,mn.sections=Xt.sections;for(var hn=0;hn<Nr.length;hn++)mn.sectionIndex.push(0);$t.push(mn)}}else if(br){$t=[];for(var Ln=0,Qn=br(Xt.text,Xt.sectionIndex,hi(Xt,re,m,t,u,lt,Lt));Ln<Qn.length;Ln+=1){var Yn=Qn[Ln],Nn=new Hr;Nn.text=Yn[0],Nn.sectionIndex=Yn[1],Nn.sections=Xt.sections,$t.push(Nn)}}else $t=function(ra,Ja){for(var Da=[],ji=ra.text,va=0,ai=0,Go=Ja;ai<Go.length;ai+=1){var bi=Go[ai];Da.push(ra.substring(va,bi)),va=bi}return va<ji.length&&Da.push(ra.substring(va,ji.length)),Da}(Xt,hi(Xt,re,m,t,u,lt,Lt));var _a=[],fa={positionedLines:_a,text:Xt.toString(),top:he[1],bottom:he[1],left:he[0],right:he[0],writingMode:_e,iconsInText:!1,verticalizable:!1};return function(ra,Ja,Da,ji,va,ai,Go,bi,Ho,Zo,ns,gu){for(var as=0,Yu=-17,su=0,Ku=0,uu=bi==="right"?1:bi==="left"?0:.5,Ws=0,lu=0,mi=va;lu<mi.length;lu+=1){var ii=mi[lu];ii.trim();var Ji=ii.getMaxScale(),fo=24*(Ji-1),yu={positionedGlyphs:[],lineOffset:0};ra.positionedLines[Ws]=yu;var Eo=yu.positionedGlyphs,Wo=0;if(ii.length()){for(var Ru=0;Ru<ii.length();Ru++){var di=ii.getSection(Ru),Zf=ii.getSectionIndex(Ru),Zc=ii.getCharCode(Ru),cf=0,dc=null,Iu=null,Pf=null,Lf=24,Wf=!(Ho===na.horizontal||!ns&&!us(Zc)||ns&&(ma[Zc]||(dh=Zc,tn.Arabic(dh)||tn["Arabic Supplement"](dh)||tn["Arabic Extended-A"](dh)||tn["Arabic Presentation Forms-A"](dh)||tn["Arabic Presentation Forms-B"](dh))));if(di.imageName){var _h=ji[di.imageName];if(!_h)continue;Pf=di.imageName,ra.iconsInText=ra.iconsInText||!0,Iu=_h.paddedRect;var _f=_h.displaySize;di.scale=24*di.scale/gu,cf=fo+(24-_f[1]*di.scale),Lf=(dc={width:_f[0],height:_f[1],left:1,top:-3,advance:Wf?_f[1]:_f[0]}).advance;var Sh=Wf?_f[0]*di.scale-24*Ji:_f[1]*di.scale-24*Ji;Sh>0&&Sh>Wo&&(Wo=Sh)}else{var Xf=Da[di.fontStack],hh=Xf&&Xf[Zc];if(hh&&hh.rect)Iu=hh.rect,dc=hh.metrics;else{var Zh=Ja[di.fontStack],kh=Zh&&Zh[Zc];if(!kh)continue;dc=kh.metrics}cf=24*(Ji-di.scale)}Wf?(ra.verticalizable=!0,Eo.push({glyph:Zc,imageName:Pf,x:as,y:Yu+cf,vertical:Wf,scale:di.scale,fontStack:di.fontStack,sectionIndex:Zf,metrics:dc,rect:Iu}),as+=Lf*di.scale+Zo):(Eo.push({glyph:Zc,imageName:Pf,x:as,y:Yu+cf,vertical:Wf,scale:di.scale,fontStack:di.fontStack,sectionIndex:Zf,metrics:dc,rect:Iu}),as+=dc.advance*di.scale+Zo)}Eo.length!==0&&(su=Math.max(as-Zo,su),Os(Eo,0,Eo.length-1,uu,Wo)),as=0;var Wh=ai*Ji+Wo;yu.lineOffset=Math.max(Wo,fo),Yu+=Wh,Ku=Math.max(Wh,Ku),++Ws}else Yu+=ai,++Ws}var dh,Ah=Yu- -17,Xh=Fo(Go),ph=Xh.horizontalAlign,Yf=Xh.verticalAlign;(function(nh,Yh,jh,mh,Fh,Ch,vh,zh,Uh){var wh,Oh=(Yh-jh)*Fh;wh=Ch!==vh?-zh*mh- -17:(-mh*Uh+.5)*vh;for(var gh=0,Mh=nh;gh<Mh.length;gh+=1)for(var yh=0,Rf=Mh[gh].positionedGlyphs;yh<Rf.length;yh+=1){var Ph=Rf[yh];Ph.x+=Oh,Ph.y+=wh}})(ra.positionedLines,uu,ph,Yf,su,Ku,ai,Ah,va.length),ra.top+=-Yf*Ah,ra.bottom=ra.top+Ah,ra.left+=-ph*su,ra.right=ra.left+su}(fa,t,r,u,$t,S,P,V,_e,re,we,Ct),!function(ra){for(var Ja=0,Da=ra;Ja<Da.length;Ja+=1)if(Da[Ja].positionedGlyphs.length!==0)return!1;return!0}(_a)&&fa}Hr.fromFeature=function(e,t){for(var r=new Hr,u=0;u<e.sections.length;u++){var f=e.sections[u];f.image?r.addImageSection(f):r.addTextSection(f,t)}return r},Hr.prototype.length=function(){return this.text.length},Hr.prototype.getSection=function(e){return this.sections[this.sectionIndex[e]]},Hr.prototype.getSectionIndex=function(e){return this.sectionIndex[e]},Hr.prototype.getCharCode=function(e){return this.text.charCodeAt(e)},Hr.prototype.verticalizePunctuation=function(){this.text=function(e){for(var t="",r=0;r<e.length;r++){var u=e.charCodeAt(r+1)||null,f=e.charCodeAt(r-1)||null;t+=u&&ro(u)&&!Zl[e[r+1]]||f&&ro(f)&&!Zl[e[r-1]]||!Zl[e[r]]?e[r]:Zl[e[r]]}return t}(this.text)},Hr.prototype.trim=function(){for(var e=0,t=0;t<this.text.length&&ma[this.text.charCodeAt(t)];t++)e++;for(var r=this.text.length,u=this.text.length-1;u>=0&&u>=e&&ma[this.text.charCodeAt(u)];u--)r--;this.text=this.text.substring(e,r),this.sectionIndex=this.sectionIndex.slice(e,r)},Hr.prototype.substring=function(e,t){var r=new Hr;return r.text=this.text.substring(e,t),r.sectionIndex=this.sectionIndex.slice(e,t),r.sections=this.sections,r},Hr.prototype.toString=function(){return this.text},Hr.prototype.getMaxScale=function(){var e=this;return this.sectionIndex.reduce(function(t,r){return Math.max(t,e.sections[r].scale)},0)},Hr.prototype.addTextSection=function(e,t){this.text+=e.text,this.sections.push(cn.forText(e.scale,e.fontStack||t));for(var r=this.sections.length-1,u=0;u<e.text.length;++u)this.sectionIndex.push(r)},Hr.prototype.addImageSection=function(e){var t=e.image?e.image.name:"";if(t.length!==0){var r=this.getNextImageSectionCharCode();r?(this.text+=String.fromCharCode(r),this.sections.push(cn.forImage(t)),this.sectionIndex.push(this.sections.length-1)):Me("Reached maximum number of images 6401")}else Me("Can't add FormattedSection with an empty image.")},Hr.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var ma={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},pa={};function Un(e,t,r,u,f,m){if(t.imageName){var S=u[t.imageName];return S?S.displaySize[0]*t.scale*24/m+f:0}var P=r[t.fontStack],V=P&&P[e];return V?V.metrics.advance*t.scale+f:0}function Ua(e,t,r,u){var f=Math.pow(e-t,2);return u?e<t?f/2:2*f:f+Math.abs(r)*r}function Ta(e,t,r){var u=0;return e===10&&(u-=1e4),r&&(u+=150),e!==40&&e!==65288||(u+=50),t!==41&&t!==65289||(u+=50),u}function Ba(e,t,r,u,f,m){for(var S=null,P=Ua(t,r,f,m),V=0,re=u;V<re.length;V+=1){var he=re[V],_e=Ua(t-he.x,r,f,m)+he.badness;_e<=P&&(S=he,P=_e)}return{index:e,x:t,priorBreak:S,badness:P}}function hi(e,t,r,u,f,m,S){if(m!=="point")return[];if(!e)return[];for(var P,V=[],re=function($t,Xt,ir,br,Sr,Fr){for(var Nr=0,mn=0;mn<$t.length();mn++){var hn=$t.getSection(mn);Nr+=Un($t.getCharCode(mn),hn,br,Sr,Xt,Fr)}return Nr/Math.max(1,Math.ceil(Nr/ir))}(e,t,r,u,f,S),he=e.text.indexOf("\u200B")>=0,_e=0,we=0;we<e.length();we++){var lt=e.getSection(we),Lt=e.getCharCode(we);if(ma[Lt]||(_e+=Un(Lt,lt,u,f,t,S)),we<e.length()-1){var Ct=!((P=Lt)<11904||!(tn["Bopomofo Extended"](P)||tn.Bopomofo(P)||tn["CJK Compatibility Forms"](P)||tn["CJK Compatibility Ideographs"](P)||tn["CJK Compatibility"](P)||tn["CJK Radicals Supplement"](P)||tn["CJK Strokes"](P)||tn["CJK Symbols and Punctuation"](P)||tn["CJK Unified Ideographs Extension A"](P)||tn["CJK Unified Ideographs"](P)||tn["Enclosed CJK Letters and Months"](P)||tn["Halfwidth and Fullwidth Forms"](P)||tn.Hiragana(P)||tn["Ideographic Description Characters"](P)||tn["Kangxi Radicals"](P)||tn["Katakana Phonetic Extensions"](P)||tn.Katakana(P)||tn["Vertical Forms"](P)||tn["Yi Radicals"](P)||tn["Yi Syllables"](P)));(pa[Lt]||Ct||lt.imageName)&&V.push(Ba(we+1,_e,re,V,Ta(Lt,e.getCharCode(we+1),Ct&&he),!1))}}return function $t(Xt){return Xt?$t(Xt.priorBreak).concat(Xt.index):[]}(Ba(e.length(),_e,re,V,0,!0))}function Fo(e){var t=.5,r=.5;switch(e){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(e){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0}return{horizontalAlign:t,verticalAlign:r}}function Os(e,t,r,u,f){if(u||f)for(var m=e[r],S=(e[r].x+m.metrics.advance*m.scale)*u,P=t;P<=r;P++)e[P].x-=S,e[P].y+=f}function ei(e,t,r,u,f,m){var S,P=e.image;if(P.content){var V=P.content,re=P.pixelRatio||1;S=[V[0]/re,V[1]/re,P.displaySize[0]-V[2]/re,P.displaySize[1]-V[3]/re]}var he,_e,we,lt,Lt=t.left*m,Ct=t.right*m;r==="width"||r==="both"?(lt=f[0]+Lt-u[3],_e=f[0]+Ct+u[1]):_e=(lt=f[0]+(Lt+Ct-P.displaySize[0])/2)+P.displaySize[0];var $t=t.top*m,Xt=t.bottom*m;return r==="height"||r==="both"?(he=f[1]+$t-u[0],we=f[1]+Xt+u[2]):we=(he=f[1]+($t+Xt-P.displaySize[1])/2)+P.displaySize[1],{image:P,top:he,right:_e,bottom:we,left:lt,collisionPadding:S}}pa[10]=!0,pa[32]=!0,pa[38]=!0,pa[40]=!0,pa[41]=!0,pa[43]=!0,pa[45]=!0,pa[47]=!0,pa[173]=!0,pa[183]=!0,pa[8203]=!0,pa[8208]=!0,pa[8211]=!0,pa[8231]=!0;var bo=function(e){function t(r,u,f,m){e.call(this,r,u),this.angle=f,m!==void 0&&(this.segment=m)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.clone=function(){return new t(this.x,this.y,this.angle,this.segment)},t}(ee);function Ci(e,t){var r=t.expression;if(r.kind==="constant")return{kind:"constant",layoutSize:r.evaluate(new Pa(e+1))};if(r.kind==="source")return{kind:"source"};for(var u=r.zoomStops,f=r.interpolationType,m=0;m<u.length&&u[m]<=e;)m++;for(var S=m=Math.max(0,m-1);S<u.length&&u[S]<e+1;)S++;S=Math.min(u.length-1,S);var P=u[m],V=u[S];return r.kind==="composite"?{kind:"composite",minZoom:P,maxZoom:V,interpolationType:f}:{kind:"camera",minZoom:P,maxZoom:V,minSize:r.evaluate(new Pa(P)),maxSize:r.evaluate(new Pa(V)),interpolationType:f}}function vs(e,t,r){var u=t.uSize,f=r.lowerSize;return e.kind==="source"?f/128:e.kind==="composite"?Gi(f/128,r.upperSize/128,t.uSizeT):u}function zo(e,t){var r=0,u=0;if(e.kind==="constant")u=e.layoutSize;else if(e.kind!=="source"){var f=e.interpolationType,m=f?Se(gi.interpolationFactor(f,t,e.minZoom,e.maxZoom),0,1):0;e.kind==="camera"?u=Gi(e.minSize,e.maxSize,m):r=m}return{uSizeT:r,uSize:u}}Rn("Anchor",bo);var gs=Object.freeze({__proto__:null,getSizeData:Ci,evaluateSizeForFeature:vs,evaluateSizeForZoom:zo,SIZE_PACK_FACTOR:128});function Uo(e,t,r,u,f){if(t.segment===void 0)return!0;for(var m=t,S=t.segment+1,P=0;P>-r/2;){if(--S<0)return!1;P-=e[S].dist(m),m=e[S]}P+=e[S].dist(e[S+1]),S++;for(var V=[],re=0;P<r/2;){var he=e[S],_e=e[S+1];if(!_e)return!1;var we=e[S-1].angleTo(he)-he.angleTo(_e);for(we=Math.abs((we+3*Math.PI)%(2*Math.PI)-Math.PI),V.push({distance:P,angleDelta:we}),re+=we;P-V[0].distance>u;)re-=V.shift().angleDelta;if(re>f)return!1;S++,P+=he.dist(_e)}return!0}function Bo(e){for(var t=0,r=0;r<e.length-1;r++)t+=e[r].dist(e[r+1]);return t}function Vo(e,t,r){return e?.6*t*r:0}function aa(e,t){return Math.max(e?e.right-e.left:0,t?t.right-t.left:0)}function ou(e,t,r,u,f,m){for(var S=Vo(r,f,m),P=aa(r,u)*m,V=0,re=Bo(e)/2,he=0;he<e.length-1;he++){var _e=e[he],we=e[he+1],lt=_e.dist(we);if(V+lt>re){var Lt=(re-V)/lt,Ct=Gi(_e.x,we.x,Lt),$t=Gi(_e.y,we.y,Lt),Xt=new bo(Ct,$t,we.angleTo(_e),he);return Xt._round(),!S||Uo(e,Xt,P,S,t)?Xt:void 0}V+=lt}}function yi(e,t,r,u,f,m,S,P,V){var re=Vo(u,m,S),he=aa(u,f),_e=he*S,we=e[0].x===0||e[0].x===V||e[0].y===0||e[0].y===V;return t-_e<t/4&&(t=_e+t/4),function lt(Lt,Ct,$t,Xt,ir,br,Sr,Fr,Nr){for(var mn=br/2,hn=Bo(Lt),Ln=0,Qn=Ct-$t,Yn=[],Nn=0;Nn<Lt.length-1;Nn++){for(var _a=Lt[Nn],fa=Lt[Nn+1],ra=_a.dist(fa),Ja=fa.angleTo(_a);Qn+$t<Ln+ra;){var Da=((Qn+=$t)-Ln)/ra,ji=Gi(_a.x,fa.x,Da),va=Gi(_a.y,fa.y,Da);if(ji>=0&&ji<Nr&&va>=0&&va<Nr&&Qn-mn>=0&&Qn+mn<=hn){var ai=new bo(ji,va,Ja,Nn);ai._round(),Xt&&!Uo(Lt,ai,br,Xt,ir)||Yn.push(ai)}}Ln+=ra}return Fr||Yn.length||Sr||(Yn=lt(Lt,Ln/2,$t,Xt,ir,br,Sr,!0,Nr)),Yn}(e,we?t/2*P%t:(he/2+2*m)*S*P%t,t,re,r,_e,we,!1,V)}function An(e,t,r,u,f){for(var m=[],S=0;S<e.length;S++)for(var P=e[S],V=void 0,re=0;re<P.length-1;re++){var he=P[re],_e=P[re+1];he.x<t&&_e.x<t||(he.x<t?he=new ee(t,he.y+(t-he.x)/(_e.x-he.x)*(_e.y-he.y))._round():_e.x<t&&(_e=new ee(t,he.y+(t-he.x)/(_e.x-he.x)*(_e.y-he.y))._round()),he.y<r&&_e.y<r||(he.y<r?he=new ee(he.x+(r-he.y)/(_e.y-he.y)*(_e.x-he.x),r)._round():_e.y<r&&(_e=new ee(he.x+(r-he.y)/(_e.y-he.y)*(_e.x-he.x),r)._round()),he.x>=u&&_e.x>=u||(he.x>=u?he=new ee(u,he.y+(u-he.x)/(_e.x-he.x)*(_e.y-he.y))._round():_e.x>=u&&(_e=new ee(u,he.y+(u-he.x)/(_e.x-he.x)*(_e.y-he.y))._round()),he.y>=f&&_e.y>=f||(he.y>=f?he=new ee(he.x+(f-he.y)/(_e.y-he.y)*(_e.x-he.x),f)._round():_e.y>=f&&(_e=new ee(he.x+(f-he.y)/(_e.y-he.y)*(_e.x-he.x),f)._round()),V&&he.equals(V[V.length-1])||m.push(V=[he]),V.push(_e)))))}return m}function Ra(e,t,r,u){var f=[],m=e.image,S=m.pixelRatio,P=m.paddedRect.w-2,V=m.paddedRect.h-2,re=e.right-e.left,he=e.bottom-e.top,_e=m.stretchX||[[0,P]],we=m.stretchY||[[0,V]],lt=function(va,ai){return va+ai[1]-ai[0]},Lt=_e.reduce(lt,0),Ct=we.reduce(lt,0),$t=P-Lt,Xt=V-Ct,ir=0,br=Lt,Sr=0,Fr=Ct,Nr=0,mn=$t,hn=0,Ln=Xt;if(m.content&&u){var Qn=m.content;ir=Va(_e,0,Qn[0]),Sr=Va(we,0,Qn[1]),br=Va(_e,Qn[0],Qn[2]),Fr=Va(we,Qn[1],Qn[3]),Nr=Qn[0]-ir,hn=Qn[1]-Sr,mn=Qn[2]-Qn[0]-br,Ln=Qn[3]-Qn[1]-Fr}var Yn=function(va,ai,Go,bi){var Ho=w(va.stretch-ir,br,re,e.left),Zo=b(va.fixed-Nr,mn,va.stretch,Lt),ns=w(ai.stretch-Sr,Fr,he,e.top),gu=b(ai.fixed-hn,Ln,ai.stretch,Ct),as=w(Go.stretch-ir,br,re,e.left),Yu=b(Go.fixed-Nr,mn,Go.stretch,Lt),su=w(bi.stretch-Sr,Fr,he,e.top),Ku=b(bi.fixed-hn,Ln,bi.stretch,Ct),uu=new ee(Ho,ns),Ws=new ee(as,ns),lu=new ee(as,su),mi=new ee(Ho,su),ii=new ee(Zo/S,gu/S),Ji=new ee(Yu/S,Ku/S),fo=t*Math.PI/180;if(fo){var yu=Math.sin(fo),Eo=Math.cos(fo),Wo=[Eo,-yu,yu,Eo];uu._matMult(Wo),Ws._matMult(Wo),mi._matMult(Wo),lu._matMult(Wo)}var Ru=va.stretch+va.fixed,di=ai.stretch+ai.fixed;return{tl:uu,tr:Ws,bl:mi,br:lu,tex:{x:m.paddedRect.x+1+Ru,y:m.paddedRect.y+1+di,w:Go.stretch+Go.fixed-Ru,h:bi.stretch+bi.fixed-di},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:ii,pixelOffsetBR:Ji,minFontScaleX:mn/S/re,minFontScaleY:Ln/S/he,isSDF:r}};if(u&&(m.stretchX||m.stretchY))for(var Nn=rs(_e,$t,Lt),_a=rs(we,Xt,Ct),fa=0;fa<Nn.length-1;fa++)for(var ra=Nn[fa],Ja=Nn[fa+1],Da=0;Da<_a.length-1;Da++)f.push(Yn(ra,_a[Da],Ja,_a[Da+1]));else f.push(Yn({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:P+1},{fixed:0,stretch:V+1}));return f}function Va(e,t,r){for(var u=0,f=0,m=e;f<m.length;f+=1){var S=m[f];u+=Math.max(t,Math.min(r,S[1]))-Math.max(t,Math.min(r,S[0]))}return u}function rs(e,t,r){for(var u=[{fixed:-1,stretch:0}],f=0,m=e;f<m.length;f+=1){var S=m[f],P=S[0],V=S[1],re=u[u.length-1];u.push({fixed:P-re.stretch,stretch:re.stretch}),u.push({fixed:P-re.stretch,stretch:re.stretch+(V-P)})}return u.push({fixed:t+1,stretch:r}),u}function w(e,t,r,u){return e/t*r+u}function b(e,t,r,u){return e-t*r/u}var c=function(t,r,u,f,m,S,P,V,re,he){if(this.boxStartIndex=t.length,re){var _e=S.top,we=S.bottom,lt=S.collisionPadding;lt&&(_e-=lt[1],we+=lt[3]);var Lt=we-_e;Lt>0&&(Lt=Math.max(10,Lt),this.circleDiameter=Lt)}else{var Ct=S.top*P-V,$t=S.bottom*P+V,Xt=S.left*P-V,ir=S.right*P+V,br=S.collisionPadding;if(br&&(Xt-=br[0]*P,Ct-=br[1]*P,ir+=br[2]*P,$t+=br[3]*P),he){var Sr=new ee(Xt,Ct),Fr=new ee(ir,Ct),Nr=new ee(Xt,$t),mn=new ee(ir,$t),hn=he*Math.PI/180;Sr._rotate(hn),Fr._rotate(hn),Nr._rotate(hn),mn._rotate(hn),Xt=Math.min(Sr.x,Fr.x,Nr.x,mn.x),ir=Math.max(Sr.x,Fr.x,Nr.x,mn.x),Ct=Math.min(Sr.y,Fr.y,Nr.y,mn.y),$t=Math.max(Sr.y,Fr.y,Nr.y,mn.y)}t.emplaceBack(r.x,r.y,Xt,Ct,ir,$t,u,f,m)}this.boxEndIndex=t.length},d=function(t,r){if(t===void 0&&(t=[]),r===void 0&&(r=y),this.data=t,this.length=this.data.length,this.compare=r,this.length>0)for(var u=(this.length>>1)-1;u>=0;u--)this._down(u)};function y(e,t){return e<t?-1:e>t?1:0}function I(e,t,r){t===void 0&&(t=1),r===void 0&&(r=!1);for(var u=1/0,f=1/0,m=-1/0,S=-1/0,P=e[0],V=0;V<P.length;V++){var re=P[V];(!V||re.x<u)&&(u=re.x),(!V||re.y<f)&&(f=re.y),(!V||re.x>m)&&(m=re.x),(!V||re.y>S)&&(S=re.y)}var he=Math.min(m-u,S-f),_e=he/2,we=new d([],te);if(he===0)return new ee(u,f);for(var lt=u;lt<m;lt+=he)for(var Lt=f;Lt<S;Lt+=he)we.push(new B(lt+_e,Lt+_e,_e,e));for(var Ct=function(ir){for(var br=0,Sr=0,Fr=0,Nr=ir[0],mn=0,hn=Nr.length,Ln=hn-1;mn<hn;Ln=mn++){var Qn=Nr[mn],Yn=Nr[Ln],Nn=Qn.x*Yn.y-Yn.x*Qn.y;Sr+=(Qn.x+Yn.x)*Nn,Fr+=(Qn.y+Yn.y)*Nn,br+=3*Nn}return new B(Sr/br,Fr/br,0,ir)}(e),$t=we.length;we.length;){var Xt=we.pop();(Xt.d>Ct.d||!Ct.d)&&(Ct=Xt,r&&console.log("found best %d after %d probes",Math.round(1e4*Xt.d)/1e4,$t)),Xt.max-Ct.d<=t||(we.push(new B(Xt.p.x-(_e=Xt.h/2),Xt.p.y-_e,_e,e)),we.push(new B(Xt.p.x+_e,Xt.p.y-_e,_e,e)),we.push(new B(Xt.p.x-_e,Xt.p.y+_e,_e,e)),we.push(new B(Xt.p.x+_e,Xt.p.y+_e,_e,e)),$t+=4)}return r&&(console.log("num probes: "+$t),console.log("best distance: "+Ct.d)),Ct.p}function te(e,t){return t.max-e.max}function B(e,t,r,u){this.p=new ee(e,t),this.h=r,this.d=function(f,m){for(var S=!1,P=1/0,V=0;V<m.length;V++)for(var re=m[V],he=0,_e=re.length,we=_e-1;he<_e;we=he++){var lt=re[he],Lt=re[we];lt.y>f.y!=Lt.y>f.y&&f.x<(Lt.x-lt.x)*(f.y-lt.y)/(Lt.y-lt.y)+lt.x&&(S=!S),P=Math.min(P,Hu(f,lt,Lt))}return(S?1:-1)*Math.sqrt(P)}(this.p,u),this.max=this.d+this.h*Math.SQRT2}d.prototype.push=function(e){this.data.push(e),this.length++,this._up(this.length-1)},d.prototype.pop=function(){if(this.length!==0){var e=this.data[0],t=this.data.pop();return this.length--,this.length>0&&(this.data[0]=t,this._down(0)),e}},d.prototype.peek=function(){return this.data[0]},d.prototype._up=function(e){for(var t=this.data,r=this.compare,u=t[e];e>0;){var f=e-1>>1,m=t[f];if(r(u,m)>=0)break;t[e]=m,e=f}t[e]=u},d.prototype._down=function(e){for(var t=this.data,r=this.compare,u=this.length>>1,f=t[e];e<u;){var m=1+(e<<1),S=t[m],P=m+1;if(P<this.length&&r(t[P],S)<0&&(m=P,S=t[P]),r(S,f)>=0)break;t[e]=S,e=m}t[e]=f};var k=Number.POSITIVE_INFINITY;function Q(e,t){return t[1]!==k?function(r,u,f){var m=0,S=0;switch(u=Math.abs(u),f=Math.abs(f),r){case"top-right":case"top-left":case"top":S=f-7;break;case"bottom-right":case"bottom-left":case"bottom":S=7-f}switch(r){case"top-right":case"bottom-right":case"right":m=-u;break;case"top-left":case"bottom-left":case"left":m=u}return[m,S]}(e,t[0],t[1]):function(r,u){var f=0,m=0;u<0&&(u=0);var S=u/Math.sqrt(2);switch(r){case"top-right":case"top-left":m=S-7;break;case"bottom-right":case"bottom-left":m=7-S;break;case"bottom":m=7-u;break;case"top":m=u-7}switch(r){case"top-right":case"bottom-right":f=-S;break;case"top-left":case"bottom-left":f=S;break;case"left":f=u;break;case"right":f=-u}return[f,m]}(e,t[0])}function We(e){switch(e){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function rt(e,t,r,u,f,m,S,P,V,re,he,_e,we,lt,Lt){var Ct=function(Sr,Fr,Nr,mn,hn,Ln,Qn,Yn){for(var Nn=mn.layout.get("text-rotate").evaluate(Ln,{})*Math.PI/180,_a=[],fa=0,ra=Fr.positionedLines;fa<ra.length;fa+=1)for(var Ja=ra[fa],Da=0,ji=Ja.positionedGlyphs;Da<ji.length;Da+=1){var va=ji[Da];if(va.rect){var ai=va.rect||{},Go=4,bi=!0,Ho=1,Zo=0,ns=(hn||Yn)&&va.vertical,gu=va.metrics.advance*va.scale/2;if(Yn&&Fr.verticalizable&&(Zo=Ja.lineOffset/2-(va.imageName?-(24-va.metrics.width*va.scale)/2:24*(va.scale-1))),va.imageName){var as=Qn[va.imageName];bi=as.sdf,Go=1/(Ho=as.pixelRatio)}var Yu=hn?[va.x+gu,va.y]:[0,0],su=hn?[0,0]:[va.x+gu+Nr[0],va.y+Nr[1]-Zo],Ku=[0,0];ns&&(Ku=su,su=[0,0]);var uu=(va.metrics.left-Go)*va.scale-gu+su[0],Ws=(-va.metrics.top-Go)*va.scale+su[1],lu=uu+ai.w*va.scale/Ho,mi=Ws+ai.h*va.scale/Ho,ii=new ee(uu,Ws),Ji=new ee(lu,Ws),fo=new ee(uu,mi),yu=new ee(lu,mi);if(ns){var Eo=new ee(-gu,gu- -17),Wo=-Math.PI/2,Ru=12-gu,di=new ee(22-Ru,-(va.imageName?Ru:0)),Zf=new(Function.prototype.bind.apply(ee,[null].concat(Ku)));ii._rotateAround(Wo,Eo)._add(di)._add(Zf),Ji._rotateAround(Wo,Eo)._add(di)._add(Zf),fo._rotateAround(Wo,Eo)._add(di)._add(Zf),yu._rotateAround(Wo,Eo)._add(di)._add(Zf)}if(Nn){var Zc=Math.sin(Nn),cf=Math.cos(Nn),dc=[cf,-Zc,Zc,cf];ii._matMult(dc),Ji._matMult(dc),fo._matMult(dc),yu._matMult(dc)}var Iu=new ee(0,0),Pf=new ee(0,0);_a.push({tl:ii,tr:Ji,bl:fo,br:yu,tex:ai,writingMode:Fr.writingMode,glyphOffset:Yu,sectionIndex:va.sectionIndex,isSDF:bi,pixelOffsetTL:Iu,pixelOffsetBR:Pf,minFontScaleX:0,minFontScaleY:0})}}return _a}(0,r,P,f,m,S,u,e.allowVerticalPlacement),$t=e.textSizeData,Xt=null;$t.kind==="source"?(Xt=[128*f.layout.get("text-size").evaluate(S,{})])[0]>32640&&Me(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):$t.kind==="composite"&&((Xt=[128*lt.compositeTextSizes[0].evaluate(S,{},Lt),128*lt.compositeTextSizes[1].evaluate(S,{},Lt)])[0]>32640||Xt[1]>32640)&&Me(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),e.addSymbols(e.text,Ct,Xt,P,m,S,re,t,V.lineStartIndex,V.lineLength,we,Lt);for(var ir=0,br=he;ir<br.length;ir+=1)_e[br[ir]]=e.text.placedSymbolArray.length-1;return 4*Ct.length}function Pe(e){for(var t in e)return e[t];return null}function Qe(e,t,r,u){var f=e.compareText;if(t in f){for(var m=f[t],S=m.length-1;S>=0;S--)if(u.dist(m[S])<r)return!0}else f[t]=[];return f[t].push(u),!1}var Tt=Co.VectorTileFeature.types,ke=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function vt(e,t,r,u,f,m,S,P,V,re,he,_e,we){var lt=P?Math.min(32640,Math.round(P[0])):0,Lt=P?Math.min(32640,Math.round(P[1])):0;e.emplaceBack(t,r,Math.round(32*u),Math.round(32*f),m,S,(lt<<1)+(V?1:0),Lt,16*re,16*he,256*_e,256*we)}function De(e,t,r){e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r)}function Zt(e){for(var t=0,r=e.sections;t<r.length;t+=1)if(jl(r[t].text))return!0;return!1}var Kt=function(t){this.layoutVertexArray=new yf,this.indexArray=new Al,this.programConfigurations=t,this.segments=new nt,this.dynamicLayoutVertexArray=new Ul,this.opacityVertexArray=new Bl,this.placedSymbolArray=new l};Kt.prototype.isEmpty=function(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0},Kt.prototype.upload=function(e,t,r,u){this.isEmpty()||(r&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Tf.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,t),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,zf.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,ke,!0),this.opacityVertexBuffer.itemSize=1),(r||u)&&this.programConfigurations.upload(e))},Kt.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},Rn("SymbolBuffers",Kt);var dr=function(t,r,u){this.layoutVertexArray=new t,this.layoutAttributes=r,this.indexArray=new u,this.segments=new nt,this.collisionVertexArray=new zc};dr.prototype.upload=function(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,Uf.members,!0)},dr.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},Rn("CollisionBuffers",dr);var rr=function(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(S){return S.id}),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=ko([]),this.placementViewportMatrix=ko([]);var r=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Ci(this.zoom,r["text-size"]),this.iconSizeData=Ci(this.zoom,r["icon-size"]);var u=this.layers[0].layout,f=u.get("symbol-sort-key"),m=u.get("symbol-z-order");this.canOverlap=u.get("text-allow-overlap")||u.get("icon-allow-overlap")||u.get("text-ignore-placement")||u.get("icon-ignore-placement"),this.sortFeaturesByKey=m!=="viewport-y"&&f.constantOr(1)!==void 0,this.sortFeaturesByY=(m==="viewport-y"||m==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,u.get("symbol-placement")==="point"&&(this.writingModes=u.get("text-writing-mode").map(function(S){return na[S]})),this.stateDependentLayerIds=this.layers.filter(function(S){return S.isStateDependent()}).map(function(S){return S.id}),this.sourceID=t.sourceID};rr.prototype.createArrays=function(){this.text=new Kt(new La(this.layers,this.zoom,function(e){return/^text/.test(e)})),this.icon=new Kt(new La(this.layers,this.zoom,function(e){return/^icon/.test(e)})),this.glyphOffsetArray=new L,this.lineVertexArray=new j,this.symbolInstances=new O},rr.prototype.calculateGlyphDependencies=function(e,t,r,u,f){for(var m=0;m<e.length;m++)if(t[e.charCodeAt(m)]=!0,(r||u)&&f){var S=Zl[e.charAt(m)];S&&(t[S.charCodeAt(0)]=!0)}},rr.prototype.populate=function(e,t,r){var u=this.layers[0],f=u.layout,m=f.get("text-font"),S=f.get("text-field"),P=f.get("icon-image"),V=(S.value.kind!=="constant"||S.value.value instanceof Xi&&!S.value.value.isEmpty()||S.value.value.toString().length>0)&&(m.value.kind!=="constant"||m.value.value.length>0),re=P.value.kind!=="constant"||!!P.value.value||Object.keys(P.parameters).length>0,he=f.get("symbol-sort-key");if(this.features=[],V||re){for(var _e=t.iconDependencies,we=t.glyphDependencies,lt=t.availableImages,Lt=new Pa(this.zoom),Ct=0,$t=e;Ct<$t.length;Ct+=1){var Xt=$t[Ct],ir=Xt.feature,br=Xt.id,Sr=Xt.index,Fr=Xt.sourceLayerIndex,Nr=u._featureFilter.needGeometry,mn=Bi(ir,Nr);if(u._featureFilter.filter(Lt,mn,r)){Nr||(mn.geometry=Ei(ir));var hn=void 0;if(V){var Ln=u.getValueAndResolveTokens("text-field",mn,r,lt),Qn=Xi.factory(Ln);Zt(Qn)&&(this.hasRTLText=!0),(!this.hasRTLText||jc()==="unavailable"||this.hasRTLText&&ls.isParsed())&&(hn=Of(Qn,u,mn))}var Yn=void 0;if(re){var Nn=u.getValueAndResolveTokens("icon-image",mn,r,lt);Yn=Nn instanceof Xo?Nn:Xo.fromString(Nn)}if(hn||Yn){var _a=this.sortFeaturesByKey?he.evaluate(mn,{},r):void 0;if(this.features.push({id:br,text:hn,icon:Yn,index:Sr,sourceLayerIndex:Fr,geometry:mn.geometry,properties:ir.properties,type:Tt[ir.type],sortKey:_a}),Yn&&(_e[Yn.name]=!0),hn){var fa=m.evaluate(mn,{},r).join(","),ra=f.get("text-rotation-alignment")==="map"&&f.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(na.vertical)>=0;for(var Ja=0,Da=hn.sections;Ja<Da.length;Ja+=1){var ji=Da[Ja];if(ji.image)_e[ji.image.name]=!0;else{var va=bc(hn.toString()),ai=ji.fontStack||fa,Go=we[ai]=we[ai]||{};this.calculateGlyphDependencies(ji.text,Go,ra,this.allowVerticalPlacement,va)}}}}}}f.get("symbol-placement")==="line"&&(this.features=function(bi){var Ho={},Zo={},ns=[],gu=0;function as(Eo){ns.push(bi[Eo]),gu++}function Yu(Eo,Wo,Ru){var di=Zo[Eo];return delete Zo[Eo],Zo[Wo]=di,ns[di].geometry[0].pop(),ns[di].geometry[0]=ns[di].geometry[0].concat(Ru[0]),di}function su(Eo,Wo,Ru){var di=Ho[Wo];return delete Ho[Wo],Ho[Eo]=di,ns[di].geometry[0].shift(),ns[di].geometry[0]=Ru[0].concat(ns[di].geometry[0]),di}function Ku(Eo,Wo,Ru){var di=Ru?Wo[0][Wo[0].length-1]:Wo[0][0];return Eo+":"+di.x+":"+di.y}for(var uu=0;uu<bi.length;uu++){var Ws=bi[uu],lu=Ws.geometry,mi=Ws.text?Ws.text.toString():null;if(mi){var ii=Ku(mi,lu),Ji=Ku(mi,lu,!0);if(ii in Zo&&Ji in Ho&&Zo[ii]!==Ho[Ji]){var fo=su(ii,Ji,lu),yu=Yu(ii,Ji,ns[fo].geometry);delete Ho[ii],delete Zo[Ji],Zo[Ku(mi,ns[yu].geometry,!0)]=yu,ns[fo].geometry=null}else ii in Zo?Yu(ii,Ji,lu):Ji in Ho?su(ii,Ji,lu):(as(uu),Ho[ii]=gu-1,Zo[Ji]=gu-1)}else as(uu)}return ns.filter(function(Eo){return Eo.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(bi,Ho){return bi.sortKey-Ho.sortKey})}},rr.prototype.update=function(e,t,r){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,t,this.layers,r),this.icon.programConfigurations.updatePaintArrays(e,t,this.layers,r))},rr.prototype.isEmpty=function(){return this.symbolInstances.length===0&&!this.hasRTLText},rr.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},rr.prototype.upload=function(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},rr.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},rr.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},rr.prototype.addToLineVertexArray=function(e,t){var r=this.lineVertexArray.length;if(e.segment!==void 0){for(var u=e.dist(t[e.segment+1]),f=e.dist(t[e.segment]),m={},S=e.segment+1;S<t.length;S++)m[S]={x:t[S].x,y:t[S].y,tileUnitDistanceFromAnchor:u},S<t.length-1&&(u+=t[S+1].dist(t[S]));for(var P=e.segment||0;P>=0;P--)m[P]={x:t[P].x,y:t[P].y,tileUnitDistanceFromAnchor:f},P>0&&(f+=t[P-1].dist(t[P]));for(var V=0;V<t.length;V++){var re=m[V];this.lineVertexArray.emplaceBack(re.x,re.y,re.tileUnitDistanceFromAnchor)}}return{lineStartIndex:r,lineLength:this.lineVertexArray.length-r}},rr.prototype.addSymbols=function(e,t,r,u,f,m,S,P,V,re,he,_e){for(var we=e.indexArray,lt=e.layoutVertexArray,Lt=e.segments.prepareSegment(4*t.length,lt,we,this.canOverlap?m.sortKey:void 0),Ct=this.glyphOffsetArray.length,$t=Lt.vertexLength,Xt=this.allowVerticalPlacement&&S===na.vertical?Math.PI/2:0,ir=m.text&&m.text.sections,br=0;br<t.length;br++){var Sr=t[br],Fr=Sr.tl,Nr=Sr.tr,mn=Sr.bl,hn=Sr.br,Ln=Sr.tex,Qn=Sr.pixelOffsetTL,Yn=Sr.pixelOffsetBR,Nn=Sr.minFontScaleX,_a=Sr.minFontScaleY,fa=Sr.glyphOffset,ra=Sr.isSDF,Ja=Sr.sectionIndex,Da=Lt.vertexLength,ji=fa[1];vt(lt,P.x,P.y,Fr.x,ji+Fr.y,Ln.x,Ln.y,r,ra,Qn.x,Qn.y,Nn,_a),vt(lt,P.x,P.y,Nr.x,ji+Nr.y,Ln.x+Ln.w,Ln.y,r,ra,Yn.x,Qn.y,Nn,_a),vt(lt,P.x,P.y,mn.x,ji+mn.y,Ln.x,Ln.y+Ln.h,r,ra,Qn.x,Yn.y,Nn,_a),vt(lt,P.x,P.y,hn.x,ji+hn.y,Ln.x+Ln.w,Ln.y+Ln.h,r,ra,Yn.x,Yn.y,Nn,_a),De(e.dynamicLayoutVertexArray,P,Xt),we.emplaceBack(Da,Da+1,Da+2),we.emplaceBack(Da+1,Da+2,Da+3),Lt.vertexLength+=4,Lt.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(fa[0]),br!==t.length-1&&Ja===t[br+1].sectionIndex||e.programConfigurations.populatePaintArrays(lt.length,m,m.index,{},_e,ir&&ir[Ja])}e.placedSymbolArray.emplaceBack(P.x,P.y,Ct,this.glyphOffsetArray.length-Ct,$t,V,re,P.segment,r?r[0]:0,r?r[1]:0,u[0],u[1],S,0,!1,0,he)},rr.prototype._addCollisionDebugVertex=function(e,t,r,u,f,m){return t.emplaceBack(0,0),e.emplaceBack(r.x,r.y,u,f,Math.round(m.x),Math.round(m.y))},rr.prototype.addCollisionDebugVertices=function(e,t,r,u,f,m,S){var P=f.segments.prepareSegment(4,f.layoutVertexArray,f.indexArray),V=P.vertexLength,re=f.layoutVertexArray,he=f.collisionVertexArray,_e=S.anchorX,we=S.anchorY;this._addCollisionDebugVertex(re,he,m,_e,we,new ee(e,t)),this._addCollisionDebugVertex(re,he,m,_e,we,new ee(r,t)),this._addCollisionDebugVertex(re,he,m,_e,we,new ee(r,u)),this._addCollisionDebugVertex(re,he,m,_e,we,new ee(e,u)),P.vertexLength+=4;var lt=f.indexArray;lt.emplaceBack(V,V+1),lt.emplaceBack(V+1,V+2),lt.emplaceBack(V+2,V+3),lt.emplaceBack(V+3,V),P.primitiveLength+=4},rr.prototype.addDebugCollisionBoxes=function(e,t,r,u){for(var f=e;f<t;f++){var m=this.collisionBoxArray.get(f);this.addCollisionDebugVertices(m.x1,m.y1,m.x2,m.y2,u?this.textCollisionBox:this.iconCollisionBox,m.anchorPoint,r)}},rr.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new dr(fs,uh.members,rc),this.iconCollisionBox=new dr(fs,uh.members,rc);for(var e=0;e<this.symbolInstances.length;e++){var t=this.symbolInstances.get(e);this.addDebugCollisionBoxes(t.textBoxStartIndex,t.textBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.verticalTextBoxStartIndex,t.verticalTextBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.iconBoxStartIndex,t.iconBoxEndIndex,t,!1),this.addDebugCollisionBoxes(t.verticalIconBoxStartIndex,t.verticalIconBoxEndIndex,t,!1)}},rr.prototype._deserializeCollisionBoxesForSymbol=function(e,t,r,u,f,m,S,P,V){for(var re={},he=t;he<r;he++){var _e=e.get(he);re.textBox={x1:_e.x1,y1:_e.y1,x2:_e.x2,y2:_e.y2,anchorPointX:_e.anchorPointX,anchorPointY:_e.anchorPointY},re.textFeatureIndex=_e.featureIndex;break}for(var we=u;we<f;we++){var lt=e.get(we);re.verticalTextBox={x1:lt.x1,y1:lt.y1,x2:lt.x2,y2:lt.y2,anchorPointX:lt.anchorPointX,anchorPointY:lt.anchorPointY},re.verticalTextFeatureIndex=lt.featureIndex;break}for(var Lt=m;Lt<S;Lt++){var Ct=e.get(Lt);re.iconBox={x1:Ct.x1,y1:Ct.y1,x2:Ct.x2,y2:Ct.y2,anchorPointX:Ct.anchorPointX,anchorPointY:Ct.anchorPointY},re.iconFeatureIndex=Ct.featureIndex;break}for(var $t=P;$t<V;$t++){var Xt=e.get($t);re.verticalIconBox={x1:Xt.x1,y1:Xt.y1,x2:Xt.x2,y2:Xt.y2,anchorPointX:Xt.anchorPointX,anchorPointY:Xt.anchorPointY},re.verticalIconFeatureIndex=Xt.featureIndex;break}return re},rr.prototype.deserializeCollisionBoxes=function(e){this.collisionArrays=[];for(var t=0;t<this.symbolInstances.length;t++){var r=this.symbolInstances.get(t);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,r.textBoxStartIndex,r.textBoxEndIndex,r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r.iconBoxStartIndex,r.iconBoxEndIndex,r.verticalIconBoxStartIndex,r.verticalIconBoxEndIndex))}},rr.prototype.hasTextData=function(){return this.text.segments.get().length>0},rr.prototype.hasIconData=function(){return this.icon.segments.get().length>0},rr.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},rr.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},rr.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},rr.prototype.addIndicesForPlacedSymbol=function(e,t){for(var r=e.placedSymbolArray.get(t),u=r.vertexStartIndex+4*r.numGlyphs,f=r.vertexStartIndex;f<u;f+=4)e.indexArray.emplaceBack(f,f+1,f+2),e.indexArray.emplaceBack(f+1,f+2,f+3)},rr.prototype.getSortedSymbolIndexes=function(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;for(var t=Math.sin(e),r=Math.cos(e),u=[],f=[],m=[],S=0;S<this.symbolInstances.length;++S){m.push(S);var P=this.symbolInstances.get(S);u.push(0|Math.round(t*P.anchorX+r*P.anchorY)),f.push(P.featureIndex)}return m.sort(function(V,re){return u[V]-u[re]||f[re]-f[V]}),m},rr.prototype.addToSortKeyRanges=function(e,t){var r=this.sortKeyRanges[this.sortKeyRanges.length-1];r&&r.sortKey===t?r.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:t,symbolInstanceStart:e,symbolInstanceEnd:e+1})},rr.prototype.sortFeatures=function(e){var t=this;if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var r=0,u=this.symbolInstanceIndexes;r<u.length;r+=1){var f=this.symbolInstances.get(u[r]);this.featureSortOrder.push(f.featureIndex),[f.rightJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.leftJustifiedTextSymbolIndex].forEach(function(m,S,P){m>=0&&P.indexOf(m)===S&&t.addIndicesForPlacedSymbol(t.text,m)}),f.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,f.verticalPlacedTextSymbolIndex),f.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,f.placedIconSymbolIndex),f.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,f.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},Rn("SymbolBucket",rr,{omit:["layers","collisionBoxArray","features","compareText"]}),rr.MAX_GLYPHS=65535,rr.addDynamicAttributes=De;var mr=new vo({"symbol-placement":new Jn(Ze.layout_symbol["symbol-placement"]),"symbol-spacing":new Jn(Ze.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Jn(Ze.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new jn(Ze.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Jn(Ze.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Jn(Ze.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Jn(Ze.layout_symbol["icon-ignore-placement"]),"icon-optional":new Jn(Ze.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Jn(Ze.layout_symbol["icon-rotation-alignment"]),"icon-size":new jn(Ze.layout_symbol["icon-size"]),"icon-text-fit":new Jn(Ze.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Jn(Ze.layout_symbol["icon-text-fit-padding"]),"icon-image":new jn(Ze.layout_symbol["icon-image"]),"icon-rotate":new jn(Ze.layout_symbol["icon-rotate"]),"icon-padding":new Jn(Ze.layout_symbol["icon-padding"]),"icon-keep-upright":new Jn(Ze.layout_symbol["icon-keep-upright"]),"icon-offset":new jn(Ze.layout_symbol["icon-offset"]),"icon-anchor":new jn(Ze.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Jn(Ze.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Jn(Ze.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Jn(Ze.layout_symbol["text-rotation-alignment"]),"text-field":new jn(Ze.layout_symbol["text-field"]),"text-font":new jn(Ze.layout_symbol["text-font"]),"text-size":new jn(Ze.layout_symbol["text-size"]),"text-max-width":new jn(Ze.layout_symbol["text-max-width"]),"text-line-height":new Jn(Ze.layout_symbol["text-line-height"]),"text-letter-spacing":new jn(Ze.layout_symbol["text-letter-spacing"]),"text-justify":new jn(Ze.layout_symbol["text-justify"]),"text-radial-offset":new jn(Ze.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Jn(Ze.layout_symbol["text-variable-anchor"]),"text-anchor":new jn(Ze.layout_symbol["text-anchor"]),"text-max-angle":new Jn(Ze.layout_symbol["text-max-angle"]),"text-writing-mode":new Jn(Ze.layout_symbol["text-writing-mode"]),"text-rotate":new jn(Ze.layout_symbol["text-rotate"]),"text-padding":new Jn(Ze.layout_symbol["text-padding"]),"text-keep-upright":new Jn(Ze.layout_symbol["text-keep-upright"]),"text-transform":new jn(Ze.layout_symbol["text-transform"]),"text-offset":new jn(Ze.layout_symbol["text-offset"]),"text-allow-overlap":new Jn(Ze.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Jn(Ze.layout_symbol["text-ignore-placement"]),"text-optional":new Jn(Ze.layout_symbol["text-optional"])}),Or={paint:new vo({"icon-opacity":new jn(Ze.paint_symbol["icon-opacity"]),"icon-color":new jn(Ze.paint_symbol["icon-color"]),"icon-halo-color":new jn(Ze.paint_symbol["icon-halo-color"]),"icon-halo-width":new jn(Ze.paint_symbol["icon-halo-width"]),"icon-halo-blur":new jn(Ze.paint_symbol["icon-halo-blur"]),"icon-translate":new Jn(Ze.paint_symbol["icon-translate"]),"icon-translate-anchor":new Jn(Ze.paint_symbol["icon-translate-anchor"]),"text-opacity":new jn(Ze.paint_symbol["text-opacity"]),"text-color":new jn(Ze.paint_symbol["text-color"],{runtimeType:En,getOverride:function(t){return t.textColor},hasOverride:function(t){return!!t.textColor}}),"text-halo-color":new jn(Ze.paint_symbol["text-halo-color"]),"text-halo-width":new jn(Ze.paint_symbol["text-halo-width"]),"text-halo-blur":new jn(Ze.paint_symbol["text-halo-blur"]),"text-translate":new Jn(Ze.paint_symbol["text-translate"]),"text-translate-anchor":new Jn(Ze.paint_symbol["text-translate-anchor"])}),layout:mr},$r=function(t){this.type=t.property.overrides?t.property.overrides.runtimeType:fn,this.defaultValue=t};$r.prototype.evaluate=function(e){if(e.formattedSection){var t=this.defaultValue.property.overrides;if(t&&t.hasOverride(e.formattedSection))return t.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default},$r.prototype.eachChild=function(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)},$r.prototype.outputDefined=function(){return!1},$r.prototype.serialize=function(){return null},Rn("FormatSectionOverride",$r,{omit:["defaultValue"]});var Bn=function(e){function t(r){e.call(this,r,Or)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.recalculate=function(r,u){if(e.prototype.recalculate.call(this,r,u),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){var f=this.layout.get("text-writing-mode");if(f){for(var m=[],S=0,P=f;S<P.length;S+=1){var V=P[S];m.indexOf(V)<0&&m.push(V)}this.layout._values["text-writing-mode"]=m}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},t.prototype.getValueAndResolveTokens=function(r,u,f,m){var S=this.layout.get(r).evaluate(u,{},f,m),P=this._unevaluatedLayout._values[r];return P.isDataDriven()||Lo(P.value)||!S?S:function(V,re){return re.replace(/{([^{}]+)}/g,function(he,_e){return _e in V?String(V[_e]):""})}(u.properties,S)},t.prototype.createBucket=function(r){return new rr(r)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t.prototype._setPaintOverrides=function(){for(var r=0,u=Or.paint.overridableProperties;r<u.length;r+=1){var f=u[r];if(t.hasPaintOverride(this.layout,f)){var m,S=this.paint.get(f),P=new $r(S),V=new bl(P,S.property.specification);m=S.value.kind==="constant"||S.value.kind==="source"?new Ll("source",V):new Rl("composite",V,S.value.zoomStops,S.value._interpolationType),this.paint._values[f]=new Cs(S.property,m,S.parameters)}}},t.prototype._handleOverridablePaintPropertyUpdate=function(r,u,f){return!(!this.layout||u.isDataDriven()||f.isDataDriven())&&t.hasPaintOverride(this.layout,r)},t.hasPaintOverride=function(r,u){var f=r.get("text-field"),m=Or.paint.properties[u],S=!1,P=function(_e){for(var we=0,lt=_e;we<lt.length;we+=1)if(m.overrides&&m.overrides.hasOverride(lt[we]))return void(S=!0)};if(f.value.kind==="constant"&&f.value.value instanceof Xi)P(f.value.value.sections);else if(f.value.kind==="source"){var V=function he(_e){S||(_e instanceof ui&&Oi(_e.value)===Ga?P(_e.value.sections):_e instanceof oo?P(_e.sections):_e.eachChild(he))},re=f.value;re._styleExpression&&V(re._styleExpression.expression)}return S},t}(ws),on={paint:new vo({"background-color":new Jn(Ze.paint_background["background-color"]),"background-pattern":new cs(Ze.paint_background["background-pattern"]),"background-opacity":new Jn(Ze.paint_background["background-opacity"])})},Dn=function(e){function t(r){e.call(this,r,on)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(ws),ca={paint:new vo({"raster-opacity":new Jn(Ze.paint_raster["raster-opacity"]),"raster-hue-rotate":new Jn(Ze.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Jn(Ze.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Jn(Ze.paint_raster["raster-brightness-max"]),"raster-saturation":new Jn(Ze.paint_raster["raster-saturation"]),"raster-contrast":new Jn(Ze.paint_raster["raster-contrast"]),"raster-resampling":new Jn(Ze.paint_raster["raster-resampling"]),"raster-fade-duration":new Jn(Ze.paint_raster["raster-fade-duration"])})},Na=function(e){function t(r){e.call(this,r,ca)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(ws),ri=function(e){function t(r){e.call(this,r,{}),this.implementation=r}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.is3D=function(){return this.implementation.renderingMode==="3d"},t.prototype.hasOffscreenPass=function(){return this.implementation.prerender!==void 0},t.prototype.recalculate=function(){},t.prototype.updateTransitions=function(){},t.prototype.hasTransition=function(){},t.prototype.serialize=function(){},t.prototype.onAdd=function(r){this.implementation.onAdd&&this.implementation.onAdd(r,r.painter.context.gl)},t.prototype.onRemove=function(r){this.implementation.onRemove&&this.implementation.onRemove(r,r.painter.context.gl)},t}(ws),co={circle:nu,heatmap:af,hillshade:Af,fill:Dr,"fill-extrusion":_i,line:Eh,symbol:Bn,background:Dn,raster:Na},Hc=Y.HTMLImageElement,ys=Y.HTMLCanvasElement,fc=Y.HTMLVideoElement,xo=Y.ImageData,Wl=Y.ImageBitmap,Xu=function(t,r,u,f){this.context=t,this.format=u,this.texture=t.gl.createTexture(),this.update(r,f)};Xu.prototype.update=function(e,t,r){var u=e.width,f=e.height,m=!(this.size&&this.size[0]===u&&this.size[1]===f||r),S=this.context,P=S.gl;if(this.useMipmap=Boolean(t&&t.useMipmap),P.bindTexture(P.TEXTURE_2D,this.texture),S.pixelStoreUnpackFlipY.set(!1),S.pixelStoreUnpack.set(1),S.pixelStoreUnpackPremultiplyAlpha.set(this.format===P.RGBA&&(!t||t.premultiply!==!1)),m)this.size=[u,f],e instanceof Hc||e instanceof ys||e instanceof fc||e instanceof xo||Wl&&e instanceof Wl?P.texImage2D(P.TEXTURE_2D,0,this.format,this.format,P.UNSIGNED_BYTE,e):P.texImage2D(P.TEXTURE_2D,0,this.format,u,f,0,this.format,P.UNSIGNED_BYTE,e.data);else{var V=r||{x:0,y:0},re=V.x,he=V.y;e instanceof Hc||e instanceof ys||e instanceof fc||e instanceof xo||Wl&&e instanceof Wl?P.texSubImage2D(P.TEXTURE_2D,0,re,he,P.RGBA,P.UNSIGNED_BYTE,e):P.texSubImage2D(P.TEXTURE_2D,0,re,he,u,f,P.RGBA,P.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&P.generateMipmap(P.TEXTURE_2D)},Xu.prototype.bind=function(e,t,r){var u=this.context.gl;u.bindTexture(u.TEXTURE_2D,this.texture),r!==u.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(r=u.LINEAR),e!==this.filter&&(u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,e),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,r||e),this.filter=e),t!==this.wrap&&(u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,t),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,t),this.wrap=t)},Xu.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},Xu.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var pl=function(t){var r=this;this._callback=t,this._triggered=!1,typeof MessageChannel!="undefined"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){r._triggered=!1,r._callback()})};pl.prototype.trigger=function(){var e=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){e._triggered=!1,e._callback()},0))},pl.prototype.remove=function(){delete this._channel,this._callback=function(){}};var wl=function(t,r,u){this.target=t,this.parent=r,this.mapId=u,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},wt(["receive","process"],this),this.invoker=new pl(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=Qt()?t:Y};function Mf(e,t,r){var u=2*Math.PI*6378137/256/Math.pow(2,r);return[e*u-2*Math.PI*6378137/2,t*u-2*Math.PI*6378137/2]}wl.prototype.send=function(e,t,r,u,f){var m=this;f===void 0&&(f=!1);var S=Math.round(1e18*Math.random()).toString(36).substring(0,10);r&&(this.callbacks[S]=r);var P=$(this.globalScope)?void 0:[];return this.target.postMessage({id:S,type:e,hasCallback:!!r,targetMapId:u,mustQueue:f,sourceMapId:this.mapId,data:du(t,P)},P),{cancel:function(){r&&delete m.callbacks[S],m.target.postMessage({id:S,type:"<cancel>",targetMapId:u,sourceMapId:m.mapId})}}},wl.prototype.receive=function(e){var t=e.data,r=t.id;if(r&&(!t.targetMapId||this.mapId===t.targetMapId))if(t.type==="<cancel>"){delete this.tasks[r];var u=this.cancelCallbacks[r];delete this.cancelCallbacks[r],u&&u()}else Qt()||t.mustQueue?(this.tasks[r]=t,this.taskQueue.push(r),this.invoker.trigger()):this.processTask(r,t)},wl.prototype.process=function(){if(this.taskQueue.length){var e=this.taskQueue.shift(),t=this.tasks[e];delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),t&&this.processTask(e,t)}},wl.prototype.processTask=function(e,t){var r=this;if(t.type==="<response>"){var u=this.callbacks[e];delete this.callbacks[e],u&&(t.error?u(Bs(t.error)):u(null,Bs(t.data)))}else{var f=!1,m=$(this.globalScope)?void 0:[],S=t.hasCallback?function(he,_e){f=!0,delete r.cancelCallbacks[e],r.target.postMessage({id:e,type:"<response>",sourceMapId:r.mapId,error:he?du(he):null,data:du(_e,m)},m)}:function(he){f=!0},P=null,V=Bs(t.data);if(this.parent[t.type])P=this.parent[t.type](t.sourceMapId,V,S);else if(this.parent.getWorkerSource){var re=t.type.split(".");P=this.parent.getWorkerSource(t.sourceMapId,re[0],V.source)[re[1]](V,S)}else S(new Error("Could not find function "+t.type));!f&&P&&P.cancel&&(this.cancelCallbacks[e]=P.cancel)}},wl.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var Fa=function(t,r){t&&(r?this.setSouthWest(t).setNorthEast(r):t.length===4?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))};Fa.prototype.setNorthEast=function(e){return this._ne=e instanceof li?new li(e.lng,e.lat):li.convert(e),this},Fa.prototype.setSouthWest=function(e){return this._sw=e instanceof li?new li(e.lng,e.lat):li.convert(e),this},Fa.prototype.extend=function(e){var t,r,u=this._sw,f=this._ne;if(e instanceof li)t=e,r=e;else{if(!(e instanceof Fa))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(Fa.convert(e)):this.extend(li.convert(e)):this;if(r=e._ne,!(t=e._sw)||!r)return this}return u||f?(u.lng=Math.min(t.lng,u.lng),u.lat=Math.min(t.lat,u.lat),f.lng=Math.max(r.lng,f.lng),f.lat=Math.max(r.lat,f.lat)):(this._sw=new li(t.lng,t.lat),this._ne=new li(r.lng,r.lat)),this},Fa.prototype.getCenter=function(){return new li((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},Fa.prototype.getSouthWest=function(){return this._sw},Fa.prototype.getNorthEast=function(){return this._ne},Fa.prototype.getNorthWest=function(){return new li(this.getWest(),this.getNorth())},Fa.prototype.getSouthEast=function(){return new li(this.getEast(),this.getSouth())},Fa.prototype.getWest=function(){return this._sw.lng},Fa.prototype.getSouth=function(){return this._sw.lat},Fa.prototype.getEast=function(){return this._ne.lng},Fa.prototype.getNorth=function(){return this._ne.lat},Fa.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},Fa.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},Fa.prototype.isEmpty=function(){return!(this._sw&&this._ne)},Fa.prototype.contains=function(e){var t=li.convert(e),r=t.lng,u=t.lat,f=this._sw.lng<=r&&r<=this._ne.lng;return this._sw.lng>this._ne.lng&&(f=this._sw.lng>=r&&r>=this._ne.lng),this._sw.lat<=u&&u<=this._ne.lat&&f},Fa.convert=function(e){return!e||e instanceof Fa?e:new Fa(e)};var li=function(t,r){if(isNaN(t)||isNaN(r))throw new Error("Invalid LngLat object: ("+t+", "+r+")");if(this.lng=+t,this.lat=+r,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};li.prototype.wrap=function(){return new li(mt(this.lng,-180,180),this.lat)},li.prototype.toArray=function(){return[this.lng,this.lat]},li.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},li.prototype.distanceTo=function(e){var t=Math.PI/180,r=this.lat*t,u=e.lat*t,f=Math.sin(r)*Math.sin(u)+Math.cos(r)*Math.cos(u)*Math.cos((e.lng-this.lng)*t);return 63710088e-1*Math.acos(Math.min(f,1))},li.prototype.toBounds=function(e){e===void 0&&(e=0);var t=360*e/40075017,r=t/Math.cos(Math.PI/180*this.lat);return new Fa(new li(this.lng-r,this.lat-t),new li(this.lng+r,this.lat+t))},li.convert=function(e){if(e instanceof li)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new li(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new li(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var lh=2*Math.PI*63710088e-1;function th(e){return lh*Math.cos(e*Math.PI/180)}function Dh(e){return(180+e)/360}function hc(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function rh(e,t){return e/th(t)}function Vh(e){return 360/Math.PI*Math.atan(Math.exp((180-360*e)*Math.PI/180))-90}var ch=function(t,r,u){u===void 0&&(u=0),this.x=+t,this.y=+r,this.z=+u};ch.fromLngLat=function(e,t){t===void 0&&(t=0);var r=li.convert(e);return new ch(Dh(r.lng),hc(r.lat),rh(t,r.lat))},ch.prototype.toLngLat=function(){return new li(360*this.x-180,Vh(this.y))},ch.prototype.toAltitude=function(){return this.z*th(Vh(this.y))},ch.prototype.meterInMercatorCoordinateUnits=function(){return 1/lh*(e=Vh(this.y),1/Math.cos(e*Math.PI/180));var e};var fh=function(t,r,u){this.z=t,this.x=r,this.y=u,this.key=Nh(0,t,t,r,u)};fh.prototype.equals=function(e){return this.z===e.z&&this.x===e.x&&this.y===e.y},fh.prototype.url=function(e,t){var r,u,f,m,S,P=(u=this.y,f=this.z,m=Mf(256*(r=this.x),256*(u=Math.pow(2,f)-u-1),f),S=Mf(256*(r+1),256*(u+1),f),m[0]+","+m[1]+","+S[0]+","+S[1]),V=function(re,he,_e){for(var we,lt="",Lt=re;Lt>0;Lt--)lt+=(he&(we=1<<Lt-1)?1:0)+(_e&we?2:0);return lt}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(t==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",V).replace("{bbox-epsg-3857}",P)},fh.prototype.getTilePoint=function(e){var t=Math.pow(2,this.z);return new ee(8192*(e.x*t-this.x),8192*(e.y*t-this.y))},fh.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var qh=function(t,r){this.wrap=t,this.canonical=r,this.key=Nh(t,r.z,r.z,r.x,r.y)},Zs=function(t,r,u,f,m){this.overscaledZ=t,this.wrap=r,this.canonical=new fh(u,+f,+m),this.key=Nh(r,t,u,f,m)};function Nh(e,t,r,u,f){(e*=2)<0&&(e=-1*e-1);var m=1<<r;return(m*m*e+m*f+u).toString(36)+r.toString(36)+t.toString(36)}Zs.prototype.equals=function(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)},Zs.prototype.scaledTo=function(e){var t=this.canonical.z-e;return e>this.canonical.z?new Zs(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Zs(e,this.wrap,e,this.canonical.x>>t,this.canonical.y>>t)},Zs.prototype.calculateScaledKey=function(e,t){var r=this.canonical.z-e;return e>this.canonical.z?Nh(this.wrap*+t,e,this.canonical.z,this.canonical.x,this.canonical.y):Nh(this.wrap*+t,e,e,this.canonical.x>>r,this.canonical.y>>r)},Zs.prototype.isChildOf=function(e){if(e.wrap!==this.wrap)return!1;var t=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>t&&e.canonical.y===this.canonical.y>>t},Zs.prototype.children=function(e){if(this.overscaledZ>=e)return[new Zs(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var t=this.canonical.z+1,r=2*this.canonical.x,u=2*this.canonical.y;return[new Zs(t,this.wrap,t,r,u),new Zs(t,this.wrap,t,r+1,u),new Zs(t,this.wrap,t,r,u+1),new Zs(t,this.wrap,t,r+1,u+1)]},Zs.prototype.isLessThan=function(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))},Zs.prototype.wrapped=function(){return new Zs(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},Zs.prototype.unwrapTo=function(e){return new Zs(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)},Zs.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},Zs.prototype.toUnwrapped=function(){return new qh(this.wrap,this.canonical)},Zs.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},Zs.prototype.getTilePoint=function(e){return this.canonical.getTilePoint(new ch(e.x-this.wrap,e.y))},Rn("CanonicalTileID",fh),Rn("OverscaledTileID",Zs,{omit:["posMatrix"]});var Vf=function(t,r,u){if(this.uid=t,r.height!==r.width)throw new RangeError("DEM tiles must be square");if(u&&u!=="mapbox"&&u!=="terrarium")return Me('"'+u+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=r.height;var f=this.dim=r.height-2;this.data=new Uint32Array(r.data.buffer),this.encoding=u||"mapbox";for(var m=0;m<f;m++)this.data[this._idx(-1,m)]=this.data[this._idx(0,m)],this.data[this._idx(f,m)]=this.data[this._idx(f-1,m)],this.data[this._idx(m,-1)]=this.data[this._idx(m,0)],this.data[this._idx(m,f)]=this.data[this._idx(m,f-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(f,-1)]=this.data[this._idx(f-1,0)],this.data[this._idx(-1,f)]=this.data[this._idx(0,f-1)],this.data[this._idx(f,f)]=this.data[this._idx(f-1,f-1)]};Vf.prototype.get=function(e,t){var r=new Uint8Array(this.data.buffer),u=4*this._idx(e,t);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(r[u],r[u+1],r[u+2])},Vf.prototype.getUnpackVector=function(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},Vf.prototype._idx=function(e,t){if(e<-1||e>=this.dim+1||t<-1||t>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(t+1)*this.stride+(e+1)},Vf.prototype._unpackMapbox=function(e,t,r){return(256*e*256+256*t+r)/10-1e4},Vf.prototype._unpackTerrarium=function(e,t,r){return 256*e+t+r/256-32768},Vf.prototype.getPixels=function(){return new go({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},Vf.prototype.backfillBorder=function(e,t,r){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");var u=t*this.dim,f=t*this.dim+this.dim,m=r*this.dim,S=r*this.dim+this.dim;switch(t){case-1:u=f-1;break;case 1:f=u+1}switch(r){case-1:m=S-1;break;case 1:S=m+1}for(var P=-t*this.dim,V=-r*this.dim,re=m;re<S;re++)for(var he=u;he<f;he++)this.data[this._idx(he,re)]=e.data[this._idx(he+P,re+V)]},Rn("DEMData",Vf);var Gh=function(t){this._stringToNumber={},this._numberToString=[];for(var r=0;r<t.length;r++){var u=t[r];this._stringToNumber[u]=r,this._numberToString[r]=u}};Gh.prototype.encode=function(e){return this._stringToNumber[e]},Gh.prototype.decode=function(e){return this._numberToString[e]};var Hh=function(t,r,u,f,m){this.type="Feature",this._vectorTileFeature=t,t._z=r,t._x=u,t._y=f,this.properties=t.properties,this.id=m},ed={geometry:{configurable:!0}};ed.geometry.get=function(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},ed.geometry.set=function(e){this._geometry=e},Hh.prototype.toJSON=function(){var e={geometry:this.geometry};for(var t in this)t!=="_geometry"&&t!=="_vectorTileFeature"&&(e[t]=this[t]);return e},Object.defineProperties(Hh.prototype,ed);var Th=function(){this.state={},this.stateChanges={},this.deletedStates={}};Th.prototype.updateState=function(e,t,r){var u=String(t);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][u]=this.stateChanges[e][u]||{},Le(this.stateChanges[e][u],r),this.deletedStates[e]===null)for(var f in this.deletedStates[e]={},this.state[e])f!==u&&(this.deletedStates[e][f]=null);else if(this.deletedStates[e]&&this.deletedStates[e][u]===null)for(var m in this.deletedStates[e][u]={},this.state[e][u])r[m]||(this.deletedStates[e][u][m]=null);else for(var S in r)this.deletedStates[e]&&this.deletedStates[e][u]&&this.deletedStates[e][u][S]===null&&delete this.deletedStates[e][u][S]},Th.prototype.removeFeatureState=function(e,t,r){if(this.deletedStates[e]!==null){var u=String(t);if(this.deletedStates[e]=this.deletedStates[e]||{},r&&t!==void 0)this.deletedStates[e][u]!==null&&(this.deletedStates[e][u]=this.deletedStates[e][u]||{},this.deletedStates[e][u][r]=null);else if(t!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][u])for(r in this.deletedStates[e][u]={},this.stateChanges[e][u])this.deletedStates[e][u][r]=null;else this.deletedStates[e][u]=null;else this.deletedStates[e]=null}},Th.prototype.getState=function(e,t){var r=String(t),u=Le({},(this.state[e]||{})[r],(this.stateChanges[e]||{})[r]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){var f=this.deletedStates[e][t];if(f===null)return{};for(var m in f)delete u[m]}return u},Th.prototype.initializeTileState=function(e,t){e.setFeatureState(this.state,t)},Th.prototype.coalesceChanges=function(e,t){var r={};for(var u in this.stateChanges){this.state[u]=this.state[u]||{};var f={};for(var m in this.stateChanges[u])this.state[u][m]||(this.state[u][m]={}),Le(this.state[u][m],this.stateChanges[u][m]),f[m]=this.state[u][m];r[u]=f}for(var S in this.deletedStates){this.state[S]=this.state[S]||{};var P={};if(this.deletedStates[S]===null)for(var V in this.state[S])P[V]={},this.state[S][V]={};else for(var re in this.deletedStates[S]){if(this.deletedStates[S][re]===null)this.state[S][re]={};else for(var he=0,_e=Object.keys(this.deletedStates[S][re]);he<_e.length;he+=1)delete this.state[S][re][_e[he]];P[re]=this.state[S][re]}r[S]=r[S]||{},Le(r[S],P)}if(this.stateChanges={},this.deletedStates={},Object.keys(r).length!==0)for(var we in e)e[we].setFeatureState(r,t)};var Gf=function(t,r){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new ol(8192,16,0),this.grid3D=new ol(8192,16,0),this.featureIndexArray=new Ee,this.promoteId=r};function td(e,t,r,u,f){return Ie(e,function(m,S){var P=t instanceof xc?t.get(S):null;return P&&P.evaluate?P.evaluate(r,u,f):P})}function rd(e){for(var t=1/0,r=1/0,u=-1/0,f=-1/0,m=0,S=e;m<S.length;m+=1){var P=S[m];t=Math.min(t,P.x),r=Math.min(r,P.y),u=Math.max(u,P.x),f=Math.max(f,P.y)}return{minX:t,minY:r,maxX:u,maxY:f}}function ld(e,t){return t-e}Gf.prototype.insert=function(e,t,r,u,f,m){var S=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(r,u,f);for(var P=m?this.grid3D:this.grid,V=0;V<t.length;V++){for(var re=t[V],he=[1/0,1/0,-1/0,-1/0],_e=0;_e<re.length;_e++){var we=re[_e];he[0]=Math.min(he[0],we.x),he[1]=Math.min(he[1],we.y),he[2]=Math.max(he[2],we.x),he[3]=Math.max(he[3],we.y)}he[0]<8192&&he[1]<8192&&he[2]>=0&&he[3]>=0&&P.insert(S,he[0],he[1],he[2],he[3])}},Gf.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new Co.VectorTile(new je(this.rawTileData)).layers,this.sourceLayerCoder=new Gh(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},Gf.prototype.query=function(e,t,r,u){var f=this;this.loadVTLayers();for(var m=e.params||{},S=8192/e.tileSize/e.scale,P=gc(m.filter),V=e.queryGeometry,re=e.queryPadding*S,he=rd(V),_e=this.grid.query(he.minX-re,he.minY-re,he.maxX+re,he.maxY+re),we=rd(e.cameraQueryGeometry),lt=this.grid3D.query(we.minX-re,we.minY-re,we.maxX+re,we.maxY+re,function(Sr,Fr,Nr,mn){return function(hn,Ln,Qn,Yn,Nn){for(var _a=0,fa=hn;_a<fa.length;_a+=1){var ra=fa[_a];if(Ln<=ra.x&&Qn<=ra.y&&Yn>=ra.x&&Nn>=ra.y)return!0}var Ja=[new ee(Ln,Qn),new ee(Ln,Nn),new ee(Yn,Nn),new ee(Yn,Qn)];if(hn.length>2){for(var Da=0,ji=Ja;Da<ji.length;Da+=1)if(ru(hn,ji[Da]))return!0}for(var va=0;va<hn.length-1;va++)if(Mu(hn[va],hn[va+1],Ja))return!0;return!1}(e.cameraQueryGeometry,Sr-re,Fr-re,Nr+re,mn+re)}),Lt=0,Ct=lt;Lt<Ct.length;Lt+=1)_e.push(Ct[Lt]);_e.sort(ld);for(var $t,Xt={},ir=function(Fr){var Nr=_e[Fr];if(Nr!==$t){$t=Nr;var mn=f.featureIndexArray.get(Nr),hn=null;f.loadMatchingFeature(Xt,mn.bucketIndex,mn.sourceLayerIndex,mn.featureIndex,P,m.layers,m.availableImages,t,r,u,function(Ln,Qn,Yn){return hn||(hn=Ei(Ln)),Qn.queryIntersectsFeature(V,Ln,Yn,hn,f.z,e.transform,S,e.pixelPosMatrix)})}},br=0;br<_e.length;br++)ir(br);return Xt},Gf.prototype.loadMatchingFeature=function(e,t,r,u,f,m,S,P,V,re,he){var _e=this.bucketLayerIDs[t];if(!m||function(hn,Ln){for(var Qn=0;Qn<hn.length;Qn++)if(Ln.indexOf(hn[Qn])>=0)return!0;return!1}(m,_e)){var we=this.sourceLayerCoder.decode(r),lt=this.vtLayers[we].feature(u);if(f.needGeometry){var Lt=Bi(lt,!0);if(!f.filter(new Pa(this.tileID.overscaledZ),Lt,this.tileID.canonical))return}else if(!f.filter(new Pa(this.tileID.overscaledZ),lt))return;for(var Ct=this.getId(lt,we),$t=0;$t<_e.length;$t++){var Xt=_e[$t];if(!(m&&m.indexOf(Xt)<0)){var ir=P[Xt];if(ir){var br={};Ct!==void 0&&re&&(br=re.getState(ir.sourceLayer||"_geojsonTileLayer",Ct));var Sr=Le({},V[Xt]);Sr.paint=td(Sr.paint,ir.paint,lt,br,S),Sr.layout=td(Sr.layout,ir.layout,lt,br,S);var Fr=!he||he(lt,ir,br);if(Fr){var Nr=new Hh(lt,this.z,this.x,this.y,Ct);Nr.layer=Sr;var mn=e[Xt];mn===void 0&&(mn=e[Xt]=[]),mn.push({featureIndex:u,feature:Nr,intersectionZ:Fr})}}}}}},Gf.prototype.lookupSymbolFeatures=function(e,t,r,u,f,m,S,P){var V={};this.loadVTLayers();for(var re=gc(f),he=0,_e=e;he<_e.length;he+=1)this.loadMatchingFeature(V,r,u,_e[he],re,m,S,P,t);return V},Gf.prototype.hasLayer=function(e){for(var t=0,r=this.bucketLayerIDs;t<r.length;t+=1)for(var u=0,f=r[t];u<f.length;u+=1)if(e===f[u])return!0;return!1},Gf.prototype.getId=function(e,t){var r=e.id;return this.promoteId&&typeof(r=e.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[t]])=="boolean"&&(r=Number(r)),r},Rn("FeatureIndex",Gf,{omit:["rawTileData","sourceLayerCoder"]});var bs=function(t,r){this.tileID=t,this.uid=Ye(),this.uses=0,this.tileSize=r,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};bs.prototype.registerFadeDuration=function(e){var t=e+this.timeAdded;t<me.now()||this.fadeEndTime&&t<this.fadeEndTime||(this.fadeEndTime=t)},bs.prototype.wasRequested=function(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"},bs.prototype.loadVectorData=function(e,t,r){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){for(var u in e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(re,he){var _e={};if(!he)return _e;for(var we=function(){var $t=Lt[lt],Xt=$t.layerIds.map(function(Sr){return he.getLayer(Sr)}).filter(Boolean);if(Xt.length!==0){$t.layers=Xt,$t.stateDependentLayerIds&&($t.stateDependentLayers=$t.stateDependentLayerIds.map(function(Sr){return Xt.filter(function(Fr){return Fr.id===Sr})[0]}));for(var ir=0,br=Xt;ir<br.length;ir+=1)_e[br[ir].id]=$t}},lt=0,Lt=re;lt<Lt.length;lt+=1)we();return _e}(e.buckets,t.style),this.hasSymbolBuckets=!1,this.buckets){var f=this.buckets[u];if(f instanceof rr){if(this.hasSymbolBuckets=!0,!r)break;f.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var m in this.buckets){var S=this.buckets[m];if(S instanceof rr&&S.hasRTLText){this.hasRTLText=!0,ls.isLoading()||ls.isLoaded()||jc()!=="deferred"||Ro();break}}for(var P in this.queryPadding=0,this.buckets){var V=this.buckets[P];this.queryPadding=Math.max(this.queryPadding,t.style.getLayer(P).queryRadius(V))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new a},bs.prototype.unloadVectorData=function(){for(var e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},bs.prototype.getBucket=function(e){return this.buckets[e.id]},bs.prototype.upload=function(e){for(var t in this.buckets){var r=this.buckets[t];r.uploadPending()&&r.upload(e)}var u=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Xu(e,this.imageAtlas.image,u.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Xu(e,this.glyphAtlasImage,u.ALPHA),this.glyphAtlasImage=null)},bs.prototype.prepare=function(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)},bs.prototype.queryRenderedFeatures=function(e,t,r,u,f,m,S,P,V,re){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:u,cameraQueryGeometry:f,scale:m,tileSize:this.tileSize,pixelPosMatrix:re,transform:P,params:S,queryPadding:this.queryPadding*V},e,t,r):{}},bs.prototype.querySourceFeatures=function(e,t){var r=this.latestFeatureIndex;if(r&&r.rawTileData){var u=r.loadVTLayers(),f=t?t.sourceLayer:"",m=u._geojsonTileLayer||u[f];if(m)for(var S=gc(t&&t.filter),P=this.tileID.canonical,V=P.z,re=P.x,he=P.y,_e={z:V,x:re,y:he},we=0;we<m.length;we++){var lt=m.feature(we);if(S.needGeometry){var Lt=Bi(lt,!0);if(!S.filter(new Pa(this.tileID.overscaledZ),Lt,this.tileID.canonical))continue}else if(!S.filter(new Pa(this.tileID.overscaledZ),lt))continue;var Ct=r.getId(lt,f),$t=new Hh(lt,V,re,he,Ct);$t.tile=_e,e.push($t)}}},bs.prototype.hasData=function(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"},bs.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},bs.prototype.setExpiryData=function(e){var t=this.expirationTime;if(e.cacheControl){var r=ur(e.cacheControl);r["max-age"]&&(this.expirationTime=Date.now()+1e3*r["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){var u=Date.now(),f=!1;if(this.expirationTime>u)f=!1;else if(t)if(this.expirationTime<t)f=!0;else{var m=this.expirationTime-t;m?this.expirationTime=u+Math.max(m,3e4):f=!0}else f=!0;f?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},bs.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)},bs.prototype.setFeatureState=function(e,t){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(e).length!==0){var r=this.latestFeatureIndex.loadVTLayers();for(var u in this.buckets)if(t.style.hasLayer(u)){var f=this.buckets[u],m=f.layers[0].sourceLayer||"_geojsonTileLayer",S=r[m],P=e[m];if(S&&P&&Object.keys(P).length!==0){f.update(P,S,this.imageAtlas&&this.imageAtlas.patternPositions||{});var V=t&&t.style&&t.style.getLayer(u);V&&(this.queryPadding=Math.max(this.queryPadding,V.queryRadius(f)))}}}},bs.prototype.holdingForFade=function(){return this.symbolFadeHoldUntil!==void 0},bs.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<me.now()},bs.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},bs.prototype.setHoldDuration=function(e){this.symbolFadeHoldUntil=me.now()+e},bs.prototype.setDependencies=function(e,t){for(var r={},u=0,f=t;u<f.length;u+=1)r[f[u]]=!0;this.dependencies[e]=r},bs.prototype.hasDependency=function(e,t){for(var r=0,u=e;r<u.length;r+=1){var f=this.dependencies[u[r]];if(f){for(var m=0,S=t;m<S.length;m+=1)if(f[S[m]])return!0}}return!1};var Hf=Y.performance,cd=function(t){this._marks={start:[t.url,"start"].join("#"),end:[t.url,"end"].join("#"),measure:t.url.toString()},Hf.mark(this._marks.start)};cd.prototype.finish=function(){Hf.mark(this._marks.end);var e=Hf.getEntriesByName(this._marks.measure);return e.length===0&&(Hf.measure(this._marks.measure,this._marks.start,this._marks.end),e=Hf.getEntriesByName(this._marks.measure),Hf.clearMarks(this._marks.start),Hf.clearMarks(this._marks.end),Hf.clearMeasures(this._marks.measure)),e},i.Actor=wl,i.AlphaImage=ks,i.CanonicalTileID=fh,i.CollisionBoxArray=a,i.Color=ha,i.DEMData=Vf,i.DataConstantProperty=Jn,i.DictionaryCoder=Gh,i.EXTENT=8192,i.ErrorEvent=Ot,i.EvaluationParameters=Pa,i.Event=ut,i.Evented=Bt,i.FeatureIndex=Gf,i.FillBucket=Yt,i.FillExtrusionBucket=qa,i.ImageAtlas=Xn,i.ImagePosition=Vr,i.LineBucket=Lu,i.LngLat=li,i.LngLatBounds=Fa,i.MercatorCoordinate=ch,i.ONE_EM=24,i.OverscaledTileID=Zs,i.Point=ee,i.Point$1=ee,i.Properties=vo,i.Protobuf=je,i.RGBAImage=go,i.RequestManager=R,i.RequestPerformance=cd,i.ResourceType=Zr,i.SegmentVector=nt,i.SourceFeatureState=Th,i.StructArrayLayout1ui2=nc,i.StructArrayLayout2f1f2i16=Bu,i.StructArrayLayout2i4=mu,i.StructArrayLayout3ui6=Al,i.StructArrayLayout4i8=cl,i.SymbolBucket=rr,i.Texture=Xu,i.Tile=bs,i.Transitionable=So,i.Uniform1f=an,i.Uniform1i=Cr,i.Uniform2f=Yr,i.Uniform3f=vn,i.Uniform4f=Pn,i.UniformColor=qn,i.UniformMatrix4f=Aa,i.UnwrappedTileID=qh,i.ValidationError=Rt,i.WritingMode=na,i.ZoomHistory=sl,i.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e},i.addDynamicAttributes=De,i.asyncAll=function(e,t,r){if(!e.length)return r(null,[]);var u=e.length,f=new Array(e.length),m=null;e.forEach(function(S,P){t(S,function(V,re){V&&(m=V),f[P]=re,--u==0&&r(m,f)})})},i.bezier=Xe,i.bindAll=wt,i.browser=me,i.cacheEntryPossiblyAdded=function(e){++Ht>Et&&(e.getActor().send("enforceCacheSizeLimit",bt),Ht=0)},i.clamp=Se,i.clearTileCache=function(e){var t=Y.caches.delete("mapbox-tiles");e&&t.catch(e).then(function(){return e()})},i.clipLine=An,i.clone=function(e){var t=new No(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},i.clone$1=Ve,i.clone$2=function(e){var t=new No(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},i.collisionCircleLayout=Bf,i.config=ve,i.create=function(){var e=new No(16);return No!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e},i.create$1=function(){var e=new No(9);return No!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e},i.create$2=function(){var e=new No(4);return No!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e},i.createCommonjsModule=Z,i.createExpression=Jl,i.createLayout=no,i.createStyleLayer=function(e){return e.type==="custom"?new ri(e):new co[e.type](e)},i.cross=function(e,t,r){var u=t[0],f=t[1],m=t[2],S=r[0],P=r[1],V=r[2];return e[0]=f*V-m*P,e[1]=m*S-u*V,e[2]=u*P-f*S,e},i.deepEqual=function e(t,r){if(Array.isArray(t)){if(!Array.isArray(r)||t.length!==r.length)return!1;for(var u=0;u<t.length;u++)if(!e(t[u],r[u]))return!1;return!0}if(typeof t=="object"&&t!==null&&r!==null){if(typeof r!="object")return!1;if(Object.keys(t).length!==Object.keys(r).length)return!1;for(var f in t)if(!e(t[f],r[f]))return!1;return!0}return t===r},i.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},i.dot$1=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},i.ease=be,i.emitValidationErrors=il,i.endsWith=At,i.enforceCacheSizeLimit=function(e){Fe(),qe&&qe.then(function(t){t.keys().then(function(r){for(var u=0;u<r.length-e;u++)t.delete(r[u])})})},i.evaluateSizeForFeature=vs,i.evaluateSizeForZoom=zo,i.evaluateVariableOffset=Q,i.evented=rf,i.extend=Le,i.featureFilter=gc,i.filterObject=Ne,i.fromRotation=function(e,t){var r=Math.sin(t),u=Math.cos(t);return e[0]=u,e[1]=r,e[2]=0,e[3]=-r,e[4]=u,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},i.getAnchorAlignment=Fo,i.getAnchorJustification=We,i.getArrayBuffer=Kn,i.getImage=W,i.getJSON=function(e,t){return $n(Le(e,{type:"json"}),t)},i.getRTLTextPluginStatus=jc,i.getReferrer=Vn,i.getVideo=function(e,t){var r,u,f=Y.document.createElement("video");f.muted=!0,f.onloadstart=function(){t(null,f)};for(var m=0;m<e.length;m++){var S=Y.document.createElement("source");r=e[m],u=void 0,(u=Y.document.createElement("a")).href=r,(u.protocol!==Y.document.location.protocol||u.host!==Y.document.location.host)&&(f.crossOrigin="Anonymous"),S.src=e[m],f.appendChild(S)}return{cancel:function(){}}},i.identity=ko,i.invert=function(e,t){var r=t[0],u=t[1],f=t[2],m=t[3],S=t[4],P=t[5],V=t[6],re=t[7],he=t[8],_e=t[9],we=t[10],lt=t[11],Lt=t[12],Ct=t[13],$t=t[14],Xt=t[15],ir=r*P-u*S,br=r*V-f*S,Sr=r*re-m*S,Fr=u*V-f*P,Nr=u*re-m*P,mn=f*re-m*V,hn=he*Ct-_e*Lt,Ln=he*$t-we*Lt,Qn=he*Xt-lt*Lt,Yn=_e*$t-we*Ct,Nn=_e*Xt-lt*Ct,_a=we*Xt-lt*$t,fa=ir*_a-br*Nn+Sr*Yn+Fr*Qn-Nr*Ln+mn*hn;return fa?(e[0]=(P*_a-V*Nn+re*Yn)*(fa=1/fa),e[1]=(f*Nn-u*_a-m*Yn)*fa,e[2]=(Ct*mn-$t*Nr+Xt*Fr)*fa,e[3]=(we*Nr-_e*mn-lt*Fr)*fa,e[4]=(V*Qn-S*_a-re*Ln)*fa,e[5]=(r*_a-f*Qn+m*Ln)*fa,e[6]=($t*Sr-Lt*mn-Xt*br)*fa,e[7]=(he*mn-we*Sr+lt*br)*fa,e[8]=(S*Nn-P*Qn+re*hn)*fa,e[9]=(u*Qn-r*Nn-m*hn)*fa,e[10]=(Lt*Nr-Ct*Sr+Xt*ir)*fa,e[11]=(_e*Sr-he*Nr-lt*ir)*fa,e[12]=(P*Ln-S*Yn-V*hn)*fa,e[13]=(r*Yn-u*Ln+f*hn)*fa,e[14]=(Ct*br-Lt*Fr-$t*ir)*fa,e[15]=(he*Fr-_e*br+we*ir)*fa,e):null},i.isChar=tn,i.isMapboxURL=q,i.keysDifference=function(e,t){var r=[];for(var u in e)u in t||r.push(u);return r},i.makeRequest=$n,i.mapObject=Ie,i.mercatorXfromLng=Dh,i.mercatorYfromLat=hc,i.mercatorZfromAltitude=rh,i.mul=uo,i.multiply=Ko,i.mvt=Co,i.nextPowerOfTwo=function(e){return e<=1?1:Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},i.normalize=function(e,t){var r=t[0],u=t[1],f=t[2],m=r*r+u*u+f*f;return m>0&&(m=1/Math.sqrt(m)),e[0]=t[0]*m,e[1]=t[1]*m,e[2]=t[2]*m,e},i.number=Gi,i.offscreenCanvasSupported=hr,i.ortho=function(e,t,r,u,f,m,S){var P=1/(t-r),V=1/(u-f),re=1/(m-S);return e[0]=-2*P,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*V,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*re,e[11]=0,e[12]=(t+r)*P,e[13]=(f+u)*V,e[14]=(S+m)*re,e[15]=1,e},i.parseGlyphPBF=function(e){return new je(e).readFields(Ir,[])},i.pbf=je,i.performSymbolLayout=function(e,t,r,u,f,m,S){e.createArrays(),e.tilePixelRatio=8192/(512*e.overscaling),e.compareText={},e.iconsNeedLinear=!1;var P=e.layers[0].layout,V=e.layers[0]._unevaluatedLayout._values,re={};if(e.textSizeData.kind==="composite"){var he=e.textSizeData,_e=he.maxZoom;re.compositeTextSizes=[V["text-size"].possiblyEvaluate(new Pa(he.minZoom),S),V["text-size"].possiblyEvaluate(new Pa(_e),S)]}if(e.iconSizeData.kind==="composite"){var we=e.iconSizeData,lt=we.maxZoom;re.compositeIconSizes=[V["icon-size"].possiblyEvaluate(new Pa(we.minZoom),S),V["icon-size"].possiblyEvaluate(new Pa(lt),S)]}re.layoutTextSize=V["text-size"].possiblyEvaluate(new Pa(e.zoom+1),S),re.layoutIconSize=V["icon-size"].possiblyEvaluate(new Pa(e.zoom+1),S),re.textMaxSize=V["text-size"].possiblyEvaluate(new Pa(18));for(var Lt=24*P.get("text-line-height"),Ct=P.get("text-rotation-alignment")==="map"&&P.get("symbol-placement")!=="point",$t=P.get("text-keep-upright"),Xt=P.get("text-size"),ir=function(){var Nr=Sr[br],mn=P.get("text-font").evaluate(Nr,{},S).join(","),hn=Xt.evaluate(Nr,{},S),Ln=re.layoutTextSize.evaluate(Nr,{},S),Qn=re.layoutIconSize.evaluate(Nr,{},S),Yn={horizontal:{},vertical:void 0},Nn=Nr.text,_a=[0,0];if(Nn){var fa=Nn.toString(),ra=24*P.get("text-letter-spacing").evaluate(Nr,{},S),Ja=function(mi){for(var ii=0,Ji=mi;ii<Ji.length;ii+=1)if(fo=Ji[ii].charCodeAt(0),tn.Arabic(fo)||tn["Arabic Supplement"](fo)||tn["Arabic Extended-A"](fo)||tn["Arabic Presentation Forms-A"](fo)||tn["Arabic Presentation Forms-B"](fo))return!1;var fo;return!0}(fa)?ra:0,Da=P.get("text-anchor").evaluate(Nr,{},S),ji=P.get("text-variable-anchor");if(!ji){var va=P.get("text-radial-offset").evaluate(Nr,{},S);_a=va?Q(Da,[24*va,k]):P.get("text-offset").evaluate(Nr,{},S).map(function(mi){return 24*mi})}var ai=Ct?"center":P.get("text-justify").evaluate(Nr,{},S),Go=P.get("symbol-placement"),bi=Go==="point"?24*P.get("text-max-width").evaluate(Nr,{},S):0,Ho=function(){e.allowVerticalPlacement&&bc(fa)&&(Yn.vertical=jr(Nn,t,r,f,mn,bi,Lt,Da,"left",Ja,_a,na.vertical,!0,Go,Ln,hn))};if(!Ct&&ji){for(var Zo=ai==="auto"?ji.map(function(mi){return We(mi)}):[ai],ns=!1,gu=0;gu<Zo.length;gu++){var as=Zo[gu];if(!Yn.horizontal[as])if(ns)Yn.horizontal[as]=Yn.horizontal[0];else{var Yu=jr(Nn,t,r,f,mn,bi,Lt,"center",as,Ja,_a,na.horizontal,!1,Go,Ln,hn);Yu&&(Yn.horizontal[as]=Yu,ns=Yu.positionedLines.length===1)}}Ho()}else{ai==="auto"&&(ai=We(Da));var su=jr(Nn,t,r,f,mn,bi,Lt,Da,ai,Ja,_a,na.horizontal,!1,Go,Ln,hn);su&&(Yn.horizontal[ai]=su),Ho(),bc(fa)&&Ct&&$t&&(Yn.vertical=jr(Nn,t,r,f,mn,bi,Lt,Da,ai,Ja,_a,na.vertical,!1,Go,Ln,hn))}}var Ku=void 0,uu=!1;if(Nr.icon&&Nr.icon.name){var Ws=u[Nr.icon.name];Ws&&(Ku=function(mi,ii,Ji){var fo=Fo(Ji),yu=ii[0]-mi.displaySize[0]*fo.horizontalAlign,Eo=ii[1]-mi.displaySize[1]*fo.verticalAlign;return{image:mi,top:Eo,bottom:Eo+mi.displaySize[1],left:yu,right:yu+mi.displaySize[0]}}(f[Nr.icon.name],P.get("icon-offset").evaluate(Nr,{},S),P.get("icon-anchor").evaluate(Nr,{},S)),uu=Ws.sdf,e.sdfIcons===void 0?e.sdfIcons=Ws.sdf:e.sdfIcons!==Ws.sdf&&Me("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Ws.pixelRatio!==e.pixelRatio||P.get("icon-rotate").constantOr(1)!==0)&&(e.iconsNeedLinear=!0))}var lu=Pe(Yn.horizontal)||Yn.vertical;e.iconsInText=!!lu&&lu.iconsInText,(lu||Ku)&&function(mi,ii,Ji,fo,yu,Eo,Wo,Ru,di,Zf,Zc){var cf=Eo.textMaxSize.evaluate(ii,{});cf===void 0&&(cf=Wo);var dc,Iu=mi.layers[0].layout,Pf=Iu.get("icon-offset").evaluate(ii,{},Zc),Lf=Pe(Ji.horizontal),Wf=Wo/24,_h=mi.tilePixelRatio*Wf,_f=mi.tilePixelRatio*cf/24,Sh=mi.tilePixelRatio*Ru,Xf=mi.tilePixelRatio*Iu.get("symbol-spacing"),hh=Iu.get("text-padding")*mi.tilePixelRatio,Zh=Iu.get("icon-padding")*mi.tilePixelRatio,kh=Iu.get("text-max-angle")/180*Math.PI,Wh=Iu.get("text-rotation-alignment")==="map"&&Iu.get("symbol-placement")!=="point",dh=Iu.get("icon-rotation-alignment")==="map"&&Iu.get("symbol-placement")!=="point",Ah=Iu.get("symbol-placement"),Xh=Xf/2,ph=Iu.get("icon-text-fit");fo&&ph!=="none"&&(mi.allowVerticalPlacement&&Ji.vertical&&(dc=ei(fo,Ji.vertical,ph,Iu.get("icon-text-fit-padding"),Pf,Wf)),Lf&&(fo=ei(fo,Lf,ph,Iu.get("icon-text-fit-padding"),Pf,Wf)));var Yf=function(fd,Lh){Lh.x<0||Lh.x>=8192||Lh.y<0||Lh.y>=8192||function(xs,Wc,hd,Kf,od,h,_,T,x,A,M,U,ie,de,Be,zt,er,Mr,kr,xn,yn,Fn,Sa,wa,Ri){var oi,si,Qi,Oa,qi,To=xs.addToLineVertexArray(Wc,hd),Xs=0,Xa=0,Ms=0,$o=0,ff=-1,Rh=-1,wc={},bh=jt(""),ah=0,Xc=0;if(T._unevaluatedLayout.getValue("text-radial-offset")===void 0?(ah=(oi=T.layout.get("text-offset").evaluate(yn,{},wa).map(function(_d){return 24*_d}))[0],Xc=oi[1]):(ah=24*T.layout.get("text-radial-offset").evaluate(yn,{},wa),Xc=k),xs.allowVerticalPlacement&&Kf.vertical){var dd=T.layout.get("text-rotate").evaluate(yn,{},wa)+90;Oa=new c(x,Wc,A,M,U,Kf.vertical,ie,de,Be,dd),_&&(qi=new c(x,Wc,A,M,U,_,er,Mr,Be,dd))}if(od){var sd=T.layout.get("icon-rotate").evaluate(yn,{}),pd=T.layout.get("icon-text-fit")!=="none",md=Ra(od,sd,Sa,pd),ud=_?Ra(_,sd,Sa,pd):void 0;Qi=new c(x,Wc,A,M,U,od,er,Mr,!1,sd),Xs=4*md.length;var vd=xs.iconSizeData,Bh=null;vd.kind==="source"?(Bh=[128*T.layout.get("icon-size").evaluate(yn,{})])[0]>32640&&Me(xs.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):vd.kind==="composite"&&((Bh=[128*Fn.compositeIconSizes[0].evaluate(yn,{},wa),128*Fn.compositeIconSizes[1].evaluate(yn,{},wa)])[0]>32640||Bh[1]>32640)&&Me(xs.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),xs.addSymbols(xs.icon,md,Bh,xn,kr,yn,!1,Wc,To.lineStartIndex,To.lineLength,-1,wa),ff=xs.icon.placedSymbolArray.length-1,ud&&(Xa=4*ud.length,xs.addSymbols(xs.icon,ud,Bh,xn,kr,yn,na.vertical,Wc,To.lineStartIndex,To.lineLength,-1,wa),Rh=xs.icon.placedSymbolArray.length-1)}for(var gd in Kf.horizontal){var Qh=Kf.horizontal[gd];if(!si){bh=jt(Qh.text);var ka=T.layout.get("text-rotate").evaluate(yn,{},wa);si=new c(x,Wc,A,M,U,Qh,ie,de,Be,ka)}var Fi=Qh.positionedLines.length===1;if(Ms+=rt(xs,Wc,Qh,h,T,Be,yn,zt,To,Kf.vertical?na.horizontal:na.horizontalOnly,Fi?Object.keys(Kf.horizontal):[gd],wc,ff,Fn,wa),Fi)break}Kf.vertical&&($o+=rt(xs,Wc,Kf.vertical,h,T,Be,yn,zt,To,na.vertical,["vertical"],wc,Rh,Fn,wa));var ci=si?si.boxStartIndex:xs.collisionBoxArray.length,In=si?si.boxEndIndex:xs.collisionBoxArray.length,Oc=Oa?Oa.boxStartIndex:xs.collisionBoxArray.length,Es=Oa?Oa.boxEndIndex:xs.collisionBoxArray.length,Yc=Qi?Qi.boxStartIndex:xs.collisionBoxArray.length,Kc=Qi?Qi.boxEndIndex:xs.collisionBoxArray.length,xh=qi?qi.boxStartIndex:xs.collisionBoxArray.length,yd=qi?qi.boxEndIndex:xs.collisionBoxArray.length,ih=-1,bd=function(xd,Sd){return xd&&xd.circleDiameter?Math.max(xd.circleDiameter,Sd):Sd};ih=bd(si,ih),ih=bd(Oa,ih),ih=bd(Qi,ih);var Td=(ih=bd(qi,ih))>-1?1:0;Td&&(ih*=Ri/24),xs.glyphOffsetArray.length>=rr.MAX_GLYPHS&&Me("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),yn.sortKey!==void 0&&xs.addToSortKeyRanges(xs.symbolInstances.length,yn.sortKey),xs.symbolInstances.emplaceBack(Wc.x,Wc.y,wc.right>=0?wc.right:-1,wc.center>=0?wc.center:-1,wc.left>=0?wc.left:-1,wc.vertical||-1,ff,Rh,bh,ci,In,Oc,Es,Yc,Kc,xh,yd,A,Ms,$o,Xs,Xa,Td,0,ie,ah,Xc,ih)}(mi,Lh,fd,Ji,fo,yu,dc,mi.layers[0],mi.collisionBoxArray,ii.index,ii.sourceLayerIndex,mi.index,_h,hh,Wh,di,Sh,Zh,dh,Pf,ii,Eo,Zf,Zc,Wo)};if(Ah==="line")for(var nh=0,Yh=An(ii.geometry,0,0,8192,8192);nh<Yh.length;nh+=1)for(var jh=Yh[nh],mh=0,Fh=yi(jh,Xf,kh,Ji.vertical||Lf,fo,24,_f,mi.overscaling,8192);mh<Fh.length;mh+=1){var Ch=Fh[mh];Lf&&Qe(mi,Lf.text,Xh,Ch)||Yf(jh,Ch)}else if(Ah==="line-center")for(var vh=0,zh=ii.geometry;vh<zh.length;vh+=1){var Uh=zh[vh];if(Uh.length>1){var wh=ou(Uh,kh,Ji.vertical||Lf,fo,24,_f);wh&&Yf(Uh,wh)}}else if(ii.type==="Polygon")for(var Oh=0,gh=N(ii.geometry,0);Oh<gh.length;Oh+=1){var Mh=gh[Oh],yh=I(Mh,16);Yf(Mh[0],new bo(yh.x,yh.y,0))}else if(ii.type==="LineString")for(var Rf=0,Ph=ii.geometry;Rf<Ph.length;Rf+=1){var Kh=Ph[Rf];Yf(Kh,new bo(Kh[0].x,Kh[0].y,0))}else if(ii.type==="Point")for(var $h=0,nd=ii.geometry;$h<nd.length;$h+=1)for(var ad=0,id=nd[$h];ad<id.length;ad+=1){var Jh=id[ad];Yf([Jh],new bo(Jh.x,Jh.y,0))}}(e,Nr,Yn,Ku,u,re,Ln,Qn,_a,uu,S)},br=0,Sr=e.features;br<Sr.length;br+=1)ir();m&&e.generateCollisionDebugBuffers()},i.perspective=function(e,t,r,u,f){var m,S=1/Math.tan(t/2);return e[0]=S/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=S,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,f!=null&&f!==1/0?(e[10]=(f+u)*(m=1/(u-f)),e[14]=2*f*u*m):(e[10]=-1,e[14]=-2*u),e},i.pick=function(e,t){for(var r={},u=0;u<t.length;u++){var f=t[u];f in e&&(r[f]=e[f])}return r},i.plugin=ls,i.polygonIntersectsPolygon=vu,i.postMapLoadEvent=xt,i.postTurnstileEvent=pr,i.potpack=zr,i.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],i.register=Rn,i.registerForPluginStateChange=function(e){return e({pluginStatus:Vs,pluginURL:Su}),rf.on("pluginStateChange",e),e},i.renderColorRamp=ms,i.rotate=function(e,t,r){var u=t[0],f=t[1],m=t[2],S=t[3],P=Math.sin(r),V=Math.cos(r);return e[0]=u*V+m*P,e[1]=f*V+S*P,e[2]=u*-P+m*V,e[3]=f*-P+S*V,e},i.rotateX=function(e,t,r){var u=Math.sin(r),f=Math.cos(r),m=t[4],S=t[5],P=t[6],V=t[7],re=t[8],he=t[9],_e=t[10],we=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=m*f+re*u,e[5]=S*f+he*u,e[6]=P*f+_e*u,e[7]=V*f+we*u,e[8]=re*f-m*u,e[9]=he*f-S*u,e[10]=_e*f-P*u,e[11]=we*f-V*u,e},i.rotateZ=function(e,t,r){var u=Math.sin(r),f=Math.cos(r),m=t[0],S=t[1],P=t[2],V=t[3],re=t[4],he=t[5],_e=t[6],we=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=m*f+re*u,e[1]=S*f+he*u,e[2]=P*f+_e*u,e[3]=V*f+we*u,e[4]=re*f-m*u,e[5]=he*f-S*u,e[6]=_e*f-P*u,e[7]=we*f-V*u,e},i.scale=function(e,t,r){var u=r[0],f=r[1],m=r[2];return e[0]=t[0]*u,e[1]=t[1]*u,e[2]=t[2]*u,e[3]=t[3]*u,e[4]=t[4]*f,e[5]=t[5]*f,e[6]=t[6]*f,e[7]=t[7]*f,e[8]=t[8]*m,e[9]=t[9]*m,e[10]=t[10]*m,e[11]=t[11]*m,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},i.scale$1=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e},i.scale$2=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e},i.setCacheLimits=function(e,t){bt=e,Et=t},i.setRTLTextPlugin=function(e,t,r){if(r===void 0&&(r=!1),Vs==="deferred"||Vs==="loading"||Vs==="loaded")throw new Error("setRTLTextPlugin cannot be called multiple times.");Su=me.resolveURL(e),Vs="deferred",kc=t,zl(),r||Ro()},i.sphericalToCartesian=function(e){var t=e[0],r=e[1],u=e[2];return r+=90,r*=Math.PI/180,u*=Math.PI/180,{x:t*Math.cos(r)*Math.sin(u),y:t*Math.sin(r)*Math.sin(u),z:t*Math.cos(u)}},i.sqrLen=function(e){var t=e[0],r=e[1];return t*t+r*r},i.styleSpec=Ze,i.sub=function(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e},i.symbolSize=gs,i.transformMat3=function(e,t,r){var u=t[0],f=t[1],m=t[2];return e[0]=u*r[0]+f*r[3]+m*r[6],e[1]=u*r[1]+f*r[4]+m*r[7],e[2]=u*r[2]+f*r[5]+m*r[8],e},i.transformMat4=Ns,i.translate=function(e,t,r){var u,f,m,S,P,V,re,he,_e,we,lt,Lt,Ct=r[0],$t=r[1],Xt=r[2];return t===e?(e[12]=t[0]*Ct+t[4]*$t+t[8]*Xt+t[12],e[13]=t[1]*Ct+t[5]*$t+t[9]*Xt+t[13],e[14]=t[2]*Ct+t[6]*$t+t[10]*Xt+t[14],e[15]=t[3]*Ct+t[7]*$t+t[11]*Xt+t[15]):(f=t[1],m=t[2],S=t[3],P=t[4],V=t[5],re=t[6],he=t[7],_e=t[8],we=t[9],lt=t[10],Lt=t[11],e[0]=u=t[0],e[1]=f,e[2]=m,e[3]=S,e[4]=P,e[5]=V,e[6]=re,e[7]=he,e[8]=_e,e[9]=we,e[10]=lt,e[11]=Lt,e[12]=u*Ct+P*$t+_e*Xt+t[12],e[13]=f*Ct+V*$t+we*Xt+t[13],e[14]=m*Ct+re*$t+lt*Xt+t[14],e[15]=S*Ct+he*$t+Lt*Xt+t[15]),e},i.triggerPluginCompletionEvent=Fl,i.uniqueId=Ye,i.validateCustomStyleLayer=function(e){var t=[],r=e.id;return r===void 0&&t.push({message:"layers."+r+': missing required property "id"'}),e.render===void 0&&t.push({message:"layers."+r+': missing required method "render"'}),e.renderingMode&&e.renderingMode!=="2d"&&e.renderingMode!=="3d"&&t.push({message:"layers."+r+': property "renderingMode" must be either "2d" or "3d"'}),t},i.validateLight=gf,i.validateStyle=al,i.values=function(e){var t=[];for(var r in e)t.push(e[r]);return t},i.vectorTile=Co,i.version="1.13.0",i.warnOnce=Me,i.webpSupported=Ge,i.window=Y,i.wrap=mt}),F(["./shared"],function(i){"use strict";function Z(z){var W=typeof z;if(W==="number"||W==="boolean"||W==="string"||z==null)return JSON.stringify(z);if(Array.isArray(z)){for(var le="[",xe=0,ut=z;xe<ut.length;xe+=1)le+=Z(ut[xe])+",";return le+"]"}for(var Ot=Object.keys(z).sort(),Bt="{",Ze=0;Ze<Ot.length;Ze++)Bt+=JSON.stringify(Ot[Ze])+":"+Z(z[Ot[Ze]])+",";return Bt+"}"}function D(z){for(var W="",le=0,xe=i.refProperties;le<xe.length;le+=1)W+="/"+Z(z[xe[le]]);return W}var J=function(W){this.keyCache={},W&&this.replace(W)};J.prototype.replace=function(z){this._layerConfigs={},this._layers={},this.update(z,[])},J.prototype.update=function(z,W){for(var le=this,xe=0,ut=z;xe<ut.length;xe+=1){var Ot=ut[xe];this._layerConfigs[Ot.id]=Ot;var Bt=this._layers[Ot.id]=i.createStyleLayer(Ot);Bt._featureFilter=i.featureFilter(Bt.filter),this.keyCache[Ot.id]&&delete this.keyCache[Ot.id]}for(var Ze=0,Rt=W;Ze<Rt.length;Ze+=1){var lr=Rt[Ze];delete this.keyCache[lr],delete this._layerConfigs[lr],delete this._layers[lr]}this.familiesBySource={};for(var Ur=0,Gr=function(dn,En){for(var bn={},gn=0;gn<dn.length;gn++){var Mn=En&&En[dn[gn].id]||D(dn[gn]);En&&(En[dn[gn].id]=Mn);var Ga=bn[Mn];Ga||(Ga=bn[Mn]=[]),Ga.push(dn[gn])}var ga=[];for(var Ma in bn)ga.push(bn[Ma]);return ga}(i.values(this._layerConfigs),this.keyCache);Ur<Gr.length;Ur+=1){var cr=Gr[Ur].map(function(dn){return le._layers[dn.id]}),Br=cr[0];if(Br.visibility!=="none"){var wn=Br.source||"",fn=this.familiesBySource[wn];fn||(fn=this.familiesBySource[wn]={});var tr=Br.sourceLayer||"_geojsonTileLayer",rn=fn[tr];rn||(rn=fn[tr]=[]),rn.push(cr)}}};var ee=function(W){var le={},xe=[];for(var ut in W){var Ot=W[ut],Bt=le[ut]={};for(var Ze in Ot){var Rt=Ot[+Ze];if(Rt&&Rt.bitmap.width!==0&&Rt.bitmap.height!==0){var lr={x:0,y:0,w:Rt.bitmap.width+2,h:Rt.bitmap.height+2};xe.push(lr),Bt[Ze]={rect:lr,metrics:Rt.metrics}}}}var Ur=i.potpack(xe),Gr=new i.AlphaImage({width:Ur.w||1,height:Ur.h||1});for(var cr in W){var Br=W[cr];for(var wn in Br){var fn=Br[+wn];if(fn&&fn.bitmap.width!==0&&fn.bitmap.height!==0){var tr=le[cr][wn].rect;i.AlphaImage.copy(fn.bitmap,Gr,{x:0,y:0},{x:tr.x+1,y:tr.y+1},fn.bitmap)}}}this.image=Gr,this.positions=le};i.register("GlyphAtlas",ee);var ce=function(W){this.tileID=new i.OverscaledTileID(W.tileID.overscaledZ,W.tileID.wrap,W.tileID.canonical.z,W.tileID.canonical.x,W.tileID.canonical.y),this.uid=W.uid,this.zoom=W.zoom,this.pixelRatio=W.pixelRatio,this.tileSize=W.tileSize,this.source=W.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=W.showCollisionBoxes,this.collectResourceTiming=!!W.collectResourceTiming,this.returnDependencies=!!W.returnDependencies,this.promoteId=W.promoteId};function Y(z,W,le){for(var xe=new i.EvaluationParameters(W),ut=0,Ot=z;ut<Ot.length;ut+=1)Ot[ut].recalculate(xe,le)}function ze(z,W){var le=i.getArrayBuffer(z.request,function(xe,ut,Ot,Bt){xe?W(xe):ut&&W(null,{vectorTile:new i.vectorTile.VectorTile(new i.pbf(ut)),rawData:ut,cacheControl:Ot,expires:Bt})});return function(){le.cancel(),W()}}ce.prototype.parse=function(z,W,le,xe,ut){var Ot=this;this.status="parsing",this.data=z,this.collisionBoxArray=new i.CollisionBoxArray;var Bt=new i.DictionaryCoder(Object.keys(z.layers).sort()),Ze=new i.FeatureIndex(this.tileID,this.promoteId);Ze.bucketLayerIDs=[];var Rt,lr,Ur,Gr,cr={},Br={featureIndex:Ze,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:le},wn=W.familiesBySource[this.source];for(var fn in wn){var tr=z.layers[fn];if(tr){tr.version===1&&i.warnOnce('Vector tile source "'+this.source+'" layer "'+fn+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var rn=Bt.encode(fn),dn=[],En=0;En<tr.length;En++){var bn=tr.feature(En),gn=Ze.getId(bn,fn);dn.push({feature:bn,id:gn,index:En,sourceLayerIndex:rn})}for(var Mn=0,Ga=wn[fn];Mn<Ga.length;Mn+=1){var ga=Ga[Mn],Ma=ga[0];Ma.minzoom&&this.zoom<Math.floor(Ma.minzoom)||Ma.maxzoom&&this.zoom>=Ma.maxzoom||Ma.visibility!=="none"&&(Y(ga,this.zoom,le),(cr[Ma.id]=Ma.createBucket({index:Ze.bucketLayerIDs.length,layers:ga,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:rn,sourceID:this.source})).populate(dn,Br,this.tileID.canonical),Ze.bucketLayerIDs.push(ga.map(function(ya){return ya.id})))}}}var Ia=i.mapObject(Br.glyphDependencies,function(ya){return Object.keys(ya).map(Number)});Object.keys(Ia).length?xe.send("getGlyphs",{uid:this.uid,stacks:Ia},function(ya,ba){Rt||(Rt=ya,lr=ba,vi.call(Ot))}):lr={};var Wi=Object.keys(Br.iconDependencies);Wi.length?xe.send("getImages",{icons:Wi,source:this.source,tileID:this.tileID,type:"icons"},function(ya,ba){Rt||(Rt=ya,Ur=ba,vi.call(Ot))}):Ur={};var da=Object.keys(Br.patternDependencies);function vi(){if(Rt)return ut(Rt);if(lr&&Ur&&Gr){var ya=new ee(lr),ba=new i.ImageAtlas(Ur,Gr);for(var ha in cr){var wi=cr[ha];wi instanceof i.SymbolBucket?(Y(wi.layers,this.zoom,le),i.performSymbolLayout(wi,lr,ya.positions,Ur,ba.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):wi.hasPattern&&(wi instanceof i.LineBucket||wi instanceof i.FillBucket||wi instanceof i.FillExtrusionBucket)&&(Y(wi.layers,this.zoom,le),wi.addFeatures(Br,this.tileID.canonical,ba.patternPositions))}this.status="done",ut(null,{buckets:i.values(cr).filter(function(is){return!is.isEmpty()}),featureIndex:Ze,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:ya.image,imageAtlas:ba,glyphMap:this.returnDependencies?lr:null,iconMap:this.returnDependencies?Ur:null,glyphPositions:this.returnDependencies?ya.positions:null})}}da.length?xe.send("getImages",{icons:da,source:this.source,tileID:this.tileID,type:"patterns"},function(ya,ba){Rt||(Rt=ya,Gr=ba,vi.call(Ot))}):Gr={},vi.call(this)};var Xe=function(W,le,xe,ut){this.actor=W,this.layerIndex=le,this.availableImages=xe,this.loadVectorData=ut||ze,this.loading={},this.loaded={}};Xe.prototype.loadTile=function(z,W){var le=this,xe=z.uid;this.loading||(this.loading={});var ut=!!(z&&z.request&&z.request.collectResourceTiming)&&new i.RequestPerformance(z.request),Ot=this.loading[xe]=new ce(z);Ot.abort=this.loadVectorData(z,function(Bt,Ze){if(delete le.loading[xe],Bt||!Ze)return Ot.status="done",le.loaded[xe]=Ot,W(Bt);var Rt=Ze.rawData,lr={};Ze.expires&&(lr.expires=Ze.expires),Ze.cacheControl&&(lr.cacheControl=Ze.cacheControl);var Ur={};if(ut){var Gr=ut.finish();Gr&&(Ur.resourceTiming=JSON.parse(JSON.stringify(Gr)))}Ot.vectorTile=Ze.vectorTile,Ot.parse(Ze.vectorTile,le.layerIndex,le.availableImages,le.actor,function(cr,Br){if(cr||!Br)return W(cr);W(null,i.extend({rawTileData:Rt.slice(0)},Br,lr,Ur))}),le.loaded=le.loaded||{},le.loaded[xe]=Ot})},Xe.prototype.reloadTile=function(z,W){var le=this,xe=this.loaded,ut=z.uid,Ot=this;if(xe&&xe[ut]){var Bt=xe[ut];Bt.showCollisionBoxes=z.showCollisionBoxes;var Ze=function(lr,Ur){var Gr=Bt.reloadCallback;Gr&&(delete Bt.reloadCallback,Bt.parse(Bt.vectorTile,Ot.layerIndex,le.availableImages,Ot.actor,Gr)),W(lr,Ur)};Bt.status==="parsing"?Bt.reloadCallback=Ze:Bt.status==="done"&&(Bt.vectorTile?Bt.parse(Bt.vectorTile,this.layerIndex,this.availableImages,this.actor,Ze):Ze())}},Xe.prototype.abortTile=function(z,W){var le=this.loading,xe=z.uid;le&&le[xe]&&le[xe].abort&&(le[xe].abort(),delete le[xe]),W()},Xe.prototype.removeTile=function(z,W){var le=this.loaded,xe=z.uid;le&&le[xe]&&delete le[xe],W()};var be=i.window.ImageBitmap,Se=function(){this.loaded={}};function mt(z,W){if(z.length!==0){Le(z[0],W);for(var le=1;le<z.length;le++)Le(z[le],!W)}}function Le(z,W){for(var le=0,xe=0,ut=z.length,Ot=ut-1;xe<ut;Ot=xe++)le+=(z[xe][0]-z[Ot][0])*(z[Ot][1]+z[xe][1]);le>=0!=!!W&&z.reverse()}Se.prototype.loadTile=function(z,W){var le=z.uid,xe=z.encoding,ut=z.rawImageData,Ot=be&&ut instanceof be?this.getImageData(ut):ut,Bt=new i.DEMData(le,Ot,xe);this.loaded=this.loaded||{},this.loaded[le]=Bt,W(null,Bt)},Se.prototype.getImageData=function(z){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(z.width,z.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=z.width,this.offscreenCanvas.height=z.height,this.offscreenCanvasContext.drawImage(z,0,0,z.width,z.height);var W=this.offscreenCanvasContext.getImageData(-1,-1,z.width+2,z.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new i.RGBAImage({width:W.width,height:W.height},W.data)},Se.prototype.removeTile=function(z){var W=this.loaded,le=z.uid;W&&W[le]&&delete W[le]};var St=i.vectorTile.VectorTileFeature.prototype.toGeoJSON,Ye=function(W){this._feature=W,this.extent=i.EXTENT,this.type=W.type,this.properties=W.tags,"id"in W&&!isNaN(W.id)&&(this.id=parseInt(W.id,10))};Ye.prototype.loadGeometry=function(){if(this._feature.type===1){for(var z=[],W=0,le=this._feature.geometry;W<le.length;W+=1){var xe=le[W];z.push([new i.Point$1(xe[0],xe[1])])}return z}for(var ut=[],Ot=0,Bt=this._feature.geometry;Ot<Bt.length;Ot+=1){for(var Ze=[],Rt=0,lr=Bt[Ot];Rt<lr.length;Rt+=1){var Ur=lr[Rt];Ze.push(new i.Point$1(Ur[0],Ur[1]))}ut.push(Ze)}return ut},Ye.prototype.toGeoJSON=function(z,W,le){return St.call(this,z,W,le)};var dt=function(W){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=i.EXTENT,this.length=W.length,this._features=W};dt.prototype.feature=function(z){return new Ye(this._features[z])};var Je=i.vectorTile.VectorTileFeature,wt=At;function At(z,W){this.options=W||{},this.features=z,this.length=z.length}function Ie(z,W){this.id=typeof z.id=="number"?z.id:void 0,this.type=z.type,this.rawGeometry=z.type===1?[z.geometry]:z.geometry,this.properties=z.tags,this.extent=W||4096}At.prototype.feature=function(z){return new Ie(this.features[z],this.options.extent)},Ie.prototype.loadGeometry=function(){var z=this.rawGeometry;this.geometry=[];for(var W=0;W<z.length;W++){for(var le=z[W],xe=[],ut=0;ut<le.length;ut++)xe.push(new i.Point$1(le[ut][0],le[ut][1]));this.geometry.push(xe)}return this.geometry},Ie.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var z=this.geometry,W=1/0,le=-1/0,xe=1/0,ut=-1/0,Ot=0;Ot<z.length;Ot++)for(var Bt=z[Ot],Ze=0;Ze<Bt.length;Ze++){var Rt=Bt[Ze];W=Math.min(W,Rt.x),le=Math.max(le,Rt.x),xe=Math.min(xe,Rt.y),ut=Math.max(ut,Rt.y)}return[W,xe,le,ut]},Ie.prototype.toGeoJSON=Je.prototype.toGeoJSON;var Ne=ct,Ve=wt;function ct(z){var W=new i.pbf;return function(le,xe){for(var ut in le.layers)xe.writeMessage(3,Me,le.layers[ut])}(z,W),W.finish()}function Me(z,W){var le;W.writeVarintField(15,z.version||1),W.writeStringField(1,z.name||""),W.writeVarintField(5,z.extent||4096);var xe={keys:[],values:[],keycache:{},valuecache:{}};for(le=0;le<z.length;le++)xe.feature=z.feature(le),W.writeMessage(2,ht,xe);var ut=xe.keys;for(le=0;le<ut.length;le++)W.writeStringField(3,ut[le]);var Ot=xe.values;for(le=0;le<Ot.length;le++)W.writeMessage(4,$,Ot[le])}function ht(z,W){var le=z.feature;le.id!==void 0&&W.writeVarintField(1,le.id),W.writeMessage(2,Wt,z),W.writeVarintField(3,le.type),W.writeMessage(4,oe,le)}function Wt(z,W){var le=z.feature,xe=z.keys,ut=z.values,Ot=z.keycache,Bt=z.valuecache;for(var Ze in le.properties){var Rt=Ot[Ze];Rt===void 0&&(xe.push(Ze),Ot[Ze]=Rt=xe.length-1),W.writeVarint(Rt);var lr=le.properties[Ze],Ur=typeof lr;Ur!=="string"&&Ur!=="boolean"&&Ur!=="number"&&(lr=JSON.stringify(lr));var Gr=Ur+":"+lr,cr=Bt[Gr];cr===void 0&&(ut.push(lr),Bt[Gr]=cr=ut.length-1),W.writeVarint(cr)}}function Qt(z,W){return(W<<3)+(7&z)}function ur(z){return z<<1^z>>31}function oe(z,W){for(var le=z.loadGeometry(),xe=z.type,ut=0,Ot=0,Bt=le.length,Ze=0;Ze<Bt;Ze++){var Rt=le[Ze],lr=1;xe===1&&(lr=Rt.length),W.writeVarint(Qt(1,lr));for(var Ur=xe===3?Rt.length-1:Rt.length,Gr=0;Gr<Ur;Gr++){Gr===1&&xe!==1&&W.writeVarint(Qt(2,Ur-1));var cr=Rt[Gr].x-ut,Br=Rt[Gr].y-Ot;W.writeVarint(ur(cr)),W.writeVarint(ur(Br)),ut+=cr,Ot+=Br}xe===3&&W.writeVarint(Qt(7,1))}}function $(z,W){var le=typeof z;le==="string"?W.writeStringField(1,z):le==="boolean"?W.writeBooleanField(7,z):le==="number"&&(z%1!=0?W.writeDoubleField(3,z):z<0?W.writeSVarintField(6,z):W.writeVarintField(5,z))}function H(z,W,le,xe){Ae(z,le,xe),Ae(W,2*le,2*xe),Ae(W,2*le+1,2*xe+1)}function Ae(z,W,le){var xe=z[W];z[W]=z[le],z[le]=xe}function ye(z,W,le,xe){var ut=z-le,Ot=W-xe;return ut*ut+Ot*Ot}Ne.fromVectorTileJs=ct,Ne.fromGeojsonVt=function(z,W){W=W||{};var le={};for(var xe in z)le[xe]=new wt(z[xe].features,W),le[xe].name=xe,le[xe].version=W.version,le[xe].extent=W.extent;return ct({layers:le})},Ne.GeoJSONWrapper=Ve;var Te=function(W){return W[0]},pe=function(W){return W[1]},it=function(W,le,xe,ut,Ot){le===void 0&&(le=Te),xe===void 0&&(xe=pe),ut===void 0&&(ut=64),Ot===void 0&&(Ot=Float64Array),this.nodeSize=ut,this.points=W;for(var Bt=W.length<65536?Uint16Array:Uint32Array,Ze=this.ids=new Bt(W.length),Rt=this.coords=new Ot(2*W.length),lr=0;lr<W.length;lr++)Ze[lr]=lr,Rt[2*lr]=le(W[lr]),Rt[2*lr+1]=xe(W[lr]);!function Ur(Gr,cr,Br,wn,fn,tr){if(!(fn-wn<=Br)){var rn=wn+fn>>1;!function dn(En,bn,gn,Mn,Ga,ga){for(;Ga>Mn;){if(Ga-Mn>600){var Ma=Ga-Mn+1,Ia=gn-Mn+1,Wi=Math.log(Ma),da=.5*Math.exp(2*Wi/3),vi=.5*Math.sqrt(Wi*da*(Ma-da)/Ma)*(Ia-Ma/2<0?-1:1);dn(En,bn,gn,Math.max(Mn,Math.floor(gn-Ia*da/Ma+vi)),Math.min(Ga,Math.floor(gn+(Ma-Ia)*da/Ma+vi)),ga)}var ya=bn[2*gn+ga],ba=Mn,ha=Ga;for(H(En,bn,Mn,gn),bn[2*Ga+ga]>ya&&H(En,bn,Mn,Ga);ba<ha;){for(H(En,bn,ba,ha),ba++,ha--;bn[2*ba+ga]<ya;)ba++;for(;bn[2*ha+ga]>ya;)ha--}bn[2*Mn+ga]===ya?H(En,bn,Mn,ha):H(En,bn,++ha,Ga),ha<=gn&&(Mn=ha+1),gn<=ha&&(Ga=ha-1)}}(Gr,cr,rn,wn,fn,tr%2),Ur(Gr,cr,Br,wn,rn-1,tr+1),Ur(Gr,cr,Br,rn+1,fn,tr+1)}}(Ze,Rt,ut,0,Ze.length-1,0)};it.prototype.range=function(z,W,le,xe){return function(ut,Ot,Bt,Ze,Rt,lr,Ur){for(var Gr,cr,Br=[0,ut.length-1,0],wn=[];Br.length;){var fn=Br.pop(),tr=Br.pop(),rn=Br.pop();if(tr-rn<=Ur)for(var dn=rn;dn<=tr;dn++)cr=Ot[2*dn+1],(Gr=Ot[2*dn])>=Bt&&Gr<=Rt&&cr>=Ze&&cr<=lr&&wn.push(ut[dn]);else{var En=Math.floor((rn+tr)/2);cr=Ot[2*En+1],(Gr=Ot[2*En])>=Bt&&Gr<=Rt&&cr>=Ze&&cr<=lr&&wn.push(ut[En]);var bn=(fn+1)%2;(fn===0?Bt<=Gr:Ze<=cr)&&(Br.push(rn),Br.push(En-1),Br.push(bn)),(fn===0?Rt>=Gr:lr>=cr)&&(Br.push(En+1),Br.push(tr),Br.push(bn))}}return wn}(this.ids,this.coords,z,W,le,xe,this.nodeSize)},it.prototype.within=function(z,W,le){return function(xe,ut,Ot,Bt,Ze,Rt){for(var lr=[0,xe.length-1,0],Ur=[],Gr=Ze*Ze;lr.length;){var cr=lr.pop(),Br=lr.pop(),wn=lr.pop();if(Br-wn<=Rt)for(var fn=wn;fn<=Br;fn++)ye(ut[2*fn],ut[2*fn+1],Ot,Bt)<=Gr&&Ur.push(xe[fn]);else{var tr=Math.floor((wn+Br)/2),rn=ut[2*tr],dn=ut[2*tr+1];ye(rn,dn,Ot,Bt)<=Gr&&Ur.push(xe[tr]);var En=(cr+1)%2;(cr===0?Ot-Ze<=rn:Bt-Ze<=dn)&&(lr.push(wn),lr.push(tr-1),lr.push(En)),(cr===0?Ot+Ze>=rn:Bt+Ze>=dn)&&(lr.push(tr+1),lr.push(Br),lr.push(En))}}return Ur}(this.ids,this.coords,z,W,le,this.nodeSize)};var qt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(W){return W}},Pt=function(W){this.options=C(Object.create(qt),W),this.trees=new Array(this.options.maxZoom+1)};function me(z,W,le,xe,ut){return{x:z,y:W,zoom:1/0,id:le,parentId:-1,numPoints:xe,properties:ut}}function ve(z,W){var le=z.geometry.coordinates,xe=le[1];return{x:Oe(le[0]),y:gt(xe),zoom:1/0,index:W,parentId:-1}}function Ge(z){return{type:"Feature",id:z.id,properties:st(z),geometry:{type:"Point",coordinates:[(xe=z.x,360*(xe-.5)),(W=z.y,le=(180-360*W)*Math.PI/180,360*Math.atan(Math.exp(le))/Math.PI-90)]}};var W,le,xe}function st(z){var W=z.numPoints,le=W>=1e4?Math.round(W/1e3)+"k":W>=1e3?Math.round(W/100)/10+"k":W;return C(C({},z.properties),{cluster:!0,cluster_id:z.id,point_count:W,point_count_abbreviated:le})}function Oe(z){return z/360+.5}function gt(z){var W=Math.sin(z*Math.PI/180),le=.5-.25*Math.log((1+W)/(1-W))/Math.PI;return le<0?0:le>1?1:le}function C(z,W){for(var le in W)z[le]=W[le];return z}function R(z){return z.x}function q(z){return z.y}function fe(z,W,le,xe,ut,Ot){var Bt=ut-le,Ze=Ot-xe;if(Bt!==0||Ze!==0){var Rt=((z-le)*Bt+(W-xe)*Ze)/(Bt*Bt+Ze*Ze);Rt>1?(le=ut,xe=Ot):Rt>0&&(le+=Bt*Rt,xe+=Ze*Rt)}return(Bt=z-le)*Bt+(Ze=W-xe)*Ze}function He(z,W,le,xe){var ut={id:z===void 0?null:z,type:W,geometry:le,tags:xe,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(Ot){var Bt=Ot.geometry,Ze=Ot.type;if(Ze==="Point"||Ze==="MultiPoint"||Ze==="LineString")et(Ot,Bt);else if(Ze==="Polygon"||Ze==="MultiLineString")for(var Rt=0;Rt<Bt.length;Rt++)et(Ot,Bt[Rt]);else if(Ze==="MultiPolygon")for(Rt=0;Rt<Bt.length;Rt++)for(var lr=0;lr<Bt[Rt].length;lr++)et(Ot,Bt[Rt][lr])}(ut),ut}function et(z,W){for(var le=0;le<W.length;le+=3)z.minX=Math.min(z.minX,W[le]),z.minY=Math.min(z.minY,W[le+1]),z.maxX=Math.max(z.maxX,W[le]),z.maxY=Math.max(z.maxY,W[le+1])}function _t(z,W,le,xe){if(W.geometry){var ut=W.geometry.coordinates,Ot=W.geometry.type,Bt=Math.pow(le.tolerance/((1<<le.maxZoom)*le.extent),2),Ze=[],Rt=W.id;if(le.promoteId?Rt=W.properties[le.promoteId]:le.generateId&&(Rt=xe||0),Ot==="Point")ot(ut,Ze);else if(Ot==="MultiPoint")for(var lr=0;lr<ut.length;lr++)ot(ut[lr],Ze);else if(Ot==="LineString")Ut(ut,Ze,Bt,!1);else if(Ot==="MultiLineString"){if(le.lineMetrics){for(lr=0;lr<ut.length;lr++)Ut(ut[lr],Ze=[],Bt,!1),z.push(He(Rt,"LineString",Ze,W.properties));return}K(ut,Ze,Bt,!1)}else if(Ot==="Polygon")K(ut,Ze,Bt,!0);else{if(Ot!=="MultiPolygon"){if(Ot==="GeometryCollection"){for(lr=0;lr<W.geometry.geometries.length;lr++)_t(z,{id:Rt,geometry:W.geometry.geometries[lr],properties:W.properties},le,xe);return}throw new Error("Input data is not a valid GeoJSON object.")}for(lr=0;lr<ut.length;lr++){var Ur=[];K(ut[lr],Ur,Bt,!0),Ze.push(Ur)}}z.push(He(Rt,Ot,Ze,W.properties))}}function ot(z,W){W.push(qe(z[0])),W.push(ae(z[1])),W.push(0)}function Ut(z,W,le,xe){for(var ut,Ot,Bt=0,Ze=0;Ze<z.length;Ze++){var Rt=qe(z[Ze][0]),lr=ae(z[Ze][1]);W.push(Rt),W.push(lr),W.push(0),Ze>0&&(Bt+=xe?(ut*lr-Rt*Ot)/2:Math.sqrt(Math.pow(Rt-ut,2)+Math.pow(lr-Ot,2))),ut=Rt,Ot=lr}var Ur=W.length-3;W[2]=1,function Gr(cr,Br,wn,fn){for(var tr,rn=fn,dn=wn-Br>>1,En=wn-Br,bn=cr[Br],gn=cr[Br+1],Mn=cr[wn],Ga=cr[wn+1],ga=Br+3;ga<wn;ga+=3){var Ma=fe(cr[ga],cr[ga+1],bn,gn,Mn,Ga);if(Ma>rn)tr=ga,rn=Ma;else if(Ma===rn){var Ia=Math.abs(ga-dn);Ia<En&&(tr=ga,En=Ia)}}rn>fn&&(tr-Br>3&&Gr(cr,Br,tr,fn),cr[tr+2]=rn,wn-tr>3&&Gr(cr,tr,wn,fn))}(W,0,Ur,le),W[Ur+2]=1,W.size=Math.abs(Bt),W.start=0,W.end=W.size}function K(z,W,le,xe){for(var ut=0;ut<z.length;ut++){var Ot=[];Ut(z[ut],Ot,le,xe),W.push(Ot)}}function qe(z){return z/360+.5}function ae(z){var W=Math.sin(z*Math.PI/180),le=.5-.25*Math.log((1+W)/(1-W))/Math.PI;return le<0?0:le>1?1:le}function tt(z,W,le,xe,ut,Ot,Bt,Ze){if(xe/=W,Ot>=(le/=W)&&Bt<xe)return z;if(Bt<le||Ot>=xe)return null;for(var Rt=[],lr=0;lr<z.length;lr++){var Ur=z[lr],Gr=Ur.geometry,cr=Ur.type,Br=ut===0?Ur.minX:Ur.minY,wn=ut===0?Ur.maxX:Ur.maxY;if(Br>=le&&wn<xe)Rt.push(Ur);else if(!(wn<le||Br>=xe)){var fn=[];if(cr==="Point"||cr==="MultiPoint")kt(Gr,fn,le,xe,ut);else if(cr==="LineString")pr(Gr,fn,le,xe,ut,!1,Ze.lineMetrics);else if(cr==="MultiLineString")xt(Gr,fn,le,xe,ut,!1);else if(cr==="Polygon")xt(Gr,fn,le,xe,ut,!0);else if(cr==="MultiPolygon")for(var tr=0;tr<Gr.length;tr++){var rn=[];xt(Gr[tr],rn,le,xe,ut,!0),rn.length&&fn.push(rn)}if(fn.length){if(Ze.lineMetrics&&cr==="LineString"){for(tr=0;tr<fn.length;tr++)Rt.push(He(Ur.id,cr,fn[tr],Ur.tags));continue}cr!=="LineString"&&cr!=="MultiLineString"||(fn.length===1?(cr="LineString",fn=fn[0]):cr="MultiLineString"),cr!=="Point"&&cr!=="MultiPoint"||(cr=fn.length===3?"Point":"MultiPoint"),Rt.push(He(Ur.id,cr,fn,Ur.tags))}}}return Rt.length?Rt:null}function kt(z,W,le,xe,ut){for(var Ot=0;Ot<z.length;Ot+=3){var Bt=z[Ot+ut];Bt>=le&&Bt<=xe&&(W.push(z[Ot]),W.push(z[Ot+1]),W.push(z[Ot+2]))}}function pr(z,W,le,xe,ut,Ot,Bt){for(var Ze,Rt,lr=Ke(z),Ur=ut===0?Et:Fe,Gr=z.start,cr=0;cr<z.length-3;cr+=3){var Br=z[cr],wn=z[cr+1],fn=z[cr+2],tr=z[cr+3],rn=z[cr+4],dn=ut===0?Br:wn,En=ut===0?tr:rn,bn=!1;Bt&&(Ze=Math.sqrt(Math.pow(Br-tr,2)+Math.pow(wn-rn,2))),dn<le?En>le&&(Rt=Ur(lr,Br,wn,tr,rn,le),Bt&&(lr.start=Gr+Ze*Rt)):dn>xe?En<xe&&(Rt=Ur(lr,Br,wn,tr,rn,xe),Bt&&(lr.start=Gr+Ze*Rt)):bt(lr,Br,wn,fn),En<le&&dn>=le&&(Rt=Ur(lr,Br,wn,tr,rn,le),bn=!0),En>xe&&dn<=xe&&(Rt=Ur(lr,Br,wn,tr,rn,xe),bn=!0),!Ot&&bn&&(Bt&&(lr.end=Gr+Ze*Rt),W.push(lr),lr=Ke(z)),Bt&&(Gr+=Ze)}var gn=z.length-3;Br=z[gn],wn=z[gn+1],fn=z[gn+2],(dn=ut===0?Br:wn)>=le&&dn<=xe&&bt(lr,Br,wn,fn),gn=lr.length-3,Ot&&gn>=3&&(lr[gn]!==lr[0]||lr[gn+1]!==lr[1])&&bt(lr,lr[0],lr[1],lr[2]),lr.length&&W.push(lr)}function Ke(z){var W=[];return W.size=z.size,W.start=z.start,W.end=z.end,W}function xt(z,W,le,xe,ut,Ot){for(var Bt=0;Bt<z.length;Bt++)pr(z[Bt],W,le,xe,ut,Ot,!1)}function bt(z,W,le,xe){z.push(W),z.push(le),z.push(xe)}function Et(z,W,le,xe,ut,Ot){var Bt=(Ot-W)/(xe-W);return z.push(Ot),z.push(le+(ut-le)*Bt),z.push(1),Bt}function Fe(z,W,le,xe,ut,Ot){var Bt=(Ot-le)/(ut-le);return z.push(W+(xe-W)*Bt),z.push(Ot),z.push(1),Bt}function pt(z,W){for(var le=[],xe=0;xe<z.length;xe++){var ut,Ot=z[xe],Bt=Ot.type;if(Bt==="Point"||Bt==="MultiPoint"||Bt==="LineString")ut=yt(Ot.geometry,W);else if(Bt==="MultiLineString"||Bt==="Polygon"){ut=[];for(var Ze=0;Ze<Ot.geometry.length;Ze++)ut.push(yt(Ot.geometry[Ze],W))}else if(Bt==="MultiPolygon")for(ut=[],Ze=0;Ze<Ot.geometry.length;Ze++){for(var Rt=[],lr=0;lr<Ot.geometry[Ze].length;lr++)Rt.push(yt(Ot.geometry[Ze][lr],W));ut.push(Rt)}le.push(He(Ot.id,Bt,ut,Ot.tags))}return le}function yt(z,W){var le=[];le.size=z.size,z.start!==void 0&&(le.start=z.start,le.end=z.end);for(var xe=0;xe<z.length;xe+=3)le.push(z[xe]+W,z[xe+1],z[xe+2]);return le}function Ht(z,W){if(z.transformed)return z;var le,xe,ut,Ot=1<<z.z,Bt=z.x,Ze=z.y;for(le=0;le<z.features.length;le++){var Rt=z.features[le],lr=Rt.geometry,Ur=Rt.type;if(Rt.geometry=[],Ur===1)for(xe=0;xe<lr.length;xe+=2)Rt.geometry.push(hr(lr[xe],lr[xe+1],W,Ot,Bt,Ze));else for(xe=0;xe<lr.length;xe++){var Gr=[];for(ut=0;ut<lr[xe].length;ut+=2)Gr.push(hr(lr[xe][ut],lr[xe][ut+1],W,Ot,Bt,Ze));Rt.geometry.push(Gr)}}return z.transformed=!0,z}function hr(z,W,le,xe,ut,Ot){return[Math.round(le*(z*xe-ut)),Math.round(le*(W*xe-Ot))]}function Zr(z,W,le,xe,ut){for(var Ot=W===ut.maxZoom?0:ut.tolerance/((1<<W)*ut.extent),Bt={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:le,y:xe,z:W,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Ze=0;Ze<z.length;Ze++){Bt.numFeatures++,yr(Bt,z[Ze],Ot,ut);var Rt=z[Ze].minX,lr=z[Ze].minY,Ur=z[Ze].maxX,Gr=z[Ze].maxY;Rt<Bt.minX&&(Bt.minX=Rt),lr<Bt.minY&&(Bt.minY=lr),Ur>Bt.maxX&&(Bt.maxX=Ur),Gr>Bt.maxY&&(Bt.maxY=Gr)}return Bt}function yr(z,W,le,xe){var ut=W.geometry,Ot=W.type,Bt=[];if(Ot==="Point"||Ot==="MultiPoint")for(var Ze=0;Ze<ut.length;Ze+=3)Bt.push(ut[Ze]),Bt.push(ut[Ze+1]),z.numPoints++,z.numSimplified++;else if(Ot==="LineString")Vn(Bt,ut,z,le,!1,!1);else if(Ot==="MultiLineString"||Ot==="Polygon")for(Ze=0;Ze<ut.length;Ze++)Vn(Bt,ut[Ze],z,le,Ot==="Polygon",Ze===0);else if(Ot==="MultiPolygon")for(var Rt=0;Rt<ut.length;Rt++){var lr=ut[Rt];for(Ze=0;Ze<lr.length;Ze++)Vn(Bt,lr[Ze],z,le,!0,Ze===0)}if(Bt.length){var Ur=W.tags||null;if(Ot==="LineString"&&xe.lineMetrics){for(var Gr in Ur={},W.tags)Ur[Gr]=W.tags[Gr];Ur.mapbox_clip_start=ut.start/ut.size,Ur.mapbox_clip_end=ut.end/ut.size}var cr={geometry:Bt,type:Ot==="Polygon"||Ot==="MultiPolygon"?3:Ot==="LineString"||Ot==="MultiLineString"?2:1,tags:Ur};W.id!==null&&(cr.id=W.id),z.features.push(cr)}}function Vn(z,W,le,xe,ut,Ot){var Bt=xe*xe;if(xe>0&&W.size<(ut?Bt:xe))le.numPoints+=W.length/3;else{for(var Ze=[],Rt=0;Rt<W.length;Rt+=3)(xe===0||W[Rt+2]>Bt)&&(le.numSimplified++,Ze.push(W[Rt]),Ze.push(W[Rt+1])),le.numPoints++;ut&&function(lr,Ur){for(var Gr=0,cr=0,Br=lr.length,wn=Br-2;cr<Br;wn=cr,cr+=2)Gr+=(lr[cr]-lr[wn])*(lr[cr+1]+lr[wn+1]);if(Gr>0===Ur)for(cr=0,Br=lr.length;cr<Br/2;cr+=2){var fn=lr[cr],tr=lr[cr+1];lr[cr]=lr[Br-2-cr],lr[cr+1]=lr[Br-1-cr],lr[Br-2-cr]=fn,lr[Br-1-cr]=tr}}(Ze,Ot),z.push(Ze)}}function zn(z,W){var le=(W=this.options=function(ut,Ot){for(var Bt in Ot)ut[Bt]=Ot[Bt];return ut}(Object.create(this.options),W)).debug;if(le&&console.time("preprocess data"),W.maxZoom<0||W.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(W.promoteId&&W.generateId)throw new Error("promoteId and generateId cannot be used together.");var xe=function(ut,Ot){var Bt=[];if(ut.type==="FeatureCollection")for(var Ze=0;Ze<ut.features.length;Ze++)_t(Bt,ut.features[Ze],Ot,Ze);else _t(Bt,ut.type==="Feature"?ut:{geometry:ut},Ot);return Bt}(z,W);this.tiles={},this.tileCoords=[],le&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",W.indexMaxZoom,W.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(xe=function(ut,Ot){var Bt=Ot.buffer/Ot.extent,Ze=ut,Rt=tt(ut,1,-1-Bt,Bt,0,-1,2,Ot),lr=tt(ut,1,1-Bt,2+Bt,0,-1,2,Ot);return(Rt||lr)&&(Ze=tt(ut,1,-Bt,1+Bt,0,-1,2,Ot)||[],Rt&&(Ze=pt(Rt,1).concat(Ze)),lr&&(Ze=Ze.concat(pt(lr,-1)))),Ze}(xe,W)).length&&this.splitTile(xe,0,0,0),le&&(xe.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function oa(z,W,le){return 32*((1<<z)*le+W)+z}function $n(z,W){var le=z.tileID.canonical;if(!this._geoJSONIndex)return W(null,null);var xe=this._geoJSONIndex.getTile(le.z,le.x,le.y);if(!xe)return W(null,null);var ut=new dt(xe.features),Ot=Ne(ut);Ot.byteOffset===0&&Ot.byteLength===Ot.buffer.byteLength||(Ot=new Uint8Array(Ot)),W(null,{vectorTile:ut,rawData:Ot.buffer})}Pt.prototype.load=function(z){var W=this.options,le=W.log,xe=W.minZoom,ut=W.maxZoom,Ot=W.nodeSize;le&&console.time("total time");var Bt="prepare "+z.length+" points";le&&console.time(Bt),this.points=z;for(var Ze=[],Rt=0;Rt<z.length;Rt++)z[Rt].geometry&&Ze.push(ve(z[Rt],Rt));this.trees[ut+1]=new it(Ze,R,q,Ot,Float32Array),le&&console.timeEnd(Bt);for(var lr=ut;lr>=xe;lr--){var Ur=+Date.now();Ze=this._cluster(Ze,lr),this.trees[lr]=new it(Ze,R,q,Ot,Float32Array),le&&console.log("z%d: %d clusters in %dms",lr,Ze.length,+Date.now()-Ur)}return le&&console.timeEnd("total time"),this},Pt.prototype.getClusters=function(z,W){var le=((z[0]+180)%360+360)%360-180,xe=Math.max(-90,Math.min(90,z[1])),ut=z[2]===180?180:((z[2]+180)%360+360)%360-180,Ot=Math.max(-90,Math.min(90,z[3]));if(z[2]-z[0]>=360)le=-180,ut=180;else if(le>ut){var Bt=this.getClusters([le,xe,180,Ot],W),Ze=this.getClusters([-180,xe,ut,Ot],W);return Bt.concat(Ze)}for(var Rt=this.trees[this._limitZoom(W)],lr=[],Ur=0,Gr=Rt.range(Oe(le),gt(Ot),Oe(ut),gt(xe));Ur<Gr.length;Ur+=1){var cr=Rt.points[Gr[Ur]];lr.push(cr.numPoints?Ge(cr):this.points[cr.index])}return lr},Pt.prototype.getChildren=function(z){var W=this._getOriginId(z),le=this._getOriginZoom(z),xe="No cluster with the specified id.",ut=this.trees[le];if(!ut)throw new Error(xe);var Ot=ut.points[W];if(!Ot)throw new Error(xe);for(var Bt=this.options.radius/(this.options.extent*Math.pow(2,le-1)),Ze=[],Rt=0,lr=ut.within(Ot.x,Ot.y,Bt);Rt<lr.length;Rt+=1){var Ur=ut.points[lr[Rt]];Ur.parentId===z&&Ze.push(Ur.numPoints?Ge(Ur):this.points[Ur.index])}if(Ze.length===0)throw new Error(xe);return Ze},Pt.prototype.getLeaves=function(z,W,le){var xe=[];return this._appendLeaves(xe,z,W=W||10,le=le||0,0),xe},Pt.prototype.getTile=function(z,W,le){var xe=this.trees[this._limitZoom(z)],ut=Math.pow(2,z),Ot=this.options,Bt=Ot.radius/Ot.extent,Ze=(le-Bt)/ut,Rt=(le+1+Bt)/ut,lr={features:[]};return this._addTileFeatures(xe.range((W-Bt)/ut,Ze,(W+1+Bt)/ut,Rt),xe.points,W,le,ut,lr),W===0&&this._addTileFeatures(xe.range(1-Bt/ut,Ze,1,Rt),xe.points,ut,le,ut,lr),W===ut-1&&this._addTileFeatures(xe.range(0,Ze,Bt/ut,Rt),xe.points,-1,le,ut,lr),lr.features.length?lr:null},Pt.prototype.getClusterExpansionZoom=function(z){for(var W=this._getOriginZoom(z)-1;W<=this.options.maxZoom;){var le=this.getChildren(z);if(W++,le.length!==1)break;z=le[0].properties.cluster_id}return W},Pt.prototype._appendLeaves=function(z,W,le,xe,ut){for(var Ot=0,Bt=this.getChildren(W);Ot<Bt.length;Ot+=1){var Ze=Bt[Ot],Rt=Ze.properties;if(Rt&&Rt.cluster?ut+Rt.point_count<=xe?ut+=Rt.point_count:ut=this._appendLeaves(z,Rt.cluster_id,le,xe,ut):ut<xe?ut++:z.push(Ze),z.length===le)break}return ut},Pt.prototype._addTileFeatures=function(z,W,le,xe,ut,Ot){for(var Bt=0,Ze=z;Bt<Ze.length;Bt+=1){var Rt=W[Ze[Bt]],lr=Rt.numPoints,Ur={type:1,geometry:[[Math.round(this.options.extent*(Rt.x*ut-le)),Math.round(this.options.extent*(Rt.y*ut-xe))]],tags:lr?st(Rt):this.points[Rt.index].properties},Gr=void 0;lr?Gr=Rt.id:this.options.generateId?Gr=Rt.index:this.points[Rt.index].id&&(Gr=this.points[Rt.index].id),Gr!==void 0&&(Ur.id=Gr),Ot.features.push(Ur)}},Pt.prototype._limitZoom=function(z){return Math.max(this.options.minZoom,Math.min(+z,this.options.maxZoom+1))},Pt.prototype._cluster=function(z,W){for(var le=[],xe=this.options,ut=xe.reduce,Ot=xe.minPoints,Bt=xe.radius/(xe.extent*Math.pow(2,W)),Ze=0;Ze<z.length;Ze++){var Rt=z[Ze];if(!(Rt.zoom<=W)){Rt.zoom=W;for(var lr=this.trees[W+1],Ur=lr.within(Rt.x,Rt.y,Bt),Gr=Rt.numPoints||1,cr=Gr,Br=0,wn=Ur;Br<wn.length;Br+=1){var fn=lr.points[wn[Br]];fn.zoom>W&&(cr+=fn.numPoints||1)}if(cr>=Ot){for(var tr=Rt.x*Gr,rn=Rt.y*Gr,dn=ut&&Gr>1?this._map(Rt,!0):null,En=(Ze<<5)+(W+1)+this.points.length,bn=0,gn=Ur;bn<gn.length;bn+=1){var Mn=lr.points[gn[bn]];if(!(Mn.zoom<=W)){Mn.zoom=W;var Ga=Mn.numPoints||1;tr+=Mn.x*Ga,rn+=Mn.y*Ga,Mn.parentId=En,ut&&(dn||(dn=this._map(Rt,!0)),ut(dn,this._map(Mn)))}}Rt.parentId=En,le.push(me(tr/cr,rn/cr,En,cr,dn))}else if(le.push(Rt),cr>1)for(var ga=0,Ma=Ur;ga<Ma.length;ga+=1){var Ia=lr.points[Ma[ga]];Ia.zoom<=W||(Ia.zoom=W,le.push(Ia))}}}return le},Pt.prototype._getOriginId=function(z){return z-this.points.length>>5},Pt.prototype._getOriginZoom=function(z){return(z-this.points.length)%32},Pt.prototype._map=function(z,W){if(z.numPoints)return W?C({},z.properties):z.properties;var le=this.points[z.index].properties,xe=this.options.map(le);return W&&xe===le?C({},xe):xe},zn.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},zn.prototype.splitTile=function(z,W,le,xe,ut,Ot,Bt){for(var Ze=[z,W,le,xe],Rt=this.options,lr=Rt.debug;Ze.length;){xe=Ze.pop(),le=Ze.pop(),W=Ze.pop(),z=Ze.pop();var Ur=1<<W,Gr=oa(W,le,xe),cr=this.tiles[Gr];if(!cr&&(lr>1&&console.time("creation"),cr=this.tiles[Gr]=Zr(z,W,le,xe,Rt),this.tileCoords.push({z:W,x:le,y:xe}),lr)){lr>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",W,le,xe,cr.numFeatures,cr.numPoints,cr.numSimplified),console.timeEnd("creation"));var Br="z"+W;this.stats[Br]=(this.stats[Br]||0)+1,this.total++}if(cr.source=z,ut){if(W===Rt.maxZoom||W===ut)continue;var wn=1<<ut-W;if(le!==Math.floor(Ot/wn)||xe!==Math.floor(Bt/wn))continue}else if(W===Rt.indexMaxZoom||cr.numPoints<=Rt.indexMaxPoints)continue;if(cr.source=null,z.length!==0){lr>1&&console.time("clipping");var fn,tr,rn,dn,En,bn,gn=.5*Rt.buffer/Rt.extent,Mn=.5-gn,Ga=.5+gn,ga=1+gn;fn=tr=rn=dn=null,En=tt(z,Ur,le-gn,le+Ga,0,cr.minX,cr.maxX,Rt),bn=tt(z,Ur,le+Mn,le+ga,0,cr.minX,cr.maxX,Rt),z=null,En&&(fn=tt(En,Ur,xe-gn,xe+Ga,1,cr.minY,cr.maxY,Rt),tr=tt(En,Ur,xe+Mn,xe+ga,1,cr.minY,cr.maxY,Rt),En=null),bn&&(rn=tt(bn,Ur,xe-gn,xe+Ga,1,cr.minY,cr.maxY,Rt),dn=tt(bn,Ur,xe+Mn,xe+ga,1,cr.minY,cr.maxY,Rt),bn=null),lr>1&&console.timeEnd("clipping"),Ze.push(fn||[],W+1,2*le,2*xe),Ze.push(tr||[],W+1,2*le,2*xe+1),Ze.push(rn||[],W+1,2*le+1,2*xe),Ze.push(dn||[],W+1,2*le+1,2*xe+1)}}},zn.prototype.getTile=function(z,W,le){var xe=this.options,ut=xe.extent,Ot=xe.debug;if(z<0||z>24)return null;var Bt=1<<z,Ze=oa(z,W=(W%Bt+Bt)%Bt,le);if(this.tiles[Ze])return Ht(this.tiles[Ze],ut);Ot>1&&console.log("drilling down to z%d-%d-%d",z,W,le);for(var Rt,lr=z,Ur=W,Gr=le;!Rt&&lr>0;)lr--,Ur=Math.floor(Ur/2),Gr=Math.floor(Gr/2),Rt=this.tiles[oa(lr,Ur,Gr)];return Rt&&Rt.source?(Ot>1&&console.log("found parent tile z%d-%d-%d",lr,Ur,Gr),Ot>1&&console.time("drilling down"),this.splitTile(Rt.source,lr,Ur,Gr,z,W,le),Ot>1&&console.timeEnd("drilling down"),this.tiles[Ze]?Ht(this.tiles[Ze],ut):null):null};var Kn=function(z){function W(le,xe,ut,Ot){z.call(this,le,xe,ut,$n),Ot&&(this.loadGeoJSON=Ot)}return z&&(W.__proto__=z),(W.prototype=Object.create(z&&z.prototype)).constructor=W,W.prototype.loadData=function(le,xe){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=xe,this._pendingLoadDataParams=le,this._state&&this._state!=="Idle"?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},W.prototype._loadData=function(){var le=this;if(this._pendingCallback&&this._pendingLoadDataParams){var xe=this._pendingCallback,ut=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var Ot=!!(ut&&ut.request&&ut.request.collectResourceTiming)&&new i.RequestPerformance(ut.request);this.loadGeoJSON(ut,function(Bt,Ze){if(Bt||!Ze)return xe(Bt);if(typeof Ze!="object")return xe(new Error("Input data given to '"+ut.source+"' is not a valid GeoJSON object."));!function cr(Br,wn){var fn,tr=Br&&Br.type;if(tr==="FeatureCollection")for(fn=0;fn<Br.features.length;fn++)cr(Br.features[fn],wn);else if(tr==="GeometryCollection")for(fn=0;fn<Br.geometries.length;fn++)cr(Br.geometries[fn],wn);else if(tr==="Feature")cr(Br.geometry,wn);else if(tr==="Polygon")mt(Br.coordinates,wn);else if(tr==="MultiPolygon")for(fn=0;fn<Br.coordinates.length;fn++)mt(Br.coordinates[fn],wn);return Br}(Ze,!0);try{if(ut.filter){var Rt=i.createExpression(ut.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Rt.result==="error")throw new Error(Rt.value.map(function(cr){return cr.key+": "+cr.message}).join(", "));var lr=Ze.features.filter(function(cr){return Rt.value.evaluate({zoom:0},cr)});Ze={type:"FeatureCollection",features:lr}}le._geoJSONIndex=ut.cluster?new Pt(function(cr){var Br=cr.superclusterOptions,wn=cr.clusterProperties;if(!wn||!Br)return Br;for(var fn={},tr={},rn={accumulated:null,zoom:0},dn={properties:null},En=Object.keys(wn),bn=0,gn=En;bn<gn.length;bn+=1){var Mn=gn[bn],Ga=wn[Mn],ga=Ga[0],Ma=i.createExpression(Ga[1]),Ia=i.createExpression(typeof ga=="string"?[ga,["accumulated"],["get",Mn]]:ga);fn[Mn]=Ma.value,tr[Mn]=Ia.value}return Br.map=function(Wi){dn.properties=Wi;for(var da={},vi=0,ya=En;vi<ya.length;vi+=1){var ba=ya[vi];da[ba]=fn[ba].evaluate(rn,dn)}return da},Br.reduce=function(Wi,da){dn.properties=da;for(var vi=0,ya=En;vi<ya.length;vi+=1){var ba=ya[vi];rn.accumulated=Wi[ba],Wi[ba]=tr[ba].evaluate(rn,dn)}},Br}(ut)).load(Ze.features):function(cr,Br){return new zn(cr,Br)}(Ze,ut.geojsonVtOptions)}catch(cr){return xe(cr)}le.loaded={};var Ur={};if(Ot){var Gr=Ot.finish();Gr&&(Ur.resourceTiming={},Ur.resourceTiming[ut.source]=JSON.parse(JSON.stringify(Gr)))}xe(null,Ur)})}},W.prototype.coalesce=function(){this._state==="Coalescing"?this._state="Idle":this._state==="NeedsLoadData"&&(this._state="Coalescing",this._loadData())},W.prototype.reloadTile=function(le,xe){var ut=this.loaded;return ut&&ut[le.uid]?z.prototype.reloadTile.call(this,le,xe):this.loadTile(le,xe)},W.prototype.loadGeoJSON=function(le,xe){if(le.request)i.getJSON(le.request,xe);else{if(typeof le.data!="string")return xe(new Error("Input data given to '"+le.source+"' is not a valid GeoJSON object."));try{return xe(null,JSON.parse(le.data))}catch(ut){return xe(new Error("Input data given to '"+le.source+"' is not a valid GeoJSON object."))}}},W.prototype.removeSource=function(le,xe){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),xe()},W.prototype.getClusterExpansionZoom=function(le,xe){try{xe(null,this._geoJSONIndex.getClusterExpansionZoom(le.clusterId))}catch(ut){xe(ut)}},W.prototype.getClusterChildren=function(le,xe){try{xe(null,this._geoJSONIndex.getChildren(le.clusterId))}catch(ut){xe(ut)}},W.prototype.getClusterLeaves=function(le,xe){try{xe(null,this._geoJSONIndex.getLeaves(le.clusterId,le.limit,le.offset))}catch(ut){xe(ut)}},W}(Xe),Cn=function(W){var le=this;this.self=W,this.actor=new i.Actor(W,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:Xe,geojson:Kn},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(xe,ut){if(le.workerSourceTypes[xe])throw new Error('Worker source with name "'+xe+'" already registered.');le.workerSourceTypes[xe]=ut},this.self.registerRTLTextPlugin=function(xe){if(i.plugin.isParsed())throw new Error("RTL text plugin already registered.");i.plugin.applyArabicShaping=xe.applyArabicShaping,i.plugin.processBidirectionalText=xe.processBidirectionalText,i.plugin.processStyledBidirectionalText=xe.processStyledBidirectionalText}};return Cn.prototype.setReferrer=function(z,W){this.referrer=W},Cn.prototype.setImages=function(z,W,le){for(var xe in this.availableImages[z]=W,this.workerSources[z]){var ut=this.workerSources[z][xe];for(var Ot in ut)ut[Ot].availableImages=W}le()},Cn.prototype.setLayers=function(z,W,le){this.getLayerIndex(z).replace(W),le()},Cn.prototype.updateLayers=function(z,W,le){this.getLayerIndex(z).update(W.layers,W.removedIds),le()},Cn.prototype.loadTile=function(z,W,le){this.getWorkerSource(z,W.type,W.source).loadTile(W,le)},Cn.prototype.loadDEMTile=function(z,W,le){this.getDEMWorkerSource(z,W.source).loadTile(W,le)},Cn.prototype.reloadTile=function(z,W,le){this.getWorkerSource(z,W.type,W.source).reloadTile(W,le)},Cn.prototype.abortTile=function(z,W,le){this.getWorkerSource(z,W.type,W.source).abortTile(W,le)},Cn.prototype.removeTile=function(z,W,le){this.getWorkerSource(z,W.type,W.source).removeTile(W,le)},Cn.prototype.removeDEMTile=function(z,W){this.getDEMWorkerSource(z,W.source).removeTile(W)},Cn.prototype.removeSource=function(z,W,le){if(this.workerSources[z]&&this.workerSources[z][W.type]&&this.workerSources[z][W.type][W.source]){var xe=this.workerSources[z][W.type][W.source];delete this.workerSources[z][W.type][W.source],xe.removeSource!==void 0?xe.removeSource(W,le):le()}},Cn.prototype.loadWorkerSource=function(z,W,le){try{this.self.importScripts(W.url),le()}catch(xe){le(xe.toString())}},Cn.prototype.syncRTLPluginState=function(z,W,le){try{i.plugin.setState(W);var xe=i.plugin.getPluginURL();if(i.plugin.isLoaded()&&!i.plugin.isParsed()&&xe!=null){this.self.importScripts(xe);var ut=i.plugin.isParsed();le(ut?void 0:new Error("RTL Text Plugin failed to import scripts from "+xe),ut)}}catch(Ot){le(Ot.toString())}},Cn.prototype.getAvailableImages=function(z){var W=this.availableImages[z];return W||(W=[]),W},Cn.prototype.getLayerIndex=function(z){var W=this.layerIndexes[z];return W||(W=this.layerIndexes[z]=new J),W},Cn.prototype.getWorkerSource=function(z,W,le){var xe=this;return this.workerSources[z]||(this.workerSources[z]={}),this.workerSources[z][W]||(this.workerSources[z][W]={}),this.workerSources[z][W][le]||(this.workerSources[z][W][le]=new this.workerSourceTypes[W]({send:function(Ot,Bt,Ze){xe.actor.send(Ot,Bt,Ze,z)}},this.getLayerIndex(z),this.getAvailableImages(z))),this.workerSources[z][W][le]},Cn.prototype.getDEMWorkerSource=function(z,W){return this.demWorkerSources[z]||(this.demWorkerSources[z]={}),this.demWorkerSources[z][W]||(this.demWorkerSources[z][W]=new Se),this.demWorkerSources[z][W]},Cn.prototype.enforceCacheSizeLimit=function(z,W){i.enforceCacheSizeLimit(W)},typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope&&(self.worker=new Cn(self)),Cn}),F(["./shared"],function(i){"use strict";var Z=i.createCommonjsModule(function(s){function a(v){return!n(v)}function n(v){return typeof window=="undefined"||typeof document=="undefined"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var L,j,ue=new Blob([""],{type:"text/javascript"}),Ee=URL.createObjectURL(ue);try{j=new Worker(Ee),L=!0}catch($e){L=!1}return j&&j.terminate(),URL.revokeObjectURL(Ee),L}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var L=document.createElement("canvas");L.width=L.height=1;var j=L.getContext("2d");if(!j)return!1;var ue=j.getImageData(0,0,1,1);return ue&&ue.width===L.width}()?(l[O=v&&v.failIfMajorPerformanceCaveat]===void 0&&(l[O]=function(L){var j=function(Ee){var $e=document.createElement("canvas"),nt=Object.create(a.webGLContextAttributes);return nt.failIfMajorPerformanceCaveat=Ee,$e.probablySupportsContext?$e.probablySupportsContext("webgl",nt)||$e.probablySupportsContext("experimental-webgl",nt):$e.supportsContext?$e.supportsContext("webgl",nt)||$e.supportsContext("experimental-webgl",nt):$e.getContext("webgl",nt)||$e.getContext("experimental-webgl",nt)}(L);if(!j)return!1;var ue=j.createShader(j.VERTEX_SHADER);return!(!ue||j.isContextLost())&&(j.shaderSource(ue,"void main() {}"),j.compileShader(ue),j.getShaderParameter(ue,j.COMPILE_STATUS)===!0)}(O)),l[O]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var O}s.exports?s.exports=a:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=a,window.mapboxgl.notSupportedReason=n);var l={};a.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),D={create:function(a,n,l){var v=i.window.document.createElement(a);return n!==void 0&&(v.className=n),l&&l.appendChild(v),v},createNS:function(a,n){return i.window.document.createElementNS(a,n)}},J=i.window.document&&i.window.document.documentElement.style;function ee(s){if(!J)return s[0];for(var a=0;a<s.length;a++)if(s[a]in J)return s[a];return s[0]}var ce,Y=ee(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);D.disableDrag=function(){J&&Y&&(ce=J[Y],J[Y]="none")},D.enableDrag=function(){J&&Y&&(J[Y]=ce)};var ze=ee(["transform","WebkitTransform"]);D.setTransform=function(s,a){s.style[ze]=a};var Xe=!1;try{var be=Object.defineProperty({},"passive",{get:function(){Xe=!0}});i.window.addEventListener("test",be,be),i.window.removeEventListener("test",be,be)}catch(s){Xe=!1}D.addEventListener=function(s,a,n,l){l===void 0&&(l={}),s.addEventListener(a,n,"passive"in l&&Xe?l:l.capture)},D.removeEventListener=function(s,a,n,l){l===void 0&&(l={}),s.removeEventListener(a,n,"passive"in l&&Xe?l:l.capture)};var Se=function s(a){a.preventDefault(),a.stopPropagation(),i.window.removeEventListener("click",s,!0)};function mt(s){var a=s.userImage;return!!(a&&a.render&&a.render())&&(s.data.replace(new Uint8Array(a.data.buffer)),!0)}D.suppressClick=function(){i.window.addEventListener("click",Se,!0),i.window.setTimeout(function(){i.window.removeEventListener("click",Se,!0)},0)},D.mousePos=function(s,a){var n=s.getBoundingClientRect();return new i.Point(a.clientX-n.left-s.clientLeft,a.clientY-n.top-s.clientTop)},D.touchPos=function(s,a){for(var n=s.getBoundingClientRect(),l=[],v=0;v<a.length;v++)l.push(new i.Point(a[v].clientX-n.left-s.clientLeft,a[v].clientY-n.top-s.clientTop));return l},D.mouseButton=function(s){return i.window.InstallTrigger!==void 0&&s.button===2&&s.ctrlKey&&i.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:s.button},D.remove=function(s){s.parentNode&&s.parentNode.removeChild(s)};var Le=function(s){function a(){s.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new i.RGBAImage({width:1,height:1}),this.dirty=!0}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.isLoaded=function(){return this.loaded},a.prototype.setLoaded=function(n){if(this.loaded!==n&&(this.loaded=n,n)){for(var l=0,v=this.requestors;l<v.length;l+=1){var O=v[l];this._notify(O.ids,O.callback)}this.requestors=[]}},a.prototype.getImage=function(n){return this.images[n]},a.prototype.addImage=function(n,l){this._validate(n,l)&&(this.images[n]=l)},a.prototype._validate=function(n,l){var v=!0;return this._validateStretch(l.stretchX,l.data&&l.data.width)||(this.fire(new i.ErrorEvent(new Error('Image "'+n+'" has invalid "stretchX" value'))),v=!1),this._validateStretch(l.stretchY,l.data&&l.data.height)||(this.fire(new i.ErrorEvent(new Error('Image "'+n+'" has invalid "stretchY" value'))),v=!1),this._validateContent(l.content,l)||(this.fire(new i.ErrorEvent(new Error('Image "'+n+'" has invalid "content" value'))),v=!1),v},a.prototype._validateStretch=function(n,l){if(!n)return!0;for(var v=0,O=0,L=n;O<L.length;O+=1){var j=L[O];if(j[0]<v||j[1]<j[0]||l<j[1])return!1;v=j[1]}return!0},a.prototype._validateContent=function(n,l){return!(n&&(n.length!==4||n[0]<0||l.data.width<n[0]||n[1]<0||l.data.height<n[1]||n[2]<0||l.data.width<n[2]||n[3]<0||l.data.height<n[3]||n[2]<n[0]||n[3]<n[1]))},a.prototype.updateImage=function(n,l){l.version=this.images[n].version+1,this.images[n]=l,this.updatedImages[n]=!0},a.prototype.removeImage=function(n){var l=this.images[n];delete this.images[n],delete this.patterns[n],l.userImage&&l.userImage.onRemove&&l.userImage.onRemove()},a.prototype.listImages=function(){return Object.keys(this.images)},a.prototype.getImages=function(n,l){var v=!0;if(!this.isLoaded())for(var O=0,L=n;O<L.length;O+=1)this.images[L[O]]||(v=!1);this.isLoaded()||v?this._notify(n,l):this.requestors.push({ids:n,callback:l})},a.prototype._notify=function(n,l){for(var v={},O=0,L=n;O<L.length;O+=1){var j=L[O];this.images[j]||this.fire(new i.Event("styleimagemissing",{id:j}));var ue=this.images[j];ue?v[j]={data:ue.data.clone(),pixelRatio:ue.pixelRatio,sdf:ue.sdf,version:ue.version,stretchX:ue.stretchX,stretchY:ue.stretchY,content:ue.content,hasRenderCallback:Boolean(ue.userImage&&ue.userImage.render)}:i.warnOnce('Image "'+j+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}l(null,v)},a.prototype.getPixelSize=function(){var n=this.atlasImage;return{width:n.width,height:n.height}},a.prototype.getPattern=function(n){var l=this.patterns[n],v=this.getImage(n);if(!v)return null;if(l&&l.position.version===v.version)return l.position;if(l)l.position.version=v.version;else{var O={w:v.data.width+2,h:v.data.height+2,x:0,y:0},L=new i.ImagePosition(O,v);this.patterns[n]={bin:O,position:L}}return this._updatePatternAtlas(),this.patterns[n].position},a.prototype.bind=function(n){var l=n.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new i.Texture(n,this.atlasImage,l.RGBA),this.atlasTexture.bind(l.LINEAR,l.CLAMP_TO_EDGE)},a.prototype._updatePatternAtlas=function(){var n=[];for(var l in this.patterns)n.push(this.patterns[l].bin);var v=i.potpack(n),O=v.w,L=v.h,j=this.atlasImage;for(var ue in j.resize({width:O||1,height:L||1}),this.patterns){var Ee=this.patterns[ue].bin,$e=Ee.x+1,nt=Ee.y+1,at=this.images[ue].data,Ft=at.width,Nt=at.height;i.RGBAImage.copy(at,j,{x:0,y:0},{x:$e,y:nt},{width:Ft,height:Nt}),i.RGBAImage.copy(at,j,{x:0,y:Nt-1},{x:$e,y:nt-1},{width:Ft,height:1}),i.RGBAImage.copy(at,j,{x:0,y:0},{x:$e,y:nt+Nt},{width:Ft,height:1}),i.RGBAImage.copy(at,j,{x:Ft-1,y:0},{x:$e-1,y:nt},{width:1,height:Nt}),i.RGBAImage.copy(at,j,{x:0,y:0},{x:$e+Ft,y:nt},{width:1,height:Nt})}this.dirty=!0},a.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},a.prototype.dispatchRenderCallbacks=function(n){for(var l=0,v=n;l<v.length;l+=1){var O=v[l];if(!this.callbackDispatchedThisFrame[O]){this.callbackDispatchedThisFrame[O]=!0;var L=this.images[O];mt(L)&&this.updateImage(O,L)}}},a}(i.Evented),St=Je,Ye=Je,dt=1e20;function Je(s,a,n,l,v,O){this.fontSize=s||24,this.buffer=a===void 0?3:a,this.cutoff=l||.25,this.fontFamily=v||"sans-serif",this.fontWeight=O||"normal",this.radius=n||8;var L=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=L,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(L*L),this.gridInner=new Float64Array(L*L),this.f=new Float64Array(L),this.d=new Float64Array(L),this.z=new Float64Array(L+1),this.v=new Int16Array(L),this.middle=Math.round(L/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function wt(s,a,n,l,v,O,L){for(var j=0;j<a;j++){for(var ue=0;ue<n;ue++)l[ue]=s[ue*a+j];for(At(l,v,O,L,n),ue=0;ue<n;ue++)s[ue*a+j]=v[ue]}for(ue=0;ue<n;ue++){for(j=0;j<a;j++)l[j]=s[ue*a+j];for(At(l,v,O,L,a),j=0;j<a;j++)s[ue*a+j]=Math.sqrt(v[j])}}function At(s,a,n,l,v){n[0]=0,l[0]=-dt,l[1]=+dt;for(var O=1,L=0;O<v;O++){for(var j=(s[O]+O*O-(s[n[L]]+n[L]*n[L]))/(2*O-2*n[L]);j<=l[L];)L--,j=(s[O]+O*O-(s[n[L]]+n[L]*n[L]))/(2*O-2*n[L]);n[++L]=O,l[L]=j,l[L+1]=+dt}for(O=0,L=0;O<v;O++){for(;l[L+1]<O;)L++;a[O]=(O-n[L])*(O-n[L])+s[n[L]]}}Je.prototype.draw=function(s){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(s,this.buffer,this.middle);for(var a=this.ctx.getImageData(0,0,this.size,this.size),n=new Uint8ClampedArray(this.size*this.size),l=0;l<this.size*this.size;l++){var v=a.data[4*l+3]/255;this.gridOuter[l]=v===1?0:v===0?dt:Math.pow(Math.max(0,.5-v),2),this.gridInner[l]=v===1?dt:v===0?0:Math.pow(Math.max(0,v-.5),2)}for(wt(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),wt(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),l=0;l<this.size*this.size;l++)n[l]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[l]-this.gridInner[l])/this.radius+this.cutoff))));return n},St.default=Ye;var Ie=function(a,n){this.requestManager=a,this.localIdeographFontFamily=n,this.entries={}};Ie.prototype.setURL=function(s){this.url=s},Ie.prototype.getGlyphs=function(s,a){var n=this,l=[];for(var v in s)for(var O=0,L=s[v];O<L.length;O+=1)l.push({stack:v,id:L[O]});i.asyncAll(l,function(j,ue){var Ee=j.stack,$e=j.id,nt=n.entries[Ee];nt||(nt=n.entries[Ee]={glyphs:{},requests:{},ranges:{}});var at=nt.glyphs[$e];if(at===void 0){if(at=n._tinySDF(nt,Ee,$e))return nt.glyphs[$e]=at,void ue(null,{stack:Ee,id:$e,glyph:at});var Ft=Math.floor($e/256);if(256*Ft>65535)ue(new Error("glyphs > 65535 not supported"));else if(nt.ranges[Ft])ue(null,{stack:Ee,id:$e,glyph:at});else{var Nt=nt.requests[Ft];Nt||(Nt=nt.requests[Ft]=[],Ie.loadGlyphRange(Ee,Ft,n.url,n.requestManager,function(Jt,jt){if(jt){for(var Gt in jt)n._doesCharSupportLocalGlyph(+Gt)||(nt.glyphs[+Gt]=jt[+Gt]);nt.ranges[Ft]=!0}for(var ar=0,nr=Nt;ar<nr.length;ar+=1)(0,nr[ar])(Jt,jt);delete nt.requests[Ft]})),Nt.push(function(Jt,jt){Jt?ue(Jt):jt&&ue(null,{stack:Ee,id:$e,glyph:jt[$e]||null})})}}else ue(null,{stack:Ee,id:$e,glyph:at})},function(j,ue){if(j)a(j);else if(ue){for(var Ee={},$e=0,nt=ue;$e<nt.length;$e+=1){var at=nt[$e],Ft=at.stack,Nt=at.id,Jt=at.glyph;(Ee[Ft]||(Ee[Ft]={}))[Nt]=Jt&&{id:Jt.id,bitmap:Jt.bitmap.clone(),metrics:Jt.metrics}}a(null,Ee)}})},Ie.prototype._doesCharSupportLocalGlyph=function(s){return!!this.localIdeographFontFamily&&(i.isChar["CJK Unified Ideographs"](s)||i.isChar["Hangul Syllables"](s)||i.isChar.Hiragana(s)||i.isChar.Katakana(s))},Ie.prototype._tinySDF=function(s,a,n){var l=this.localIdeographFontFamily;if(l&&this._doesCharSupportLocalGlyph(n)){var v=s.tinySDF;if(!v){var O="400";/bold/i.test(a)?O="900":/medium/i.test(a)?O="500":/light/i.test(a)&&(O="200"),v=s.tinySDF=new Ie.TinySDF(24,3,8,.25,l,O)}return{id:n,bitmap:new i.AlphaImage({width:30,height:30},v.draw(String.fromCharCode(n))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},Ie.loadGlyphRange=function(s,a,n,l,v){var O=256*a,L=O+255,j=l.transformRequest(l.normalizeGlyphsURL(n).replace("{fontstack}",s).replace("{range}",O+"-"+L),i.ResourceType.Glyphs);i.getArrayBuffer(j,function(ue,Ee){if(ue)v(ue);else if(Ee){for(var $e={},nt=0,at=i.parseGlyphPBF(Ee);nt<at.length;nt+=1){var Ft=at[nt];$e[Ft.id]=Ft}v(null,$e)}})},Ie.TinySDF=St;var Ne=function(){this.specification=i.styleSpec.light.position};Ne.prototype.possiblyEvaluate=function(s,a){return i.sphericalToCartesian(s.expression.evaluate(a))},Ne.prototype.interpolate=function(s,a,n){return{x:i.number(s.x,a.x,n),y:i.number(s.y,a.y,n),z:i.number(s.z,a.z,n)}};var Ve=new i.Properties({anchor:new i.DataConstantProperty(i.styleSpec.light.anchor),position:new Ne,color:new i.DataConstantProperty(i.styleSpec.light.color),intensity:new i.DataConstantProperty(i.styleSpec.light.intensity)}),ct=function(s){function a(n){s.call(this),this._transitionable=new i.Transitionable(Ve),this.setLight(n),this._transitioning=this._transitionable.untransitioned()}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getLight=function(){return this._transitionable.serialize()},a.prototype.setLight=function(n,l){if(l===void 0&&(l={}),!this._validate(i.validateLight,n,l))for(var v in n){var O=n[v];i.endsWith(v,"-transition")?this._transitionable.setTransition(v.slice(0,-"-transition".length),O):this._transitionable.setValue(v,O)}},a.prototype.updateTransitions=function(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)},a.prototype.hasTransition=function(){return this._transitioning.hasTransition()},a.prototype.recalculate=function(n){this.properties=this._transitioning.possiblyEvaluate(n)},a.prototype._validate=function(n,l,v){return(!v||v.validate!==!1)&&i.emitValidationErrors(this,n.call(i.validateStyle,i.extend({value:l,style:{glyphs:!0,sprite:!0},styleSpec:i.styleSpec})))},a}(i.Evented),Me=function(a,n){this.width=a,this.height=n,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};Me.prototype.getDash=function(s,a){var n=s.join(",")+String(a);return this.dashEntry[n]||(this.dashEntry[n]=this.addDash(s,a)),this.dashEntry[n]},Me.prototype.getDashRanges=function(s,a,n){var l=[],v=s.length%2==1?-s[s.length-1]*n:0,O=s[0]*n,L=!0;l.push({left:v,right:O,isDash:L,zeroLength:s[0]===0});for(var j=s[0],ue=1;ue<s.length;ue++){var Ee=s[ue];l.push({left:v=j*n,right:O=(j+=Ee)*n,isDash:L=!L,zeroLength:Ee===0})}return l},Me.prototype.addRoundDash=function(s,a,n){for(var l=a/2,v=-n;v<=n;v++)for(var O=this.width*(this.nextRow+n+v),L=0,j=s[L],ue=0;ue<this.width;ue++){ue/j.right>1&&(j=s[++L]);var Ee=Math.abs(ue-j.left),$e=Math.abs(ue-j.right),nt=Math.min(Ee,$e),at=void 0,Ft=v/n*(l+1);if(j.isDash){var Nt=l-Math.abs(Ft);at=Math.sqrt(nt*nt+Nt*Nt)}else at=l-Math.sqrt(nt*nt+Ft*Ft);this.data[O+ue]=Math.max(0,Math.min(255,at+128))}},Me.prototype.addRegularDash=function(s){for(var a=s.length-1;a>=0;--a){var n=s[a],l=s[a+1];n.zeroLength?s.splice(a,1):l&&l.isDash===n.isDash&&(l.left=n.left,s.splice(a,1))}var v=s[0],O=s[s.length-1];v.isDash===O.isDash&&(v.left=O.left-this.width,O.right=v.right+this.width);for(var L=this.width*this.nextRow,j=0,ue=s[j],Ee=0;Ee<this.width;Ee++){Ee/ue.right>1&&(ue=s[++j]);var $e=Math.abs(Ee-ue.left),nt=Math.abs(Ee-ue.right),at=Math.min($e,nt);this.data[L+Ee]=Math.max(0,Math.min(255,(ue.isDash?at:-at)+128))}},Me.prototype.addDash=function(s,a){var n=a?7:0,l=2*n+1;if(this.nextRow+l>this.height)return i.warnOnce("LineAtlas out of space"),null;for(var v=0,O=0;O<s.length;O++)v+=s[O];if(v!==0){var L=this.width/v,j=this.getDashRanges(s,this.width,L);a?this.addRoundDash(j,L,n):this.addRegularDash(j)}var ue={y:(this.nextRow+n+.5)/this.height,height:2*n/this.height,width:v};return this.nextRow+=l,this.dirty=!0,ue},Me.prototype.bind=function(s){var a=s.gl;this.texture?(a.bindTexture(a.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,a.texSubImage2D(a.TEXTURE_2D,0,0,0,this.width,this.height,a.ALPHA,a.UNSIGNED_BYTE,this.data))):(this.texture=a.createTexture(),a.bindTexture(a.TEXTURE_2D,this.texture),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texImage2D(a.TEXTURE_2D,0,a.ALPHA,this.width,this.height,0,a.ALPHA,a.UNSIGNED_BYTE,this.data))};var ht=function s(a,n){this.workerPool=a,this.actors=[],this.currentActor=0,this.id=i.uniqueId();for(var l=this.workerPool.acquire(this.id),v=0;v<l.length;v++){var O=new s.Actor(l[v],n,this.id);O.name="Worker "+v,this.actors.push(O)}};function Wt(s,a,n){var l=function(O,L){if(O)return n(O);if(L){var j=i.pick(i.extend(L,s),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);L.vector_layers&&(j.vectorLayers=L.vector_layers,j.vectorLayerIds=j.vectorLayers.map(function(ue){return ue.id})),j.tiles=a.canonicalizeTileset(j,s.url),n(null,j)}};return s.url?i.getJSON(a.transformRequest(a.normalizeSourceURL(s.url),i.ResourceType.Source),l):i.browser.frame(function(){return l(null,s)})}ht.prototype.broadcast=function(s,a,n){i.asyncAll(this.actors,function(l,v){l.send(s,a,v)},n=n||function(){})},ht.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},ht.prototype.remove=function(){this.actors.forEach(function(s){s.remove()}),this.actors=[],this.workerPool.release(this.id)},ht.Actor=i.Actor;var Qt=function(a,n,l){this.bounds=i.LngLatBounds.convert(this.validateBounds(a)),this.minzoom=n||0,this.maxzoom=l||24};Qt.prototype.validateBounds=function(s){return Array.isArray(s)&&s.length===4?[Math.max(-180,s[0]),Math.max(-90,s[1]),Math.min(180,s[2]),Math.min(90,s[3])]:[-180,-90,180,90]},Qt.prototype.contains=function(s){var a=Math.pow(2,s.z),n=Math.floor(i.mercatorXfromLng(this.bounds.getWest())*a),l=Math.floor(i.mercatorYfromLat(this.bounds.getNorth())*a),v=Math.ceil(i.mercatorXfromLng(this.bounds.getEast())*a),O=Math.ceil(i.mercatorYfromLat(this.bounds.getSouth())*a);return s.x>=n&&s.x<v&&s.y>=l&&s.y<O};var ur=function(s){function a(n,l,v,O){if(s.call(this),this.id=n,this.dispatcher=v,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,i.extend(this,i.pick(l,["url","scheme","tileSize","promoteId"])),this._options=i.extend({type:"vector"},l),this._collectResourceTiming=l.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(O)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.load=function(){var n=this;this._loaded=!1,this.fire(new i.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Wt(this._options,this.map._requestManager,function(l,v){n._tileJSONRequest=null,n._loaded=!0,l?n.fire(new i.ErrorEvent(l)):v&&(i.extend(n,v),v.bounds&&(n.tileBounds=new Qt(v.bounds,n.minzoom,n.maxzoom)),i.postTurnstileEvent(v.tiles,n.map._requestManager._customAccessToken),i.postMapLoadEvent(v.tiles,n.map._getMapId(),n.map._requestManager._skuToken,n.map._requestManager._customAccessToken),n.fire(new i.Event("data",{dataType:"source",sourceDataType:"metadata"})),n.fire(new i.Event("data",{dataType:"source",sourceDataType:"content"})))})},a.prototype.loaded=function(){return this._loaded},a.prototype.hasTile=function(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)},a.prototype.onAdd=function(n){this.map=n,this.load()},a.prototype.setSourceProperty=function(n){this._tileJSONRequest&&this._tileJSONRequest.cancel(),n(),this.map.style.sourceCaches[this.id].clearTiles(),this.load()},a.prototype.setTiles=function(n){var l=this;return this.setSourceProperty(function(){l._options.tiles=n}),this},a.prototype.setUrl=function(n){var l=this;return this.setSourceProperty(function(){l.url=n,l._options.url=n}),this},a.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},a.prototype.serialize=function(){return i.extend({},this._options)},a.prototype.loadTile=function(n,l){var v=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme)),O={request:this.map._requestManager.transformRequest(v,i.ResourceType.Tile),uid:n.uid,tileID:n.tileID,zoom:n.tileID.overscaledZ,tileSize:this.tileSize*n.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:i.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function L(j,ue){return delete n.request,n.aborted?l(null):j&&j.status!==404?l(j):(ue&&ue.resourceTiming&&(n.resourceTiming=ue.resourceTiming),this.map._refreshExpiredTiles&&ue&&n.setExpiryData(ue),n.loadVectorData(ue,this.map.painter),i.cacheEntryPossiblyAdded(this.dispatcher),l(null),void(n.reloadCallback&&(this.loadTile(n,n.reloadCallback),n.reloadCallback=null)))}O.request.collectResourceTiming=this._collectResourceTiming,n.actor&&n.state!=="expired"?n.state==="loading"?n.reloadCallback=l:n.request=n.actor.send("reloadTile",O,L.bind(this)):(n.actor=this.dispatcher.getActor(),n.request=n.actor.send("loadTile",O,L.bind(this)))},a.prototype.abortTile=function(n){n.request&&(n.request.cancel(),delete n.request),n.actor&&n.actor.send("abortTile",{uid:n.uid,type:this.type,source:this.id},void 0)},a.prototype.unloadTile=function(n){n.unloadVectorData(),n.actor&&n.actor.send("removeTile",{uid:n.uid,type:this.type,source:this.id},void 0)},a.prototype.hasTransition=function(){return!1},a}(i.Evented),oe=function(s){function a(n,l,v,O){s.call(this),this.id=n,this.dispatcher=v,this.setEventedParent(O),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=i.extend({type:"raster"},l),i.extend(this,i.pick(l,["url","scheme","tileSize"]))}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.load=function(){var n=this;this._loaded=!1,this.fire(new i.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Wt(this._options,this.map._requestManager,function(l,v){n._tileJSONRequest=null,n._loaded=!0,l?n.fire(new i.ErrorEvent(l)):v&&(i.extend(n,v),v.bounds&&(n.tileBounds=new Qt(v.bounds,n.minzoom,n.maxzoom)),i.postTurnstileEvent(v.tiles),i.postMapLoadEvent(v.tiles,n.map._getMapId(),n.map._requestManager._skuToken),n.fire(new i.Event("data",{dataType:"source",sourceDataType:"metadata"})),n.fire(new i.Event("data",{dataType:"source",sourceDataType:"content"})))})},a.prototype.loaded=function(){return this._loaded},a.prototype.onAdd=function(n){this.map=n,this.load()},a.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},a.prototype.serialize=function(){return i.extend({},this._options)},a.prototype.hasTile=function(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)},a.prototype.loadTile=function(n,l){var v=this,O=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);n.request=i.getImage(this.map._requestManager.transformRequest(O,i.ResourceType.Tile),function(L,j){if(delete n.request,n.aborted)n.state="unloaded",l(null);else if(L)n.state="errored",l(L);else if(j){v.map._refreshExpiredTiles&&n.setExpiryData(j),delete j.cacheControl,delete j.expires;var ue=v.map.painter.context,Ee=ue.gl;n.texture=v.map.painter.getTileTexture(j.width),n.texture?n.texture.update(j,{useMipmap:!0}):(n.texture=new i.Texture(ue,j,Ee.RGBA,{useMipmap:!0}),n.texture.bind(Ee.LINEAR,Ee.CLAMP_TO_EDGE,Ee.LINEAR_MIPMAP_NEAREST),ue.extTextureFilterAnisotropic&&Ee.texParameterf(Ee.TEXTURE_2D,ue.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,ue.extTextureFilterAnisotropicMax)),n.state="loaded",i.cacheEntryPossiblyAdded(v.dispatcher),l(null)}})},a.prototype.abortTile=function(n,l){n.request&&(n.request.cancel(),delete n.request),l()},a.prototype.unloadTile=function(n,l){n.texture&&this.map.painter.saveTileTexture(n.texture),l()},a.prototype.hasTransition=function(){return!1},a}(i.Evented),$=function(s){function a(n,l,v,O){s.call(this,n,l,v,O),this.type="raster-dem",this.maxzoom=22,this._options=i.extend({type:"raster-dem"},l),this.encoding=l.encoding||"mapbox"}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},a.prototype.loadTile=function(n,l){var v=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function O(L,j){L&&(n.state="errored",l(L)),j&&(n.dem=j,n.needsHillshadePrepare=!0,n.state="loaded",l(null))}n.request=i.getImage(this.map._requestManager.transformRequest(v,i.ResourceType.Tile),function(L,j){if(delete n.request,n.aborted)n.state="unloaded",l(null);else if(L)n.state="errored",l(L);else if(j){this.map._refreshExpiredTiles&&n.setExpiryData(j),delete j.cacheControl,delete j.expires;var ue=i.window.ImageBitmap&&j instanceof i.window.ImageBitmap&&i.offscreenCanvasSupported()?j:i.browser.getImageData(j,1),Ee={uid:n.uid,coord:n.tileID,source:this.id,rawImageData:ue,encoding:this.encoding};n.actor&&n.state!=="expired"||(n.actor=this.dispatcher.getActor(),n.actor.send("loadDEMTile",Ee,O.bind(this)))}}.bind(this)),n.neighboringTiles=this._getNeighboringTiles(n.tileID)},a.prototype._getNeighboringTiles=function(n){var l=n.canonical,v=Math.pow(2,l.z),O=(l.x-1+v)%v,L=l.x===0?n.wrap-1:n.wrap,j=(l.x+1+v)%v,ue=l.x+1===v?n.wrap+1:n.wrap,Ee={};return Ee[new i.OverscaledTileID(n.overscaledZ,L,l.z,O,l.y).key]={backfilled:!1},Ee[new i.OverscaledTileID(n.overscaledZ,ue,l.z,j,l.y).key]={backfilled:!1},l.y>0&&(Ee[new i.OverscaledTileID(n.overscaledZ,L,l.z,O,l.y-1).key]={backfilled:!1},Ee[new i.OverscaledTileID(n.overscaledZ,n.wrap,l.z,l.x,l.y-1).key]={backfilled:!1},Ee[new i.OverscaledTileID(n.overscaledZ,ue,l.z,j,l.y-1).key]={backfilled:!1}),l.y+1<v&&(Ee[new i.OverscaledTileID(n.overscaledZ,L,l.z,O,l.y+1).key]={backfilled:!1},Ee[new i.OverscaledTileID(n.overscaledZ,n.wrap,l.z,l.x,l.y+1).key]={backfilled:!1},Ee[new i.OverscaledTileID(n.overscaledZ,ue,l.z,j,l.y+1).key]={backfilled:!1}),Ee},a.prototype.unloadTile=function(n){n.demTexture&&this.map.painter.saveTileTexture(n.demTexture),n.fbo&&(n.fbo.destroy(),delete n.fbo),n.dem&&delete n.dem,delete n.neighboringTiles,n.state="unloaded",n.actor&&n.actor.send("removeDEMTile",{uid:n.uid,source:this.id})},a}(oe),H=function(s){function a(n,l,v,O){s.call(this),this.id=n,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=v.getActor(),this.setEventedParent(O),this._data=l.data,this._options=i.extend({},l),this._collectResourceTiming=l.collectResourceTiming,this._resourceTiming=[],l.maxzoom!==void 0&&(this.maxzoom=l.maxzoom),l.type&&(this.type=l.type),l.attribution&&(this.attribution=l.attribution),this.promoteId=l.promoteId;var L=i.EXTENT/this.tileSize;this.workerOptions=i.extend({source:this.id,cluster:l.cluster||!1,geojsonVtOptions:{buffer:(l.buffer!==void 0?l.buffer:128)*L,tolerance:(l.tolerance!==void 0?l.tolerance:.375)*L,extent:i.EXTENT,maxZoom:this.maxzoom,lineMetrics:l.lineMetrics||!1,generateId:l.generateId||!1},superclusterOptions:{maxZoom:l.clusterMaxZoom!==void 0?Math.min(l.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,l.clusterMinPoints||2),extent:i.EXTENT,radius:(l.clusterRadius||50)*L,log:!1,generateId:l.generateId||!1},clusterProperties:l.clusterProperties,filter:l.filter},l.workerOptions)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.load=function(){var n=this;this.fire(new i.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(l){if(l)n.fire(new i.ErrorEvent(l));else{var v={dataType:"source",sourceDataType:"metadata"};n._collectResourceTiming&&n._resourceTiming&&n._resourceTiming.length>0&&(v.resourceTiming=n._resourceTiming,n._resourceTiming=[]),n.fire(new i.Event("data",v))}})},a.prototype.onAdd=function(n){this.map=n,this.load()},a.prototype.setData=function(n){var l=this;return this._data=n,this.fire(new i.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(v){if(v)l.fire(new i.ErrorEvent(v));else{var O={dataType:"source",sourceDataType:"content"};l._collectResourceTiming&&l._resourceTiming&&l._resourceTiming.length>0&&(O.resourceTiming=l._resourceTiming,l._resourceTiming=[]),l.fire(new i.Event("data",O))}}),this},a.prototype.getClusterExpansionZoom=function(n,l){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:n,source:this.id},l),this},a.prototype.getClusterChildren=function(n,l){return this.actor.send("geojson.getClusterChildren",{clusterId:n,source:this.id},l),this},a.prototype.getClusterLeaves=function(n,l,v,O){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:n,limit:l,offset:v},O),this},a.prototype._updateWorkerData=function(n){var l=this;this._loaded=!1;var v=i.extend({},this.workerOptions),O=this._data;typeof O=="string"?(v.request=this.map._requestManager.transformRequest(i.browser.resolveURL(O),i.ResourceType.Source),v.request.collectResourceTiming=this._collectResourceTiming):v.data=JSON.stringify(O),this.actor.send(this.type+".loadData",v,function(L,j){l._removed||j&&j.abandoned||(l._loaded=!0,j&&j.resourceTiming&&j.resourceTiming[l.id]&&(l._resourceTiming=j.resourceTiming[l.id].slice(0)),l.actor.send(l.type+".coalesce",{source:v.source},null),n(L))})},a.prototype.loaded=function(){return this._loaded},a.prototype.loadTile=function(n,l){var v=this,O=n.actor?"reloadTile":"loadTile";n.actor=this.actor,n.request=this.actor.send(O,{type:this.type,uid:n.uid,tileID:n.tileID,zoom:n.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:i.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function(L,j){return delete n.request,n.unloadVectorData(),n.aborted?l(null):L?l(L):(n.loadVectorData(j,v.map.painter,O==="reloadTile"),l(null))})},a.prototype.abortTile=function(n){n.request&&(n.request.cancel(),delete n.request),n.aborted=!0},a.prototype.unloadTile=function(n){n.unloadVectorData(),this.actor.send("removeTile",{uid:n.uid,type:this.type,source:this.id})},a.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},a.prototype.serialize=function(){return i.extend({},this._options,{type:this.type,data:this._data})},a.prototype.hasTransition=function(){return!1},a}(i.Evented),Ae=i.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),ye=function(s){function a(n,l,v,O){s.call(this),this.id=n,this.dispatcher=v,this.coordinates=l.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(O),this.options=l}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.load=function(n,l){var v=this;this._loaded=!1,this.fire(new i.Event("dataloading",{dataType:"source"})),this.url=this.options.url,i.getImage(this.map._requestManager.transformRequest(this.url,i.ResourceType.Image),function(O,L){v._loaded=!0,O?v.fire(new i.ErrorEvent(O)):L&&(v.image=L,n&&(v.coordinates=n),l&&l(),v._finishLoading())})},a.prototype.loaded=function(){return this._loaded},a.prototype.updateImage=function(n){var l=this;return this.image&&n.url?(this.options.url=n.url,this.load(n.coordinates,function(){l.texture=null}),this):this},a.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new i.Event("data",{dataType:"source",sourceDataType:"metadata"})))},a.prototype.onAdd=function(n){this.map=n,this.load()},a.prototype.setCoordinates=function(n){var l=this;this.coordinates=n;var v=n.map(i.MercatorCoordinate.fromLngLat);this.tileID=function(L){for(var j=1/0,ue=1/0,Ee=-1/0,$e=-1/0,nt=0,at=L;nt<at.length;nt+=1){var Ft=at[nt];j=Math.min(j,Ft.x),ue=Math.min(ue,Ft.y),Ee=Math.max(Ee,Ft.x),$e=Math.max($e,Ft.y)}var Nt=Math.max(Ee-j,$e-ue),Jt=Math.max(0,Math.floor(-Math.log(Nt)/Math.LN2)),jt=Math.pow(2,Jt);return new i.CanonicalTileID(Jt,Math.floor((j+Ee)/2*jt),Math.floor((ue+$e)/2*jt))}(v),this.minzoom=this.maxzoom=this.tileID.z;var O=v.map(function(L){return l.tileID.getTilePoint(L)._round()});return this._boundsArray=new i.StructArrayLayout4i8,this._boundsArray.emplaceBack(O[0].x,O[0].y,0,0),this._boundsArray.emplaceBack(O[1].x,O[1].y,i.EXTENT,0),this._boundsArray.emplaceBack(O[3].x,O[3].y,0,i.EXTENT),this._boundsArray.emplaceBack(O[2].x,O[2].y,i.EXTENT,i.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new i.Event("data",{dataType:"source",sourceDataType:"content"})),this},a.prototype.prepare=function(){if(Object.keys(this.tiles).length!==0&&this.image){var n=this.map.painter.context,l=n.gl;for(var v in this.boundsBuffer||(this.boundsBuffer=n.createVertexBuffer(this._boundsArray,Ae.members)),this.boundsSegments||(this.boundsSegments=i.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new i.Texture(n,this.image,l.RGBA),this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE)),this.tiles){var O=this.tiles[v];O.state!=="loaded"&&(O.state="loaded",O.texture=this.texture)}}},a.prototype.loadTile=function(n,l){this.tileID&&this.tileID.equals(n.tileID.canonical)?(this.tiles[String(n.tileID.wrap)]=n,n.buckets={},l(null)):(n.state="errored",l(null))},a.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},a.prototype.hasTransition=function(){return!1},a}(i.Evented),Te=function(s){function a(n,l,v,O){s.call(this,n,l,v,O),this.roundZoom=!0,this.type="video",this.options=l}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.load=function(){var n=this;this._loaded=!1;var l=this.options;this.urls=[];for(var v=0,O=l.urls;v<O.length;v+=1)this.urls.push(this.map._requestManager.transformRequest(O[v],i.ResourceType.Source).url);i.getVideo(this.urls,function(L,j){n._loaded=!0,L?n.fire(new i.ErrorEvent(L)):j&&(n.video=j,n.video.loop=!0,n.video.addEventListener("playing",function(){n.map.triggerRepaint()}),n.map&&n.video.play(),n._finishLoading())})},a.prototype.pause=function(){this.video&&this.video.pause()},a.prototype.play=function(){this.video&&this.video.play()},a.prototype.seek=function(n){if(this.video){var l=this.video.seekable;n<l.start(0)||n>l.end(0)?this.fire(new i.ErrorEvent(new i.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+l.start(0)+" and "+l.end(0)+"-second mark."))):this.video.currentTime=n}},a.prototype.getVideo=function(){return this.video},a.prototype.onAdd=function(n){this.map||(this.map=n,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},a.prototype.prepare=function(){if(!(Object.keys(this.tiles).length===0||this.video.readyState<2)){var n=this.map.painter.context,l=n.gl;for(var v in this.boundsBuffer||(this.boundsBuffer=n.createVertexBuffer(this._boundsArray,Ae.members)),this.boundsSegments||(this.boundsSegments=i.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE),l.texSubImage2D(l.TEXTURE_2D,0,0,0,l.RGBA,l.UNSIGNED_BYTE,this.video)):(this.texture=new i.Texture(n,this.video,l.RGBA),this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE)),this.tiles){var O=this.tiles[v];O.state!=="loaded"&&(O.state="loaded",O.texture=this.texture)}}},a.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},a.prototype.hasTransition=function(){return this.video&&!this.video.paused},a}(ye),pe=function(s){function a(n,l,v,O){s.call(this,n,l,v,O),l.coordinates?Array.isArray(l.coordinates)&&l.coordinates.length===4&&!l.coordinates.some(function(L){return!Array.isArray(L)||L.length!==2||L.some(function(j){return typeof j!="number"})})||this.fire(new i.ErrorEvent(new i.ValidationError("sources."+n,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new i.ErrorEvent(new i.ValidationError("sources."+n,null,'missing required property "coordinates"'))),l.animate&&typeof l.animate!="boolean"&&this.fire(new i.ErrorEvent(new i.ValidationError("sources."+n,null,'optional "animate" property must be a boolean value'))),l.canvas?typeof l.canvas=="string"||l.canvas instanceof i.window.HTMLCanvasElement||this.fire(new i.ErrorEvent(new i.ValidationError("sources."+n,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new i.ErrorEvent(new i.ValidationError("sources."+n,null,'missing required property "canvas"'))),this.options=l,this.animate=l.animate===void 0||l.animate}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof i.window.HTMLCanvasElement?this.options.canvas:i.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new i.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},a.prototype.getCanvas=function(){return this.canvas},a.prototype.onAdd=function(n){this.map=n,this.load(),this.canvas&&this.animate&&this.play()},a.prototype.onRemove=function(){this.pause()},a.prototype.prepare=function(){var n=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,n=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,n=!0),!this._hasInvalidDimensions()&&Object.keys(this.tiles).length!==0){var l=this.map.painter.context,v=l.gl;for(var O in this.boundsBuffer||(this.boundsBuffer=l.createVertexBuffer(this._boundsArray,Ae.members)),this.boundsSegments||(this.boundsSegments=i.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(n||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new i.Texture(l,this.canvas,v.RGBA,{premultiply:!0}),this.tiles){var L=this.tiles[O];L.state!=="loaded"&&(L.state="loaded",L.texture=this.texture)}}},a.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},a.prototype.hasTransition=function(){return this._playing},a.prototype._hasInvalidDimensions=function(){for(var n=0,l=[this.canvas.width,this.canvas.height];n<l.length;n+=1){var v=l[n];if(isNaN(v)||v<=0)return!0}return!1},a}(ye),it={vector:ur,raster:oe,"raster-dem":$,geojson:H,video:Te,image:ye,canvas:pe};function qt(s,a){var n=i.identity([]);return i.translate(n,n,[1,1,0]),i.scale(n,n,[.5*s.width,.5*s.height,1]),i.multiply(n,n,s.calculatePosMatrix(a.toUnwrapped()))}function Pt(s,a,n,l,v,O){var L=function(Jt,jt,Gt){if(Jt)for(var ar=0,nr=Jt;ar<nr.length;ar+=1){var Rr=jt[nr[ar]];if(Rr&&Rr.source===Gt&&Rr.type==="fill-extrusion")return!0}else for(var gr in jt){var Ar=jt[gr];if(Ar.source===Gt&&Ar.type==="fill-extrusion")return!0}return!1}(v&&v.layers,a,s.id),j=O.maxPitchScaleFactor(),ue=s.tilesIn(l,j,L);ue.sort(me);for(var Ee=[],$e=0,nt=ue;$e<nt.length;$e+=1){var at=nt[$e];Ee.push({wrappedTileID:at.tileID.wrapped().key,queryResults:at.tile.queryRenderedFeatures(a,n,s._state,at.queryGeometry,at.cameraQueryGeometry,at.scale,v,O,j,qt(s.transform,at.tileID))})}var Ft=function(Jt){for(var jt={},Gt={},ar=0,nr=Jt;ar<nr.length;ar+=1){var Rr=nr[ar],gr=Rr.queryResults,Ar=Rr.wrappedTileID,Cr=Gt[Ar]=Gt[Ar]||{};for(var an in gr)for(var Yr=gr[an],vn=Cr[an]=Cr[an]||{},Pn=jt[an]=jt[an]||[],qn=0,sa=Yr;qn<sa.length;qn+=1){var Aa=sa[qn];vn[Aa.featureIndex]||(vn[Aa.featureIndex]=!0,Pn.push(Aa))}}return jt}(Ee);for(var Nt in Ft)Ft[Nt].forEach(function(Jt){var jt=Jt.feature,Gt=s.getFeatureState(jt.layer["source-layer"],jt.id);jt.source=jt.layer.source,jt.layer["source-layer"]&&(jt.sourceLayer=jt.layer["source-layer"]),jt.state=Gt});return Ft}function me(s,a){var n=s.tileID,l=a.tileID;return n.overscaledZ-l.overscaledZ||n.canonical.y-l.canonical.y||n.wrap-l.wrap||n.canonical.x-l.canonical.x}var ve=function(a,n){this.max=a,this.onRemove=n,this.reset()};ve.prototype.reset=function(){for(var s in this.data)for(var a=0,n=this.data[s];a<n.length;a+=1){var l=n[a];l.timeout&&clearTimeout(l.timeout),this.onRemove(l.value)}return this.data={},this.order=[],this},ve.prototype.add=function(s,a,n){var l=this,v=s.wrapped().key;this.data[v]===void 0&&(this.data[v]=[]);var O={value:a,timeout:void 0};if(n!==void 0&&(O.timeout=setTimeout(function(){l.remove(s,O)},n)),this.data[v].push(O),this.order.push(v),this.order.length>this.max){var L=this._getAndRemoveByKey(this.order[0]);L&&this.onRemove(L)}return this},ve.prototype.has=function(s){return s.wrapped().key in this.data},ve.prototype.getAndRemove=function(s){return this.has(s)?this._getAndRemoveByKey(s.wrapped().key):null},ve.prototype._getAndRemoveByKey=function(s){var a=this.data[s].shift();return a.timeout&&clearTimeout(a.timeout),this.data[s].length===0&&delete this.data[s],this.order.splice(this.order.indexOf(s),1),a.value},ve.prototype.getByKey=function(s){var a=this.data[s];return a?a[0].value:null},ve.prototype.get=function(s){return this.has(s)?this.data[s.wrapped().key][0].value:null},ve.prototype.remove=function(s,a){if(!this.has(s))return this;var n=s.wrapped().key,l=a===void 0?0:this.data[n].indexOf(a),v=this.data[n][l];return this.data[n].splice(l,1),v.timeout&&clearTimeout(v.timeout),this.data[n].length===0&&delete this.data[n],this.onRemove(v.value),this.order.splice(this.order.indexOf(n),1),this},ve.prototype.setMaxSize=function(s){for(this.max=s;this.order.length>this.max;){var a=this._getAndRemoveByKey(this.order[0]);a&&this.onRemove(a)}return this},ve.prototype.filter=function(s){var a=[];for(var n in this.data)for(var l=0,v=this.data[n];l<v.length;l+=1){var O=v[l];s(O.value)||a.push(O)}for(var L=0,j=a;L<j.length;L+=1){var ue=j[L];this.remove(ue.value.tileID,ue)}};var Ge=function(a,n,l){this.context=a;var v=a.gl;this.buffer=v.createBuffer(),this.dynamicDraw=Boolean(l),this.context.unbindVAO(),a.bindElementBuffer.set(this.buffer),v.bufferData(v.ELEMENT_ARRAY_BUFFER,n.arrayBuffer,this.dynamicDraw?v.DYNAMIC_DRAW:v.STATIC_DRAW),this.dynamicDraw||delete n.arrayBuffer};Ge.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},Ge.prototype.updateData=function(s){var a=this.context.gl;this.context.unbindVAO(),this.bind(),a.bufferSubData(a.ELEMENT_ARRAY_BUFFER,0,s.arrayBuffer)},Ge.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var st={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},Oe=function(a,n,l,v){this.length=n.length,this.attributes=l,this.itemSize=n.bytesPerElement,this.dynamicDraw=v,this.context=a;var O=a.gl;this.buffer=O.createBuffer(),a.bindVertexBuffer.set(this.buffer),O.bufferData(O.ARRAY_BUFFER,n.arrayBuffer,this.dynamicDraw?O.DYNAMIC_DRAW:O.STATIC_DRAW),this.dynamicDraw||delete n.arrayBuffer};Oe.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},Oe.prototype.updateData=function(s){var a=this.context.gl;this.bind(),a.bufferSubData(a.ARRAY_BUFFER,0,s.arrayBuffer)},Oe.prototype.enableAttributes=function(s,a){for(var n=0;n<this.attributes.length;n++){var l=a.attributes[this.attributes[n].name];l!==void 0&&s.enableVertexAttribArray(l)}},Oe.prototype.setVertexAttribPointers=function(s,a,n){for(var l=0;l<this.attributes.length;l++){var v=this.attributes[l],O=a.attributes[v.name];O!==void 0&&s.vertexAttribPointer(O,v.components,s[st[v.type]],!1,this.itemSize,v.offset+this.itemSize*(n||0))}},Oe.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var gt=function(a){this.gl=a.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};gt.prototype.get=function(){return this.current},gt.prototype.set=function(s){},gt.prototype.getDefault=function(){return this.default},gt.prototype.setDefault=function(){this.set(this.default)};var C=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return i.Color.transparent},a.prototype.set=function(n){var l=this.current;(n.r!==l.r||n.g!==l.g||n.b!==l.b||n.a!==l.a||this.dirty)&&(this.gl.clearColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)},a}(gt),R=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return 1},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.clearDepth(n),this.current=n,this.dirty=!1)},a}(gt),q=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return 0},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.clearStencil(n),this.current=n,this.dirty=!1)},a}(gt),fe=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return[!0,!0,!0,!0]},a.prototype.set=function(n){var l=this.current;(n[0]!==l[0]||n[1]!==l[1]||n[2]!==l[2]||n[3]!==l[3]||this.dirty)&&(this.gl.colorMask(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)},a}(gt),He=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return!0},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.depthMask(n),this.current=n,this.dirty=!1)},a}(gt),et=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return 255},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.stencilMask(n),this.current=n,this.dirty=!1)},a}(gt),_t=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},a.prototype.set=function(n){var l=this.current;(n.func!==l.func||n.ref!==l.ref||n.mask!==l.mask||this.dirty)&&(this.gl.stencilFunc(n.func,n.ref,n.mask),this.current=n,this.dirty=!1)},a}(gt),ot=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){var n=this.gl;return[n.KEEP,n.KEEP,n.KEEP]},a.prototype.set=function(n){var l=this.current;(n[0]!==l[0]||n[1]!==l[1]||n[2]!==l[2]||this.dirty)&&(this.gl.stencilOp(n[0],n[1],n[2]),this.current=n,this.dirty=!1)},a}(gt),Ut=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;n?l.enable(l.STENCIL_TEST):l.disable(l.STENCIL_TEST),this.current=n,this.dirty=!1}},a}(gt),K=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return[0,1]},a.prototype.set=function(n){var l=this.current;(n[0]!==l[0]||n[1]!==l[1]||this.dirty)&&(this.gl.depthRange(n[0],n[1]),this.current=n,this.dirty=!1)},a}(gt),qe=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;n?l.enable(l.DEPTH_TEST):l.disable(l.DEPTH_TEST),this.current=n,this.dirty=!1}},a}(gt),ae=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return this.gl.LESS},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.depthFunc(n),this.current=n,this.dirty=!1)},a}(gt),tt=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;n?l.enable(l.BLEND):l.disable(l.BLEND),this.current=n,this.dirty=!1}},a}(gt),kt=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){var n=this.gl;return[n.ONE,n.ZERO]},a.prototype.set=function(n){var l=this.current;(n[0]!==l[0]||n[1]!==l[1]||this.dirty)&&(this.gl.blendFunc(n[0],n[1]),this.current=n,this.dirty=!1)},a}(gt),pr=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return i.Color.transparent},a.prototype.set=function(n){var l=this.current;(n.r!==l.r||n.g!==l.g||n.b!==l.b||n.a!==l.a||this.dirty)&&(this.gl.blendColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)},a}(gt),Ke=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return this.gl.FUNC_ADD},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.blendEquation(n),this.current=n,this.dirty=!1)},a}(gt),xt=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;n?l.enable(l.CULL_FACE):l.disable(l.CULL_FACE),this.current=n,this.dirty=!1}},a}(gt),bt=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return this.gl.BACK},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.cullFace(n),this.current=n,this.dirty=!1)},a}(gt),Et=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return this.gl.CCW},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.frontFace(n),this.current=n,this.dirty=!1)},a}(gt),Fe=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.useProgram(n),this.current=n,this.dirty=!1)},a}(gt),pt=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return this.gl.TEXTURE0},a.prototype.set=function(n){(n!==this.current||this.dirty)&&(this.gl.activeTexture(n),this.current=n,this.dirty=!1)},a}(gt),yt=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){var n=this.gl;return[0,0,n.drawingBufferWidth,n.drawingBufferHeight]},a.prototype.set=function(n){var l=this.current;(n[0]!==l[0]||n[1]!==l[1]||n[2]!==l[2]||n[3]!==l[3]||this.dirty)&&(this.gl.viewport(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)},a}(gt),Ht=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;l.bindFramebuffer(l.FRAMEBUFFER,n),this.current=n,this.dirty=!1}},a}(gt),hr=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;l.bindRenderbuffer(l.RENDERBUFFER,n),this.current=n,this.dirty=!1}},a}(gt),Zr=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;l.bindTexture(l.TEXTURE_2D,n),this.current=n,this.dirty=!1}},a}(gt),yr=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;l.bindBuffer(l.ARRAY_BUFFER,n),this.current=n,this.dirty=!1}},a}(gt),Vn=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(n){var l=this.gl;l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,n),this.current=n,this.dirty=!1},a}(gt),zn=function(s){function a(n){s.call(this,n),this.vao=n.extVertexArrayObject}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(n){this.vao&&(n!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(n),this.current=n,this.dirty=!1)},a}(gt),oa=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return 4},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;l.pixelStorei(l.UNPACK_ALIGNMENT,n),this.current=n,this.dirty=!1}},a}(gt),$n=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;l.pixelStorei(l.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n),this.current=n,this.dirty=!1}},a}(gt),Kn=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(n){if(n!==this.current||this.dirty){var l=this.gl;l.pixelStorei(l.UNPACK_FLIP_Y_WEBGL,n),this.current=n,this.dirty=!1}},a}(gt),Cn=function(s){function a(n,l){s.call(this,n),this.context=n,this.parent=l}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a}(gt),z=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.setDirty=function(){this.dirty=!0},a.prototype.set=function(n){if(n!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var l=this.gl;l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,n,0),this.current=n,this.dirty=!1}},a}(Cn),W=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.set=function(n){if(n!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var l=this.gl;l.framebufferRenderbuffer(l.FRAMEBUFFER,l.DEPTH_ATTACHMENT,l.RENDERBUFFER,n),this.current=n,this.dirty=!1}},a}(Cn),le=function(a,n,l,v){this.context=a,this.width=n,this.height=l;var O=this.framebuffer=a.gl.createFramebuffer();this.colorAttachment=new z(a,O),v&&(this.depthAttachment=new W(a,O))};le.prototype.destroy=function(){var s=this.context.gl,a=this.colorAttachment.get();if(a&&s.deleteTexture(a),this.depthAttachment){var n=this.depthAttachment.get();n&&s.deleteRenderbuffer(n)}s.deleteFramebuffer(this.framebuffer)};var xe=function(a,n,l){this.func=a,this.mask=n,this.range=l};xe.ReadOnly=!1,xe.ReadWrite=!0,xe.disabled=new xe(519,xe.ReadOnly,[0,1]);var ut=function(a,n,l,v,O,L){this.test=a,this.ref=n,this.mask=l,this.fail=v,this.depthFail=O,this.pass=L};ut.disabled=new ut({func:519,mask:0},0,0,7680,7680,7680);var Ot=function(a,n,l){this.blendFunction=a,this.blendColor=n,this.mask=l};Ot.disabled=new Ot(Ot.Replace=[1,0],i.Color.transparent,[!1,!1,!1,!1]),Ot.unblended=new Ot(Ot.Replace,i.Color.transparent,[!0,!0,!0,!0]),Ot.alphaBlended=new Ot([1,771],i.Color.transparent,[!0,!0,!0,!0]);var Bt=function(a,n,l){this.enable=a,this.mode=n,this.frontFace=l};Bt.disabled=new Bt(!1,1029,2305),Bt.backCCW=new Bt(!0,1029,2305);var Ze=function(a){this.gl=a,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new C(this),this.clearDepth=new R(this),this.clearStencil=new q(this),this.colorMask=new fe(this),this.depthMask=new He(this),this.stencilMask=new et(this),this.stencilFunc=new _t(this),this.stencilOp=new ot(this),this.stencilTest=new Ut(this),this.depthRange=new K(this),this.depthTest=new qe(this),this.depthFunc=new ae(this),this.blend=new tt(this),this.blendFunc=new kt(this),this.blendColor=new pr(this),this.blendEquation=new Ke(this),this.cullFace=new xt(this),this.cullFaceSide=new bt(this),this.frontFace=new Et(this),this.program=new Fe(this),this.activeTexture=new pt(this),this.viewport=new yt(this),this.bindFramebuffer=new Ht(this),this.bindRenderbuffer=new hr(this),this.bindTexture=new Zr(this),this.bindVertexBuffer=new yr(this),this.bindElementBuffer=new Vn(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new zn(this),this.pixelStoreUnpack=new oa(this),this.pixelStoreUnpackPremultiplyAlpha=new $n(this),this.pixelStoreUnpackFlipY=new Kn(this),this.extTextureFilterAnisotropic=a.getExtension("EXT_texture_filter_anisotropic")||a.getExtension("MOZ_EXT_texture_filter_anisotropic")||a.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=a.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=a.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(a.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=a.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=a.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=a.getParameter(a.MAX_TEXTURE_SIZE)};Ze.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},Ze.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},Ze.prototype.createIndexBuffer=function(s,a){return new Ge(this,s,a)},Ze.prototype.createVertexBuffer=function(s,a,n){return new Oe(this,s,a,n)},Ze.prototype.createRenderbuffer=function(s,a,n){var l=this.gl,v=l.createRenderbuffer();return this.bindRenderbuffer.set(v),l.renderbufferStorage(l.RENDERBUFFER,s,a,n),this.bindRenderbuffer.set(null),v},Ze.prototype.createFramebuffer=function(s,a,n){return new le(this,s,a,n)},Ze.prototype.clear=function(s){var a=s.color,n=s.depth,l=this.gl,v=0;a&&(v|=l.COLOR_BUFFER_BIT,this.clearColor.set(a),this.colorMask.set([!0,!0,!0,!0])),n!==void 0&&(v|=l.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(n),this.depthMask.set(!0)),l.clear(v)},Ze.prototype.setCullFace=function(s){s.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(s.mode),this.frontFace.set(s.frontFace))},Ze.prototype.setDepthMode=function(s){s.func!==this.gl.ALWAYS||s.mask?(this.depthTest.set(!0),this.depthFunc.set(s.func),this.depthMask.set(s.mask),this.depthRange.set(s.range)):this.depthTest.set(!1)},Ze.prototype.setStencilMode=function(s){s.test.func!==this.gl.ALWAYS||s.mask?(this.stencilTest.set(!0),this.stencilMask.set(s.mask),this.stencilOp.set([s.fail,s.depthFail,s.pass]),this.stencilFunc.set({func:s.test.func,ref:s.ref,mask:s.test.mask})):this.stencilTest.set(!1)},Ze.prototype.setColorMode=function(s){i.deepEqual(s.blendFunction,Ot.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(s.blendFunction),this.blendColor.set(s.blendColor)),this.colorMask.set(s.mask)},Ze.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var Rt=function(s){function a(n,l,v){var O=this;s.call(this),this.id=n,this.dispatcher=v,this.on("data",function(L){L.dataType==="source"&&L.sourceDataType==="metadata"&&(O._sourceLoaded=!0),O._sourceLoaded&&!O._paused&&L.dataType==="source"&&L.sourceDataType==="content"&&(O.reload(),O.transform&&O.update(O.transform))}),this.on("error",function(){O._sourceErrored=!0}),this._source=function(L,j,ue,Ee){var $e=new it[j.type](L,j,ue,Ee);if($e.id!==L)throw new Error("Expected Source id to be "+L+" instead of "+$e.id);return i.bindAll(["load","abort","unload","serialize","prepare"],$e),$e}(n,l,v,this),this._tiles={},this._cache=new ve(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new i.SourceFeatureState}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.onAdd=function(n){this.map=n,this._maxTileCacheSize=n?n._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(n)},a.prototype.onRemove=function(n){this._source&&this._source.onRemove&&this._source.onRemove(n)},a.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;if(!this._source.loaded())return!1;for(var n in this._tiles){var l=this._tiles[n];if(l.state!=="loaded"&&l.state!=="errored")return!1}return!0},a.prototype.getSource=function(){return this._source},a.prototype.pause=function(){this._paused=!0},a.prototype.resume=function(){if(this._paused){var n=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,n&&this.reload(),this.transform&&this.update(this.transform)}},a.prototype._loadTile=function(n,l){return this._source.loadTile(n,l)},a.prototype._unloadTile=function(n){if(this._source.unloadTile)return this._source.unloadTile(n,function(){})},a.prototype._abortTile=function(n){if(this._source.abortTile)return this._source.abortTile(n,function(){})},a.prototype.serialize=function(){return this._source.serialize()},a.prototype.prepare=function(n){for(var l in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var v=this._tiles[l];v.upload(n),v.prepare(this.map.style.imageManager)}},a.prototype.getIds=function(){return i.values(this._tiles).map(function(n){return n.tileID}).sort(lr).map(function(n){return n.key})},a.prototype.getRenderableIds=function(n){var l=this,v=[];for(var O in this._tiles)this._isIdRenderable(O,n)&&v.push(this._tiles[O]);return n?v.sort(function(L,j){var ue=L.tileID,Ee=j.tileID,$e=new i.Point(ue.canonical.x,ue.canonical.y)._rotate(l.transform.angle),nt=new i.Point(Ee.canonical.x,Ee.canonical.y)._rotate(l.transform.angle);return ue.overscaledZ-Ee.overscaledZ||nt.y-$e.y||nt.x-$e.x}).map(function(L){return L.tileID.key}):v.map(function(L){return L.tileID}).sort(lr).map(function(L){return L.key})},a.prototype.hasRenderableParent=function(n){var l=this.findLoadedParent(n,0);return!!l&&this._isIdRenderable(l.tileID.key)},a.prototype._isIdRenderable=function(n,l){return this._tiles[n]&&this._tiles[n].hasData()&&!this._coveredTiles[n]&&(l||!this._tiles[n].holdingForFade())},a.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var n in this._cache.reset(),this._tiles)this._tiles[n].state!=="errored"&&this._reloadTile(n,"reloading")},a.prototype._reloadTile=function(n,l){var v=this._tiles[n];v&&(v.state!=="loading"&&(v.state=l),this._loadTile(v,this._tileLoaded.bind(this,v,n,l)))},a.prototype._tileLoaded=function(n,l,v,O){if(O)return n.state="errored",void(O.status!==404?this._source.fire(new i.ErrorEvent(O,{tile:n})):this.update(this.transform));n.timeAdded=i.browser.now(),v==="expired"&&(n.refreshedUponExpiration=!0),this._setTileReloadTimer(l,n),this.getSource().type==="raster-dem"&&n.dem&&this._backfillDEM(n),this._state.initializeTileState(n,this.map?this.map.painter:null),this._source.fire(new i.Event("data",{dataType:"source",tile:n,coord:n.tileID}))},a.prototype._backfillDEM=function(n){for(var l=this.getRenderableIds(),v=0;v<l.length;v++){var O=l[v];if(n.neighboringTiles&&n.neighboringTiles[O]){var L=this.getTileByID(O);j(n,L),j(L,n)}}function j(ue,Ee){ue.needsHillshadePrepare=!0;var $e=Ee.tileID.canonical.x-ue.tileID.canonical.x,nt=Ee.tileID.canonical.y-ue.tileID.canonical.y,at=Math.pow(2,ue.tileID.canonical.z),Ft=Ee.tileID.key;$e===0&&nt===0||Math.abs(nt)>1||(Math.abs($e)>1&&(Math.abs($e+at)===1?$e+=at:Math.abs($e-at)===1&&($e-=at)),Ee.dem&&ue.dem&&(ue.dem.backfillBorder(Ee.dem,$e,nt),ue.neighboringTiles&&ue.neighboringTiles[Ft]&&(ue.neighboringTiles[Ft].backfilled=!0)))}},a.prototype.getTile=function(n){return this.getTileByID(n.key)},a.prototype.getTileByID=function(n){return this._tiles[n]},a.prototype._retainLoadedChildren=function(n,l,v,O){for(var L in this._tiles){var j=this._tiles[L];if(!(O[L]||!j.hasData()||j.tileID.overscaledZ<=l||j.tileID.overscaledZ>v)){for(var ue=j.tileID;j&&j.tileID.overscaledZ>l+1;){var Ee=j.tileID.scaledTo(j.tileID.overscaledZ-1);(j=this._tiles[Ee.key])&&j.hasData()&&(ue=Ee)}for(var $e=ue;$e.overscaledZ>l;)if(n[($e=$e.scaledTo($e.overscaledZ-1)).key]){O[ue.key]=ue;break}}}},a.prototype.findLoadedParent=function(n,l){if(n.key in this._loadedParentTiles){var v=this._loadedParentTiles[n.key];return v&&v.tileID.overscaledZ>=l?v:null}for(var O=n.overscaledZ-1;O>=l;O--){var L=n.scaledTo(O),j=this._getLoadedTile(L);if(j)return j}},a.prototype._getLoadedTile=function(n){var l=this._tiles[n.key];return l&&l.hasData()?l:this._cache.getByKey(n.wrapped().key)},a.prototype.updateCacheSize=function(n){var l=Math.ceil(n.width/this._source.tileSize)+1,v=Math.ceil(n.height/this._source.tileSize)+1,O=Math.floor(l*v*5),L=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,O):O;this._cache.setMaxSize(L)},a.prototype.handleWrapJump=function(n){var l=Math.round((n-(this._prevLng===void 0?n:this._prevLng))/360);if(this._prevLng=n,l){var v={};for(var O in this._tiles){var L=this._tiles[O];L.tileID=L.tileID.unwrapTo(L.tileID.wrap+l),v[L.tileID.key]=L}for(var j in this._tiles=v,this._timers)clearTimeout(this._timers[j]),delete this._timers[j];for(var ue in this._tiles)this._setTileReloadTimer(ue,this._tiles[ue])}},a.prototype.update=function(n){var l=this;if(this.transform=n,this._sourceLoaded&&!this._paused){var v;this.updateCacheSize(n),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?v=n.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(Cr){return new i.OverscaledTileID(Cr.canonical.z,Cr.wrap,Cr.canonical.z,Cr.canonical.x,Cr.canonical.y)}):(v=n.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(v=v.filter(function(Cr){return l._source.hasTile(Cr)}))):v=[];var O=n.coveringZoomLevel(this._source),L=Math.max(O-a.maxOverzooming,this._source.minzoom),j=Math.max(O+a.maxUnderzooming,this._source.minzoom),ue=this._updateRetainedTiles(v,O);if(Ur(this._source.type)){for(var Ee={},$e={},nt=0,at=Object.keys(ue);nt<at.length;nt+=1){var Ft=at[nt],Nt=ue[Ft],Jt=this._tiles[Ft];if(Jt&&!(Jt.fadeEndTime&&Jt.fadeEndTime<=i.browser.now())){var jt=this.findLoadedParent(Nt,L);jt&&(this._addTile(jt.tileID),Ee[jt.tileID.key]=jt.tileID),$e[Ft]=Nt}}for(var Gt in this._retainLoadedChildren($e,O,j,ue),Ee)ue[Gt]||(this._coveredTiles[Gt]=!0,ue[Gt]=Ee[Gt])}for(var ar in ue)this._tiles[ar].clearFadeHold();for(var nr=0,Rr=i.keysDifference(this._tiles,ue);nr<Rr.length;nr+=1){var gr=Rr[nr],Ar=this._tiles[gr];Ar.hasSymbolBuckets&&!Ar.holdingForFade()?Ar.setHoldDuration(this.map._fadeDuration):Ar.hasSymbolBuckets&&!Ar.symbolFadeFinished()||this._removeTile(gr)}this._updateLoadedParentTileCache()}},a.prototype.releaseSymbolFadeTiles=function(){for(var n in this._tiles)this._tiles[n].holdingForFade()&&this._removeTile(n)},a.prototype._updateRetainedTiles=function(n,l){for(var v={},O={},L=Math.max(l-a.maxOverzooming,this._source.minzoom),j=Math.max(l+a.maxUnderzooming,this._source.minzoom),ue={},Ee=0,$e=n;Ee<$e.length;Ee+=1){var nt=$e[Ee],at=this._addTile(nt);v[nt.key]=nt,at.hasData()||l<this._source.maxzoom&&(ue[nt.key]=nt)}this._retainLoadedChildren(ue,l,j,v);for(var Ft=0,Nt=n;Ft<Nt.length;Ft+=1){var Jt=Nt[Ft],jt=this._tiles[Jt.key];if(!jt.hasData()){if(l+1>this._source.maxzoom){var Gt=Jt.children(this._source.maxzoom)[0],ar=this.getTile(Gt);if(ar&&ar.hasData()){v[Gt.key]=Gt;continue}}else{var nr=Jt.children(this._source.maxzoom);if(v[nr[0].key]&&v[nr[1].key]&&v[nr[2].key]&&v[nr[3].key])continue}for(var Rr=jt.wasRequested(),gr=Jt.overscaledZ-1;gr>=L;--gr){var Ar=Jt.scaledTo(gr);if(O[Ar.key])break;if(O[Ar.key]=!0,!(jt=this.getTile(Ar))&&Rr&&(jt=this._addTile(Ar)),jt&&(v[Ar.key]=Ar,Rr=jt.wasRequested(),jt.hasData()))break}}}return v},a.prototype._updateLoadedParentTileCache=function(){for(var n in this._loadedParentTiles={},this._tiles){for(var l=[],v=void 0,O=this._tiles[n].tileID;O.overscaledZ>0;){if(O.key in this._loadedParentTiles){v=this._loadedParentTiles[O.key];break}l.push(O.key);var L=O.scaledTo(O.overscaledZ-1);if(v=this._getLoadedTile(L))break;O=L}for(var j=0,ue=l;j<ue.length;j+=1)this._loadedParentTiles[ue[j]]=v}},a.prototype._addTile=function(n){var l=this._tiles[n.key];if(l)return l;(l=this._cache.getAndRemove(n))&&(this._setTileReloadTimer(n.key,l),l.tileID=n,this._state.initializeTileState(l,this.map?this.map.painter:null),this._cacheTimers[n.key]&&(clearTimeout(this._cacheTimers[n.key]),delete this._cacheTimers[n.key],this._setTileReloadTimer(n.key,l)));var v=Boolean(l);return v||(l=new i.Tile(n,this._source.tileSize*n.overscaleFactor()),this._loadTile(l,this._tileLoaded.bind(this,l,n.key,l.state))),l?(l.uses++,this._tiles[n.key]=l,v||this._source.fire(new i.Event("dataloading",{tile:l,coord:l.tileID,dataType:"source"})),l):null},a.prototype._setTileReloadTimer=function(n,l){var v=this;n in this._timers&&(clearTimeout(this._timers[n]),delete this._timers[n]);var O=l.getExpiryTimeout();O&&(this._timers[n]=setTimeout(function(){v._reloadTile(n,"expired"),delete v._timers[n]},O))},a.prototype._removeTile=function(n){var l=this._tiles[n];l&&(l.uses--,delete this._tiles[n],this._timers[n]&&(clearTimeout(this._timers[n]),delete this._timers[n]),l.uses>0||(l.hasData()&&l.state!=="reloading"?this._cache.add(l.tileID,l,l.getExpiryTimeout()):(l.aborted=!0,this._abortTile(l),this._unloadTile(l))))},a.prototype.clearTiles=function(){for(var n in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(n);this._cache.reset()},a.prototype.tilesIn=function(n,l,v){var O=this,L=[],j=this.transform;if(!j)return L;for(var ue=v?j.getCameraQueryGeometry(n):n,Ee=n.map(function(gr){return j.pointCoordinate(gr)}),$e=ue.map(function(gr){return j.pointCoordinate(gr)}),nt=this.getIds(),at=1/0,Ft=1/0,Nt=-1/0,Jt=-1/0,jt=0,Gt=$e;jt<Gt.length;jt+=1){var ar=Gt[jt];at=Math.min(at,ar.x),Ft=Math.min(Ft,ar.y),Nt=Math.max(Nt,ar.x),Jt=Math.max(Jt,ar.y)}for(var nr=function(Ar){var Cr=O._tiles[nt[Ar]];if(!Cr.holdingForFade()){var an=Cr.tileID,Yr=Math.pow(2,j.zoom-Cr.tileID.overscaledZ),vn=l*Cr.queryPadding*i.EXTENT/Cr.tileSize/Yr,Pn=[an.getTilePoint(new i.MercatorCoordinate(at,Ft)),an.getTilePoint(new i.MercatorCoordinate(Nt,Jt))];if(Pn[0].x-vn<i.EXTENT&&Pn[0].y-vn<i.EXTENT&&Pn[1].x+vn>=0&&Pn[1].y+vn>=0){var qn=Ee.map(function(Aa){return an.getTilePoint(Aa)}),sa=$e.map(function(Aa){return an.getTilePoint(Aa)});L.push({tile:Cr,tileID:an,queryGeometry:qn,cameraQueryGeometry:sa,scale:Yr})}}},Rr=0;Rr<nt.length;Rr++)nr(Rr);return L},a.prototype.getVisibleCoordinates=function(n){for(var l=this,v=this.getRenderableIds(n).map(function(ue){return l._tiles[ue].tileID}),O=0,L=v;O<L.length;O+=1){var j=L[O];j.posMatrix=this.transform.calculatePosMatrix(j.toUnwrapped())}return v},a.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(Ur(this._source.type))for(var n in this._tiles){var l=this._tiles[n];if(l.fadeEndTime!==void 0&&l.fadeEndTime>=i.browser.now())return!0}return!1},a.prototype.setFeatureState=function(n,l,v){this._state.updateState(n=n||"_geojsonTileLayer",l,v)},a.prototype.removeFeatureState=function(n,l,v){this._state.removeFeatureState(n=n||"_geojsonTileLayer",l,v)},a.prototype.getFeatureState=function(n,l){return this._state.getState(n=n||"_geojsonTileLayer",l)},a.prototype.setDependencies=function(n,l,v){var O=this._tiles[n];O&&O.setDependencies(l,v)},a.prototype.reloadTilesForDependencies=function(n,l){for(var v in this._tiles)this._tiles[v].hasDependency(n,l)&&this._reloadTile(v,"reloading");this._cache.filter(function(O){return!O.hasDependency(n,l)})},a}(i.Evented);function lr(s,a){var n=Math.abs(2*s.wrap)-+(s.wrap<0),l=Math.abs(2*a.wrap)-+(a.wrap<0);return s.overscaledZ-a.overscaledZ||l-n||a.canonical.y-s.canonical.y||a.canonical.x-s.canonical.x}function Ur(s){return s==="raster"||s==="image"||s==="video"}function Gr(){return new i.window.Worker(ac.workerUrl)}Rt.maxOverzooming=10,Rt.maxUnderzooming=3;var cr="mapboxgl_preloaded_worker_pool",Br=function(){this.active={}};Br.prototype.acquire=function(s){if(!this.workers)for(this.workers=[];this.workers.length<Br.workerCount;)this.workers.push(new Gr);return this.active[s]=!0,this.workers.slice()},Br.prototype.release=function(s){delete this.active[s],this.numActive()===0&&(this.workers.forEach(function(a){a.terminate()}),this.workers=null)},Br.prototype.isPreloaded=function(){return!!this.active[cr]},Br.prototype.numActive=function(){return Object.keys(this.active).length};var wn,fn=Math.floor(i.browser.hardwareConcurrency/2);function tr(){return wn||(wn=new Br),wn}function rn(s,a){var n={};for(var l in s)l!=="ref"&&(n[l]=s[l]);return i.refProperties.forEach(function(v){v in a&&(n[v]=a[v])}),n}function dn(s){s=s.slice();for(var a=Object.create(null),n=0;n<s.length;n++)a[s[n].id]=s[n];for(var l=0;l<s.length;l++)"ref"in s[l]&&(s[l]=rn(s[l],a[s[l].ref]));return s}Br.workerCount=Math.max(Math.min(fn,6),1);var En={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function bn(s,a,n){n.push({command:En.addSource,args:[s,a[s]]})}function gn(s,a,n){a.push({command:En.removeSource,args:[s]}),n[s]=!0}function Mn(s,a,n,l){gn(s,n,l),bn(s,a,n)}function Ga(s,a,n){var l;for(l in s[n])if(s[n].hasOwnProperty(l)&&l!=="data"&&!i.deepEqual(s[n][l],a[n][l]))return!1;for(l in a[n])if(a[n].hasOwnProperty(l)&&l!=="data"&&!i.deepEqual(s[n][l],a[n][l]))return!1;return!0}function ga(s,a,n,l,v,O){var L;for(L in a=a||{},s=s||{})s.hasOwnProperty(L)&&(i.deepEqual(s[L],a[L])||n.push({command:O,args:[l,L,a[L],v]}));for(L in a)a.hasOwnProperty(L)&&!s.hasOwnProperty(L)&&(i.deepEqual(s[L],a[L])||n.push({command:O,args:[l,L,a[L],v]}))}function Ma(s){return s.id}function Ia(s,a){return s[a.id]=a,s}var Wi=function(a,n){this.reset(a,n)};Wi.prototype.reset=function(s,a){this.points=s||[],this._distances=[0];for(var n=1;n<this.points.length;n++)this._distances[n]=this._distances[n-1]+this.points[n].dist(this.points[n-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(a||0,.5*this.length),this.paddedLength=this.length-2*this.padding},Wi.prototype.lerp=function(s){if(this.points.length===1)return this.points[0];s=i.clamp(s,0,1);for(var a=1,n=this._distances[a],l=s*this.paddedLength+this.padding;n<l&&a<this._distances.length;)n=this._distances[++a];var v=a-1,O=this._distances[v],L=n-O,j=L>0?(l-O)/L:0;return this.points[v].mult(1-j).add(this.points[a].mult(j))};var da=function(a,n,l){var v=this.boxCells=[],O=this.circleCells=[];this.xCellCount=Math.ceil(a/l),this.yCellCount=Math.ceil(n/l);for(var L=0;L<this.xCellCount*this.yCellCount;L++)v.push([]),O.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=a,this.height=n,this.xScale=this.xCellCount/a,this.yScale=this.yCellCount/n,this.boxUid=0,this.circleUid=0};function vi(s,a,n,l,v){var O=i.create();return a?(i.scale(O,O,[1/v,1/v,1]),n||i.rotateZ(O,O,l.angle)):i.multiply(O,l.labelPlaneMatrix,s),O}function ya(s,a,n,l,v){if(a){var O=i.clone(s);return i.scale(O,O,[v,v,1]),n||i.rotateZ(O,O,-l.angle),O}return l.glCoordMatrix}function ba(s,a){var n=[s.x,s.y,0,1];Yi(n,n,a);var l=n[3];return{point:new i.Point(n[0]/l,n[1]/l),signedDistanceFromCamera:l}}function ha(s,a){return .5+s/a*.5}function wi(s,a){var n=s[0]/s[3],l=s[1]/s[3];return n>=-a[0]&&n<=a[0]&&l>=-a[1]&&l<=a[1]}function is(s,a,n,l,v,O,L,j){var ue=l?s.textSizeData:s.iconSizeData,Ee=i.evaluateSizeForZoom(ue,n.transform.zoom),$e=[256/n.width*2+1,256/n.height*2+1],nt=l?s.text.dynamicLayoutVertexArray:s.icon.dynamicLayoutVertexArray;nt.clear();for(var at=s.lineVertexArray,Ft=l?s.text.placedSymbolArray:s.icon.placedSymbolArray,Nt=n.transform.width/n.transform.height,Jt=!1,jt=0;jt<Ft.length;jt++){var Gt=Ft.get(jt);if(Gt.hidden||Gt.writingMode===i.WritingMode.vertical&&!Jt)ui(Gt.numGlyphs,nt);else{Jt=!1;var ar=[Gt.anchorX,Gt.anchorY,0,1];if(i.transformMat4(ar,ar,a),wi(ar,$e)){var nr=ha(n.transform.cameraToCenterDistance,ar[3]),Rr=i.evaluateSizeForFeature(ue,Ee,Gt),gr=L?Rr/nr:Rr*nr,Ar=new i.Point(Gt.anchorX,Gt.anchorY),Cr=ba(Ar,v).point,an={},Yr=Du(Gt,gr,!1,j,a,v,O,s.glyphOffsetArray,at,nt,Cr,Ar,an,Nt);Jt=Yr.useVertical,(Yr.notEnoughRoom||Jt||Yr.needsFlipping&&Du(Gt,gr,!0,j,a,v,O,s.glyphOffsetArray,at,nt,Cr,Ar,an,Nt).notEnoughRoom)&&ui(Gt.numGlyphs,nt)}else ui(Gt.numGlyphs,nt)}}l?s.text.dynamicLayoutVertexBuffer.updateData(nt):s.icon.dynamicLayoutVertexBuffer.updateData(nt)}function Xi(s,a,n,l,v,O,L,j,ue,Ee,$e){var nt=j.glyphStartIndex+j.numGlyphs,at=j.lineStartIndex,Ft=j.lineStartIndex+j.lineLength,Nt=a.getoffsetX(j.glyphStartIndex),Jt=a.getoffsetX(nt-1),jt=Oi(s*Nt,n,l,v,O,L,j.segment,at,Ft,ue,Ee,$e);if(!jt)return null;var Gt=Oi(s*Jt,n,l,v,O,L,j.segment,at,Ft,ue,Ee,$e);return Gt?{first:jt,last:Gt}:null}function Xo(s,a,n,l){return s===i.WritingMode.horizontal&&Math.abs(n.y-a.y)>Math.abs(n.x-a.x)*l?{useVertical:!0}:(s===i.WritingMode.vertical?a.y<n.y:a.x>n.x)?{needsFlipping:!0}:null}function Du(s,a,n,l,v,O,L,j,ue,Ee,$e,nt,at,Ft){var Nt,Jt=a/24,jt=s.lineOffsetX*Jt,Gt=s.lineOffsetY*Jt;if(s.numGlyphs>1){var ar=s.glyphStartIndex+s.numGlyphs,nr=s.lineStartIndex,Rr=s.lineStartIndex+s.lineLength,gr=Xi(Jt,j,jt,Gt,n,$e,nt,s,ue,O,at);if(!gr)return{notEnoughRoom:!0};var Ar=ba(gr.first.point,L).point,Cr=ba(gr.last.point,L).point;if(l&&!n){var an=Xo(s.writingMode,Ar,Cr,Ft);if(an)return an}Nt=[gr.first];for(var Yr=s.glyphStartIndex+1;Yr<ar-1;Yr++)Nt.push(Oi(Jt*j.getoffsetX(Yr),jt,Gt,n,$e,nt,s.segment,nr,Rr,ue,O,at));Nt.push(gr.last)}else{if(l&&!n){var vn=ba(nt,v).point,Pn=s.lineStartIndex+s.segment+1,qn=new i.Point(ue.getx(Pn),ue.gety(Pn)),sa=ba(qn,v),Aa=sa.signedDistanceFromCamera>0?sa.point:Ha(nt,qn,vn,1,v),Wa=Xo(s.writingMode,vn,Aa,Ft);if(Wa)return Wa}var _n=Oi(Jt*j.getoffsetX(s.glyphStartIndex),jt,Gt,n,$e,nt,s.segment,s.lineStartIndex,s.lineStartIndex+s.lineLength,ue,O,at);if(!_n)return{notEnoughRoom:!0};Nt=[_n]}for(var ua=0,xa=Nt;ua<xa.length;ua+=1){var Zn=xa[ua];i.addDynamicAttributes(Ee,Zn.point,Zn.angle)}return{}}function Ha(s,a,n,l,v){var O=ba(s.add(s.sub(a)._unit()),v).point,L=n.sub(O);return n.add(L._mult(l/L.mag()))}function Oi(s,a,n,l,v,O,L,j,ue,Ee,$e,nt){var at=l?s-a:s+a,Ft=at>0?1:-1,Nt=0;l&&(Ft*=-1,Nt=Math.PI),Ft<0&&(Nt+=Math.PI);for(var Jt=Ft>0?j+L:j+L+1,jt=v,Gt=v,ar=0,nr=0,Rr=Math.abs(at),gr=[];ar+nr<=Rr;){if((Jt+=Ft)<j||Jt>=ue)return null;if(Gt=jt,gr.push(jt),(jt=nt[Jt])===void 0){var Ar=new i.Point(Ee.getx(Jt),Ee.gety(Jt)),Cr=ba(Ar,$e);if(Cr.signedDistanceFromCamera>0)jt=nt[Jt]=Cr.point;else{var an=Jt-Ft;jt=Ha(ar===0?O:new i.Point(Ee.getx(an),Ee.gety(an)),Ar,Gt,Rr-ar+1,$e)}}ar+=nr,nr=Gt.dist(jt)}var Yr=(Rr-ar)/nr,vn=jt.sub(Gt),Pn=vn.mult(Yr)._add(Gt);Pn._add(vn._unit()._perp()._mult(n*Ft));var qn=Nt+Math.atan2(jt.y-Gt.y,jt.x-Gt.x);return gr.push(Pn),{point:Pn,angle:qn,path:gr}}da.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},da.prototype.insert=function(s,a,n,l,v){this._forEachCell(a,n,l,v,this._insertBoxCell,this.boxUid++),this.boxKeys.push(s),this.bboxes.push(a),this.bboxes.push(n),this.bboxes.push(l),this.bboxes.push(v)},da.prototype.insertCircle=function(s,a,n,l){this._forEachCell(a-l,n-l,a+l,n+l,this._insertCircleCell,this.circleUid++),this.circleKeys.push(s),this.circles.push(a),this.circles.push(n),this.circles.push(l)},da.prototype._insertBoxCell=function(s,a,n,l,v,O){this.boxCells[v].push(O)},da.prototype._insertCircleCell=function(s,a,n,l,v,O){this.circleCells[v].push(O)},da.prototype._query=function(s,a,n,l,v,O){if(n<0||s>this.width||l<0||a>this.height)return!v&&[];var L=[];if(s<=0&&a<=0&&this.width<=n&&this.height<=l){if(v)return!0;for(var j=0;j<this.boxKeys.length;j++)L.push({key:this.boxKeys[j],x1:this.bboxes[4*j],y1:this.bboxes[4*j+1],x2:this.bboxes[4*j+2],y2:this.bboxes[4*j+3]});for(var ue=0;ue<this.circleKeys.length;ue++){var Ee=this.circles[3*ue],$e=this.circles[3*ue+1],nt=this.circles[3*ue+2];L.push({key:this.circleKeys[ue],x1:Ee-nt,y1:$e-nt,x2:Ee+nt,y2:$e+nt})}return O?L.filter(O):L}return this._forEachCell(s,a,n,l,this._queryCell,L,{hitTest:v,seenUids:{box:{},circle:{}}},O),v?L.length>0:L},da.prototype._queryCircle=function(s,a,n,l,v){var O=s-n,L=s+n,j=a-n,ue=a+n;if(L<0||O>this.width||ue<0||j>this.height)return!l&&[];var Ee=[];return this._forEachCell(O,j,L,ue,this._queryCellCircle,Ee,{hitTest:l,circle:{x:s,y:a,radius:n},seenUids:{box:{},circle:{}}},v),l?Ee.length>0:Ee},da.prototype.query=function(s,a,n,l,v){return this._query(s,a,n,l,!1,v)},da.prototype.hitTest=function(s,a,n,l,v){return this._query(s,a,n,l,!0,v)},da.prototype.hitTestCircle=function(s,a,n,l){return this._queryCircle(s,a,n,!0,l)},da.prototype._queryCell=function(s,a,n,l,v,O,L,j){var ue=L.seenUids,Ee=this.boxCells[v];if(Ee!==null)for(var $e=this.bboxes,nt=0,at=Ee;nt<at.length;nt+=1){var Ft=at[nt];if(!ue.box[Ft]){ue.box[Ft]=!0;var Nt=4*Ft;if(s<=$e[Nt+2]&&a<=$e[Nt+3]&&n>=$e[Nt+0]&&l>=$e[Nt+1]&&(!j||j(this.boxKeys[Ft]))){if(L.hitTest)return O.push(!0),!0;O.push({key:this.boxKeys[Ft],x1:$e[Nt],y1:$e[Nt+1],x2:$e[Nt+2],y2:$e[Nt+3]})}}}var Jt=this.circleCells[v];if(Jt!==null)for(var jt=this.circles,Gt=0,ar=Jt;Gt<ar.length;Gt+=1){var nr=ar[Gt];if(!ue.circle[nr]){ue.circle[nr]=!0;var Rr=3*nr;if(this._circleAndRectCollide(jt[Rr],jt[Rr+1],jt[Rr+2],s,a,n,l)&&(!j||j(this.circleKeys[nr]))){if(L.hitTest)return O.push(!0),!0;var gr=jt[Rr],Ar=jt[Rr+1],Cr=jt[Rr+2];O.push({key:this.circleKeys[nr],x1:gr-Cr,y1:Ar-Cr,x2:gr+Cr,y2:Ar+Cr})}}}},da.prototype._queryCellCircle=function(s,a,n,l,v,O,L,j){var ue=L.circle,Ee=L.seenUids,$e=this.boxCells[v];if($e!==null)for(var nt=this.bboxes,at=0,Ft=$e;at<Ft.length;at+=1){var Nt=Ft[at];if(!Ee.box[Nt]){Ee.box[Nt]=!0;var Jt=4*Nt;if(this._circleAndRectCollide(ue.x,ue.y,ue.radius,nt[Jt+0],nt[Jt+1],nt[Jt+2],nt[Jt+3])&&(!j||j(this.boxKeys[Nt])))return O.push(!0),!0}}var jt=this.circleCells[v];if(jt!==null)for(var Gt=this.circles,ar=0,nr=jt;ar<nr.length;ar+=1){var Rr=nr[ar];if(!Ee.circle[Rr]){Ee.circle[Rr]=!0;var gr=3*Rr;if(this._circlesCollide(Gt[gr],Gt[gr+1],Gt[gr+2],ue.x,ue.y,ue.radius)&&(!j||j(this.circleKeys[Rr])))return O.push(!0),!0}}},da.prototype._forEachCell=function(s,a,n,l,v,O,L,j){for(var ue=this._convertToXCellCoord(s),Ee=this._convertToYCellCoord(a),$e=this._convertToXCellCoord(n),nt=this._convertToYCellCoord(l),at=ue;at<=$e;at++)for(var Ft=Ee;Ft<=nt;Ft++)if(v.call(this,s,a,n,l,this.xCellCount*Ft+at,O,L,j))return},da.prototype._convertToXCellCoord=function(s){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(s*this.xScale)))},da.prototype._convertToYCellCoord=function(s){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(s*this.yScale)))},da.prototype._circlesCollide=function(s,a,n,l,v,O){var L=l-s,j=v-a,ue=n+O;return ue*ue>L*L+j*j},da.prototype._circleAndRectCollide=function(s,a,n,l,v,O,L){var j=(O-l)/2,ue=Math.abs(s-(l+j));if(ue>j+n)return!1;var Ee=(L-v)/2,$e=Math.abs(a-(v+Ee));if($e>Ee+n)return!1;if(ue<=j||$e<=Ee)return!0;var nt=ue-j,at=$e-Ee;return nt*nt+at*at<=n*n};var Jo=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function ui(s,a){for(var n=0;n<s;n++){var l=a.length;a.resize(l+4),a.float32.set(Jo,3*l)}}function Yi(s,a,n){var l=a[0],v=a[1];return s[0]=n[0]*l+n[4]*v+n[12],s[1]=n[1]*l+n[5]*v+n[13],s[3]=n[3]*l+n[7]*v+n[15],s}var Oo=function(a,n,l){n===void 0&&(n=new da(a.width+200,a.height+200,25)),l===void 0&&(l=new da(a.width+200,a.height+200,25)),this.transform=a,this.grid=n,this.ignoredGrid=l,this.pitchfactor=Math.cos(a._pitch)*a.cameraToCenterDistance,this.screenRightBoundary=a.width+100,this.screenBottomBoundary=a.height+100,this.gridRightBoundary=a.width+200,this.gridBottomBoundary=a.height+200};function Za(s,a,n){return a*(i.EXTENT/(s.tileSize*Math.pow(2,n-s.tileID.overscaledZ)))}Oo.prototype.placeCollisionBox=function(s,a,n,l,v){var O=this.projectAndGetPerspectiveRatio(l,s.anchorPointX,s.anchorPointY),L=n*O.perspectiveRatio,j=s.x1*L+O.point.x,ue=s.y1*L+O.point.y,Ee=s.x2*L+O.point.x,$e=s.y2*L+O.point.y;return!this.isInsideGrid(j,ue,Ee,$e)||!a&&this.grid.hitTest(j,ue,Ee,$e,v)?{box:[],offscreen:!1}:{box:[j,ue,Ee,$e],offscreen:this.isOffscreen(j,ue,Ee,$e)}},Oo.prototype.placeCollisionCircles=function(s,a,n,l,v,O,L,j,ue,Ee,$e,nt,at){var Ft=[],Nt=new i.Point(a.anchorX,a.anchorY),Jt=ba(Nt,O),jt=ha(this.transform.cameraToCenterDistance,Jt.signedDistanceFromCamera),Gt=(Ee?v/jt:v*jt)/i.ONE_EM,ar=ba(Nt,L).point,nr=Xi(Gt,l,a.lineOffsetX*Gt,a.lineOffsetY*Gt,!1,ar,Nt,a,n,L,{}),Rr=!1,gr=!1,Ar=!0;if(nr){for(var Cr=.5*nt*jt+at,an=new i.Point(-100,-100),Yr=new i.Point(this.screenRightBoundary,this.screenBottomBoundary),vn=new Wi,Pn=nr.first,qn=nr.last,sa=[],Aa=Pn.path.length-1;Aa>=1;Aa--)sa.push(Pn.path[Aa]);for(var Wa=1;Wa<qn.path.length;Wa++)sa.push(qn.path[Wa]);var _n=2.5*Cr;if(j){var ua=sa.map(function(Hs){return ba(Hs,j)});sa=ua.some(function(Hs){return Hs.signedDistanceFromCamera<=0})?[]:ua.map(function(Hs){return Hs.point})}var xa=[];if(sa.length>0){for(var Zn=sa[0].clone(),Ca=sa[0].clone(),ia=1;ia<sa.length;ia++)Zn.x=Math.min(Zn.x,sa[ia].x),Zn.y=Math.min(Zn.y,sa[ia].y),Ca.x=Math.max(Ca.x,sa[ia].x),Ca.y=Math.max(Ca.y,sa[ia].y);xa=Zn.x>=an.x&&Ca.x<=Yr.x&&Zn.y>=an.y&&Ca.y<=Yr.y?[sa]:Ca.x<an.x||Zn.x>Yr.x||Ca.y<an.y||Zn.y>Yr.y?[]:i.clipLine([sa],an.x,an.y,Yr.x,Yr.y)}for(var La=0,za=xa;La<za.length;La+=1){var Hi;vn.reset(za[La],.25*Cr),Hi=vn.length<=.5*Cr?1:Math.ceil(vn.paddedLength/_n)+1;for(var Ai=0;Ai<Hi;Ai++){var Ni=Ai/Math.max(Hi-1,1),Ei=vn.lerp(Ni),Bi=Ei.x+100,es=Ei.y+100;Ft.push(Bi,es,Cr,0);var ts=Bi-Cr,vu=es-Cr,wu=Bi+Cr,hs=es+Cr;if(Ar=Ar&&this.isOffscreen(ts,vu,wu,hs),gr=gr||this.isInsideGrid(ts,vu,wu,hs),!s&&this.grid.hitTestCircle(Bi,es,Cr,$e)&&(Rr=!0,!ue))return{circles:[],offscreen:!1,collisionDetected:Rr}}}}return{circles:!ue&&Rr||!gr?[]:Ft,offscreen:Ar,collisionDetected:Rr}},Oo.prototype.queryRenderedSymbols=function(s){if(s.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};for(var a=[],n=1/0,l=1/0,v=-1/0,O=-1/0,L=0,j=s;L<j.length;L+=1){var ue=j[L],Ee=new i.Point(ue.x+100,ue.y+100);n=Math.min(n,Ee.x),l=Math.min(l,Ee.y),v=Math.max(v,Ee.x),O=Math.max(O,Ee.y),a.push(Ee)}for(var $e={},nt={},at=0,Ft=this.grid.query(n,l,v,O).concat(this.ignoredGrid.query(n,l,v,O));at<Ft.length;at+=1){var Nt=Ft[at],Jt=Nt.key;if($e[Jt.bucketInstanceId]===void 0&&($e[Jt.bucketInstanceId]={}),!$e[Jt.bucketInstanceId][Jt.featureIndex]){var jt=[new i.Point(Nt.x1,Nt.y1),new i.Point(Nt.x2,Nt.y1),new i.Point(Nt.x2,Nt.y2),new i.Point(Nt.x1,Nt.y2)];i.polygonIntersectsPolygon(a,jt)&&($e[Jt.bucketInstanceId][Jt.featureIndex]=!0,nt[Jt.bucketInstanceId]===void 0&&(nt[Jt.bucketInstanceId]=[]),nt[Jt.bucketInstanceId].push(Jt.featureIndex))}}return nt},Oo.prototype.insertCollisionBox=function(s,a,n,l,v){(a?this.ignoredGrid:this.grid).insert({bucketInstanceId:n,featureIndex:l,collisionGroupID:v},s[0],s[1],s[2],s[3])},Oo.prototype.insertCollisionCircles=function(s,a,n,l,v){for(var O=a?this.ignoredGrid:this.grid,L={bucketInstanceId:n,featureIndex:l,collisionGroupID:v},j=0;j<s.length;j+=4)O.insertCircle(L,s[j],s[j+1],s[j+2])},Oo.prototype.projectAndGetPerspectiveRatio=function(s,a,n){var l=[a,n,0,1];return Yi(l,l,s),{point:new i.Point((l[0]/l[3]+1)/2*this.transform.width+100,(-l[1]/l[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/l[3]*.5}},Oo.prototype.isOffscreen=function(s,a,n,l){return n<100||s>=this.screenRightBoundary||l<100||a>this.screenBottomBoundary},Oo.prototype.isInsideGrid=function(s,a,n,l){return n>=0&&s<this.gridRightBoundary&&l>=0&&a<this.gridBottomBoundary},Oo.prototype.getViewportMatrix=function(){var s=i.identity([]);return i.translate(s,s,[-100,-100,0]),s};var oo=function(a,n,l,v){this.opacity=a?Math.max(0,Math.min(1,a.opacity+(a.placed?n:-n))):v&&l?1:0,this.placed=l};oo.prototype.isHidden=function(){return this.opacity===0&&!this.placed};var so=function(a,n,l,v,O){this.text=new oo(a?a.text:null,n,l,O),this.icon=new oo(a?a.icon:null,n,v,O)};so.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var bu=function(a,n,l){this.text=a,this.icon=n,this.skipFade=l},Qo=function(){this.invProjMatrix=i.create(),this.viewportMatrix=i.create(),this.circles=[]},Xl=function(a,n,l,v,O){this.bucketInstanceId=a,this.featureIndex=n,this.sourceLayerIndex=l,this.bucketIndex=v,this.tileID=O},js=function(a){this.crossSourceCollisions=a,this.maxGroupID=0,this.collisionGroups={}};function ho(s,a,n,l,v){var O=i.getAnchorAlignment(s),L=-(O.horizontalAlign-.5)*a,j=-(O.verticalAlign-.5)*n,ue=i.evaluateVariableOffset(s,l);return new i.Point(L+ue[0]*v,j+ue[1]*v)}function Vt(s,a,n,l,v,O){var L=s.x1,j=s.x2,ue=s.y1,Ee=s.y2,$e=s.anchorPointX,nt=s.anchorPointY,at=new i.Point(a,n);return l&&at._rotate(v?O:-O),{x1:L+at.x,y1:ue+at.y,x2:j+at.x,y2:Ee+at.y,anchorPointX:$e,anchorPointY:nt}}js.prototype.get=function(s){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[s]){var a=++this.maxGroupID;this.collisionGroups[s]={ID:a,predicate:function(l){return l.collisionGroupID===a}}}return this.collisionGroups[s]};var Re=function(a,n,l,v){this.transform=a.clone(),this.collisionIndex=new Oo(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=n,this.retainedQueryData={},this.collisionGroups=new js(l),this.collisionCircleArrays={},this.prevPlacement=v,v&&(v.prevPlacement=void 0),this.placedOrientations={}};function Dt(s,a,n,l,v){s.emplaceBack(a?1:0,n?1:0,l||0,v||0),s.emplaceBack(a?1:0,n?1:0,l||0,v||0),s.emplaceBack(a?1:0,n?1:0,l||0,v||0),s.emplaceBack(a?1:0,n?1:0,l||0,v||0)}Re.prototype.getBucketParts=function(s,a,n,l){var v=n.getBucket(a),O=n.latestFeatureIndex;if(v&&O&&a.id===v.layerIds[0]){var L=n.collisionBoxArray,j=v.layers[0].layout,ue=Math.pow(2,this.transform.zoom-n.tileID.overscaledZ),Ee=n.tileSize/i.EXTENT,$e=this.transform.calculatePosMatrix(n.tileID.toUnwrapped()),nt=j.get("text-pitch-alignment")==="map",at=j.get("text-rotation-alignment")==="map",Ft=Za(n,1,this.transform.zoom),Nt=vi($e,nt,at,this.transform,Ft),Jt=null;if(nt){var jt=ya($e,nt,at,this.transform,Ft);Jt=i.multiply([],this.transform.labelPlaneMatrix,jt)}this.retainedQueryData[v.bucketInstanceId]=new Xl(v.bucketInstanceId,O,v.sourceLayerIndex,v.index,n.tileID);var Gt={bucket:v,layout:j,posMatrix:$e,textLabelPlaneMatrix:Nt,labelToScreenMatrix:Jt,scale:ue,textPixelRatio:Ee,holdingForFade:n.holdingForFade(),collisionBoxArray:L,partiallyEvaluatedTextSize:i.evaluateSizeForZoom(v.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(v.sourceID)};if(l)for(var ar=0,nr=v.sortKeyRanges;ar<nr.length;ar+=1){var Rr=nr[ar];s.push({sortKey:Rr.sortKey,symbolInstanceStart:Rr.symbolInstanceStart,symbolInstanceEnd:Rr.symbolInstanceEnd,parameters:Gt})}else s.push({symbolInstanceStart:0,symbolInstanceEnd:v.symbolInstances.length,parameters:Gt})}},Re.prototype.attemptAnchorPlacement=function(s,a,n,l,v,O,L,j,ue,Ee,$e,nt,at,Ft,Nt){var Jt,jt=[nt.textOffset0,nt.textOffset1],Gt=ho(s,n,l,jt,v),ar=this.collisionIndex.placeCollisionBox(Vt(a,Gt.x,Gt.y,O,L,this.transform.angle),$e,j,ue,Ee.predicate);if(!Nt||this.collisionIndex.placeCollisionBox(Vt(Nt,Gt.x,Gt.y,O,L,this.transform.angle),$e,j,ue,Ee.predicate).box.length!==0)return ar.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[nt.crossTileID]&&this.prevPlacement.placements[nt.crossTileID]&&this.prevPlacement.placements[nt.crossTileID].text&&(Jt=this.prevPlacement.variableOffsets[nt.crossTileID].anchor),this.variableOffsets[nt.crossTileID]={textOffset:jt,width:n,height:l,anchor:s,textBoxScale:v,prevAnchor:Jt},this.markUsedJustification(at,s,nt,Ft),at.allowVerticalPlacement&&(this.markUsedOrientation(at,Ft,nt),this.placedOrientations[nt.crossTileID]=Ft),{shift:Gt,placedGlyphBoxes:ar}):void 0},Re.prototype.placeLayerBucketPart=function(s,a,n){var l=this,v=s.parameters,O=v.bucket,L=v.layout,j=v.posMatrix,ue=v.textLabelPlaneMatrix,Ee=v.labelToScreenMatrix,$e=v.textPixelRatio,nt=v.holdingForFade,at=v.collisionBoxArray,Ft=v.partiallyEvaluatedTextSize,Nt=v.collisionGroup,Jt=L.get("text-optional"),jt=L.get("icon-optional"),Gt=L.get("text-allow-overlap"),ar=L.get("icon-allow-overlap"),nr=L.get("text-rotation-alignment")==="map",Rr=L.get("text-pitch-alignment")==="map",gr=L.get("icon-text-fit")!=="none",Ar=L.get("symbol-z-order")==="viewport-y",Cr=Gt&&(ar||!O.hasIconData()||jt),an=ar&&(Gt||!O.hasTextData()||Jt);!O.collisionArrays&&at&&O.deserializeCollisionBoxes(at);var Yr=function(_n,ua){if(!a[_n.crossTileID])if(nt)l.placements[_n.crossTileID]=new bu(!1,!1,!1);else{var xa,Zn=!1,Ca=!1,ia=!0,La=null,za={box:null,offscreen:null},Hi={box:null,offscreen:null},Ai=null,Ni=null,Ei=0,Bi=0,es=0;ua.textFeatureIndex?Ei=ua.textFeatureIndex:_n.useRuntimeCollisionCircles&&(Ei=_n.featureIndex),ua.verticalTextFeatureIndex&&(Bi=ua.verticalTextFeatureIndex);var ts=ua.textBox;if(ts){var vu=function(Ko){var Ao=i.WritingMode.horizontal;if(O.allowVerticalPlacement&&!Ko&&l.prevPlacement){var uo=l.prevPlacement.placedOrientations[_n.crossTileID];uo&&(l.placedOrientations[_n.crossTileID]=uo,l.markUsedOrientation(O,Ao=uo,_n))}return Ao},wu=function(Ko,Ao){if(O.allowVerticalPlacement&&_n.numVerticalGlyphVertices>0&&ua.verticalTextBox)for(var uo=0,Ns=O.writingModes;uo<Ns.length&&(Ns[uo]===i.WritingMode.vertical?(za=Ao(),Hi=za):za=Ko(),!(za&&za.box&&za.box.length));uo+=1);else za=Ko()};if(L.get("text-variable-anchor")){var hs=L.get("text-variable-anchor");if(l.prevPlacement&&l.prevPlacement.variableOffsets[_n.crossTileID]){var Hs=l.prevPlacement.variableOffsets[_n.crossTileID];hs.indexOf(Hs.anchor)>0&&(hs=hs.filter(function(ko){return ko!==Hs.anchor})).unshift(Hs.anchor)}var Ou=function(Ko,Ao,uo){for(var Ns=Ko.x2-Ko.x1,nu=Ko.y2-Ko.y1,Gl=_n.textBoxScale,Uc=gr&&!ar?Ao:null,fl={box:[],offscreen:!1},sc=Gt?2*hs.length:hs.length,hl=0;hl<sc;++hl){var ks=l.attemptAnchorPlacement(hs[hl%hs.length],Ko,Ns,nu,Gl,nr,Rr,$e,j,Nt,hl>=hs.length,_n,O,uo,Uc);if(ks&&(fl=ks.placedGlyphBoxes)&&fl.box&&fl.box.length){Zn=!0,La=ks.shift;break}}return fl};wu(function(){return Ou(ts,ua.iconBox,i.WritingMode.horizontal)},function(){var ko=ua.verticalTextBox;return O.allowVerticalPlacement&&!(za&&za.box&&za.box.length)&&_n.numVerticalGlyphVertices>0&&ko?Ou(ko,ua.verticalIconBox,i.WritingMode.vertical):{box:null,offscreen:null}}),za&&(Zn=za.box,ia=za.offscreen);var ic=vu(za&&za.box);if(!Zn&&l.prevPlacement){var tu=l.prevPlacement.variableOffsets[_n.crossTileID];tu&&(l.variableOffsets[_n.crossTileID]=tu,l.markUsedJustification(O,tu.anchor,_n,ic))}}else{var Hu=function(Ko,Ao){var uo=l.collisionIndex.placeCollisionBox(Ko,Gt,$e,j,Nt.predicate);return uo&&uo.box&&uo.box.length&&(l.markUsedOrientation(O,Ao,_n),l.placedOrientations[_n.crossTileID]=Ao),uo};wu(function(){return Hu(ts,i.WritingMode.horizontal)},function(){var ko=ua.verticalTextBox;return O.allowVerticalPlacement&&_n.numVerticalGlyphVertices>0&&ko?Hu(ko,i.WritingMode.vertical):{box:null,offscreen:null}}),vu(za&&za.box&&za.box.length)}}if(Zn=(xa=za)&&xa.box&&xa.box.length>0,ia=xa&&xa.offscreen,_n.useRuntimeCollisionCircles){var oc=O.text.placedSymbolArray.get(_n.centerJustifiedTextSymbolIndex),ru=i.evaluateSizeForFeature(O.textSizeData,Ft,oc),Mu=L.get("text-padding");Ai=l.collisionIndex.placeCollisionCircles(Gt,oc,O.lineVertexArray,O.glyphOffsetArray,ru,j,ue,Ee,n,Rr,Nt.predicate,_n.collisionCircleDiameter,Mu),Zn=Gt||Ai.circles.length>0&&!Ai.collisionDetected,ia=ia&&Ai.offscreen}if(ua.iconFeatureIndex&&(es=ua.iconFeatureIndex),ua.iconBox){var ds=function(Ko){var Ao=gr&&La?Vt(Ko,La.x,La.y,nr,Rr,l.transform.angle):Ko;return l.collisionIndex.placeCollisionBox(Ao,ar,$e,j,Nt.predicate)};Ca=Hi&&Hi.box&&Hi.box.length&&ua.verticalIconBox?(Ni=ds(ua.verticalIconBox)).box.length>0:(Ni=ds(ua.iconBox)).box.length>0,ia=ia&&Ni.offscreen}var ao=Jt||_n.numHorizontalGlyphVertices===0&&_n.numVerticalGlyphVertices===0,Zu=jt||_n.numIconVertices===0;if(ao||Zu?Zu?ao||(Ca=Ca&&Zn):Zn=Ca&&Zn:Ca=Zn=Ca&&Zn,Zn&&xa&&xa.box&&l.collisionIndex.insertCollisionBox(xa.box,L.get("text-ignore-placement"),O.bucketInstanceId,Hi&&Hi.box&&Bi?Bi:Ei,Nt.ID),Ca&&Ni&&l.collisionIndex.insertCollisionBox(Ni.box,L.get("icon-ignore-placement"),O.bucketInstanceId,es,Nt.ID),Ai&&(Zn&&l.collisionIndex.insertCollisionCircles(Ai.circles,L.get("text-ignore-placement"),O.bucketInstanceId,Ei,Nt.ID),n)){var Vl=O.bucketInstanceId,ps=l.collisionCircleArrays[Vl];ps===void 0&&(ps=l.collisionCircleArrays[Vl]=new Qo);for(var No=0;No<Ai.circles.length;No+=4)ps.circles.push(Ai.circles[No+0]),ps.circles.push(Ai.circles[No+1]),ps.circles.push(Ai.circles[No+2]),ps.circles.push(Ai.collisionDetected?1:0)}l.placements[_n.crossTileID]=new bu(Zn||Cr,Ca||an,ia||O.justReloaded),a[_n.crossTileID]=!0}};if(Ar)for(var vn=O.getSortedSymbolIndexes(this.transform.angle),Pn=vn.length-1;Pn>=0;--Pn){var qn=vn[Pn];Yr(O.symbolInstances.get(qn),O.collisionArrays[qn])}else for(var sa=s.symbolInstanceStart;sa<s.symbolInstanceEnd;sa++)Yr(O.symbolInstances.get(sa),O.collisionArrays[sa]);if(n&&O.bucketInstanceId in this.collisionCircleArrays){var Aa=this.collisionCircleArrays[O.bucketInstanceId];i.invert(Aa.invProjMatrix,j),Aa.viewportMatrix=this.collisionIndex.getViewportMatrix()}O.justReloaded=!1},Re.prototype.markUsedJustification=function(s,a,n,l){var v;v=l===i.WritingMode.vertical?n.verticalPlacedTextSymbolIndex:{left:n.leftJustifiedTextSymbolIndex,center:n.centerJustifiedTextSymbolIndex,right:n.rightJustifiedTextSymbolIndex}[i.getAnchorJustification(a)];for(var O=0,L=[n.leftJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.rightJustifiedTextSymbolIndex,n.verticalPlacedTextSymbolIndex];O<L.length;O+=1){var j=L[O];j>=0&&(s.text.placedSymbolArray.get(j).crossTileID=v>=0&&j!==v?0:n.crossTileID)}},Re.prototype.markUsedOrientation=function(s,a,n){for(var l=a===i.WritingMode.horizontal||a===i.WritingMode.horizontalOnly?a:0,v=a===i.WritingMode.vertical?a:0,O=0,L=[n.leftJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.rightJustifiedTextSymbolIndex];O<L.length;O+=1)s.text.placedSymbolArray.get(L[O]).placedOrientation=l;n.verticalPlacedTextSymbolIndex&&(s.text.placedSymbolArray.get(n.verticalPlacedTextSymbolIndex).placedOrientation=v)},Re.prototype.commit=function(s){this.commitTime=s,this.zoomAtLastRecencyCheck=this.transform.zoom;var a=this.prevPlacement,n=!1;this.prevZoomAdjustment=a?a.zoomAdjustment(this.transform.zoom):0;var l=a?a.symbolFadeChange(s):1,v=a?a.opacities:{},O=a?a.variableOffsets:{},L=a?a.placedOrientations:{};for(var j in this.placements){var ue=this.placements[j],Ee=v[j];Ee?(this.opacities[j]=new so(Ee,l,ue.text,ue.icon),n=n||ue.text!==Ee.text.placed||ue.icon!==Ee.icon.placed):(this.opacities[j]=new so(null,l,ue.text,ue.icon,ue.skipFade),n=n||ue.text||ue.icon)}for(var $e in v){var nt=v[$e];if(!this.opacities[$e]){var at=new so(nt,l,!1,!1);at.isHidden()||(this.opacities[$e]=at,n=n||nt.text.placed||nt.icon.placed)}}for(var Ft in O)this.variableOffsets[Ft]||!this.opacities[Ft]||this.opacities[Ft].isHidden()||(this.variableOffsets[Ft]=O[Ft]);for(var Nt in L)this.placedOrientations[Nt]||!this.opacities[Nt]||this.opacities[Nt].isHidden()||(this.placedOrientations[Nt]=L[Nt]);n?this.lastPlacementChangeTime=s:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=a?a.lastPlacementChangeTime:s)},Re.prototype.updateLayerOpacities=function(s,a){for(var n={},l=0,v=a;l<v.length;l+=1){var O=v[l],L=O.getBucket(s);L&&O.latestFeatureIndex&&s.id===L.layerIds[0]&&this.updateBucketOpacities(L,n,O.collisionBoxArray)}},Re.prototype.updateBucketOpacities=function(s,a,n){var l=this;s.hasTextData()&&s.text.opacityVertexArray.clear(),s.hasIconData()&&s.icon.opacityVertexArray.clear(),s.hasIconCollisionBoxData()&&s.iconCollisionBox.collisionVertexArray.clear(),s.hasTextCollisionBoxData()&&s.textCollisionBox.collisionVertexArray.clear();var v=s.layers[0].layout,O=new so(null,0,!1,!1,!0),L=v.get("text-allow-overlap"),j=v.get("icon-allow-overlap"),ue=v.get("text-variable-anchor"),Ee=v.get("text-rotation-alignment")==="map",$e=v.get("text-pitch-alignment")==="map",nt=v.get("icon-text-fit")!=="none",at=new so(null,0,L&&(j||!s.hasIconData()||v.get("icon-optional")),j&&(L||!s.hasTextData()||v.get("text-optional")),!0);!s.collisionArrays&&n&&(s.hasIconCollisionBoxData()||s.hasTextCollisionBoxData())&&s.deserializeCollisionBoxes(n);for(var Ft=function(ar,nr,Rr){for(var gr=0;gr<nr/4;gr++)ar.opacityVertexArray.emplaceBack(Rr)},Nt=function(ar){var nr=s.symbolInstances.get(ar),Rr=nr.numHorizontalGlyphVertices,gr=nr.numVerticalGlyphVertices,Ar=nr.crossTileID,Cr=l.opacities[Ar];a[Ar]?Cr=O:Cr||(l.opacities[Ar]=Cr=at),a[Ar]=!0;var an=nr.numIconVertices>0,Yr=l.placedOrientations[nr.crossTileID],vn=Yr===i.WritingMode.vertical,Pn=Yr===i.WritingMode.horizontal||Yr===i.WritingMode.horizontalOnly;if(Rr>0||gr>0){var qn=Mo(Cr.text);Ft(s.text,Rr,vn?Nu:qn),Ft(s.text,gr,Pn?Nu:qn);var sa=Cr.text.isHidden();[nr.rightJustifiedTextSymbolIndex,nr.centerJustifiedTextSymbolIndex,nr.leftJustifiedTextSymbolIndex].forEach(function(za){za>=0&&(s.text.placedSymbolArray.get(za).hidden=sa||vn?1:0)}),nr.verticalPlacedTextSymbolIndex>=0&&(s.text.placedSymbolArray.get(nr.verticalPlacedTextSymbolIndex).hidden=sa||Pn?1:0);var Aa=l.variableOffsets[nr.crossTileID];Aa&&l.markUsedJustification(s,Aa.anchor,nr,Yr);var Wa=l.placedOrientations[nr.crossTileID];Wa&&(l.markUsedJustification(s,"left",nr,Wa),l.markUsedOrientation(s,Wa,nr))}if(an){var _n=Mo(Cr.icon),ua=!(nt&&nr.verticalPlacedIconSymbolIndex&&vn);nr.placedIconSymbolIndex>=0&&(Ft(s.icon,nr.numIconVertices,ua?_n:Nu),s.icon.placedSymbolArray.get(nr.placedIconSymbolIndex).hidden=Cr.icon.isHidden()),nr.verticalPlacedIconSymbolIndex>=0&&(Ft(s.icon,nr.numVerticalIconVertices,ua?Nu:_n),s.icon.placedSymbolArray.get(nr.verticalPlacedIconSymbolIndex).hidden=Cr.icon.isHidden())}if(s.hasIconCollisionBoxData()||s.hasTextCollisionBoxData()){var xa=s.collisionArrays[ar];if(xa){var Zn=new i.Point(0,0);if(xa.textBox||xa.verticalTextBox){var Ca=!0;if(ue){var ia=l.variableOffsets[Ar];ia?(Zn=ho(ia.anchor,ia.width,ia.height,ia.textOffset,ia.textBoxScale),Ee&&Zn._rotate($e?l.transform.angle:-l.transform.angle)):Ca=!1}xa.textBox&&Dt(s.textCollisionBox.collisionVertexArray,Cr.text.placed,!Ca||vn,Zn.x,Zn.y),xa.verticalTextBox&&Dt(s.textCollisionBox.collisionVertexArray,Cr.text.placed,!Ca||Pn,Zn.x,Zn.y)}var La=Boolean(!Pn&&xa.verticalIconBox);xa.iconBox&&Dt(s.iconCollisionBox.collisionVertexArray,Cr.icon.placed,La,nt?Zn.x:0,nt?Zn.y:0),xa.verticalIconBox&&Dt(s.iconCollisionBox.collisionVertexArray,Cr.icon.placed,!La,nt?Zn.x:0,nt?Zn.y:0)}}},Jt=0;Jt<s.symbolInstances.length;Jt++)Nt(Jt);if(s.sortFeatures(this.transform.angle),this.retainedQueryData[s.bucketInstanceId]&&(this.retainedQueryData[s.bucketInstanceId].featureSortOrder=s.featureSortOrder),s.hasTextData()&&s.text.opacityVertexBuffer&&s.text.opacityVertexBuffer.updateData(s.text.opacityVertexArray),s.hasIconData()&&s.icon.opacityVertexBuffer&&s.icon.opacityVertexBuffer.updateData(s.icon.opacityVertexArray),s.hasIconCollisionBoxData()&&s.iconCollisionBox.collisionVertexBuffer&&s.iconCollisionBox.collisionVertexBuffer.updateData(s.iconCollisionBox.collisionVertexArray),s.hasTextCollisionBoxData()&&s.textCollisionBox.collisionVertexBuffer&&s.textCollisionBox.collisionVertexBuffer.updateData(s.textCollisionBox.collisionVertexArray),s.bucketInstanceId in this.collisionCircleArrays){var jt=this.collisionCircleArrays[s.bucketInstanceId];s.placementInvProjMatrix=jt.invProjMatrix,s.placementViewportMatrix=jt.viewportMatrix,s.collisionCircleArray=jt.circles,delete this.collisionCircleArrays[s.bucketInstanceId]}},Re.prototype.symbolFadeChange=function(s){return this.fadeDuration===0?1:(s-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},Re.prototype.zoomAdjustment=function(s){return Math.max(0,(this.transform.zoom-s)/1.5)},Re.prototype.hasTransitions=function(s){return this.stale||s-this.lastPlacementChangeTime<this.fadeDuration},Re.prototype.stillRecent=function(s,a){var n=this.zoomAtLastRecencyCheck===a?1-this.zoomAdjustment(a):1;return this.zoomAtLastRecencyCheck=a,this.commitTime+this.fadeDuration*n>s},Re.prototype.setStale=function(){this.stale=!0};var vr=Math.pow(2,25),en=Math.pow(2,24),Tn=Math.pow(2,17),Gn=Math.pow(2,16),Mi=Math.pow(2,9),po=Math.pow(2,8),mo=Math.pow(2,1);function Mo(s){if(s.opacity===0&&!s.placed)return 0;if(s.opacity===1&&s.placed)return 4294967295;var a=s.placed?1:0,n=Math.floor(127*s.opacity);return n*vr+a*en+n*Tn+a*Gn+n*Mi+a*po+n*mo+a}var Nu=0,Ol=function(a){this._sortAcrossTiles=a.layout.get("symbol-z-order")!=="viewport-y"&&a.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};Ol.prototype.continuePlacement=function(s,a,n,l,v){for(var O=this._bucketParts;this._currentTileIndex<s.length;)if(a.getBucketParts(O,l,s[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,v())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,O.sort(function(L,j){return L.sortKey-j.sortKey}));this._currentPartIndex<O.length;)if(a.placeLayerBucketPart(O[this._currentPartIndex],this._seenCrossTileIDs,n),this._currentPartIndex++,v())return!0;return!1};var Ts=function(a,n,l,v,O,L,j){this.placement=new Re(a,O,L,j),this._currentPlacementIndex=n.length-1,this._forceFullPlacement=l,this._showCollisionBoxes=v,this._done=!1};Ts.prototype.isDone=function(){return this._done},Ts.prototype.continuePlacement=function(s,a,n){for(var l=this,v=i.browser.now(),O=function(){var Ee=i.browser.now()-v;return!l._forceFullPlacement&&Ee>2};this._currentPlacementIndex>=0;){var L=a[s[this._currentPlacementIndex]],j=this.placement.collisionIndex.transform.zoom;if(L.type==="symbol"&&(!L.minzoom||L.minzoom<=j)&&(!L.maxzoom||L.maxzoom>j)){if(this._inProgressLayer||(this._inProgressLayer=new Ol(L)),this._inProgressLayer.continuePlacement(n[L.source],this.placement,this._showCollisionBoxes,L,O))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},Ts.prototype.commit=function(s){return this.placement.commit(s),this.placement};var pc=512/i.EXTENT/2,xu=function(a,n,l){this.tileID=a,this.indexedSymbolInstances={},this.bucketInstanceId=l;for(var v=0;v<n.length;v++){var O=n.get(v),L=O.key;this.indexedSymbolInstances[L]||(this.indexedSymbolInstances[L]=[]),this.indexedSymbolInstances[L].push({crossTileID:O.crossTileID,coord:this.getScaledCoordinates(O,a)})}};xu.prototype.getScaledCoordinates=function(s,a){var n=pc/Math.pow(2,a.canonical.z-this.tileID.canonical.z);return{x:Math.floor((a.canonical.x*i.EXTENT+s.anchorX)*n),y:Math.floor((a.canonical.y*i.EXTENT+s.anchorY)*n)}},xu.prototype.findMatches=function(s,a,n){for(var l=this.tileID.canonical.z<a.canonical.z?1:Math.pow(2,this.tileID.canonical.z-a.canonical.z),v=0;v<s.length;v++){var O=s.get(v);if(!O.crossTileID){var L=this.indexedSymbolInstances[O.key];if(L)for(var j=this.getScaledCoordinates(O,a),ue=0,Ee=L;ue<Ee.length;ue+=1){var $e=Ee[ue];if(Math.abs($e.coord.x-j.x)<=l&&Math.abs($e.coord.y-j.y)<=l&&!n[$e.crossTileID]){n[$e.crossTileID]=!0,O.crossTileID=$e.crossTileID;break}}}}};var Po=function(){this.maxCrossTileID=0};Po.prototype.generate=function(){return++this.maxCrossTileID};var ku=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};ku.prototype.handleWrapJump=function(s){var a=Math.round((s-this.lng)/360);if(a!==0)for(var n in this.indexes){var l=this.indexes[n],v={};for(var O in l){var L=l[O];L.tileID=L.tileID.unwrapTo(L.tileID.wrap+a),v[L.tileID.key]=L}this.indexes[n]=v}this.lng=s},ku.prototype.addBucket=function(s,a,n){if(this.indexes[s.overscaledZ]&&this.indexes[s.overscaledZ][s.key]){if(this.indexes[s.overscaledZ][s.key].bucketInstanceId===a.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(s.overscaledZ,this.indexes[s.overscaledZ][s.key])}for(var l=0;l<a.symbolInstances.length;l++)a.symbolInstances.get(l).crossTileID=0;this.usedCrossTileIDs[s.overscaledZ]||(this.usedCrossTileIDs[s.overscaledZ]={});var v=this.usedCrossTileIDs[s.overscaledZ];for(var O in this.indexes){var L=this.indexes[O];if(Number(O)>s.overscaledZ)for(var j in L){var ue=L[j];ue.tileID.isChildOf(s)&&ue.findMatches(a.symbolInstances,s,v)}else{var Ee=L[s.scaledTo(Number(O)).key];Ee&&Ee.findMatches(a.symbolInstances,s,v)}}for(var $e=0;$e<a.symbolInstances.length;$e++){var nt=a.symbolInstances.get($e);nt.crossTileID||(nt.crossTileID=n.generate(),v[nt.crossTileID]=!0)}return this.indexes[s.overscaledZ]===void 0&&(this.indexes[s.overscaledZ]={}),this.indexes[s.overscaledZ][s.key]=new xu(s,a.symbolInstances,a.bucketInstanceId),!0},ku.prototype.removeBucketCrossTileIDs=function(s,a){for(var n in a.indexedSymbolInstances)for(var l=0,v=a.indexedSymbolInstances[n];l<v.length;l+=1)delete this.usedCrossTileIDs[s][v[l].crossTileID]},ku.prototype.removeStaleBuckets=function(s){var a=!1;for(var n in this.indexes){var l=this.indexes[n];for(var v in l)s[l[v].bucketInstanceId]||(this.removeBucketCrossTileIDs(n,l[v]),delete l[v],a=!0)}return a};var _o=function(){this.layerIndexes={},this.crossTileIDs=new Po,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};_o.prototype.addLayer=function(s,a,n){var l=this.layerIndexes[s.id];l===void 0&&(l=this.layerIndexes[s.id]=new ku);var v=!1,O={};l.handleWrapJump(n);for(var L=0,j=a;L<j.length;L+=1){var ue=j[L],Ee=ue.getBucket(s);Ee&&s.id===Ee.layerIds[0]&&(Ee.bucketInstanceId||(Ee.bucketInstanceId=++this.maxBucketInstanceId),l.addBucket(ue.tileID,Ee,this.crossTileIDs)&&(v=!0),O[Ee.bucketInstanceId]=!0)}return l.removeStaleBuckets(O)&&(v=!0),v},_o.prototype.pruneUnusedLayers=function(s){var a={};for(var n in s.forEach(function(l){a[l]=!0}),this.layerIndexes)a[n]||delete this.layerIndexes[n]};var zi=function(a,n){return i.emitValidationErrors(a,n&&n.filter(function(l){return l.identifier!=="source.canvas"}))},Ys=i.pick(En,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Ks=i.pick(En,["setCenter","setZoom","setBearing","setPitch"]),Fs=function(){var s={},a=i.styleSpec.$version;for(var n in i.styleSpec.$root){var l,v=i.styleSpec.$root[n];v.required&&((l=n==="version"?a:v.type==="array"?[]:{})!=null&&(s[n]=l))}return s}(),Ii=function(s){function a(n,l){var v=this;l===void 0&&(l={}),s.call(this),this.map=n,this.dispatcher=new ht(tr(),this),this.imageManager=new Le,this.imageManager.setEventedParent(this),this.glyphManager=new Ie(n._requestManager,l.localIdeographFontFamily),this.lineAtlas=new Me(256,512),this.crossTileSymbolIndex=new _o,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new i.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",i.getReferrer());var O=this;this._rtlTextPluginCallback=a.registerForPluginStateChange(function(L){O.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:L.pluginStatus,pluginURL:L.pluginURL},function(j,ue){if(i.triggerPluginCompletionEvent(j),ue&&ue.every(function($e){return $e}))for(var Ee in O.sourceCaches)O.sourceCaches[Ee].reload()})}),this.on("data",function(L){if(L.dataType==="source"&&L.sourceDataType==="metadata"){var j=v.sourceCaches[L.sourceId];if(j){var ue=j.getSource();if(ue&&ue.vectorLayerIds)for(var Ee in v._layers){var $e=v._layers[Ee];$e.source===ue.id&&v._validateLayer($e)}}}})}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.loadURL=function(n,l){var v=this;l===void 0&&(l={}),this.fire(new i.Event("dataloading",{dataType:"style"}));var O=typeof l.validate=="boolean"?l.validate:!i.isMapboxURL(n);n=this.map._requestManager.normalizeStyleURL(n,l.accessToken);var L=this.map._requestManager.transformRequest(n,i.ResourceType.Style);this._request=i.getJSON(L,function(j,ue){v._request=null,j?v.fire(new i.ErrorEvent(j)):ue&&v._load(ue,O)})},a.prototype.loadJSON=function(n,l){var v=this;l===void 0&&(l={}),this.fire(new i.Event("dataloading",{dataType:"style"})),this._request=i.browser.frame(function(){v._request=null,v._load(n,l.validate!==!1)})},a.prototype.loadEmpty=function(){this.fire(new i.Event("dataloading",{dataType:"style"})),this._load(Fs,!1)},a.prototype._load=function(n,l){if(!l||!zi(this,i.validateStyle(n))){for(var v in this._loaded=!0,this.stylesheet=n,n.sources)this.addSource(v,n.sources[v],{validate:!1});n.sprite?this._loadSprite(n.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(n.glyphs);var O=dn(this.stylesheet.layers);this._order=O.map(function(Ee){return Ee.id}),this._layers={},this._serializedLayers={};for(var L=0,j=O;L<j.length;L+=1){var ue=j[L];(ue=i.createStyleLayer(ue)).setEventedParent(this,{layer:{id:ue.id}}),this._layers[ue.id]=ue,this._serializedLayers[ue.id]=ue.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new ct(this.stylesheet.light),this.fire(new i.Event("data",{dataType:"style"})),this.fire(new i.Event("style.load"))}},a.prototype._loadSprite=function(n){var l=this;this._spriteRequest=function(v,O,L){var j,ue,Ee,$e=i.browser.devicePixelRatio>1?"@2x":"",nt=i.getJSON(O.transformRequest(O.normalizeSpriteURL(v,$e,".json"),i.ResourceType.SpriteJSON),function(Nt,Jt){nt=null,Ee||(Ee=Nt,j=Jt,Ft())}),at=i.getImage(O.transformRequest(O.normalizeSpriteURL(v,$e,".png"),i.ResourceType.SpriteImage),function(Nt,Jt){at=null,Ee||(Ee=Nt,ue=Jt,Ft())});function Ft(){if(Ee)L(Ee);else if(j&&ue){var Nt=i.browser.getImageData(ue),Jt={};for(var jt in j){var Gt=j[jt],ar=Gt.width,nr=Gt.height,Rr=Gt.x,gr=Gt.y,Ar=Gt.sdf,Cr=Gt.pixelRatio,an=Gt.stretchX,Yr=Gt.stretchY,vn=Gt.content,Pn=new i.RGBAImage({width:ar,height:nr});i.RGBAImage.copy(Nt,Pn,{x:Rr,y:gr},{x:0,y:0},{width:ar,height:nr}),Jt[jt]={data:Pn,pixelRatio:Cr,sdf:Ar,stretchX:an,stretchY:Yr,content:vn}}L(null,Jt)}}return{cancel:function(){nt&&(nt.cancel(),nt=null),at&&(at.cancel(),at=null)}}}(n,this.map._requestManager,function(v,O){if(l._spriteRequest=null,v)l.fire(new i.ErrorEvent(v));else if(O)for(var L in O)l.imageManager.addImage(L,O[L]);l.imageManager.setLoaded(!0),l._availableImages=l.imageManager.listImages(),l.dispatcher.broadcast("setImages",l._availableImages),l.fire(new i.Event("data",{dataType:"style"}))})},a.prototype._validateLayer=function(n){var l=this.sourceCaches[n.source];if(l){var v=n.sourceLayer;if(v){var O=l.getSource();(O.type==="geojson"||O.vectorLayerIds&&O.vectorLayerIds.indexOf(v)===-1)&&this.fire(new i.ErrorEvent(new Error('Source layer "'+v+'" does not exist on source "'+O.id+'" as specified by style layer "'+n.id+'"')))}}},a.prototype.loaded=function(){if(!this._loaded)return!1;if(Object.keys(this._updatedSources).length)return!1;for(var n in this.sourceCaches)if(!this.sourceCaches[n].loaded())return!1;return!!this.imageManager.isLoaded()},a.prototype._serializeLayers=function(n){for(var l=[],v=0,O=n;v<O.length;v+=1){var L=this._layers[O[v]];L.type!=="custom"&&l.push(L.serialize())}return l},a.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var n in this.sourceCaches)if(this.sourceCaches[n].hasTransition())return!0;for(var l in this._layers)if(this._layers[l].hasTransition())return!0;return!1},a.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},a.prototype.update=function(n){if(this._loaded){var l=this._changed;if(this._changed){var v=Object.keys(this._updatedLayers),O=Object.keys(this._removedLayers);for(var L in(v.length||O.length)&&this._updateWorkerLayers(v,O),this._updatedSources){var j=this._updatedSources[L];j==="reload"?this._reloadSource(L):j==="clear"&&this._clearSource(L)}for(var ue in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[ue].updateTransitions(n);this.light.updateTransitions(n),this._resetUpdates()}var Ee={};for(var $e in this.sourceCaches){var nt=this.sourceCaches[$e];Ee[$e]=nt.used,nt.used=!1}for(var at=0,Ft=this._order;at<Ft.length;at+=1){var Nt=this._layers[Ft[at]];Nt.recalculate(n,this._availableImages),!Nt.isHidden(n.zoom)&&Nt.source&&(this.sourceCaches[Nt.source].used=!0)}for(var Jt in Ee){var jt=this.sourceCaches[Jt];Ee[Jt]!==jt.used&&jt.fire(new i.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:Jt}))}this.light.recalculate(n),this.z=n.zoom,l&&this.fire(new i.Event("data",{dataType:"style"}))}},a.prototype._updateTilesForChangedImages=function(){var n=Object.keys(this._changedImages);if(n.length){for(var l in this.sourceCaches)this.sourceCaches[l].reloadTilesForDependencies(["icons","patterns"],n);this._changedImages={}}},a.prototype._updateWorkerLayers=function(n,l){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(n),removedIds:l})},a.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},a.prototype.setState=function(n){var l=this;if(this._checkLoaded(),zi(this,i.validateStyle(n)))return!1;(n=i.clone$1(n)).layers=dn(n.layers);var v=function(L,j){if(!L)return[{command:En.setStyle,args:[j]}];var ue=[];try{if(!i.deepEqual(L.version,j.version))return[{command:En.setStyle,args:[j]}];i.deepEqual(L.center,j.center)||ue.push({command:En.setCenter,args:[j.center]}),i.deepEqual(L.zoom,j.zoom)||ue.push({command:En.setZoom,args:[j.zoom]}),i.deepEqual(L.bearing,j.bearing)||ue.push({command:En.setBearing,args:[j.bearing]}),i.deepEqual(L.pitch,j.pitch)||ue.push({command:En.setPitch,args:[j.pitch]}),i.deepEqual(L.sprite,j.sprite)||ue.push({command:En.setSprite,args:[j.sprite]}),i.deepEqual(L.glyphs,j.glyphs)||ue.push({command:En.setGlyphs,args:[j.glyphs]}),i.deepEqual(L.transition,j.transition)||ue.push({command:En.setTransition,args:[j.transition]}),i.deepEqual(L.light,j.light)||ue.push({command:En.setLight,args:[j.light]});var Ee={},$e=[];!function(at,Ft,Nt,Jt){var jt;for(jt in Ft=Ft||{},at=at||{})at.hasOwnProperty(jt)&&(Ft.hasOwnProperty(jt)||gn(jt,Nt,Jt));for(jt in Ft)Ft.hasOwnProperty(jt)&&(at.hasOwnProperty(jt)?i.deepEqual(at[jt],Ft[jt])||(at[jt].type==="geojson"&&Ft[jt].type==="geojson"&&Ga(at,Ft,jt)?Nt.push({command:En.setGeoJSONSourceData,args:[jt,Ft[jt].data]}):Mn(jt,Ft,Nt,Jt)):bn(jt,Ft,Nt))}(L.sources,j.sources,$e,Ee);var nt=[];L.layers&&L.layers.forEach(function(at){Ee[at.source]?ue.push({command:En.removeLayer,args:[at.id]}):nt.push(at)}),ue=ue.concat($e),function(at,Ft,Nt){Ft=Ft||[];var Jt,jt,Gt,ar,nr,Rr,gr,Ar=(at=at||[]).map(Ma),Cr=Ft.map(Ma),an=at.reduce(Ia,{}),Yr=Ft.reduce(Ia,{}),vn=Ar.slice(),Pn=Object.create(null);for(Jt=0,jt=0;Jt<Ar.length;Jt++)Yr.hasOwnProperty(Gt=Ar[Jt])?jt++:(Nt.push({command:En.removeLayer,args:[Gt]}),vn.splice(vn.indexOf(Gt,jt),1));for(Jt=0,jt=0;Jt<Cr.length;Jt++)vn[vn.length-1-Jt]!==(Gt=Cr[Cr.length-1-Jt])&&(an.hasOwnProperty(Gt)?(Nt.push({command:En.removeLayer,args:[Gt]}),vn.splice(vn.lastIndexOf(Gt,vn.length-jt),1)):jt++,Nt.push({command:En.addLayer,args:[Yr[Gt],Rr=vn[vn.length-Jt]]}),vn.splice(vn.length-Jt,0,Gt),Pn[Gt]=!0);for(Jt=0;Jt<Cr.length;Jt++)if(ar=an[Gt=Cr[Jt]],nr=Yr[Gt],!Pn[Gt]&&!i.deepEqual(ar,nr))if(i.deepEqual(ar.source,nr.source)&&i.deepEqual(ar["source-layer"],nr["source-layer"])&&i.deepEqual(ar.type,nr.type)){for(gr in ga(ar.layout,nr.layout,Nt,Gt,null,En.setLayoutProperty),ga(ar.paint,nr.paint,Nt,Gt,null,En.setPaintProperty),i.deepEqual(ar.filter,nr.filter)||Nt.push({command:En.setFilter,args:[Gt,nr.filter]}),i.deepEqual(ar.minzoom,nr.minzoom)&&i.deepEqual(ar.maxzoom,nr.maxzoom)||Nt.push({command:En.setLayerZoomRange,args:[Gt,nr.minzoom,nr.maxzoom]}),ar)ar.hasOwnProperty(gr)&&gr!=="layout"&&gr!=="paint"&&gr!=="filter"&&gr!=="metadata"&&gr!=="minzoom"&&gr!=="maxzoom"&&(gr.indexOf("paint.")===0?ga(ar[gr],nr[gr],Nt,Gt,gr.slice(6),En.setPaintProperty):i.deepEqual(ar[gr],nr[gr])||Nt.push({command:En.setLayerProperty,args:[Gt,gr,nr[gr]]}));for(gr in nr)nr.hasOwnProperty(gr)&&!ar.hasOwnProperty(gr)&&gr!=="layout"&&gr!=="paint"&&gr!=="filter"&&gr!=="metadata"&&gr!=="minzoom"&&gr!=="maxzoom"&&(gr.indexOf("paint.")===0?ga(ar[gr],nr[gr],Nt,Gt,gr.slice(6),En.setPaintProperty):i.deepEqual(ar[gr],nr[gr])||Nt.push({command:En.setLayerProperty,args:[Gt,gr,nr[gr]]}))}else Nt.push({command:En.removeLayer,args:[Gt]}),Rr=vn[vn.lastIndexOf(Gt)+1],Nt.push({command:En.addLayer,args:[nr,Rr]})}(nt,j.layers,ue)}catch(at){console.warn("Unable to compute style diff:",at),ue=[{command:En.setStyle,args:[j]}]}return ue}(this.serialize(),n).filter(function(L){return!(L.command in Ks)});if(v.length===0)return!1;var O=v.filter(function(L){return!(L.command in Ys)});if(O.length>0)throw new Error("Unimplemented: "+O.map(function(L){return L.command}).join(", ")+".");return v.forEach(function(L){L.command!=="setTransition"&&l[L.command].apply(l,L.args)}),this.stylesheet=n,!0},a.prototype.addImage=function(n,l){if(this.getImage(n))return this.fire(new i.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(n,l),this._afterImageUpdated(n)},a.prototype.updateImage=function(n,l){this.imageManager.updateImage(n,l)},a.prototype.getImage=function(n){return this.imageManager.getImage(n)},a.prototype.removeImage=function(n){if(!this.getImage(n))return this.fire(new i.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(n),this._afterImageUpdated(n)},a.prototype._afterImageUpdated=function(n){this._availableImages=this.imageManager.listImages(),this._changedImages[n]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new i.Event("data",{dataType:"style"}))},a.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},a.prototype.addSource=function(n,l,v){var O=this;if(v===void 0&&(v={}),this._checkLoaded(),this.sourceCaches[n]!==void 0)throw new Error("There is already a source with this ID");if(!l.type)throw new Error("The type property must be defined, but only the following properties were given: "+Object.keys(l).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(l.type)>=0&&this._validate(i.validateStyle.source,"sources."+n,l,null,v))){this.map&&this.map._collectResourceTiming&&(l.collectResourceTiming=!0);var L=this.sourceCaches[n]=new Rt(n,l,this.dispatcher);L.style=this,L.setEventedParent(this,function(){return{isSourceLoaded:O.loaded(),source:L.serialize(),sourceId:n}}),L.onAdd(this.map),this._changed=!0}},a.prototype.removeSource=function(n){if(this._checkLoaded(),this.sourceCaches[n]===void 0)throw new Error("There is no source with this ID");for(var l in this._layers)if(this._layers[l].source===n)return this.fire(new i.ErrorEvent(new Error('Source "'+n+'" cannot be removed while layer "'+l+'" is using it.')));var v=this.sourceCaches[n];delete this.sourceCaches[n],delete this._updatedSources[n],v.fire(new i.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:n})),v.setEventedParent(null),v.clearTiles(),v.onRemove&&v.onRemove(this.map),this._changed=!0},a.prototype.setGeoJSONSourceData=function(n,l){this._checkLoaded(),this.sourceCaches[n].getSource().setData(l),this._changed=!0},a.prototype.getSource=function(n){return this.sourceCaches[n]&&this.sourceCaches[n].getSource()},a.prototype.addLayer=function(n,l,v){v===void 0&&(v={}),this._checkLoaded();var O=n.id;if(this.getLayer(O))this.fire(new i.ErrorEvent(new Error('Layer with id "'+O+'" already exists on this map')));else{var L;if(n.type==="custom"){if(zi(this,i.validateCustomStyleLayer(n)))return;L=i.createStyleLayer(n)}else{if(typeof n.source=="object"&&(this.addSource(O,n.source),n=i.clone$1(n),n=i.extend(n,{source:O})),this._validate(i.validateStyle.layer,"layers."+O,n,{arrayIndex:-1},v))return;L=i.createStyleLayer(n),this._validateLayer(L),L.setEventedParent(this,{layer:{id:O}}),this._serializedLayers[L.id]=L.serialize()}var j=l?this._order.indexOf(l):this._order.length;if(l&&j===-1)this.fire(new i.ErrorEvent(new Error('Layer with id "'+l+'" does not exist on this map.')));else{if(this._order.splice(j,0,O),this._layerOrderChanged=!0,this._layers[O]=L,this._removedLayers[O]&&L.source&&L.type!=="custom"){var ue=this._removedLayers[O];delete this._removedLayers[O],ue.type!==L.type?this._updatedSources[L.source]="clear":(this._updatedSources[L.source]="reload",this.sourceCaches[L.source].pause())}this._updateLayer(L),L.onAdd&&L.onAdd(this.map)}}},a.prototype.moveLayer=function(n,l){if(this._checkLoaded(),this._changed=!0,this._layers[n]){if(n!==l){var v=this._order.indexOf(n);this._order.splice(v,1);var O=l?this._order.indexOf(l):this._order.length;l&&O===-1?this.fire(new i.ErrorEvent(new Error('Layer with id "'+l+'" does not exist on this map.'))):(this._order.splice(O,0,n),this._layerOrderChanged=!0)}}else this.fire(new i.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot be moved.")))},a.prototype.removeLayer=function(n){this._checkLoaded();var l=this._layers[n];if(l){l.setEventedParent(null);var v=this._order.indexOf(n);this._order.splice(v,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[n]=l,delete this._layers[n],delete this._serializedLayers[n],delete this._updatedLayers[n],delete this._updatedPaintProps[n],l.onRemove&&l.onRemove(this.map)}else this.fire(new i.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot be removed.")))},a.prototype.getLayer=function(n){return this._layers[n]},a.prototype.hasLayer=function(n){return n in this._layers},a.prototype.setLayerZoomRange=function(n,l,v){this._checkLoaded();var O=this.getLayer(n);O?O.minzoom===l&&O.maxzoom===v||(l!=null&&(O.minzoom=l),v!=null&&(O.maxzoom=v),this._updateLayer(O)):this.fire(new i.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot have zoom extent.")))},a.prototype.setFilter=function(n,l,v){v===void 0&&(v={}),this._checkLoaded();var O=this.getLayer(n);if(O){if(!i.deepEqual(O.filter,l))return l==null?(O.filter=void 0,void this._updateLayer(O)):void(this._validate(i.validateStyle.filter,"layers."+O.id+".filter",l,null,v)||(O.filter=i.clone$1(l),this._updateLayer(O)))}else this.fire(new i.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot be filtered.")))},a.prototype.getFilter=function(n){return i.clone$1(this.getLayer(n).filter)},a.prototype.setLayoutProperty=function(n,l,v,O){O===void 0&&(O={}),this._checkLoaded();var L=this.getLayer(n);L?i.deepEqual(L.getLayoutProperty(l),v)||(L.setLayoutProperty(l,v,O),this._updateLayer(L)):this.fire(new i.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot be styled.")))},a.prototype.getLayoutProperty=function(n,l){var v=this.getLayer(n);if(v)return v.getLayoutProperty(l);this.fire(new i.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style.")))},a.prototype.setPaintProperty=function(n,l,v,O){O===void 0&&(O={}),this._checkLoaded();var L=this.getLayer(n);L?i.deepEqual(L.getPaintProperty(l),v)||(L.setPaintProperty(l,v,O)&&this._updateLayer(L),this._changed=!0,this._updatedPaintProps[n]=!0):this.fire(new i.ErrorEvent(new Error("The layer '"+n+"' does not exist in the map's style and cannot be styled.")))},a.prototype.getPaintProperty=function(n,l){return this.getLayer(n).getPaintProperty(l)},a.prototype.setFeatureState=function(n,l){this._checkLoaded();var v=n.source,O=n.sourceLayer,L=this.sourceCaches[v];if(L!==void 0){var j=L.getSource().type;j==="geojson"&&O?this.fire(new i.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):j!=="vector"||O?(n.id===void 0&&this.fire(new i.ErrorEvent(new Error("The feature id parameter must be provided."))),L.setFeatureState(O,n.id,l)):this.fire(new i.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new i.ErrorEvent(new Error("The source '"+v+"' does not exist in the map's style.")))},a.prototype.removeFeatureState=function(n,l){this._checkLoaded();var v=n.source,O=this.sourceCaches[v];if(O!==void 0){var L=O.getSource().type,j=L==="vector"?n.sourceLayer:void 0;L!=="vector"||j?l&&typeof n.id!="string"&&typeof n.id!="number"?this.fire(new i.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):O.removeFeatureState(j,n.id,l):this.fire(new i.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new i.ErrorEvent(new Error("The source '"+v+"' does not exist in the map's style.")))},a.prototype.getFeatureState=function(n){this._checkLoaded();var l=n.source,v=n.sourceLayer,O=this.sourceCaches[l];if(O!==void 0){if(O.getSource().type!=="vector"||v)return n.id===void 0&&this.fire(new i.ErrorEvent(new Error("The feature id parameter must be provided."))),O.getFeatureState(v,n.id);this.fire(new i.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new i.ErrorEvent(new Error("The source '"+l+"' does not exist in the map's style.")))},a.prototype.getTransition=function(){return i.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},a.prototype.serialize=function(){return i.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:i.mapObject(this.sourceCaches,function(n){return n.serialize()}),layers:this._serializeLayers(this._order)},function(n){return n!==void 0})},a.prototype._updateLayer=function(n){this._updatedLayers[n.id]=!0,n.source&&!this._updatedSources[n.source]&&this.sourceCaches[n.source].getSource().type!=="raster"&&(this._updatedSources[n.source]="reload",this.sourceCaches[n.source].pause()),this._changed=!0},a.prototype._flattenAndSortRenderedFeatures=function(n){for(var l=this,v=function(Yr){return l._layers[Yr].type==="fill-extrusion"},O={},L=[],j=this._order.length-1;j>=0;j--){var ue=this._order[j];if(v(ue)){O[ue]=j;for(var Ee=0,$e=n;Ee<$e.length;Ee+=1){var nt=$e[Ee][ue];if(nt)for(var at=0,Ft=nt;at<Ft.length;at+=1)L.push(Ft[at])}}}L.sort(function(an,Yr){return Yr.intersectionZ-an.intersectionZ});for(var Nt=[],Jt=this._order.length-1;Jt>=0;Jt--){var jt=this._order[Jt];if(v(jt))for(var Gt=L.length-1;Gt>=0;Gt--){var ar=L[Gt].feature;if(O[ar.layer.id]<Jt)break;Nt.push(ar),L.pop()}else for(var nr=0,Rr=n;nr<Rr.length;nr+=1){var gr=Rr[nr][jt];if(gr)for(var Ar=0,Cr=gr;Ar<Cr.length;Ar+=1)Nt.push(Cr[Ar].feature)}}return Nt},a.prototype.queryRenderedFeatures=function(n,l,v){l&&l.filter&&this._validate(i.validateStyle.filter,"queryRenderedFeatures.filter",l.filter,null,l);var O={};if(l&&l.layers){if(!Array.isArray(l.layers))return this.fire(new i.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var L=0,j=l.layers;L<j.length;L+=1){var ue=j[L],Ee=this._layers[ue];if(!Ee)return this.fire(new i.ErrorEvent(new Error("The layer '"+ue+"' does not exist in the map's style and cannot be queried for features."))),[];O[Ee.source]=!0}}var $e=[];for(var nt in l.availableImages=this._availableImages,this.sourceCaches)l.layers&&!O[nt]||$e.push(Pt(this.sourceCaches[nt],this._layers,this._serializedLayers,n,l,v));return this.placement&&$e.push(function(at,Ft,Nt,Jt,jt,Gt,ar){for(var nr={},Rr=Gt.queryRenderedSymbols(Jt),gr=[],Ar=0,Cr=Object.keys(Rr).map(Number);Ar<Cr.length;Ar+=1)gr.push(ar[Cr[Ar]]);gr.sort(me);for(var an=function(){var Aa=vn[Yr],Wa=Aa.featureIndex.lookupSymbolFeatures(Rr[Aa.bucketInstanceId],Ft,Aa.bucketIndex,Aa.sourceLayerIndex,jt.filter,jt.layers,jt.availableImages,at);for(var _n in Wa){var ua=nr[_n]=nr[_n]||[],xa=Wa[_n];xa.sort(function(ia,La){var za=Aa.featureSortOrder;if(za){var Hi=za.indexOf(ia.featureIndex);return za.indexOf(La.featureIndex)-Hi}return La.featureIndex-ia.featureIndex});for(var Zn=0,Ca=xa;Zn<Ca.length;Zn+=1)ua.push(Ca[Zn])}},Yr=0,vn=gr;Yr<vn.length;Yr+=1)an();var Pn=function(Aa){nr[Aa].forEach(function(Wa){var _n=Wa.feature,ua=Nt[at[Aa].source].getFeatureState(_n.layer["source-layer"],_n.id);_n.source=_n.layer.source,_n.layer["source-layer"]&&(_n.sourceLayer=_n.layer["source-layer"]),_n.state=ua})};for(var qn in nr)Pn(qn);return nr}(this._layers,this._serializedLayers,this.sourceCaches,n,l,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures($e)},a.prototype.querySourceFeatures=function(n,l){l&&l.filter&&this._validate(i.validateStyle.filter,"querySourceFeatures.filter",l.filter,null,l);var v=this.sourceCaches[n];return v?function(O,L){for(var j=O.getRenderableIds().map(function(Ft){return O.getTileByID(Ft)}),ue=[],Ee={},$e=0;$e<j.length;$e++){var nt=j[$e],at=nt.tileID.canonical.key;Ee[at]||(Ee[at]=!0,nt.querySourceFeatures(ue,L))}return ue}(v,l):[]},a.prototype.addSourceType=function(n,l,v){return a.getSourceType(n)?v(new Error('A source type called "'+n+'" already exists.')):(a.setSourceType(n,l),l.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:n,url:l.workerSourceURL},v):v(null,null))},a.prototype.getLight=function(){return this.light.getLight()},a.prototype.setLight=function(n,l){l===void 0&&(l={}),this._checkLoaded();var v=this.light.getLight(),O=!1;for(var L in n)if(!i.deepEqual(n[L],v[L])){O=!0;break}if(O){var j={now:i.browser.now(),transition:i.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(n,l),this.light.updateTransitions(j)}},a.prototype._validate=function(n,l,v,O,L){return L===void 0&&(L={}),(!L||L.validate!==!1)&&zi(this,n.call(i.validateStyle,i.extend({key:l,style:this.serialize(),value:v,styleSpec:i.styleSpec},O)))},a.prototype._remove=function(){for(var n in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),i.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[n].setEventedParent(null);for(var l in this.sourceCaches)this.sourceCaches[l].clearTiles(),this.sourceCaches[l].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},a.prototype._clearSource=function(n){this.sourceCaches[n].clearTiles()},a.prototype._reloadSource=function(n){this.sourceCaches[n].resume(),this.sourceCaches[n].reload()},a.prototype._updateSources=function(n){for(var l in this.sourceCaches)this.sourceCaches[l].update(n)},a.prototype._generateCollisionBoxes=function(){for(var n in this.sourceCaches)this._reloadSource(n)},a.prototype._updatePlacement=function(n,l,v,O,L){L===void 0&&(L=!1);for(var j=!1,ue=!1,Ee={},$e=0,nt=this._order;$e<nt.length;$e+=1){var at=this._layers[nt[$e]];if(at.type==="symbol"){if(!Ee[at.source]){var Ft=this.sourceCaches[at.source];Ee[at.source]=Ft.getRenderableIds(!0).map(function(ar){return Ft.getTileByID(ar)}).sort(function(ar,nr){return nr.tileID.overscaledZ-ar.tileID.overscaledZ||(ar.tileID.isLessThan(nr.tileID)?-1:1)})}var Nt=this.crossTileSymbolIndex.addLayer(at,Ee[at.source],n.center.lng);j=j||Nt}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((L=L||this._layerOrderChanged||v===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(i.browser.now(),n.zoom))&&(this.pauseablePlacement=new Ts(n,this._order,L,l,v,O,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,Ee),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(i.browser.now()),ue=!0),j&&this.pauseablePlacement.placement.setStale()),ue||j)for(var Jt=0,jt=this._order;Jt<jt.length;Jt+=1){var Gt=this._layers[jt[Jt]];Gt.type==="symbol"&&this.placement.updateLayerOpacities(Gt,Ee[Gt.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(i.browser.now())},a.prototype._releaseSymbolFadeTiles=function(){for(var n in this.sourceCaches)this.sourceCaches[n].releaseSymbolFadeTiles()},a.prototype.getImages=function(n,l,v){this.imageManager.getImages(l.icons,v),this._updateTilesForChangedImages();var O=this.sourceCaches[l.source];O&&O.setDependencies(l.tileID.key,l.type,l.icons)},a.prototype.getGlyphs=function(n,l,v){this.glyphManager.getGlyphs(l.stacks,v)},a.prototype.getResource=function(n,l,v){return i.makeRequest(l,v)},a}(i.Evented);Ii.getSourceType=function(s){return it[s]},Ii.setSourceType=function(s,a){it[s]=a},Ii.registerForPluginStateChange=i.registerForPluginStateChange;var Gi=i.createLayout([{name:"a_pos",type:"Int16",components:2}]),_s=pi(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}`),ml=pi(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),$u=pi(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),It=pi(`varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),fr=pi("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Pr=pi(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),Wn=pi(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),Ya=pi("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),xi=pi("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),Ki=pi("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),Ka=pi(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),Di=pi(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),Yo=pi(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),Ps=pi(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),gi=pi(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),Ml=pi(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),$s=pi(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),Ss=pi(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),vl=pi(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),cu=pi(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),Eu=pi(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),fu=pi(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),ju=pi(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),Js=pi(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}`),Mc=pi(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),hf=pi(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`);function pi(s,a){var n=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,l=a.match(/attribute ([\w]+) ([\w]+)/g),v=s.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),O=a.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),L=O?O.concat(v):v,j={};return{fragmentSource:s=s.replace(n,function(ue,Ee,$e,nt,at){return j[at]=!0,Ee==="define"?`
#ifndef HAS_UNIFORM_u_`+at+`
varying `+$e+" "+nt+" "+at+`;
#else
uniform `+$e+" "+nt+" u_"+at+`;
#endif
`:`
#ifdef HAS_UNIFORM_u_`+at+`
    `+$e+" "+nt+" "+at+" = u_"+at+`;
#endif
`}),vertexSource:a=a.replace(n,function(ue,Ee,$e,nt,at){var Ft=nt==="float"?"vec2":"vec4",Nt=at.match(/color/)?"color":Ft;return j[at]?Ee==="define"?`
#ifndef HAS_UNIFORM_u_`+at+`
uniform lowp float u_`+at+`_t;
attribute `+$e+" "+Ft+" a_"+at+`;
varying `+$e+" "+nt+" "+at+`;
#else
uniform `+$e+" "+nt+" u_"+at+`;
#endif
`:Nt==="vec4"?`
#ifndef HAS_UNIFORM_u_`+at+`
    `+at+" = a_"+at+`;
#else
    `+$e+" "+nt+" "+at+" = u_"+at+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+at+`
    `+at+" = unpack_mix_"+Nt+"(a_"+at+", u_"+at+`_t);
#else
    `+$e+" "+nt+" "+at+" = u_"+at+`;
#endif
`:Ee==="define"?`
#ifndef HAS_UNIFORM_u_`+at+`
uniform lowp float u_`+at+`_t;
attribute `+$e+" "+Ft+" a_"+at+`;
#else
uniform `+$e+" "+nt+" u_"+at+`;
#endif
`:Nt==="vec4"?`
#ifndef HAS_UNIFORM_u_`+at+`
    `+$e+" "+nt+" "+at+" = a_"+at+`;
#else
    `+$e+" "+nt+" "+at+" = u_"+at+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+at+`
    `+$e+" "+nt+" "+at+" = unpack_mix_"+Nt+"(a_"+at+", u_"+at+`_t);
#else
    `+$e+" "+nt+" "+at+" = u_"+at+`;
#endif
`}),staticAttributes:l,staticUniforms:L}}var Pc=Object.freeze({__proto__:null,prelude:_s,background:ml,backgroundPattern:$u,circle:It,clippingMask:fr,heatmap:Pr,heatmapTexture:Wn,collisionBox:Ya,collisionCircle:xi,debug:Ki,fill:Ka,fillOutline:Di,fillOutlinePattern:Yo,fillPattern:Ps,fillExtrusion:gi,fillExtrusionPattern:Ml,hillshadePrepare:$s,hillshade:Ss,line:vl,lineGradient:cu,linePattern:Eu,lineSDF:fu,raster:ju,symbolIcon:Js,symbolSDF:Mc,symbolTextAndIcon:hf}),mc=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};function $c(s){for(var a=[],n=0;n<s.length;n++)if(s[n]!==null){var l=s[n].split(" ");a.push(l.pop())}return a}mc.prototype.bind=function(s,a,n,l,v,O,L,j){this.context=s;for(var ue=this.boundPaintVertexBuffers.length!==l.length,Ee=0;!ue&&Ee<l.length;Ee++)this.boundPaintVertexBuffers[Ee]!==l[Ee]&&(ue=!0);s.extVertexArrayObject&&this.vao&&this.boundProgram===a&&this.boundLayoutVertexBuffer===n&&!ue&&this.boundIndexBuffer===v&&this.boundVertexOffset===O&&this.boundDynamicVertexBuffer===L&&this.boundDynamicVertexBuffer2===j?(s.bindVertexArrayOES.set(this.vao),L&&L.bind(),v&&v.dynamicDraw&&v.bind(),j&&j.bind()):this.freshBind(a,n,l,v,O,L,j)},mc.prototype.freshBind=function(s,a,n,l,v,O,L){var j,ue=s.numAttributes,Ee=this.context,$e=Ee.gl;if(Ee.extVertexArrayObject)this.vao&&this.destroy(),this.vao=Ee.extVertexArrayObject.createVertexArrayOES(),Ee.bindVertexArrayOES.set(this.vao),j=0,this.boundProgram=s,this.boundLayoutVertexBuffer=a,this.boundPaintVertexBuffers=n,this.boundIndexBuffer=l,this.boundVertexOffset=v,this.boundDynamicVertexBuffer=O,this.boundDynamicVertexBuffer2=L;else{j=Ee.currentNumAttributes||0;for(var nt=ue;nt<j;nt++)$e.disableVertexAttribArray(nt)}a.enableAttributes($e,s);for(var at=0,Ft=n;at<Ft.length;at+=1)Ft[at].enableAttributes($e,s);O&&O.enableAttributes($e,s),L&&L.enableAttributes($e,s),a.bind(),a.setVertexAttribPointers($e,s,v);for(var Nt=0,Jt=n;Nt<Jt.length;Nt+=1){var jt=Jt[Nt];jt.bind(),jt.setVertexAttribPointers($e,s,v)}O&&(O.bind(),O.setVertexAttribPointers($e,s,v)),l&&l.bind(),L&&(L.bind(),L.setVertexAttribPointers($e,s,v)),Ee.currentNumAttributes=ue},mc.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var gl=function(a,n,l,v,O,L){var j=a.gl;this.program=j.createProgram();for(var ue=$c(l.staticAttributes),Ee=v?v.getBinderAttributes():[],$e=ue.concat(Ee),nt=l.staticUniforms?$c(l.staticUniforms):[],at=v?v.getBinderUniforms():[],Ft=[],Nt=0,Jt=nt.concat(at);Nt<Jt.length;Nt+=1){var jt=Jt[Nt];Ft.indexOf(jt)<0&&Ft.push(jt)}var Gt=v?v.defines():[];L&&Gt.push("#define OVERDRAW_INSPECTOR;");var ar=Gt.concat(_s.fragmentSource,l.fragmentSource).join(`
`),nr=Gt.concat(_s.vertexSource,l.vertexSource).join(`
`),Rr=j.createShader(j.FRAGMENT_SHADER);if(j.isContextLost())this.failedToCreate=!0;else{j.shaderSource(Rr,ar),j.compileShader(Rr),j.attachShader(this.program,Rr);var gr=j.createShader(j.VERTEX_SHADER);if(j.isContextLost())this.failedToCreate=!0;else{j.shaderSource(gr,nr),j.compileShader(gr),j.attachShader(this.program,gr),this.attributes={};var Ar={};this.numAttributes=$e.length;for(var Cr=0;Cr<this.numAttributes;Cr++)$e[Cr]&&(j.bindAttribLocation(this.program,Cr,$e[Cr]),this.attributes[$e[Cr]]=Cr);j.linkProgram(this.program),j.deleteShader(gr),j.deleteShader(Rr);for(var an=0;an<Ft.length;an++){var Yr=Ft[an];if(Yr&&!Ar[Yr]){var vn=j.getUniformLocation(this.program,Yr);vn&&(Ar[Yr]=vn)}}this.fixedUniforms=O(a,Ar),this.binderUniforms=v?v.getUniforms(a,Ar):[]}}};function Jc(s,a,n){var l=1/Za(n,1,a.transform.tileZoom),v=Math.pow(2,n.tileID.overscaledZ),O=n.tileSize*Math.pow(2,a.transform.tileZoom)/v,L=O*(n.tileID.canonical.x+n.tileID.wrap*v),j=O*n.tileID.canonical.y;return{u_image:0,u_texsize:n.imageAtlasTexture.size,u_scale:[l,s.fromScale,s.toScale],u_fade:s.t,u_pixel_coord_upper:[L>>16,j>>16],u_pixel_coord_lower:[65535&L,65535&j]}}gl.prototype.draw=function(s,a,n,l,v,O,L,j,ue,Ee,$e,nt,at,Ft,Nt,Jt){var jt,Gt=s.gl;if(!this.failedToCreate){for(var ar in s.program.set(this.program),s.setDepthMode(n),s.setStencilMode(l),s.setColorMode(v),s.setCullFace(O),this.fixedUniforms)this.fixedUniforms[ar].set(L[ar]);Ft&&Ft.setUniforms(s,this.binderUniforms,nt,{zoom:at});for(var nr=(jt={},jt[Gt.LINES]=2,jt[Gt.TRIANGLES]=3,jt[Gt.LINE_STRIP]=1,jt)[a],Rr=0,gr=$e.get();Rr<gr.length;Rr+=1){var Ar=gr[Rr],Cr=Ar.vaos||(Ar.vaos={});(Cr[j]||(Cr[j]=new mc)).bind(s,this,ue,Ft?Ft.getPaintVertexBuffers():[],Ee,Ar.vertexOffset,Nt,Jt),Gt.drawElements(a,Ar.primitiveLength*nr,Gt.UNSIGNED_SHORT,Ar.primitiveOffset*nr*2)}}};var $i=function(a,n,l,v){var O=n.style.light,L=O.properties.get("position"),j=[L.x,L.y,L.z],ue=i.create$1();O.properties.get("anchor")==="viewport"&&i.fromRotation(ue,-n.transform.angle),i.transformMat3(j,j,ue);var Ee=O.properties.get("color");return{u_matrix:a,u_lightpos:j,u_lightintensity:O.properties.get("intensity"),u_lightcolor:[Ee.r,Ee.g,Ee.b],u_vertical_gradient:+l,u_opacity:v}},Tu=function(a,n,l,v,O,L,j){return i.extend($i(a,n,l,v),Jc(L,n,j),{u_height_factor:-Math.pow(2,O.overscaledZ)/j.tileSize/8})},yl=function(a){return{u_matrix:a}},os=function(a,n,l,v){return i.extend(yl(a),Jc(l,n,v))},Lc=function(a,n){return{u_matrix:a,u_world:n}},vc=function(a,n,l,v,O){return i.extend(os(a,n,l,v),{u_world:O})},Pl=function(a,n,l,v){var O,L,j=a.transform;if(v.paint.get("circle-pitch-alignment")==="map"){var ue=Za(l,1,j.zoom);O=!0,L=[ue,ue]}else O=!1,L=j.pixelsToGLUnits;return{u_camera_to_center_distance:j.cameraToCenterDistance,u_scale_with_map:+(v.paint.get("circle-pitch-scale")==="map"),u_matrix:a.translatePosMatrix(n.posMatrix,l,v.paint.get("circle-translate"),v.paint.get("circle-translate-anchor")),u_pitch_with_map:+O,u_device_pixel_ratio:i.browser.devicePixelRatio,u_extrude_scale:L}},Ju=function(a,n,l){var v=Za(l,1,n.zoom),O=Math.pow(2,n.zoom-l.tileID.overscaledZ),L=l.tileID.overscaleFactor();return{u_matrix:a,u_camera_to_center_distance:n.cameraToCenterDistance,u_pixels_to_tile_units:v,u_extrude_scale:[n.pixelsToGLUnits[0]/(v*O),n.pixelsToGLUnits[1]/(v*O)],u_overscale_factor:L}},Rc=function(a,n,l){return{u_matrix:a,u_inv_matrix:n,u_camera_to_center_distance:l.cameraToCenterDistance,u_viewport_size:[l.width,l.height]}},hu=function(a,n,l){return l===void 0&&(l=1),{u_matrix:a,u_color:n,u_overlay:0,u_overlay_scale:l}},_u=function(a){return{u_matrix:a}},Qc=function(a,n,l,v){return{u_matrix:a,u_extrude_scale:Za(n,1,l),u_intensity:v}},Yl=function(a,n,l){var v=a.transform;return{u_matrix:Ic(a,n,l),u_ratio:1/Za(n,1,v.zoom),u_device_pixel_ratio:i.browser.devicePixelRatio,u_units_to_pixels:[1/v.pixelsToGLUnits[0],1/v.pixelsToGLUnits[1]]}},Si=function(a,n,l,v){return i.extend(Yl(a,n,l),{u_image:0,u_image_height:v})},qc=function(a,n,l,v){var O=a.transform,L=Kl(n,O);return{u_matrix:Ic(a,n,l),u_texsize:n.imageAtlasTexture.size,u_ratio:1/Za(n,1,O.zoom),u_device_pixel_ratio:i.browser.devicePixelRatio,u_image:0,u_scale:[L,v.fromScale,v.toScale],u_fade:v.t,u_units_to_pixels:[1/O.pixelsToGLUnits[0],1/O.pixelsToGLUnits[1]]}},df=function(a,n,l,v,O){var L=a.lineAtlas,j=Kl(n,a.transform),ue=l.layout.get("line-cap")==="round",Ee=L.getDash(v.from,ue),$e=L.getDash(v.to,ue),nt=Ee.width*O.fromScale,at=$e.width*O.toScale;return i.extend(Yl(a,n,l),{u_patternscale_a:[j/nt,-Ee.height/2],u_patternscale_b:[j/at,-$e.height/2],u_sdfgamma:L.width/(256*Math.min(nt,at)*i.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:Ee.y,u_tex_y_b:$e.y,u_mix:O.t})};function Kl(s,a){return 1/Za(s,1,a.tileZoom)}function Ic(s,a,n){return s.translatePosMatrix(a.tileID.posMatrix,a,n.paint.get("line-translate"),n.paint.get("line-translate-anchor"))}var $l=function(a,n,l,v,O){return{u_matrix:a,u_tl_parent:n,u_scale_parent:l,u_buffer_scale:1,u_fade_t:v.mix,u_opacity:v.opacity*O.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:O.paint.get("raster-brightness-min"),u_brightness_high:O.paint.get("raster-brightness-max"),u_saturation_factor:(j=O.paint.get("raster-saturation"),j>0?1-1/(1.001-j):-j),u_contrast_factor:(L=O.paint.get("raster-contrast"),L>0?1/(1-L):1+L),u_spin_weights:Qu(O.paint.get("raster-hue-rotate"))};var L,j};function Qu(s){s*=Math.PI/180;var a=Math.sin(s),n=Math.cos(s);return[(2*n+1)/3,(-Math.sqrt(3)*a-n+1)/3,(Math.sqrt(3)*a-n+1)/3]}var Fu,bl=function(a,n,l,v,O,L,j,ue,Ee,$e){var nt=O.transform;return{u_is_size_zoom_constant:+(a==="constant"||a==="source"),u_is_size_feature_constant:+(a==="constant"||a==="camera"),u_size_t:n?n.uSizeT:0,u_size:n?n.uSize:0,u_camera_to_center_distance:nt.cameraToCenterDistance,u_pitch:nt.pitch/360*2*Math.PI,u_rotate_symbol:+l,u_aspect_ratio:nt.width/nt.height,u_fade_change:O.options.fadeDuration?O.symbolFadeChange:1,u_matrix:L,u_label_plane_matrix:j,u_coord_matrix:ue,u_is_text:+Ee,u_pitch_with_map:+v,u_texsize:$e,u_texture:0}},Lo=function(a,n,l,v,O,L,j,ue,Ee,$e,nt){var at=O.transform;return i.extend(bl(a,n,l,v,O,L,j,ue,Ee,$e),{u_gamma_scale:v?Math.cos(at._pitch)*at.cameraToCenterDistance:1,u_device_pixel_ratio:i.browser.devicePixelRatio,u_is_halo:+nt})},Jl=function(a,n,l,v,O,L,j,ue,Ee,$e){return i.extend(Lo(a,n,l,v,O,L,j,ue,!0,Ee,!0),{u_texsize_icon:$e,u_texture_icon:1})},Ll=function(a,n,l){return{u_matrix:a,u_opacity:n,u_color:l}},Rl=function(a,n,l,v,O,L){return i.extend(function(j,ue,Ee,$e){var nt=Ee.imageManager.getPattern(j.from.toString()),at=Ee.imageManager.getPattern(j.to.toString()),Ft=Ee.imageManager.getPixelSize(),Nt=Ft.width,Jt=Ft.height,jt=Math.pow(2,$e.tileID.overscaledZ),Gt=$e.tileSize*Math.pow(2,Ee.transform.tileZoom)/jt,ar=Gt*($e.tileID.canonical.x+$e.tileID.wrap*jt),nr=Gt*$e.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:nt.tl,u_pattern_br_a:nt.br,u_pattern_tl_b:at.tl,u_pattern_br_b:at.br,u_texsize:[Nt,Jt],u_mix:ue.t,u_pattern_size_a:nt.displaySize,u_pattern_size_b:at.displaySize,u_scale_a:ue.fromScale,u_scale_b:ue.toScale,u_tile_units_to_pixels:1/Za($e,1,Ee.transform.tileZoom),u_pixel_coord_upper:[ar>>16,nr>>16],u_pixel_coord_lower:[65535&ar,65535&nr]}}(v,L,l,O),{u_matrix:a,u_opacity:n})},Dc={fillExtrusion:function(a,n){return{u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_lightpos:new i.Uniform3f(a,n.u_lightpos),u_lightintensity:new i.Uniform1f(a,n.u_lightintensity),u_lightcolor:new i.Uniform3f(a,n.u_lightcolor),u_vertical_gradient:new i.Uniform1f(a,n.u_vertical_gradient),u_opacity:new i.Uniform1f(a,n.u_opacity)}},fillExtrusionPattern:function(a,n){return{u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_lightpos:new i.Uniform3f(a,n.u_lightpos),u_lightintensity:new i.Uniform1f(a,n.u_lightintensity),u_lightcolor:new i.Uniform3f(a,n.u_lightcolor),u_vertical_gradient:new i.Uniform1f(a,n.u_vertical_gradient),u_height_factor:new i.Uniform1f(a,n.u_height_factor),u_image:new i.Uniform1i(a,n.u_image),u_texsize:new i.Uniform2f(a,n.u_texsize),u_pixel_coord_upper:new i.Uniform2f(a,n.u_pixel_coord_upper),u_pixel_coord_lower:new i.Uniform2f(a,n.u_pixel_coord_lower),u_scale:new i.Uniform3f(a,n.u_scale),u_fade:new i.Uniform1f(a,n.u_fade),u_opacity:new i.Uniform1f(a,n.u_opacity)}},fill:function(a,n){return{u_matrix:new i.UniformMatrix4f(a,n.u_matrix)}},fillPattern:function(a,n){return{u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_image:new i.Uniform1i(a,n.u_image),u_texsize:new i.Uniform2f(a,n.u_texsize),u_pixel_coord_upper:new i.Uniform2f(a,n.u_pixel_coord_upper),u_pixel_coord_lower:new i.Uniform2f(a,n.u_pixel_coord_lower),u_scale:new i.Uniform3f(a,n.u_scale),u_fade:new i.Uniform1f(a,n.u_fade)}},fillOutline:function(a,n){return{u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_world:new i.Uniform2f(a,n.u_world)}},fillOutlinePattern:function(a,n){return{u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_world:new i.Uniform2f(a,n.u_world),u_image:new i.Uniform1i(a,n.u_image),u_texsize:new i.Uniform2f(a,n.u_texsize),u_pixel_coord_upper:new i.Uniform2f(a,n.u_pixel_coord_upper),u_pixel_coord_lower:new i.Uniform2f(a,n.u_pixel_coord_lower),u_scale:new i.Uniform3f(a,n.u_scale),u_fade:new i.Uniform1f(a,n.u_fade)}},circle:function(a,n){return{u_camera_to_center_distance:new i.Uniform1f(a,n.u_camera_to_center_distance),u_scale_with_map:new i.Uniform1i(a,n.u_scale_with_map),u_pitch_with_map:new i.Uniform1i(a,n.u_pitch_with_map),u_extrude_scale:new i.Uniform2f(a,n.u_extrude_scale),u_device_pixel_ratio:new i.Uniform1f(a,n.u_device_pixel_ratio),u_matrix:new i.UniformMatrix4f(a,n.u_matrix)}},collisionBox:function(a,n){return{u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_camera_to_center_distance:new i.Uniform1f(a,n.u_camera_to_center_distance),u_pixels_to_tile_units:new i.Uniform1f(a,n.u_pixels_to_tile_units),u_extrude_scale:new i.Uniform2f(a,n.u_extrude_scale),u_overscale_factor:new i.Uniform1f(a,n.u_overscale_factor)}},collisionCircle:function(a,n){return{u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_inv_matrix:new i.UniformMatrix4f(a,n.u_inv_matrix),u_camera_to_center_distance:new i.Uniform1f(a,n.u_camera_to_center_distance),u_viewport_size:new i.Uniform2f(a,n.u_viewport_size)}},debug:function(a,n){return{u_color:new i.UniformColor(a,n.u_color),u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_overlay:new i.Uniform1i(a,n.u_overlay),u_overlay_scale:new i.Uniform1f(a,n.u_overlay_scale)}},clippingMask:function(a,n){return{u_matrix:new i.UniformMatrix4f(a,n.u_matrix)}},heatmap:function(a,n){return{u_extrude_scale:new i.Uniform1f(a,n.u_extrude_scale),u_intensity:new i.Uniform1f(a,n.u_intensity),u_matrix:new i.UniformMatrix4f(a,n.u_matrix)}},heatmapTexture:function(a,n){return{u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_world:new i.Uniform2f(a,n.u_world),u_image:new i.Uniform1i(a,n.u_image),u_color_ramp:new i.Uniform1i(a,n.u_color_ramp),u_opacity:new i.Uniform1f(a,n.u_opacity)}},hillshade:function(a,n){return{u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_image:new i.Uniform1i(a,n.u_image),u_latrange:new i.Uniform2f(a,n.u_latrange),u_light:new i.Uniform2f(a,n.u_light),u_shadow:new i.UniformColor(a,n.u_shadow),u_highlight:new i.UniformColor(a,n.u_highlight),u_accent:new i.UniformColor(a,n.u_accent)}},hillshadePrepare:function(a,n){return{u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_image:new i.Uniform1i(a,n.u_image),u_dimension:new i.Uniform2f(a,n.u_dimension),u_zoom:new i.Uniform1f(a,n.u_zoom),u_unpack:new i.Uniform4f(a,n.u_unpack)}},line:function(a,n){return{u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_ratio:new i.Uniform1f(a,n.u_ratio),u_device_pixel_ratio:new i.Uniform1f(a,n.u_device_pixel_ratio),u_units_to_pixels:new i.Uniform2f(a,n.u_units_to_pixels)}},lineGradient:function(a,n){return{u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_ratio:new i.Uniform1f(a,n.u_ratio),u_device_pixel_ratio:new i.Uniform1f(a,n.u_device_pixel_ratio),u_units_to_pixels:new i.Uniform2f(a,n.u_units_to_pixels),u_image:new i.Uniform1i(a,n.u_image),u_image_height:new i.Uniform1f(a,n.u_image_height)}},linePattern:function(a,n){return{u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_texsize:new i.Uniform2f(a,n.u_texsize),u_ratio:new i.Uniform1f(a,n.u_ratio),u_device_pixel_ratio:new i.Uniform1f(a,n.u_device_pixel_ratio),u_image:new i.Uniform1i(a,n.u_image),u_units_to_pixels:new i.Uniform2f(a,n.u_units_to_pixels),u_scale:new i.Uniform3f(a,n.u_scale),u_fade:new i.Uniform1f(a,n.u_fade)}},lineSDF:function(a,n){return{u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_ratio:new i.Uniform1f(a,n.u_ratio),u_device_pixel_ratio:new i.Uniform1f(a,n.u_device_pixel_ratio),u_units_to_pixels:new i.Uniform2f(a,n.u_units_to_pixels),u_patternscale_a:new i.Uniform2f(a,n.u_patternscale_a),u_patternscale_b:new i.Uniform2f(a,n.u_patternscale_b),u_sdfgamma:new i.Uniform1f(a,n.u_sdfgamma),u_image:new i.Uniform1i(a,n.u_image),u_tex_y_a:new i.Uniform1f(a,n.u_tex_y_a),u_tex_y_b:new i.Uniform1f(a,n.u_tex_y_b),u_mix:new i.Uniform1f(a,n.u_mix)}},raster:function(a,n){return{u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_tl_parent:new i.Uniform2f(a,n.u_tl_parent),u_scale_parent:new i.Uniform1f(a,n.u_scale_parent),u_buffer_scale:new i.Uniform1f(a,n.u_buffer_scale),u_fade_t:new i.Uniform1f(a,n.u_fade_t),u_opacity:new i.Uniform1f(a,n.u_opacity),u_image0:new i.Uniform1i(a,n.u_image0),u_image1:new i.Uniform1i(a,n.u_image1),u_brightness_low:new i.Uniform1f(a,n.u_brightness_low),u_brightness_high:new i.Uniform1f(a,n.u_brightness_high),u_saturation_factor:new i.Uniform1f(a,n.u_saturation_factor),u_contrast_factor:new i.Uniform1f(a,n.u_contrast_factor),u_spin_weights:new i.Uniform3f(a,n.u_spin_weights)}},symbolIcon:function(a,n){return{u_is_size_zoom_constant:new i.Uniform1i(a,n.u_is_size_zoom_constant),u_is_size_feature_constant:new i.Uniform1i(a,n.u_is_size_feature_constant),u_size_t:new i.Uniform1f(a,n.u_size_t),u_size:new i.Uniform1f(a,n.u_size),u_camera_to_center_distance:new i.Uniform1f(a,n.u_camera_to_center_distance),u_pitch:new i.Uniform1f(a,n.u_pitch),u_rotate_symbol:new i.Uniform1i(a,n.u_rotate_symbol),u_aspect_ratio:new i.Uniform1f(a,n.u_aspect_ratio),u_fade_change:new i.Uniform1f(a,n.u_fade_change),u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_label_plane_matrix:new i.UniformMatrix4f(a,n.u_label_plane_matrix),u_coord_matrix:new i.UniformMatrix4f(a,n.u_coord_matrix),u_is_text:new i.Uniform1i(a,n.u_is_text),u_pitch_with_map:new i.Uniform1i(a,n.u_pitch_with_map),u_texsize:new i.Uniform2f(a,n.u_texsize),u_texture:new i.Uniform1i(a,n.u_texture)}},symbolSDF:function(a,n){return{u_is_size_zoom_constant:new i.Uniform1i(a,n.u_is_size_zoom_constant),u_is_size_feature_constant:new i.Uniform1i(a,n.u_is_size_feature_constant),u_size_t:new i.Uniform1f(a,n.u_size_t),u_size:new i.Uniform1f(a,n.u_size),u_camera_to_center_distance:new i.Uniform1f(a,n.u_camera_to_center_distance),u_pitch:new i.Uniform1f(a,n.u_pitch),u_rotate_symbol:new i.Uniform1i(a,n.u_rotate_symbol),u_aspect_ratio:new i.Uniform1f(a,n.u_aspect_ratio),u_fade_change:new i.Uniform1f(a,n.u_fade_change),u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_label_plane_matrix:new i.UniformMatrix4f(a,n.u_label_plane_matrix),u_coord_matrix:new i.UniformMatrix4f(a,n.u_coord_matrix),u_is_text:new i.Uniform1i(a,n.u_is_text),u_pitch_with_map:new i.Uniform1i(a,n.u_pitch_with_map),u_texsize:new i.Uniform2f(a,n.u_texsize),u_texture:new i.Uniform1i(a,n.u_texture),u_gamma_scale:new i.Uniform1f(a,n.u_gamma_scale),u_device_pixel_ratio:new i.Uniform1f(a,n.u_device_pixel_ratio),u_is_halo:new i.Uniform1i(a,n.u_is_halo)}},symbolTextAndIcon:function(a,n){return{u_is_size_zoom_constant:new i.Uniform1i(a,n.u_is_size_zoom_constant),u_is_size_feature_constant:new i.Uniform1i(a,n.u_is_size_feature_constant),u_size_t:new i.Uniform1f(a,n.u_size_t),u_size:new i.Uniform1f(a,n.u_size),u_camera_to_center_distance:new i.Uniform1f(a,n.u_camera_to_center_distance),u_pitch:new i.Uniform1f(a,n.u_pitch),u_rotate_symbol:new i.Uniform1i(a,n.u_rotate_symbol),u_aspect_ratio:new i.Uniform1f(a,n.u_aspect_ratio),u_fade_change:new i.Uniform1f(a,n.u_fade_change),u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_label_plane_matrix:new i.UniformMatrix4f(a,n.u_label_plane_matrix),u_coord_matrix:new i.UniformMatrix4f(a,n.u_coord_matrix),u_is_text:new i.Uniform1i(a,n.u_is_text),u_pitch_with_map:new i.Uniform1i(a,n.u_pitch_with_map),u_texsize:new i.Uniform2f(a,n.u_texsize),u_texsize_icon:new i.Uniform2f(a,n.u_texsize_icon),u_texture:new i.Uniform1i(a,n.u_texture),u_texture_icon:new i.Uniform1i(a,n.u_texture_icon),u_gamma_scale:new i.Uniform1f(a,n.u_gamma_scale),u_device_pixel_ratio:new i.Uniform1f(a,n.u_device_pixel_ratio),u_is_halo:new i.Uniform1i(a,n.u_is_halo)}},background:function(a,n){return{u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_opacity:new i.Uniform1f(a,n.u_opacity),u_color:new i.UniformColor(a,n.u_color)}},backgroundPattern:function(a,n){return{u_matrix:new i.UniformMatrix4f(a,n.u_matrix),u_opacity:new i.Uniform1f(a,n.u_opacity),u_image:new i.Uniform1i(a,n.u_image),u_pattern_tl_a:new i.Uniform2f(a,n.u_pattern_tl_a),u_pattern_br_a:new i.Uniform2f(a,n.u_pattern_br_a),u_pattern_tl_b:new i.Uniform2f(a,n.u_pattern_tl_b),u_pattern_br_b:new i.Uniform2f(a,n.u_pattern_br_b),u_texsize:new i.Uniform2f(a,n.u_texsize),u_mix:new i.Uniform1f(a,n.u_mix),u_pattern_size_a:new i.Uniform2f(a,n.u_pattern_size_a),u_pattern_size_b:new i.Uniform2f(a,n.u_pattern_size_b),u_scale_a:new i.Uniform1f(a,n.u_scale_a),u_scale_b:new i.Uniform1f(a,n.u_scale_b),u_pixel_coord_upper:new i.Uniform2f(a,n.u_pixel_coord_upper),u_pixel_coord_lower:new i.Uniform2f(a,n.u_pixel_coord_lower),u_tile_units_to_pixels:new i.Uniform1f(a,n.u_tile_units_to_pixels)}}};function xl(s,a,n,l,v,O,L){for(var j=s.context,ue=j.gl,Ee=s.useProgram("collisionBox"),$e=[],nt=0,at=0,Ft=0;Ft<l.length;Ft++){var Nt=l[Ft],Jt=a.getTile(Nt),jt=Jt.getBucket(n);if(jt){var Gt=Nt.posMatrix;v[0]===0&&v[1]===0||(Gt=s.translatePosMatrix(Nt.posMatrix,Jt,v,O));var ar=L?jt.textCollisionBox:jt.iconCollisionBox,nr=jt.collisionCircleArray;if(nr.length>0){var Rr=i.create(),gr=Gt;i.mul(Rr,jt.placementInvProjMatrix,s.transform.glCoordMatrix),i.mul(Rr,Rr,jt.placementViewportMatrix),$e.push({circleArray:nr,circleOffset:at,transform:gr,invTransform:Rr}),at=nt+=nr.length/4}ar&&Ee.draw(j,ue.LINES,xe.disabled,ut.disabled,s.colorModeForRenderPass(),Bt.disabled,Ju(Gt,s.transform,Jt),n.id,ar.layoutVertexBuffer,ar.indexBuffer,ar.segments,null,s.transform.zoom,null,null,ar.collisionVertexBuffer)}}if(L&&$e.length){var Ar=s.useProgram("collisionCircle"),Cr=new i.StructArrayLayout2f1f2i16;Cr.resize(4*nt),Cr._trim();for(var an=0,Yr=0,vn=$e;Yr<vn.length;Yr+=1)for(var Pn=vn[Yr],qn=0;qn<Pn.circleArray.length/4;qn++){var sa=4*qn,Aa=Pn.circleArray[sa+0],Wa=Pn.circleArray[sa+1],_n=Pn.circleArray[sa+2],ua=Pn.circleArray[sa+3];Cr.emplace(an++,Aa,Wa,_n,ua,0),Cr.emplace(an++,Aa,Wa,_n,ua,1),Cr.emplace(an++,Aa,Wa,_n,ua,2),Cr.emplace(an++,Aa,Wa,_n,ua,3)}(!Fu||Fu.length<2*nt)&&(Fu=function(Hi){var Ai=2*Hi,Ni=new i.StructArrayLayout3ui6;Ni.resize(Ai),Ni._trim();for(var Ei=0;Ei<Ai;Ei++){var Bi=6*Ei;Ni.uint16[Bi+0]=4*Ei+0,Ni.uint16[Bi+1]=4*Ei+1,Ni.uint16[Bi+2]=4*Ei+2,Ni.uint16[Bi+3]=4*Ei+2,Ni.uint16[Bi+4]=4*Ei+3,Ni.uint16[Bi+5]=4*Ei+0}return Ni}(nt));for(var xa=j.createIndexBuffer(Fu,!0),Zn=j.createVertexBuffer(Cr,i.collisionCircleLayout.members,!0),Ca=0,ia=$e;Ca<ia.length;Ca+=1){var La=ia[Ca],za=Rc(La.transform,La.invTransform,s.transform);Ar.draw(j,ue.TRIANGLES,xe.disabled,ut.disabled,s.colorModeForRenderPass(),Bt.disabled,za,n.id,Zn,xa,i.SegmentVector.simpleSegment(0,2*La.circleOffset,La.circleArray.length,La.circleArray.length/2),null,s.transform.zoom,null,null,null)}Zn.destroy(),xa.destroy()}}var Qs=i.identity(new Float32Array(16));function eo(s,a,n,l,v,O){var L=i.getAnchorAlignment(s),j=-(L.horizontalAlign-.5)*a,ue=-(L.verticalAlign-.5)*n,Ee=i.evaluateVariableOffset(s,l);return new i.Point((j/v+Ee[0])*O,(ue/v+Ee[1])*O)}function pf(s,a,n,l,v,O,L,j,ue,Ee,$e){var nt=s.text.placedSymbolArray,at=s.text.dynamicLayoutVertexArray,Ft=s.icon.dynamicLayoutVertexArray,Nt={};at.clear();for(var Jt=0;Jt<nt.length;Jt++){var jt=nt.get(Jt),Gt=jt.hidden||!jt.crossTileID||s.allowVerticalPlacement&&!jt.placedOrientation?null:l[jt.crossTileID];if(Gt){var ar=new i.Point(jt.anchorX,jt.anchorY),nr=ba(ar,n?j:L),Rr=ha(O.cameraToCenterDistance,nr.signedDistanceFromCamera),gr=v.evaluateSizeForFeature(s.textSizeData,Ee,jt)*Rr/i.ONE_EM;n&&(gr*=s.tilePixelRatio/ue);for(var Ar=eo(Gt.anchor,Gt.width,Gt.height,Gt.textOffset,Gt.textBoxScale,gr),Cr=n?ba(ar.add(Ar),L).point:nr.point.add(a?Ar.rotate(-O.angle):Ar),an=s.allowVerticalPlacement&&jt.placedOrientation===i.WritingMode.vertical?Math.PI/2:0,Yr=0;Yr<jt.numGlyphs;Yr++)i.addDynamicAttributes(at,Cr,an);$e&&jt.associatedIconIndex>=0&&(Nt[jt.associatedIconIndex]={shiftedAnchor:Cr,angle:an})}else ui(jt.numGlyphs,at)}if($e){Ft.clear();for(var vn=s.icon.placedSymbolArray,Pn=0;Pn<vn.length;Pn++){var qn=vn.get(Pn);if(qn.hidden)ui(qn.numGlyphs,Ft);else{var sa=Nt[Pn];if(sa)for(var Aa=0;Aa<qn.numGlyphs;Aa++)i.addDynamicAttributes(Ft,sa.shiftedAnchor,sa.angle);else ui(qn.numGlyphs,Ft)}}s.icon.dynamicLayoutVertexBuffer.updateData(Ft)}s.text.dynamicLayoutVertexBuffer.updateData(at)}function mf(s,a,n){return n.iconsInText&&a?"symbolTextAndIcon":s?"symbolSDF":"symbolIcon"}function El(s,a,n,l,v,O,L,j,ue,Ee,$e,nt){for(var at=s.context,Ft=at.gl,Nt=s.transform,Jt=j==="map",jt=ue==="map",Gt=Jt&&n.layout.get("symbol-placement")!=="point",ar=Jt&&!jt&&!Gt,nr=n.layout.get("symbol-sort-key").constantOr(1)!==void 0,Rr=!1,gr=s.depthModeForSublayer(0,xe.ReadOnly),Ar=n.layout.get("text-variable-anchor"),Cr=[],an=0,Yr=l;an<Yr.length;an+=1){var vn=Yr[an],Pn=a.getTile(vn),qn=Pn.getBucket(n);if(qn){var sa=v?qn.text:qn.icon;if(sa&&sa.segments.get().length){var Aa=sa.programConfigurations.get(n.id),Wa=v||qn.sdfIcons,_n=v?qn.textSizeData:qn.iconSizeData,ua=jt||Nt.pitch!==0,xa=s.useProgram(mf(Wa,v,qn),Aa),Zn=i.evaluateSizeForZoom(_n,Nt.zoom),Ca=void 0,ia=[0,0],La=void 0,za=void 0,Hi=null,Ai=void 0;if(v)La=Pn.glyphAtlasTexture,za=Ft.LINEAR,Ca=Pn.glyphAtlasTexture.size,qn.iconsInText&&(ia=Pn.imageAtlasTexture.size,Hi=Pn.imageAtlasTexture,Ai=ua||s.options.rotating||s.options.zooming||_n.kind==="composite"||_n.kind==="camera"?Ft.LINEAR:Ft.NEAREST);else{var Ni=n.layout.get("icon-size").constantOr(0)!==1||qn.iconsNeedLinear;La=Pn.imageAtlasTexture,za=Wa||s.options.rotating||s.options.zooming||Ni||ua?Ft.LINEAR:Ft.NEAREST,Ca=Pn.imageAtlasTexture.size}var Ei=Za(Pn,1,s.transform.zoom),Bi=vi(vn.posMatrix,jt,Jt,s.transform,Ei),es=ya(vn.posMatrix,jt,Jt,s.transform,Ei),ts=Ar&&qn.hasTextData(),vu=n.layout.get("icon-text-fit")!=="none"&&ts&&qn.hasIconData();Gt&&is(qn,vn.posMatrix,s,v,Bi,es,jt,Ee);var wu=s.translatePosMatrix(vn.posMatrix,Pn,O,L),hs=Gt||v&&Ar||vu?Qs:Bi,Hs=s.translatePosMatrix(es,Pn,O,L,!0),Ou=Wa&&n.paint.get(v?"text-halo-width":"icon-halo-width").constantOr(1)!==0,ic={program:xa,buffers:sa,uniformValues:Wa?qn.iconsInText?Jl(_n.kind,Zn,ar,jt,s,wu,hs,Hs,Ca,ia):Lo(_n.kind,Zn,ar,jt,s,wu,hs,Hs,v,Ca,!0):bl(_n.kind,Zn,ar,jt,s,wu,hs,Hs,v,Ca),atlasTexture:La,atlasTextureIcon:Hi,atlasInterpolation:za,atlasInterpolationIcon:Ai,isSDF:Wa,hasHalo:Ou};if(nr&&qn.canOverlap){Rr=!0;for(var tu=0,Hu=sa.segments.get();tu<Hu.length;tu+=1){var oc=Hu[tu];Cr.push({segments:new i.SegmentVector([oc]),sortKey:oc.sortKey,state:ic})}}else Cr.push({segments:sa.segments,sortKey:0,state:ic})}}}Rr&&Cr.sort(function(Vl,ps){return Vl.sortKey-ps.sortKey});for(var ru=0,Mu=Cr;ru<Mu.length;ru+=1){var ds=Mu[ru],ao=ds.state;if(at.activeTexture.set(Ft.TEXTURE0),ao.atlasTexture.bind(ao.atlasInterpolation,Ft.CLAMP_TO_EDGE),ao.atlasTextureIcon&&(at.activeTexture.set(Ft.TEXTURE1),ao.atlasTextureIcon&&ao.atlasTextureIcon.bind(ao.atlasInterpolationIcon,Ft.CLAMP_TO_EDGE)),ao.isSDF){var Zu=ao.uniformValues;ao.hasHalo&&(Zu.u_is_halo=1,Ql(ao.buffers,ds.segments,n,s,ao.program,gr,$e,nt,Zu)),Zu.u_is_halo=0}Ql(ao.buffers,ds.segments,n,s,ao.program,gr,$e,nt,ao.uniformValues)}}function Ql(s,a,n,l,v,O,L,j,ue){var Ee=l.context;v.draw(Ee,Ee.gl.TRIANGLES,O,L,j,Bt.disabled,ue,n.id,s.layoutVertexBuffer,s.indexBuffer,a,n.paint,l.transform.zoom,s.programConfigurations.get(n.id),s.dynamicLayoutVertexBuffer,s.opacityVertexBuffer)}function qu(s,a,n,l,v,O,L){var j,ue,Ee,$e,nt,at=s.context.gl,Ft=n.paint.get("fill-pattern"),Nt=Ft&&Ft.constantOr(1),Jt=n.getCrossfadeParameters();L?(ue=Nt&&!n.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",j=at.LINES):(ue=Nt?"fillPattern":"fill",j=at.TRIANGLES);for(var jt=0,Gt=l;jt<Gt.length;jt+=1){var ar=Gt[jt],nr=a.getTile(ar);if(!Nt||nr.patternsLoaded()){var Rr=nr.getBucket(n);if(Rr){var gr=Rr.programConfigurations.get(n.id),Ar=s.useProgram(ue,gr);Nt&&(s.context.activeTexture.set(at.TEXTURE0),nr.imageAtlasTexture.bind(at.LINEAR,at.CLAMP_TO_EDGE),gr.updatePaintBuffers(Jt));var Cr=Ft.constantOr(null);if(Cr&&nr.imageAtlas){var an=nr.imageAtlas,Yr=an.patternPositions[Cr.to.toString()],vn=an.patternPositions[Cr.from.toString()];Yr&&vn&&gr.setConstantPatternPositions(Yr,vn)}var Pn=s.translatePosMatrix(ar.posMatrix,nr,n.paint.get("fill-translate"),n.paint.get("fill-translate-anchor"));if(L){$e=Rr.indexBuffer2,nt=Rr.segments2;var qn=[at.drawingBufferWidth,at.drawingBufferHeight];Ee=ue==="fillOutlinePattern"&&Nt?vc(Pn,s,Jt,nr,qn):Lc(Pn,qn)}else $e=Rr.indexBuffer,nt=Rr.segments,Ee=Nt?os(Pn,s,Jt,nr):yl(Pn);Ar.draw(s.context,j,v,s.stencilModeForClipping(ar),O,Bt.disabled,Ee,n.id,Rr.layoutVertexBuffer,$e,nt,n.paint,s.transform.zoom,gr)}}}}function Il(s,a,n,l,v,O,L){for(var j=s.context,ue=j.gl,Ee=n.paint.get("fill-extrusion-pattern"),$e=Ee.constantOr(1),nt=n.getCrossfadeParameters(),at=n.paint.get("fill-extrusion-opacity"),Ft=0,Nt=l;Ft<Nt.length;Ft+=1){var Jt=Nt[Ft],jt=a.getTile(Jt),Gt=jt.getBucket(n);if(Gt){var ar=Gt.programConfigurations.get(n.id),nr=s.useProgram($e?"fillExtrusionPattern":"fillExtrusion",ar);$e&&(s.context.activeTexture.set(ue.TEXTURE0),jt.imageAtlasTexture.bind(ue.LINEAR,ue.CLAMP_TO_EDGE),ar.updatePaintBuffers(nt));var Rr=Ee.constantOr(null);if(Rr&&jt.imageAtlas){var gr=jt.imageAtlas,Ar=gr.patternPositions[Rr.to.toString()],Cr=gr.patternPositions[Rr.from.toString()];Ar&&Cr&&ar.setConstantPatternPositions(Ar,Cr)}var an=s.translatePosMatrix(Jt.posMatrix,jt,n.paint.get("fill-extrusion-translate"),n.paint.get("fill-extrusion-translate-anchor")),Yr=n.paint.get("fill-extrusion-vertical-gradient"),vn=$e?Tu(an,s,Yr,at,Jt,nt,jt):$i(an,s,Yr,at);nr.draw(j,j.gl.TRIANGLES,v,O,L,Bt.backCCW,vn,n.id,Gt.layoutVertexBuffer,Gt.indexBuffer,Gt.segments,n.paint,s.transform.zoom,ar)}}}function gc(s,a,n,l,v,O){var L=s.context,j=L.gl,ue=a.fbo;if(ue){var Ee=s.useProgram("hillshade");L.activeTexture.set(j.TEXTURE0),j.bindTexture(j.TEXTURE_2D,ue.colorAttachment.get());var $e=function(nt,at,Ft){var Nt=Ft.paint.get("hillshade-shadow-color"),Jt=Ft.paint.get("hillshade-highlight-color"),jt=Ft.paint.get("hillshade-accent-color"),Gt=Ft.paint.get("hillshade-illumination-direction")*(Math.PI/180);Ft.paint.get("hillshade-illumination-anchor")==="viewport"&&(Gt-=nt.transform.angle);var ar,nr,Rr,gr=!nt.options.moving;return{u_matrix:nt.transform.calculatePosMatrix(at.tileID.toUnwrapped(),gr),u_image:0,u_latrange:(ar=at.tileID,nr=Math.pow(2,ar.canonical.z),Rr=ar.canonical.y,[new i.MercatorCoordinate(0,Rr/nr).toLngLat().lat,new i.MercatorCoordinate(0,(Rr+1)/nr).toLngLat().lat]),u_light:[Ft.paint.get("hillshade-exaggeration"),Gt],u_shadow:Nt,u_highlight:Jt,u_accent:jt}}(s,a,n);Ee.draw(L,j.TRIANGLES,l,v,O,Bt.disabled,$e,n.id,s.rasterBoundsBuffer,s.quadTriangleIndexBuffer,s.rasterBoundsSegments)}}function yc(s,a,n,l,v,O){var L=s.context,j=L.gl,ue=a.dem;if(ue&&ue.data){var Ee=ue.dim,$e=ue.stride,nt=ue.getPixels();if(L.activeTexture.set(j.TEXTURE1),L.pixelStoreUnpackPremultiplyAlpha.set(!1),a.demTexture=a.demTexture||s.getTileTexture($e),a.demTexture){var at=a.demTexture;at.update(nt,{premultiply:!1}),at.bind(j.NEAREST,j.CLAMP_TO_EDGE)}else a.demTexture=new i.Texture(L,nt,j.RGBA,{premultiply:!1}),a.demTexture.bind(j.NEAREST,j.CLAMP_TO_EDGE);L.activeTexture.set(j.TEXTURE0);var Ft=a.fbo;if(!Ft){var Nt=new i.Texture(L,{width:Ee,height:Ee,data:null},j.RGBA);Nt.bind(j.LINEAR,j.CLAMP_TO_EDGE),(Ft=a.fbo=L.createFramebuffer(Ee,Ee,!0)).colorAttachment.set(Nt.texture)}L.bindFramebuffer.set(Ft.framebuffer),L.viewport.set([0,0,Ee,Ee]),s.useProgram("hillshadePrepare").draw(L,j.TRIANGLES,l,v,O,Bt.disabled,function(Jt,jt){var Gt=jt.stride,ar=i.create();return i.ortho(ar,0,i.EXTENT,-i.EXTENT,0,0,1),i.translate(ar,ar,[0,-i.EXTENT,0]),{u_matrix:ar,u_image:1,u_dimension:[Gt,Gt],u_zoom:Jt.overscaledZ,u_unpack:jt.getUnpackVector()}}(a.tileID,ue),n.id,s.rasterBoundsBuffer,s.quadTriangleIndexBuffer,s.rasterBoundsSegments),a.needsHillshadePrepare=!1}}function el(s,a,n,l,v){var O=l.paint.get("raster-fade-duration");if(O>0){var L=i.browser.now(),j=(L-s.timeAdded)/O,ue=a?(L-a.timeAdded)/O:-1,Ee=n.getSource(),$e=v.coveringZoomLevel({tileSize:Ee.tileSize,roundZoom:Ee.roundZoom}),nt=!a||Math.abs(a.tileID.overscaledZ-$e)>Math.abs(s.tileID.overscaledZ-$e),at=nt&&s.refreshedUponExpiration?1:i.clamp(nt?j:1-ue,0,1);return s.refreshedUponExpiration&&j>=1&&(s.refreshedUponExpiration=!1),a?{opacity:1,mix:1-at}:{opacity:at,mix:0}}return{opacity:1,mix:0}}var ef=new i.Color(1,0,0,1),tl=new i.Color(0,1,0,1),qs=new i.Color(0,0,1,1),Tl=new i.Color(1,0,1,1),ql=new i.Color(0,1,1,1);function Nc(s,a,n,l){zs(s,0,a+n/2,s.transform.width,n,l)}function tf(s,a,n,l){zs(s,a-n/2,0,n,s.transform.height,l)}function zs(s,a,n,l,v,O){var L=s.context,j=L.gl;j.enable(j.SCISSOR_TEST),j.scissor(a*i.browser.devicePixelRatio,n*i.browser.devicePixelRatio,l*i.browser.devicePixelRatio,v*i.browser.devicePixelRatio),L.clear({color:O}),j.disable(j.SCISSOR_TEST)}function vf(s,a,n){var l=s.context,v=l.gl,O=n.posMatrix,L=s.useProgram("debug"),j=xe.disabled,ue=ut.disabled,Ee=s.colorModeForRenderPass();l.activeTexture.set(v.TEXTURE0),s.emptyTexture.bind(v.LINEAR,v.CLAMP_TO_EDGE),L.draw(l,v.LINE_STRIP,j,ue,Ee,Bt.disabled,hu(O,i.Color.red),"$debug",s.debugBuffer,s.tileBorderIndexBuffer,s.debugSegments);var $e=a.getTileByID(n.key).latestRawTileData,nt=Math.floor(($e&&$e.byteLength||0)/1024),at=a.getTile(n).tileSize,Ft=512/Math.min(at,512)*(n.overscaledZ/s.transform.zoom)*.5,Nt=n.canonical.toString();n.overscaledZ!==n.canonical.z&&(Nt+=" => "+n.overscaledZ),function(Jt,jt){Jt.initDebugOverlayCanvas();var Gt=Jt.debugOverlayCanvas,ar=Jt.context.gl,nr=Jt.debugOverlayCanvas.getContext("2d");nr.clearRect(0,0,Gt.width,Gt.height),nr.shadowColor="white",nr.shadowBlur=2,nr.lineWidth=1.5,nr.strokeStyle="white",nr.textBaseline="top",nr.font="bold 36px Open Sans, sans-serif",nr.fillText(jt,5,5),nr.strokeText(jt,5,5),Jt.debugOverlayTexture.update(Gt),Jt.debugOverlayTexture.bind(ar.LINEAR,ar.CLAMP_TO_EDGE)}(s,Nt+" "+nt+"kb"),L.draw(l,v.TRIANGLES,j,ue,Ot.alphaBlended,Bt.disabled,hu(O,i.Color.transparent,Ft),"$debug",s.debugBuffer,s.quadTriangleIndexBuffer,s.debugSegments)}var rl={symbol:function(a,n,l,v,O){if(a.renderPass==="translucent"){var L=ut.disabled,j=a.colorModeForRenderPass();l.layout.get("text-variable-anchor")&&function(ue,Ee,$e,nt,at,Ft,Nt){for(var Jt=Ee.transform,jt=at==="map",Gt=Ft==="map",ar=0,nr=ue;ar<nr.length;ar+=1){var Rr=nr[ar],gr=nt.getTile(Rr),Ar=gr.getBucket($e);if(Ar&&Ar.text&&Ar.text.segments.get().length){var Cr=i.evaluateSizeForZoom(Ar.textSizeData,Jt.zoom),an=Za(gr,1,Ee.transform.zoom),Yr=vi(Rr.posMatrix,Gt,jt,Ee.transform,an),vn=$e.layout.get("icon-text-fit")!=="none"&&Ar.hasIconData();if(Cr){var Pn=Math.pow(2,Jt.zoom-gr.tileID.overscaledZ);pf(Ar,jt,Gt,Nt,i.symbolSize,Jt,Yr,Rr.posMatrix,Pn,Cr,vn)}}}}(v,a,l,n,l.layout.get("text-rotation-alignment"),l.layout.get("text-pitch-alignment"),O),l.paint.get("icon-opacity").constantOr(1)!==0&&El(a,n,l,v,!1,l.paint.get("icon-translate"),l.paint.get("icon-translate-anchor"),l.layout.get("icon-rotation-alignment"),l.layout.get("icon-pitch-alignment"),l.layout.get("icon-keep-upright"),L,j),l.paint.get("text-opacity").constantOr(1)!==0&&El(a,n,l,v,!0,l.paint.get("text-translate"),l.paint.get("text-translate-anchor"),l.layout.get("text-rotation-alignment"),l.layout.get("text-pitch-alignment"),l.layout.get("text-keep-upright"),L,j),n.map.showCollisionBoxes&&(xl(a,n,l,v,l.paint.get("text-translate"),l.paint.get("text-translate-anchor"),!0),xl(a,n,l,v,l.paint.get("icon-translate"),l.paint.get("icon-translate-anchor"),!1))}},circle:function(a,n,l,v){if(a.renderPass==="translucent"){var O=l.paint.get("circle-opacity"),L=l.paint.get("circle-stroke-width"),j=l.paint.get("circle-stroke-opacity"),ue=l.layout.get("circle-sort-key").constantOr(1)!==void 0;if(O.constantOr(1)!==0||L.constantOr(1)!==0&&j.constantOr(1)!==0){for(var Ee=a.context,$e=Ee.gl,nt=a.depthModeForSublayer(0,xe.ReadOnly),at=ut.disabled,Ft=a.colorModeForRenderPass(),Nt=[],Jt=0;Jt<v.length;Jt++){var jt=v[Jt],Gt=n.getTile(jt),ar=Gt.getBucket(l);if(ar){var nr=ar.programConfigurations.get(l.id),Rr={programConfiguration:nr,program:a.useProgram("circle",nr),layoutVertexBuffer:ar.layoutVertexBuffer,indexBuffer:ar.indexBuffer,uniformValues:Pl(a,jt,Gt,l)};if(ue)for(var gr=0,Ar=ar.segments.get();gr<Ar.length;gr+=1){var Cr=Ar[gr];Nt.push({segments:new i.SegmentVector([Cr]),sortKey:Cr.sortKey,state:Rr})}else Nt.push({segments:ar.segments,sortKey:0,state:Rr})}}ue&&Nt.sort(function(qn,sa){return qn.sortKey-sa.sortKey});for(var an=0,Yr=Nt;an<Yr.length;an+=1){var vn=Yr[an],Pn=vn.state;Pn.program.draw(Ee,$e.TRIANGLES,nt,at,Ft,Bt.disabled,Pn.uniformValues,l.id,Pn.layoutVertexBuffer,Pn.indexBuffer,vn.segments,l.paint,a.transform.zoom,Pn.programConfiguration)}}}},heatmap:function(a,n,l,v){if(l.paint.get("heatmap-opacity")!==0)if(a.renderPass==="offscreen"){var O=a.context,L=O.gl,j=ut.disabled,ue=new Ot([L.ONE,L.ONE],i.Color.transparent,[!0,!0,!0,!0]);!function(Nt,Jt,jt){var Gt=Nt.gl;Nt.activeTexture.set(Gt.TEXTURE1),Nt.viewport.set([0,0,Jt.width/4,Jt.height/4]);var ar=jt.heatmapFbo;if(ar)Gt.bindTexture(Gt.TEXTURE_2D,ar.colorAttachment.get()),Nt.bindFramebuffer.set(ar.framebuffer);else{var nr=Gt.createTexture();Gt.bindTexture(Gt.TEXTURE_2D,nr),Gt.texParameteri(Gt.TEXTURE_2D,Gt.TEXTURE_WRAP_S,Gt.CLAMP_TO_EDGE),Gt.texParameteri(Gt.TEXTURE_2D,Gt.TEXTURE_WRAP_T,Gt.CLAMP_TO_EDGE),Gt.texParameteri(Gt.TEXTURE_2D,Gt.TEXTURE_MIN_FILTER,Gt.LINEAR),Gt.texParameteri(Gt.TEXTURE_2D,Gt.TEXTURE_MAG_FILTER,Gt.LINEAR),ar=jt.heatmapFbo=Nt.createFramebuffer(Jt.width/4,Jt.height/4,!1),function(Rr,gr,Ar,Cr){var an=Rr.gl;an.texImage2D(an.TEXTURE_2D,0,an.RGBA,gr.width/4,gr.height/4,0,an.RGBA,Rr.extRenderToTextureHalfFloat?Rr.extTextureHalfFloat.HALF_FLOAT_OES:an.UNSIGNED_BYTE,null),Cr.colorAttachment.set(Ar)}(Nt,Jt,nr,ar)}}(O,a,l),O.clear({color:i.Color.transparent});for(var Ee=0;Ee<v.length;Ee++){var $e=v[Ee];if(!n.hasRenderableParent($e)){var nt=n.getTile($e),at=nt.getBucket(l);if(at){var Ft=at.programConfigurations.get(l.id);a.useProgram("heatmap",Ft).draw(O,L.TRIANGLES,xe.disabled,j,ue,Bt.disabled,Qc($e.posMatrix,nt,a.transform.zoom,l.paint.get("heatmap-intensity")),l.id,at.layoutVertexBuffer,at.indexBuffer,at.segments,l.paint,a.transform.zoom,Ft)}}}O.viewport.set([0,0,a.width,a.height])}else a.renderPass==="translucent"&&(a.context.setColorMode(a.colorModeForRenderPass()),function(Nt,Jt){var jt=Nt.context,Gt=jt.gl,ar=Jt.heatmapFbo;if(ar){jt.activeTexture.set(Gt.TEXTURE0),Gt.bindTexture(Gt.TEXTURE_2D,ar.colorAttachment.get()),jt.activeTexture.set(Gt.TEXTURE1);var nr=Jt.colorRampTexture;nr||(nr=Jt.colorRampTexture=new i.Texture(jt,Jt.colorRamp,Gt.RGBA)),nr.bind(Gt.LINEAR,Gt.CLAMP_TO_EDGE),Nt.useProgram("heatmapTexture").draw(jt,Gt.TRIANGLES,xe.disabled,ut.disabled,Nt.colorModeForRenderPass(),Bt.disabled,function(Rr,gr,Ar,Cr){var an=i.create();i.ortho(an,0,Rr.width,Rr.height,0,0,1);var Yr=Rr.context.gl;return{u_matrix:an,u_world:[Yr.drawingBufferWidth,Yr.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:gr.paint.get("heatmap-opacity")}}(Nt,Jt),Jt.id,Nt.viewportBuffer,Nt.quadTriangleIndexBuffer,Nt.viewportSegments,Jt.paint,Nt.transform.zoom)}}(a,l))},line:function(a,n,l,v){if(a.renderPass==="translucent"){var O=l.paint.get("line-opacity"),L=l.paint.get("line-width");if(O.constantOr(1)!==0&&L.constantOr(1)!==0)for(var j=a.depthModeForSublayer(0,xe.ReadOnly),ue=a.colorModeForRenderPass(),Ee=l.paint.get("line-dasharray"),$e=l.paint.get("line-pattern"),nt=$e.constantOr(1),at=l.paint.get("line-gradient"),Ft=l.getCrossfadeParameters(),Nt=nt?"linePattern":Ee?"lineSDF":at?"lineGradient":"line",Jt=a.context,jt=Jt.gl,Gt=!0,ar=0,nr=v;ar<nr.length;ar+=1){var Rr=nr[ar],gr=n.getTile(Rr);if(!nt||gr.patternsLoaded()){var Ar=gr.getBucket(l);if(Ar){var Cr=Ar.programConfigurations.get(l.id),an=a.context.program.get(),Yr=a.useProgram(Nt,Cr),vn=Gt||Yr.program!==an,Pn=$e.constantOr(null);if(Pn&&gr.imageAtlas){var qn=gr.imageAtlas,sa=qn.patternPositions[Pn.to.toString()],Aa=qn.patternPositions[Pn.from.toString()];sa&&Aa&&Cr.setConstantPatternPositions(sa,Aa)}var Wa=nt?qc(a,gr,l,Ft):Ee?df(a,gr,l,Ee,Ft):at?Si(a,gr,l,Ar.lineClipsArray.length):Yl(a,gr,l);if(nt)Jt.activeTexture.set(jt.TEXTURE0),gr.imageAtlasTexture.bind(jt.LINEAR,jt.CLAMP_TO_EDGE),Cr.updatePaintBuffers(Ft);else if(Ee&&(vn||a.lineAtlas.dirty))Jt.activeTexture.set(jt.TEXTURE0),a.lineAtlas.bind(Jt);else if(at){var _n=Ar.gradients[l.id],ua=_n.texture;if(l.gradientVersion!==_n.version){var xa=256;if(l.stepInterpolant){var Zn=n.getSource().maxzoom,Ca=Rr.canonical.z===Zn?Math.ceil(1<<a.transform.maxZoom-Rr.canonical.z):1;xa=i.clamp(i.nextPowerOfTwo(Ar.maxLineLength/i.EXTENT*1024*Ca),256,Jt.maxTextureSize)}_n.gradient=i.renderColorRamp({expression:l.gradientExpression(),evaluationKey:"lineProgress",resolution:xa,image:_n.gradient||void 0,clips:Ar.lineClipsArray}),_n.texture?_n.texture.update(_n.gradient):_n.texture=new i.Texture(Jt,_n.gradient,jt.RGBA),_n.version=l.gradientVersion,ua=_n.texture}Jt.activeTexture.set(jt.TEXTURE0),ua.bind(l.stepInterpolant?jt.NEAREST:jt.LINEAR,jt.CLAMP_TO_EDGE)}Yr.draw(Jt,jt.TRIANGLES,j,a.stencilModeForClipping(Rr),ue,Bt.disabled,Wa,l.id,Ar.layoutVertexBuffer,Ar.indexBuffer,Ar.segments,l.paint,a.transform.zoom,Cr,Ar.layoutVertexBuffer2),Gt=!1}}}}},fill:function(a,n,l,v){var O=l.paint.get("fill-color"),L=l.paint.get("fill-opacity");if(L.constantOr(1)!==0){var j=a.colorModeForRenderPass(),ue=l.paint.get("fill-pattern"),Ee=a.opaquePassEnabledForLayer()&&!ue.constantOr(1)&&O.constantOr(i.Color.transparent).a===1&&L.constantOr(0)===1?"opaque":"translucent";if(a.renderPass===Ee){var $e=a.depthModeForSublayer(1,a.renderPass==="opaque"?xe.ReadWrite:xe.ReadOnly);qu(a,n,l,v,$e,j,!1)}if(a.renderPass==="translucent"&&l.paint.get("fill-antialias")){var nt=a.depthModeForSublayer(l.getPaintProperty("fill-outline-color")?2:0,xe.ReadOnly);qu(a,n,l,v,nt,j,!0)}}},"fill-extrusion":function(a,n,l,v){var O=l.paint.get("fill-extrusion-opacity");if(O!==0&&a.renderPass==="translucent"){var L=new xe(a.context.gl.LEQUAL,xe.ReadWrite,a.depthRangeFor3D);if(O!==1||l.paint.get("fill-extrusion-pattern").constantOr(1))Il(a,n,l,v,L,ut.disabled,Ot.disabled),Il(a,n,l,v,L,a.stencilModeFor3D(),a.colorModeForRenderPass());else{var j=a.colorModeForRenderPass();Il(a,n,l,v,L,ut.disabled,j)}}},hillshade:function(a,n,l,v){if(a.renderPass==="offscreen"||a.renderPass==="translucent"){for(var O=a.context,L=a.depthModeForSublayer(0,xe.ReadOnly),j=a.colorModeForRenderPass(),ue=a.renderPass==="translucent"?a.stencilConfigForOverlap(v):[{},v],Ee=ue[0],$e=0,nt=ue[1];$e<nt.length;$e+=1){var at=nt[$e],Ft=n.getTile(at);Ft.needsHillshadePrepare&&a.renderPass==="offscreen"?yc(a,Ft,l,L,ut.disabled,j):a.renderPass==="translucent"&&gc(a,Ft,l,L,Ee[at.overscaledZ],j)}O.viewport.set([0,0,a.width,a.height])}},raster:function(a,n,l,v){if(a.renderPass==="translucent"&&l.paint.get("raster-opacity")!==0&&v.length)for(var O=a.context,L=O.gl,j=n.getSource(),ue=a.useProgram("raster"),Ee=a.colorModeForRenderPass(),$e=j instanceof ye?[{},v]:a.stencilConfigForOverlap(v),nt=$e[0],at=$e[1],Ft=at[at.length-1].overscaledZ,Nt=!a.options.moving,Jt=0,jt=at;Jt<jt.length;Jt+=1){var Gt=jt[Jt],ar=a.depthModeForSublayer(Gt.overscaledZ-Ft,l.paint.get("raster-opacity")===1?xe.ReadWrite:xe.ReadOnly,L.LESS),nr=n.getTile(Gt),Rr=a.transform.calculatePosMatrix(Gt.toUnwrapped(),Nt);nr.registerFadeDuration(l.paint.get("raster-fade-duration"));var gr=n.findLoadedParent(Gt,0),Ar=el(nr,gr,n,l,a.transform),Cr=void 0,an=void 0,Yr=l.paint.get("raster-resampling")==="nearest"?L.NEAREST:L.LINEAR;O.activeTexture.set(L.TEXTURE0),nr.texture.bind(Yr,L.CLAMP_TO_EDGE,L.LINEAR_MIPMAP_NEAREST),O.activeTexture.set(L.TEXTURE1),gr?(gr.texture.bind(Yr,L.CLAMP_TO_EDGE,L.LINEAR_MIPMAP_NEAREST),Cr=Math.pow(2,gr.tileID.overscaledZ-nr.tileID.overscaledZ),an=[nr.tileID.canonical.x*Cr%1,nr.tileID.canonical.y*Cr%1]):nr.texture.bind(Yr,L.CLAMP_TO_EDGE,L.LINEAR_MIPMAP_NEAREST);var vn=$l(Rr,an||[0,0],Cr||1,Ar,l);j instanceof ye?ue.draw(O,L.TRIANGLES,ar,ut.disabled,Ee,Bt.disabled,vn,l.id,j.boundsBuffer,a.quadTriangleIndexBuffer,j.boundsSegments):ue.draw(O,L.TRIANGLES,ar,nt[Gt.overscaledZ],Ee,Bt.disabled,vn,l.id,a.rasterBoundsBuffer,a.quadTriangleIndexBuffer,a.rasterBoundsSegments)}},background:function(a,n,l){var v=l.paint.get("background-color"),O=l.paint.get("background-opacity");if(O!==0){var L=a.context,j=L.gl,ue=a.transform,Ee=ue.tileSize,$e=l.paint.get("background-pattern");if(!a.isPatternMissing($e)){var nt=!$e&&v.a===1&&O===1&&a.opaquePassEnabledForLayer()?"opaque":"translucent";if(a.renderPass===nt){var at=ut.disabled,Ft=a.depthModeForSublayer(0,nt==="opaque"?xe.ReadWrite:xe.ReadOnly),Nt=a.colorModeForRenderPass(),Jt=a.useProgram($e?"backgroundPattern":"background"),jt=ue.coveringTiles({tileSize:Ee});$e&&(L.activeTexture.set(j.TEXTURE0),a.imageManager.bind(a.context));for(var Gt=l.getCrossfadeParameters(),ar=0,nr=jt;ar<nr.length;ar+=1){var Rr=nr[ar],gr=a.transform.calculatePosMatrix(Rr.toUnwrapped()),Ar=$e?Rl(gr,O,a,$e,{tileID:Rr,tileSize:Ee},Gt):Ll(gr,O,v);Jt.draw(L,j.TRIANGLES,Ft,at,Nt,Bt.disabled,Ar,l.id,a.tileExtentBuffer,a.quadTriangleIndexBuffer,a.tileExtentSegments)}}}}},debug:function(a,n,l){for(var v=0;v<l.length;v++)vf(a,n,l[v])},custom:function(a,n,l){var v=a.context,O=l.implementation;if(a.renderPass==="offscreen"){var L=O.prerender;L&&(a.setCustomLayerDefaults(),v.setColorMode(a.colorModeForRenderPass()),L.call(O,v.gl,a.transform.customLayerMatrix()),v.setDirty(),a.setBaseState())}else if(a.renderPass==="translucent"){a.setCustomLayerDefaults(),v.setColorMode(a.colorModeForRenderPass()),v.setStencilMode(ut.disabled);var j=O.renderingMode==="3d"?new xe(a.context.gl.LEQUAL,xe.ReadWrite,a.depthRangeFor3D):a.depthModeForSublayer(0,xe.ReadOnly);v.setDepthMode(j),O.render(v.gl,a.transform.customLayerMatrix()),v.setDirty(),a.setBaseState(),v.bindFramebuffer.set(null)}}},Pi=function(a,n){this.context=new Ze(a),this.transform=n,this._tileTextures={},this.setup(),this.numSublayers=Rt.maxUnderzooming+Rt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new _o,this.gpuTimers={}};Pi.prototype.resize=function(s,a){if(this.width=s*i.browser.devicePixelRatio,this.height=a*i.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var n=0,l=this.style._order;n<l.length;n+=1)this.style._layers[l[n]].resize()},Pi.prototype.setup=function(){var s=this.context,a=new i.StructArrayLayout2i4;a.emplaceBack(0,0),a.emplaceBack(i.EXTENT,0),a.emplaceBack(0,i.EXTENT),a.emplaceBack(i.EXTENT,i.EXTENT),this.tileExtentBuffer=s.createVertexBuffer(a,Gi.members),this.tileExtentSegments=i.SegmentVector.simpleSegment(0,0,4,2);var n=new i.StructArrayLayout2i4;n.emplaceBack(0,0),n.emplaceBack(i.EXTENT,0),n.emplaceBack(0,i.EXTENT),n.emplaceBack(i.EXTENT,i.EXTENT),this.debugBuffer=s.createVertexBuffer(n,Gi.members),this.debugSegments=i.SegmentVector.simpleSegment(0,0,4,5);var l=new i.StructArrayLayout4i8;l.emplaceBack(0,0,0,0),l.emplaceBack(i.EXTENT,0,i.EXTENT,0),l.emplaceBack(0,i.EXTENT,0,i.EXTENT),l.emplaceBack(i.EXTENT,i.EXTENT,i.EXTENT,i.EXTENT),this.rasterBoundsBuffer=s.createVertexBuffer(l,Ae.members),this.rasterBoundsSegments=i.SegmentVector.simpleSegment(0,0,4,2);var v=new i.StructArrayLayout2i4;v.emplaceBack(0,0),v.emplaceBack(1,0),v.emplaceBack(0,1),v.emplaceBack(1,1),this.viewportBuffer=s.createVertexBuffer(v,Gi.members),this.viewportSegments=i.SegmentVector.simpleSegment(0,0,4,2);var O=new i.StructArrayLayout1ui2;O.emplaceBack(0),O.emplaceBack(1),O.emplaceBack(3),O.emplaceBack(2),O.emplaceBack(0),this.tileBorderIndexBuffer=s.createIndexBuffer(O);var L=new i.StructArrayLayout3ui6;L.emplaceBack(0,1,2),L.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=s.createIndexBuffer(L),this.emptyTexture=new i.Texture(s,{width:1,height:1,data:new Uint8Array([0,0,0,0])},s.gl.RGBA);var j=this.context.gl;this.stencilClearMode=new ut({func:j.ALWAYS,mask:0},0,255,j.ZERO,j.ZERO,j.ZERO)},Pi.prototype.clearStencil=function(){var s=this.context,a=s.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var n=i.create();i.ortho(n,0,this.width,this.height,0,0,1),i.scale(n,n,[a.drawingBufferWidth,a.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(s,a.TRIANGLES,xe.disabled,this.stencilClearMode,Ot.disabled,Bt.disabled,_u(n),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},Pi.prototype._renderTileClippingMasks=function(s,a){if(this.currentStencilSource!==s.source&&s.isTileClipped()&&a&&a.length){this.currentStencilSource=s.source;var n=this.context,l=n.gl;this.nextStencilID+a.length>256&&this.clearStencil(),n.setColorMode(Ot.disabled),n.setDepthMode(xe.disabled);var v=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var O=0,L=a;O<L.length;O+=1){var j=L[O],ue=this._tileClippingMaskIDs[j.key]=this.nextStencilID++;v.draw(n,l.TRIANGLES,xe.disabled,new ut({func:l.ALWAYS,mask:0},ue,255,l.KEEP,l.KEEP,l.REPLACE),Ot.disabled,Bt.disabled,_u(j.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},Pi.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var s=this.nextStencilID++,a=this.context.gl;return new ut({func:a.NOTEQUAL,mask:255},s,255,a.KEEP,a.KEEP,a.REPLACE)},Pi.prototype.stencilModeForClipping=function(s){var a=this.context.gl;return new ut({func:a.EQUAL,mask:255},this._tileClippingMaskIDs[s.key],0,a.KEEP,a.KEEP,a.REPLACE)},Pi.prototype.stencilConfigForOverlap=function(s){var a,n=this.context.gl,l=s.sort(function(ue,Ee){return Ee.overscaledZ-ue.overscaledZ}),v=l[l.length-1].overscaledZ,O=l[0].overscaledZ-v+1;if(O>1){this.currentStencilSource=void 0,this.nextStencilID+O>256&&this.clearStencil();for(var L={},j=0;j<O;j++)L[j+v]=new ut({func:n.GEQUAL,mask:255},j+this.nextStencilID,255,n.KEEP,n.KEEP,n.REPLACE);return this.nextStencilID+=O,[L,l]}return[(a={},a[v]=ut.disabled,a),l]},Pi.prototype.colorModeForRenderPass=function(){var s=this.context.gl;return this._showOverdrawInspector?new Ot([s.CONSTANT_COLOR,s.ONE],new i.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Ot.unblended:Ot.alphaBlended},Pi.prototype.depthModeForSublayer=function(s,a,n){if(!this.opaquePassEnabledForLayer())return xe.disabled;var l=1-((1+this.currentLayer)*this.numSublayers+s)*this.depthEpsilon;return new xe(n||this.context.gl.LEQUAL,a,[l,l])},Pi.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},Pi.prototype.render=function(s,a){var n=this;this.style=s,this.options=a,this.lineAtlas=s.lineAtlas,this.imageManager=s.imageManager,this.glyphManager=s.glyphManager,this.symbolFadeChange=s.placement.symbolFadeChange(i.browser.now()),this.imageManager.beginFrame();var l=this.style._order,v=this.style.sourceCaches;for(var O in v){var L=v[O];L.used&&L.prepare(this.context)}var j,ue,Ee={},$e={},nt={};for(var at in v){var Ft=v[at];Ee[at]=Ft.getVisibleCoordinates(),$e[at]=Ee[at].slice().reverse(),nt[at]=Ft.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var Nt=0;Nt<l.length;Nt++)if(this.style._layers[l[Nt]].is3D()){this.opaquePassCutoff=Nt;break}this.renderPass="offscreen";for(var Jt=0,jt=l;Jt<jt.length;Jt+=1){var Gt=this.style._layers[jt[Jt]];if(Gt.hasOffscreenPass()&&!Gt.isHidden(this.transform.zoom)){var ar=$e[Gt.source];(Gt.type==="custom"||ar.length)&&this.renderLayer(this,v[Gt.source],Gt,ar)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:a.showOverdrawInspector?i.Color.black:i.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=a.showOverdrawInspector,this.depthRangeFor3D=[0,1-(s._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=l.length-1;this.currentLayer>=0;this.currentLayer--){var nr=this.style._layers[l[this.currentLayer]],Rr=v[nr.source],gr=Ee[nr.source];this._renderTileClippingMasks(nr,gr),this.renderLayer(this,Rr,nr,gr)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<l.length;this.currentLayer++){var Ar=this.style._layers[l[this.currentLayer]],Cr=v[Ar.source],an=(Ar.type==="symbol"?nt:$e)[Ar.source];this._renderTileClippingMasks(Ar,Ee[Ar.source]),this.renderLayer(this,Cr,Ar,an)}this.options.showTileBoundaries&&(i.values(this.style._layers).forEach(function(Yr){Yr.source&&!Yr.isHidden(n.transform.zoom)&&(Yr.source!==(ue&&ue.id)&&(ue=n.style.sourceCaches[Yr.source]),(!j||j.getSource().maxzoom<ue.getSource().maxzoom)&&(j=ue))}),j&&rl.debug(this,j,j.getVisibleCoordinates())),this.options.showPadding&&function(Yr){var vn=Yr.transform.padding;Nc(Yr,Yr.transform.height-(vn.top||0),3,ef),Nc(Yr,vn.bottom||0,3,tl),tf(Yr,vn.left||0,3,qs),tf(Yr,Yr.transform.width-(vn.right||0),3,Tl);var Pn=Yr.transform.centerPoint;!function(qn,sa,Aa,Wa){zs(qn,sa-1,Aa-10,2,20,Wa),zs(qn,sa-10,Aa-1,20,2,Wa)}(Yr,Pn.x,Yr.transform.height-Pn.y,ql)}(this),this.context.setDefault()},Pi.prototype.renderLayer=function(s,a,n,l){n.isHidden(this.transform.zoom)||(n.type==="background"||n.type==="custom"||l.length)&&(this.id=n.id,this.gpuTimingStart(n),rl[n.type](s,a,n,l,this.style.placement.variableOffsets),this.gpuTimingEnd())},Pi.prototype.gpuTimingStart=function(s){if(this.options.gpuTiming){var a=this.context.extTimerQuery,n=this.gpuTimers[s.id];n||(n=this.gpuTimers[s.id]={calls:0,cpuTime:0,query:a.createQueryEXT()}),n.calls++,a.beginQueryEXT(a.TIME_ELAPSED_EXT,n.query)}},Pi.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var s=this.context.extTimerQuery;s.endQueryEXT(s.TIME_ELAPSED_EXT)}},Pi.prototype.collectGpuTimers=function(){var s=this.gpuTimers;return this.gpuTimers={},s},Pi.prototype.queryGpuTimers=function(s){var a={};for(var n in s){var l=s[n],v=this.context.extTimerQuery,O=v.getQueryObjectEXT(l.query,v.QUERY_RESULT_EXT)/1e6;v.deleteQueryEXT(l.query),a[n]=O}return a},Pi.prototype.translatePosMatrix=function(s,a,n,l,v){if(!n[0]&&!n[1])return s;var O=v?l==="map"?this.transform.angle:0:l==="viewport"?-this.transform.angle:0;if(O){var L=Math.sin(O),j=Math.cos(O);n=[n[0]*j-n[1]*L,n[0]*L+n[1]*j]}var ue=[v?n[0]:Za(a,n[0],this.transform.zoom),v?n[1]:Za(a,n[1],this.transform.zoom),0],Ee=new Float32Array(16);return i.translate(Ee,s,ue),Ee},Pi.prototype.saveTileTexture=function(s){var a=this._tileTextures[s.size[0]];a?a.push(s):this._tileTextures[s.size[0]]=[s]},Pi.prototype.getTileTexture=function(s){var a=this._tileTextures[s];return a&&a.length>0?a.pop():null},Pi.prototype.isPatternMissing=function(s){if(!s)return!1;if(!s.from||!s.to)return!0;var a=this.imageManager.getPattern(s.from.toString()),n=this.imageManager.getPattern(s.to.toString());return!a||!n},Pi.prototype.useProgram=function(s,a){this.cache=this.cache||{};var n=""+s+(a?a.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[n]||(this.cache[n]=new gl(this.context,s,Pc[s],a,Dc[s],this._showOverdrawInspector)),this.cache[n]},Pi.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},Pi.prototype.setBaseState=function(){var s=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(s.FUNC_ADD)},Pi.prototype.initDebugOverlayCanvas=function(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=i.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new i.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},Pi.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var nl=function(a,n){this.points=a,this.planes=n};nl.fromInvProjectionMatrix=function(s,a,n){var l=Math.pow(2,n),v=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(L){return i.transformMat4([],L,s)}).map(function(L){return i.scale$1([],L,1/L[3]/a*l)}),O=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(L){var j=i.sub([],v[L[0]],v[L[1]]),ue=i.sub([],v[L[2]],v[L[1]]),Ee=i.normalize([],i.cross([],j,ue)),$e=-i.dot(Ee,v[L[1]]);return Ee.concat($e)});return new nl(v,O)};var zu=function(a,n){this.min=a,this.max=n,this.center=i.scale$2([],i.add([],this.min,this.max),.5)};zu.prototype.quadrant=function(s){for(var a=[s%2==0,s<2],n=i.clone$2(this.min),l=i.clone$2(this.max),v=0;v<a.length;v++)n[v]=a[v]?this.min[v]:this.center[v],l[v]=a[v]?this.center[v]:this.max[v];return l[2]=this.max[2],new zu(n,l)},zu.prototype.distanceX=function(s){return Math.max(Math.min(this.max[0],s[0]),this.min[0])-s[0]},zu.prototype.distanceY=function(s){return Math.max(Math.min(this.max[1],s[1]),this.min[1])-s[1]},zu.prototype.intersects=function(s){for(var a=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],n=!0,l=0;l<s.planes.length;l++){for(var v=s.planes[l],O=0,L=0;L<a.length;L++)O+=i.dot$1(v,a[L])>=0;if(O===0)return 0;O!==a.length&&(n=!1)}if(n)return 2;for(var j=0;j<3;j++){for(var ue=Number.MAX_VALUE,Ee=-Number.MAX_VALUE,$e=0;$e<s.points.length;$e++){var nt=s.points[$e][j]-this.min[j];ue=Math.min(ue,nt),Ee=Math.max(Ee,nt)}if(Ee<0||ue>this.max[j]-this.min[j])return 0}return 1};var fi=function(a,n,l,v){if(a===void 0&&(a=0),n===void 0&&(n=0),l===void 0&&(l=0),v===void 0&&(v=0),isNaN(a)||a<0||isNaN(n)||n<0||isNaN(l)||l<0||isNaN(v)||v<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=a,this.bottom=n,this.left=l,this.right=v};fi.prototype.interpolate=function(s,a,n){return a.top!=null&&s.top!=null&&(this.top=i.number(s.top,a.top,n)),a.bottom!=null&&s.bottom!=null&&(this.bottom=i.number(s.bottom,a.bottom,n)),a.left!=null&&s.left!=null&&(this.left=i.number(s.left,a.left,n)),a.right!=null&&s.right!=null&&(this.right=i.number(s.right,a.right,n)),this},fi.prototype.getCenter=function(s,a){var n=i.clamp((this.left+s-this.right)/2,0,s),l=i.clamp((this.top+a-this.bottom)/2,0,a);return new i.Point(n,l)},fi.prototype.equals=function(s){return this.top===s.top&&this.bottom===s.bottom&&this.left===s.left&&this.right===s.right},fi.prototype.clone=function(){return new fi(this.top,this.bottom,this.left,this.right)},fi.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var kn=function(a,n,l,v,O){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=O===void 0||O,this._minZoom=a||0,this._maxZoom=n||22,this._minPitch=l==null?0:l,this._maxPitch=v==null?60:v,this.setMaxBounds(),this.width=0,this.height=0,this._center=new i.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new fi,this._posMatrixCache={},this._alignedPosMatrixCache={}},Li={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};kn.prototype.clone=function(){var s=new kn(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return s.tileSize=this.tileSize,s.latRange=this.latRange,s.width=this.width,s.height=this.height,s._center=this._center,s.zoom=this.zoom,s.angle=this.angle,s._fov=this._fov,s._pitch=this._pitch,s._unmodified=this._unmodified,s._edgeInsets=this._edgeInsets.clone(),s._calcMatrices(),s},Li.minZoom.get=function(){return this._minZoom},Li.minZoom.set=function(s){this._minZoom!==s&&(this._minZoom=s,this.zoom=Math.max(this.zoom,s))},Li.maxZoom.get=function(){return this._maxZoom},Li.maxZoom.set=function(s){this._maxZoom!==s&&(this._maxZoom=s,this.zoom=Math.min(this.zoom,s))},Li.minPitch.get=function(){return this._minPitch},Li.minPitch.set=function(s){this._minPitch!==s&&(this._minPitch=s,this.pitch=Math.max(this.pitch,s))},Li.maxPitch.get=function(){return this._maxPitch},Li.maxPitch.set=function(s){this._maxPitch!==s&&(this._maxPitch=s,this.pitch=Math.min(this.pitch,s))},Li.renderWorldCopies.get=function(){return this._renderWorldCopies},Li.renderWorldCopies.set=function(s){s===void 0?s=!0:s===null&&(s=!1),this._renderWorldCopies=s},Li.worldSize.get=function(){return this.tileSize*this.scale},Li.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},Li.size.get=function(){return new i.Point(this.width,this.height)},Li.bearing.get=function(){return-this.angle/Math.PI*180},Li.bearing.set=function(s){var a=-i.wrap(s,-180,180)*Math.PI/180;this.angle!==a&&(this._unmodified=!1,this.angle=a,this._calcMatrices(),this.rotationMatrix=i.create$2(),i.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},Li.pitch.get=function(){return this._pitch/Math.PI*180},Li.pitch.set=function(s){var a=i.clamp(s,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==a&&(this._unmodified=!1,this._pitch=a,this._calcMatrices())},Li.fov.get=function(){return this._fov/Math.PI*180},Li.fov.set=function(s){s=Math.max(.01,Math.min(60,s)),this._fov!==s&&(this._unmodified=!1,this._fov=s/180*Math.PI,this._calcMatrices())},Li.zoom.get=function(){return this._zoom},Li.zoom.set=function(s){var a=Math.min(Math.max(s,this.minZoom),this.maxZoom);this._zoom!==a&&(this._unmodified=!1,this._zoom=a,this.scale=this.zoomScale(a),this.tileZoom=Math.floor(a),this.zoomFraction=a-this.tileZoom,this._constrain(),this._calcMatrices())},Li.center.get=function(){return this._center},Li.center.set=function(s){s.lat===this._center.lat&&s.lng===this._center.lng||(this._unmodified=!1,this._center=s,this._constrain(),this._calcMatrices())},Li.padding.get=function(){return this._edgeInsets.toJSON()},Li.padding.set=function(s){this._edgeInsets.equals(s)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,s,1),this._calcMatrices())},Li.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},kn.prototype.isPaddingEqual=function(s){return this._edgeInsets.equals(s)},kn.prototype.interpolatePadding=function(s,a,n){this._unmodified=!1,this._edgeInsets.interpolate(s,a,n),this._constrain(),this._calcMatrices()},kn.prototype.coveringZoomLevel=function(s){var a=(s.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/s.tileSize));return Math.max(0,a)},kn.prototype.getVisibleUnwrappedCoordinates=function(s){var a=[new i.UnwrappedTileID(0,s)];if(this._renderWorldCopies)for(var n=this.pointCoordinate(new i.Point(0,0)),l=this.pointCoordinate(new i.Point(this.width,0)),v=this.pointCoordinate(new i.Point(this.width,this.height)),O=this.pointCoordinate(new i.Point(0,this.height)),L=Math.floor(Math.min(n.x,l.x,v.x,O.x)),j=Math.floor(Math.max(n.x,l.x,v.x,O.x)),ue=L-1;ue<=j+1;ue++)ue!==0&&a.push(new i.UnwrappedTileID(ue,s));return a},kn.prototype.coveringTiles=function(s){var a=this.coveringZoomLevel(s),n=a;if(s.minzoom!==void 0&&a<s.minzoom)return[];s.maxzoom!==void 0&&a>s.maxzoom&&(a=s.maxzoom);var l=i.MercatorCoordinate.fromLngLat(this.center),v=Math.pow(2,a),O=[v*l.x,v*l.y,0],L=nl.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,a),j=s.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(j=a);var ue=function(vn){return{aabb:new zu([vn*v,0,0],[(vn+1)*v,v,0]),zoom:0,x:0,y:0,wrap:vn,fullyVisible:!1}},Ee=[],$e=[],nt=a,at=s.reparseOverscaled?n:a;if(this._renderWorldCopies)for(var Ft=1;Ft<=3;Ft++)Ee.push(ue(-Ft)),Ee.push(ue(Ft));for(Ee.push(ue(0));Ee.length>0;){var Nt=Ee.pop(),Jt=Nt.x,jt=Nt.y,Gt=Nt.fullyVisible;if(!Gt){var ar=Nt.aabb.intersects(L);if(ar===0)continue;Gt=ar===2}var nr=Nt.aabb.distanceX(O),Rr=Nt.aabb.distanceY(O),gr=Math.max(Math.abs(nr),Math.abs(Rr));if(Nt.zoom===nt||gr>3+(1<<nt-Nt.zoom)-2&&Nt.zoom>=j)$e.push({tileID:new i.OverscaledTileID(Nt.zoom===nt?at:Nt.zoom,Nt.wrap,Nt.zoom,Jt,jt),distanceSq:i.sqrLen([O[0]-.5-Jt,O[1]-.5-jt])});else for(var Ar=0;Ar<4;Ar++){var Cr=(Jt<<1)+Ar%2,an=(jt<<1)+(Ar>>1);Ee.push({aabb:Nt.aabb.quadrant(Ar),zoom:Nt.zoom+1,x:Cr,y:an,wrap:Nt.wrap,fullyVisible:Gt})}}return $e.sort(function(Yr,vn){return Yr.distanceSq-vn.distanceSq}).map(function(Yr){return Yr.tileID})},kn.prototype.resize=function(s,a){this.width=s,this.height=a,this.pixelsToGLUnits=[2/s,-2/a],this._constrain(),this._calcMatrices()},Li.unmodified.get=function(){return this._unmodified},kn.prototype.zoomScale=function(s){return Math.pow(2,s)},kn.prototype.scaleZoom=function(s){return Math.log(s)/Math.LN2},kn.prototype.project=function(s){var a=i.clamp(s.lat,-this.maxValidLatitude,this.maxValidLatitude);return new i.Point(i.mercatorXfromLng(s.lng)*this.worldSize,i.mercatorYfromLat(a)*this.worldSize)},kn.prototype.unproject=function(s){return new i.MercatorCoordinate(s.x/this.worldSize,s.y/this.worldSize).toLngLat()},Li.point.get=function(){return this.project(this.center)},kn.prototype.setLocationAtPoint=function(s,a){var n=this.pointCoordinate(a),l=this.pointCoordinate(this.centerPoint),v=this.locationCoordinate(s),O=new i.MercatorCoordinate(v.x-(n.x-l.x),v.y-(n.y-l.y));this.center=this.coordinateLocation(O),this._renderWorldCopies&&(this.center=this.center.wrap())},kn.prototype.locationPoint=function(s){return this.coordinatePoint(this.locationCoordinate(s))},kn.prototype.pointLocation=function(s){return this.coordinateLocation(this.pointCoordinate(s))},kn.prototype.locationCoordinate=function(s){return i.MercatorCoordinate.fromLngLat(s)},kn.prototype.coordinateLocation=function(s){return s.toLngLat()},kn.prototype.pointCoordinate=function(s){var a=[s.x,s.y,0,1],n=[s.x,s.y,1,1];i.transformMat4(a,a,this.pixelMatrixInverse),i.transformMat4(n,n,this.pixelMatrixInverse);var l=a[3],v=n[3],O=a[1]/l,L=n[1]/v,j=a[2]/l,ue=n[2]/v,Ee=j===ue?0:(0-j)/(ue-j);return new i.MercatorCoordinate(i.number(a[0]/l,n[0]/v,Ee)/this.worldSize,i.number(O,L,Ee)/this.worldSize)},kn.prototype.coordinatePoint=function(s){var a=[s.x*this.worldSize,s.y*this.worldSize,0,1];return i.transformMat4(a,a,this.pixelMatrix),new i.Point(a[0]/a[3],a[1]/a[3])},kn.prototype.getBounds=function(){return new i.LngLatBounds().extend(this.pointLocation(new i.Point(0,0))).extend(this.pointLocation(new i.Point(this.width,0))).extend(this.pointLocation(new i.Point(this.width,this.height))).extend(this.pointLocation(new i.Point(0,this.height)))},kn.prototype.getMaxBounds=function(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new i.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},kn.prototype.setMaxBounds=function(s){s?(this.lngRange=[s.getWest(),s.getEast()],this.latRange=[s.getSouth(),s.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},kn.prototype.calculatePosMatrix=function(s,a){a===void 0&&(a=!1);var n=s.key,l=a?this._alignedPosMatrixCache:this._posMatrixCache;if(l[n])return l[n];var v=s.canonical,O=this.worldSize/this.zoomScale(v.z),L=v.x+Math.pow(2,v.z)*s.wrap,j=i.identity(new Float64Array(16));return i.translate(j,j,[L*O,v.y*O,0]),i.scale(j,j,[O/i.EXTENT,O/i.EXTENT,1]),i.multiply(j,a?this.alignedProjMatrix:this.projMatrix,j),l[n]=new Float32Array(j),l[n]},kn.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},kn.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var s,a,n,l,v=-90,O=90,L=-180,j=180,ue=this.size,Ee=this._unmodified;if(this.latRange){var $e=this.latRange;v=i.mercatorYfromLat($e[1])*this.worldSize,s=(O=i.mercatorYfromLat($e[0])*this.worldSize)-v<ue.y?ue.y/(O-v):0}if(this.lngRange){var nt=this.lngRange;L=i.mercatorXfromLng(nt[0])*this.worldSize,a=(j=i.mercatorXfromLng(nt[1])*this.worldSize)-L<ue.x?ue.x/(j-L):0}var at=this.point,Ft=Math.max(a||0,s||0);if(Ft)return this.center=this.unproject(new i.Point(a?(j+L)/2:at.x,s?(O+v)/2:at.y)),this.zoom+=this.scaleZoom(Ft),this._unmodified=Ee,void(this._constraining=!1);if(this.latRange){var Nt=at.y,Jt=ue.y/2;Nt-Jt<v&&(l=v+Jt),Nt+Jt>O&&(l=O-Jt)}if(this.lngRange){var jt=at.x,Gt=ue.x/2;jt-Gt<L&&(n=L+Gt),jt+Gt>j&&(n=j-Gt)}n===void 0&&l===void 0||(this.center=this.unproject(new i.Point(n!==void 0?n:at.x,l!==void 0?l:at.y))),this._unmodified=Ee,this._constraining=!1}},kn.prototype._calcMatrices=function(){if(this.height){var s=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var a=Math.PI/2+this._pitch,n=this._fov*(.5+s.y/this.height),l=Math.sin(n)*this.cameraToCenterDistance/Math.sin(i.clamp(Math.PI-a-n,.01,Math.PI-.01)),v=this.point,O=v.x,L=v.y,j=1.01*(Math.cos(Math.PI/2-this._pitch)*l+this.cameraToCenterDistance),ue=this.height/50,Ee=new Float64Array(16);i.perspective(Ee,this._fov,this.width/this.height,ue,j),Ee[8]=2*-s.x/this.width,Ee[9]=2*s.y/this.height,i.scale(Ee,Ee,[1,-1,1]),i.translate(Ee,Ee,[0,0,-this.cameraToCenterDistance]),i.rotateX(Ee,Ee,this._pitch),i.rotateZ(Ee,Ee,this.angle),i.translate(Ee,Ee,[-O,-L,0]),this.mercatorMatrix=i.scale([],Ee,[this.worldSize,this.worldSize,this.worldSize]),i.scale(Ee,Ee,[1,1,i.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=Ee,this.invProjMatrix=i.invert([],this.projMatrix);var $e=this.width%2/2,nt=this.height%2/2,at=Math.cos(this.angle),Ft=Math.sin(this.angle),Nt=O-Math.round(O)+at*$e+Ft*nt,Jt=L-Math.round(L)+at*nt+Ft*$e,jt=new Float64Array(Ee);if(i.translate(jt,jt,[Nt>.5?Nt-1:Nt,Jt>.5?Jt-1:Jt,0]),this.alignedProjMatrix=jt,Ee=i.create(),i.scale(Ee,Ee,[this.width/2,-this.height/2,1]),i.translate(Ee,Ee,[1,-1,0]),this.labelPlaneMatrix=Ee,Ee=i.create(),i.scale(Ee,Ee,[1,-1,1]),i.translate(Ee,Ee,[-1,-1,0]),i.scale(Ee,Ee,[2/this.width,2/this.height,1]),this.glCoordMatrix=Ee,this.pixelMatrix=i.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(Ee=i.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=Ee,this._posMatrixCache={},this._alignedPosMatrixCache={}}},kn.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var s=this.pointCoordinate(new i.Point(0,0)),a=[s.x*this.worldSize,s.y*this.worldSize,0,1];return i.transformMat4(a,a,this.pixelMatrix)[3]/this.cameraToCenterDistance},kn.prototype.getCameraPoint=function(){var s=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new i.Point(0,s))},kn.prototype.getCameraQueryGeometry=function(s){var a=this.getCameraPoint();if(s.length===1)return[s[0],a];for(var n=a.x,l=a.y,v=a.x,O=a.y,L=0,j=s;L<j.length;L+=1){var ue=j[L];n=Math.min(n,ue.x),l=Math.min(l,ue.y),v=Math.max(v,ue.x),O=Math.max(O,ue.y)}return[new i.Point(n,l),new i.Point(v,l),new i.Point(v,O),new i.Point(n,O),new i.Point(n,l)]},Object.defineProperties(kn.prototype,Li);var Ls=function(a){var n,l,v,O;this._hashName=a&&encodeURIComponent(a),i.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(n=this._updateHashUnthrottled.bind(this),l=!1,v=null,O=function(){v=null,l&&(n(),v=setTimeout(O,300),l=!1)},function(){return l=!0,v||O(),v})};Ls.prototype.addTo=function(s){return this._map=s,i.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},Ls.prototype.remove=function(){return i.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},Ls.prototype.getHashString=function(s){var a=this._map.getCenter(),n=Math.round(100*this._map.getZoom())/100,l=Math.ceil((n*Math.LN2+Math.log(512/360/.5))/Math.LN10),v=Math.pow(10,l),O=Math.round(a.lng*v)/v,L=Math.round(a.lat*v)/v,j=this._map.getBearing(),ue=this._map.getPitch(),Ee="";if(Ee+=s?"/"+O+"/"+L+"/"+n:n+"/"+L+"/"+O,(j||ue)&&(Ee+="/"+Math.round(10*j)/10),ue&&(Ee+="/"+Math.round(ue)),this._hashName){var $e=this._hashName,nt=!1,at=i.window.location.hash.slice(1).split("&").map(function(Ft){var Nt=Ft.split("=")[0];return Nt===$e?(nt=!0,Nt+"="+Ee):Ft}).filter(function(Ft){return Ft});return nt||at.push($e+"="+Ee),"#"+at.join("&")}return"#"+Ee},Ls.prototype._getCurrentHash=function(){var s,a=this,n=i.window.location.hash.replace("#","");return this._hashName?(n.split("&").map(function(l){return l.split("=")}).forEach(function(l){l[0]===a._hashName&&(s=l)}),(s&&s[1]||"").split("/")):n.split("/")},Ls.prototype._onHashChange=function(){var s=this._getCurrentHash();if(s.length>=3&&!s.some(function(n){return isNaN(n)})){var a=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(s[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+s[2],+s[1]],zoom:+s[0],bearing:a,pitch:+(s[4]||0)}),!0}return!1},Ls.prototype._updateHashUnthrottled=function(){var s=i.window.location.href.replace(/(#.+)?$/,this.getHashString());try{i.window.history.replaceState(i.window.history.state,null,s)}catch(a){}};var Dl={linearity:.3,easing:i.bezier(0,0,.3,1)},Uu=i.extend({deceleration:2500,maxSpeed:1400},Dl),al=i.extend({deceleration:20,maxSpeed:1400},Dl),gf=i.extend({deceleration:1e3,maxSpeed:360},Dl),ss=i.extend({deceleration:1e3,maxSpeed:90},Dl),_l=function(a){this._map=a,this.clear()};function il(s,a){(!s.duration||s.duration<a.duration)&&(s.duration=a.duration,s.easing=a.easing)}function ol(s,a,n){var l=n.maxSpeed,v=n.linearity,O=n.deceleration,L=i.clamp(s*v/(a/1e3),-l,l),j=Math.abs(L)/(O*v);return{easing:n.easing,duration:1e3*j,amount:L*(j/2)}}_l.prototype.clear=function(){this._inertiaBuffer=[]},_l.prototype.record=function(s){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:i.browser.now(),settings:s})},_l.prototype._drainInertiaBuffer=function(){for(var s=this._inertiaBuffer,a=i.browser.now();s.length>0&&a-s[0].time>160;)s.shift()},_l.prototype._onMoveEnd=function(s){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var a={zoom:0,bearing:0,pitch:0,pan:new i.Point(0,0),pinchAround:void 0,around:void 0},n=0,l=this._inertiaBuffer;n<l.length;n+=1){var v=l[n].settings;a.zoom+=v.zoomDelta||0,a.bearing+=v.bearingDelta||0,a.pitch+=v.pitchDelta||0,v.panDelta&&a.pan._add(v.panDelta),v.around&&(a.around=v.around),v.pinchAround&&(a.pinchAround=v.pinchAround)}var O=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,L={};if(a.pan.mag()){var j=ol(a.pan.mag(),O,i.extend({},Uu,s||{}));L.offset=a.pan.mult(j.amount/a.pan.mag()),L.center=this._map.transform.center,il(L,j)}if(a.zoom){var ue=ol(a.zoom,O,al);L.zoom=this._map.transform.zoom+ue.amount,il(L,ue)}if(a.bearing){var Ee=ol(a.bearing,O,gf);L.bearing=this._map.transform.bearing+i.clamp(Ee.amount,-179,179),il(L,Ee)}if(a.pitch){var $e=ol(a.pitch,O,ss);L.pitch=this._map.transform.pitch+$e.amount,il(L,$e)}if(L.zoom||L.bearing){var nt=a.pinchAround===void 0?a.around:a.pinchAround;L.around=nt?this._map.unproject(nt):this._map.getCenter()}return this.clear(),i.extend(L,{noMoveStart:!0})}};var Ui=function(s){function a(l,v,O,L){L===void 0&&(L={});var j=D.mousePos(v.getCanvasContainer(),O),ue=v.unproject(j);s.call(this,l,i.extend({point:j,lngLat:ue,originalEvent:O},L)),this._defaultPrevented=!1,this.target=v}s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a;var n={defaultPrevented:{configurable:!0}};return a.prototype.preventDefault=function(){this._defaultPrevented=!0},n.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(a.prototype,n),a}(i.Event),As=function(s){function a(l,v,O){var L=l==="touchend"?O.changedTouches:O.touches,j=D.touchPos(v.getCanvasContainer(),L),ue=j.map(function(nt){return v.unproject(nt)}),Ee=j.reduce(function(nt,at,Ft,Nt){return nt.add(at.div(Nt.length))},new i.Point(0,0)),$e=v.unproject(Ee);s.call(this,l,{points:j,point:Ee,lngLats:ue,lngLat:$e,originalEvent:O}),this._defaultPrevented=!1}s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a;var n={defaultPrevented:{configurable:!0}};return a.prototype.preventDefault=function(){this._defaultPrevented=!0},n.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(a.prototype,n),a}(i.Event),Nl=function(s){function a(l,v,O){s.call(this,l,{originalEvent:O}),this._defaultPrevented=!1}s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a;var n={defaultPrevented:{configurable:!0}};return a.prototype.preventDefault=function(){this._defaultPrevented=!0},n.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(a.prototype,n),a}(i.Event),to=function(a,n){this._map=a,this._clickTolerance=n.clickTolerance};to.prototype.reset=function(){delete this._mousedownPos},to.prototype.wheel=function(s){return this._firePreventable(new Nl(s.type,this._map,s))},to.prototype.mousedown=function(s,a){return this._mousedownPos=a,this._firePreventable(new Ui(s.type,this._map,s))},to.prototype.mouseup=function(s){this._map.fire(new Ui(s.type,this._map,s))},to.prototype.click=function(s,a){this._mousedownPos&&this._mousedownPos.dist(a)>=this._clickTolerance||this._map.fire(new Ui(s.type,this._map,s))},to.prototype.dblclick=function(s){return this._firePreventable(new Ui(s.type,this._map,s))},to.prototype.mouseover=function(s){this._map.fire(new Ui(s.type,this._map,s))},to.prototype.mouseout=function(s){this._map.fire(new Ui(s.type,this._map,s))},to.prototype.touchstart=function(s){return this._firePreventable(new As(s.type,this._map,s))},to.prototype.touchmove=function(s){this._map.fire(new As(s.type,this._map,s))},to.prototype.touchend=function(s){this._map.fire(new As(s.type,this._map,s))},to.prototype.touchcancel=function(s){this._map.fire(new As(s.type,this._map,s))},to.prototype._firePreventable=function(s){if(this._map.fire(s),s.defaultPrevented)return{}},to.prototype.isEnabled=function(){return!0},to.prototype.isActive=function(){return!1},to.prototype.enable=function(){},to.prototype.disable=function(){};var Rn=function(a){this._map=a};Rn.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},Rn.prototype.mousemove=function(s){this._map.fire(new Ui(s.type,this._map,s))},Rn.prototype.mousedown=function(){this._delayContextMenu=!0},Rn.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Ui("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},Rn.prototype.contextmenu=function(s){this._delayContextMenu?this._contextMenuEvent=s:this._map.fire(new Ui(s.type,this._map,s)),this._map.listens("contextmenu")&&s.preventDefault()},Rn.prototype.isEnabled=function(){return!0},Rn.prototype.isActive=function(){return!1},Rn.prototype.enable=function(){},Rn.prototype.disable=function(){};var Us=function(a,n){this._map=a,this._el=a.getCanvasContainer(),this._container=a.getContainer(),this._clickTolerance=n.clickTolerance||1};function ni(s,a){for(var n={},l=0;l<s.length;l++)n[s[l].identifier]=a[l];return n}Us.prototype.isEnabled=function(){return!!this._enabled},Us.prototype.isActive=function(){return!!this._active},Us.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},Us.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Us.prototype.mousedown=function(s,a){this.isEnabled()&&s.shiftKey&&s.button===0&&(D.disableDrag(),this._startPos=this._lastPos=a,this._active=!0)},Us.prototype.mousemoveWindow=function(s,a){if(this._active){var n=a;if(!(this._lastPos.equals(n)||!this._box&&n.dist(this._startPos)<this._clickTolerance)){var l=this._startPos;this._lastPos=n,this._box||(this._box=D.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",s));var v=Math.min(l.x,n.x),O=Math.max(l.x,n.x),L=Math.min(l.y,n.y),j=Math.max(l.y,n.y);D.setTransform(this._box,"translate("+v+"px,"+L+"px)"),this._box.style.width=O-v+"px",this._box.style.height=j-L+"px"}}},Us.prototype.mouseupWindow=function(s,a){var n=this;if(this._active&&s.button===0){var l=this._startPos,v=a;if(this.reset(),D.suppressClick(),l.x!==v.x||l.y!==v.y)return this._map.fire(new i.Event("boxzoomend",{originalEvent:s})),{cameraAnimation:function(L){return L.fitScreenCoordinates(l,v,n._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",s)}},Us.prototype.keydown=function(s){this._active&&s.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",s))},Us.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(D.remove(this._box),this._box=null),D.enableDrag(),delete this._startPos,delete this._lastPos},Us.prototype._fireEvent=function(s,a){return this._map.fire(new i.Event(s,{originalEvent:a}))};var kl=function(a){this.reset(),this.numTouches=a.numTouches};kl.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},kl.prototype.touchstart=function(s,a,n){(this.centroid||n.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=s.timeStamp),n.length===this.numTouches&&(this.centroid=function(l){for(var v=new i.Point(0,0),O=0,L=l;O<L.length;O+=1)v._add(L[O]);return v.div(l.length)}(a),this.touches=ni(n,a)))},kl.prototype.touchmove=function(s,a,n){if(!this.aborted&&this.centroid){var l=ni(n,a);for(var v in this.touches){var O=l[v];(!O||O.dist(this.touches[v])>30)&&(this.aborted=!0)}}},kl.prototype.touchend=function(s,a,n){if((!this.centroid||s.timeStamp-this.startTime>500)&&(this.aborted=!0),n.length===0){var l=!this.aborted&&this.centroid;if(this.reset(),l)return l}};var du=function(a){this.singleTap=new kl(a),this.numTaps=a.numTaps,this.reset()};du.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},du.prototype.touchstart=function(s,a,n){this.singleTap.touchstart(s,a,n)},du.prototype.touchmove=function(s,a,n){this.singleTap.touchmove(s,a,n)},du.prototype.touchend=function(s,a,n){var l=this.singleTap.touchend(s,a,n);if(l){var v=s.timeStamp-this.lastTime<500,O=!this.lastTap||this.lastTap.dist(l)<30;if(v&&O||this.reset(),this.count++,this.lastTime=s.timeStamp,this.lastTap=l,this.count===this.numTaps)return this.reset(),l}};var Bs=function(){this._zoomIn=new du({numTouches:1,numTaps:2}),this._zoomOut=new du({numTouches:2,numTaps:1}),this.reset()};Bs.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},Bs.prototype.touchstart=function(s,a,n){this._zoomIn.touchstart(s,a,n),this._zoomOut.touchstart(s,a,n)},Bs.prototype.touchmove=function(s,a,n){this._zoomIn.touchmove(s,a,n),this._zoomOut.touchmove(s,a,n)},Bs.prototype.touchend=function(s,a,n){var l=this,v=this._zoomIn.touchend(s,a,n),O=this._zoomOut.touchend(s,a,n);return v?(this._active=!0,s.preventDefault(),setTimeout(function(){return l.reset()},0),{cameraAnimation:function(j){return j.easeTo({duration:300,zoom:j.getZoom()+1,around:j.unproject(v)},{originalEvent:s})}}):O?(this._active=!0,s.preventDefault(),setTimeout(function(){return l.reset()},0),{cameraAnimation:function(j){return j.easeTo({duration:300,zoom:j.getZoom()-1,around:j.unproject(O)},{originalEvent:s})}}):void 0},Bs.prototype.touchcancel=function(){this.reset()},Bs.prototype.enable=function(){this._enabled=!0},Bs.prototype.disable=function(){this._enabled=!1,this.reset()},Bs.prototype.isEnabled=function(){return this._enabled},Bs.prototype.isActive=function(){return this._active};var sl={0:1,2:2},tn=function(a){this.reset(),this._clickTolerance=a.clickTolerance||1};tn.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},tn.prototype._correctButton=function(s,a){return!1},tn.prototype._move=function(s,a){return{}},tn.prototype.mousedown=function(s,a){if(!this._lastPoint){var n=D.mouseButton(s);this._correctButton(s,n)&&(this._lastPoint=a,this._eventButton=n)}},tn.prototype.mousemoveWindow=function(s,a){var n=this._lastPoint;if(n){if(s.preventDefault(),function(l,v){var O=sl[v];return l.buttons===void 0||(l.buttons&O)!==O}(s,this._eventButton))this.reset();else if(this._moved||!(a.dist(n)<this._clickTolerance))return this._moved=!0,this._lastPoint=a,this._move(n,a)}},tn.prototype.mouseupWindow=function(s){this._lastPoint&&D.mouseButton(s)===this._eventButton&&(this._moved&&D.suppressClick(),this.reset())},tn.prototype.enable=function(){this._enabled=!0},tn.prototype.disable=function(){this._enabled=!1,this.reset()},tn.prototype.isEnabled=function(){return this._enabled},tn.prototype.isActive=function(){return this._active};var bc=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.mousedown=function(n,l){s.prototype.mousedown.call(this,n,l),this._lastPoint&&(this._active=!0)},a.prototype._correctButton=function(n,l){return l===0&&!n.ctrlKey},a.prototype._move=function(n,l){return{around:l,panDelta:l.sub(n)}},a}(tn),us=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype._correctButton=function(n,l){return l===0&&n.ctrlKey||l===2},a.prototype._move=function(n,l){var v=.8*(l.x-n.x);if(v)return this._active=!0,{bearingDelta:v}},a.prototype.contextmenu=function(n){n.preventDefault()},a}(tn),ro=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype._correctButton=function(n,l){return l===0&&n.ctrlKey||l===2},a.prototype._move=function(n,l){var v=-.5*(l.y-n.y);if(v)return this._active=!0,{pitchDelta:v}},a.prototype.contextmenu=function(n){n.preventDefault()},a}(tn),qo=function(a){this._minTouches=1,this._clickTolerance=a.clickTolerance||1,this.reset()};qo.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new i.Point(0,0)},qo.prototype.touchstart=function(s,a,n){return this._calculateTransform(s,a,n)},qo.prototype.touchmove=function(s,a,n){if(this._active&&!(n.length<this._minTouches))return s.preventDefault(),this._calculateTransform(s,a,n)},qo.prototype.touchend=function(s,a,n){this._calculateTransform(s,a,n),this._active&&n.length<this._minTouches&&this.reset()},qo.prototype.touchcancel=function(){this.reset()},qo.prototype._calculateTransform=function(s,a,n){n.length>0&&(this._active=!0);var l=ni(n,a),v=new i.Point(0,0),O=new i.Point(0,0),L=0;for(var j in l){var ue=l[j],Ee=this._touches[j];Ee&&(v._add(ue),O._add(ue.sub(Ee)),L++,l[j]=ue)}if(this._touches=l,!(L<this._minTouches)&&O.mag()){var $e=O.div(L);if(this._sum._add($e),!(this._sum.mag()<this._clickTolerance))return{around:v.div(L),panDelta:$e}}},qo.prototype.enable=function(){this._enabled=!0},qo.prototype.disable=function(){this._enabled=!1,this.reset()},qo.prototype.isEnabled=function(){return this._enabled},qo.prototype.isActive=function(){return this._active};var Rs=function(){this.reset()};function jl(s,a,n){for(var l=0;l<s.length;l++)if(s[l].identifier===n)return a[l]}function kc(s,a){return Math.log(s/a)/Math.LN2}Rs.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},Rs.prototype._start=function(s){},Rs.prototype._move=function(s,a,n){return{}},Rs.prototype.touchstart=function(s,a,n){this._firstTwoTouches||n.length<2||(this._firstTwoTouches=[n[0].identifier,n[1].identifier],this._start([a[0],a[1]]))},Rs.prototype.touchmove=function(s,a,n){if(this._firstTwoTouches){s.preventDefault();var l=this._firstTwoTouches,v=l[1],O=jl(n,a,l[0]),L=jl(n,a,v);if(O&&L){var j=this._aroundCenter?null:O.add(L).div(2);return this._move([O,L],j,s)}}},Rs.prototype.touchend=function(s,a,n){if(this._firstTwoTouches){var l=this._firstTwoTouches,v=l[1],O=jl(n,a,l[0]),L=jl(n,a,v);O&&L||(this._active&&D.suppressClick(),this.reset())}},Rs.prototype.touchcancel=function(){this.reset()},Rs.prototype.enable=function(s){this._enabled=!0,this._aroundCenter=!!s&&s.around==="center"},Rs.prototype.disable=function(){this._enabled=!1,this.reset()},Rs.prototype.isEnabled=function(){return this._enabled},Rs.prototype.isActive=function(){return this._active};var Vs=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.reset=function(){s.prototype.reset.call(this),delete this._distance,delete this._startDistance},a.prototype._start=function(n){this._startDistance=this._distance=n[0].dist(n[1])},a.prototype._move=function(n,l){var v=this._distance;if(this._distance=n[0].dist(n[1]),this._active||!(Math.abs(kc(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:kc(this._distance,v),pinchAround:l}},a}(Rs);function Su(s,a){return 180*s.angleWith(a)/Math.PI}var Fl=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.reset=function(){s.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},a.prototype._start=function(n){this._startVector=this._vector=n[0].sub(n[1]),this._minDiameter=n[0].dist(n[1])},a.prototype._move=function(n,l){var v=this._vector;if(this._vector=n[0].sub(n[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Su(this._vector,v),pinchAround:l}},a.prototype._isBelowThreshold=function(n){this._minDiameter=Math.min(this._minDiameter,n.mag());var l=25/(Math.PI*this._minDiameter)*360,v=Su(n,this._startVector);return Math.abs(v)<l},a}(Rs);function zl(s){return Math.abs(s.y)>Math.abs(s.x)}var rf=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.reset=function(){s.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},a.prototype._start=function(n){this._lastPoints=n,zl(n[0].sub(n[1]))&&(this._valid=!1)},a.prototype._move=function(n,l,v){var O=n[0].sub(this._lastPoints[0]),L=n[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(O,L,v.timeStamp),this._valid)return this._lastPoints=n,this._active=!0,{pitchDelta:(O.y+L.y)/2*-.5}},a.prototype.gestureBeginsVertically=function(n,l,v){if(this._valid!==void 0)return this._valid;var O=n.mag()>=2,L=l.mag()>=2;if(O||L){if(!O||!L)return this._firstMove===void 0&&(this._firstMove=v),v-this._firstMove<100&&void 0;var j=n.y>0==l.y>0;return zl(n)&&zl(l)&&j}},a}(Rs),jc={panStep:100,bearingStep:15,pitchStep:10},Ro=function(){var a=jc;this._panStep=a.panStep,this._bearingStep=a.bearingStep,this._pitchStep=a.pitchStep,this._rotationDisabled=!1};function ls(s){return s*(2-s)}Ro.prototype.reset=function(){this._active=!1},Ro.prototype.keydown=function(s){var a=this;if(!(s.altKey||s.ctrlKey||s.metaKey)){var n=0,l=0,v=0,O=0,L=0;switch(s.keyCode){case 61:case 107:case 171:case 187:n=1;break;case 189:case 109:case 173:n=-1;break;case 37:s.shiftKey?l=-1:(s.preventDefault(),O=-1);break;case 39:s.shiftKey?l=1:(s.preventDefault(),O=1);break;case 38:s.shiftKey?v=1:(s.preventDefault(),L=-1);break;case 40:s.shiftKey?v=-1:(s.preventDefault(),L=1);break;default:return}return this._rotationDisabled&&(l=0,v=0),{cameraAnimation:function(ue){var Ee=ue.getZoom();ue.easeTo({duration:300,easeId:"keyboardHandler",easing:ls,zoom:n?Math.round(Ee)+n*(s.shiftKey?2:1):Ee,bearing:ue.getBearing()+l*a._bearingStep,pitch:ue.getPitch()+v*a._pitchStep,offset:[-O*a._panStep,-L*a._panStep],center:ue.getCenter()},{originalEvent:s})}}}},Ro.prototype.enable=function(){this._enabled=!0},Ro.prototype.disable=function(){this._enabled=!1,this.reset()},Ro.prototype.isEnabled=function(){return this._enabled},Ro.prototype.isActive=function(){return this._active},Ro.prototype.disableRotation=function(){this._rotationDisabled=!0},Ro.prototype.enableRotation=function(){this._rotationDisabled=!1};var Pa=function(a,n){this._map=a,this._el=a.getCanvasContainer(),this._handler=n,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,i.bindAll(["_onTimeout"],this)};Pa.prototype.setZoomRate=function(s){this._defaultZoomRate=s},Pa.prototype.setWheelZoomRate=function(s){this._wheelZoomRate=s},Pa.prototype.isEnabled=function(){return!!this._enabled},Pa.prototype.isActive=function(){return!!this._active||this._finishTimeout!==void 0},Pa.prototype.isZooming=function(){return!!this._zooming},Pa.prototype.enable=function(s){this.isEnabled()||(this._enabled=!0,this._aroundCenter=s&&s.around==="center")},Pa.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Pa.prototype.wheel=function(s){if(this.isEnabled()){var a=s.deltaMode===i.window.WheelEvent.DOM_DELTA_LINE?40*s.deltaY:s.deltaY,n=i.browser.now(),l=n-(this._lastWheelEventTime||0);this._lastWheelEventTime=n,a!==0&&a%4.000244140625==0?this._type="wheel":a!==0&&Math.abs(a)<4?this._type="trackpad":l>400?(this._type=null,this._lastValue=a,this._timeout=setTimeout(this._onTimeout,40,s)):this._type||(this._type=Math.abs(l*a)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,a+=this._lastValue)),s.shiftKey&&a&&(a/=4),this._type&&(this._lastWheelEvent=s,this._delta-=a,this._active||this._start(s)),s.preventDefault()}},Pa.prototype._onTimeout=function(s){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(s)},Pa.prototype._start=function(s){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var a=D.mousePos(this._el,s);this._around=i.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(a)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},Pa.prototype.renderFrame=function(){var s=this;if(this._frameId&&(this._frameId=null,this.isActive())){var a=this._map.transform;if(this._delta!==0){var n=this._type==="wheel"&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,l=2/(1+Math.exp(-Math.abs(this._delta*n)));this._delta<0&&l!==0&&(l=1/l);var v=typeof this._targetZoom=="number"?a.zoomScale(this._targetZoom):a.scale;this._targetZoom=Math.min(a.maxZoom,Math.max(a.minZoom,a.scaleZoom(v*l))),this._type==="wheel"&&(this._startZoom=a.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var O,L=typeof this._targetZoom=="number"?this._targetZoom:a.zoom,j=this._startZoom,ue=this._easing,Ee=!1;if(this._type==="wheel"&&j&&ue){var $e=Math.min((i.browser.now()-this._lastWheelEventTime)/200,1),nt=ue($e);O=i.number(j,L,nt),$e<1?this._frameId||(this._frameId=!0):Ee=!0}else O=L,Ee=!0;return this._active=!0,Ee&&(this._active=!1,this._finishTimeout=setTimeout(function(){s._zooming=!1,s._handler._triggerRenderFrame(),delete s._targetZoom,delete s._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!Ee,zoomDelta:O-a.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},Pa.prototype._smoothOutEasing=function(s){var a=i.ease;if(this._prevEase){var n=this._prevEase,l=(i.browser.now()-n.start)/n.duration,v=n.easing(l+.01)-n.easing(l),O=.27/Math.sqrt(v*v+1e-4)*.01,L=Math.sqrt(.0729-O*O);a=i.bezier(O,L,.25,1)}return this._prevEase={start:i.browser.now(),duration:s,easing:a},a},Pa.prototype.reset=function(){this._active=!1};var eu=function(a,n){this._clickZoom=a,this._tapZoom=n};eu.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},eu.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},eu.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},eu.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var Io=function(){this.reset()};Io.prototype.reset=function(){this._active=!1},Io.prototype.dblclick=function(s,a){return s.preventDefault(),{cameraAnimation:function(l){l.easeTo({duration:300,zoom:l.getZoom()+(s.shiftKey?-1:1),around:l.unproject(a)},{originalEvent:s})}}},Io.prototype.enable=function(){this._enabled=!0},Io.prototype.disable=function(){this._enabled=!1,this.reset()},Io.prototype.isEnabled=function(){return this._enabled},Io.prototype.isActive=function(){return this._active};var So=function(){this._tap=new du({numTouches:1,numTaps:1}),this.reset()};So.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},So.prototype.touchstart=function(s,a,n){this._swipePoint||(this._tapTime&&s.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?n.length>0&&(this._swipePoint=a[0],this._swipeTouch=n[0].identifier):this._tap.touchstart(s,a,n))},So.prototype.touchmove=function(s,a,n){if(this._tapTime){if(this._swipePoint){if(n[0].identifier!==this._swipeTouch)return;var l=a[0],v=l.y-this._swipePoint.y;return this._swipePoint=l,s.preventDefault(),this._active=!0,{zoomDelta:v/128}}}else this._tap.touchmove(s,a,n)},So.prototype.touchend=function(s,a,n){this._tapTime?this._swipePoint&&n.length===0&&this.reset():this._tap.touchend(s,a,n)&&(this._tapTime=s.timeStamp)},So.prototype.touchcancel=function(){this.reset()},So.prototype.enable=function(){this._enabled=!0},So.prototype.disable=function(){this._enabled=!1,this.reset()},So.prototype.isEnabled=function(){return this._enabled},So.prototype.isActive=function(){return this._active};var Sl=function(a,n,l){this._el=a,this._mousePan=n,this._touchPan=l};Sl.prototype.enable=function(s){this._inertiaOptions=s||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},Sl.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},Sl.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},Sl.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var ul=function(a,n,l){this._pitchWithRotate=a.pitchWithRotate,this._mouseRotate=n,this._mousePitch=l};ul.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},ul.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},ul.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},ul.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var pu=function(a,n,l,v){this._el=a,this._touchZoom=n,this._touchRotate=l,this._tapDragZoom=v,this._rotationDisabled=!1,this._enabled=!0};pu.prototype.enable=function(s){this._touchZoom.enable(s),this._rotationDisabled||this._touchRotate.enable(s),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},pu.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},pu.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},pu.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},pu.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},pu.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var Cs=function(a){return a.zoom||a.drag||a.pitch||a.rotate},xc=function(s){function a(){s.apply(this,arguments)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a}(i.Event);function Jn(s){return s.panDelta&&s.panDelta.mag()||s.zoomDelta||s.bearingDelta||s.pitchDelta}var jn=function(a,n){this._map=a,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new _l(a),this._bearingSnap=n.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(n),i.bindAll(["handleEvent","handleWindowEvent"],this);var l=this._el;this._listeners=[[l,"touchstart",{passive:!0}],[l,"touchmove",{passive:!1}],[l,"touchend",void 0],[l,"touchcancel",void 0],[l,"mousedown",void 0],[l,"mousemove",void 0],[l,"mouseup",void 0],[i.window.document,"mousemove",{capture:!0}],[i.window.document,"mouseup",void 0],[l,"mouseover",void 0],[l,"mouseout",void 0],[l,"dblclick",void 0],[l,"click",void 0],[l,"keydown",{capture:!1}],[l,"keyup",void 0],[l,"wheel",{passive:!1}],[l,"contextmenu",void 0],[i.window,"blur",void 0]];for(var v=0,O=this._listeners;v<O.length;v+=1){var L=O[v],j=L[0];D.addEventListener(j,L[1],j===i.window.document?this.handleWindowEvent:this.handleEvent,L[2])}};jn.prototype.destroy=function(){for(var s=0,a=this._listeners;s<a.length;s+=1){var n=a[s],l=n[0];D.removeEventListener(l,n[1],l===i.window.document?this.handleWindowEvent:this.handleEvent,n[2])}},jn.prototype._addDefaultHandlers=function(s){var a=this._map,n=a.getCanvasContainer();this._add("mapEvent",new to(a,s));var l=a.boxZoom=new Us(a,s);this._add("boxZoom",l);var v=new Bs,O=new Io;a.doubleClickZoom=new eu(O,v),this._add("tapZoom",v),this._add("clickZoom",O);var L=new So;this._add("tapDragZoom",L);var j=a.touchPitch=new rf;this._add("touchPitch",j);var ue=new us(s),Ee=new ro(s);a.dragRotate=new ul(s,ue,Ee),this._add("mouseRotate",ue,["mousePitch"]),this._add("mousePitch",Ee,["mouseRotate"]);var $e=new bc(s),nt=new qo(s);a.dragPan=new Sl(n,$e,nt),this._add("mousePan",$e),this._add("touchPan",nt,["touchZoom","touchRotate"]);var at=new Fl,Ft=new Vs;a.touchZoomRotate=new pu(n,Ft,at,L),this._add("touchRotate",at,["touchPan","touchZoom"]),this._add("touchZoom",Ft,["touchPan","touchRotate"]);var Nt=a.scrollZoom=new Pa(a,this);this._add("scrollZoom",Nt,["mousePan"]);var Jt=a.keyboard=new Ro;this._add("keyboard",Jt),this._add("blockableMapEvent",new Rn(a));for(var jt=0,Gt=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];jt<Gt.length;jt+=1){var ar=Gt[jt];s.interactive&&s[ar]&&a[ar].enable(s[ar])}},jn.prototype._add=function(s,a,n){this._handlers.push({handlerName:s,handler:a,allowed:n}),this._handlersById[s]=a},jn.prototype.stop=function(s){if(!this._updatingCamera){for(var a=0,n=this._handlers;a<n.length;a+=1)n[a].handler.reset();this._inertia.clear(),this._fireEvents({},{},s),this._changes=[]}},jn.prototype.isActive=function(){for(var s=0,a=this._handlers;s<a.length;s+=1)if(a[s].handler.isActive())return!0;return!1},jn.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},jn.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},jn.prototype.isMoving=function(){return Boolean(Cs(this._eventsInProgress))||this.isZooming()},jn.prototype._blockedByActive=function(s,a,n){for(var l in s)if(l!==n&&(!a||a.indexOf(l)<0))return!0;return!1},jn.prototype.handleWindowEvent=function(s){this.handleEvent(s,s.type+"Window")},jn.prototype._getMapTouches=function(s){for(var a=[],n=0,l=s;n<l.length;n+=1){var v=l[n];this._el.contains(v.target)&&a.push(v)}return a},jn.prototype.handleEvent=function(s,a){if(s.type!=="blur"){this._updatingCamera=!0;for(var n=s.type==="renderFrame"?void 0:s,l={needsRenderFrame:!1},v={},O={},L=s.touches?this._getMapTouches(s.touches):void 0,j=L?D.touchPos(this._el,L):D.mousePos(this._el,s),ue=0,Ee=this._handlers;ue<Ee.length;ue+=1){var $e=Ee[ue],nt=$e.handlerName,at=$e.handler,Ft=$e.allowed;if(at.isEnabled()){var Nt=void 0;this._blockedByActive(O,Ft,nt)?at.reset():at[a||s.type]&&(Nt=at[a||s.type](s,j,L),this.mergeHandlerResult(l,v,Nt,nt,n),Nt&&Nt.needsRenderFrame&&this._triggerRenderFrame()),(Nt||at.isActive())&&(O[nt]=at)}}var Jt={};for(var jt in this._previousActiveHandlers)O[jt]||(Jt[jt]=n);this._previousActiveHandlers=O,(Object.keys(Jt).length||Jn(l))&&(this._changes.push([l,v,Jt]),this._triggerRenderFrame()),(Object.keys(O).length||Jn(l))&&this._map._stop(!0),this._updatingCamera=!1;var Gt=l.cameraAnimation;Gt&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Gt(this._map))}else this.stop(!0)},jn.prototype.mergeHandlerResult=function(s,a,n,l,v){if(n){i.extend(s,n);var O={handlerName:l,originalEvent:n.originalEvent||v};n.zoomDelta!==void 0&&(a.zoom=O),n.panDelta!==void 0&&(a.drag=O),n.pitchDelta!==void 0&&(a.pitch=O),n.bearingDelta!==void 0&&(a.rotate=O)}},jn.prototype._applyChanges=function(){for(var s={},a={},n={},l=0,v=this._changes;l<v.length;l+=1){var O=v[l],L=O[0],j=O[1],ue=O[2];L.panDelta&&(s.panDelta=(s.panDelta||new i.Point(0,0))._add(L.panDelta)),L.zoomDelta&&(s.zoomDelta=(s.zoomDelta||0)+L.zoomDelta),L.bearingDelta&&(s.bearingDelta=(s.bearingDelta||0)+L.bearingDelta),L.pitchDelta&&(s.pitchDelta=(s.pitchDelta||0)+L.pitchDelta),L.around!==void 0&&(s.around=L.around),L.pinchAround!==void 0&&(s.pinchAround=L.pinchAround),L.noInertia&&(s.noInertia=L.noInertia),i.extend(a,j),i.extend(n,ue)}this._updateMapTransform(s,a,n),this._changes=[]},jn.prototype._updateMapTransform=function(s,a,n){var l=this._map,v=l.transform;if(!Jn(s))return this._fireEvents(a,n,!0);var O=s.panDelta,L=s.zoomDelta,j=s.bearingDelta,ue=s.pitchDelta,Ee=s.around,$e=s.pinchAround;$e!==void 0&&(Ee=$e),l._stop(!0),Ee=Ee||l.transform.centerPoint;var nt=v.pointLocation(O?Ee.sub(O):Ee);j&&(v.bearing+=j),ue&&(v.pitch+=ue),L&&(v.zoom+=L),v.setLocationAtPoint(nt,Ee),this._map._update(),s.noInertia||this._inertia.record(s),this._fireEvents(a,n,!0)},jn.prototype._fireEvents=function(s,a,n){var l=this,v=Cs(this._eventsInProgress),O=Cs(s),L={};for(var j in s)this._eventsInProgress[j]||(L[j+"start"]=s[j].originalEvent),this._eventsInProgress[j]=s[j];for(var ue in!v&&O&&this._fireEvent("movestart",O.originalEvent),L)this._fireEvent(ue,L[ue]);for(var Ee in O&&this._fireEvent("move",O.originalEvent),s)this._fireEvent(Ee,s[Ee].originalEvent);var $e,nt={};for(var at in this._eventsInProgress){var Ft=this._eventsInProgress[at],Nt=Ft.handlerName,Jt=Ft.originalEvent;this._handlersById[Nt].isActive()||(delete this._eventsInProgress[at],nt[at+"end"]=$e=a[Nt]||Jt)}for(var jt in nt)this._fireEvent(jt,nt[jt]);var Gt=Cs(this._eventsInProgress);if(n&&(v||O)&&!Gt){this._updatingCamera=!0;var ar=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),nr=function(gr){return gr!==0&&-l._bearingSnap<gr&&gr<l._bearingSnap};ar?(nr(ar.bearing||this._map.getBearing())&&(ar.bearing=0),this._map.easeTo(ar,{originalEvent:$e})):(this._map.fire(new i.Event("moveend",{originalEvent:$e})),nr(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}},jn.prototype._fireEvent=function(s,a){this._map.fire(new i.Event(s,a?{originalEvent:a}:{}))},jn.prototype._requestFrame=function(){var s=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add(function(a){delete s._frameId,s.handleEvent(new xc("renderFrame",{timeStamp:a})),s._applyChanges()})},jn.prototype._triggerRenderFrame=function(){this._frameId===void 0&&(this._frameId=this._requestFrame())};var Ec=function(s){function a(n,l){s.call(this),this._moving=!1,this._zooming=!1,this.transform=n,this._bearingSnap=l.bearingSnap,i.bindAll(["_renderFrameCallback"],this)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.getCenter=function(){return new i.LngLat(this.transform.center.lng,this.transform.center.lat)},a.prototype.setCenter=function(n,l){return this.jumpTo({center:n},l)},a.prototype.panBy=function(n,l,v){return n=i.Point.convert(n).mult(-1),this.panTo(this.transform.center,i.extend({offset:n},l),v)},a.prototype.panTo=function(n,l,v){return this.easeTo(i.extend({center:n},l),v)},a.prototype.getZoom=function(){return this.transform.zoom},a.prototype.setZoom=function(n,l){return this.jumpTo({zoom:n},l),this},a.prototype.zoomTo=function(n,l,v){return this.easeTo(i.extend({zoom:n},l),v)},a.prototype.zoomIn=function(n,l){return this.zoomTo(this.getZoom()+1,n,l),this},a.prototype.zoomOut=function(n,l){return this.zoomTo(this.getZoom()-1,n,l),this},a.prototype.getBearing=function(){return this.transform.bearing},a.prototype.setBearing=function(n,l){return this.jumpTo({bearing:n},l),this},a.prototype.getPadding=function(){return this.transform.padding},a.prototype.setPadding=function(n,l){return this.jumpTo({padding:n},l),this},a.prototype.rotateTo=function(n,l,v){return this.easeTo(i.extend({bearing:n},l),v)},a.prototype.resetNorth=function(n,l){return this.rotateTo(0,i.extend({duration:1e3},n),l),this},a.prototype.resetNorthPitch=function(n,l){return this.easeTo(i.extend({bearing:0,pitch:0,duration:1e3},n),l),this},a.prototype.snapToNorth=function(n,l){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(n,l):this},a.prototype.getPitch=function(){return this.transform.pitch},a.prototype.setPitch=function(n,l){return this.jumpTo({pitch:n},l),this},a.prototype.cameraForBounds=function(n,l){n=i.LngLatBounds.convert(n);var v=l&&l.bearing||0;return this._cameraForBoxAndBearing(n.getNorthWest(),n.getSouthEast(),v,l)},a.prototype._cameraForBoxAndBearing=function(n,l,v,O){var L={top:0,bottom:0,right:0,left:0};if(typeof(O=i.extend({padding:L,offset:[0,0],maxZoom:this.transform.maxZoom},O)).padding=="number"){var j=O.padding;O.padding={top:j,bottom:j,right:j,left:j}}O.padding=i.extend(L,O.padding);var ue=this.transform,Ee=ue.padding,$e=ue.project(i.LngLat.convert(n)),nt=ue.project(i.LngLat.convert(l)),at=$e.rotate(-v*Math.PI/180),Ft=nt.rotate(-v*Math.PI/180),Nt=new i.Point(Math.max(at.x,Ft.x),Math.max(at.y,Ft.y)),Jt=new i.Point(Math.min(at.x,Ft.x),Math.min(at.y,Ft.y)),jt=Nt.sub(Jt),Gt=(ue.width-(Ee.left+Ee.right+O.padding.left+O.padding.right))/jt.x,ar=(ue.height-(Ee.top+Ee.bottom+O.padding.top+O.padding.bottom))/jt.y;if(!(ar<0||Gt<0)){var nr=Math.min(ue.scaleZoom(ue.scale*Math.min(Gt,ar)),O.maxZoom),Rr=typeof O.offset.x=="number"?new i.Point(O.offset.x,O.offset.y):i.Point.convert(O.offset),gr=new i.Point((O.padding.left-O.padding.right)/2,(O.padding.top-O.padding.bottom)/2).rotate(v*Math.PI/180),Ar=Rr.add(gr).mult(ue.scale/ue.zoomScale(nr));return{center:ue.unproject($e.add(nt).div(2).sub(Ar)),zoom:nr,bearing:v}}i.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},a.prototype.fitBounds=function(n,l,v){return this._fitInternal(this.cameraForBounds(n,l),l,v)},a.prototype.fitScreenCoordinates=function(n,l,v,O,L){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(i.Point.convert(n)),this.transform.pointLocation(i.Point.convert(l)),v,O),O,L)},a.prototype._fitInternal=function(n,l,v){return n?(delete(l=i.extend(n,l)).padding,l.linear?this.easeTo(l,v):this.flyTo(l,v)):this},a.prototype.jumpTo=function(n,l){this.stop();var v=this.transform,O=!1,L=!1,j=!1;return"zoom"in n&&v.zoom!==+n.zoom&&(O=!0,v.zoom=+n.zoom),n.center!==void 0&&(v.center=i.LngLat.convert(n.center)),"bearing"in n&&v.bearing!==+n.bearing&&(L=!0,v.bearing=+n.bearing),"pitch"in n&&v.pitch!==+n.pitch&&(j=!0,v.pitch=+n.pitch),n.padding==null||v.isPaddingEqual(n.padding)||(v.padding=n.padding),this.fire(new i.Event("movestart",l)).fire(new i.Event("move",l)),O&&this.fire(new i.Event("zoomstart",l)).fire(new i.Event("zoom",l)).fire(new i.Event("zoomend",l)),L&&this.fire(new i.Event("rotatestart",l)).fire(new i.Event("rotate",l)).fire(new i.Event("rotateend",l)),j&&this.fire(new i.Event("pitchstart",l)).fire(new i.Event("pitch",l)).fire(new i.Event("pitchend",l)),this.fire(new i.Event("moveend",l))},a.prototype.easeTo=function(n,l){var v=this;this._stop(!1,n.easeId),((n=i.extend({offset:[0,0],duration:500,easing:i.ease},n)).animate===!1||!n.essential&&i.browser.prefersReducedMotion)&&(n.duration=0);var O=this.transform,L=this.getZoom(),j=this.getBearing(),ue=this.getPitch(),Ee=this.getPadding(),$e="zoom"in n?+n.zoom:L,nt="bearing"in n?this._normalizeBearing(n.bearing,j):j,at="pitch"in n?+n.pitch:ue,Ft="padding"in n?n.padding:O.padding,Nt=i.Point.convert(n.offset),Jt=O.centerPoint.add(Nt),jt=O.pointLocation(Jt),Gt=i.LngLat.convert(n.center||jt);this._normalizeCenter(Gt);var ar,nr,Rr=O.project(jt),gr=O.project(Gt).sub(Rr),Ar=O.zoomScale($e-L);n.around&&(ar=i.LngLat.convert(n.around),nr=O.locationPoint(ar));var Cr={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||$e!==L,this._rotating=this._rotating||j!==nt,this._pitching=this._pitching||at!==ue,this._padding=!O.isPaddingEqual(Ft),this._easeId=n.easeId,this._prepareEase(l,n.noMoveStart,Cr),this._ease(function(an){if(v._zooming&&(O.zoom=i.number(L,$e,an)),v._rotating&&(O.bearing=i.number(j,nt,an)),v._pitching&&(O.pitch=i.number(ue,at,an)),v._padding&&(O.interpolatePadding(Ee,Ft,an),Jt=O.centerPoint.add(Nt)),ar)O.setLocationAtPoint(ar,nr);else{var Yr=O.zoomScale(O.zoom-L),vn=$e>L?Math.min(2,Ar):Math.max(.5,Ar),Pn=Math.pow(vn,1-an),qn=O.unproject(Rr.add(gr.mult(an*Pn)).mult(Yr));O.setLocationAtPoint(O.renderWorldCopies?qn.wrap():qn,Jt)}v._fireMoveEvents(l)},function(an){v._afterEase(l,an)},n),this},a.prototype._prepareEase=function(n,l,v){v===void 0&&(v={}),this._moving=!0,l||v.moving||this.fire(new i.Event("movestart",n)),this._zooming&&!v.zooming&&this.fire(new i.Event("zoomstart",n)),this._rotating&&!v.rotating&&this.fire(new i.Event("rotatestart",n)),this._pitching&&!v.pitching&&this.fire(new i.Event("pitchstart",n))},a.prototype._fireMoveEvents=function(n){this.fire(new i.Event("move",n)),this._zooming&&this.fire(new i.Event("zoom",n)),this._rotating&&this.fire(new i.Event("rotate",n)),this._pitching&&this.fire(new i.Event("pitch",n))},a.prototype._afterEase=function(n,l){if(!this._easeId||!l||this._easeId!==l){delete this._easeId;var v=this._zooming,O=this._rotating,L=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,v&&this.fire(new i.Event("zoomend",n)),O&&this.fire(new i.Event("rotateend",n)),L&&this.fire(new i.Event("pitchend",n)),this.fire(new i.Event("moveend",n))}},a.prototype.flyTo=function(n,l){var v=this;if(!n.essential&&i.browser.prefersReducedMotion){var O=i.pick(n,["center","zoom","bearing","pitch","around"]);return this.jumpTo(O,l)}this.stop(),n=i.extend({offset:[0,0],speed:1.2,curve:1.42,easing:i.ease},n);var L=this.transform,j=this.getZoom(),ue=this.getBearing(),Ee=this.getPitch(),$e=this.getPadding(),nt="zoom"in n?i.clamp(+n.zoom,L.minZoom,L.maxZoom):j,at="bearing"in n?this._normalizeBearing(n.bearing,ue):ue,Ft="pitch"in n?+n.pitch:Ee,Nt="padding"in n?n.padding:L.padding,Jt=L.zoomScale(nt-j),jt=i.Point.convert(n.offset),Gt=L.centerPoint.add(jt),ar=L.pointLocation(Gt),nr=i.LngLat.convert(n.center||ar);this._normalizeCenter(nr);var Rr=L.project(ar),gr=L.project(nr).sub(Rr),Ar=n.curve,Cr=Math.max(L.width,L.height),an=Cr/Jt,Yr=gr.mag();if("minZoom"in n){var vn=i.clamp(Math.min(n.minZoom,j,nt),L.minZoom,L.maxZoom),Pn=Cr/L.zoomScale(vn-j);Ar=Math.sqrt(Pn/Yr*2)}var qn=Ar*Ar;function sa(ia){var La=(an*an-Cr*Cr+(ia?-1:1)*qn*qn*Yr*Yr)/(2*(ia?an:Cr)*qn*Yr);return Math.log(Math.sqrt(La*La+1)-La)}function Aa(ia){return(Math.exp(ia)-Math.exp(-ia))/2}function Wa(ia){return(Math.exp(ia)+Math.exp(-ia))/2}var _n=sa(0),ua=function(La){return Wa(_n)/Wa(_n+Ar*La)},xa=function(La){return Cr*((Wa(_n)*(Aa(za=_n+Ar*La)/Wa(za))-Aa(_n))/qn)/Yr;var za},Zn=(sa(1)-_n)/Ar;if(Math.abs(Yr)<1e-6||!isFinite(Zn)){if(Math.abs(Cr-an)<1e-6)return this.easeTo(n,l);var Ca=an<Cr?-1:1;Zn=Math.abs(Math.log(an/Cr))/Ar,xa=function(){return 0},ua=function(La){return Math.exp(Ca*Ar*La)}}return n.duration="duration"in n?+n.duration:1e3*Zn/("screenSpeed"in n?+n.screenSpeed/Ar:+n.speed),n.maxDuration&&n.duration>n.maxDuration&&(n.duration=0),this._zooming=!0,this._rotating=ue!==at,this._pitching=Ft!==Ee,this._padding=!L.isPaddingEqual(Nt),this._prepareEase(l,!1),this._ease(function(ia){var La=ia*Zn,za=1/ua(La);L.zoom=ia===1?nt:j+L.scaleZoom(za),v._rotating&&(L.bearing=i.number(ue,at,ia)),v._pitching&&(L.pitch=i.number(Ee,Ft,ia)),v._padding&&(L.interpolatePadding($e,Nt,ia),Gt=L.centerPoint.add(jt));var Hi=ia===1?nr:L.unproject(Rr.add(gr.mult(xa(La))).mult(za));L.setLocationAtPoint(L.renderWorldCopies?Hi.wrap():Hi,Gt),v._fireMoveEvents(l)},function(){return v._afterEase(l)},n),this},a.prototype.isEasing=function(){return!!this._easeFrameId},a.prototype.stop=function(){return this._stop()},a.prototype._stop=function(n,l){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var v=this._onEaseEnd;delete this._onEaseEnd,v.call(this,l)}if(!n){var O=this.handlers;O&&O.stop(!1)}return this},a.prototype._ease=function(n,l,v){v.animate===!1||v.duration===0?(n(1),l()):(this._easeStart=i.browser.now(),this._easeOptions=v,this._onEaseFrame=n,this._onEaseEnd=l,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},a.prototype._renderFrameCallback=function(){var n=Math.min((i.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(n)),n<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},a.prototype._normalizeBearing=function(n,l){n=i.wrap(n,-180,180);var v=Math.abs(n-l);return Math.abs(n-360-l)<v&&(n-=360),Math.abs(n+360-l)<v&&(n+=360),n},a.prototype._normalizeCenter=function(n){var l=this.transform;if(l.renderWorldCopies&&!l.lngRange){var v=n.lng-l.center.lng;n.lng+=v>180?-360:v<-180?360:0}},a}(i.Evented),cs=function(a){a===void 0&&(a={}),this.options=a,i.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)};cs.prototype.getDefaultPosition=function(){return"bottom-right"},cs.prototype.onAdd=function(s){var a=this.options&&this.options.compact;return this._map=s,this._container=D.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=D.create("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=D.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),a&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),a===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},cs.prototype.onRemove=function(){D.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},cs.prototype._setElementTitle=function(s,a){var n=this._map._getUIString("AttributionControl."+a);s.title=n,s.setAttribute("aria-label",n)},cs.prototype._toggleAttribution=function(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))},cs.prototype._updateEditLink=function(){var s=this._editLink;s||(s=this._editLink=this._container.querySelector(".mapbox-improve-map"));var a=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||i.config.ACCESS_TOKEN}];if(s){var n=a.reduce(function(l,v,O){return v.value&&(l+=v.key+"="+v.value+(O<a.length-1?"&":"")),l},"?");s.href=i.config.FEEDBACK_URL+"/"+n+(this._map._hash?this._map._hash.getHashString(!0):""),s.rel="noopener nofollow",this._setElementTitle(s,"MapFeedback")}},cs.prototype._updateData=function(s){!s||s.sourceDataType!=="metadata"&&s.sourceDataType!=="visibility"&&s.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())},cs.prototype._updateAttributions=function(){if(this._map.style){var s=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?s=s.concat(this.options.customAttribution.map(function(j){return typeof j!="string"?"":j})):typeof this.options.customAttribution=="string"&&s.push(this.options.customAttribution)),this._map.style.stylesheet){var a=this._map.style.stylesheet;this.styleOwner=a.owner,this.styleId=a.id}var n=this._map.style.sourceCaches;for(var l in n){var v=n[l];if(v.used){var O=v.getSource();O.attribution&&s.indexOf(O.attribution)<0&&s.push(O.attribution)}}s.sort(function(j,ue){return j.length-ue.length});var L=(s=s.filter(function(j,ue){for(var Ee=ue+1;Ee<s.length;Ee++)if(s[Ee].indexOf(j)>=0)return!1;return!0})).join(" | ");L!==this._attribHTML&&(this._attribHTML=L,s.length?(this._innerContainer.innerHTML=L,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},cs.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")};var Do=function(){i.bindAll(["_updateLogo"],this),i.bindAll(["_updateCompact"],this)};Do.prototype.onAdd=function(s){this._map=s,this._container=D.create("div","mapboxgl-ctrl");var a=D.create("a","mapboxgl-ctrl-logo");return a.target="_blank",a.rel="noopener nofollow",a.href="https://www.mapbox.com/",a.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),a.setAttribute("rel","noopener nofollow"),this._container.appendChild(a),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},Do.prototype.onRemove=function(){D.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},Do.prototype.getDefaultPosition=function(){return"bottom-left"},Do.prototype._updateLogo=function(s){s&&s.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")},Do.prototype._logoRequired=function(){if(this._map.style){var s=this._map.style.sourceCaches;for(var a in s)if(s[a].getSource().mapbox_logo)return!0;return!1}},Do.prototype._updateCompact=function(){var s=this._container.children;if(s.length){var a=s[0];this._map.getCanvasContainer().offsetWidth<250?a.classList.add("mapboxgl-compact"):a.classList.remove("mapboxgl-compact")}};var vo=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};vo.prototype.add=function(s){var a=++this._id;return this._queue.push({callback:s,id:a,cancelled:!1}),a},vo.prototype.remove=function(s){for(var a=this._currentlyRunning,n=0,l=a?this._queue.concat(a):this._queue;n<l.length;n+=1){var v=l[n];if(v.id===s)return void(v.cancelled=!0)}},vo.prototype.run=function(s){s===void 0&&(s=0);var a=this._currentlyRunning=this._queue;this._queue=[];for(var n=0,l=a;n<l.length;n+=1){var v=l[n];if(!v.cancelled&&(v.callback(s),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},vo.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var ws={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},Au=i.window.HTMLImageElement,ec=i.window.HTMLElement,$a=i.window.ImageBitmap,no={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},ll=function(s){function a(l){var v=this;if((l=i.extend({},no,l)).minZoom!=null&&l.maxZoom!=null&&l.minZoom>l.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(l.minPitch!=null&&l.maxPitch!=null&&l.minPitch>l.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(l.minPitch!=null&&l.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(l.maxPitch!=null&&l.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var O=new kn(l.minZoom,l.maxZoom,l.minPitch,l.maxPitch,l.renderWorldCopies);if(s.call(this,O,l),this._interactive=l.interactive,this._maxTileCacheSize=l.maxTileCacheSize,this._failIfMajorPerformanceCaveat=l.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=l.preserveDrawingBuffer,this._antialias=l.antialias,this._trackResize=l.trackResize,this._bearingSnap=l.bearingSnap,this._refreshExpiredTiles=l.refreshExpiredTiles,this._fadeDuration=l.fadeDuration,this._crossSourceCollisions=l.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=l.collectResourceTiming,this._renderTaskQueue=new vo,this._controls=[],this._mapId=i.uniqueId(),this._locale=i.extend({},ws,l.locale),this._clickTolerance=l.clickTolerance,this._requestManager=new i.RequestManager(l.transformRequest,l.accessToken),typeof l.container=="string"){if(this._container=i.window.document.getElementById(l.container),!this._container)throw new Error("Container '"+l.container+"' not found.")}else{if(!(l.container instanceof ec))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=l.container}if(l.maxBounds&&this.setMaxBounds(l.maxBounds),i.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return v._update(!1)}),this.on("moveend",function(){return v._update(!1)}),this.on("zoom",function(){return v._update(!0)}),i.window!==void 0&&(i.window.addEventListener("online",this._onWindowOnline,!1),i.window.addEventListener("resize",this._onWindowResize,!1),i.window.addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new jn(this,l),this._hash=l.hash&&new Ls(typeof l.hash=="string"&&l.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:l.center,zoom:l.zoom,bearing:l.bearing,pitch:l.pitch}),l.bounds&&(this.resize(),this.fitBounds(l.bounds,i.extend({},l.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=l.localIdeographFontFamily,l.style&&this.setStyle(l.style,{localIdeographFontFamily:l.localIdeographFontFamily}),l.attributionControl&&this.addControl(new cs({customAttribution:l.customAttribution})),this.addControl(new Do,l.logoPosition),this.on("style.load",function(){v.transform.unmodified&&v.jumpTo(v.style.stylesheet)}),this.on("data",function(L){v._update(L.dataType==="style"),v.fire(new i.Event(L.dataType+"data",L))}),this.on("dataloading",function(L){v.fire(new i.Event(L.dataType+"dataloading",L))})}s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a;var n={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return a.prototype._getMapId=function(){return this._mapId},a.prototype.addControl=function(l,v){if(v===void 0&&(v=l.getDefaultPosition?l.getDefaultPosition():"top-right"),!l||!l.onAdd)return this.fire(new i.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var O=l.onAdd(this);this._controls.push(l);var L=this._controlPositions[v];return v.indexOf("bottom")!==-1?L.insertBefore(O,L.firstChild):L.appendChild(O),this},a.prototype.removeControl=function(l){if(!l||!l.onRemove)return this.fire(new i.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var v=this._controls.indexOf(l);return v>-1&&this._controls.splice(v,1),l.onRemove(this),this},a.prototype.hasControl=function(l){return this._controls.indexOf(l)>-1},a.prototype.resize=function(l){var v=this._containerDimensions(),O=v[0],L=v[1];this._resizeCanvas(O,L),this.transform.resize(O,L),this.painter.resize(O,L);var j=!this._moving;return j&&(this.stop(),this.fire(new i.Event("movestart",l)).fire(new i.Event("move",l))),this.fire(new i.Event("resize",l)),j&&this.fire(new i.Event("moveend",l)),this},a.prototype.getBounds=function(){return this.transform.getBounds()},a.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},a.prototype.setMaxBounds=function(l){return this.transform.setMaxBounds(i.LngLatBounds.convert(l)),this._update()},a.prototype.setMinZoom=function(l){if((l=l==null?-2:l)>=-2&&l<=this.transform.maxZoom)return this.transform.minZoom=l,this._update(),this.getZoom()<l&&this.setZoom(l),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},a.prototype.getMinZoom=function(){return this.transform.minZoom},a.prototype.setMaxZoom=function(l){if((l=l==null?22:l)>=this.transform.minZoom)return this.transform.maxZoom=l,this._update(),this.getZoom()>l&&this.setZoom(l),this;throw new Error("maxZoom must be greater than the current minZoom")},a.prototype.getMaxZoom=function(){return this.transform.maxZoom},a.prototype.setMinPitch=function(l){if((l=l==null?0:l)<0)throw new Error("minPitch must be greater than or equal to 0");if(l>=0&&l<=this.transform.maxPitch)return this.transform.minPitch=l,this._update(),this.getPitch()<l&&this.setPitch(l),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},a.prototype.getMinPitch=function(){return this.transform.minPitch},a.prototype.setMaxPitch=function(l){if((l=l==null?60:l)>60)throw new Error("maxPitch must be less than or equal to 60");if(l>=this.transform.minPitch)return this.transform.maxPitch=l,this._update(),this.getPitch()>l&&this.setPitch(l),this;throw new Error("maxPitch must be greater than the current minPitch")},a.prototype.getMaxPitch=function(){return this.transform.maxPitch},a.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},a.prototype.setRenderWorldCopies=function(l){return this.transform.renderWorldCopies=l,this._update()},a.prototype.project=function(l){return this.transform.locationPoint(i.LngLat.convert(l))},a.prototype.unproject=function(l){return this.transform.pointLocation(i.Point.convert(l))},a.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},a.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},a.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},a.prototype._createDelegatedListener=function(l,v,O){var L,j=this;if(l==="mouseenter"||l==="mouseover"){var ue=!1;return{layer:v,listener:O,delegates:{mousemove:function(nt){var at=j.getLayer(v)?j.queryRenderedFeatures(nt.point,{layers:[v]}):[];at.length?ue||(ue=!0,O.call(j,new Ui(l,j,nt.originalEvent,{features:at}))):ue=!1},mouseout:function(){ue=!1}}}}if(l==="mouseleave"||l==="mouseout"){var Ee=!1;return{layer:v,listener:O,delegates:{mousemove:function(nt){(j.getLayer(v)?j.queryRenderedFeatures(nt.point,{layers:[v]}):[]).length?Ee=!0:Ee&&(Ee=!1,O.call(j,new Ui(l,j,nt.originalEvent)))},mouseout:function(nt){Ee&&(Ee=!1,O.call(j,new Ui(l,j,nt.originalEvent)))}}}}return{layer:v,listener:O,delegates:(L={},L[l]=function($e){var nt=j.getLayer(v)?j.queryRenderedFeatures($e.point,{layers:[v]}):[];nt.length&&($e.features=nt,O.call(j,$e),delete $e.features)},L)}},a.prototype.on=function(l,v,O){if(O===void 0)return s.prototype.on.call(this,l,v);var L=this._createDelegatedListener(l,v,O);for(var j in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[l]=this._delegatedListeners[l]||[],this._delegatedListeners[l].push(L),L.delegates)this.on(j,L.delegates[j]);return this},a.prototype.once=function(l,v,O){if(O===void 0)return s.prototype.once.call(this,l,v);var L=this._createDelegatedListener(l,v,O);for(var j in L.delegates)this.once(j,L.delegates[j]);return this},a.prototype.off=function(l,v,O){var L=this;return O===void 0?s.prototype.off.call(this,l,v):(this._delegatedListeners&&this._delegatedListeners[l]&&function(j){for(var ue=j[l],Ee=0;Ee<ue.length;Ee++){var $e=ue[Ee];if($e.layer===v&&$e.listener===O){for(var nt in $e.delegates)L.off(nt,$e.delegates[nt]);return ue.splice(Ee,1),L}}}(this._delegatedListeners),this)},a.prototype.queryRenderedFeatures=function(l,v){if(!this.style)return[];var O;if(v!==void 0||l===void 0||l instanceof i.Point||Array.isArray(l)||(v=l,l=void 0),v=v||{},(l=l||[[0,0],[this.transform.width,this.transform.height]])instanceof i.Point||typeof l[0]=="number")O=[i.Point.convert(l)];else{var L=i.Point.convert(l[0]),j=i.Point.convert(l[1]);O=[L,new i.Point(j.x,L.y),j,new i.Point(L.x,j.y),L]}return this.style.queryRenderedFeatures(O,v,this.transform)},a.prototype.querySourceFeatures=function(l,v){return this.style.querySourceFeatures(l,v)},a.prototype.setStyle=function(l,v){return(v=i.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},v)).diff!==!1&&v.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&l?(this._diffStyle(l,v),this):(this._localIdeographFontFamily=v.localIdeographFontFamily,this._updateStyle(l,v))},a.prototype._getUIString=function(l){var v=this._locale[l];if(v==null)throw new Error("Missing UI string '"+l+"'");return v},a.prototype._updateStyle=function(l,v){return this.style&&(this.style.setEventedParent(null),this.style._remove()),l?(this.style=new Ii(this,v||{}),this.style.setEventedParent(this,{style:this.style}),typeof l=="string"?this.style.loadURL(l):this.style.loadJSON(l),this):(delete this.style,this)},a.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new Ii(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},a.prototype._diffStyle=function(l,v){var O=this;if(typeof l=="string"){var L=this._requestManager.normalizeStyleURL(l),j=this._requestManager.transformRequest(L,i.ResourceType.Style);i.getJSON(j,function(ue,Ee){ue?O.fire(new i.ErrorEvent(ue)):Ee&&O._updateDiff(Ee,v)})}else typeof l=="object"&&this._updateDiff(l,v)},a.prototype._updateDiff=function(l,v){try{this.style.setState(l)&&this._update(!0)}catch(O){i.warnOnce("Unable to perform style diff: "+(O.message||O.error||O)+".  Rebuilding the style from scratch."),this._updateStyle(l,v)}},a.prototype.getStyle=function(){if(this.style)return this.style.serialize()},a.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():i.warnOnce("There is no style added to the map.")},a.prototype.addSource=function(l,v){return this._lazyInitEmptyStyle(),this.style.addSource(l,v),this._update(!0)},a.prototype.isSourceLoaded=function(l){var v=this.style&&this.style.sourceCaches[l];if(v!==void 0)return v.loaded();this.fire(new i.ErrorEvent(new Error("There is no source with ID '"+l+"'")))},a.prototype.areTilesLoaded=function(){var l=this.style&&this.style.sourceCaches;for(var v in l){var O=l[v]._tiles;for(var L in O){var j=O[L];if(j.state!=="loaded"&&j.state!=="errored")return!1}}return!0},a.prototype.addSourceType=function(l,v,O){return this._lazyInitEmptyStyle(),this.style.addSourceType(l,v,O)},a.prototype.removeSource=function(l){return this.style.removeSource(l),this._update(!0)},a.prototype.getSource=function(l){return this.style.getSource(l)},a.prototype.addImage=function(l,v,O){O===void 0&&(O={});var L=O.pixelRatio;L===void 0&&(L=1);var j=O.sdf;j===void 0&&(j=!1);var ue=O.stretchX,Ee=O.stretchY,$e=O.content;if(this._lazyInitEmptyStyle(),v instanceof Au||$a&&v instanceof $a){var nt=i.browser.getImageData(v);this.style.addImage(l,{data:new i.RGBAImage({width:nt.width,height:nt.height},nt.data),pixelRatio:L,stretchX:ue,stretchY:Ee,content:$e,sdf:j,version:0})}else{if(v.width===void 0||v.height===void 0)return this.fire(new i.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var at=v;this.style.addImage(l,{data:new i.RGBAImage({width:v.width,height:v.height},new Uint8Array(v.data)),pixelRatio:L,stretchX:ue,stretchY:Ee,content:$e,sdf:j,version:0,userImage:at}),at.onAdd&&at.onAdd(this,l)}},a.prototype.updateImage=function(l,v){var O=this.style.getImage(l);if(!O)return this.fire(new i.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var L=v instanceof Au||$a&&v instanceof $a?i.browser.getImageData(v):v,j=L.width,ue=L.height,Ee=L.data;return j===void 0||ue===void 0?this.fire(new i.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):j!==O.data.width||ue!==O.data.height?this.fire(new i.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(O.data.replace(Ee,!(v instanceof Au||$a&&v instanceof $a)),void this.style.updateImage(l,O))},a.prototype.hasImage=function(l){return l?!!this.style.getImage(l):(this.fire(new i.ErrorEvent(new Error("Missing required image id"))),!1)},a.prototype.removeImage=function(l){this.style.removeImage(l)},a.prototype.loadImage=function(l,v){i.getImage(this._requestManager.transformRequest(l,i.ResourceType.Image),v)},a.prototype.listImages=function(){return this.style.listImages()},a.prototype.addLayer=function(l,v){return this._lazyInitEmptyStyle(),this.style.addLayer(l,v),this._update(!0)},a.prototype.moveLayer=function(l,v){return this.style.moveLayer(l,v),this._update(!0)},a.prototype.removeLayer=function(l){return this.style.removeLayer(l),this._update(!0)},a.prototype.getLayer=function(l){return this.style.getLayer(l)},a.prototype.setLayerZoomRange=function(l,v,O){return this.style.setLayerZoomRange(l,v,O),this._update(!0)},a.prototype.setFilter=function(l,v,O){return O===void 0&&(O={}),this.style.setFilter(l,v,O),this._update(!0)},a.prototype.getFilter=function(l){return this.style.getFilter(l)},a.prototype.setPaintProperty=function(l,v,O,L){return L===void 0&&(L={}),this.style.setPaintProperty(l,v,O,L),this._update(!0)},a.prototype.getPaintProperty=function(l,v){return this.style.getPaintProperty(l,v)},a.prototype.setLayoutProperty=function(l,v,O,L){return L===void 0&&(L={}),this.style.setLayoutProperty(l,v,O,L),this._update(!0)},a.prototype.getLayoutProperty=function(l,v){return this.style.getLayoutProperty(l,v)},a.prototype.setLight=function(l,v){return v===void 0&&(v={}),this._lazyInitEmptyStyle(),this.style.setLight(l,v),this._update(!0)},a.prototype.getLight=function(){return this.style.getLight()},a.prototype.setFeatureState=function(l,v){return this.style.setFeatureState(l,v),this._update()},a.prototype.removeFeatureState=function(l,v){return this.style.removeFeatureState(l,v),this._update()},a.prototype.getFeatureState=function(l){return this.style.getFeatureState(l)},a.prototype.getContainer=function(){return this._container},a.prototype.getCanvasContainer=function(){return this._canvasContainer},a.prototype.getCanvas=function(){return this._canvas},a.prototype._containerDimensions=function(){var l=0,v=0;return this._container&&(l=this._container.clientWidth||400,v=this._container.clientHeight||300),[l,v]},a.prototype._detectMissingCSS=function(){i.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&i.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},a.prototype._setupContainer=function(){var l=this._container;l.classList.add("mapboxgl-map"),(this._missingCSSCanary=D.create("div","mapboxgl-canary",l)).style.visibility="hidden",this._detectMissingCSS();var v=this._canvasContainer=D.create("div","mapboxgl-canvas-container",l);this._interactive&&v.classList.add("mapboxgl-interactive"),this._canvas=D.create("canvas","mapboxgl-canvas",v),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");var O=this._containerDimensions();this._resizeCanvas(O[0],O[1]);var L=this._controlContainer=D.create("div","mapboxgl-control-container",l),j=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(ue){j[ue]=D.create("div","mapboxgl-ctrl-"+ue,L)}),this._container.addEventListener("scroll",this._onMapScroll,!1)},a.prototype._resizeCanvas=function(l,v){var O=i.browser.devicePixelRatio||1;this._canvas.width=O*l,this._canvas.height=O*v,this._canvas.style.width=l+"px",this._canvas.style.height=v+"px"},a.prototype._setupPainter=function(){var l=i.extend({},Z.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),v=this._canvas.getContext("webgl",l)||this._canvas.getContext("experimental-webgl",l);v?(this.painter=new Pi(v,this.transform),i.webpSupported.testSupport(v)):this.fire(new i.ErrorEvent(new Error("Failed to initialize WebGL")))},a.prototype._contextLost=function(l){l.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new i.Event("webglcontextlost",{originalEvent:l}))},a.prototype._contextRestored=function(l){this._setupPainter(),this.resize(),this._update(),this.fire(new i.Event("webglcontextrestored",{originalEvent:l}))},a.prototype._onMapScroll=function(l){if(l.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},a.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},a.prototype._update=function(l){return this.style?(this._styleDirty=this._styleDirty||l,this._sourcesDirty=!0,this.triggerRepaint(),this):this},a.prototype._requestRenderFrame=function(l){return this._update(),this._renderTaskQueue.add(l)},a.prototype._cancelRenderFrame=function(l){this._renderTaskQueue.remove(l)},a.prototype._render=function(l){var v,O=this,L=0,j=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(v=j.createQueryEXT(),j.beginQueryEXT(j.TIME_ELAPSED_EXT,v),L=i.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(l),!this._removed){var ue=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var Ee=this.transform.zoom,$e=i.browser.now();this.style.zoomHistory.update(Ee,$e);var nt=new i.EvaluationParameters(Ee,{now:$e,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),at=nt.crossFadingFactor();at===1&&at===this._crossFadingFactor||(ue=!0,this._crossFadingFactor=at),this.style.update(nt)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new i.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new i.Event("load"))),this.style&&(this.style.hasTransitions()||ue)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var Ft=i.browser.now()-L;j.endQueryEXT(j.TIME_ELAPSED_EXT,v),setTimeout(function(){var jt=j.getQueryObjectEXT(v,j.QUERY_RESULT_EXT)/1e6;j.deleteQueryEXT(v),O.fire(new i.Event("gpu-timing-frame",{cpuTime:Ft,gpuTime:jt}))},50)}if(this.listens("gpu-timing-layer")){var Nt=this.painter.collectGpuTimers();setTimeout(function(){var jt=O.painter.queryGpuTimers(Nt);O.fire(new i.Event("gpu-timing-layer",{layerTimes:jt}))},50)}var Jt=this._sourcesDirty||this._styleDirty||this._placementDirty;return Jt||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new i.Event("idle")),!this._loaded||this._fullyLoaded||Jt||(this._fullyLoaded=!0),this}},a.prototype.remove=function(){this._hash&&this._hash.remove();for(var l=0,v=this._controls;l<v.length;l+=1)v[l].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),i.window!==void 0&&(i.window.removeEventListener("resize",this._onWindowResize,!1),i.window.removeEventListener("orientationchange",this._onWindowResize,!1),i.window.removeEventListener("online",this._onWindowOnline,!1));var O=this.painter.context.gl.getExtension("WEBGL_lose_context");O&&O.loseContext(),mu(this._canvasContainer),mu(this._controlContainer),mu(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new i.Event("remove"))},a.prototype.triggerRepaint=function(){var l=this;this.style&&!this._frame&&(this._frame=i.browser.frame(function(v){l._frame=null,l._render(v)}))},a.prototype._onWindowOnline=function(){this._update()},a.prototype._onWindowResize=function(l){this._trackResize&&this.resize({originalEvent:l})._update()},n.showTileBoundaries.get=function(){return!!this._showTileBoundaries},n.showTileBoundaries.set=function(l){this._showTileBoundaries!==l&&(this._showTileBoundaries=l,this._update())},n.showPadding.get=function(){return!!this._showPadding},n.showPadding.set=function(l){this._showPadding!==l&&(this._showPadding=l,this._update())},n.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},n.showCollisionBoxes.set=function(l){this._showCollisionBoxes!==l&&(this._showCollisionBoxes=l,l?this.style._generateCollisionBoxes():this._update())},n.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},n.showOverdrawInspector.set=function(l){this._showOverdrawInspector!==l&&(this._showOverdrawInspector=l,this._update())},n.repaint.get=function(){return!!this._repaint},n.repaint.set=function(l){this._repaint!==l&&(this._repaint=l,this.triggerRepaint())},n.vertices.get=function(){return!!this._vertices},n.vertices.set=function(l){this._vertices=l,this._update()},a.prototype._setCacheLimits=function(l,v){i.setCacheLimits(l,v)},n.version.get=function(){return i.version},Object.defineProperties(a.prototype,n),a}(Ec);function mu(s){s.parentNode&&s.parentNode.removeChild(s)}var cl={showCompass:!0,showZoom:!0,visualizePitch:!1},Cu=function(a){var n=this;this.options=i.extend({},cl,a),this._container=D.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(l){return l.preventDefault()}),this.options.showZoom&&(i.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(l){return n._map.zoomIn({},{originalEvent:l})}),D.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(l){return n._map.zoomOut({},{originalEvent:l})}),D.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(i.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(l){n.options.visualizePitch?n._map.resetNorthPitch({},{originalEvent:l}):n._map.resetNorth({},{originalEvent:l})}),this._compassIcon=D.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};Cu.prototype._updateZoomButtons=function(){var s=this._map.getZoom(),a=s===this._map.getMaxZoom(),n=s===this._map.getMinZoom();this._zoomInButton.disabled=a,this._zoomOutButton.disabled=n,this._zoomInButton.setAttribute("aria-disabled",a.toString()),this._zoomOutButton.setAttribute("aria-disabled",n.toString())},Cu.prototype._rotateCompassArrow=function(){var s=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=s},Cu.prototype.onAdd=function(s){return this._map=s,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Is(this._map,this._compass,this.options.visualizePitch)),this._container},Cu.prototype.onRemove=function(){D.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},Cu.prototype._createButton=function(s,a){var n=D.create("button",s,this._container);return n.type="button",n.addEventListener("click",a),n},Cu.prototype._setButtonTitle=function(s,a){var n=this._map._getUIString("NavigationControl."+a);s.title=n,s.setAttribute("aria-label",n)};var Is=function(a,n,l){l===void 0&&(l=!1),this._clickTolerance=10,this.element=n,this.mouseRotate=new us({clickTolerance:a.dragRotate._mouseRotate._clickTolerance}),this.map=a,l&&(this.mousePitch=new ro({clickTolerance:a.dragRotate._mousePitch._clickTolerance})),i.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),D.addEventListener(n,"mousedown",this.mousedown),D.addEventListener(n,"touchstart",this.touchstart,{passive:!1}),D.addEventListener(n,"touchmove",this.touchmove),D.addEventListener(n,"touchend",this.touchend),D.addEventListener(n,"touchcancel",this.reset)};function Fc(s,a,n){if(s=new i.LngLat(s.lng,s.lat),a){var l=new i.LngLat(s.lng-360,s.lat),v=new i.LngLat(s.lng+360,s.lat),O=n.locationPoint(s).distSqr(a);n.locationPoint(l).distSqr(a)<O?s=l:n.locationPoint(v).distSqr(a)<O&&(s=v)}for(;Math.abs(s.lng-n.center.lng)>180;){var L=n.locationPoint(s);if(L.x>=0&&L.y>=0&&L.x<=n.width&&L.y<=n.height)break;s.lng>n.center.lng?s.lng-=360:s.lng+=360}return s}Is.prototype.down=function(s,a){this.mouseRotate.mousedown(s,a),this.mousePitch&&this.mousePitch.mousedown(s,a),D.disableDrag()},Is.prototype.move=function(s,a){var n=this.map,l=this.mouseRotate.mousemoveWindow(s,a);if(l&&l.bearingDelta&&n.setBearing(n.getBearing()+l.bearingDelta),this.mousePitch){var v=this.mousePitch.mousemoveWindow(s,a);v&&v.pitchDelta&&n.setPitch(n.getPitch()+v.pitchDelta)}},Is.prototype.off=function(){var s=this.element;D.removeEventListener(s,"mousedown",this.mousedown),D.removeEventListener(s,"touchstart",this.touchstart,{passive:!1}),D.removeEventListener(s,"touchmove",this.touchmove),D.removeEventListener(s,"touchend",this.touchend),D.removeEventListener(s,"touchcancel",this.reset),this.offTemp()},Is.prototype.offTemp=function(){D.enableDrag(),D.removeEventListener(i.window,"mousemove",this.mousemove),D.removeEventListener(i.window,"mouseup",this.mouseup)},Is.prototype.mousedown=function(s){this.down(i.extend({},s,{ctrlKey:!0,preventDefault:function(){return s.preventDefault()}}),D.mousePos(this.element,s)),D.addEventListener(i.window,"mousemove",this.mousemove),D.addEventListener(i.window,"mouseup",this.mouseup)},Is.prototype.mousemove=function(s){this.move(s,D.mousePos(this.element,s))},Is.prototype.mouseup=function(s){this.mouseRotate.mouseupWindow(s),this.mousePitch&&this.mousePitch.mouseupWindow(s),this.offTemp()},Is.prototype.touchstart=function(s){s.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=D.touchPos(this.element,s.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return s.preventDefault()}},this._startPos))},Is.prototype.touchmove=function(s){s.targetTouches.length!==1?this.reset():(this._lastPos=D.touchPos(this.element,s.targetTouches)[0],this.move({preventDefault:function(){return s.preventDefault()}},this._lastPos))},Is.prototype.touchend=function(s){s.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},Is.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var Gs={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function yf(s,a,n){var l=s.classList;for(var v in Gs)l.remove("mapboxgl-"+n+"-anchor-"+v);l.add("mapboxgl-"+n+"-anchor-"+a)}var Ul,Bl=function(s){function a(n,l){if(s.call(this),(n instanceof i.window.HTMLElement||l)&&(n=i.extend({element:n},l)),i.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=n&&n.anchor||"center",this._color=n&&n.color||"#3FB1CE",this._scale=n&&n.scale||1,this._draggable=n&&n.draggable||!1,this._clickTolerance=n&&n.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=n&&n.rotation||0,this._rotationAlignment=n&&n.rotationAlignment||"auto",this._pitchAlignment=n&&n.pitchAlignment&&n.pitchAlignment!=="auto"?n.pitchAlignment:this._rotationAlignment,n&&n.element)this._element=n.element,this._offset=i.Point.convert(n&&n.offset||[0,0]);else{this._defaultMarker=!0,this._element=D.create("div"),this._element.setAttribute("aria-label","Map marker");var v=D.createNS("http://www.w3.org/2000/svg","svg");v.setAttributeNS(null,"display","block"),v.setAttributeNS(null,"height","41px"),v.setAttributeNS(null,"width","27px"),v.setAttributeNS(null,"viewBox","0 0 27 41");var O=D.createNS("http://www.w3.org/2000/svg","g");O.setAttributeNS(null,"stroke","none"),O.setAttributeNS(null,"stroke-width","1"),O.setAttributeNS(null,"fill","none"),O.setAttributeNS(null,"fill-rule","evenodd");var L=D.createNS("http://www.w3.org/2000/svg","g");L.setAttributeNS(null,"fill-rule","nonzero");var j=D.createNS("http://www.w3.org/2000/svg","g");j.setAttributeNS(null,"transform","translate(3.0, 29.0)"),j.setAttributeNS(null,"fill","#000000");for(var ue=0,Ee=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];ue<Ee.length;ue+=1){var $e=Ee[ue],nt=D.createNS("http://www.w3.org/2000/svg","ellipse");nt.setAttributeNS(null,"opacity","0.04"),nt.setAttributeNS(null,"cx","10.5"),nt.setAttributeNS(null,"cy","5.80029008"),nt.setAttributeNS(null,"rx",$e.rx),nt.setAttributeNS(null,"ry",$e.ry),j.appendChild(nt)}var at=D.createNS("http://www.w3.org/2000/svg","g");at.setAttributeNS(null,"fill",this._color);var Ft=D.createNS("http://www.w3.org/2000/svg","path");Ft.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),at.appendChild(Ft);var Nt=D.createNS("http://www.w3.org/2000/svg","g");Nt.setAttributeNS(null,"opacity","0.25"),Nt.setAttributeNS(null,"fill","#000000");var Jt=D.createNS("http://www.w3.org/2000/svg","path");Jt.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),Nt.appendChild(Jt);var jt=D.createNS("http://www.w3.org/2000/svg","g");jt.setAttributeNS(null,"transform","translate(6.0, 7.0)"),jt.setAttributeNS(null,"fill","#FFFFFF");var Gt=D.createNS("http://www.w3.org/2000/svg","g");Gt.setAttributeNS(null,"transform","translate(8.0, 8.0)");var ar=D.createNS("http://www.w3.org/2000/svg","circle");ar.setAttributeNS(null,"fill","#000000"),ar.setAttributeNS(null,"opacity","0.25"),ar.setAttributeNS(null,"cx","5.5"),ar.setAttributeNS(null,"cy","5.5"),ar.setAttributeNS(null,"r","5.4999962");var nr=D.createNS("http://www.w3.org/2000/svg","circle");nr.setAttributeNS(null,"fill","#FFFFFF"),nr.setAttributeNS(null,"cx","5.5"),nr.setAttributeNS(null,"cy","5.5"),nr.setAttributeNS(null,"r","5.4999962"),Gt.appendChild(ar),Gt.appendChild(nr),L.appendChild(j),L.appendChild(at),L.appendChild(Nt),L.appendChild(jt),L.appendChild(Gt),v.appendChild(L),v.setAttributeNS(null,"height",41*this._scale+"px"),v.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(v),this._offset=i.Point.convert(n&&n.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(Rr){Rr.preventDefault()}),this._element.addEventListener("mousedown",function(Rr){Rr.preventDefault()}),yf(this._element,this._anchor,"marker"),this._popup=null}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.addTo=function(n){return this.remove(),this._map=n,n.getCanvasContainer().appendChild(this._element),n.on("move",this._update),n.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},a.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),D.remove(this._element),this._popup&&this._popup.remove(),this},a.prototype.getLngLat=function(){return this._lngLat},a.prototype.setLngLat=function(n){return this._lngLat=i.LngLat.convert(n),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},a.prototype.getElement=function(){return this._element},a.prototype.setPopup=function(n){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),n){if(!("offset"in n.options)){var l=Math.sqrt(Math.pow(13.5,2)/2);n.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[l,-1*(24.6+l)],"bottom-right":[-l,-1*(24.6+l)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=n,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},a.prototype._onKeyPress=function(n){var l=n.code,v=n.charCode||n.keyCode;l!=="Space"&&l!=="Enter"&&v!==32&&v!==13||this.togglePopup()},a.prototype._onMapClick=function(n){var l=n.originalEvent.target,v=this._element;this._popup&&(l===v||v.contains(l))&&this.togglePopup()},a.prototype.getPopup=function(){return this._popup},a.prototype.togglePopup=function(){var n=this._popup;return n?(n.isOpen()?n.remove():n.addTo(this._map),this):this},a.prototype._update=function(n){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=Fc(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var l="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?l="rotateZ("+this._rotation+"deg)":this._rotationAlignment==="map"&&(l="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var v="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?v="rotateX(0deg)":this._pitchAlignment==="map"&&(v="rotateX("+this._map.getPitch()+"deg)"),n&&n.type!=="moveend"||(this._pos=this._pos.round()),D.setTransform(this._element,Gs[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+v+" "+l)}},a.prototype.getOffset=function(){return this._offset},a.prototype.setOffset=function(n){return this._offset=i.Point.convert(n),this._update(),this},a.prototype._onMove=function(n){if(!this._isDragging){var l=this._clickTolerance||this._map._clickTolerance;this._isDragging=n.point.dist(this._pointerdownPos)>=l}this._isDragging&&(this._pos=n.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new i.Event("dragstart"))),this.fire(new i.Event("drag")))},a.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new i.Event("dragend")),this._state="inactive"},a.prototype._addDragHandler=function(n){this._element.contains(n.originalEvent.target)&&(n.preventDefault(),this._positionDelta=n.point.sub(this._pos).add(this._offset),this._pointerdownPos=n.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},a.prototype.setDraggable=function(n){return this._draggable=!!n,this._map&&(n?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},a.prototype.isDraggable=function(){return this._draggable},a.prototype.setRotation=function(n){return this._rotation=n||0,this._update(),this},a.prototype.getRotation=function(){return this._rotation},a.prototype.setRotationAlignment=function(n){return this._rotationAlignment=n||"auto",this._update(),this},a.prototype.getRotationAlignment=function(){return this._rotationAlignment},a.prototype.setPitchAlignment=function(n){return this._pitchAlignment=n&&n!=="auto"?n:this._rotationAlignment,this._update(),this},a.prototype.getPitchAlignment=function(){return this._pitchAlignment},a}(i.Evented),Tc={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},fs=0,Bu=!1,zc=function(s){function a(n){s.call(this),this.options=i.extend({},Tc,n),i.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.onAdd=function(n){var l;return this._map=n,this._container=D.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),l=this._setupUI,Ul!==void 0?l(Ul):i.window.navigator.permissions!==void 0?i.window.navigator.permissions.query({name:"geolocation"}).then(function(v){l(Ul=v.state!=="denied")}):l(Ul=!!i.window.navigator.geolocation),this._container},a.prototype.onRemove=function(){this._geolocationWatchID!==void 0&&(i.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),D.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,fs=0,Bu=!1},a.prototype._isOutOfMapMaxBounds=function(n){var l=this._map.getMaxBounds(),v=n.coords;return l&&(v.longitude<l.getWest()||v.longitude>l.getEast()||v.latitude<l.getSouth()||v.latitude>l.getNorth())},a.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},a.prototype._onSuccess=function(n){if(this._map){if(this._isOutOfMapMaxBounds(n))return this._setErrorState(),this.fire(new i.Event("outofmaxbounds",n)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=n,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(n),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(n),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new i.Event("geolocate",n)),this._finish()}},a.prototype._updateCamera=function(n){var l=new i.LngLat(n.coords.longitude,n.coords.latitude),v=n.coords.accuracy,O=this._map.getBearing(),L=i.extend({bearing:O},this.options.fitBoundsOptions);this._map.fitBounds(l.toBounds(v),L,{geolocateSource:!0})},a.prototype._updateMarker=function(n){if(n){var l=new i.LngLat(n.coords.longitude,n.coords.latitude);this._accuracyCircleMarker.setLngLat(l).addTo(this._map),this._userLocationDotMarker.setLngLat(l).addTo(this._map),this._accuracy=n.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},a.prototype._updateCircleRadius=function(){var n=this._map._container.clientHeight/2,l=this._map.unproject([0,n]),v=this._map.unproject([1,n]),O=l.distanceTo(v),L=Math.ceil(2*this._accuracy/O);this._circleElement.style.width=L+"px",this._circleElement.style.height=L+"px"},a.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},a.prototype._onError=function(n){if(this._map){if(this.options.trackUserLocation)if(n.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var l=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=l,this._geolocateButton.setAttribute("aria-label",l),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(n.code===3&&Bu)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new i.Event("error",n)),this._finish()}},a.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},a.prototype._setupUI=function(n){var l=this;if(this._container.addEventListener("contextmenu",function(L){return L.preventDefault()}),this._geolocateButton=D.create("button","mapboxgl-ctrl-geolocate",this._container),D.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",n===!1){i.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var v=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=v,this._geolocateButton.setAttribute("aria-label",v)}else{var O=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=O,this._geolocateButton.setAttribute("aria-label",O)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=D.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new Bl(this._dotElement),this._circleElement=D.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Bl({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(L){L.geolocateSource||l._watchState!=="ACTIVE_LOCK"||L.originalEvent&&L.originalEvent.type==="resize"||(l._watchState="BACKGROUND",l._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),l._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),l.fire(new i.Event("trackuserlocationend")))})},a.prototype.trigger=function(){if(!this._setup)return i.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new i.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":fs--,Bu=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new i.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new i.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){var n;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++fs>1?(n={maximumAge:6e5,timeout:0},Bu=!0):(n=this.options.positionOptions,Bu=!1),this._geolocationWatchID=i.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,n)}}else i.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},a.prototype._clearWatch=function(){i.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},a}(i.Evented),Al={maxWidth:100,unit:"metric"},Vu=function(a){this.options=i.extend({},Al,a),i.bindAll(["_onMove","setUnit"],this)};function tc(s,a,n){var l=n&&n.maxWidth||100,v=s._container.clientHeight/2,O=s.unproject([0,v]),L=s.unproject([l,v]),j=O.distanceTo(L);if(n&&n.unit==="imperial"){var ue=3.2808*j;ue>5280?Gu(a,l,ue/5280,s._getUIString("ScaleControl.Miles")):Gu(a,l,ue,s._getUIString("ScaleControl.Feet"))}else n&&n.unit==="nautical"?Gu(a,l,j/1852,s._getUIString("ScaleControl.NauticalMiles")):j>=1e3?Gu(a,l,j/1e3,s._getUIString("ScaleControl.Kilometers")):Gu(a,l,j,s._getUIString("ScaleControl.Meters"))}function Gu(s,a,n,l){var v,O,L,j=(v=n,(O=Math.pow(10,(""+Math.floor(v)).length-1))*(L=(L=v/O)>=10?10:L>=5?5:L>=3?3:L>=2?2:L>=1?1:function(ue){var Ee=Math.pow(10,Math.ceil(-Math.log(ue)/Math.LN10));return Math.round(ue*Ee)/Ee}(L)));s.style.width=a*(j/n)+"px",s.innerHTML=j+"&nbsp;"+l}Vu.prototype.getDefaultPosition=function(){return"bottom-left"},Vu.prototype._onMove=function(){tc(this._map,this._container,this.options)},Vu.prototype.onAdd=function(s){return this._map=s,this._container=D.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",s.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},Vu.prototype.onRemove=function(){D.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},Vu.prototype.setUnit=function(s){this.options.unit=s,tc(this._map,this._container,this.options)};var Ds=function(a){this._fullscreen=!1,a&&a.container&&(a.container instanceof i.window.HTMLElement?this._container=a.container:i.warnOnce("Full screen control 'container' must be a DOM element.")),i.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in i.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in i.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in i.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in i.window.document&&(this._fullscreenchange="MSFullscreenChange")};Ds.prototype.onAdd=function(s){return this._map=s,this._container||(this._container=this._map.getContainer()),this._controlContainer=D.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",i.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},Ds.prototype.onRemove=function(){D.remove(this._controlContainer),this._map=null,i.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},Ds.prototype._checkFullscreenSupport=function(){return!!(i.window.document.fullscreenEnabled||i.window.document.mozFullScreenEnabled||i.window.document.msFullscreenEnabled||i.window.document.webkitFullscreenEnabled)},Ds.prototype._setupUI=function(){var s=this._fullscreenButton=D.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);D.create("span","mapboxgl-ctrl-icon",s).setAttribute("aria-hidden",!0),s.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),i.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},Ds.prototype._updateTitle=function(){var s=this._getTitle();this._fullscreenButton.setAttribute("aria-label",s),this._fullscreenButton.title=s},Ds.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},Ds.prototype._isFullscreen=function(){return this._fullscreen},Ds.prototype._changeIcon=function(){(i.window.document.fullscreenElement||i.window.document.mozFullScreenElement||i.window.document.webkitFullscreenElement||i.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},Ds.prototype._onClickFullscreen=function(){this._isFullscreen()?i.window.document.exitFullscreen?i.window.document.exitFullscreen():i.window.document.mozCancelFullScreen?i.window.document.mozCancelFullScreen():i.window.document.msExitFullscreen?i.window.document.msExitFullscreen():i.window.document.webkitCancelFullScreen&&i.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var nf={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},rc=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),nc=function(s){function a(n){s.call(this),this.options=i.extend(Object.create(nf),n),i.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return s&&(a.__proto__=s),(a.prototype=Object.create(s&&s.prototype)).constructor=a,a.prototype.addTo=function(n){return this._map&&this.remove(),this._map=n,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new i.Event("open")),this},a.prototype.isOpen=function(){return!!this._map},a.prototype.remove=function(){return this._content&&D.remove(this._content),this._container&&(D.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new i.Event("close")),this},a.prototype.getLngLat=function(){return this._lngLat},a.prototype.setLngLat=function(n){return this._lngLat=i.LngLat.convert(n),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},a.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},a.prototype.getElement=function(){return this._container},a.prototype.setText=function(n){return this.setDOMContent(i.window.document.createTextNode(n))},a.prototype.setHTML=function(n){var l,v=i.window.document.createDocumentFragment(),O=i.window.document.createElement("body");for(O.innerHTML=n;l=O.firstChild;)v.appendChild(l);return this.setDOMContent(v)},a.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},a.prototype.setMaxWidth=function(n){return this.options.maxWidth=n,this._update(),this},a.prototype.setDOMContent=function(n){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=D.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(n),this._createCloseButton(),this._update(),this._focusFirstElement(),this},a.prototype.addClassName=function(n){this._container&&this._container.classList.add(n)},a.prototype.removeClassName=function(n){this._container&&this._container.classList.remove(n)},a.prototype.setOffset=function(n){return this.options.offset=n,this._update(),this},a.prototype.toggleClassName=function(n){if(this._container)return this._container.classList.toggle(n)},a.prototype._createCloseButton=function(){this.options.closeButton&&(this._closeButton=D.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},a.prototype._onMouseUp=function(n){this._update(n.point)},a.prototype._onMouseMove=function(n){this._update(n.point)},a.prototype._onDrag=function(n){this._update(n.point)},a.prototype._update=function(n){var l=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=D.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=D.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(nt){return l._container.classList.add(nt)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Fc(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||n)){var v=this._pos=this._trackPointer&&n?n:this._map.project(this._lngLat),O=this.options.anchor,L=function nt(at){if(at){if(typeof at=="number"){var Ft=Math.round(Math.sqrt(.5*Math.pow(at,2)));return{center:new i.Point(0,0),top:new i.Point(0,at),"top-left":new i.Point(Ft,Ft),"top-right":new i.Point(-Ft,Ft),bottom:new i.Point(0,-at),"bottom-left":new i.Point(Ft,-Ft),"bottom-right":new i.Point(-Ft,-Ft),left:new i.Point(at,0),right:new i.Point(-at,0)}}if(at instanceof i.Point||Array.isArray(at)){var Nt=i.Point.convert(at);return{center:Nt,top:Nt,"top-left":Nt,"top-right":Nt,bottom:Nt,"bottom-left":Nt,"bottom-right":Nt,left:Nt,right:Nt}}return{center:i.Point.convert(at.center||[0,0]),top:i.Point.convert(at.top||[0,0]),"top-left":i.Point.convert(at["top-left"]||[0,0]),"top-right":i.Point.convert(at["top-right"]||[0,0]),bottom:i.Point.convert(at.bottom||[0,0]),"bottom-left":i.Point.convert(at["bottom-left"]||[0,0]),"bottom-right":i.Point.convert(at["bottom-right"]||[0,0]),left:i.Point.convert(at.left||[0,0]),right:i.Point.convert(at.right||[0,0])}}return nt(new i.Point(0,0))}(this.options.offset);if(!O){var j,ue=this._container.offsetWidth,Ee=this._container.offsetHeight;j=v.y+L.bottom.y<Ee?["top"]:v.y>this._map.transform.height-Ee?["bottom"]:[],v.x<ue/2?j.push("left"):v.x>this._map.transform.width-ue/2&&j.push("right"),O=j.length===0?"bottom":j.join("-")}var $e=v.add(L[O]).round();D.setTransform(this._container,Gs[O]+" translate("+$e.x+"px,"+$e.y+"px)"),yf(this._container,O,"popup")}},a.prototype._focusFirstElement=function(){if(this.options.focusAfterOpen&&this._container){var n=this._container.querySelector(rc);n&&n.focus()}},a.prototype._onClose=function(){this.remove()},a}(i.Evented),ac={version:i.version,supported:Z,setRTLTextPlugin:i.setRTLTextPlugin,getRTLTextPluginStatus:i.getRTLTextPluginStatus,Map:ll,NavigationControl:Cu,GeolocateControl:zc,AttributionControl:cs,ScaleControl:Vu,FullscreenControl:Ds,Popup:nc,Marker:Bl,Style:Ii,LngLat:i.LngLat,LngLatBounds:i.LngLatBounds,Point:i.Point,MercatorCoordinate:i.MercatorCoordinate,Evented:i.Evented,config:i.config,prewarm:function(){tr().acquire(cr)},clearPrewarmedResources:function(){var a=wn;a&&(a.isPreloaded()&&a.numActive()===1?(a.release(cr),wn=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return i.config.ACCESS_TOKEN},set accessToken(s){i.config.ACCESS_TOKEN=s},get baseApiUrl(){return i.config.API_URL},set baseApiUrl(s){i.config.API_URL=s},get workerCount(){return Br.workerCount},set workerCount(s){Br.workerCount=s},get maxParallelImageRequests(){return i.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(s){i.config.MAX_PARALLEL_IMAGE_REQUESTS=s},clearStorage:function(a){i.clearTileCache(a)},workerUrl:""};return ac}),X})},"4cb6":function(Ue,g,o){"use strict";Object.defineProperty(g,"__esModule",{value:!0}),g.METADATA_KEY=void 0;var E=o("xfSm");g.METADATA_KEY=E;var p=o("9Fde");Object.defineProperty(g,"Container",{enumerable:!0,get:function(){return p.Container}});var X=o("FV85");Object.defineProperty(g,"BindingScopeEnum",{enumerable:!0,get:function(){return X.BindingScopeEnum}}),Object.defineProperty(g,"BindingTypeEnum",{enumerable:!0,get:function(){return X.BindingTypeEnum}}),Object.defineProperty(g,"TargetTypeEnum",{enumerable:!0,get:function(){return X.TargetTypeEnum}});var F=o("dxzI");Object.defineProperty(g,"AsyncContainerModule",{enumerable:!0,get:function(){return F.AsyncContainerModule}}),Object.defineProperty(g,"ContainerModule",{enumerable:!0,get:function(){return F.ContainerModule}});var i=o("cZ5Q");Object.defineProperty(g,"injectable",{enumerable:!0,get:function(){return i.injectable}});var Z=o("0gSV");Object.defineProperty(g,"tagged",{enumerable:!0,get:function(){return Z.tagged}});var D=o("ZzCi");Object.defineProperty(g,"named",{enumerable:!0,get:function(){return D.named}});var J=o("Yk9n");Object.defineProperty(g,"inject",{enumerable:!0,get:function(){return J.inject}}),Object.defineProperty(g,"LazyServiceIdentifer",{enumerable:!0,get:function(){return J.LazyServiceIdentifer}});var ee=o("jYx5");Object.defineProperty(g,"optional",{enumerable:!0,get:function(){return ee.optional}});var ce=o("n2J3");Object.defineProperty(g,"unmanaged",{enumerable:!0,get:function(){return ce.unmanaged}});var Y=o("jIg/");Object.defineProperty(g,"multiInject",{enumerable:!0,get:function(){return Y.multiInject}});var ze=o("oaX6");Object.defineProperty(g,"targetName",{enumerable:!0,get:function(){return ze.targetName}});var Xe=o("Sk89");Object.defineProperty(g,"postConstruct",{enumerable:!0,get:function(){return Xe.postConstruct}});var be=o("wnjb");Object.defineProperty(g,"MetadataReader",{enumerable:!0,get:function(){return be.MetadataReader}});var Se=o("d9O0");Object.defineProperty(g,"id",{enumerable:!0,get:function(){return Se.id}});var mt=o("Ztfv");Object.defineProperty(g,"decorate",{enumerable:!0,get:function(){return mt.decorate}});var Le=o("RR/i");Object.defineProperty(g,"traverseAncerstors",{enumerable:!0,get:function(){return Le.traverseAncerstors}}),Object.defineProperty(g,"taggedConstraint",{enumerable:!0,get:function(){return Le.taggedConstraint}}),Object.defineProperty(g,"namedConstraint",{enumerable:!0,get:function(){return Le.namedConstraint}}),Object.defineProperty(g,"typeConstraint",{enumerable:!0,get:function(){return Le.typeConstraint}});var St=o("ujMp");Object.defineProperty(g,"getServiceIdentifierAsString",{enumerable:!0,get:function(){return St.getServiceIdentifierAsString}});var Ye=o("78VC");Object.defineProperty(g,"multiBindToService",{enumerable:!0,get:function(){return Ye.multiBindToService}})},"4qC0":function(Ue,g,o){var E=o("NykK"),p=o("Z0cm"),X=o("ExA7"),F="[object String]";function i(Z){return typeof Z=="string"||!p(Z)&&X(Z)&&E(Z)==F}Ue.exports=i},"5Tg0":function(Ue,g,o){(function(E){var p=o("Kz5y"),X=g&&!g.nodeType&&g,F=X&&typeof E=="object"&&E&&!E.nodeType&&E,i=F&&F.exports===X,Z=i?p.Buffer:void 0,D=Z?Z.allocUnsafe:void 0;function J(ee,ce){if(ce)return ee.slice();var Y=ee.length,ze=D?D(Y):new ee.constructor(Y);return ee.copy(ze),ze}E.exports=J}).call(this,o("YuTi")(Ue))},"5gLl":function(Ue,g,o){"use strict";o.d(g,"a",function(){return Y});var E=o("lSNA"),p=o.n(E),X=o("LvWW"),F=o.n(X),i=o("AKIq"),Z=o.n(i),D=o("cWyK"),J=o.n(D);function ee(ze,Xe){var be=Object.keys(ze);if(Object.getOwnPropertySymbols){var Se=Object.getOwnPropertySymbols(ze);Xe&&(Se=Se.filter(function(mt){return Object.getOwnPropertyDescriptor(ze,mt).enumerable})),be.push.apply(be,Se)}return be}function ce(ze){for(var Xe=1;Xe<arguments.length;Xe++){var be=arguments[Xe]!=null?arguments[Xe]:{};Xe%2?ee(Object(be),!0).forEach(function(Se){p()(ze,Se,be[Se])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ze,Object.getOwnPropertyDescriptors(be)):ee(Object(be)).forEach(function(Se){Object.defineProperty(ze,Se,Object.getOwnPropertyDescriptor(be,Se))})}return ze}function Y(ze,Xe){var be=[],Se={};if(ze.features=ze.features.filter(function(Le){var St=Le.geometry;return Le!=null&&St&&St.type&&St.coordinates&&St.coordinates.length>0}),F()(ze,!0),ze.features.length===0)return{dataArray:[],featureKeys:Se};var mt=0;return D.flattenEach(ze,function(Le,St){var Ye=Object(i.getCoords)(Le),dt=St,Je=ce(ce({},Le.properties),{},{coordinates:Ye,_id:dt});be.push(Je)}),{dataArray:be,featureKeys:Se}}},"5ku3":function(Ue,g,o){"use strict";(function(E){o.d(g,"a",function(){return F});var p=o("U8pU"),X=o("I0ug");function F(){var Z=(typeof E=="undefined"?"undefined":Object(p.a)(E))==="object"&&String(E)==="[object process]"&&!E.browser;return!Z||Object(X.a)()}function i(){return F()&&typeof document!="undefined"}}).call(this,o("Q2Ig"))},"5zYK":function(Ue,g,o){"use strict";o.d(g,"a",function(){return ee});var E=o("lSNA"),p=o.n(E),X=o("RIqP"),F=o.n(X),i=o("LvWW"),Z=o.n(i);function D(ce,Y){var ze=Object.keys(ce);if(Object.getOwnPropertySymbols){var Xe=Object.getOwnPropertySymbols(ce);Y&&(Xe=Xe.filter(function(be){return Object.getOwnPropertyDescriptor(ce,be).enumerable})),ze.push.apply(ze,Xe)}return ze}function J(ce){for(var Y=1;Y<arguments.length;Y++){var ze=arguments[Y]!=null?arguments[Y]:{};Y%2?D(Object(ze),!0).forEach(function(Xe){p()(ce,Xe,ze[Xe])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ce,Object.getOwnPropertyDescriptors(ze)):D(Object(ze)).forEach(function(Xe){Object.defineProperty(ce,Xe,Object.getOwnPropertyDescriptor(ze,Xe))})}return ce}function ee(ce,Y){var ze=Y.x,Xe=Y.y,be=Y.x1,Se=Y.y1,mt=Y.coordinates,Le=[];return ce.forEach(function(St,Ye){var dt=[];if(ze&&Xe&&(dt=[parseFloat(St[ze]),parseFloat(St[Xe])]),ze&&Xe&&be&&Se){var Je=[parseFloat(St[ze]),parseFloat(St[Xe])],wt=[parseFloat(St[be]),parseFloat(St[Se])];dt=[Je,wt]}if(mt){var At="Polygon";Array.isArray(mt[0])||(At="Point"),Array.isArray(mt[0])&&!Array.isArray(mt[0][0])&&(At="LineString");var Ie={type:At,coordinates:F()(St[mt])};Z()(Ie,!0),dt=Ie.coordinates}var Ne=J(J({},St),{},{_id:Ye,coordinates:dt});Le.push(Ne)}),{dataArray:Le}}},"6AGu":function(Ue,g,o){"use strict";Object.defineProperty(g,"__esModule",{value:!0}),g.BindingInSyntax=void 0;var E=o("FV85"),p=o("LKzl"),X=function(){function F(i){this._binding=i}return F.prototype.inRequestScope=function(){return this._binding.scope=E.BindingScopeEnum.Request,new p.BindingWhenOnSyntax(this._binding)},F.prototype.inSingletonScope=function(){return this._binding.scope=E.BindingScopeEnum.Singleton,new p.BindingWhenOnSyntax(this._binding)},F.prototype.inTransientScope=function(){return this._binding.scope=E.BindingScopeEnum.Transient,new p.BindingWhenOnSyntax(this._binding)},F}();g.BindingInSyntax=X},"6NqC":function(Ue,g){},"6acW":function(Ue,g,o){var E=o("dt0z"),p=o("gQMU");function X(F){return p(E(F).toLowerCase())}Ue.exports=X},"6nK8":function(Ue,g,o){var E=o("dVn5"),p=o("fo6e"),X=o("dt0z"),F=o("9NmV");function i(Z,D,J){return Z=X(Z),D=J?void 0:D,D===void 0?p(Z)?F(Z):E(Z):Z.match(D)||[]}Ue.exports=i},"711d":function(Ue,g){function o(E){return function(p){return p==null?void 0:p[E]}}Ue.exports=o},"78VC":function(Ue,g,o){"use strict";Object.defineProperty(g,"__esModule",{value:!0}),g.multiBindToService=void 0,g.multiBindToService=function(E){return function(p){return function(){for(var X=[],F=0;F<arguments.length;F++)X[F]=arguments[F];return X.forEach(function(i){return E.bind(i).toService(p)})}}}},"7Ix3":function(Ue,g){function o(E){var p=[];if(E!=null)for(var X in Object(E))p.push(X);return p}Ue.exports=o},"7tbW":function(Ue,g,o){var E=o("LGYb");function p(X){return X&&X.length?E(X):[]}Ue.exports=p},"8/Fi":function(Ue,g,o){"use strict";var E=o("J4zp"),p=o.n(E),X=o("9nhX"),F=o.n(X),i=["circle","triangle","square","pentagon","hexagon","octogon","hexagram","rhombus","vesica"];function Z(ht){return i.indexOf(ht)}var D=2,J=4,ee=64,ce=128,Y=256,ze=512,Xe=8192,be=16384,Se=32768,mt=32768*2,Le=131072,St=262144,Ye=524288,dt=1048576,Je=2097152,wt=4194304,At=8388608,Ie=16777216,Ne=16777216*2;function Ve(ht,Wt){return ht=F()(Math.floor(ht),0,255),Wt=F()(Math.floor(Wt),0,255),256*ht+Wt}function ct(ht){var Wt=ht.color,Qt=ht.radius,ur=ht.tileX,oe=ht.tileY,$=ht.shape,H=ht.opacity,Ae=ht.stroke,ye=ht.strokeWidth,Te=ht.strokeOpacity,pe=[],it=[],qt=[],Pt=[Ve(Wt[0],Wt[1]),Ve(Wt[2],Wt[3])],me=[Ve(Ae[0],Ae[1]),Ve(Ae[2],Ae[3])];return[[-1,-1],[1,-1],[1,1],[-1,1]].forEach(function(ve){var Ge=p()(ve,2),st=Ge[0],Oe=Ge[1];pe.push([].concat(Pt,[(st+1)*At+(Oe+1)*Je+Z($)*Le+Qt,(ur+512)*Ye+(oe+512)*ee])),it.push([].concat(me,[ye,Te])),qt.push([H,0,0,0])}),{packedBuffer:pe,packedBuffer2:it,packedBuffer3:qt}}function Me(ht,Wt){if(ht===0&&!Wt)return 0;if(ht===1&&Wt)return 4294967295;var Qt=Wt?1:0,ur=Math.floor(ht*127);return ur*Ne+Qt*Ie+ur*Le+Qt*mt+ur*ze+Qt*Y+ur*D+Qt}},"88Gu":function(Ue,g){var o=800,E=16,p=Date.now;function X(F){var i=0,Z=0;return function(){var D=p(),J=E-(D-Z);if(Z=D,J>0){if(++i>=o)return arguments[0]}else i=0;return F.apply(void 0,arguments)}}Ue.exports=X},"8ml+":function(Ue,g,o){"use strict";var E=o("h1nZ");o.o(E,"CityBuildingLayer")&&o.d(g,"CityBuildingLayer",function(){return E.CityBuildingLayer}),o.o(E,"Control")&&o.d(g,"Control",function(){return E.Control}),o.o(E,"HeatmapLayer")&&o.d(g,"HeatmapLayer",function(){return E.HeatmapLayer}),o.o(E,"ImageLayer")&&o.d(g,"ImageLayer",function(){return E.ImageLayer}),o.o(E,"LineLayer")&&o.d(g,"LineLayer",function(){return E.LineLayer}),o.o(E,"Logo")&&o.d(g,"Logo",function(){return E.Logo}),o.o(E,"Marker")&&o.d(g,"Marker",function(){return E.Marker}),o.o(E,"PointLayer")&&o.d(g,"PointLayer",function(){return E.PointLayer}),o.o(E,"PolygonLayer")&&o.d(g,"PolygonLayer",function(){return E.PolygonLayer}),o.o(E,"Popup")&&o.d(g,"Popup",function(){return E.Popup}),o.o(E,"RasterLayer")&&o.d(g,"RasterLayer",function(){return E.RasterLayer}),o.o(E,"Scale")&&o.d(g,"Scale",function(){return E.Scale}),o.o(E,"Scene")&&o.d(g,"Scene",function(){return E.Scene}),o.o(E,"Zoom")&&o.d(g,"Zoom",function(){return E.Zoom});var p=o("kQ+U");o.d(g,"Scene",function(){return p.a});var X=o("sxDa");o.d(g,"CityBuildingLayer",function(){return X.a}),o.d(g,"HeatmapLayer",function(){return X.b}),o.d(g,"ImageLayer",function(){return X.c}),o.d(g,"LineLayer",function(){return X.d}),o.d(g,"PointLayer",function(){return X.e}),o.d(g,"PolygonLayer",function(){return X.f}),o.d(g,"RasterLayer",function(){return X.g});var F=o("k5/I");o.d(g,"Control",function(){return F.a}),o.d(g,"Logo",function(){return F.b}),o.d(g,"Marker",function(){return F.c}),o.d(g,"Popup",function(){return F.d}),o.d(g,"Scale",function(){return F.e}),o.d(g,"Zoom",function(){return F.f});var i=o("Hel2"),Z=o("RL2/")},"8uyu":function(Ue,g){},"9Fde":function(Ue,g,o){"use strict";var E=this&&this.__awaiter||function(mt,Le,St,Ye){function dt(Je){return Je instanceof St?Je:new St(function(wt){wt(Je)})}return new(St||(St=Promise))(function(Je,wt){function At(Ve){try{Ne(Ye.next(Ve))}catch(ct){wt(ct)}}function Ie(Ve){try{Ne(Ye.throw(Ve))}catch(ct){wt(ct)}}function Ne(Ve){Ve.done?Je(Ve.value):dt(Ve.value).then(At,Ie)}Ne((Ye=Ye.apply(mt,Le||[])).next())})},p=this&&this.__generator||function(mt,Le){var St={label:0,sent:function(){if(Je[0]&1)throw Je[1];return Je[1]},trys:[],ops:[]},Ye,dt,Je,wt;return wt={next:At(0),throw:At(1),return:At(2)},typeof Symbol=="function"&&(wt[Symbol.iterator]=function(){return this}),wt;function At(Ne){return function(Ve){return Ie([Ne,Ve])}}function Ie(Ne){if(Ye)throw new TypeError("Generator is already executing.");for(;St;)try{if(Ye=1,dt&&(Je=Ne[0]&2?dt.return:Ne[0]?dt.throw||((Je=dt.return)&&Je.call(dt),0):dt.next)&&!(Je=Je.call(dt,Ne[1])).done)return Je;(dt=0,Je)&&(Ne=[Ne[0]&2,Je.value]);switch(Ne[0]){case 0:case 1:Je=Ne;break;case 4:return St.label++,{value:Ne[1],done:!1};case 5:St.label++,dt=Ne[1],Ne=[0];continue;case 7:Ne=St.ops.pop(),St.trys.pop();continue;default:if(!(Je=St.trys,Je=Je.length>0&&Je[Je.length-1])&&(Ne[0]===6||Ne[0]===2)){St=0;continue}if(Ne[0]===3&&(!Je||Ne[1]>Je[0]&&Ne[1]<Je[3])){St.label=Ne[1];break}if(Ne[0]===6&&St.label<Je[1]){St.label=Je[1],Je=Ne;break}if(Je&&St.label<Je[2]){St.label=Je[2],St.ops.push(Ne);break}Je[2]&&St.ops.pop(),St.trys.pop();continue}Ne=Le.call(mt,St)}catch(Ve){Ne=[6,Ve],dt=0}finally{Ye=Je=0}if(Ne[0]&5)throw Ne[1];return{value:Ne[0]?Ne[1]:void 0,done:!0}}};Object.defineProperty(g,"__esModule",{value:!0}),g.Container=void 0;var X=o("LgvC"),F=o("MON2"),i=o("FV85"),Z=o("xfSm"),D=o("wnjb"),J=o("h7MG"),ee=o("aPG5"),ce=o("gzZq"),Y=o("d9O0"),ze=o("ujMp"),Xe=o("HpQ9"),be=o("AwBQ"),Se=function(){function mt(Le){var St=Le||{};if(typeof St!="object")throw new Error(""+F.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT);if(St.defaultScope===void 0)St.defaultScope=i.BindingScopeEnum.Transient;else if(St.defaultScope!==i.BindingScopeEnum.Singleton&&St.defaultScope!==i.BindingScopeEnum.Transient&&St.defaultScope!==i.BindingScopeEnum.Request)throw new Error(""+F.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE);if(St.autoBindInjectable===void 0)St.autoBindInjectable=!1;else if(typeof St.autoBindInjectable!="boolean")throw new Error(""+F.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE);if(St.skipBaseClassChecks===void 0)St.skipBaseClassChecks=!1;else if(typeof St.skipBaseClassChecks!="boolean")throw new Error(""+F.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK);this.options={autoBindInjectable:St.autoBindInjectable,defaultScope:St.defaultScope,skipBaseClassChecks:St.skipBaseClassChecks},this.id=Y.id(),this._bindingDictionary=new be.Lookup,this._snapshots=[],this._middleware=null,this.parent=null,this._metadataReader=new D.MetadataReader}return mt.merge=function(Le,St){var Ye=new mt,dt=J.getBindingDictionary(Ye),Je=J.getBindingDictionary(Le),wt=J.getBindingDictionary(St);function At(Ie,Ne){Ie.traverse(function(Ve,ct){ct.forEach(function(Me){Ne.add(Me.serviceIdentifier,Me.clone())})})}return At(Je,dt),At(wt,dt),Ye},mt.prototype.load=function(){for(var Le=[],St=0;St<arguments.length;St++)Le[St]=arguments[St];for(var Ye=this._getContainerModuleHelpersFactory(),dt=0,Je=Le;dt<Je.length;dt++){var wt=Je[dt],At=Ye(wt.id);wt.registry(At.bindFunction,At.unbindFunction,At.isboundFunction,At.rebindFunction)}},mt.prototype.loadAsync=function(){for(var Le=[],St=0;St<arguments.length;St++)Le[St]=arguments[St];return E(this,void 0,void 0,function(){var Ye,dt,Je,wt,At;return p(this,function(Ie){switch(Ie.label){case 0:Ye=this._getContainerModuleHelpersFactory(),dt=0,Je=Le,Ie.label=1;case 1:return dt<Je.length?(wt=Je[dt],At=Ye(wt.id),[4,wt.registry(At.bindFunction,At.unbindFunction,At.isboundFunction,At.rebindFunction)]):[3,4];case 2:Ie.sent(),Ie.label=3;case 3:return dt++,[3,1];case 4:return[2]}})})},mt.prototype.unload=function(){for(var Le=this,St=[],Ye=0;Ye<arguments.length;Ye++)St[Ye]=arguments[Ye];var dt=function(wt){return function(At){return At.moduleId===wt}};St.forEach(function(Je){var wt=dt(Je.id);Le._bindingDictionary.removeByCondition(wt)})},mt.prototype.bind=function(Le){var St=this.options.defaultScope||i.BindingScopeEnum.Transient,Ye=new X.Binding(Le,St);return this._bindingDictionary.add(Le,Ye),new ce.BindingToSyntax(Ye)},mt.prototype.rebind=function(Le){return this.unbind(Le),this.bind(Le)},mt.prototype.unbind=function(Le){try{this._bindingDictionary.remove(Le)}catch(St){throw new Error(F.CANNOT_UNBIND+" "+ze.getServiceIdentifierAsString(Le))}},mt.prototype.unbindAll=function(){this._bindingDictionary=new be.Lookup},mt.prototype.isBound=function(Le){var St=this._bindingDictionary.hasKey(Le);return!St&&this.parent&&(St=this.parent.isBound(Le)),St},mt.prototype.isBoundNamed=function(Le,St){return this.isBoundTagged(Le,Z.NAMED_TAG,St)},mt.prototype.isBoundTagged=function(Le,St,Ye){var dt=!1;if(this._bindingDictionary.hasKey(Le)){var Je=this._bindingDictionary.get(Le),wt=J.createMockRequest(this,Le,St,Ye);dt=Je.some(function(At){return At.constraint(wt)})}return!dt&&this.parent&&(dt=this.parent.isBoundTagged(Le,St,Ye)),dt},mt.prototype.snapshot=function(){this._snapshots.push(Xe.ContainerSnapshot.of(this._bindingDictionary.clone(),this._middleware))},mt.prototype.restore=function(){var Le=this._snapshots.pop();if(Le===void 0)throw new Error(F.NO_MORE_SNAPSHOTS_AVAILABLE);this._bindingDictionary=Le.bindings,this._middleware=Le.middleware},mt.prototype.createChild=function(Le){var St=new mt(Le||this.options);return St.parent=this,St},mt.prototype.applyMiddleware=function(){for(var Le=[],St=0;St<arguments.length;St++)Le[St]=arguments[St];var Ye=this._middleware?this._middleware:this._planAndResolve();this._middleware=Le.reduce(function(dt,Je){return Je(dt)},Ye)},mt.prototype.applyCustomMetadataReader=function(Le){this._metadataReader=Le},mt.prototype.get=function(Le){return this._get(!1,!1,i.TargetTypeEnum.Variable,Le)},mt.prototype.getTagged=function(Le,St,Ye){return this._get(!1,!1,i.TargetTypeEnum.Variable,Le,St,Ye)},mt.prototype.getNamed=function(Le,St){return this.getTagged(Le,Z.NAMED_TAG,St)},mt.prototype.getAll=function(Le){return this._get(!0,!0,i.TargetTypeEnum.Variable,Le)},mt.prototype.getAllTagged=function(Le,St,Ye){return this._get(!1,!0,i.TargetTypeEnum.Variable,Le,St,Ye)},mt.prototype.getAllNamed=function(Le,St){return this.getAllTagged(Le,Z.NAMED_TAG,St)},mt.prototype.resolve=function(Le){var St=this.createChild();return St.bind(Le).toSelf(),St.get(Le)},mt.prototype._getContainerModuleHelpersFactory=function(){var Le=this,St=function(Ie,Ne){Ie._binding.moduleId=Ne},Ye=function(Ie){return function(Ne){var Ve=Le.bind.bind(Le),ct=Ve(Ne);return St(ct,Ie),ct}},dt=function(Ie){return function(Ne){var Ve=Le.unbind.bind(Le);Ve(Ne)}},Je=function(Ie){return function(Ne){var Ve=Le.isBound.bind(Le);return Ve(Ne)}},wt=function(Ie){return function(Ne){var Ve=Le.rebind.bind(Le),ct=Ve(Ne);return St(ct,Ie),ct}};return function(At){return{bindFunction:Ye(At),isboundFunction:Je(At),rebindFunction:wt(At),unbindFunction:dt(At)}}},mt.prototype._get=function(Le,St,Ye,dt,Je,wt){var At=null,Ie={avoidConstraints:Le,contextInterceptor:function(Ve){return Ve},isMultiInject:St,key:Je,serviceIdentifier:dt,targetType:Ye,value:wt};if(this._middleware){if(At=this._middleware(Ie),At==null)throw new Error(F.INVALID_MIDDLEWARE_RETURN)}else At=this._planAndResolve()(Ie);return At},mt.prototype._planAndResolve=function(){var Le=this;return function(St){var Ye=J.plan(Le._metadataReader,Le,St.isMultiInject,St.targetType,St.serviceIdentifier,St.key,St.value,St.avoidConstraints);Ye=St.contextInterceptor(Ye);var dt=ee.resolve(Ye);return dt}},mt}();g.Container=Se},"9NmV":function(Ue,g){var o="\\ud800-\\udfff",E="\\u0300-\\u036f",p="\\ufe20-\\ufe2f",X="\\u20d0-\\u20ff",F=E+p+X,i="\\u2700-\\u27bf",Z="a-z\\xdf-\\xf6\\xf8-\\xff",D="\\xac\\xb1\\xd7\\xf7",J="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",ee="\\u2000-\\u206f",ce=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Y="A-Z\\xc0-\\xd6\\xd8-\\xde",ze="\\ufe0e\\ufe0f",Xe=D+J+ee+ce,be="['\u2019]",Se="["+Xe+"]",mt="["+F+"]",Le="\\d+",St="["+i+"]",Ye="["+Z+"]",dt="[^"+o+Xe+Le+i+Z+Y+"]",Je="\\ud83c[\\udffb-\\udfff]",wt="(?:"+mt+"|"+Je+")",At="[^"+o+"]",Ie="(?:\\ud83c[\\udde6-\\uddff]){2}",Ne="[\\ud800-\\udbff][\\udc00-\\udfff]",Ve="["+Y+"]",ct="\\u200d",Me="(?:"+Ye+"|"+dt+")",ht="(?:"+Ve+"|"+dt+")",Wt="(?:"+be+"(?:d|ll|m|re|s|t|ve))?",Qt="(?:"+be+"(?:D|LL|M|RE|S|T|VE))?",ur=wt+"?",oe="["+ze+"]?",$="(?:"+ct+"(?:"+[At,Ie,Ne].join("|")+")"+oe+ur+")*",H="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Ae="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",ye=oe+ur+$,Te="(?:"+[St,Ie,Ne].join("|")+")"+ye,pe=RegExp([Ve+"?"+Ye+"+"+Wt+"(?="+[Se,Ve,"$"].join("|")+")",ht+"+"+Qt+"(?="+[Se,Ve+Me,"$"].join("|")+")",Ve+"?"+Me+"+"+Wt,Ve+"+"+Qt,Ae,H,Le,Te].join("|"),"g");function it(qt){return qt.match(pe)||[]}Ue.exports=it},"9lTW":function(Ue,g,o){"use strict";(function(E){var p=o("MgzW");/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */function X(Me,ht){if(Me===ht)return 0;for(var Wt=Me.length,Qt=ht.length,ur=0,oe=Math.min(Wt,Qt);ur<oe;++ur)if(Me[ur]!==ht[ur]){Wt=Me[ur],Qt=ht[ur];break}return Wt<Qt?-1:Qt<Wt?1:0}function F(Me){return E.Buffer&&typeof E.Buffer.isBuffer=="function"?E.Buffer.isBuffer(Me):!!(Me!=null&&Me._isBuffer)}var i=o("MCLT"),Z=Object.prototype.hasOwnProperty,D=Array.prototype.slice,J=function(){return function(){}.name==="foo"}();function ee(Me){return Object.prototype.toString.call(Me)}function ce(Me){return F(Me)||typeof E.ArrayBuffer!="function"?!1:typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(Me):Me?Me instanceof DataView?!0:!!(Me.buffer&&Me.buffer instanceof ArrayBuffer):!1}var Y=Ue.exports=St,ze=/\s*function\s+([^\(\s]*)\s*/;function Xe(Me){if(!i.isFunction(Me))return;if(J)return Me.name;var ht=Me.toString(),Wt=ht.match(ze);return Wt&&Wt[1]}Y.AssertionError=function(ht){this.name="AssertionError",this.actual=ht.actual,this.expected=ht.expected,this.operator=ht.operator,ht.message?(this.message=ht.message,this.generatedMessage=!1):(this.message=mt(this),this.generatedMessage=!0);var Wt=ht.stackStartFunction||Le;if(Error.captureStackTrace)Error.captureStackTrace(this,Wt);else{var Qt=new Error;if(Qt.stack){var ur=Qt.stack,oe=Xe(Wt),$=ur.indexOf(`
`+oe);if($>=0){var H=ur.indexOf(`
`,$+1);ur=ur.substring(H+1)}this.stack=ur}}},i.inherits(Y.AssertionError,Error);function be(Me,ht){return typeof Me=="string"?Me.length<ht?Me:Me.slice(0,ht):Me}function Se(Me){if(J||!i.isFunction(Me))return i.inspect(Me);var ht=Xe(Me),Wt=ht?": "+ht:"";return"[Function"+Wt+"]"}function mt(Me){return be(Se(Me.actual),128)+" "+Me.operator+" "+be(Se(Me.expected),128)}function Le(Me,ht,Wt,Qt,ur){throw new Y.AssertionError({message:Wt,actual:Me,expected:ht,operator:Qt,stackStartFunction:ur})}Y.fail=Le;function St(Me,ht){Me||Le(Me,!0,ht,"==",Y.ok)}Y.ok=St,Y.equal=function(ht,Wt,Qt){ht!=Wt&&Le(ht,Wt,Qt,"==",Y.equal)},Y.notEqual=function(ht,Wt,Qt){ht==Wt&&Le(ht,Wt,Qt,"!=",Y.notEqual)},Y.deepEqual=function(ht,Wt,Qt){Ye(ht,Wt,!1)||Le(ht,Wt,Qt,"deepEqual",Y.deepEqual)},Y.deepStrictEqual=function(ht,Wt,Qt){Ye(ht,Wt,!0)||Le(ht,Wt,Qt,"deepStrictEqual",Y.deepStrictEqual)};function Ye(Me,ht,Wt,Qt){if(Me===ht)return!0;if(F(Me)&&F(ht))return X(Me,ht)===0;if(i.isDate(Me)&&i.isDate(ht))return Me.getTime()===ht.getTime();if(i.isRegExp(Me)&&i.isRegExp(ht))return Me.source===ht.source&&Me.global===ht.global&&Me.multiline===ht.multiline&&Me.lastIndex===ht.lastIndex&&Me.ignoreCase===ht.ignoreCase;if((Me===null||typeof Me!="object")&&(ht===null||typeof ht!="object"))return Wt?Me===ht:Me==ht;if(ce(Me)&&ce(ht)&&ee(Me)===ee(ht)&&!(Me instanceof Float32Array||Me instanceof Float64Array))return X(new Uint8Array(Me.buffer),new Uint8Array(ht.buffer))===0;if(F(Me)!==F(ht))return!1;Qt=Qt||{actual:[],expected:[]};var ur=Qt.actual.indexOf(Me);return ur!==-1&&ur===Qt.expected.indexOf(ht)?!0:(Qt.actual.push(Me),Qt.expected.push(ht),Je(Me,ht,Wt,Qt))}function dt(Me){return Object.prototype.toString.call(Me)=="[object Arguments]"}function Je(Me,ht,Wt,Qt){if(Me==null||ht===null||ht===void 0)return!1;if(i.isPrimitive(Me)||i.isPrimitive(ht))return Me===ht;if(Wt&&Object.getPrototypeOf(Me)!==Object.getPrototypeOf(ht))return!1;var ur=dt(Me),oe=dt(ht);if(ur&&!oe||!ur&&oe)return!1;if(ur)return Me=D.call(Me),ht=D.call(ht),Ye(Me,ht,Wt);var $=ct(Me),H=ct(ht),Ae,ye;if($.length!==H.length)return!1;for($.sort(),H.sort(),ye=$.length-1;ye>=0;ye--)if($[ye]!==H[ye])return!1;for(ye=$.length-1;ye>=0;ye--)if(Ae=$[ye],!Ye(Me[Ae],ht[Ae],Wt,Qt))return!1;return!0}Y.notDeepEqual=function(ht,Wt,Qt){Ye(ht,Wt,!1)&&Le(ht,Wt,Qt,"notDeepEqual",Y.notDeepEqual)},Y.notDeepStrictEqual=wt;function wt(Me,ht,Wt){Ye(Me,ht,!0)&&Le(Me,ht,Wt,"notDeepStrictEqual",wt)}Y.strictEqual=function(ht,Wt,Qt){ht!==Wt&&Le(ht,Wt,Qt,"===",Y.strictEqual)},Y.notStrictEqual=function(ht,Wt,Qt){ht===Wt&&Le(ht,Wt,Qt,"!==",Y.notStrictEqual)};function At(Me,ht){if(!Me||!ht)return!1;if(Object.prototype.toString.call(ht)=="[object RegExp]")return ht.test(Me);try{if(Me instanceof ht)return!0}catch(Wt){}return Error.isPrototypeOf(ht)?!1:ht.call({},Me)===!0}function Ie(Me){var ht;try{Me()}catch(Wt){ht=Wt}return ht}function Ne(Me,ht,Wt,Qt){var ur;if(typeof ht!="function")throw new TypeError('"block" argument must be a function');typeof Wt=="string"&&(Qt=Wt,Wt=null),ur=Ie(ht),Qt=(Wt&&Wt.name?" ("+Wt.name+").":".")+(Qt?" "+Qt:"."),Me&&!ur&&Le(ur,Wt,"Missing expected exception"+Qt);var oe=typeof Qt=="string",$=!Me&&i.isError(ur),H=!Me&&ur&&!Wt;if(($&&oe&&At(ur,Wt)||H)&&Le(ur,Wt,"Got unwanted exception"+Qt),Me&&ur&&Wt&&!At(ur,Wt)||!Me&&ur)throw ur}Y.throws=function(Me,ht,Wt){Ne(!0,Me,ht,Wt)},Y.doesNotThrow=function(Me,ht,Wt){Ne(!1,Me,ht,Wt)},Y.ifError=function(Me){if(Me)throw Me};function Ve(Me,ht){Me||Le(Me,!0,ht,"==",Ve)}Y.strict=p(Ve,Y,{equal:Y.strictEqual,deepEqual:Y.deepStrictEqual,notEqual:Y.notStrictEqual,notDeepEqual:Y.notDeepStrictEqual}),Y.strict.strict=Y.strict;var ct=Object.keys||function(Me){var ht=[];for(var Wt in Me)Z.call(Me,Wt)&&ht.push(Wt);return ht}}).call(this,o("yLpj"))},"9nhX":function(Ue,g,o){var E=o("g4R6"),p=o("tLB3");function X(F,i,Z){return Z===void 0&&(Z=i,i=void 0),Z!==void 0&&(Z=p(Z),Z=Z===Z?Z:0),i!==void 0&&(i=p(i),i=i===i?i:0),E(p(F),i,Z)}Ue.exports=X},AFH1:function(Ue,g,o){"use strict";o.d(g,"a",function(){return E});var E;(function(p){p.TOPRIGHT="topright",p.TOPLEFT="topleft",p.BOTTOMRIGHT="bottomright",p.BOTTOMLEFT="bottomleft"})(E||(E={}))},AKIq:function(Ue,g,o){"use strict";Object.defineProperty(g,"__esModule",{value:!0});var E=o("/rf6");function p(ce){if(!ce)throw new Error("coord is required");if(!Array.isArray(ce)){if(ce.type==="Feature"&&ce.geometry!==null&&ce.geometry.type==="Point")return ce.geometry.coordinates;if(ce.type==="Point")return ce.coordinates}if(Array.isArray(ce)&&ce.length>=2&&!Array.isArray(ce[0])&&!Array.isArray(ce[1]))return ce;throw new Error("coord must be GeoJSON Point or an Array of numbers")}g.getCoord=p;function X(ce){if(Array.isArray(ce))return ce;if(ce.type==="Feature"){if(ce.geometry!==null)return ce.geometry.coordinates}else if(ce.coordinates)return ce.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}g.getCoords=X;function F(ce){if(ce.length>1&&E.isNumber(ce[0])&&E.isNumber(ce[1]))return!0;if(Array.isArray(ce[0])&&ce[0].length)return F(ce[0]);throw new Error("coordinates must only contain numbers")}g.containsNumber=F;function i(ce,Y,ze){if(!Y||!ze)throw new Error("type and name required");if(!ce||ce.type!==Y)throw new Error("Invalid input to "+ze+": must be a "+Y+", given "+ce.type)}g.geojsonType=i;function Z(ce,Y,ze){if(!ce)throw new Error("No feature passed");if(!ze)throw new Error(".featureOf() requires a name");if(!ce||ce.type!=="Feature"||!ce.geometry)throw new Error("Invalid input to "+ze+", Feature with geometry required");if(!ce.geometry||ce.geometry.type!==Y)throw new Error("Invalid input to "+ze+": must be a "+Y+", given "+ce.geometry.type)}g.featureOf=Z;function D(ce,Y,ze){if(!ce)throw new Error("No featureCollection passed");if(!ze)throw new Error(".collectionOf() requires a name");if(!ce||ce.type!=="FeatureCollection")throw new Error("Invalid input to "+ze+", FeatureCollection required");for(var Xe=0,be=ce.features;Xe<be.length;Xe++){var Se=be[Xe];if(!Se||Se.type!=="Feature"||!Se.geometry)throw new Error("Invalid input to "+ze+", Feature with geometry required");if(!Se.geometry||Se.geometry.type!==Y)throw new Error("Invalid input to "+ze+": must be a "+Y+", given "+Se.geometry.type)}}g.collectionOf=D;function J(ce){return ce.type==="Feature"?ce.geometry:ce}g.getGeom=J;function ee(ce,Y){return ce.type==="FeatureCollection"?"FeatureCollection":ce.type==="GeometryCollection"?"GeometryCollection":ce.type==="Feature"&&ce.geometry!==null?ce.geometry.type:ce.type}g.getType=ee},APxj:function(Ue,g,o){"use strict";Object.defineProperty(g,"__esModule",{value:!0});var E=o("Ucsi");function p(X,F){F===void 0&&(F=!0);var i=E.makePropertyInjectDecorator(X,F),Z=E.makePropertyInjectNamedDecorator(X,F),D=E.makePropertyInjectTaggedDecorator(X,F),J=E.makePropertyMultiInjectDecorator(X,F);return{lazyInject:i,lazyInjectNamed:Z,lazyInjectTagged:D,lazyMultiInject:J}}g.default=p},AwBQ:function(Ue,g,o){"use strict";Object.defineProperty(g,"__esModule",{value:!0}),g.Lookup=void 0;var E=o("MON2"),p=function(){function X(){this._map=new Map}return X.prototype.getMap=function(){return this._map},X.prototype.add=function(F,i){if(F==null)throw new Error(E.NULL_ARGUMENT);if(i==null)throw new Error(E.NULL_ARGUMENT);var Z=this._map.get(F);Z!==void 0?(Z.push(i),this._map.set(F,Z)):this._map.set(F,[i])},X.prototype.get=function(F){if(F==null)throw new Error(E.NULL_ARGUMENT);var i=this._map.get(F);if(i!==void 0)return i;throw new Error(E.KEY_NOT_FOUND)},X.prototype.remove=function(F){if(F==null)throw new Error(E.NULL_ARGUMENT);if(!this._map.delete(F))throw new Error(E.KEY_NOT_FOUND)},X.prototype.removeByCondition=function(F){var i=this;this._map.forEach(function(Z,D){var J=Z.filter(function(ee){return!F(ee)});J.length>0?i._map.set(D,J):i._map.delete(D)})},X.prototype.hasKey=function(F){if(F==null)throw new Error(E.NULL_ARGUMENT);return this._map.has(F)},X.prototype.clone=function(){var F=new X;return this._map.forEach(function(i,Z){i.forEach(function(D){return F.add(Z,D.clone())})}),F},X.prototype.traverse=function(F){this._map.forEach(function(i,Z){F(Z,i)})},X}();g.Lookup=p},"B6l+":function(Ue,g,o){var E=o("Sq3C"),p=o("Z1HP"),X=o("Sxd8"),F=o("dt0z");function i(Z,D,J){Z=F(Z),D=X(D);var ee=D?p(Z):0;return D&&ee<D?Z+E(D-ee,J):Z}Ue.exports=i},BGjm:function(Ue,g){Ue.exports=o;function o(E,p){p||(p=document);var X=p.head||p.getElementsByTagName("head")[0];if(!X){X=p.createElement("head");var F=p.body||p.getElementsByTagName("body")[0];F?F.parentNode.insertBefore(X,F):p.documentElement.appendChild(X)}var i=p.createElement("style");return i.type="text/css",i.styleSheet?i.styleSheet.cssText=E:i.appendChild(p.createTextNode(E)),X.appendChild(i),i}},BMrR:function(Ue,g,o){"use strict";var E=o("qrJ5");g.a=E.a},BkRI:function(Ue,g,o){var E=o("OBhP"),p=1,X=4;function F(i){return E(i,p|X)}Ue.exports=F},BpBL:function(Ue,g,o){"use strict";o.d(g,"a",function(){return p});var E=o("Hel2");function p(F,i){var Z=i.extent,D=new Promise(function(ee){X(F,function(ce){ee(ce)})}),J={images:D,_id:1,dataArray:[{_id:0,coordinates:[[Z[0],Z[1]],[Z[2],Z[3]]]}]};return J}function X(F,i){var Z=F,D=[];if(typeof Z=="string")Object(E.o)({url:Z},function(ce,Y){D.push(Y),i(D)});else{var J=Z.length,ee=0;Z.forEach(function(ce){Object(E.o)({url:ce},function(Y,ze){ee++,D.push(ze),ee===J&&i(D)})})}return p}},CZoQ:function(Ue,g){function o(E,p,X){for(var F=X-1,i=E.length;++F<i;)if(E[F]===p)return F;return-1}Ue.exports=o},"D+ow":function(Ue,g){},D9lx:function(Ue,g,o){"use strict";Object.defineProperty(g,"__esModule",{value:!0}),g.BindingInWhenOnSyntax=void 0;var E=o("6AGu"),p=o("406g"),X=o("z4Hk"),F=function(){function i(Z){this._binding=Z,this._bindingWhenSyntax=new X.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new p.BindingOnSyntax(this._binding),this._bindingInSyntax=new E.BindingInSyntax(Z)}return i.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},i.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},i.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},i.prototype.when=function(Z){return this._bindingWhenSyntax.when(Z)},i.prototype.whenTargetNamed=function(Z){return this._bindingWhenSyntax.whenTargetNamed(Z)},i.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},i.prototype.whenTargetTagged=function(Z,D){return this._bindingWhenSyntax.whenTargetTagged(Z,D)},i.prototype.whenInjectedInto=function(Z){return this._bindingWhenSyntax.whenInjectedInto(Z)},i.prototype.whenParentNamed=function(Z){return this._bindingWhenSyntax.whenParentNamed(Z)},i.prototype.whenParentTagged=function(Z,D){return this._bindingWhenSyntax.whenParentTagged(Z,D)},i.prototype.whenAnyAncestorIs=function(Z){return this._bindingWhenSyntax.whenAnyAncestorIs(Z)},i.prototype.whenNoAncestorIs=function(Z){return this._bindingWhenSyntax.whenNoAncestorIs(Z)},i.prototype.whenAnyAncestorNamed=function(Z){return this._bindingWhenSyntax.whenAnyAncestorNamed(Z)},i.prototype.whenAnyAncestorTagged=function(Z,D){return this._bindingWhenSyntax.whenAnyAncestorTagged(Z,D)},i.prototype.whenNoAncestorNamed=function(Z){return this._bindingWhenSyntax.whenNoAncestorNamed(Z)},i.prototype.whenNoAncestorTagged=function(Z,D){return this._bindingWhenSyntax.whenNoAncestorTagged(Z,D)},i.prototype.whenAnyAncestorMatches=function(Z){return this._bindingWhenSyntax.whenAnyAncestorMatches(Z)},i.prototype.whenNoAncestorMatches=function(Z){return this._bindingWhenSyntax.whenNoAncestorMatches(Z)},i.prototype.onActivation=function(Z){return this._bindingOnSyntax.onActivation(Z)},i}();g.BindingInWhenOnSyntax=F},"Dw+G":function(Ue,g,o){var E=o("juv8"),p=o("mTTR");function X(F,i){return F&&E(i,p(i),F)}Ue.exports=X},DzJC:function(Ue,g,o){var E=o("sEfC"),p=o("GoyQ"),X="Expected a function";function F(i,Z,D){var J=!0,ee=!0;if(typeof i!="function")throw new TypeError(X);return p(D)&&(J="leading"in D?!!D.leading:J,ee="trailing"in D?!!D.trailing:ee),E(i,Z,{leading:J,maxWait:Z,trailing:ee})}Ue.exports=F},EA7m:function(Ue,g,o){var E=o("zZ0H"),p=o("Ioao"),X=o("wclG");function F(i,Z){return X(p(i,Z,E),i+"")}Ue.exports=F},EEGq:function(Ue,g,o){var E=o("juv8"),p=o("oCl/");function X(F,i){return E(F,p(F),i)}Ue.exports=X},EfZ0:function(Ue,g,o){"use strict";o.d(g,"a",function(){return E});var E={ProjectionMatrix:"u_ProjectionMatrix",ViewMatrix:"u_ViewMatrix",ViewProjectionMatrix:"u_ViewProjectionMatrix",Zoom:"u_Zoom",ZoomScale:"u_ZoomScale",FocalDistance:"u_FocalDistance",CameraPosition:"u_CameraPosition"}},Em2t:function(Ue,g,o){var E=o("bahg"),p=o("quyA"),X=o("0JQy");function F(i){return p(i)?X(i):E(i)}Ue.exports=F},FI6e:function(Ue,g){},FV85:function(Ue,g,o){"use strict";Object.defineProperty(g,"__esModule",{value:!0}),g.TargetTypeEnum=g.BindingTypeEnum=g.BindingScopeEnum=void 0;var E={Request:"Request",Singleton:"Singleton",Transient:"Transient"};g.BindingScopeEnum=E;var p={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"};g.BindingTypeEnum=p;var X={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"};g.TargetTypeEnum=X},FmoU:function(Ue,g,o){"use strict";o.d(g,"a",function(){return dt}),o.d(g,"b",function(){return Ie});var E=function($,H,Ae){$.prototype=H.prototype=Ae,Ae.constructor=$};function p($,H){var Ae=Object.create($.prototype);for(var ye in H)Ae[ye]=H[ye];return Ae}function X(){}var F=.7,i=1/F,Z="\\s*([+-]?\\d+)\\s*",D="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",J="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",ee=/^#([0-9a-f]{3,8})$/,ce=new RegExp("^rgb\\("+[Z,Z,Z]+"\\)$"),Y=new RegExp("^rgb\\("+[J,J,J]+"\\)$"),ze=new RegExp("^rgba\\("+[Z,Z,Z,D]+"\\)$"),Xe=new RegExp("^rgba\\("+[J,J,J,D]+"\\)$"),be=new RegExp("^hsl\\("+[D,J,J]+"\\)$"),Se=new RegExp("^hsla\\("+[D,J,J,D]+"\\)$"),mt={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};E(X,dt,{copy:function(H){return Object.assign(new this.constructor,this,H)},displayable:function(){return this.rgb().displayable()},hex:Le,formatHex:Le,formatHsl:St,formatRgb:Ye,toString:Ye});function Le(){return this.rgb().formatHex()}function St(){return Wt(this).formatHsl()}function Ye(){return this.rgb().formatRgb()}function dt($){var H,Ae;return $=($+"").trim().toLowerCase(),(H=ee.exec($))?(Ae=H[1].length,H=parseInt(H[1],16),Ae===6?Je(H):Ae===3?new Ne(H>>8&15|H>>4&240,H>>4&15|H&240,(H&15)<<4|H&15,1):Ae===8?wt(H>>24&255,H>>16&255,H>>8&255,(H&255)/255):Ae===4?wt(H>>12&15|H>>8&240,H>>8&15|H>>4&240,H>>4&15|H&240,((H&15)<<4|H&15)/255):null):(H=ce.exec($))?new Ne(H[1],H[2],H[3],1):(H=Y.exec($))?new Ne(H[1]*255/100,H[2]*255/100,H[3]*255/100,1):(H=ze.exec($))?wt(H[1],H[2],H[3],H[4]):(H=Xe.exec($))?wt(H[1]*255/100,H[2]*255/100,H[3]*255/100,H[4]):(H=be.exec($))?ht(H[1],H[2]/100,H[3]/100,1):(H=Se.exec($))?ht(H[1],H[2]/100,H[3]/100,H[4]):mt.hasOwnProperty($)?Je(mt[$]):$==="transparent"?new Ne(NaN,NaN,NaN,0):null}function Je($){return new Ne($>>16&255,$>>8&255,$&255,1)}function wt($,H,Ae,ye){return ye<=0&&($=H=Ae=NaN),new Ne($,H,Ae,ye)}function At($){return $ instanceof X||($=dt($)),$?($=$.rgb(),new Ne($.r,$.g,$.b,$.opacity)):new Ne}function Ie($,H,Ae,ye){return arguments.length===1?At($):new Ne($,H,Ae,ye==null?1:ye)}function Ne($,H,Ae,ye){this.r=+$,this.g=+H,this.b=+Ae,this.opacity=+ye}E(Ne,Ie,p(X,{brighter:function(H){return H=H==null?i:Math.pow(i,H),new Ne(this.r*H,this.g*H,this.b*H,this.opacity)},darker:function(H){return H=H==null?F:Math.pow(F,H),new Ne(this.r*H,this.g*H,this.b*H,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Ve,formatHex:Ve,formatRgb:ct,toString:ct}));function Ve(){return"#"+Me(this.r)+Me(this.g)+Me(this.b)}function ct(){var $=this.opacity;return $=isNaN($)?1:Math.max(0,Math.min(1,$)),($===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+($===1?")":", "+$+")")}function Me($){return $=Math.max(0,Math.min(255,Math.round($)||0)),($<16?"0":"")+$.toString(16)}function ht($,H,Ae,ye){return ye<=0?$=H=Ae=NaN:Ae<=0||Ae>=1?$=H=NaN:H<=0&&($=NaN),new ur($,H,Ae,ye)}function Wt($){if($ instanceof ur)return new ur($.h,$.s,$.l,$.opacity);if($ instanceof X||($=dt($)),!$)return new ur;if($ instanceof ur)return $;$=$.rgb();var H=$.r/255,Ae=$.g/255,ye=$.b/255,Te=Math.min(H,Ae,ye),pe=Math.max(H,Ae,ye),it=NaN,qt=pe-Te,Pt=(pe+Te)/2;return qt?(H===pe?it=(Ae-ye)/qt+(Ae<ye)*6:Ae===pe?it=(ye-H)/qt+2:it=(H-Ae)/qt+4,qt/=Pt<.5?pe+Te:2-pe-Te,it*=60):qt=Pt>0&&Pt<1?0:it,new ur(it,qt,Pt,$.opacity)}function Qt($,H,Ae,ye){return arguments.length===1?Wt($):new ur($,H,Ae,ye==null?1:ye)}function ur($,H,Ae,ye){this.h=+$,this.s=+H,this.l=+Ae,this.opacity=+ye}E(ur,Qt,p(X,{brighter:function(H){return H=H==null?i:Math.pow(i,H),new ur(this.h,this.s,this.l*H,this.opacity)},darker:function(H){return H=H==null?F:Math.pow(F,H),new ur(this.h,this.s,this.l*H,this.opacity)},rgb:function(){var H=this.h%360+(this.h<0)*360,Ae=isNaN(H)||isNaN(this.s)?0:this.s,ye=this.l,Te=ye+(ye<.5?ye:1-ye)*Ae,pe=2*ye-Te;return new Ne(oe(H>=240?H-240:H+120,pe,Te),oe(H,pe,Te),oe(H<120?H+240:H-120,pe,Te),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var H=this.opacity;return H=isNaN(H)?1:Math.max(0,Math.min(1,H)),(H===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(H===1?")":", "+H+")")}}));function oe($,H,Ae){return($<60?H+(Ae-H)*$/60:$<180?Ae:$<240?H+(Ae-H)*(240-$)/60:H)*255}},G6z8:function(Ue,g,o){var E=o("fR/l"),p=o("oCl/"),X=o("mTTR");function F(i){return E(i,X,p)}Ue.exports=F},GXnB:function(Ue,g,o){"use strict";Object.defineProperty(g,"__esModule",{value:!0}),g.Metadata=void 0;var E=o("xfSm"),p=function(){function X(F,i){this.key=F,this.value=i}return X.prototype.toString=function(){return this.key===E.NAMED_TAG?"named: "+this.value.toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+this.value+" }"},X}();g.Metadata=p},Gi0A:function(Ue,g,o){var E=o("QqLw"),p=o("ExA7"),X="[object Map]";function F(i){return p(i)&&E(i)==X}Ue.exports=F},HTcj:function(Ue,g,o){"use strict";var E=o("GNNt"),p=o("wEI+"),X=o("q1tI"),F=o.n(X),i=o("TSYQ"),Z=o.n(i),D=o("jYQm"),J=function(Y){var ze=Object(X.useContext)(D.a),Xe=Y.children,be=Y.contentWidth,Se=Y.className,mt=Y.style,Le=Object(X.useContext)(p.b.ConfigContext),St=Le.getPrefixCls,Ye=Y.prefixCls||St("pro"),dt=be||ze.contentWidth,Je="".concat(Ye,"-grid-content");return F.a.createElement("div",{className:Z()(Je,Se,{wide:dt==="Fixed"}),style:mt},F.a.createElement("div",{className:"".concat(Ye,"-grid-content-children")},Xe))},ee=g.a=J},Hel2:function(Ue,g,o){"use strict";o.d(g,"o",function(){return Pt}),o.d(g,"m",function(){return Oe}),o.d(g,"p",function(){return q}),o.d(g,"d",function(){return ot}),o.d(g,"q",function(){return K}),o.d(g,"r",function(){return ae}),o.d(g,"j",function(){return tt}),o.d(g,"h",function(){return kt}),o.d(g,"b",function(){return pr}),o.d(g,"i",function(){return Ke}),o.d(g,"s",function(){return bt}),o.d(g,"k",function(){return Et}),o.d(g,"l",function(){return Fe}),o.d(g,"n",function(){return pt}),o.d(g,"f",function(){return yt}),o.d(g,"e",function(){return Ht}),o.d(g,"g",function(){return hr}),o.d(g,"a",function(){return E}),o.d(g,"c",function(){return p});var E={};o.r(E),o.d(E,"getContainer",function(){return Z}),o.d(E,"trim",function(){return D}),o.d(E,"splitWords",function(){return J}),o.d(E,"create",function(){return ce}),o.d(E,"remove",function(){return Y}),o.d(E,"addClass",function(){return ze}),o.d(E,"removeClass",function(){return Xe}),o.d(E,"hasClass",function(){return be}),o.d(E,"setClass",function(){return Se}),o.d(E,"getClass",function(){return mt}),o.d(E,"empty",function(){return Le}),o.d(E,"setTransform",function(){return Ye}),o.d(E,"triggerResize",function(){return dt}),o.d(E,"printCanvas",function(){return Je});var p={};o.r(p),o.d(p,"sum",function(){return Vn}),o.d(p,"max",function(){return Zr}),o.d(p,"min",function(){return yr}),o.d(p,"mean",function(){return zn}),o.d(p,"mode",function(){return oa}),o.d(p,"statMap",function(){return $n}),o.d(p,"getColumn",function(){return Kn}),o.d(p,"getSatByColumn",function(){return Cn});function X(z){var W=131,le=137,xe=0;z+="x";for(var ut=Math.floor(9007199254740991/le),Ot=0;Ot<z.length;Ot++)xe>ut&&(xe=Math.floor(xe/le)),xe=xe*W+z.charCodeAt(Ot);return xe}function F(z){z=z.toString();for(var W=5381,le=z.length;le;)W=W*33^z.charCodeAt(--le);return W>>>0}var i=window.document.documentElement.style;function Z(z){var W=z;return typeof z=="string"&&(W=document.getElementById(z)),W}function D(z){return z.trim?z.trim():z.replace(/^\s+|\s+$/g,"")}function J(z){return D(z).split(/\s+/)}function ee(z){if(!i)return z[0];for(var W in z)if(z[W]&&z[W]in i)return z[W];return z[0]}function ce(z,W,le){var xe=document.createElement(z);return xe.className=W||"",le&&le.appendChild(xe),xe}function Y(z){var W=z.parentNode;W&&W.removeChild(z)}function ze(z,W){if(z.classList!==void 0)for(var le=J(W),xe=0,ut=le.length;xe<ut;xe++)z.classList.add(le[xe]);else if(!be(z,W)){var Ot=mt(z);Se(z,(Ot?Ot+" ":"")+W)}}function Xe(z,W){z.classList!==void 0?z.classList.remove(W):Se(z,D((" "+mt(z)+" ").replace(" "+W+" "," ")))}function be(z,W){if(z.classList!==void 0)return z.classList.contains(W);var le=mt(z);return le.length>0&&new RegExp("(^|\\s)"+W+"(\\s|$)").test(le)}function Se(z,W){z instanceof HTMLElement?z.className=W:z.className.baseVal=W}function mt(z){return z instanceof SVGElement&&(z=z.correspondingElement),z.className.baseVal===void 0?z.className:z.className.baseVal}function Le(z){for(;z&&z.firstChild;)z.removeChild(z.firstChild)}var St=ee(["transform","WebkitTransform"]);function Ye(z,W){z.style[St]=W}function dt(){if(typeof Event=="function")window.dispatchEvent(new Event("resize"));else{var z=window.document.createEvent("UIEvents");z.initUIEvent("resize",!0,!1,window,0),window.dispatchEvent(z)}}function Je(z){var W=["padding: "+(z.height/2-8)+"px "+z.width/2+"px;","line-height: "+z.height+"px;","background-image: url("+z.toDataURL()+");"];console.log(`%c
`,W.join(""))}var wt=o("lwsE"),At=o.n(wt),Ie=o("W8MJ"),Ne=o.n(Ie),Ve=o("7W2i"),ct=o.n(Ve),Me=o("a1gu"),ht=o.n(Me),Wt=o("Nsbk"),Qt=o.n(Wt),ur=o("oShl"),oe=o.n(ur);function $(z){var W=H();return function(){var xe=Qt()(z),ut;if(W){var Ot=Qt()(this).constructor;ut=Reflect.construct(xe,arguments,Ot)}else ut=xe.apply(this,arguments);return ht()(this,ut)}}function H(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(z){return!1}}var Ae=function(z){ct()(le,z);var W=$(le);function le(xe,ut,Ot){var Bt;return At()(this,le),Bt=W.call(this,xe),Bt.status=void 0,Bt.url=void 0,Bt.status=ut,Bt.url=Ot,Bt.name=Bt.constructor.name,Bt.message=xe,Bt}return Ne()(le,[{key:"toString",value:function(){return"".concat(this.name,": ").concat(this.message," (").concat(this.status,"): ").concat(this.url)}}]),le}(oe()(Error));function ye(z){var W=new XMLHttpRequest;W.open("GET",z.url,!0);for(var le in z.headers)z.headers.hasOwnProperty(le)&&W.setRequestHeader(le,z.headers[le]);return W.withCredentials=z.credentials==="include",W}var Te=function(W,le){var xe=ye(W);return xe.setRequestHeader("Accept","application/json"),xe.onerror=function(){le(new Error(xe.statusText))},xe.onload=function(){if(xe.status>=200&&xe.status<300&&xe.response){var ut;try{ut=JSON.parse(xe.response)}catch(Ot){return le(Ot)}le(null,ut)}else xe.status===401?le(new Ae("".concat(xe.statusText),xe.status,W.url)):le(new Ae(xe.statusText,xe.status,W.url))},xe.send(),xe},pe=function(W,le){var xe=ye(W);return xe.responseType="arraybuffer",xe.onerror=function(){le(new Error(xe.statusText))},xe.onload=function(){var ut=xe.response;if(ut.byteLength===0&&xe.status===200)return le(new Error("http status 200 returned without content."));xe.status>=200&&xe.status<300&&xe.response?le(null,{data:ut,cacheControl:xe.getResponseHeader("Cache-Control"),expires:xe.getResponseHeader("Expires")}):le(new Ae(xe.statusText,xe.status,W.url))},xe.send(),xe};function it(z){var W=window.document.createElement("a");return W.href=z,W.protocol===window.document.location.protocol&&W.host===window.document.location.host}var qt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=",Pt=function(W,le){return pe(W,function(xe,ut){if(xe)le(xe);else if(ut){var Ot=new window.Image;Ot.crossOrigin="anonymous";var Bt=window.URL||window.webkitURL;Ot.onload=function(){le(null,Ot),Bt.revokeObjectURL(Ot.src)};var Ze=new window.Blob([new Uint8Array(ut.data)],{type:"image/png"});Ot.src=ut.data.byteLength?Bt.createObjectURL(Ze):qt}})},me=o("J4zp"),ve=o.n(me),Ge=o("/rf6"),st=2*Math.PI*6378137/2;function Oe(z){var W=[Infinity,Infinity,-Infinity,-Infinity];return z.forEach(function(le){var xe=le.coordinates;gt(W,xe)}),W}function gt(z,W){return Array.isArray(W[0])?W.forEach(function(le){gt(z,le)}):(z[0]>W[0]&&(z[0]=W[0]),z[1]>W[1]&&(z[1]=W[1]),z[2]<W[0]&&(z[2]=W[0]),z[3]<W[1]&&(z[3]=W[1])),z}function C(z,W){return R(z,W)}function R(z,W){return Array.isArray(z[0])?z.map(function(le){return R(le,W)}):W(z)}function q(z){var W=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,le=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{enable:!0,decimal:1};z=_t(z,W);var xe=z[0],ut=z[1],Ot=xe*st/180,Bt=Math.log(Math.tan((90+ut)*Math.PI/360))/(Math.PI/180);return Bt=Bt*st/180,le.enable&&(Ot=Number(Ot.toFixed(le.decimal)),Bt=Number(Bt.toFixed(le.decimal))),z.length===3?[Ot,Bt,z[2]]:[Ot,Bt]}function fe(z){var W=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,le=z[0],xe=z[1],ut=le/st*180,Ot=xe/st*180;return Ot=180/Math.PI*(2*Math.atan(Math.exp(Ot*Math.PI/180))-Math.PI/2),W!=null&&(ut=Number(ut.toFixed(W)),Ot=Number(Ot.toFixed(W))),z.length===3?[ut,Ot,z[2]]:[ut,Ot]}function He(z){if(z==null)throw new Error("lng is required");return(z>180||z<-180)&&(z=z%360,z>180&&(z=-360+z),z<-180&&(z=360+z),z===0&&(z=0)),z}function et(z){if(z==null)throw new Error("lat is required");return(z>90||z<-90)&&(z=z%180,z>90&&(z=-180+z),z<-90&&(z=180+z),z===0&&(z=0)),z}function _t(z,W){if(W===!1)return z;var le=He(z[0]),xe=et(z[1]);return xe>85&&(xe=85),xe<-85&&(xe=-85),z.length===3?[le,xe,z[2]]:[le,xe]}function ot(z){var W=85.0511287798,le=Math.max(Math.min(W,z[1]),-W),xe=256<<20,ut=Math.PI/180,Ot=z[0]*ut,Bt=le*ut;Bt=Math.log(Math.tan(Math.PI/4+Bt/2));var Ze=.5/Math.PI,Rt=.5,lr=-.5/Math.PI;return ut=.5,Ot=xe*(Ze*Ot+Rt),Bt=xe*(lr*Bt+ut),[Math.floor(Ot),Math.floor(Bt)]}function Ut(z){var W=.5/Math.PI,le=.5,xe=-.5/Math.PI,ut=.5,Ot=256<<20,Bt=ve()(z,2),Ze=Bt[0],Rt=Bt[1];Ze=(Ze/Ot-le)/W,Rt=(Rt/Ot-ut)/xe,Rt=(Math.atan(Math.pow(Math.E,Rt))-Math.PI/4)*2,ut=Math.PI/180;var lr=Rt/ut,Ur=Ze/ut;return[Ur,lr]}function K(z,W,le){var xe=Object(Ge.degreesToRadians)(W[1]-z[1]),ut=Object(Ge.degreesToRadians)(W[0]-z[0]),Ot=Object(Ge.degreesToRadians)(z[1]),Bt=Object(Ge.degreesToRadians)(W[1]),Ze=Math.pow(Math.sin(xe/2),2)+Math.pow(Math.sin(ut/2),2)*Math.cos(Ot)*Math.cos(Bt);return Object(Ge.radiansToLength)(2*Math.atan2(Math.sqrt(Ze),Math.sqrt(1-Ze)),le="meters")}function qe(z){var W=Math.PI/180,le=85.0511287798,xe=6378137,ut=Math.max(Math.min(le,z[1]),-le),Ot=Math.sin(ut*W),Bt=xe*z[0]*W,Ze=xe*Math.log((1+Ot)/(1-Ot))/2;return[Bt,Ze]}function ae(z,W){var le=Math.abs(z[1][1]-z[0][1])*W,xe=Math.abs(z[1][0]-z[0][0])*W;return[[z[0][0]-xe,z[0][1]-le],[z[1][0]+xe,z[1][1]+le]]}function tt(z,W){return z[0][0]<=W[0][0]&&z[0][1]<=W[0][1]&&z[1][0]>=W[1][0]&&z[1][1]>=W[1][1]}function kt(z){return[[z[0],z[1]],[z[2],z[3]]]}var pr=function(){function z(){var W=arguments.length>0&&arguments[0]!==void 0?arguments[0]:50,le=arguments.length>1?arguments[1]:void 0;At()(this,z),this.limit=void 0,this.cache=void 0,this.destroy=void 0,this.order=void 0,this.limit=W,this.destroy=le||this.defaultDestroy,this.order=[],this.clear()}return Ne()(z,[{key:"clear",value:function(){var le=this;this.order.forEach(function(xe){le.delete(xe)}),this.cache={},this.order=[]}},{key:"get",value:function(le){var xe=this.cache[le];return xe&&(this.deleteOrder(le),this.appendOrder(le)),xe}},{key:"set",value:function(le,xe){this.cache[le]?(this.delete(le),this.cache[le]=xe,this.appendOrder(le)):(Object.keys(this.cache).length===this.limit&&this.delete(this.order[0]),this.cache[le]=xe,this.appendOrder(le))}},{key:"delete",value:function(le){var xe=this.cache[le];xe&&(this.deleteCache(le),this.deleteOrder(le),this.destroy(xe,le))}},{key:"deleteCache",value:function(le){delete this.cache[le]}},{key:"deleteOrder",value:function(le){var xe=this.order.findIndex(function(ut){return ut===le});xe>=0&&this.order.splice(xe,1)}},{key:"appendOrder",value:function(le){this.order.push(le)}},{key:"defaultDestroy",value:function(le,xe){return null}}]),z}();function Ke(z,W){z.forEach(function(le){if(!W[le])return;W[le]=W[le].bind(W)})}var xt=o("FmoU");function bt(z){var W=xt.a(z),le=[0,0,0,0];return W!=null&&(le[0]=W.r/255,le[1]=W.g/255,le[2]=W.b/255,le[3]=W.opacity),le}function Et(z){var W=z&&z[0],le=z&&z[1],xe=z&&z[2],ut=W+le*256+xe*65536-1;return ut}function Fe(z){return[z+1&255,z+1>>8&255,z+1>>8>>8&255]}function pt(z){var W=document.createElement("canvas"),le=W.getContext("2d");W.width=256,W.height=1;for(var xe=le.createLinearGradient(0,0,256,1),ut=null,Ot=z.positions[0],Bt=z.positions[z.positions.length-1],Ze=0;Ze<z.colors.length;++Ze){var Rt=(z.positions[Ze]-Ot)/(Bt-Ot);xe.addColorStop(Rt,z.colors[Ze])}return le.fillStyle=xe,le.fillRect(0,0,256,1),ut=new Uint8ClampedArray(le.getImageData(0,0,256,1).data),new ImageData(ut,256,1)}var yt;(function(z){z.CENTER="center",z.TOP="top",z["TOP-LEFT"]="top-left",z["TOP-RIGHT"]="top-right",z.BOTTOM="bottom",z["BOTTOM-LEFT"]="bottom-left",z.LEFT="left",z.RIGHT="right"})(yt||(yt={}));var Ht={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function hr(z,W,le){var xe=z.classList;for(var ut in Ht)Ht.hasOwnProperty(ut)&&xe.remove("l7-".concat(le,"-anchor-").concat(ut));xe.add("l7-".concat(le,"-anchor-").concat(W))}function Zr(z){if(z.length===0)throw new Error("max requires at least one data point");for(var W=z[0],le=1;le<z.length;le++)z[le]>W&&(W=z[le]);return W*1}function yr(z){if(z.length===0)throw new Error("min requires at least one data point");for(var W=z[0],le=1;le<z.length;le++)z[le]<W&&(W=z[le]);return W*1}function Vn(z){if(z.length===0)return 0;for(var W=z[0]*1,le=1;le<z.length;le++)W+=z[le]*1;return W}function zn(z){if(z.length===0)throw new Error("mean requires at least one data point");return Vn(z)/z.length}function oa(z){if(z.length===0)throw new Error("mean requires at least one data point");if(z.length<3)return z[0];z.sort();for(var W=z[0],le=NaN,xe=0,ut=1,Ot=1;Ot<z.length+1;Ot++)z[Ot]!==W?(ut>xe&&(xe=ut,le=W),ut=1,W=z[Ot]):ut++;return le*1}var $n={min:yr,max:Zr,mean:zn,sum:Vn,mode:oa};function Kn(z,W){return z.map(function(le){return le[W]})}function Cn(z,W){return $n[z](W)}},HpQ9:function(Ue,g,o){"use strict";Object.defineProperty(g,"__esModule",{value:!0}),g.ContainerSnapshot=void 0;var E=function(){function p(){}return p.of=function(X,F){var i=new p;return i.bindings=X,i.middleware=F,i},p}();g.ContainerSnapshot=E},HthE:function(Ue,g,o){"use strict";o.d(g,"a",function(){return E}),o.d(g,"b",function(){return p});var E;(function(X){X[X.LNGLAT=1]="LNGLAT",X[X.LNGLAT_OFFSET=2]="LNGLAT_OFFSET",X[X.VECTOR_TILE=3]="VECTOR_TILE",X[X.IDENTITY=4]="IDENTITY",X[X.P20=5]="P20",X[X.P20_OFFSET=6]="P20_OFFSET",X[X.METER_OFFSET=7]="METER_OFFSET"})(E||(E={}));var p={CoordinateSystem:"u_CoordinateSystem",ViewportCenter:"u_ViewportCenter",ViewportCenterProjection:"u_ViewportCenterProjection",PixelsPerDegree:"u_PixelsPerDegree",PixelsPerDegree2:"u_PixelsPerDegree2",PixelsPerMeter:"u_PixelsPerMeter"}},I0ug:function(Ue,g,o){"use strict";(function(E){o.d(g,"a",function(){return X});var p=o("U8pU");function X(F){if(typeof window!="undefined"&&Object(p.a)(window.process)==="object"&&window.process.type==="renderer")return!0;if(typeof E!="undefined"&&Object(p.a)(E.versions)==="object"&&Boolean(E.versions.electron))return!0;var i=(typeof navigator=="undefined"?"undefined":Object(p.a)(navigator))==="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,Z=F||i;return!!(Z&&Z.indexOf("Electron")>=0)}}).call(this,o("Q2Ig"))},IOcx:function(Ue,g,o){"use strict";o.d(g,"a",function(){return E}),o.d(g,"b",function(){return ht}),o.d(g,"c",function(){return Wt}),o.d(g,"d",function(){return Qt}),o.d(g,"e",function(){return ur});var E={};o.r(E),o.d(E,"create",function(){return X}),o.d(E,"clone",function(){return F}),o.d(E,"copy",function(){return i}),o.d(E,"identity",function(){return Z}),o.d(E,"fromValues",function(){return D}),o.d(E,"set",function(){return J}),o.d(E,"transpose",function(){return ee}),o.d(E,"invert",function(){return ce}),o.d(E,"adjoint",function(){return Y}),o.d(E,"determinant",function(){return ze}),o.d(E,"multiply",function(){return Xe}),o.d(E,"rotate",function(){return be}),o.d(E,"scale",function(){return Se}),o.d(E,"fromRotation",function(){return mt}),o.d(E,"fromScaling",function(){return Le}),o.d(E,"str",function(){return St}),o.d(E,"frob",function(){return Ye}),o.d(E,"LDU",function(){return dt}),o.d(E,"add",function(){return Je}),o.d(E,"subtract",function(){return wt}),o.d(E,"exactEquals",function(){return At}),o.d(E,"equals",function(){return Ie}),o.d(E,"multiplyScalar",function(){return Ne}),o.d(E,"multiplyScalarAndAdd",function(){return Ve}),o.d(E,"mul",function(){return ct}),o.d(E,"sub",function(){return Me});var p=o("yU0y");function X(){var oe=new p.a(4);return p.a!=Float32Array&&(oe[1]=0,oe[2]=0),oe[0]=1,oe[3]=1,oe}function F(oe){var $=new p.a(4);return $[0]=oe[0],$[1]=oe[1],$[2]=oe[2],$[3]=oe[3],$}function i(oe,$){return oe[0]=$[0],oe[1]=$[1],oe[2]=$[2],oe[3]=$[3],oe}function Z(oe){return oe[0]=1,oe[1]=0,oe[2]=0,oe[3]=1,oe}function D(oe,$,H,Ae){var ye=new p.a(4);return ye[0]=oe,ye[1]=$,ye[2]=H,ye[3]=Ae,ye}function J(oe,$,H,Ae,ye){return oe[0]=$,oe[1]=H,oe[2]=Ae,oe[3]=ye,oe}function ee(oe,$){if(oe===$){var H=$[1];oe[1]=$[2],oe[2]=H}else oe[0]=$[0],oe[1]=$[2],oe[2]=$[1],oe[3]=$[3];return oe}function ce(oe,$){var H=$[0],Ae=$[1],ye=$[2],Te=$[3],pe=H*Te-ye*Ae;return pe?(pe=1/pe,oe[0]=Te*pe,oe[1]=-Ae*pe,oe[2]=-ye*pe,oe[3]=H*pe,oe):null}function Y(oe,$){var H=$[0];return oe[0]=$[3],oe[1]=-$[1],oe[2]=-$[2],oe[3]=H,oe}function ze(oe){return oe[0]*oe[3]-oe[2]*oe[1]}function Xe(oe,$,H){var Ae=$[0],ye=$[1],Te=$[2],pe=$[3],it=H[0],qt=H[1],Pt=H[2],me=H[3];return oe[0]=Ae*it+Te*qt,oe[1]=ye*it+pe*qt,oe[2]=Ae*Pt+Te*me,oe[3]=ye*Pt+pe*me,oe}function be(oe,$,H){var Ae=$[0],ye=$[1],Te=$[2],pe=$[3],it=Math.sin(H),qt=Math.cos(H);return oe[0]=Ae*qt+Te*it,oe[1]=ye*qt+pe*it,oe[2]=Ae*-it+Te*qt,oe[3]=ye*-it+pe*qt,oe}function Se(oe,$,H){var Ae=$[0],ye=$[1],Te=$[2],pe=$[3],it=H[0],qt=H[1];return oe[0]=Ae*it,oe[1]=ye*it,oe[2]=Te*qt,oe[3]=pe*qt,oe}function mt(oe,$){var H=Math.sin($),Ae=Math.cos($);return oe[0]=Ae,oe[1]=H,oe[2]=-H,oe[3]=Ae,oe}function Le(oe,$){return oe[0]=$[0],oe[1]=0,oe[2]=0,oe[3]=$[1],oe}function St(oe){return"mat2("+oe[0]+", "+oe[1]+", "+oe[2]+", "+oe[3]+")"}function Ye(oe){return Math.hypot(oe[0],oe[1],oe[2],oe[3])}function dt(oe,$,H,Ae){return oe[2]=Ae[2]/Ae[0],H[0]=Ae[0],H[1]=Ae[1],H[3]=Ae[3]-oe[2]*H[1],[oe,$,H]}function Je(oe,$,H){return oe[0]=$[0]+H[0],oe[1]=$[1]+H[1],oe[2]=$[2]+H[2],oe[3]=$[3]+H[3],oe}function wt(oe,$,H){return oe[0]=$[0]-H[0],oe[1]=$[1]-H[1],oe[2]=$[2]-H[2],oe[3]=$[3]-H[3],oe}function At(oe,$){return oe[0]===$[0]&&oe[1]===$[1]&&oe[2]===$[2]&&oe[3]===$[3]}function Ie(oe,$){var H=oe[0],Ae=oe[1],ye=oe[2],Te=oe[3],pe=$[0],it=$[1],qt=$[2],Pt=$[3];return Math.abs(H-pe)<=p.b*Math.max(1,Math.abs(H),Math.abs(pe))&&Math.abs(Ae-it)<=p.b*Math.max(1,Math.abs(Ae),Math.abs(it))&&Math.abs(ye-qt)<=p.b*Math.max(1,Math.abs(ye),Math.abs(qt))&&Math.abs(Te-Pt)<=p.b*Math.max(1,Math.abs(Te),Math.abs(Pt))}function Ne(oe,$,H){return oe[0]=$[0]*H,oe[1]=$[1]*H,oe[2]=$[2]*H,oe[3]=$[3]*H,oe}function Ve(oe,$,H,Ae){return oe[0]=$[0]+H[0]*Ae,oe[1]=$[1]+H[1]*Ae,oe[2]=$[2]+H[2]*Ae,oe[3]=$[3]+H[3]*Ae,oe}var ct=Xe,Me=wt,ht=o("ZaHm"),Wt=o("ZxFD"),Qt=o("n+fv"),ur=o("bl9R")},ISu3:function(Ue,g,o){"use strict";o.d(g,"a",function(){return X}),o.d(g,"c",function(){return F}),o.d(g,"b",function(){return i}),o.d(g,"d",function(){return Z});var E={},p={},X=function(J){return p[J]},F=function(J,ee){p[J]=ee},i=function(J){return E[J]},Z=function(J,ee){E[J]=ee}},Ioao:function(Ue,g,o){var E=o("heNW"),p=Math.max;function X(F,i,Z){return i=p(i===void 0?F.length-1:i,0),function(){for(var D=arguments,J=-1,ee=p(D.length-i,0),ce=Array(ee);++J<ee;)ce[J]=D[i+J];J=-1;for(var Y=Array(i+1);++J<i;)Y[J]=D[J];return Y[i]=Z(ce),E(F,this,Y)}}Ue.exports=X},J2iB:function(Ue,g){function o(E){return E==null}Ue.exports=o},J7lC:function(Ue,g){},K9nA:function(Ue,g,o){"use strict";(function(E,p){o.d(g,"b",function(){return Z}),o.d(g,"a",function(){return ee});var X=o("U8pU"),F={self:typeof self!="undefined"&&self,window:typeof window!="undefined"&&window,global:typeof E!="undefined"&&E,document:typeof document!="undefined"&&document,process:(typeof p=="undefined"?"undefined":Object(X.a)(p))==="object"&&p},i=F.self||F.window||F.global,Z=F.window||F.self||F.global,D=F.global||F.self||F.window,J=F.document||{},ee=F.process||{},ce=console}).call(this,o("yLpj"),o("Q2Ig"))},KKCa:function(Ue,g){typeof Object.create=="function"?Ue.exports=function(E,p){E.super_=p,E.prototype=Object.create(p.prototype,{constructor:{value:E,enumerable:!1,writable:!0,configurable:!0}})}:Ue.exports=function(E,p){E.super_=p;var X=function(){};X.prototype=p.prototype,E.prototype=new X,E.prototype.constructor=E}},KwMD:function(Ue,g){function o(E,p,X,F){for(var i=E.length,Z=X+(F?1:-1);F?Z--:++Z<i;)if(p(E[Z],Z,E))return Z;return-1}Ue.exports=o},KxBF:function(Ue,g){function o(E,p,X){var F=-1,i=E.length;p<0&&(p=-p>i?0:i+p),X=X>i?i:X,X<0&&(X+=i),i=p>X?0:X-p>>>0,p>>>=0;for(var Z=Array(i);++F<i;)Z[F]=E[F+p];return Z}Ue.exports=o},L56e:function(Ue,g,o){"use strict";o.d(g,"a",function(){return E});var E=["mapload"]},LGYb:function(Ue,g,o){var E=o("1hJj"),p=o("jbM+"),X=o("Xt/L"),F=o("xYSL"),i=o("dQpi"),Z=o("rEGp"),D=200;function J(ee,ce,Y){var ze=-1,Xe=p,be=ee.length,Se=!0,mt=[],Le=mt;if(Y)Se=!1,Xe=X;else if(be>=D){var St=ce?null:i(ee);if(St)return Z(St);Se=!1,Xe=F,Le=new E}else Le=ce?[]:mt;e:for(;++ze<be;){var Ye=ee[ze],dt=ce?ce(Ye):Ye;if(Ye=Y||Ye!==0?Ye:0,Se&&dt===dt){for(var Je=Le.length;Je--;)if(Le[Je]===dt)continue e;ce&&Le.push(dt),mt.push(Ye)}else Xe(Le,dt,Y)||(Le!==mt&&Le.push(dt),mt.push(Ye))}return mt}Ue.exports=J},LKzl:function(Ue,g,o){"use strict";Object.defineProperty(g,"__esModule",{value:!0}),g.BindingWhenOnSyntax=void 0;var E=o("406g"),p=o("z4Hk"),X=function(){function F(i){this._binding=i,this._bindingWhenSyntax=new p.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new E.BindingOnSyntax(this._binding)}return F.prototype.when=function(i){return this._bindingWhenSyntax.when(i)},F.prototype.whenTargetNamed=function(i){return this._bindingWhenSyntax.whenTargetNamed(i)},F.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},F.prototype.whenTargetTagged=function(i,Z){return this._bindingWhenSyntax.whenTargetTagged(i,Z)},F.prototype.whenInjectedInto=function(i){return this._bindingWhenSyntax.whenInjectedInto(i)},F.prototype.whenParentNamed=function(i){return this._bindingWhenSyntax.whenParentNamed(i)},F.prototype.whenParentTagged=function(i,Z){return this._bindingWhenSyntax.whenParentTagged(i,Z)},F.prototype.whenAnyAncestorIs=function(i){return this._bindingWhenSyntax.whenAnyAncestorIs(i)},F.prototype.whenNoAncestorIs=function(i){return this._bindingWhenSyntax.whenNoAncestorIs(i)},F.prototype.whenAnyAncestorNamed=function(i){return this._bindingWhenSyntax.whenAnyAncestorNamed(i)},F.prototype.whenAnyAncestorTagged=function(i,Z){return this._bindingWhenSyntax.whenAnyAncestorTagged(i,Z)},F.prototype.whenNoAncestorNamed=function(i){return this._bindingWhenSyntax.whenNoAncestorNamed(i)},F.prototype.whenNoAncestorTagged=function(i,Z){return this._bindingWhenSyntax.whenNoAncestorTagged(i,Z)},F.prototype.whenAnyAncestorMatches=function(i){return this._bindingWhenSyntax.whenAnyAncestorMatches(i)},F.prototype.whenNoAncestorMatches=function(i){return this._bindingWhenSyntax.whenNoAncestorMatches(i)},F.prototype.onActivation=function(i){return this._bindingOnSyntax.onActivation(i)},F}();g.BindingWhenOnSyntax=X},LcsW:function(Ue,g,o){var E=o("kekF"),p=E(Object.getPrototypeOf,Object);Ue.exports=p},LgvC:function(Ue,g,o){"use strict";Object.defineProperty(g,"__esModule",{value:!0}),g.Binding=void 0;var E=o("FV85"),p=o("d9O0"),X=function(){function F(i,Z){this.id=p.id(),this.activated=!1,this.serviceIdentifier=i,this.scope=Z,this.type=E.BindingTypeEnum.Invalid,this.constraint=function(D){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.dynamicValue=null}return F.prototype.clone=function(){var i=new F(this.serviceIdentifier,this.scope);return i.activated=!1,i.implementationType=this.implementationType,i.dynamicValue=this.dynamicValue,i.scope=this.scope,i.type=this.type,i.factory=this.factory,i.provider=this.provider,i.constraint=this.constraint,i.onActivation=this.onActivation,i.cache=this.cache,i},F}();g.Binding=X},LsHQ:function(Ue,g,o){var E=o("EA7m"),p=o("mv/X");function X(F){return E(function(i,Z){var D=-1,J=Z.length,ee=J>1?Z[J-1]:void 0,ce=J>2?Z[2]:void 0;for(ee=F.length>3&&typeof ee=="function"?(J--,ee):void 0,ce&&p(Z[0],Z[1],ce)&&(ee=J<3?void 0:ee,J=1),i=Object(i);++D<J;){var Y=Z[D];Y&&F(i,Y,D,ee)}return i})}Ue.exports=X},LvWW:function(Ue,g,o){var E=o("mhV4");Ue.exports=p;function p(J,ee){switch(J&&J.type||null){case"FeatureCollection":return J.features=J.features.map(X(p,ee)),J;case"GeometryCollection":return J.geometries=J.geometries.map(X(p,ee)),J;case"Feature":return J.geometry=p(J.geometry,ee),J;case"Polygon":case"MultiPolygon":return F(J,ee);default:return J}}function X(J,ee){return function(ce){return J(ce,ee)}}function F(J,ee){return J.type==="Polygon"?J.coordinates=i(J.coordinates,ee):J.type==="MultiPolygon"&&(J.coordinates=J.coordinates.map(X(i,ee))),J}function i(J,ee){ee=!!ee,J[0]=Z(J[0],ee);for(var ce=1;ce<J.length;ce++)J[ce]=Z(J[ce],!ee);return J}function Z(J,ee){return D(J)===ee?J:J.reverse()}function D(J){return E.ring(J)>=0}},MCLT:function(Ue,g,o){(function(E){var p=Object.getOwnPropertyDescriptors||function(pe){for(var it=Object.keys(pe),qt={},Pt=0;Pt<it.length;Pt++)qt[it[Pt]]=Object.getOwnPropertyDescriptor(pe,it[Pt]);return qt},X=/%[sdj%]/g;g.format=function(Te){if(!Je(Te)){for(var pe=[],it=0;it<arguments.length;it++)pe.push(Z(arguments[it]));return pe.join(" ")}for(var it=1,qt=arguments,Pt=qt.length,me=String(Te).replace(X,function(Ge){if(Ge==="%%")return"%";if(it>=Pt)return Ge;switch(Ge){case"%s":return String(qt[it++]);case"%d":return Number(qt[it++]);case"%j":try{return JSON.stringify(qt[it++])}catch(st){return"[Circular]"}default:return Ge}}),ve=qt[it];it<Pt;ve=qt[++it])St(ve)||!Ne(ve)?me+=" "+ve:me+=" "+Z(ve);return me},g.deprecate=function(Te,pe){if(typeof E!="undefined"&&E.noDeprecation===!0)return Te;if(typeof E=="undefined")return function(){return g.deprecate(Te,pe).apply(this,arguments)};var it=!1;function qt(){if(!it){if(E.throwDeprecation)throw new Error(pe);E.traceDeprecation?console.trace(pe):console.error(pe),it=!0}return Te.apply(this,arguments)}return qt};var F={},i;g.debuglog=function(Te){if(At(i)&&(i=Object({NODE_ENV:"production"}).NODE_DEBUG||""),Te=Te.toUpperCase(),!F[Te])if(new RegExp("\\b"+Te+"\\b","i").test(i)){var pe=E.pid;F[Te]=function(){var it=g.format.apply(g,arguments);console.error("%s %d: %s",Te,pe,it)}}else F[Te]=function(){};return F[Te]};function Z(Te,pe){var it={seen:[],stylize:J};return arguments.length>=3&&(it.depth=arguments[2]),arguments.length>=4&&(it.colors=arguments[3]),Le(pe)?it.showHidden=pe:pe&&g._extend(it,pe),At(it.showHidden)&&(it.showHidden=!1),At(it.depth)&&(it.depth=2),At(it.colors)&&(it.colors=!1),At(it.customInspect)&&(it.customInspect=!0),it.colors&&(it.stylize=D),ce(it,Te,it.depth)}g.inspect=Z,Z.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},Z.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function D(Te,pe){var it=Z.styles[pe];return it?"["+Z.colors[it][0]+"m"+Te+"["+Z.colors[it][1]+"m":Te}function J(Te,pe){return Te}function ee(Te){var pe={};return Te.forEach(function(it,qt){pe[it]=!0}),pe}function ce(Te,pe,it){if(Te.customInspect&&pe&&Me(pe.inspect)&&pe.inspect!==g.inspect&&!(pe.constructor&&pe.constructor.prototype===pe)){var qt=pe.inspect(it,Te);return Je(qt)||(qt=ce(Te,qt,it)),qt}var Pt=Y(Te,pe);if(Pt)return Pt;var me=Object.keys(pe),ve=ee(me);if(Te.showHidden&&(me=Object.getOwnPropertyNames(pe)),ct(pe)&&(me.indexOf("message")>=0||me.indexOf("description")>=0))return ze(pe);if(me.length===0){if(Me(pe)){var Ge=pe.name?": "+pe.name:"";return Te.stylize("[Function"+Ge+"]","special")}if(Ie(pe))return Te.stylize(RegExp.prototype.toString.call(pe),"regexp");if(Ve(pe))return Te.stylize(Date.prototype.toString.call(pe),"date");if(ct(pe))return ze(pe)}var st="",Oe=!1,gt=["{","}"];if(mt(pe)&&(Oe=!0,gt=["[","]"]),Me(pe)){var C=pe.name?": "+pe.name:"";st=" [Function"+C+"]"}if(Ie(pe)&&(st=" "+RegExp.prototype.toString.call(pe)),Ve(pe)&&(st=" "+Date.prototype.toUTCString.call(pe)),ct(pe)&&(st=" "+ze(pe)),me.length===0&&(!Oe||pe.length==0))return gt[0]+st+gt[1];if(it<0)return Ie(pe)?Te.stylize(RegExp.prototype.toString.call(pe),"regexp"):Te.stylize("[Object]","special");Te.seen.push(pe);var R;return Oe?R=Xe(Te,pe,it,ve,me):R=me.map(function(q){return be(Te,pe,it,ve,q,Oe)}),Te.seen.pop(),Se(R,st,gt)}function Y(Te,pe){if(At(pe))return Te.stylize("undefined","undefined");if(Je(pe)){var it="'"+JSON.stringify(pe).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return Te.stylize(it,"string")}if(dt(pe))return Te.stylize(""+pe,"number");if(Le(pe))return Te.stylize(""+pe,"boolean");if(St(pe))return Te.stylize("null","null")}function ze(Te){return"["+Error.prototype.toString.call(Te)+"]"}function Xe(Te,pe,it,qt,Pt){for(var me=[],ve=0,Ge=pe.length;ve<Ge;++ve)$(pe,String(ve))?me.push(be(Te,pe,it,qt,String(ve),!0)):me.push("");return Pt.forEach(function(st){st.match(/^\d+$/)||me.push(be(Te,pe,it,qt,st,!0))}),me}function be(Te,pe,it,qt,Pt,me){var ve,Ge,st;if(st=Object.getOwnPropertyDescriptor(pe,Pt)||{value:pe[Pt]},st.get?st.set?Ge=Te.stylize("[Getter/Setter]","special"):Ge=Te.stylize("[Getter]","special"):st.set&&(Ge=Te.stylize("[Setter]","special")),$(qt,Pt)||(ve="["+Pt+"]"),Ge||(Te.seen.indexOf(st.value)<0?(St(it)?Ge=ce(Te,st.value,null):Ge=ce(Te,st.value,it-1),Ge.indexOf(`
`)>-1&&(me?Ge=Ge.split(`
`).map(function(Oe){return"  "+Oe}).join(`
`).substr(2):Ge=`
`+Ge.split(`
`).map(function(Oe){return"   "+Oe}).join(`
`))):Ge=Te.stylize("[Circular]","special")),At(ve)){if(me&&Pt.match(/^\d+$/))return Ge;ve=JSON.stringify(""+Pt),ve.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(ve=ve.substr(1,ve.length-2),ve=Te.stylize(ve,"name")):(ve=ve.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),ve=Te.stylize(ve,"string"))}return ve+": "+Ge}function Se(Te,pe,it){var qt=0,Pt=Te.reduce(function(me,ve){return qt++,ve.indexOf(`
`)>=0&&qt++,me+ve.replace(/\u001b\[\d\d?m/g,"").length+1},0);return Pt>60?it[0]+(pe===""?"":pe+`
 `)+" "+Te.join(`,
  `)+" "+it[1]:it[0]+pe+" "+Te.join(", ")+" "+it[1]}function mt(Te){return Array.isArray(Te)}g.isArray=mt;function Le(Te){return typeof Te=="boolean"}g.isBoolean=Le;function St(Te){return Te===null}g.isNull=St;function Ye(Te){return Te==null}g.isNullOrUndefined=Ye;function dt(Te){return typeof Te=="number"}g.isNumber=dt;function Je(Te){return typeof Te=="string"}g.isString=Je;function wt(Te){return typeof Te=="symbol"}g.isSymbol=wt;function At(Te){return Te===void 0}g.isUndefined=At;function Ie(Te){return Ne(Te)&&Wt(Te)==="[object RegExp]"}g.isRegExp=Ie;function Ne(Te){return typeof Te=="object"&&Te!==null}g.isObject=Ne;function Ve(Te){return Ne(Te)&&Wt(Te)==="[object Date]"}g.isDate=Ve;function ct(Te){return Ne(Te)&&(Wt(Te)==="[object Error]"||Te instanceof Error)}g.isError=ct;function Me(Te){return typeof Te=="function"}g.isFunction=Me;function ht(Te){return Te===null||typeof Te=="boolean"||typeof Te=="number"||typeof Te=="string"||typeof Te=="symbol"||typeof Te=="undefined"}g.isPrimitive=ht,g.isBuffer=o("1gqn");function Wt(Te){return Object.prototype.toString.call(Te)}function Qt(Te){return Te<10?"0"+Te.toString(10):Te.toString(10)}var ur=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function oe(){var Te=new Date,pe=[Qt(Te.getHours()),Qt(Te.getMinutes()),Qt(Te.getSeconds())].join(":");return[Te.getDate(),ur[Te.getMonth()],pe].join(" ")}g.log=function(){console.log("%s - %s",oe(),g.format.apply(g,arguments))},g.inherits=o("KKCa"),g._extend=function(Te,pe){if(!pe||!Ne(pe))return Te;for(var it=Object.keys(pe),qt=it.length;qt--;)Te[it[qt]]=pe[it[qt]];return Te};function $(Te,pe){return Object.prototype.hasOwnProperty.call(Te,pe)}var H=typeof Symbol!="undefined"?Symbol("util.promisify.custom"):void 0;g.promisify=function(pe){if(typeof pe!="function")throw new TypeError('The "original" argument must be of type Function');if(H&&pe[H]){var it=pe[H];if(typeof it!="function")throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(it,H,{value:it,enumerable:!1,writable:!1,configurable:!0}),it}function it(){for(var qt,Pt,me=new Promise(function(st,Oe){qt=st,Pt=Oe}),ve=[],Ge=0;Ge<arguments.length;Ge++)ve.push(arguments[Ge]);ve.push(function(st,Oe){st?Pt(st):qt(Oe)});try{pe.apply(this,ve)}catch(st){Pt(st)}return me}return Object.setPrototypeOf(it,Object.getPrototypeOf(pe)),H&&Object.defineProperty(it,H,{value:it,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(it,p(pe))},g.promisify.custom=H;function Ae(Te,pe){if(!Te){var it=new Error("Promise was rejected with a falsy value");it.reason=Te,Te=it}return pe(Te)}function ye(Te){if(typeof Te!="function")throw new TypeError('The "original" argument must be of type Function');function pe(){for(var it=[],qt=0;qt<arguments.length;qt++)it.push(arguments[qt]);var Pt=it.pop();if(typeof Pt!="function")throw new TypeError("The last argument must be of type Function");var me=this,ve=function(){return Pt.apply(me,arguments)};Te.apply(this,it).then(function(Ge){E.nextTick(ve,null,Ge)},function(Ge){E.nextTick(Ae,Ge,ve)})}return Object.setPrototypeOf(pe,Object.getPrototypeOf(Te)),Object.defineProperties(pe,p(Te)),pe}g.callbackify=ye}).call(this,o("Q2Ig"))},MON2:function(Ue,g,o){"use strict";Object.defineProperty(g,"__esModule",{value:!0}),g.STACK_OVERFLOW=g.CIRCULAR_DEPENDENCY_IN_FACTORY=g.POST_CONSTRUCT_ERROR=g.MULTIPLE_POST_CONSTRUCT_METHODS=g.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK=g.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE=g.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE=g.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT=g.ARGUMENTS_LENGTH_MISMATCH=g.INVALID_DECORATOR_OPERATION=g.INVALID_TO_SELF_VALUE=g.INVALID_FUNCTION_BINDING=g.INVALID_MIDDLEWARE_RETURN=g.NO_MORE_SNAPSHOTS_AVAILABLE=g.INVALID_BINDING_TYPE=g.NOT_IMPLEMENTED=g.CIRCULAR_DEPENDENCY=g.UNDEFINED_INJECT_ANNOTATION=g.MISSING_INJECT_ANNOTATION=g.MISSING_INJECTABLE_ANNOTATION=g.NOT_REGISTERED=g.CANNOT_UNBIND=g.AMBIGUOUS_MATCH=g.KEY_NOT_FOUND=g.NULL_ARGUMENT=g.DUPLICATED_METADATA=g.DUPLICATED_INJECTABLE_DECORATOR=void 0,g.DUPLICATED_INJECTABLE_DECORATOR="Cannot apply @injectable decorator multiple times.",g.DUPLICATED_METADATA="Metadata key was used more than once in a parameter:",g.NULL_ARGUMENT="NULL argument",g.KEY_NOT_FOUND="Key Not Found",g.AMBIGUOUS_MATCH="Ambiguous match found for serviceIdentifier:",g.CANNOT_UNBIND="Could not unbind serviceIdentifier:",g.NOT_REGISTERED="No matching bindings found for serviceIdentifier:",g.MISSING_INJECTABLE_ANNOTATION="Missing required @injectable annotation in:",g.MISSING_INJECT_ANNOTATION="Missing required @inject or @multiInject annotation in:",g.UNDEFINED_INJECT_ANNOTATION=function(E){return"@inject called with undefined this could mean that the class "+E+" has a circular dependency problem. You can use a LazyServiceIdentifer to  overcome this limitation."},g.CIRCULAR_DEPENDENCY="Circular dependency found:",g.NOT_IMPLEMENTED="Sorry, this feature is not fully implemented yet.",g.INVALID_BINDING_TYPE="Invalid binding type:",g.NO_MORE_SNAPSHOTS_AVAILABLE="No snapshot available to restore.",g.INVALID_MIDDLEWARE_RETURN="Invalid return type in middleware. Middleware must return!",g.INVALID_FUNCTION_BINDING="Value provided to function binding must be a function!",g.INVALID_TO_SELF_VALUE="The toSelf function can only be applied when a constructor is used as service identifier",g.INVALID_DECORATOR_OPERATION="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.",g.ARGUMENTS_LENGTH_MISMATCH=function(){for(var E=[],p=0;p<arguments.length;p++)E[p]=arguments[p];return"The number of constructor arguments in the derived class "+(E[0]+" must be >= than the number of constructor arguments of its base class.")},g.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT="Invalid Container constructor argument. Container options must be an object.",g.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE="Invalid Container option. Default scope must be a string ('singleton' or 'transient').",g.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE="Invalid Container option. Auto bind injectable must be a boolean",g.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK="Invalid Container option. Skip base check must be a boolean",g.MULTIPLE_POST_CONSTRUCT_METHODS="Cannot apply @postConstruct decorator multiple times in the same class",g.POST_CONSTRUCT_ERROR=function(){for(var E=[],p=0;p<arguments.length;p++)E[p]=arguments[p];return"@postConstruct error in class "+E[0]+": "+E[1]},g.CIRCULAR_DEPENDENCY_IN_FACTORY=function(){for(var E=[],p=0;p<arguments.length;p++)E[p]=arguments[p];return"It looks like there is a circular dependency "+("in one of the '"+E[0]+"' bindings. Please investigate bindings with")+("service identifier '"+E[1]+"'.")},g.STACK_OVERFLOW="Maximum call stack size exceeded"},MrPd:function(Ue,g,o){var E=o("hypo"),p=o("ljhN"),X=Object.prototype,F=X.hasOwnProperty;function i(Z,D,J){var ee=Z[D];(!(F.call(Z,D)&&p(ee,J))||J===void 0&&!(D in Z))&&E(Z,D,J)}Ue.exports=i},O0oS:function(Ue,g,o){var E=o("Cwc5"),p=function(){try{var X=E(Object,"defineProperty");return X({},"",{}),X}catch(F){}}();Ue.exports=p},O1je:function(Ue,g){},OBhP:function(Ue,g,o){var E=o("fmRc"),p=o("gFfm"),X=o("MrPd"),F=o("WwFo"),i=o("Dw+G"),Z=o("5Tg0"),D=o("Q1l4"),J=o("VOtZ"),ee=o("EEGq"),ce=o("qZTm"),Y=o("G6z8"),ze=o("QqLw"),Xe=o("yHx3"),be=o("wrZu"),Se=o("+iFO"),mt=o("Z0cm"),Le=o("DSRE"),St=o("zEVN"),Ye=o("GoyQ"),dt=o("1+5i"),Je=o("7GkX"),wt=o("mTTR"),At=1,Ie=2,Ne=4,Ve="[object Arguments]",ct="[object Array]",Me="[object Boolean]",ht="[object Date]",Wt="[object Error]",Qt="[object Function]",ur="[object GeneratorFunction]",oe="[object Map]",$="[object Number]",H="[object Object]",Ae="[object RegExp]",ye="[object Set]",Te="[object String]",pe="[object Symbol]",it="[object WeakMap]",qt="[object ArrayBuffer]",Pt="[object DataView]",me="[object Float32Array]",ve="[object Float64Array]",Ge="[object Int8Array]",st="[object Int16Array]",Oe="[object Int32Array]",gt="[object Uint8Array]",C="[object Uint8ClampedArray]",R="[object Uint16Array]",q="[object Uint32Array]",fe={};fe[Ve]=fe[ct]=fe[qt]=fe[Pt]=fe[Me]=fe[ht]=fe[me]=fe[ve]=fe[Ge]=fe[st]=fe[Oe]=fe[oe]=fe[$]=fe[H]=fe[Ae]=fe[ye]=fe[Te]=fe[pe]=fe[gt]=fe[C]=fe[R]=fe[q]=!0,fe[Wt]=fe[Qt]=fe[it]=!1;function He(et,_t,ot,Ut,K,qe){var ae,tt=_t&At,kt=_t&Ie,pr=_t&Ne;if(ot&&(ae=K?ot(et,Ut,K,qe):ot(et)),ae!==void 0)return ae;if(!Ye(et))return et;var Ke=mt(et);if(Ke){if(ae=Xe(et),!tt)return D(et,ae)}else{var xt=ze(et),bt=xt==Qt||xt==ur;if(Le(et))return Z(et,tt);if(xt==H||xt==Ve||bt&&!K){if(ae=kt||bt?{}:Se(et),!tt)return kt?ee(et,i(ae,et)):J(et,F(ae,et))}else{if(!fe[xt])return K?et:{};ae=be(et,xt,tt)}}qe||(qe=new E);var Et=qe.get(et);if(Et)return Et;qe.set(et,ae),dt(et)?et.forEach(function(yt){ae.add(He(yt,_t,ot,yt,et,qe))}):St(et)&&et.forEach(function(yt,Ht){ae.set(Ht,He(yt,_t,ot,Ht,et,qe))});var Fe=pr?kt?Y:ce:kt?wt:Je,pt=Ke?void 0:Fe(et);return p(pt||et,function(yt,Ht){pt&&(Ht=yt,yt=et[Ht]),X(ae,Ht,He(yt,_t,ot,Ht,et,qe))}),ae}Ue.exports=He},PSsN:function(Ue,g){},PUg6:function(Ue,g,o){"use strict";o.d(g,"a",function(){return E});var E;(function(p){p.normal="normal",p.additive="additive",p.subtractive="subtractive",p.min="min",p.max="max",p.none="none"})(E||(E={}))},Q1l4:function(Ue,g){function o(E,p){var X=-1,F=E.length;for(p||(p=Array(F));++X<F;)p[X]=E[X];return p}Ue.exports=o},QGbF:function(Ue,g){},"QQZ/":function(Ue,g,o){var E=o("Sq3C"),p=o("Z1HP"),X=o("Sxd8"),F=o("dt0z");function i(Z,D,J){Z=F(Z),D=X(D);var ee=D?p(Z):0;return D&&ee<D?E(D-ee,J)+Z:Z}Ue.exports=i},QcOe:function(Ue,g,o){var E=o("GoyQ"),p=o("6sVZ"),X=o("7Ix3"),F=Object.prototype,i=F.hasOwnProperty;function Z(D){if(!E(D))return X(D);var J=p(D),ee=[];for(var ce in D)ce=="constructor"&&(J||!i.call(D,ce))||ee.push(ce);return ee}Ue.exports=Z},QkVN:function(Ue,g,o){var E=o("+Qka"),p=o("LsHQ"),X=p(function(F,i,Z){E(F,i,Z)});Ue.exports=X},"R/W3":function(Ue,g,o){var E=o("KwMD"),p=o("2ajD"),X=o("CZoQ");function F(i,Z,D){return Z===Z?X(i,Z,D):E(i,p,D)}Ue.exports=F},"RL2/":function(Ue,g,o){"use strict";var E="2.3.1"},RMtq:function(Ue,g){},"RR/i":function(Ue,g,o){"use strict";Object.defineProperty(g,"__esModule",{value:!0}),g.typeConstraint=g.namedConstraint=g.taggedConstraint=g.traverseAncerstors=void 0;var E=o("xfSm"),p=o("GXnB"),X=function D(J,ee){var ce=J.parentRequest;return ce!==null?ee(ce)?!0:D(ce,ee):!1};g.traverseAncerstors=X;var F=function(J){return function(ee){var ce=function(ze){return ze!==null&&ze.target!==null&&ze.target.matchesTag(J)(ee)};return ce.metaData=new p.Metadata(J,ee),ce}};g.taggedConstraint=F;var i=F(E.NAMED_TAG);g.namedConstraint=i;var Z=function(J){return function(ee){var ce=null;if(ee!==null)if(ce=ee.bindings[0],typeof J=="string"){var Y=ce.serviceIdentifier;return Y===J}else{var ze=ee.bindings[0].implementationType;return J===ze}return!1}};g.typeConstraint=Z},Sk89:function(Ue,g,o){"use strict";Object.defineProperty(g,"__esModule",{value:!0}),g.postConstruct=void 0;var E=o("MON2"),p=o("xfSm"),X=o("GXnB");function F(){return function(i,Z,D){var J=new X.Metadata(p.POST_CONSTRUCT,Z);if(Reflect.hasOwnMetadata(p.POST_CONSTRUCT,i.constructor))throw new Error(E.MULTIPLE_POST_CONSTRUCT_METHODS);Reflect.defineMetadata(p.POST_CONSTRUCT,J,i.constructor)}}g.postConstruct=F},Sq3C:function(Ue,g,o){var E=o("sKgW"),p=o("zoYe"),X=o("wy8a"),F=o("quyA"),i=o("Z1HP"),Z=o("Em2t"),D=Math.ceil;function J(ee,ce){ce=ce===void 0?" ":p(ce);var Y=ce.length;if(Y<2)return Y?E(ce,ee):ce;var ze=E(ce,D(ee/i(ce)));return F(ce)?X(Z(ze),0,ee).join(""):ze.slice(0,ee)}Ue.exports=J},Sxd8:function(Ue,g,o){var E=o("ZCgT");function p(X){var F=E(X),i=F%1;return F===F?i?F-i:F:0}Ue.exports=p},T1AV:function(Ue,g,o){var E=o("t2Dn"),p=o("5Tg0"),X=o("yP5f"),F=o("Q1l4"),i=o("+iFO"),Z=o("03A+"),D=o("Z0cm"),J=o("3L66"),ee=o("DSRE"),ce=o("lSCD"),Y=o("GoyQ"),ze=o("YO3V"),Xe=o("c6wG"),be=o("itsj"),Se=o("jeLo");function mt(Le,St,Ye,dt,Je,wt,At){var Ie=be(Le,Ye),Ne=be(St,Ye),Ve=At.get(Ne);if(Ve){E(Le,Ye,Ve);return}var ct=wt?wt(Ie,Ne,Ye+"",Le,St,At):void 0,Me=ct===void 0;if(Me){var ht=D(Ne),Wt=!ht&&ee(Ne),Qt=!ht&&!Wt&&Xe(Ne);ct=Ne,ht||Wt||Qt?D(Ie)?ct=Ie:J(Ie)?ct=F(Ie):Wt?(Me=!1,ct=p(Ne,!0)):Qt?(Me=!1,ct=X(Ne,!0)):ct=[]:ze(Ne)||Z(Ne)?(ct=Ie,Z(Ie)?ct=Se(Ie):(!Y(Ie)||ce(Ie))&&(ct=i(Ne))):Me=!1}Me&&(At.set(Ne,ct),Je(ct,Ne,dt,wt,At),At.delete(Ne)),E(Le,Ye,ct)}Ue.exports=mt},TKrE:function(Ue,g,o){var E=o("qRkn"),p=o("dt0z"),X=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,F="\\u0300-\\u036f",i="\\ufe20-\\ufe2f",Z="\\u20d0-\\u20ff",D=F+i+Z,J="["+D+"]",ee=RegExp(J,"g");function ce(Y){return Y=p(Y),Y&&Y.replace(X,E).replace(ee,"")}Ue.exports=ce},"U+yc":function(Ue,g){function o(E,p,X,F,i){var Z={};return Object.keys(F).forEach(function(D){Z[D]=F[D]}),Z.enumerable=!!Z.enumerable,Z.configurable=!!Z.configurable,("value"in Z||Z.initializer)&&(Z.writable=!0),Z=X.slice().reverse().reduce(function(D,J){return J(E,p,D)||D},Z),i&&Z.initializer!==void 0&&(Z.value=Z.initializer?Z.initializer.call(i):void 0,Z.initializer=void 0),Z.initializer===void 0&&(Object.defineProperty(E,p,Z),Z=null),Z}Ue.exports=o},U1ZX:function(Ue,g){},UB5X:function(Ue,g,o){var E=o("NykK"),p=o("ExA7"),X="[object Number]";function F(i){return typeof i=="number"||p(i)&&E(i)==X}Ue.exports=F},Ucsi:function(Ue,g,o){"use strict";Object.defineProperty(g,"__esModule",{value:!0});var E=Symbol.for("INJECTION");function p(D,J,ee,ce){function Y(){return ce&&!Reflect.hasMetadata(E,this,J)&&Reflect.defineMetadata(E,ee(),this,J),Reflect.hasMetadata(E,this,J)?Reflect.getMetadata(E,this,J):ee()}function ze(Xe){Reflect.defineMetadata(E,Xe,this,J)}Object.defineProperty(D,J,{configurable:!0,enumerable:!0,get:Y,set:ze})}function X(D,J){return function(ee){return function(ce,Y){var ze=function(){return D.get(ee)};p(ce,Y,ze,J)}}}g.makePropertyInjectDecorator=X;function F(D,J){return function(ee,ce){return function(Y,ze){var Xe=function(){return D.getNamed(ee,ce)};p(Y,ze,Xe,J)}}}g.makePropertyInjectNamedDecorator=F;function i(D,J){return function(ee,ce,Y){return function(ze,Xe){var be=function(){return D.getTagged(ee,ce,Y)};p(ze,Xe,be,J)}}}g.makePropertyInjectTaggedDecorator=i;function Z(D,J){return function(ee){return function(ce,Y){var ze=function(){return D.getAll(ee)};p(ce,Y,ze,J)}}}g.makePropertyMultiInjectDecorator=Z},V1cb:function(Ue,g,o){"use strict";o.d(g,"a",function(){return E});var E;(function(p){p.Hover="hover",p.Click="click",p.Select="select",p.Active="active",p.Drag="drag"})(E||(E={}))},VIsB:function(Ue,g,o){"use strict";o.d(g,"a",function(){return Z});var E=o("Hel2");function p(ze,Xe){var be;if(typeof Symbol=="undefined"||ze[Symbol.iterator]==null){if(Array.isArray(ze)||(be=X(ze))||Xe&&ze&&typeof ze.length=="number"){be&&(ze=be);var Se=0,mt=function(){};return{s:mt,n:function(){return Se>=ze.length?{done:!0}:{done:!1,value:ze[Se++]}},e:function(Je){throw Je},f:mt}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Le=!0,St=!1,Ye;return{s:function(){be=ze[Symbol.iterator]()},n:function(){var Je=be.next();return Le=Je.done,Je},e:function(Je){St=!0,Ye=Je},f:function(){try{!Le&&be.return!=null&&be.return()}finally{if(St)throw Ye}}}}function X(ze,Xe){if(!ze)return;if(typeof ze=="string")return F(ze,Xe);var be=Object.prototype.toString.call(ze).slice(8,-1);if(be==="Object"&&ze.constructor&&(be=ze.constructor.name),be==="Map"||be==="Set")return Array.from(ze);if(be==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(be))return F(ze,Xe)}function F(ze,Xe){(Xe==null||Xe>ze.length)&&(Xe=ze.length);for(var be=0,Se=new Array(Xe);be<Xe;be++)Se[be]=ze[be];return Se}var i=6378e3;function Z(ze,Xe){var be=ze.dataArray,Se=Xe.size,mt=Se===void 0?10:Se,Le=mt/(2*Math.PI*i)*(256<<20)/2,St=D(be,mt),Ye=St.gridHash,dt=St.gridOffset,Je=Y(Ye,dt,Xe);return{yOffset:Le,xOffset:Le,radius:Le,type:"grid",dataArray:Je}}function D(ze,Xe){var be=Infinity,Se=-Infinity,mt,Le=p(ze),St;try{for(Le.s();!(St=Le.n()).done;){var Ye=St.value;mt=Ye.coordinates[1],Number.isFinite(mt)&&(be=mt<be?mt:be,Se=mt>Se?mt:Se)}}catch(Qt){Le.e(Qt)}finally{Le.f()}var dt=(be+Se)/2,Je=J(Xe,dt);if(Je.xOffset<=0||Je.yOffset<=0)return{gridHash:{},gridOffset:Je};var wt={},At=p(ze),Ie;try{for(At.s();!(Ie=At.n()).done;){var Ne=Ie.value,Ve=Ne.coordinates[1],ct=Ne.coordinates[0];if(Number.isFinite(Ve)&&Number.isFinite(ct)){var Me=Math.floor((Ve+90)/Je.yOffset),ht=Math.floor((ct+180)/Je.xOffset),Wt="".concat(Me,"-").concat(ht);wt[Wt]=wt[Wt]||{count:0,points:[]},wt[Wt].count+=1,wt[Wt].points.push(Ne)}}}catch(Qt){At.e(Qt)}finally{At.f()}return{gridHash:wt,gridOffset:Je}}function J(ze,Xe){var be=ee(ze),Se=ce(Xe,ze);return{yOffset:be,xOffset:Se}}function ee(ze){return ze/i*(180/Math.PI)}function ce(ze,Xe){return Xe/i*(180/Math.PI)/Math.cos(ze*Math.PI/180)}function Y(ze,Xe,be){return Object.keys(ze).reduce(function(Se,mt,Le){var St=mt.split("-"),Ye=parseInt(St[0],10),dt=parseInt(St[1],10),Je={};if(be.field&&be.method){var wt=E.c.getColumn(ze[mt].points,be.field);Je[be.method]=E.c.statMap[be.method](wt)}return Object.assign(Je,{_id:Le,coordinates:Object(E.d)([-180+Xe.xOffset*(dt+.5),-90+Xe.yOffset*(Ye+.5)]),rawData:ze[mt].points,count:ze[mt].count}),Se.push(Je),Se},[])}},VOtZ:function(Ue,g,o){var E=o("juv8"),p=o("MvSz");function X(F,i){return E(F,p(F),i)}Ue.exports=X},VmRL:function(Ue,g,o){"use strict";Ue.exports=E,Ue.exports.default=E;function E(oe,$,H){H=H||2;var Ae=$&&$.length,ye=Ae?$[0]*H:oe.length,Te=p(oe,0,ye,H,!0),pe=[];if(!Te||Te.next===Te.prev)return pe;var it,qt,Pt,me,ve,Ge,st;if(Ae&&(Te=ee(oe,$,Te,H)),oe.length>80*H){it=Pt=oe[0],qt=me=oe[1];for(var Oe=H;Oe<ye;Oe+=H)ve=oe[Oe],Ge=oe[Oe+1],ve<it&&(it=ve),Ge<qt&&(qt=Ge),ve>Pt&&(Pt=ve),Ge>me&&(me=Ge);st=Math.max(Pt-it,me-qt),st=st!==0?1/st:0}return F(Te,pe,H,it,qt,st),pe}function p(oe,$,H,Ae,ye){var Te,pe;if(ye===ur(oe,$,H,Ae)>0)for(Te=$;Te<H;Te+=Ae)pe=ht(Te,oe[Te],oe[Te+1],pe);else for(Te=H-Ae;Te>=$;Te-=Ae)pe=ht(Te,oe[Te],oe[Te+1],pe);return pe&&Je(pe,pe.next)&&(Wt(pe),pe=pe.next),pe}function X(oe,$){if(!oe)return oe;$||($=oe);var H=oe,Ae;do if(Ae=!1,!H.steiner&&(Je(H,H.next)||dt(H.prev,H,H.next)===0)){if(Wt(H),H=$=H.prev,H===H.next)break;Ae=!0}else H=H.next;while(Ae||H!==$);return $}function F(oe,$,H,Ae,ye,Te,pe){if(!oe)return;!pe&&Te&&be(oe,Ae,ye,Te);for(var it=oe,qt,Pt;oe.prev!==oe.next;){if(qt=oe.prev,Pt=oe.next,Te?Z(oe,Ae,ye,Te):i(oe)){$.push(qt.i/H),$.push(oe.i/H),$.push(Pt.i/H),Wt(oe),oe=Pt.next,it=Pt.next;continue}if(oe=Pt,oe===it){pe?pe===1?(oe=D(X(oe),$,H),F(oe,$,H,Ae,ye,Te,2)):pe===2&&J(oe,$,H,Ae,ye,Te):F(X(oe),$,H,Ae,ye,Te,1);break}}}function i(oe){var $=oe.prev,H=oe,Ae=oe.next;if(dt($,H,Ae)>=0)return!1;for(var ye=oe.next.next;ye!==oe.prev;){if(St($.x,$.y,H.x,H.y,Ae.x,Ae.y,ye.x,ye.y)&&dt(ye.prev,ye,ye.next)>=0)return!1;ye=ye.next}return!0}function Z(oe,$,H,Ae){var ye=oe.prev,Te=oe,pe=oe.next;if(dt(ye,Te,pe)>=0)return!1;for(var it=ye.x<Te.x?ye.x<pe.x?ye.x:pe.x:Te.x<pe.x?Te.x:pe.x,qt=ye.y<Te.y?ye.y<pe.y?ye.y:pe.y:Te.y<pe.y?Te.y:pe.y,Pt=ye.x>Te.x?ye.x>pe.x?ye.x:pe.x:Te.x>pe.x?Te.x:pe.x,me=ye.y>Te.y?ye.y>pe.y?ye.y:pe.y:Te.y>pe.y?Te.y:pe.y,ve=mt(it,qt,$,H,Ae),Ge=mt(Pt,me,$,H,Ae),st=oe.prevZ,Oe=oe.nextZ;st&&st.z>=ve&&Oe&&Oe.z<=Ge;){if(st!==oe.prev&&st!==oe.next&&St(ye.x,ye.y,Te.x,Te.y,pe.x,pe.y,st.x,st.y)&&dt(st.prev,st,st.next)>=0)return!1;if(st=st.prevZ,Oe!==oe.prev&&Oe!==oe.next&&St(ye.x,ye.y,Te.x,Te.y,pe.x,pe.y,Oe.x,Oe.y)&&dt(Oe.prev,Oe,Oe.next)>=0)return!1;Oe=Oe.nextZ}for(;st&&st.z>=ve;){if(st!==oe.prev&&st!==oe.next&&St(ye.x,ye.y,Te.x,Te.y,pe.x,pe.y,st.x,st.y)&&dt(st.prev,st,st.next)>=0)return!1;st=st.prevZ}for(;Oe&&Oe.z<=Ge;){if(Oe!==oe.prev&&Oe!==oe.next&&St(ye.x,ye.y,Te.x,Te.y,pe.x,pe.y,Oe.x,Oe.y)&&dt(Oe.prev,Oe,Oe.next)>=0)return!1;Oe=Oe.nextZ}return!0}function D(oe,$,H){var Ae=oe;do{var ye=Ae.prev,Te=Ae.next.next;!Je(ye,Te)&&wt(ye,Ae,Ae.next,Te)&&Ve(ye,Te)&&Ve(Te,ye)&&($.push(ye.i/H),$.push(Ae.i/H),$.push(Te.i/H),Wt(Ae),Wt(Ae.next),Ae=oe=Te),Ae=Ae.next}while(Ae!==oe);return X(Ae)}function J(oe,$,H,Ae,ye,Te){var pe=oe;do{for(var it=pe.next.next;it!==pe.prev;){if(pe.i!==it.i&&Ye(pe,it)){var qt=Me(pe,it);pe=X(pe,pe.next),qt=X(qt,qt.next),F(pe,$,H,Ae,ye,Te),F(qt,$,H,Ae,ye,Te);return}it=it.next}pe=pe.next}while(pe!==oe)}function ee(oe,$,H,Ae){var ye=[],Te,pe,it,qt,Pt;for(Te=0,pe=$.length;Te<pe;Te++)it=$[Te]*Ae,qt=Te<pe-1?$[Te+1]*Ae:oe.length,Pt=p(oe,it,qt,Ae,!1),Pt===Pt.next&&(Pt.steiner=!0),ye.push(Le(Pt));for(ye.sort(ce),Te=0;Te<ye.length;Te++)Y(ye[Te],H),H=X(H,H.next);return H}function ce(oe,$){return oe.x-$.x}function Y(oe,$){if($=ze(oe,$),$){var H=Me($,oe);X($,$.next),X(H,H.next)}}function ze(oe,$){var H=$,Ae=oe.x,ye=oe.y,Te=-Infinity,pe;do{if(ye<=H.y&&ye>=H.next.y&&H.next.y!==H.y){var it=H.x+(ye-H.y)*(H.next.x-H.x)/(H.next.y-H.y);if(it<=Ae&&it>Te){if(Te=it,it===Ae){if(ye===H.y)return H;if(ye===H.next.y)return H.next}pe=H.x<H.next.x?H:H.next}}H=H.next}while(H!==$);if(!pe)return null;if(Ae===Te)return pe;var qt=pe,Pt=pe.x,me=pe.y,ve=Infinity,Ge;H=pe;do Ae>=H.x&&H.x>=Pt&&Ae!==H.x&&St(ye<me?Ae:Te,ye,Pt,me,ye<me?Te:Ae,ye,H.x,H.y)&&(Ge=Math.abs(ye-H.y)/(Ae-H.x),Ve(H,oe)&&(Ge<ve||Ge===ve&&(H.x>pe.x||H.x===pe.x&&Xe(pe,H)))&&(pe=H,ve=Ge)),H=H.next;while(H!==qt);return pe}function Xe(oe,$){return dt(oe.prev,oe,$.prev)<0&&dt($.next,oe,oe.next)<0}function be(oe,$,H,Ae){var ye=oe;do ye.z===null&&(ye.z=mt(ye.x,ye.y,$,H,Ae)),ye.prevZ=ye.prev,ye.nextZ=ye.next,ye=ye.next;while(ye!==oe);ye.prevZ.nextZ=null,ye.prevZ=null,Se(ye)}function Se(oe){var $,H,Ae,ye,Te,pe,it,qt,Pt=1;do{for(H=oe,oe=null,Te=null,pe=0;H;){for(pe++,Ae=H,it=0,$=0;$<Pt&&!(it++,Ae=Ae.nextZ,!Ae);$++);for(qt=Pt;it>0||qt>0&&Ae;)it!==0&&(qt===0||!Ae||H.z<=Ae.z)?(ye=H,H=H.nextZ,it--):(ye=Ae,Ae=Ae.nextZ,qt--),Te?Te.nextZ=ye:oe=ye,ye.prevZ=Te,Te=ye;H=Ae}Te.nextZ=null,Pt*=2}while(pe>1);return oe}function mt(oe,$,H,Ae,ye){return oe=32767*(oe-H)*ye,$=32767*($-Ae)*ye,oe=(oe|oe<<8)&16711935,oe=(oe|oe<<4)&252645135,oe=(oe|oe<<2)&858993459,oe=(oe|oe<<1)&1431655765,$=($|$<<8)&16711935,$=($|$<<4)&252645135,$=($|$<<2)&858993459,$=($|$<<1)&1431655765,oe|$<<1}function Le(oe){var $=oe,H=oe;do($.x<H.x||$.x===H.x&&$.y<H.y)&&(H=$),$=$.next;while($!==oe);return H}function St(oe,$,H,Ae,ye,Te,pe,it){return(ye-pe)*($-it)-(oe-pe)*(Te-it)>=0&&(oe-pe)*(Ae-it)-(H-pe)*($-it)>=0&&(H-pe)*(Te-it)-(ye-pe)*(Ae-it)>=0}function Ye(oe,$){return oe.next.i!==$.i&&oe.prev.i!==$.i&&!Ne(oe,$)&&(Ve(oe,$)&&Ve($,oe)&&ct(oe,$)&&(dt(oe.prev,oe,$.prev)||dt(oe,$.prev,$))||Je(oe,$)&&dt(oe.prev,oe,oe.next)>0&&dt($.prev,$,$.next)>0)}function dt(oe,$,H){return($.y-oe.y)*(H.x-$.x)-($.x-oe.x)*(H.y-$.y)}function Je(oe,$){return oe.x===$.x&&oe.y===$.y}function wt(oe,$,H,Ae){var ye=Ie(dt(oe,$,H)),Te=Ie(dt(oe,$,Ae)),pe=Ie(dt(H,Ae,oe)),it=Ie(dt(H,Ae,$));return ye!==Te&&pe!==it||(ye===0&&At(oe,H,$)||(Te===0&&At(oe,Ae,$)||pe===0&&At(H,oe,Ae)))?!0:!!(it===0&&At(H,$,Ae))}function At(oe,$,H){return $.x<=Math.max(oe.x,H.x)&&$.x>=Math.min(oe.x,H.x)&&$.y<=Math.max(oe.y,H.y)&&$.y>=Math.min(oe.y,H.y)}function Ie(oe){return oe>0?1:oe<0?-1:0}function Ne(oe,$){var H=oe;do{if(H.i!==oe.i&&H.next.i!==oe.i&&H.i!==$.i&&H.next.i!==$.i&&wt(H,H.next,oe,$))return!0;H=H.next}while(H!==oe);return!1}function Ve(oe,$){return dt(oe.prev,oe,oe.next)<0?dt(oe,$,oe.next)>=0&&dt(oe,oe.prev,$)>=0:dt(oe,$,oe.prev)<0||dt(oe,oe.next,$)<0}function ct(oe,$){var H=oe,Ae=!1,ye=(oe.x+$.x)/2,Te=(oe.y+$.y)/2;do H.y>Te!==H.next.y>Te&&H.next.y!==H.y&&ye<(H.next.x-H.x)*(Te-H.y)/(H.next.y-H.y)+H.x&&(Ae=!Ae),H=H.next;while(H!==oe);return Ae}function Me(oe,$){var H=new Qt(oe.i,oe.x,oe.y),Ae=new Qt($.i,$.x,$.y),ye=oe.next,Te=$.prev;return oe.next=$,$.prev=oe,H.next=ye,ye.prev=H,Ae.next=H,H.prev=Ae,Te.next=Ae,Ae.prev=Te,Ae}function ht(oe,$,H,Ae){var ye=new Qt(oe,$,H);return Ae?(ye.next=Ae.next,ye.prev=Ae,Ae.next.prev=ye,Ae.next=ye):(ye.prev=ye,ye.next=ye),ye}function Wt(oe){oe.next.prev=oe.prev,oe.prev.next=oe.next,oe.prevZ&&(oe.prevZ.nextZ=oe.nextZ),oe.nextZ&&(oe.nextZ.prevZ=oe.prevZ)}function Qt(oe,$,H){this.i=oe,this.x=$,this.y=H,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}E.deviation=function(oe,$,H,Ae){var ye=$&&$.length,Te=ye?$[0]*H:oe.length,pe=Math.abs(ur(oe,0,Te,H));if(ye)for(var it=0,qt=$.length;it<qt;it++){var Pt=$[it]*H,me=it<qt-1?$[it+1]*H:oe.length;pe-=Math.abs(ur(oe,Pt,me,H))}var ve=0;for(it=0;it<Ae.length;it+=3){var Ge=Ae[it]*H,st=Ae[it+1]*H,Oe=Ae[it+2]*H;ve+=Math.abs((oe[Ge]-oe[Oe])*(oe[st+1]-oe[Ge+1])-(oe[Ge]-oe[st])*(oe[Oe+1]-oe[Ge+1]))}return pe===0&&ve===0?0:Math.abs((ve-pe)/pe)};function ur(oe,$,H,Ae){for(var ye=0,Te=$,pe=H-Ae;Te<H;Te+=Ae)ye+=(oe[pe]-oe[Te])*(oe[Te+1]+oe[pe+1]),pe=Te;return ye}E.flatten=function(oe){for(var $=oe[0][0].length,H={vertices:[],holes:[],dimensions:$},Ae=0,ye=0;ye<oe.length;ye++){for(var Te=0;Te<oe[ye].length;Te++)for(var pe=0;pe<$;pe++)H.vertices.push(oe[ye][Te][pe]);ye>0&&(Ae+=oe[ye-1].length,H.holes.push(Ae))}return H}},WFAs:function(Ue,g){var o=Array.isArray;Ue.exports=o},WwFo:function(Ue,g,o){var E=o("juv8"),p=o("7GkX");function X(F,i){return F&&E(i,p(i),F)}Ue.exports=X},XYm9:function(Ue,g,o){var E=o("+K+b");function p(X,F){var i=F?E(X.buffer):X.buffer;return new X.constructor(i,X.byteOffset,X.byteLength)}Ue.exports=p},"Xt/L":function(Ue,g){function o(E,p,X){for(var F=-1,i=E==null?0:E.length;++F<i;)if(X(p,E[F]))return!0;return!1}Ue.exports=o},Y8BV:function(Ue,g,o){"use strict";o.d(g,"a",function(){return E});function E(p,X){var F=X.callback;return F&&(p.dataArray=p.dataArray.filter(F)),p}},YO3V:function(Ue,g,o){var E=o("NykK"),p=o("LcsW"),X=o("ExA7"),F="[object Object]",i=Function.prototype,Z=Object.prototype,D=i.toString,J=Z.hasOwnProperty,ee=D.call(Object);function ce(Y){if(!X(Y)||E(Y)!=F)return!1;var ze=p(Y);if(ze===null)return!0;var Xe=J.call(ze,"constructor")&&ze.constructor;return typeof Xe=="function"&&Xe instanceof Xe&&D.call(Xe)==ee}Ue.exports=ce},Yk9n:function(Ue,g,o){"use strict";Object.defineProperty(g,"__esModule",{value:!0}),g.inject=g.LazyServiceIdentifer=void 0;var E=o("MON2"),p=o("xfSm"),X=o("GXnB"),F=o("Ztfv"),i=function(){function D(J){this._cb=J}return D.prototype.unwrap=function(){return this._cb()},D}();g.LazyServiceIdentifer=i;function Z(D){return function(J,ee,ce){if(D===void 0)throw new Error(E.UNDEFINED_INJECT_ANNOTATION(J.name));var Y=new X.Metadata(p.INJECT_TAG,D);typeof ce=="number"?F.tagParameter(J,ee,ce,Y):F.tagProperty(J,ee,Y)}}g.inject=Z},Z1HP:function(Ue,g,o){var E=o("ycre"),p=o("quyA"),X=o("q4HE");function F(i){return p(i)?X(i):E(i)}Ue.exports=F},ZCgT:function(Ue,g,o){var E=o("tLB3"),p=1/0,X=17976931348623157e292;function F(i){if(!i)return i===0?i:0;if(i=E(i),i===p||i===-p){var Z=i<0?-1:1;return Z*X}return i===i?i:0}Ue.exports=F},ZK94:function(Ue,g){Ue.exports.RADIUS=6378137,Ue.exports.FLATTENING=1/298.257223563,Ue.exports.POLAR_RADIUS=63567523142e-4},ZaHm:function(Ue,g,o){"use strict";o.r(g),o.d(g,"create",function(){return p}),o.d(g,"clone",function(){return X}),o.d(g,"copy",function(){return F}),o.d(g,"fromValues",function(){return i}),o.d(g,"set",function(){return Z}),o.d(g,"identity",function(){return D}),o.d(g,"transpose",function(){return J}),o.d(g,"invert",function(){return ee}),o.d(g,"adjoint",function(){return ce}),o.d(g,"determinant",function(){return Y}),o.d(g,"multiply",function(){return ze}),o.d(g,"translate",function(){return Xe}),o.d(g,"scale",function(){return be}),o.d(g,"rotate",function(){return Se}),o.d(g,"rotateX",function(){return mt}),o.d(g,"rotateY",function(){return Le}),o.d(g,"rotateZ",function(){return St}),o.d(g,"fromTranslation",function(){return Ye}),o.d(g,"fromScaling",function(){return dt}),o.d(g,"fromRotation",function(){return Je}),o.d(g,"fromXRotation",function(){return wt}),o.d(g,"fromYRotation",function(){return At}),o.d(g,"fromZRotation",function(){return Ie}),o.d(g,"fromRotationTranslation",function(){return Ne}),o.d(g,"fromQuat2",function(){return Ve}),o.d(g,"getTranslation",function(){return ct}),o.d(g,"getScaling",function(){return Me}),o.d(g,"getRotation",function(){return ht}),o.d(g,"fromRotationTranslationScale",function(){return Wt}),o.d(g,"fromRotationTranslationScaleOrigin",function(){return Qt}),o.d(g,"fromQuat",function(){return ur}),o.d(g,"frustum",function(){return oe}),o.d(g,"perspective",function(){return $}),o.d(g,"perspectiveFromFieldOfView",function(){return H}),o.d(g,"ortho",function(){return Ae}),o.d(g,"lookAt",function(){return ye}),o.d(g,"targetTo",function(){return Te}),o.d(g,"str",function(){return pe}),o.d(g,"frob",function(){return it}),o.d(g,"add",function(){return qt}),o.d(g,"subtract",function(){return Pt}),o.d(g,"multiplyScalar",function(){return me}),o.d(g,"multiplyScalarAndAdd",function(){return ve}),o.d(g,"exactEquals",function(){return Ge}),o.d(g,"equals",function(){return st}),o.d(g,"mul",function(){return Oe}),o.d(g,"sub",function(){return gt});var E=o("yU0y");function p(){var C=new E.a(16);return E.a!=Float32Array&&(C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[11]=0,C[12]=0,C[13]=0,C[14]=0),C[0]=1,C[5]=1,C[10]=1,C[15]=1,C}function X(C){var R=new E.a(16);return R[0]=C[0],R[1]=C[1],R[2]=C[2],R[3]=C[3],R[4]=C[4],R[5]=C[5],R[6]=C[6],R[7]=C[7],R[8]=C[8],R[9]=C[9],R[10]=C[10],R[11]=C[11],R[12]=C[12],R[13]=C[13],R[14]=C[14],R[15]=C[15],R}function F(C,R){return C[0]=R[0],C[1]=R[1],C[2]=R[2],C[3]=R[3],C[4]=R[4],C[5]=R[5],C[6]=R[6],C[7]=R[7],C[8]=R[8],C[9]=R[9],C[10]=R[10],C[11]=R[11],C[12]=R[12],C[13]=R[13],C[14]=R[14],C[15]=R[15],C}function i(C,R,q,fe,He,et,_t,ot,Ut,K,qe,ae,tt,kt,pr,Ke){var xt=new E.a(16);return xt[0]=C,xt[1]=R,xt[2]=q,xt[3]=fe,xt[4]=He,xt[5]=et,xt[6]=_t,xt[7]=ot,xt[8]=Ut,xt[9]=K,xt[10]=qe,xt[11]=ae,xt[12]=tt,xt[13]=kt,xt[14]=pr,xt[15]=Ke,xt}function Z(C,R,q,fe,He,et,_t,ot,Ut,K,qe,ae,tt,kt,pr,Ke,xt){return C[0]=R,C[1]=q,C[2]=fe,C[3]=He,C[4]=et,C[5]=_t,C[6]=ot,C[7]=Ut,C[8]=K,C[9]=qe,C[10]=ae,C[11]=tt,C[12]=kt,C[13]=pr,C[14]=Ke,C[15]=xt,C}function D(C){return C[0]=1,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=1,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[10]=1,C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C}function J(C,R){if(C===R){var q=R[1],fe=R[2],He=R[3],et=R[6],_t=R[7],ot=R[11];C[1]=R[4],C[2]=R[8],C[3]=R[12],C[4]=q,C[6]=R[9],C[7]=R[13],C[8]=fe,C[9]=et,C[11]=R[14],C[12]=He,C[13]=_t,C[14]=ot}else C[0]=R[0],C[1]=R[4],C[2]=R[8],C[3]=R[12],C[4]=R[1],C[5]=R[5],C[6]=R[9],C[7]=R[13],C[8]=R[2],C[9]=R[6],C[10]=R[10],C[11]=R[14],C[12]=R[3],C[13]=R[7],C[14]=R[11],C[15]=R[15];return C}function ee(C,R){var q=R[0],fe=R[1],He=R[2],et=R[3],_t=R[4],ot=R[5],Ut=R[6],K=R[7],qe=R[8],ae=R[9],tt=R[10],kt=R[11],pr=R[12],Ke=R[13],xt=R[14],bt=R[15],Et=q*ot-fe*_t,Fe=q*Ut-He*_t,pt=q*K-et*_t,yt=fe*Ut-He*ot,Ht=fe*K-et*ot,hr=He*K-et*Ut,Zr=qe*Ke-ae*pr,yr=qe*xt-tt*pr,Vn=qe*bt-kt*pr,zn=ae*xt-tt*Ke,oa=ae*bt-kt*Ke,$n=tt*bt-kt*xt,Kn=Et*$n-Fe*oa+pt*zn+yt*Vn-Ht*yr+hr*Zr;return Kn?(Kn=1/Kn,C[0]=(ot*$n-Ut*oa+K*zn)*Kn,C[1]=(He*oa-fe*$n-et*zn)*Kn,C[2]=(Ke*hr-xt*Ht+bt*yt)*Kn,C[3]=(tt*Ht-ae*hr-kt*yt)*Kn,C[4]=(Ut*Vn-_t*$n-K*yr)*Kn,C[5]=(q*$n-He*Vn+et*yr)*Kn,C[6]=(xt*pt-pr*hr-bt*Fe)*Kn,C[7]=(qe*hr-tt*pt+kt*Fe)*Kn,C[8]=(_t*oa-ot*Vn+K*Zr)*Kn,C[9]=(fe*Vn-q*oa-et*Zr)*Kn,C[10]=(pr*Ht-Ke*pt+bt*Et)*Kn,C[11]=(ae*pt-qe*Ht-kt*Et)*Kn,C[12]=(ot*yr-_t*zn-Ut*Zr)*Kn,C[13]=(q*zn-fe*yr+He*Zr)*Kn,C[14]=(Ke*Fe-pr*yt-xt*Et)*Kn,C[15]=(qe*yt-ae*Fe+tt*Et)*Kn,C):null}function ce(C,R){var q=R[0],fe=R[1],He=R[2],et=R[3],_t=R[4],ot=R[5],Ut=R[6],K=R[7],qe=R[8],ae=R[9],tt=R[10],kt=R[11],pr=R[12],Ke=R[13],xt=R[14],bt=R[15];return C[0]=ot*(tt*bt-kt*xt)-ae*(Ut*bt-K*xt)+Ke*(Ut*kt-K*tt),C[1]=-(fe*(tt*bt-kt*xt)-ae*(He*bt-et*xt)+Ke*(He*kt-et*tt)),C[2]=fe*(Ut*bt-K*xt)-ot*(He*bt-et*xt)+Ke*(He*K-et*Ut),C[3]=-(fe*(Ut*kt-K*tt)-ot*(He*kt-et*tt)+ae*(He*K-et*Ut)),C[4]=-(_t*(tt*bt-kt*xt)-qe*(Ut*bt-K*xt)+pr*(Ut*kt-K*tt)),C[5]=q*(tt*bt-kt*xt)-qe*(He*bt-et*xt)+pr*(He*kt-et*tt),C[6]=-(q*(Ut*bt-K*xt)-_t*(He*bt-et*xt)+pr*(He*K-et*Ut)),C[7]=q*(Ut*kt-K*tt)-_t*(He*kt-et*tt)+qe*(He*K-et*Ut),C[8]=_t*(ae*bt-kt*Ke)-qe*(ot*bt-K*Ke)+pr*(ot*kt-K*ae),C[9]=-(q*(ae*bt-kt*Ke)-qe*(fe*bt-et*Ke)+pr*(fe*kt-et*ae)),C[10]=q*(ot*bt-K*Ke)-_t*(fe*bt-et*Ke)+pr*(fe*K-et*ot),C[11]=-(q*(ot*kt-K*ae)-_t*(fe*kt-et*ae)+qe*(fe*K-et*ot)),C[12]=-(_t*(ae*xt-tt*Ke)-qe*(ot*xt-Ut*Ke)+pr*(ot*tt-Ut*ae)),C[13]=q*(ae*xt-tt*Ke)-qe*(fe*xt-He*Ke)+pr*(fe*tt-He*ae),C[14]=-(q*(ot*xt-Ut*Ke)-_t*(fe*xt-He*Ke)+pr*(fe*Ut-He*ot)),C[15]=q*(ot*tt-Ut*ae)-_t*(fe*tt-He*ae)+qe*(fe*Ut-He*ot),C}function Y(C){var R=C[0],q=C[1],fe=C[2],He=C[3],et=C[4],_t=C[5],ot=C[6],Ut=C[7],K=C[8],qe=C[9],ae=C[10],tt=C[11],kt=C[12],pr=C[13],Ke=C[14],xt=C[15],bt=R*_t-q*et,Et=R*ot-fe*et,Fe=R*Ut-He*et,pt=q*ot-fe*_t,yt=q*Ut-He*_t,Ht=fe*Ut-He*ot,hr=K*pr-qe*kt,Zr=K*Ke-ae*kt,yr=K*xt-tt*kt,Vn=qe*Ke-ae*pr,zn=qe*xt-tt*pr,oa=ae*xt-tt*Ke;return bt*oa-Et*zn+Fe*Vn+pt*yr-yt*Zr+Ht*hr}function ze(C,R,q){var fe=R[0],He=R[1],et=R[2],_t=R[3],ot=R[4],Ut=R[5],K=R[6],qe=R[7],ae=R[8],tt=R[9],kt=R[10],pr=R[11],Ke=R[12],xt=R[13],bt=R[14],Et=R[15],Fe=q[0],pt=q[1],yt=q[2],Ht=q[3];return C[0]=Fe*fe+pt*ot+yt*ae+Ht*Ke,C[1]=Fe*He+pt*Ut+yt*tt+Ht*xt,C[2]=Fe*et+pt*K+yt*kt+Ht*bt,C[3]=Fe*_t+pt*qe+yt*pr+Ht*Et,Fe=q[4],pt=q[5],yt=q[6],Ht=q[7],C[4]=Fe*fe+pt*ot+yt*ae+Ht*Ke,C[5]=Fe*He+pt*Ut+yt*tt+Ht*xt,C[6]=Fe*et+pt*K+yt*kt+Ht*bt,C[7]=Fe*_t+pt*qe+yt*pr+Ht*Et,Fe=q[8],pt=q[9],yt=q[10],Ht=q[11],C[8]=Fe*fe+pt*ot+yt*ae+Ht*Ke,C[9]=Fe*He+pt*Ut+yt*tt+Ht*xt,C[10]=Fe*et+pt*K+yt*kt+Ht*bt,C[11]=Fe*_t+pt*qe+yt*pr+Ht*Et,Fe=q[12],pt=q[13],yt=q[14],Ht=q[15],C[12]=Fe*fe+pt*ot+yt*ae+Ht*Ke,C[13]=Fe*He+pt*Ut+yt*tt+Ht*xt,C[14]=Fe*et+pt*K+yt*kt+Ht*bt,C[15]=Fe*_t+pt*qe+yt*pr+Ht*Et,C}function Xe(C,R,q){var fe=q[0],He=q[1],et=q[2],_t,ot,Ut,K,qe,ae,tt,kt,pr,Ke,xt,bt;return R===C?(C[12]=R[0]*fe+R[4]*He+R[8]*et+R[12],C[13]=R[1]*fe+R[5]*He+R[9]*et+R[13],C[14]=R[2]*fe+R[6]*He+R[10]*et+R[14],C[15]=R[3]*fe+R[7]*He+R[11]*et+R[15]):(_t=R[0],ot=R[1],Ut=R[2],K=R[3],qe=R[4],ae=R[5],tt=R[6],kt=R[7],pr=R[8],Ke=R[9],xt=R[10],bt=R[11],C[0]=_t,C[1]=ot,C[2]=Ut,C[3]=K,C[4]=qe,C[5]=ae,C[6]=tt,C[7]=kt,C[8]=pr,C[9]=Ke,C[10]=xt,C[11]=bt,C[12]=_t*fe+qe*He+pr*et+R[12],C[13]=ot*fe+ae*He+Ke*et+R[13],C[14]=Ut*fe+tt*He+xt*et+R[14],C[15]=K*fe+kt*He+bt*et+R[15]),C}function be(C,R,q){var fe=q[0],He=q[1],et=q[2];return C[0]=R[0]*fe,C[1]=R[1]*fe,C[2]=R[2]*fe,C[3]=R[3]*fe,C[4]=R[4]*He,C[5]=R[5]*He,C[6]=R[6]*He,C[7]=R[7]*He,C[8]=R[8]*et,C[9]=R[9]*et,C[10]=R[10]*et,C[11]=R[11]*et,C[12]=R[12],C[13]=R[13],C[14]=R[14],C[15]=R[15],C}function Se(C,R,q,fe){var He=fe[0],et=fe[1],_t=fe[2],ot=Math.hypot(He,et,_t),Ut,K,qe,ae,tt,kt,pr,Ke,xt,bt,Et,Fe,pt,yt,Ht,hr,Zr,yr,Vn,zn,oa,$n,Kn,Cn;return ot<E.b?null:(ot=1/ot,He*=ot,et*=ot,_t*=ot,Ut=Math.sin(q),K=Math.cos(q),qe=1-K,ae=R[0],tt=R[1],kt=R[2],pr=R[3],Ke=R[4],xt=R[5],bt=R[6],Et=R[7],Fe=R[8],pt=R[9],yt=R[10],Ht=R[11],hr=He*He*qe+K,Zr=et*He*qe+_t*Ut,yr=_t*He*qe-et*Ut,Vn=He*et*qe-_t*Ut,zn=et*et*qe+K,oa=_t*et*qe+He*Ut,$n=He*_t*qe+et*Ut,Kn=et*_t*qe-He*Ut,Cn=_t*_t*qe+K,C[0]=ae*hr+Ke*Zr+Fe*yr,C[1]=tt*hr+xt*Zr+pt*yr,C[2]=kt*hr+bt*Zr+yt*yr,C[3]=pr*hr+Et*Zr+Ht*yr,C[4]=ae*Vn+Ke*zn+Fe*oa,C[5]=tt*Vn+xt*zn+pt*oa,C[6]=kt*Vn+bt*zn+yt*oa,C[7]=pr*Vn+Et*zn+Ht*oa,C[8]=ae*$n+Ke*Kn+Fe*Cn,C[9]=tt*$n+xt*Kn+pt*Cn,C[10]=kt*$n+bt*Kn+yt*Cn,C[11]=pr*$n+Et*Kn+Ht*Cn,R!==C&&(C[12]=R[12],C[13]=R[13],C[14]=R[14],C[15]=R[15]),C)}function mt(C,R,q){var fe=Math.sin(q),He=Math.cos(q),et=R[4],_t=R[5],ot=R[6],Ut=R[7],K=R[8],qe=R[9],ae=R[10],tt=R[11];return R!==C&&(C[0]=R[0],C[1]=R[1],C[2]=R[2],C[3]=R[3],C[12]=R[12],C[13]=R[13],C[14]=R[14],C[15]=R[15]),C[4]=et*He+K*fe,C[5]=_t*He+qe*fe,C[6]=ot*He+ae*fe,C[7]=Ut*He+tt*fe,C[8]=K*He-et*fe,C[9]=qe*He-_t*fe,C[10]=ae*He-ot*fe,C[11]=tt*He-Ut*fe,C}function Le(C,R,q){var fe=Math.sin(q),He=Math.cos(q),et=R[0],_t=R[1],ot=R[2],Ut=R[3],K=R[8],qe=R[9],ae=R[10],tt=R[11];return R!==C&&(C[4]=R[4],C[5]=R[5],C[6]=R[6],C[7]=R[7],C[12]=R[12],C[13]=R[13],C[14]=R[14],C[15]=R[15]),C[0]=et*He-K*fe,C[1]=_t*He-qe*fe,C[2]=ot*He-ae*fe,C[3]=Ut*He-tt*fe,C[8]=et*fe+K*He,C[9]=_t*fe+qe*He,C[10]=ot*fe+ae*He,C[11]=Ut*fe+tt*He,C}function St(C,R,q){var fe=Math.sin(q),He=Math.cos(q),et=R[0],_t=R[1],ot=R[2],Ut=R[3],K=R[4],qe=R[5],ae=R[6],tt=R[7];return R!==C&&(C[8]=R[8],C[9]=R[9],C[10]=R[10],C[11]=R[11],C[12]=R[12],C[13]=R[13],C[14]=R[14],C[15]=R[15]),C[0]=et*He+K*fe,C[1]=_t*He+qe*fe,C[2]=ot*He+ae*fe,C[3]=Ut*He+tt*fe,C[4]=K*He-et*fe,C[5]=qe*He-_t*fe,C[6]=ae*He-ot*fe,C[7]=tt*He-Ut*fe,C}function Ye(C,R){return C[0]=1,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=1,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[10]=1,C[11]=0,C[12]=R[0],C[13]=R[1],C[14]=R[2],C[15]=1,C}function dt(C,R){return C[0]=R[0],C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=R[1],C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[10]=R[2],C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C}function Je(C,R,q){var fe=q[0],He=q[1],et=q[2],_t=Math.hypot(fe,He,et),ot,Ut,K;return _t<E.b?null:(_t=1/_t,fe*=_t,He*=_t,et*=_t,ot=Math.sin(R),Ut=Math.cos(R),K=1-Ut,C[0]=fe*fe*K+Ut,C[1]=He*fe*K+et*ot,C[2]=et*fe*K-He*ot,C[3]=0,C[4]=fe*He*K-et*ot,C[5]=He*He*K+Ut,C[6]=et*He*K+fe*ot,C[7]=0,C[8]=fe*et*K+He*ot,C[9]=He*et*K-fe*ot,C[10]=et*et*K+Ut,C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C)}function wt(C,R){var q=Math.sin(R),fe=Math.cos(R);return C[0]=1,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=fe,C[6]=q,C[7]=0,C[8]=0,C[9]=-q,C[10]=fe,C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C}function At(C,R){var q=Math.sin(R),fe=Math.cos(R);return C[0]=fe,C[1]=0,C[2]=-q,C[3]=0,C[4]=0,C[5]=1,C[6]=0,C[7]=0,C[8]=q,C[9]=0,C[10]=fe,C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C}function Ie(C,R){var q=Math.sin(R),fe=Math.cos(R);return C[0]=fe,C[1]=q,C[2]=0,C[3]=0,C[4]=-q,C[5]=fe,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[10]=1,C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C}function Ne(C,R,q){var fe=R[0],He=R[1],et=R[2],_t=R[3],ot=fe+fe,Ut=He+He,K=et+et,qe=fe*ot,ae=fe*Ut,tt=fe*K,kt=He*Ut,pr=He*K,Ke=et*K,xt=_t*ot,bt=_t*Ut,Et=_t*K;return C[0]=1-(kt+Ke),C[1]=ae+Et,C[2]=tt-bt,C[3]=0,C[4]=ae-Et,C[5]=1-(qe+Ke),C[6]=pr+xt,C[7]=0,C[8]=tt+bt,C[9]=pr-xt,C[10]=1-(qe+kt),C[11]=0,C[12]=q[0],C[13]=q[1],C[14]=q[2],C[15]=1,C}function Ve(C,R){var q=new E.a(3),fe=-R[0],He=-R[1],et=-R[2],_t=R[3],ot=R[4],Ut=R[5],K=R[6],qe=R[7],ae=fe*fe+He*He+et*et+_t*_t;return ae>0?(q[0]=(ot*_t+qe*fe+Ut*et-K*He)*2/ae,q[1]=(Ut*_t+qe*He+K*fe-ot*et)*2/ae,q[2]=(K*_t+qe*et+ot*He-Ut*fe)*2/ae):(q[0]=(ot*_t+qe*fe+Ut*et-K*He)*2,q[1]=(Ut*_t+qe*He+K*fe-ot*et)*2,q[2]=(K*_t+qe*et+ot*He-Ut*fe)*2),Ne(C,R,q),C}function ct(C,R){return C[0]=R[12],C[1]=R[13],C[2]=R[14],C}function Me(C,R){var q=R[0],fe=R[1],He=R[2],et=R[4],_t=R[5],ot=R[6],Ut=R[8],K=R[9],qe=R[10];return C[0]=Math.hypot(q,fe,He),C[1]=Math.hypot(et,_t,ot),C[2]=Math.hypot(Ut,K,qe),C}function ht(C,R){var q=new E.a(3);Me(q,R);var fe=1/q[0],He=1/q[1],et=1/q[2],_t=R[0]*fe,ot=R[1]*He,Ut=R[2]*et,K=R[4]*fe,qe=R[5]*He,ae=R[6]*et,tt=R[8]*fe,kt=R[9]*He,pr=R[10]*et,Ke=_t+qe+pr,xt=0;return Ke>0?(xt=Math.sqrt(Ke+1)*2,C[3]=.25*xt,C[0]=(ae-kt)/xt,C[1]=(tt-Ut)/xt,C[2]=(ot-K)/xt):_t>qe&&_t>pr?(xt=Math.sqrt(1+_t-qe-pr)*2,C[3]=(ae-kt)/xt,C[0]=.25*xt,C[1]=(ot+K)/xt,C[2]=(tt+Ut)/xt):qe>pr?(xt=Math.sqrt(1+qe-_t-pr)*2,C[3]=(tt-Ut)/xt,C[0]=(ot+K)/xt,C[1]=.25*xt,C[2]=(ae+kt)/xt):(xt=Math.sqrt(1+pr-_t-qe)*2,C[3]=(ot-K)/xt,C[0]=(tt+Ut)/xt,C[1]=(ae+kt)/xt,C[2]=.25*xt),C}function Wt(C,R,q,fe){var He=R[0],et=R[1],_t=R[2],ot=R[3],Ut=He+He,K=et+et,qe=_t+_t,ae=He*Ut,tt=He*K,kt=He*qe,pr=et*K,Ke=et*qe,xt=_t*qe,bt=ot*Ut,Et=ot*K,Fe=ot*qe,pt=fe[0],yt=fe[1],Ht=fe[2];return C[0]=(1-(pr+xt))*pt,C[1]=(tt+Fe)*pt,C[2]=(kt-Et)*pt,C[3]=0,C[4]=(tt-Fe)*yt,C[5]=(1-(ae+xt))*yt,C[6]=(Ke+bt)*yt,C[7]=0,C[8]=(kt+Et)*Ht,C[9]=(Ke-bt)*Ht,C[10]=(1-(ae+pr))*Ht,C[11]=0,C[12]=q[0],C[13]=q[1],C[14]=q[2],C[15]=1,C}function Qt(C,R,q,fe,He){var et=R[0],_t=R[1],ot=R[2],Ut=R[3],K=et+et,qe=_t+_t,ae=ot+ot,tt=et*K,kt=et*qe,pr=et*ae,Ke=_t*qe,xt=_t*ae,bt=ot*ae,Et=Ut*K,Fe=Ut*qe,pt=Ut*ae,yt=fe[0],Ht=fe[1],hr=fe[2],Zr=He[0],yr=He[1],Vn=He[2],zn=(1-(Ke+bt))*yt,oa=(kt+pt)*yt,$n=(pr-Fe)*yt,Kn=(kt-pt)*Ht,Cn=(1-(tt+bt))*Ht,z=(xt+Et)*Ht,W=(pr+Fe)*hr,le=(xt-Et)*hr,xe=(1-(tt+Ke))*hr;return C[0]=zn,C[1]=oa,C[2]=$n,C[3]=0,C[4]=Kn,C[5]=Cn,C[6]=z,C[7]=0,C[8]=W,C[9]=le,C[10]=xe,C[11]=0,C[12]=q[0]+Zr-(zn*Zr+Kn*yr+W*Vn),C[13]=q[1]+yr-(oa*Zr+Cn*yr+le*Vn),C[14]=q[2]+Vn-($n*Zr+z*yr+xe*Vn),C[15]=1,C}function ur(C,R){var q=R[0],fe=R[1],He=R[2],et=R[3],_t=q+q,ot=fe+fe,Ut=He+He,K=q*_t,qe=fe*_t,ae=fe*ot,tt=He*_t,kt=He*ot,pr=He*Ut,Ke=et*_t,xt=et*ot,bt=et*Ut;return C[0]=1-ae-pr,C[1]=qe+bt,C[2]=tt-xt,C[3]=0,C[4]=qe-bt,C[5]=1-K-pr,C[6]=kt+Ke,C[7]=0,C[8]=tt+xt,C[9]=kt-Ke,C[10]=1-K-ae,C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C}function oe(C,R,q,fe,He,et,_t){var ot=1/(q-R),Ut=1/(He-fe),K=1/(et-_t);return C[0]=et*2*ot,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=et*2*Ut,C[6]=0,C[7]=0,C[8]=(q+R)*ot,C[9]=(He+fe)*Ut,C[10]=(_t+et)*K,C[11]=-1,C[12]=0,C[13]=0,C[14]=_t*et*2*K,C[15]=0,C}function $(C,R,q,fe,He){var et=1/Math.tan(R/2),_t;return C[0]=et/q,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=et,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[11]=-1,C[12]=0,C[13]=0,C[15]=0,He!=null&&He!==Infinity?(_t=1/(fe-He),C[10]=(He+fe)*_t,C[14]=2*He*fe*_t):(C[10]=-1,C[14]=-2*fe),C}function H(C,R,q,fe){var He=Math.tan(R.upDegrees*Math.PI/180),et=Math.tan(R.downDegrees*Math.PI/180),_t=Math.tan(R.leftDegrees*Math.PI/180),ot=Math.tan(R.rightDegrees*Math.PI/180),Ut=2/(_t+ot),K=2/(He+et);return C[0]=Ut,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=K,C[6]=0,C[7]=0,C[8]=-((_t-ot)*Ut*.5),C[9]=(He-et)*K*.5,C[10]=fe/(q-fe),C[11]=-1,C[12]=0,C[13]=0,C[14]=fe*q/(q-fe),C[15]=0,C}function Ae(C,R,q,fe,He,et,_t){var ot=1/(R-q),Ut=1/(fe-He),K=1/(et-_t);return C[0]=-2*ot,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=-2*Ut,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[10]=2*K,C[11]=0,C[12]=(R+q)*ot,C[13]=(He+fe)*Ut,C[14]=(_t+et)*K,C[15]=1,C}function ye(C,R,q,fe){var He,et,_t,ot,Ut,K,qe,ae,tt,kt,pr=R[0],Ke=R[1],xt=R[2],bt=fe[0],Et=fe[1],Fe=fe[2],pt=q[0],yt=q[1],Ht=q[2];return Math.abs(pr-pt)<E.b&&Math.abs(Ke-yt)<E.b&&Math.abs(xt-Ht)<E.b?D(C):(qe=pr-pt,ae=Ke-yt,tt=xt-Ht,kt=1/Math.hypot(qe,ae,tt),qe*=kt,ae*=kt,tt*=kt,He=Et*tt-Fe*ae,et=Fe*qe-bt*tt,_t=bt*ae-Et*qe,kt=Math.hypot(He,et,_t),kt?(kt=1/kt,He*=kt,et*=kt,_t*=kt):(He=0,et=0,_t=0),ot=ae*_t-tt*et,Ut=tt*He-qe*_t,K=qe*et-ae*He,kt=Math.hypot(ot,Ut,K),kt?(kt=1/kt,ot*=kt,Ut*=kt,K*=kt):(ot=0,Ut=0,K=0),C[0]=He,C[1]=ot,C[2]=qe,C[3]=0,C[4]=et,C[5]=Ut,C[6]=ae,C[7]=0,C[8]=_t,C[9]=K,C[10]=tt,C[11]=0,C[12]=-(He*pr+et*Ke+_t*xt),C[13]=-(ot*pr+Ut*Ke+K*xt),C[14]=-(qe*pr+ae*Ke+tt*xt),C[15]=1,C)}function Te(C,R,q,fe){var He=R[0],et=R[1],_t=R[2],ot=fe[0],Ut=fe[1],K=fe[2],qe=He-q[0],ae=et-q[1],tt=_t-q[2],kt=qe*qe+ae*ae+tt*tt;kt>0&&(kt=1/Math.sqrt(kt),qe*=kt,ae*=kt,tt*=kt);var pr=Ut*tt-K*ae,Ke=K*qe-ot*tt,xt=ot*ae-Ut*qe;return kt=pr*pr+Ke*Ke+xt*xt,kt>0&&(kt=1/Math.sqrt(kt),pr*=kt,Ke*=kt,xt*=kt),C[0]=pr,C[1]=Ke,C[2]=xt,C[3]=0,C[4]=ae*xt-tt*Ke,C[5]=tt*pr-qe*xt,C[6]=qe*Ke-ae*pr,C[7]=0,C[8]=qe,C[9]=ae,C[10]=tt,C[11]=0,C[12]=He,C[13]=et,C[14]=_t,C[15]=1,C}function pe(C){return"mat4("+C[0]+", "+C[1]+", "+C[2]+", "+C[3]+", "+C[4]+", "+C[5]+", "+C[6]+", "+C[7]+", "+C[8]+", "+C[9]+", "+C[10]+", "+C[11]+", "+C[12]+", "+C[13]+", "+C[14]+", "+C[15]+")"}function it(C){return Math.hypot(C[0],C[1],C[2],C[3],C[4],C[5],C[6],C[7],C[8],C[9],C[10],C[11],C[12],C[13],C[14],C[15])}function qt(C,R,q){return C[0]=R[0]+q[0],C[1]=R[1]+q[1],C[2]=R[2]+q[2],C[3]=R[3]+q[3],C[4]=R[4]+q[4],C[5]=R[5]+q[5],C[6]=R[6]+q[6],C[7]=R[7]+q[7],C[8]=R[8]+q[8],C[9]=R[9]+q[9],C[10]=R[10]+q[10],C[11]=R[11]+q[11],C[12]=R[12]+q[12],C[13]=R[13]+q[13],C[14]=R[14]+q[14],C[15]=R[15]+q[15],C}function Pt(C,R,q){return C[0]=R[0]-q[0],C[1]=R[1]-q[1],C[2]=R[2]-q[2],C[3]=R[3]-q[3],C[4]=R[4]-q[4],C[5]=R[5]-q[5],C[6]=R[6]-q[6],C[7]=R[7]-q[7],C[8]=R[8]-q[8],C[9]=R[9]-q[9],C[10]=R[10]-q[10],C[11]=R[11]-q[11],C[12]=R[12]-q[12],C[13]=R[13]-q[13],C[14]=R[14]-q[14],C[15]=R[15]-q[15],C}function me(C,R,q){return C[0]=R[0]*q,C[1]=R[1]*q,C[2]=R[2]*q,C[3]=R[3]*q,C[4]=R[4]*q,C[5]=R[5]*q,C[6]=R[6]*q,C[7]=R[7]*q,C[8]=R[8]*q,C[9]=R[9]*q,C[10]=R[10]*q,C[11]=R[11]*q,C[12]=R[12]*q,C[13]=R[13]*q,C[14]=R[14]*q,C[15]=R[15]*q,C}function ve(C,R,q,fe){return C[0]=R[0]+q[0]*fe,C[1]=R[1]+q[1]*fe,C[2]=R[2]+q[2]*fe,C[3]=R[3]+q[3]*fe,C[4]=R[4]+q[4]*fe,C[5]=R[5]+q[5]*fe,C[6]=R[6]+q[6]*fe,C[7]=R[7]+q[7]*fe,C[8]=R[8]+q[8]*fe,C[9]=R[9]+q[9]*fe,C[10]=R[10]+q[10]*fe,C[11]=R[11]+q[11]*fe,C[12]=R[12]+q[12]*fe,C[13]=R[13]+q[13]*fe,C[14]=R[14]+q[14]*fe,C[15]=R[15]+q[15]*fe,C}function Ge(C,R){return C[0]===R[0]&&C[1]===R[1]&&C[2]===R[2]&&C[3]===R[3]&&C[4]===R[4]&&C[5]===R[5]&&C[6]===R[6]&&C[7]===R[7]&&C[8]===R[8]&&C[9]===R[9]&&C[10]===R[10]&&C[11]===R[11]&&C[12]===R[12]&&C[13]===R[13]&&C[14]===R[14]&&C[15]===R[15]}function st(C,R){var q=C[0],fe=C[1],He=C[2],et=C[3],_t=C[4],ot=C[5],Ut=C[6],K=C[7],qe=C[8],ae=C[9],tt=C[10],kt=C[11],pr=C[12],Ke=C[13],xt=C[14],bt=C[15],Et=R[0],Fe=R[1],pt=R[2],yt=R[3],Ht=R[4],hr=R[5],Zr=R[6],yr=R[7],Vn=R[8],zn=R[9],oa=R[10],$n=R[11],Kn=R[12],Cn=R[13],z=R[14],W=R[15];return Math.abs(q-Et)<=E.b*Math.max(1,Math.abs(q),Math.abs(Et))&&Math.abs(fe-Fe)<=E.b*Math.max(1,Math.abs(fe),Math.abs(Fe))&&Math.abs(He-pt)<=E.b*Math.max(1,Math.abs(He),Math.abs(pt))&&Math.abs(et-yt)<=E.b*Math.max(1,Math.abs(et),Math.abs(yt))&&Math.abs(_t-Ht)<=E.b*Math.max(1,Math.abs(_t),Math.abs(Ht))&&Math.abs(ot-hr)<=E.b*Math.max(1,Math.abs(ot),Math.abs(hr))&&Math.abs(Ut-Zr)<=E.b*Math.max(1,Math.abs(Ut),Math.abs(Zr))&&Math.abs(K-yr)<=E.b*Math.max(1,Math.abs(K),Math.abs(yr))&&Math.abs(qe-Vn)<=E.b*Math.max(1,Math.abs(qe),Math.abs(Vn))&&Math.abs(ae-zn)<=E.b*Math.max(1,Math.abs(ae),Math.abs(zn))&&Math.abs(tt-oa)<=E.b*Math.max(1,Math.abs(tt),Math.abs(oa))&&Math.abs(kt-$n)<=E.b*Math.max(1,Math.abs(kt),Math.abs($n))&&Math.abs(pr-Kn)<=E.b*Math.max(1,Math.abs(pr),Math.abs(Kn))&&Math.abs(Ke-Cn)<=E.b*Math.max(1,Math.abs(Ke),Math.abs(Cn))&&Math.abs(xt-z)<=E.b*Math.max(1,Math.abs(xt),Math.abs(z))&&Math.abs(bt-W)<=E.b*Math.max(1,Math.abs(bt),Math.abs(W))}var Oe=ze,gt=Pt},Ztfv:function(Ue,g,o){"use strict";Object.defineProperty(g,"__esModule",{value:!0}),g.tagProperty=g.tagParameter=g.decorate=void 0;var E=o("MON2"),p=o("xfSm");function X(ee,ce,Y,ze){var Xe=p.TAGGED;i(Xe,ee,ce,ze,Y)}g.tagParameter=X;function F(ee,ce,Y){var ze=p.TAGGED_PROP;i(ze,ee.constructor,ce,Y)}g.tagProperty=F;function i(ee,ce,Y,ze,Xe){var be={},Se=typeof Xe=="number",mt=Xe!==void 0&&Se?Xe.toString():Y;if(Se&&Y!==void 0)throw new Error(E.INVALID_DECORATOR_OPERATION);Reflect.hasOwnMetadata(ee,ce)&&(be=Reflect.getMetadata(ee,ce));var Le=be[mt];if(!Array.isArray(Le))Le=[];else for(var St=0,Ye=Le;St<Ye.length;St++){var dt=Ye[St];if(dt.key===ze.key)throw new Error(E.DUPLICATED_METADATA+" "+dt.key.toString())}Le.push(ze),be[mt]=Le,Reflect.defineMetadata(ee,be,ce)}function Z(ee,ce){Reflect.decorate(ee,ce)}function D(ee,ce){return function(Y,ze){ce(Y,ze,ee)}}function J(ee,ce,Y){typeof Y=="number"?Z([D(Y,ee)],ce):typeof Y=="string"?Reflect.decorate([ee],ce,Y):Z([ee],ce)}g.decorate=J},ZxFD:function(Ue,g,o){"use strict";o.r(g),o.d(g,"create",function(){return p}),o.d(g,"clone",function(){return X}),o.d(g,"fromValues",function(){return F}),o.d(g,"copy",function(){return i}),o.d(g,"set",function(){return Z}),o.d(g,"add",function(){return D}),o.d(g,"subtract",function(){return J}),o.d(g,"multiply",function(){return ee}),o.d(g,"divide",function(){return ce}),o.d(g,"ceil",function(){return Y}),o.d(g,"floor",function(){return ze}),o.d(g,"min",function(){return Xe}),o.d(g,"max",function(){return be}),o.d(g,"round",function(){return Se}),o.d(g,"scale",function(){return mt}),o.d(g,"scaleAndAdd",function(){return Le}),o.d(g,"distance",function(){return St}),o.d(g,"squaredDistance",function(){return Ye}),o.d(g,"length",function(){return dt}),o.d(g,"squaredLength",function(){return Je}),o.d(g,"negate",function(){return wt}),o.d(g,"inverse",function(){return At}),o.d(g,"normalize",function(){return Ie}),o.d(g,"dot",function(){return Ne}),o.d(g,"cross",function(){return Ve}),o.d(g,"lerp",function(){return ct}),o.d(g,"random",function(){return Me}),o.d(g,"transformMat2",function(){return ht}),o.d(g,"transformMat2d",function(){return Wt}),o.d(g,"transformMat3",function(){return Qt}),o.d(g,"transformMat4",function(){return ur}),o.d(g,"rotate",function(){return oe}),o.d(g,"angle",function(){return $}),o.d(g,"zero",function(){return H}),o.d(g,"str",function(){return Ae}),o.d(g,"exactEquals",function(){return ye}),o.d(g,"equals",function(){return Te}),o.d(g,"len",function(){return pe}),o.d(g,"sub",function(){return it}),o.d(g,"mul",function(){return qt}),o.d(g,"div",function(){return Pt}),o.d(g,"dist",function(){return me}),o.d(g,"sqrDist",function(){return ve}),o.d(g,"sqrLen",function(){return Ge}),o.d(g,"forEach",function(){return st});var E=o("yU0y");function p(){var Oe=new E.a(2);return E.a!=Float32Array&&(Oe[0]=0,Oe[1]=0),Oe}function X(Oe){var gt=new E.a(2);return gt[0]=Oe[0],gt[1]=Oe[1],gt}function F(Oe,gt){var C=new E.a(2);return C[0]=Oe,C[1]=gt,C}function i(Oe,gt){return Oe[0]=gt[0],Oe[1]=gt[1],Oe}function Z(Oe,gt,C){return Oe[0]=gt,Oe[1]=C,Oe}function D(Oe,gt,C){return Oe[0]=gt[0]+C[0],Oe[1]=gt[1]+C[1],Oe}function J(Oe,gt,C){return Oe[0]=gt[0]-C[0],Oe[1]=gt[1]-C[1],Oe}function ee(Oe,gt,C){return Oe[0]=gt[0]*C[0],Oe[1]=gt[1]*C[1],Oe}function ce(Oe,gt,C){return Oe[0]=gt[0]/C[0],Oe[1]=gt[1]/C[1],Oe}function Y(Oe,gt){return Oe[0]=Math.ceil(gt[0]),Oe[1]=Math.ceil(gt[1]),Oe}function ze(Oe,gt){return Oe[0]=Math.floor(gt[0]),Oe[1]=Math.floor(gt[1]),Oe}function Xe(Oe,gt,C){return Oe[0]=Math.min(gt[0],C[0]),Oe[1]=Math.min(gt[1],C[1]),Oe}function be(Oe,gt,C){return Oe[0]=Math.max(gt[0],C[0]),Oe[1]=Math.max(gt[1],C[1]),Oe}function Se(Oe,gt){return Oe[0]=Math.round(gt[0]),Oe[1]=Math.round(gt[1]),Oe}function mt(Oe,gt,C){return Oe[0]=gt[0]*C,Oe[1]=gt[1]*C,Oe}function Le(Oe,gt,C,R){return Oe[0]=gt[0]+C[0]*R,Oe[1]=gt[1]+C[1]*R,Oe}function St(Oe,gt){var C=gt[0]-Oe[0],R=gt[1]-Oe[1];return Math.hypot(C,R)}function Ye(Oe,gt){var C=gt[0]-Oe[0],R=gt[1]-Oe[1];return C*C+R*R}function dt(Oe){var gt=Oe[0],C=Oe[1];return Math.hypot(gt,C)}function Je(Oe){var gt=Oe[0],C=Oe[1];return gt*gt+C*C}function wt(Oe,gt){return Oe[0]=-gt[0],Oe[1]=-gt[1],Oe}function At(Oe,gt){return Oe[0]=1/gt[0],Oe[1]=1/gt[1],Oe}function Ie(Oe,gt){var C=gt[0],R=gt[1],q=C*C+R*R;return q>0&&(q=1/Math.sqrt(q)),Oe[0]=gt[0]*q,Oe[1]=gt[1]*q,Oe}function Ne(Oe,gt){return Oe[0]*gt[0]+Oe[1]*gt[1]}function Ve(Oe,gt,C){var R=gt[0]*C[1]-gt[1]*C[0];return Oe[0]=Oe[1]=0,Oe[2]=R,Oe}function ct(Oe,gt,C,R){var q=gt[0],fe=gt[1];return Oe[0]=q+R*(C[0]-q),Oe[1]=fe+R*(C[1]-fe),Oe}function Me(Oe,gt){gt=gt||1;var C=E.c()*2*Math.PI;return Oe[0]=Math.cos(C)*gt,Oe[1]=Math.sin(C)*gt,Oe}function ht(Oe,gt,C){var R=gt[0],q=gt[1];return Oe[0]=C[0]*R+C[2]*q,Oe[1]=C[1]*R+C[3]*q,Oe}function Wt(Oe,gt,C){var R=gt[0],q=gt[1];return Oe[0]=C[0]*R+C[2]*q+C[4],Oe[1]=C[1]*R+C[3]*q+C[5],Oe}function Qt(Oe,gt,C){var R=gt[0],q=gt[1];return Oe[0]=C[0]*R+C[3]*q+C[6],Oe[1]=C[1]*R+C[4]*q+C[7],Oe}function ur(Oe,gt,C){var R=gt[0],q=gt[1];return Oe[0]=C[0]*R+C[4]*q+C[12],Oe[1]=C[1]*R+C[5]*q+C[13],Oe}function oe(Oe,gt,C,R){var q=gt[0]-C[0],fe=gt[1]-C[1],He=Math.sin(R),et=Math.cos(R);return Oe[0]=q*et-fe*He+C[0],Oe[1]=q*He+fe*et+C[1],Oe}function $(Oe,gt){var C=Oe[0],R=Oe[1],q=gt[0],fe=gt[1],He=Math.sqrt(C*C+R*R)*Math.sqrt(q*q+fe*fe),et=He&&(C*q+R*fe)/He;return Math.acos(Math.min(Math.max(et,-1),1))}function H(Oe){return Oe[0]=0,Oe[1]=0,Oe}function Ae(Oe){return"vec2("+Oe[0]+", "+Oe[1]+")"}function ye(Oe,gt){return Oe[0]===gt[0]&&Oe[1]===gt[1]}function Te(Oe,gt){var C=Oe[0],R=Oe[1],q=gt[0],fe=gt[1];return Math.abs(C-q)<=E.b*Math.max(1,Math.abs(C),Math.abs(q))&&Math.abs(R-fe)<=E.b*Math.max(1,Math.abs(R),Math.abs(fe))}var pe=dt,it=J,qt=ee,Pt=ce,me=St,ve=Ye,Ge=Je,st=function(){var Oe=p();return function(gt,C,R,q,fe,He){var et,_t;for(C||(C=2),R||(R=0),q?_t=Math.min(q*C+R,gt.length):_t=gt.length,et=R;et<_t;et+=C)Oe[0]=gt[et],Oe[1]=gt[et+1],fe(Oe,Oe,He),gt[et]=Oe[0],gt[et+1]=Oe[1];return gt}}()},ZzCi:function(Ue,g,o){"use strict";Object.defineProperty(g,"__esModule",{value:!0}),g.named=void 0;var E=o("xfSm"),p=o("GXnB"),X=o("Ztfv");function F(i){return function(Z,D,J){var ee=new p.Metadata(E.NAMED_TAG,i);typeof J=="number"?X.tagParameter(Z,D,J,ee):X.tagProperty(Z,D,ee)}}g.named=F},a5Wf:function(Ue,g,o){"use strict";o.r(g);var E=o("IzEo"),p=o("bx4M"),X=o("14J3"),F=o("BMrR"),i=o("jCWc"),Z=o("kPKH"),D=o("1OyB"),J=o("vuIU"),ee=o("Ji7U"),ce=o("LK+K"),Y=o("aHsQ"),ze=o("sGsY"),Xe=o("9kvl"),be=o("q1tI"),Se=o.n(be),mt=o("HTcj"),Le=o("ZhIB"),St=o.n(Le),Ye=o("yP6+"),dt=o("wx14");function Je(w){var b=w.style;b.height="100%";var c=parseInt("".concat(getComputedStyle(w).height),10),d=parseInt("".concat(getComputedStyle(w).paddingTop),10)+parseInt("".concat(getComputedStyle(w).paddingBottom),10);return c-d}function wt(w){if(!w)return 0;var b=w,c=Je(b),d=b.parentNode;return d&&(c=Je(d)),c}function At(){return function(w){var b=function(c){Object(ee.a)(y,c);var d=Object(ce.a)(y);function y(){var I;Object(D.a)(this,y);for(var te=arguments.length,B=new Array(te),k=0;k<te;k++)B[k]=arguments[k];return I=d.call.apply(d,[this].concat(B)),I.state={computedHeight:0},I.root=null,I.handleRoot=function(Q){I.root=Q},I}return Object(J.a)(y,[{key:"componentDidMount",value:function(){var te=this.props.height;if(!te&&this.root){var B=wt(this.root);this.setState({computedHeight:B}),B<1&&(B=wt(this.root),this.setState({computedHeight:B}))}}},{key:"render",value:function(){var te=this.props.height,B=this.state.computedHeight,k=te||B;return Se.a.createElement("div",{ref:this.handleRoot},k>0&&Se.a.createElement(w,Object(dt.a)({},this.props,{height:k})))}}]),y}(Se.a.Component);return b}}var Ie=At,Ne=Ye.Guide.Arc,Ve=Ye.Guide.Html,ct=Ye.Guide.Line,Me=function(b){switch(b){case"2":return"\u5DEE";case"4":return"\u4E2D";case"6":return"\u826F";case"8":return"\u4F18";default:return""}};Ye.Shape.registerShape&&Ye.Shape.registerShape("point","pointer",{drawShape:function(b,c){var d=b.points[0];d=this.parsePoint(d);var y=this.parsePoint({x:0,y:0});return c.addShape("line",{attrs:{x1:y.x,y1:y.y,x2:d.x,y2:d.y,stroke:b.color,lineWidth:2,lineCap:"round"}}),c.addShape("circle",{attrs:{x:y.x,y:y.y,r:6,stroke:b.color,lineWidth:3,fill:"#fff"}})}});var ht=function(b){var c=b.title,d=b.height,y=d===void 0?1:d,I=b.percent,te=b.forceFit,B=te===void 0?!0:te,k=b.formatter,Q=k===void 0?Me:k,We=b.color,rt=We===void 0?"#2F9CFF":We,Pe=b.bgColor,Qe=Pe===void 0?"#F0F2F5":Pe,Tt={value:{type:"linear",min:0,max:10,tickCount:6,nice:!0}},ke=[{value:I/10}],vt=function(){return`
  <div style="width: 300px;text-align: center;font-size: 12px!important;">
    <div style="font-size: 14px; color: rgba(0,0,0,0.43);margin: 0;">`.concat(c,`</div>
    <div style="font-size: 24px;color: rgba(0,0,0,0.85);margin: 0;">
      `).concat((ke[0].value*10).toFixed(2),`%
    </div>
  </div>`)},De={fontSize:12,fill:"rgba(0, 0, 0, 0.65)",textAlign:"center"};return Se.a.createElement(Ye.Chart,{height:y,data:ke,scale:Tt,padding:[-16,0,16,0],forceFit:B},Se.a.createElement(Ye.Coord,{type:"polar",startAngle:-1.25*Math.PI,endAngle:.25*Math.PI,radius:.8}),Se.a.createElement(Ye.Axis,{name:"1",line:void 0}),Se.a.createElement(Ye.Axis,{line:void 0,tickLine:void 0,subTickLine:void 0,name:"value",zIndex:2,label:{offset:-12,formatter:Q,textStyle:De}}),Se.a.createElement(Ye.Guide,null,Se.a.createElement(ct,{start:[3,.905],end:[3,.85],lineStyle:{stroke:rt,lineDash:void 0,lineWidth:2}}),Se.a.createElement(ct,{start:[5,.905],end:[5,.85],lineStyle:{stroke:rt,lineDash:void 0,lineWidth:3}}),Se.a.createElement(ct,{start:[7,.905],end:[7,.85],lineStyle:{stroke:rt,lineDash:void 0,lineWidth:3}}),Se.a.createElement(Ne,{start:[0,.965],end:[10,.965],style:{stroke:Qe,lineWidth:10}}),Se.a.createElement(Ne,{start:[0,.965],end:[ke[0].value,.965],style:{stroke:rt,lineWidth:10}}),Se.a.createElement(Ve,{position:["50%","95%"],html:vt()})),Se.a.createElement(Ye.Geom,{line:!1,type:"point",position:"value*1",shape:"pointer",color:rt,active:!1}))},Wt=Ie()(ht),Qt=o("VTBJ"),ur={miniChart:"miniChart___27WlV",chartContent:"chartContent___2FNqq",chartLoading:"chartLoading___2DxhP"},oe=function(b){var c=b.height,d=c===void 0?1:c,y=b.data,I=y===void 0?[]:y,te=b.forceFit,B=te===void 0?!0:te,k=b.color,Q=k===void 0?"rgba(24, 144, 255, 0.2)":k,We=b.borderColor,rt=We===void 0?"#1089ff":We,Pe=b.scale,Qe=Pe===void 0?{x:{},y:{}}:Pe,Tt=b.borderWidth,ke=Tt===void 0?2:Tt,vt=b.line,De=b.xAxis,Zt=b.yAxis,Kt=b.animate,dr=Kt===void 0?!0:Kt,rr=[36,5,30,5],mr={x:Object(Qt.a)({type:"cat",range:[0,1]},Qe.x),y:Object(Qt.a)({min:0},Qe.y)},Or=["x*y",function(Bn,on){return{name:Bn,value:on}}],$r=d+54;return Se.a.createElement("div",{className:ur.miniChart,style:{height:d}},Se.a.createElement("div",{className:ur.chartContent},d>0&&Se.a.createElement(Ye.Chart,{animate:dr,scale:mr,height:$r,forceFit:B,data:I,padding:rr},Se.a.createElement(Ye.Axis,Object(dt.a)({key:"axis-x",name:"x",label:null,line:null,tickLine:null,grid:null},De)),Se.a.createElement(Ye.Axis,Object(dt.a)({key:"axis-y",name:"y",label:null,line:null,tickLine:null,grid:null},Zt)),Se.a.createElement(Ye.Tooltip,{showTitle:!1,crosshairs:!1}),Se.a.createElement(Ye.Geom,{type:"area",position:"x*y",color:Q,tooltip:Or,shape:"smooth",style:{fillOpacity:1}}),vt?Se.a.createElement(Ye.Geom,{type:"line",position:"x*y",shape:"smooth",color:rt,size:ke,tooltip:!1}):Se.a.createElement("span",{style:{display:"none"}}))))},$=Ie()(oe),H=o("/zsF"),Ae=o("PArb"),ye=o("rePB"),Te=o("cQSq"),pe=o.n(Te),it=o("9/5/"),qt=o.n(it),Pt=o("Jssm"),me=o.n(Pt),ve=o("TSYQ"),Ge=o.n(ve),st={pie:"pie___2nzPi",chart:"chart____y02v",hasLegend:"hasLegend___2tvLi",legend:"legend___aOylG",dot:"dot___3cUod",line:"line___3wzdx",legendTitle:"legendTitle___3d-qz",percent:"percent___1EUip",value:"value___3oEZu",title:"title___3EZr5",total:"total___2C3lg",legendBlock:"legendBlock___1RfCR"},Oe=function(w){Object(ee.a)(c,w);var b=Object(ce.a)(c);function c(){var d;Object(D.a)(this,c);for(var y=arguments.length,I=new Array(y),te=0;te<y;te++)I[te]=arguments[te];return d=b.call.apply(b,[this].concat(I)),d.state={legendData:[],legendBlock:!1},d.chart=void 0,d.root=void 0,d.requestRef=0,d.resize=qt()(function(){var B=d.props.hasLegend,k=d.state.legendBlock;if(!B||!d.root){window.removeEventListener("resize",d.resize);return}d.root&&d.root.parentNode&&d.root.parentNode.clientWidth<=380?k||d.setState({legendBlock:!0}):k&&d.setState({legendBlock:!1})},300),d.getG2Instance=function(B){d.chart=B,requestAnimationFrame(function(){d.getLegendData(),d.resize()})},d.getLegendData=function(){if(!d.chart)return;var B=d.chart.getAllGeoms()[0];if(!B)return;var k=B.get("dataArray")||[],Q=k.map(function(We){var rt=We[0]._origin;return rt.color=We[0].color,rt.checked=!0,rt});d.setState({legendData:Q})},d.handleRoot=function(B){d.root=B},d.handleLegendClick=function(B,k){var Q=B;Q.checked=!Q.checked;var We=d.state.legendData;We[k]=Q;var rt=We.filter(function(Pe){return Pe.checked}).map(function(Pe){return Pe.x});d.chart&&d.chart.filter("x",function(Pe){return rt.indexOf("".concat(Pe))>-1}),d.setState({legendData:We})},d}return Object(J.a)(c,[{key:"componentDidMount",value:function(){var y=this;window.addEventListener("resize",function(){y.requestRef=requestAnimationFrame(function(){return y.resize()})},{passive:!0})}},{key:"componentDidUpdate",value:function(y){var I=this.props.data;I!==y.data&&this.getLegendData()}},{key:"componentWillUnmount",value:function(){this.requestRef&&window.cancelAnimationFrame(this.requestRef),window.removeEventListener("resize",this.resize),this.resize&&this.resize.cancel()}},{key:"render",value:function(){var y,I=this,te=this.props,B=te.valueFormat,k=te.subTitle,Q=te.total,We=te.hasLegend,rt=We===void 0?!1:We,Pe=te.className,Qe=te.style,Tt=te.height,ke=Tt===void 0?0:Tt,vt=te.forceFit,De=vt===void 0?!0:vt,Zt=te.percent,Kt=te.color,dr=te.inner,rr=dr===void 0?.75:dr,mr=te.animate,Or=mr===void 0?!0:mr,$r=te.colors,Bn=te.lineWidth,on=Bn===void 0?1:Bn,Dn=this.state,ca=Dn.legendData,Na=Dn.legendBlock,ri=Ge()(st.pie,Pe,(y={},Object(ye.a)(y,st.hasLegend,!!rt),Object(ye.a)(y,st.legendBlock,Na),y)),co=this.props,Hc=co.data,ys=co.selected,fc=ys===void 0?!0:ys,xo=co.tooltip,Wl=xo===void 0?!0:xo,Xu=Hc||[],pl=fc,wl=Wl,Mf=$r;Xu=Xu||[],pl=pl||!0,wl=wl||!0;var Fa,li={x:{type:"cat",range:[0,1]},y:{min:0}};(Zt||Zt===0)&&(pl=!1,wl=!1,Fa=function(rh){return rh==="\u5360\u6BD4"?Kt||"rgba(24, 144, 255, 0.85)":"#F0F2F5"},Xu=[{x:"\u5360\u6BD4",y:parseFloat("".concat(Zt))},{x:"\u53CD\u6BD4",y:100-parseFloat("".concat(Zt))}]);var lh=["x*percent",function(hc,rh){return{name:hc,value:"".concat((rh*100).toFixed(2),"%")}}],th=[12,0,12,0],Dh=new Te.DataView;return Dh.source(Xu).transform({type:"percent",field:"y",dimension:"x",as:"percent"}),Se.a.createElement("div",{ref:this.handleRoot,className:ri,style:Qe},Se.a.createElement(me.a,{maxFontSize:25},Se.a.createElement("div",{className:st.chart},Se.a.createElement(Ye.Chart,{scale:li,height:ke,forceFit:De,data:Dh,padding:th,animate:Or,onGetG2Instance:this.getG2Instance},!!wl&&Se.a.createElement(Ye.Tooltip,{showTitle:!1}),Se.a.createElement(Ye.Coord,{type:"theta",innerRadius:rr}),Se.a.createElement(Ye.Geom,{style:{lineWidth:on,stroke:"#fff"},tooltip:wl?lh:void 0,type:"intervalStack",position:"percent",color:["x",Zt||Zt===0?Fa:Mf],selected:pl})),(k||Q)&&Se.a.createElement("div",{className:st.total},k&&Se.a.createElement("h4",{className:"pie-sub-title"},k),Q&&Se.a.createElement("div",{className:"pie-stat"},typeof Q=="function"?Q():Q)))),rt&&Se.a.createElement("ul",{className:st.legend},ca.map(function(hc,rh){return Se.a.createElement("li",{key:hc.x,onClick:function(){return I.handleLegendClick(hc,rh)}},Se.a.createElement("span",{className:st.dot,style:{backgroundColor:hc.checked?hc.color:"#aaa"}}),Se.a.createElement("span",{className:st.legendTitle},hc.x),Se.a.createElement(Ae.a,{type:"vertical"}),Se.a.createElement("span",{className:st.percent},"".concat((Number.isNaN(hc.percent)?0:hc.percent*100).toFixed(2),"%")),Se.a.createElement("span",{className:st.value},B?B(hc.y):hc.y))})))}}]),c}(be.Component),gt=Ie()(Oe),C=o("ODXe"),R={tagCloud:"tagCloud___Blez5"},q="https://gw.alipayobjects.com/zos/rmsportal/gWyeGLCdFFRavBGIDzWk.png",fe=function(w){Object(ee.a)(c,w);var b=Object(ce.a)(c);function c(){var d;Object(D.a)(this,c);for(var y=arguments.length,I=new Array(y),te=0;te<y;te++)I[te]=arguments[te];return d=b.call.apply(b,[this].concat(I)),d.state={dv:null,height:0,width:0},d.requestRef=0,d.isUnmount=!1,d.root=void 0,d.imageMask=void 0,d.resize=function(){d.requestRef=requestAnimationFrame(function(){d.renderChart(d.props)})},d.saveRootRef=function(B){d.root=B},d.initTagCloud=function(){function B(k){return Object(Qt.a)(Object(Qt.a)({},k.style),{},{fillOpacity:k.opacity,fontSize:k.origin._origin.size,rotate:k.origin._origin.rotate,text:k.origin._origin.text,textAlign:"center",fontFamily:k.origin._origin.font,fill:k.color,textBaseline:"Alphabetic"})}Ye.Shape.registerShape("point","cloud",{drawShape:function(Q,We){var rt=B(Q);return We.addShape("text",{attrs:Object(Qt.a)(Object(Qt.a)({},rt),{},{x:Q.x,y:Q.y})})}})},d.renderChart=qt()(function(B){var k=B||d.props,Q=k.data,We=k.height;if(Q.length<1||!d.root)return;var rt=We,Pe=d.root.offsetWidth,Qe=function(){var ke=new pe.a.View().source(Q),vt=ke.range("value"),De=Object(C.a)(vt,2),Zt=De[0],Kt=De[1];if(ke.transform({type:"tag-cloud",fields:["name","value"],imageMask:d.imageMask,font:"Verdana",size:[Pe,rt],padding:0,timeInterval:5e3,rotate:function(){return 0},fontSize:function(rr){var mr=Math.pow((rr.value-Zt)/(Kt-Zt),2);return mr*(17.5-5)+5}}),d.isUnmount)return;d.setState({dv:ke,width:Pe,height:rt})};d.imageMask?Qe():(d.imageMask=new Image,d.imageMask.crossOrigin="",d.imageMask.src=q,d.imageMask.onload=Qe)},200),d}return Object(J.a)(c,[{key:"componentDidMount",value:function(){var y=this;requestAnimationFrame(function(){y.initTagCloud(),y.renderChart(y.props)}),window.addEventListener("resize",this.resize,{passive:!0})}},{key:"componentDidUpdate",value:function(y){var I=this.props.data;y&&JSON.stringify(y.data)!==JSON.stringify(I)&&this.renderChart(this.props)}},{key:"componentWillUnmount",value:function(){this.isUnmount=!0,window.cancelAnimationFrame(this.requestRef),window.removeEventListener("resize",this.resize)}},{key:"render",value:function(){var y=this.props,I=y.className,te=y.height,B=this.state,k=B.dv,Q=B.width,We=B.height;return Se.a.createElement("div",{className:Ge()(R.tagCloud,I),style:{width:"100%",height:te},ref:this.saveRootRef},k&&Se.a.createElement(Ye.Chart,{width:Q,height:We,data:k,padding:0,scale:{x:{nice:!1},y:{nice:!1}}},Se.a.createElement(Ye.Tooltip,{showTitle:!1}),Se.a.createElement(Ye.Coord,{reflect:"y"}),Se.a.createElement(Ye.Geom,{type:"point",position:"x*y",color:"text",shape:"cloud",tooltip:["text*value",function(Pe,Qe){return{name:Pe,value:Qe}}]})))}}]),c}(be.Component),He=Ie()(fe),et={waterWave:"waterWave___hvLJA",text:"text___3asSo",waterWaveCanvasWrapper:"waterWaveCanvasWrapper___2ndFj"},_t=function(w){Object(ee.a)(c,w);var b=Object(ce.a)(c);function c(){var d;Object(D.a)(this,c);for(var y=arguments.length,I=new Array(y),te=0;te<y;te++)I[te]=arguments[te];return d=b.call.apply(b,[this].concat(I)),d.state={radio:1},d.timer=0,d.root=null,d.node=null,d.resize=function(){if(d.root){var B=d.props.height,k=B===void 0?1:B,Q=d.root.parentNode,We=Q.offsetWidth;d.setState({radio:We<k?We/k:1})}},d}return Object(J.a)(c,[{key:"componentDidMount",value:function(){var y=this;this.renderChart(),this.resize(),window.addEventListener("resize",function(){requestAnimationFrame(function(){return y.resize()})},{passive:!0})}},{key:"componentDidUpdate",value:function(y){var I=this.props.percent;y.percent!==I&&this.renderChart("update")}},{key:"componentWillUnmount",value:function(){cancelAnimationFrame(this.timer),this.node&&(this.node.innerHTML=""),window.removeEventListener("resize",this.resize)}},{key:"renderChart",value:function(y){var I=this.props,te=I.percent,B=I.color,k=B===void 0?"#1890FF":B,Q=te/100,We=this;if(cancelAnimationFrame(this.timer),!this.node||Q!==0&&!Q)return;var rt=this.node,Pe=rt.getContext("2d");if(!Pe)return;var Qe=rt.width,Tt=rt.height,ke=Qe/2,vt=2,De=ke-vt;Pe.beginPath(),Pe.lineWidth=vt*2;for(var Zt=Qe-vt,Kt=Zt/8,dr=.2,rr=dr,mr=vt,Or=0,$r=0,Bn=.005,on=[],Dn=ke-vt,ca=-(Math.PI/2),Na=!0,ri=ca;ri<ca+2*Math.PI;ri+=1/(8*Math.PI))on.push([ke+Dn*Math.cos(ri),ke+Dn*Math.sin(ri)]);var co=on.shift();Pe.strokeStyle=k,Pe.moveTo(co[0],co[1]);function Hc(){if(!Pe)return;Pe.beginPath(),Pe.save();for(var fc=[],xo=mr;xo<=mr+Zt;xo+=20/Zt){var Wl=Or+(mr+xo)/Kt,Xu=Math.sin(Wl)*rr,pl=xo,wl=2*De*(1-$r)+(ke-De)-Kt*Xu;Pe.lineTo(pl,wl),fc.push([pl,wl])}var Mf=fc.shift();Pe.lineTo(mr+Zt,Tt),Pe.lineTo(mr,Tt),Pe.lineTo(Mf[0],Mf[1]);var Fa=Pe.createLinearGradient(0,0,0,Tt);Fa.addColorStop(0,"#ffffff"),Fa.addColorStop(1,k),Pe.fillStyle=Fa,Pe.fill(),Pe.restore()}function ys(){if(!Pe)return;if(Pe.clearRect(0,0,Qe,Tt),Na&&y!=="update")if(on.length){var fc=on.shift();Pe.lineTo(fc[0],fc[1]),Pe.stroke()}else Na=!1,Pe.lineTo(co[0],co[1]),Pe.stroke(),on=[],Pe.globalCompositeOperation="destination-over",Pe.beginPath(),Pe.lineWidth=vt,Pe.arc(ke,ke,Dn,0,2*Math.PI,!0),Pe.beginPath(),Pe.save(),Pe.arc(ke,ke,ke-3*vt,0,2*Math.PI,!0),Pe.restore(),Pe.clip(),Pe.fillStyle=k;else{if(Q>=.85){if(rr>dr/4){var xo=dr*.01;rr-=xo}}else if(Q<=.1){if(rr<dr*1.5){var Wl=dr*.01;rr+=Wl}}else{if(rr<=dr){var Xu=dr*.01;rr+=Xu}if(rr>=dr){var pl=dr*.01;rr-=pl}}Q-$r>0&&($r+=Bn),Q-$r<0&&($r-=Bn),Or+=.07,Hc()}We.timer=requestAnimationFrame(ys)}ys()}},{key:"render",value:function(){var y=this,I=this.state.radio,te=this.props,B=te.percent,k=te.title,Q=te.height,We=Q===void 0?1:Q;return Se.a.createElement("div",{className:et.waterWave,ref:function(Pe){return y.root=Pe},style:{transform:"scale(".concat(I,")")}},Se.a.createElement("div",{style:{width:We,height:We,overflow:"hidden"}},Se.a.createElement("canvas",{className:et.waterWaveCanvasWrapper,ref:function(Pe){return y.node=Pe},width:We*2,height:We*2})),Se.a.createElement("div",{className:et.text,style:{width:We}},k&&Se.a.createElement("span",null,k),Se.a.createElement("h4",null,B,"%")))}}]),c}(be.Component),ot=Ie()(_t),Ut=o("o0o1"),K=o.n(Ut),qe=o("HaE+"),ae=Object(be.createContext)({});function tt(){return Object(be.useContext)(ae)}var kt=o("8ml+"),pr=o("lwsE"),Ke=o.n(pr),xt=o("W8MJ"),bt=o.n(xt),Et=o("7W2i"),Fe=o.n(Et),pt=o("a1gu"),yt=o.n(pt),Ht=o("Nsbk"),hr=o.n(Ht),Zr=o("lSNA"),yr=o.n(Zr),Vn=o("yG8O"),zn=o.n(Vn),oa=o("U+yc"),$n=o.n(oa),Kn=o("1ABj"),Cn=o("h1nZ"),z,W,le,xe,ut,Ot;function Bt(w,b){var c=Object.keys(w);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(w);b&&(d=d.filter(function(y){return Object.getOwnPropertyDescriptor(w,y).enumerable})),c.push.apply(c,d)}return c}function Ze(w){for(var b=1;b<arguments.length;b++){var c=arguments[b]!=null?arguments[b]:{};b%2?Bt(Object(c),!0).forEach(function(d){yr()(w,d,c[d])}):Object.getOwnPropertyDescriptors?Object.defineProperties(w,Object.getOwnPropertyDescriptors(c)):Bt(Object(c)).forEach(function(d){Object.defineProperty(w,d,Object.getOwnPropertyDescriptor(c,d))})}return w}var Rt=(z=Object(Cn.lazyInject)(Cn.TYPES.ILogService),W=Object(Cn.lazyInject)(Cn.TYPES.IGlobalConfigService),le=(Ot=function(){function w(b){Ke()(this,w),zn()(this,"logger",xe,this),zn()(this,"configService",ut,this),this.config=void 0,this.config=b}return bt()(w,[{key:"setContainer",value:function(c,d){c.bind(Cn.TYPES.MapConfig).toConstantValue(Ze(Ze({},this.config),{},{id:d})),c.bind(Cn.TYPES.IMapService).to(this.getServiceConstructor()).inSingletonScope()}},{key:"getServiceConstructor",value:function(){throw new Error("Method not implemented.")}}]),w}(),Ot),xe=$n()(le.prototype,"logger",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ut=$n()(le.prototype,"configService",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),le),lr=o("QILm"),Ur=o.n(lr),Gr=o("yXPU"),cr=o.n(Gr),Br=o("hi0z"),wn=o.n(Br),fn=o("Hel2"),tr=o("IOcx"),rn=o("4cb6"),dn={dark:"amap://styles/2a09079c3daac9420ee53b67307a8006?isPublic=true",light:"amap://styles/1fd9f8ef9751298f11f5c56968312c70?isPublic=true",normal:"amap://styles/normal",blank:"amap://styles/07c17002b38775b32a7a76c66cf90e99?isPublic=true"},En=o("J4zp"),bn=o.n(En),gn=Math.PI/180,Mn=function(){function w(){Ke()(this,w),this.projectionMatrix=tr.b.create(),this.viewMatrix=tr.b.create(),this.viewProjectionMatrix=tr.b.create(),this.ViewProjectionMatrixUncentered=tr.b.create(),this.viewUncenteredMatrix=tr.b.create(),this.zoom=void 0,this.center=void 0}return bt()(w,[{key:"syncWithMapCamera",value:function(c){var d=c.zoom,y=d===void 0?1:d,I=c.pitch,te=I===void 0?0:I,B=c.bearing,k=B===void 0?0:B,Q=c.center,We=Q===void 0?[0,0]:Q,rt=c.offsetOrigin,Pe=rt===void 0?[0,0]:rt,Qe=c.cameraHeight,Tt=Qe===void 0?1:Qe,ke=c.aspect,vt=ke===void 0?1:ke,De=c.near,Zt=De===void 0?.1:De,Kt=c.far,dr=Kt===void 0?1e3:Kt,rr=c.fov,mr=rr===void 0?0:rr;this.zoom=y,this.center=We;var Or=te*gn,$r=(360-k)*gn;tr.b.perspective(this.projectionMatrix,mr,vt,Zt,dr);var Bn=tr.d.fromValues(Tt*Math.sin(Or)*Math.sin($r),-Tt*Math.sin(Or)*Math.cos($r),Tt*Math.cos(Or)),on=tr.d.fromValues(-Math.cos(Or)*Math.sin($r),Math.cos(Or)*Math.cos($r),Math.sin(Or));tr.b.lookAt(this.viewMatrix,Bn,tr.d.fromValues(0,0,0),on),this.viewUncenteredMatrix=tr.b.clone(this.viewMatrix),tr.b.translate(this.viewMatrix,this.viewMatrix,tr.d.fromValues(-Pe[0],Pe[1],0)),tr.b.multiply(this.viewProjectionMatrix,this.projectionMatrix,this.viewMatrix),tr.b.multiply(this.ViewProjectionMatrixUncentered,this.projectionMatrix,this.viewMatrix)}},{key:"getZoom",value:function(){return this.zoom}},{key:"getZoomScale",value:function(){return 524288}},{key:"getCenter",value:function(){var c=bn()(this.center,2),d=c[0],y=c[1];return[d,y]}},{key:"getProjectionMatrix",value:function(){return this.projectionMatrix}},{key:"getViewMatrix",value:function(){return this.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewUncenteredMatrix}},{key:"getViewProjectionMatrix",value:function(){return this.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.ViewProjectionMatrixUncentered}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(c,d){var y=85.0511287798,I=Math.max(Math.min(y,c[1]),-y),te=256<<20,B=Math.PI/180,k=c[0]*B,Q=I*B;Q=Math.log(Math.tan(Math.PI/4+Q/2));var We=.5/Math.PI,rt=.5,Pe=-.5/Math.PI;return B=.5,k=te*(We*k+rt)-215440491,Q=-(te*(Pe*Q+B)-106744817),[k,Q]}}]),w}(),Ga,ga,Ma,Ia,Wi,da,vi,ya,ba,ha,wi,is,Xi,Xo;function Du(w,b){var c=Object.keys(w);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(w);b&&(d=d.filter(function(y){return Object.getOwnPropertyDescriptor(w,y).enumerable})),c.push.apply(c,d)}return c}function Ha(w){for(var b=1;b<arguments.length;b++){var c=arguments[b]!=null?arguments[b]:{};b%2?Du(Object(c),!0).forEach(function(d){yr()(w,d,c[d])}):Object.getOwnPropertyDescriptors?Object.defineProperties(w,Object.getOwnPropertyDescriptors(c)):Du(Object(c)).forEach(function(d){Object.defineProperty(w,d,Object.getOwnPropertyDescriptor(c,d))})}return w}o("BGjm")(`/* @antv/l7-maps */
.amap-logo{
 display: none !important;
}
`);var Oi=0;window.forceWebGL=!0;var Jo="15cd8a57710d40c9b7c0e3cc120f1200",ui="1.4.15",Yi="amap-script",Oo=!1,Za=[],oo=12,so=(Ga=Object(rn.injectable)(),ga=Object(rn.inject)(Cn.TYPES.IGlobalConfigService),Ma=Object(rn.inject)(Cn.TYPES.ILogService),Ia=Object(rn.inject)(Cn.TYPES.MapConfig),Wi=Object(rn.inject)(Cn.TYPES.ICoordinateSystemService),da=Object(rn.inject)(Cn.TYPES.IEventEmitter),Ga(vi=(ya=(Xo=function(){function w(){var b=this;Ke()(this,w),this.map=void 0,zn()(this,"configService",ba,this),zn()(this,"logger",ha,this),zn()(this,"config",wi,this),zn()(this,"coordinateSystemService",is,this),zn()(this,"eventEmitter",Xi,this),this.markerContainer=void 0,this.$mapContainer=void 0,this.viewport=void 0,this.cameraChangedCallback=void 0,this.handleCameraChanged=function(c){var d=c.camera,y=d.fov,I=d.near,te=d.far,B=d.height,k=d.pitch,Q=d.rotation,We=d.aspect,rt=d.position,Pe=b.getCenter(),Qe=Pe.lng,Tt=Pe.lat;b.cameraChangedCallback&&(b.viewport.syncWithMapCamera({aspect:We,bearing:360-Q,far:te,fov:y,cameraHeight:B,near:I,pitch:k,zoom:b.map.getZoom()-1,center:[Qe,Tt],offsetOrigin:[rt.x,rt.y]}),b.viewport.getZoom()>oo?b.coordinateSystemService.setCoordinateSystem(Cn.CoordinateSystem.P20_OFFSET):b.coordinateSystemService.setCoordinateSystem(Cn.CoordinateSystem.P20),b.cameraChangedCallback(b.viewport))}}return bt()(w,[{key:"addMarkerContainer",value:function(){var c=this.map.getContainer();if(c!==null){var d=c.getElementsByClassName("amap-maps")[0];this.markerContainer=fn.a.create("div","l7-marker-container",d)}}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"on",value:function(c,d){Cn.MapServiceEvent.indexOf(c)!==-1?this.eventEmitter.on(c,d):this.map.on(c,d)}},{key:"off",value:function(c,d){Cn.MapServiceEvent.indexOf(c)!==-1?this.eventEmitter.off(c,d):this.map.off(c,d)}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getMapCanvasContainer",value:function(){var c;return(c=this.map.getContainer())===null||c===void 0?void 0:c.getElementsByClassName("amap-maps")[0]}},{key:"getSize",value:function(){var c=this.map.getSize();return[c.getWidth(),c.getHeight()]}},{key:"getType",value:function(){return"amap"}},{key:"getZoom",value:function(){return this.map.getZoom()-1}},{key:"setZoom",value:function(c){return this.map.setZoom(c)}},{key:"getCenter",value:function(){var c=this.map.getCenter();return{lng:c.getLng(),lat:c.getLat()}}},{key:"setCenter",value:function(c){this.map.setCenter(c)}},{key:"getPitch",value:function(){return this.map.getPitch()}},{key:"getRotation",value:function(){return 360-this.map.getRotation()}},{key:"getBounds",value:function(){var c=this.map.getBounds().toBounds(),d=c.getNorthEast(),y=c.getSouthWest(),I=this.getCenter(),te=I.lng>d.getLng()||I.lng<y.getLng()?180-d.getLng():d.getLng(),B=I.lng<y.getLng()?y.getLng()-180:y.getLng();return[[B,y.getLat()],[te,d.getLat()]]}},{key:"getMinZoom",value:function(){var c=this.map.get("zooms");return c[0]-1}},{key:"getMaxZoom",value:function(){var c=this.map.get("zooms");return c[1]-1}},{key:"setRotation",value:function(c){return this.map.setRotation(c)}},{key:"setPitch",value:function(c){return this.map.setPitch(c)}},{key:"zoomIn",value:function(){this.map.zoomIn()}},{key:"zoomOut",value:function(){this.map.zoomOut()}},{key:"panTo",value:function(c){this.map.panTo(c)}},{key:"panBy",value:function(c){this.map.panTo(c)}},{key:"fitBounds",value:function(c){this.map.setBounds(new AMap.Bounds([c[0][0],c[0][1],c[1][0],c[1][1]]))}},{key:"setZoomAndCenter",value:function(c,d){this.map.setZoomAndCenter(c,d)}},{key:"setMapStyle",value:function(c){this.map.setMapStyle(this.getMapStyle(c))}},{key:"setMapStatus",value:function(c){this.map.setStatus(c)}},{key:"pixelToLngLat",value:function(c){var d=this.map.pixelToLngLat(new AMap.Pixel(c[0],c[1]));return{lng:d.getLng(),lat:d.getLat()}}},{key:"lngLatToPixel",value:function(c){var d=this.map.lnglatToPixel(new AMap.LngLat(c[0],c[1]));return{x:d.getX(),y:d.getY()}}},{key:"containerToLngLat",value:function(c){var d=new AMap.Pixel(c[0],c[1]),y=this.map.containerToLngLat(d);return{lng:y==null?void 0:y.getLng(),lat:y==null?void 0:y.getLat()}}},{key:"lngLatToContainer",value:function(c){var d=new AMap.LngLat(c[0],c[1]),y=this.map.lngLatToContainer(d);return{x:y.getX(),y:y.getY()}}},{key:"lngLatToMercator",value:function(c,d){return{x:0,y:0,z:0}}},{key:"getModelMatrix",value:function(c,d,y){var I=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[1,1,1],te=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{x:0,y:0,z:0},B=this.viewport.projectFlat(c),k=tr.b.create();return tr.b.translate(k,k,tr.d.fromValues(B[0],B[1],d)),tr.b.scale(k,k,tr.d.fromValues(I[0],I[1],I[2])),tr.b.rotateX(k,k,y[0]),tr.b.rotateY(k,k,y[1]),tr.b.rotateZ(k,k,y[2]),k}},{key:"init",value:function(){var b=cr()(K.a.mark(function d(){var y=this,I,te,B,k,Q,We,rt,Pe,Qe,Tt,ke,vt,De,Zt;return K.a.wrap(function(dr){for(;;)switch(dr.prev=dr.next){case 0:return I=this.config,te=I.id,B=I.style,k=B===void 0?"light":B,Q=I.minZoom,We=Q===void 0?0:Q,rt=I.maxZoom,Pe=rt===void 0?18:rt,Qe=I.token,Tt=Qe===void 0?Jo:Qe,ke=I.mapInstance,vt=I.plugin,De=vt===void 0?[]:vt,Zt=Ur()(I,["id","style","minZoom","maxZoom","token","mapInstance","plugin"]),dr.next=3,new Promise(function(rr){var mr=function(){if(ke)y.map=ke,y.$mapContainer=y.map.getContainer(),setTimeout(function(){y.map.on("camerachange",y.handleCameraChanged),rr()},30);else{y.$mapContainer=y.creatAmapContainer(te);var $r=new AMap.Map(y.$mapContainer,Ha({mapStyle:y.getMapStyle(k),zooms:[We,Pe],viewMode:"3D"},Zt));$r.on("camerachange",y.handleCameraChanged),y.map=$r,setTimeout(function(){rr()},10)}};!Oo&&!ke?(Tt===Jo&&y.logger.warn(y.configService.getSceneWarninfo("MapToken")),Oo=!0,De.push("Map3D"),wn.a.load({key:Tt,version:ui,plugins:De}).then(function(Or){mr(),Za.length&&(Za.forEach(function($r){return $r()}),Za=[])}).catch(function(Or){throw new Error(Or)})):Oo&&window.AMap||ke?mr():Za.push(mr)});case 3:this.viewport=new Mn;case 4:case"end":return dr.stop()}},d,this)}));function c(){return b.apply(this,arguments)}return c}()},{key:"exportMap",value:function(c){var d,y=(d=this.getContainer())===null||d===void 0?void 0:d.getElementsByClassName("amap-layer")[0],I=c==="jpg"?y==null?void 0:y.toDataURL("image/jpeg"):y==null?void 0:y.toDataURL("image/png");return I}},{key:"emit",value:function(c){for(var d,y=arguments.length,I=new Array(y>1?y-1:0),te=1;te<y;te++)I[te-1]=arguments[te];(d=this.eventEmitter).emit.apply(d,[c].concat(I))}},{key:"once",value:function(c){for(var d,y=arguments.length,I=new Array(y>1?y-1:0),te=1;te<y;te++)I[te-1]=arguments[te];(d=this.eventEmitter).once.apply(d,[c].concat(I))}},{key:"destroy",value:function(){this.map.destroy(),delete window.initAMap;var c=document.getElementById(Yi);c&&document.head.removeChild(c)}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"onCameraChanged",value:function(c){this.cameraChangedCallback=c}},{key:"getMapStyle",value:function(c){return dn[c]?dn[c]:c}},{key:"creatAmapContainer",value:function(c){var d=c;typeof c=="string"&&(d=document.getElementById(c));var y=document.createElement("div");return y.style.cssText+=`
      position: absolute;
      top: 0;
      height: 100%;
      width: 100%;
    `,y.id="l7_amap_div"+Oi++,d.appendChild(y),y}}]),w}(),Xo),ba=$n()(ya.prototype,"configService",[ga],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ha=$n()(ya.prototype,"logger",[Ma],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wi=$n()(ya.prototype,"config",[Ia],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),is=$n()(ya.prototype,"coordinateSystemService",[Wi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xi=$n()(ya.prototype,"eventEmitter",[da],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ya))||vi);function bu(w){var b=Qo();return function(){var d=hr()(w),y;if(b){var I=hr()(this).constructor;y=Reflect.construct(d,arguments,I)}else y=d.apply(this,arguments);return yt()(this,y)}}function Qo(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(w){return!1}}var Xl=function(w){Fe()(c,w);var b=bu(c);function c(){return Ke()(this,c),b.apply(this,arguments)}return bt()(c,[{key:"getServiceConstructor",value:function(){return so}}]),c}(Rt);function js(w,b){var c=Object.keys(w);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(w);b&&(d=d.filter(function(y){return Object.getOwnPropertyDescriptor(w,y).enumerable})),c.push.apply(c,d)}return c}function ho(w){for(var b=1;b<arguments.length;b++){var c=arguments[b]!=null?arguments[b]:{};b%2?js(Object(c),!0).forEach(function(d){Vt(w,d,c[d])}):Object.getOwnPropertyDescriptors?Object.defineProperties(w,Object.getOwnPropertyDescriptors(c)):js(Object(c)).forEach(function(d){Object.defineProperty(w,d,Object.getOwnPropertyDescriptor(c,d))})}return w}function Vt(w,b,c){return b in w?Object.defineProperty(w,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):w[b]=c,w}function Re(w,b){return Gn(w)||Tn(w,b)||vr(w,b)||Dt()}function Dt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vr(w,b){if(!w)return;if(typeof w=="string")return en(w,b);var c=Object.prototype.toString.call(w).slice(8,-1);if(c==="Object"&&w.constructor&&(c=w.constructor.name),c==="Map"||c==="Set")return Array.from(w);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return en(w,b)}function en(w,b){(b==null||b>w.length)&&(b=w.length);for(var c=0,d=new Array(b);c<b;c++)d[c]=w[c];return d}function Tn(w,b){if(typeof Symbol=="undefined"||!(Symbol.iterator in Object(w)))return;var c=[],d=!0,y=!1,I=void 0;try{for(var te=w[Symbol.iterator](),B;!(d=(B=te.next()).done)&&!(c.push(B.value),b&&c.length===b);d=!0);}catch(k){y=!0,I=k}finally{try{!d&&te.return!=null&&te.return()}finally{if(y)throw I}}return c}function Gn(w){if(Array.isArray(w))return w}var Mi=Se.a.memo(function(w){var b=w.style,c=w.className,d=w.map,y=w.option,I=w.onSceneLoaded,te=Object(be.createRef)(),B=Object(be.useState)(),k=Re(B,2),Q=k[0],We=k[1];return Object(be.useEffect)(function(){var rt=new kt.Scene(ho(ho({id:te.current},y),{},{map:new Xl(d)}));return rt.on("loaded",function(){We(rt),I&&I(rt)}),function(){rt.destroy()}},[]),Object(be.useEffect)(function(){Q&&d.style&&Q.setMapStyle(d.style)},[JSON.stringify(d.style)]),Object(be.useEffect)(function(){Q&&d.zoom&&Q.setZoom(d.zoom)},[d.zoom]),Object(be.useEffect)(function(){Q&&d.center&&Q.setCenter(d.center)},[JSON.stringify(d.center)]),Object(be.useEffect)(function(){Q&&d.pitch&&Q.setPitch(d.pitch)},[d.pitch]),Object(be.useEffect)(function(){Q&&d.rotation&&Q.setRotation(d.rotation)},[d.rotation]),Se.a.createElement(ae.Provider,{value:Q},Object(be.createElement)("div",{ref:te,style:b,className:c},Q&&w.children))}),po=Mi,mo=o("4ZJM"),Mo=o.n(mo),Nu=o("md7G"),Ol=o("foSv"),Ts=o("JX7q"),pc=o("bl9R");function xu(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function Po(w,b){var c=pc.transformMat4([],b,w);return pc.scale(c,c,1/c[3]),c}function ku(w,b){var c=w%b;return c<0?b+c:c}function _o(w,b,c){return c*b+(1-c)*w}var zi=o("ZaHm"),Ys=o("ZxFD"),Ks=o("n+fv");function Fs(w,b){if(!w)throw new Error(b||"viewport-mercator-project: assertion failed.")}var Ii=Math.PI,Gi=Ii/4,_s=Ii/180,ml=180/Ii,$u=512,It=4003e4,fr=1.5;function Pr(w){return Math.pow(2,w)}function Wn(w){return Math.log2(w)}function Ya(w,b){var c=Object(C.a)(w,2),d=c[0],y=c[1];Fs(Number.isFinite(d)&&Number.isFinite(b)),Fs(Number.isFinite(y)&&y>=-90&&y<=90,"invalid latitude"),b*=$u;var I=d*_s,te=y*_s,B=b*(I+Ii)/(2*Ii),k=b*(Ii-Math.log(Math.tan(Gi+te*.5)))/(2*Ii);return[B,k]}function xi(w,b){var c=Object(C.a)(w,2),d=c[0],y=c[1];b*=$u;var I=d/b*(2*Ii)-Ii,te=2*(Math.atan(Math.exp(Ii-y/b*(2*Ii)))-Gi);return[I*ml,te*ml]}function Ki(w){var b=w.latitude;Fs(Number.isFinite(b));var c=Math.cos(b*_s);return Wn(It*c)-9}function Ka(w){var b=w.latitude,c=w.longitude,d=w.zoom,y=w.scale,I=w.highPrecision,te=I===void 0?!1:I;y=y!==void 0?y:Pr(d),Fs(Number.isFinite(b)&&Number.isFinite(c)&&Number.isFinite(y));var B={},k=$u*y,Q=Math.cos(b*_s),We=k/360,rt=We/Q,Pe=k/It/Q;if(B.pixelsPerMeter=[Pe,-Pe,Pe],B.metersPerPixel=[1/Pe,-1/Pe,1/Pe],B.pixelsPerDegree=[We,-rt,Pe],B.degreesPerPixel=[1/We,-1/rt,1/Pe],te){var Qe=_s*Math.tan(b*_s)/Q,Tt=We*Qe/2,ke=k/It*Qe,vt=ke/rt*Pe;B.pixelsPerDegree2=[0,-Tt,ke],B.pixelsPerMeter2=[vt,0,vt]}return B}function Di(w,b){var c=Object(C.a)(w,3),d=c[0],y=c[1],I=c[2],te=Object(C.a)(b,3),B=te[0],k=te[1],Q=te[2],We=1,rt=Ka({longitude:d,latitude:y,scale:We,highPrecision:!0}),Pe=rt.pixelsPerMeter,Qe=rt.pixelsPerMeter2,Tt=Ya(w,We);Tt[0]+=B*(Pe[0]+Qe[0]*k),Tt[1]+=k*(Pe[1]+Qe[1]*k);var ke=xi(Tt,We),vt=(I||0)+(Q||0);return Number.isFinite(I)||Number.isFinite(Q)?[ke[0],ke[1],vt]:ke}function Yo(w){var b=w.height,c=w.pitch,d=w.bearing,y=w.altitude,I=w.center,te=I===void 0?null:I,B=w.flipY,k=B===void 0?!1:B,Q=xu();return zi.translate(Q,Q,[0,0,-y]),zi.scale(Q,Q,[1,1,1/b]),zi.rotateX(Q,Q,-c*_s),zi.rotateZ(Q,Q,d*_s),k&&zi.scale(Q,Q,[1,-1,1]),te&&zi.translate(Q,Q,Ks.negate([],te)),Q}function Ps(w){var b=w.width,c=w.height,d=w.altitude,y=d===void 0?fr:d,I=w.pitch,te=I===void 0?0:I,B=w.nearZMultiplier,k=B===void 0?1:B,Q=w.farZMultiplier,We=Q===void 0?1:Q,rt=te*_s,Pe=Math.atan(.5/y),Qe=Math.sin(Pe)*y/Math.sin(Math.PI/2-rt-Pe),Tt=Math.cos(Math.PI/2-rt)*Qe+y;return{fov:2*Math.atan(c/2/y),aspect:b/c,focalDistance:y,near:k,far:Tt*We}}function gi(w){var b=w.width,c=w.height,d=w.pitch,y=w.altitude,I=w.nearZMultiplier,te=w.farZMultiplier,B=Ps({width:b,height:c,altitude:y,pitch:d,nearZMultiplier:I,farZMultiplier:te}),k=B.fov,Q=B.aspect,We=B.near,rt=B.far,Pe=zi.perspective([],k,Q,We,rt);return Pe}function Ml(w,b){var c=Object(C.a)(w,3),d=c[0],y=c[1],I=c[2],te=I===void 0?0:I;return Fs(Number.isFinite(d)&&Number.isFinite(y)&&Number.isFinite(te)),Po(b,[d,y,te,1])}function $s(w,b){var c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,d=Object(C.a)(w,3),y=d[0],I=d[1],te=d[2];if(Fs(Number.isFinite(y)&&Number.isFinite(I),"invalid pixel coordinate"),Number.isFinite(te)){var B=Po(b,[y,I,te,1]);return B}var k=Po(b,[y,I,0,1]),Q=Po(b,[y,I,1,1]),We=k[2],rt=Q[2],Pe=We===rt?0:((c||0)-We)/(rt-We);return Ys.lerp([],k,Q,Pe)}var Ss=xu(),vl=function(){function w(){var b=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},c=b.width,d=b.height,y=b.viewMatrix,I=y===void 0?Ss:y,te=b.projectionMatrix,B=te===void 0?Ss:te;Object(D.a)(this,w),this.width=c||1,this.height=d||1,this.scale=1,this.pixelsPerMeter=1,this.viewMatrix=I,this.projectionMatrix=B;var k=xu();zi.multiply(k,k,this.projectionMatrix),zi.multiply(k,k,this.viewMatrix),this.viewProjectionMatrix=k;var Q=xu();zi.scale(Q,Q,[this.width/2,-this.height/2,1]),zi.translate(Q,Q,[1,-1,0]),zi.multiply(Q,Q,this.viewProjectionMatrix);var We=zi.invert(xu(),Q);if(!We)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=Q,this.pixelUnprojectionMatrix=We,this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}return Object(J.a)(w,[{key:"equals",value:function(c){return c instanceof w?c.width===this.width&&c.height===this.height&&zi.equals(c.projectionMatrix,this.projectionMatrix)&&zi.equals(c.viewMatrix,this.viewMatrix):!1}},{key:"project",value:function(c){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},y=d.topLeft,I=y===void 0?!0:y,te=this.projectPosition(c),B=Ml(te,this.pixelProjectionMatrix),k=Object(C.a)(B,2),Q=k[0],We=k[1],rt=I?We:this.height-We;return c.length===2?[Q,rt]:[Q,rt,B[2]]}},{key:"unproject",value:function(c){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},y=d.topLeft,I=y===void 0?!0:y,te=d.targetZ,B=Object(C.a)(c,3),k=B[0],Q=B[1],We=B[2],rt=I?Q:this.height-Q,Pe=te&&te*this.pixelsPerMeter,Qe=$s([k,rt,We],this.pixelUnprojectionMatrix,Pe),Tt=this.unprojectPosition(Qe),ke=Object(C.a)(Tt,3),vt=ke[0],De=ke[1],Zt=ke[2];return Number.isFinite(We)?[vt,De,Zt]:Number.isFinite(te)?[vt,De,te]:[vt,De]}},{key:"projectPosition",value:function(c){var d=this.projectFlat(c),y=Object(C.a)(d,2),I=y[0],te=y[1],B=(c[2]||0)*this.pixelsPerMeter;return[I,te,B]}},{key:"unprojectPosition",value:function(c){var d=this.unprojectFlat(c),y=Object(C.a)(d,2),I=y[0],te=y[1],B=(c[2]||0)/this.pixelsPerMeter;return[I,te,B]}},{key:"projectFlat",value:function(c){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return c}},{key:"unprojectFlat",value:function(c){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return c}}]),w}();function cu(w){var b=w.width,c=w.height,d=w.bounds,y=w.minExtent,I=y===void 0?0:y,te=w.maxZoom,B=te===void 0?24:te,k=w.padding,Q=k===void 0?0:k,We=w.offset,rt=We===void 0?[0,0]:We,Pe=Object(C.a)(d,2),Qe=Object(C.a)(Pe[0],2),Tt=Qe[0],ke=Qe[1],vt=Object(C.a)(Pe[1],2),De=vt[0],Zt=vt[1];if(Number.isFinite(Q)){var Kt=Q;Q={top:Kt,bottom:Kt,left:Kt,right:Kt}}else Fs(Number.isFinite(Q.top)&&Number.isFinite(Q.bottom)&&Number.isFinite(Q.left)&&Number.isFinite(Q.right));var dr=new Eu({width:b,height:c,longitude:0,latitude:0,zoom:0}),rr=dr.project([Tt,Zt]),mr=dr.project([De,ke]),Or=[Math.max(Math.abs(mr[0]-rr[0]),I),Math.max(Math.abs(mr[1]-rr[1]),I)],$r=[b-Q.left-Q.right-Math.abs(rt[0])*2,c-Q.top-Q.bottom-Math.abs(rt[1])*2];Fs($r[0]>0&&$r[1]>0);var Bn=$r[0]/Or[0],on=$r[1]/Or[1],Dn=(Q.right-Q.left)/2/Bn,ca=(Q.bottom-Q.top)/2/on,Na=[(mr[0]+rr[0])/2+Dn,(mr[1]+rr[1])/2+ca],ri=dr.unproject(Na),co=dr.zoom+Math.log2(Math.abs(Math.min(Bn,on)));return{longitude:ri[0],latitude:ri[1],zoom:Math.min(co,B)}}var Eu=function(w){Object(ee.a)(b,w);function b(){var c,d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},y=d.width,I=d.height,te=d.latitude,B=te===void 0?0:te,k=d.longitude,Q=k===void 0?0:k,We=d.zoom,rt=We===void 0?0:We,Pe=d.pitch,Qe=Pe===void 0?0:Pe,Tt=d.bearing,ke=Tt===void 0?0:Tt,vt=d.altitude,De=vt===void 0?1.5:vt,Zt=d.nearZMultiplier,Kt=d.farZMultiplier;Object(D.a)(this,b),y=y||1,I=I||1;var dr=Pr(rt);De=Math.max(.75,De);var rr=Ya([Q,B],dr);rr[2]=0;var mr=gi({width:y,height:I,pitch:Qe,bearing:ke,altitude:De,nearZMultiplier:Zt||1/I,farZMultiplier:Kt||1.01}),Or=Yo({height:I,center:rr,pitch:Qe,bearing:ke,altitude:De,flipY:!0});return c=Object(Nu.a)(this,Object(Ol.a)(b).call(this,{width:y,height:I,viewMatrix:Or,projectionMatrix:mr})),c.latitude=B,c.longitude=Q,c.zoom=rt,c.pitch=Qe,c.bearing=ke,c.altitude=De,c.scale=dr,c.center=rr,c.pixelsPerMeter=Ka(Object(Ts.a)(Object(Ts.a)(c))).pixelsPerMeter[2],Object.freeze(Object(Ts.a)(Object(Ts.a)(c))),c}return Object(J.a)(b,[{key:"projectFlat",value:function(d){var y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return Ya(d,y)}},{key:"unprojectFlat",value:function(d){var y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return xi(d,y)}},{key:"getMapCenterByLngLatPosition",value:function(d){var y=d.lngLat,I=d.pos,te=$s(I,this.pixelUnprojectionMatrix),B=Ya(y,this.scale),k=Ys.add([],B,Ys.negate([],te)),Q=Ys.add([],this.center,k);return xi(Q,this.scale)}},{key:"getLocationAtPoint",value:function(d){var y=d.lngLat,I=d.pos;return this.getMapCenterByLngLatPosition({lngLat:y,pos:I})}},{key:"fitBounds",value:function(d){var y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},I=this.width,te=this.height,B=cu(Object.assign({width:I,height:te,bounds:d},y)),k=B.longitude,Q=B.latitude,We=B.zoom;return new b({width:I,height:te,longitude:k,latitude:Q,zoom:We})}}]),b}(vl),fu=function(){function w(){Ke()(this,w),this.viewport=void 0}return bt()(w,[{key:"syncWithMapCamera",value:function(c){var d=c.center,y=c.zoom,I=c.pitch,te=c.bearing,B=c.viewportHeight,k=c.viewportWidth;this.viewport=new Eu({width:k,height:B,longitude:d&&d[0],latitude:d&&d[1],zoom:y,pitch:I,bearing:te})}},{key:"getZoom",value:function(){return this.viewport.zoom}},{key:"getZoomScale",value:function(){return Math.pow(2,this.getZoom())}},{key:"getCenter",value:function(){return[this.viewport.longitude,this.viewport.latitude]}},{key:"getProjectionMatrix",value:function(){return this.viewport.projectionMatrix}},{key:"getViewMatrix",value:function(){return this.viewport.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.viewMatrixUncentered}},{key:"getViewProjectionMatrix",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(c,d){return this.viewport.projectFlat(c,d)}}]),w}(),ju={light:"mapbox://styles/zcxduo/ck2ypyb1r3q9o1co1766dex29",dark:"mapbox://styles/zcxduo/ck241p6413s0b1cpayzldv7x7",normal:"mapbox://styles/mapbox/streets-v11",blank:{version:8,sources:{},layers:[{id:"background",type:"background",layout:{visibility:"none"}}]}},Js,Mc,hf,pi,Pc,mc,$c,gl,Jc,$i,Tu,yl,os,Lc;function vc(w,b){var c=Object.keys(w);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(w);b&&(d=d.filter(function(y){return Object.getOwnPropertyDescriptor(w,y).enumerable})),c.push.apply(c,d)}return c}function Pl(w){for(var b=1;b<arguments.length;b++){var c=arguments[b]!=null?arguments[b]:{};b%2?vc(Object(c),!0).forEach(function(d){yr()(w,d,c[d])}):Object.getOwnPropertyDescriptors?Object.defineProperties(w,Object.getOwnPropertyDescriptors(c)):vc(Object(c)).forEach(function(d){Object.defineProperty(w,d,Object.getOwnPropertyDescriptor(c,d))})}return w}o("BGjm")(`/* @antv/l7-maps */
.mapboxgl-map{font:12px/20px Helvetica Neue,Arial,Helvetica,sans-serif;overflow:hidden;position:relative;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mapboxgl-canvas{position:absolute;left:0;top:0}.mapboxgl-map:-webkit-full-screen{width:100%;height:100%}.mapboxgl-canary{background-color:salmon}.mapboxgl-canvas-container.mapboxgl-interactive,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass{cursor:-webkit-grab;cursor:grab;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.mapboxgl-canvas-container.mapboxgl-interactive.mapboxgl-track-pointer{cursor:pointer}.mapboxgl-canvas-container.mapboxgl-interactive:active,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass:active{cursor:-webkit-grabbing;cursor:grabbing}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate .mapboxgl-canvas{-ms-touch-action:pan-x pan-y;touch-action:pan-x pan-y}.mapboxgl-canvas-container.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-drag-pan .mapboxgl-canvas{-ms-touch-action:pinch-zoom;touch-action:pinch-zoom}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan .mapboxgl-canvas{-ms-touch-action:none;touch-action:none}.mapboxgl-ctrl-bottom-left,.mapboxgl-ctrl-bottom-right,.mapboxgl-ctrl-top-left,.mapboxgl-ctrl-top-right{position:absolute;pointer-events:none;z-index:2}.mapboxgl-ctrl-top-left{top:0;left:0}.mapboxgl-ctrl-top-right{top:0;right:0}.mapboxgl-ctrl-bottom-left{bottom:0;left:0}.mapboxgl-ctrl-bottom-right{right:0;bottom:0}.mapboxgl-ctrl{clear:both;pointer-events:auto;-webkit-transform:translate(0);transform:translate(0)}.mapboxgl-ctrl-top-left .mapboxgl-ctrl{margin:10px 0 0 10px;float:left}.mapboxgl-ctrl-top-right .mapboxgl-ctrl{margin:10px 10px 0 0;float:right}.mapboxgl-ctrl-bottom-left .mapboxgl-ctrl{margin:0 0 10px 10px;float:left}.mapboxgl-ctrl-bottom-right .mapboxgl-ctrl{margin:0 10px 10px 0;float:right}.mapboxgl-ctrl-group{border-radius:4px;background:#fff}.mapboxgl-ctrl-group:not(:empty){-webkit-box-shadow:0 0 2px rgba(0,0,0,.1);box-shadow:0 0 0 2px rgba(0,0,0,.1)}@media (-ms-high-contrast:active){.mapboxgl-ctrl-group:not(:empty){-webkit-box-shadow:0 0 0 2px ButtonText;box-shadow:0 0 0 2px ButtonText}}.mapboxgl-ctrl-group button{width:29px;height:29px;display:block;padding:0;outline:none;border:0;-webkit-box-sizing:border-box;box-sizing:border-box;background-color:transparent;cursor:pointer}.mapboxgl-ctrl-group button+button{border-top:1px solid #ddd}.mapboxgl-ctrl button .mapboxgl-ctrl-icon{display:block;width:100%;height:100%;background-repeat:no-repeat;background-position:50%}@media (-ms-high-contrast:active){.mapboxgl-ctrl-icon{background-color:transparent}.mapboxgl-ctrl-group button+button{border-top:1px solid ButtonText}}.mapboxgl-ctrl button::-moz-focus-inner{border:0;padding:0}.mapboxgl-ctrl-group button:focus{-webkit-box-shadow:0 0 2px 2px #0096ff;box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl button:disabled{cursor:not-allowed}.mapboxgl-ctrl button:disabled .mapboxgl-ctrl-icon{opacity:.25}.mapboxgl-ctrl button:not(:disabled):hover{background-color:rgba(0,0,0,.05)}.mapboxgl-ctrl-group button:focus:focus-visible{-webkit-box-shadow:0 0 2px 2px #0096ff;box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl-group button:focus:not(:focus-visible){-webkit-box-shadow:none;box-shadow:none}.mapboxgl-ctrl-group button:focus:first-child{border-radius:4px 4px 0 0}.mapboxgl-ctrl-group button:focus:last-child{border-radius:0 0 4px 4px}.mapboxgl-ctrl-group button:focus:only-child{border-radius:inherit}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23999'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23aaa'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-waiting .mapboxgl-ctrl-icon{-webkit-animation:mapboxgl-spin 2s linear infinite;animation:mapboxgl-spin 2s linear infinite}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23999'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23666'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}}@-webkit-keyframes mapboxgl-spin{0%{-webkit-transform:rotate(0deg)}to{-webkit-transform:rotate(1turn)}}@keyframes mapboxgl-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}a.mapboxgl-ctrl-logo{width:88px;height:23px;margin:0 0 -4px -4px;display:block;background-repeat:no-repeat;cursor:pointer;overflow:hidden;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg opacity='.3' stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cg opacity='.9' fill='%23fff'%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/g%3E%3C/svg%3E")}a.mapboxgl-ctrl-logo.mapboxgl-compact{width:23px}@media (-ms-high-contrast:active){a.mapboxgl-ctrl-logo{background-color:transparent;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cg fill='%23fff'%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/g%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){a.mapboxgl-ctrl-logo{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg stroke='%23fff' stroke-width='3' fill='%23fff'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/svg%3E")}}.mapboxgl-ctrl.mapboxgl-ctrl-attrib{padding:0 5px;background-color:hsla(0,0%,100%,.5);margin:0}@media screen{.mapboxgl-ctrl-attrib.mapboxgl-compact{min-height:20px;padding:0;margin:10px;position:relative;background-color:#fff;border-radius:3px 12px 12px 3px}.mapboxgl-ctrl-attrib.mapboxgl-compact:hover{padding:2px 24px 2px 4px;visibility:visible;margin-top:6px}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:hover,.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:hover{padding:2px 4px 2px 24px;border-radius:12px 3px 3px 12px}.mapboxgl-ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-inner{display:none}.mapboxgl-ctrl-attrib.mapboxgl-compact:hover .mapboxgl-ctrl-attrib-inner{display:block}.mapboxgl-ctrl-attrib.mapboxgl-compact:after{content:"";cursor:pointer;position:absolute;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E");background-color:hsla(0,0%,100%,.5);width:24px;height:24px;-webkit-box-sizing:border-box;box-sizing:border-box;border-radius:12px}.mapboxgl-ctrl-bottom-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;right:0}.mapboxgl-ctrl-top-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{top:0;right:0}.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{top:0;left:0}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;left:0}}@media screen and (-ms-high-contrast:active){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd' fill='%23fff'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E")}}@media screen and (-ms-high-contrast:black-on-white){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E")}}.mapboxgl-ctrl-attrib a{color:rgba(0,0,0,.75);text-decoration:none}.mapboxgl-ctrl-attrib a:hover{color:inherit;text-decoration:underline}.mapboxgl-ctrl-attrib .mapbox-improve-map{font-weight:700;margin-left:2px}.mapboxgl-attrib-empty{display:none}.mapboxgl-ctrl-scale{background-color:hsla(0,0%,100%,.75);font-size:10px;border:2px solid #333;border-top:#333;padding:0 5px;color:#333;-webkit-box-sizing:border-box;box-sizing:border-box}.mapboxgl-popup{position:absolute;top:0;left:0;display:-webkit-flex;display:-webkit-box;display:-ms-flexbox;display:flex;will-change:transform;pointer-events:none}.mapboxgl-popup-anchor-top,.mapboxgl-popup-anchor-top-left,.mapboxgl-popup-anchor-top-right{-webkit-flex-direction:column;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.mapboxgl-popup-anchor-bottom,.mapboxgl-popup-anchor-bottom-left,.mapboxgl-popup-anchor-bottom-right{-webkit-flex-direction:column-reverse;-webkit-box-orient:vertical;-webkit-box-direction:reverse;-ms-flex-direction:column-reverse;flex-direction:column-reverse}.mapboxgl-popup-anchor-left{-webkit-flex-direction:row;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row}.mapboxgl-popup-anchor-right{-webkit-flex-direction:row-reverse;-webkit-box-orient:horizontal;-webkit-box-direction:reverse;-ms-flex-direction:row-reverse;flex-direction:row-reverse}.mapboxgl-popup-tip{width:0;height:0;border:10px solid transparent;z-index:1}.mapboxgl-popup-anchor-top .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-top:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-tip{-webkit-align-self:flex-start;-ms-flex-item-align:start;align-self:flex-start;border-top:none;border-left:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-tip{-webkit-align-self:flex-end;-ms-flex-item-align:end;align-self:flex-end;border-top:none;border-right:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-bottom .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-bottom:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-tip{-webkit-align-self:flex-start;-ms-flex-item-align:start;align-self:flex-start;border-bottom:none;border-left:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-tip{-webkit-align-self:flex-end;-ms-flex-item-align:end;align-self:flex-end;border-bottom:none;border-right:none;border-top-color:#fff}.mapboxgl-popup-anchor-left .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-left:none;border-right-color:#fff}.mapboxgl-popup-anchor-right .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-right:none;border-left-color:#fff}.mapboxgl-popup-close-button{position:absolute;right:0;top:0;border:0;border-radius:0 3px 0 0;cursor:pointer;background-color:transparent}.mapboxgl-popup-close-button:hover{background-color:rgba(0,0,0,.05)}.mapboxgl-popup-content{position:relative;background:#fff;border-radius:3px;-webkit-box-shadow:0 1px 2px rgba(0,0,0,.1);box-shadow:0 1px 2px rgba(0,0,0,.1);padding:10px 10px 15px;pointer-events:auto}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-content{border-top-left-radius:0}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-content{border-top-right-radius:0}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-content{border-bottom-left-radius:0}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-content{border-bottom-right-radius:0}.mapboxgl-popup-track-pointer{display:none}.mapboxgl-popup-track-pointer *{pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.mapboxgl-map:hover .mapboxgl-popup-track-pointer{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex}.mapboxgl-map:active .mapboxgl-popup-track-pointer{display:none}.mapboxgl-marker{position:absolute;top:0;left:0;will-change:transform}.mapboxgl-user-location-dot,.mapboxgl-user-location-dot:before{background-color:#1da1f2;width:15px;height:15px;border-radius:50%}.mapboxgl-user-location-dot:before{content:"";position:absolute;-webkit-animation:mapboxgl-user-location-dot-pulse 2s infinite;animation:mapboxgl-user-location-dot-pulse 2s infinite}.mapboxgl-user-location-dot:after{border-radius:50%;border:2px solid #fff;content:"";height:19px;left:-2px;position:absolute;top:-2px;width:19px;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-shadow:0 0 3px rgba(0,0,0,.35);box-shadow:0 0 3px rgba(0,0,0,.35)}@-webkit-keyframes mapboxgl-user-location-dot-pulse{0%{-webkit-transform:scale(1);opacity:1}70%{-webkit-transform:scale(3);opacity:0}to{-webkit-transform:scale(1);opacity:0}}@keyframes mapboxgl-user-location-dot-pulse{0%{-webkit-transform:scale(1);transform:scale(1);opacity:1}70%{-webkit-transform:scale(3);transform:scale(3);opacity:0}to{-webkit-transform:scale(1);transform:scale(1);opacity:0}}.mapboxgl-user-location-dot-stale{background-color:#aaa}.mapboxgl-user-location-dot-stale:after{display:none}.mapboxgl-user-location-accuracy-circle{background-color:rgba(29,161,242,.2);width:1px;height:1px;border-radius:100%}.mapboxgl-crosshair,.mapboxgl-crosshair .mapboxgl-interactive,.mapboxgl-crosshair .mapboxgl-interactive:active{cursor:crosshair}.mapboxgl-boxzoom{position:absolute;top:0;left:0;width:0;height:0;background:#fff;border:2px dotted #202020;opacity:.5}@media print{.mapbox-improve-map{display:none}}`),window.mapboxgl=Mo.a;var Ju={mapmove:"move",camerachange:"move",zoomchange:"zoom",dragging:"drag"},Rc=0,hu=12,_u="pk.eyJ1IjoibHp4dWUiLCJhIjoiYnhfTURyRSJ9.Ugm314vAKPHBzcPmY1p4KQ",Qc=(Js=Object(rn.injectable)(),Mc=Object(rn.inject)(Cn.TYPES.MapConfig),hf=Object(rn.inject)(Cn.TYPES.IGlobalConfigService),pi=Object(rn.inject)(Cn.TYPES.ILogService),Pc=Object(rn.inject)(Cn.TYPES.ICoordinateSystemService),mc=Object(rn.inject)(Cn.TYPES.IEventEmitter),Js($c=(gl=(Lc=function(){function w(){var b=this;Ke()(this,w),this.map=void 0,zn()(this,"config",Jc,this),zn()(this,"configService",$i,this),zn()(this,"logger",Tu,this),zn()(this,"coordinateSystemService",yl,this),zn()(this,"eventEmitter",os,this),this.viewport=void 0,this.markerContainer=void 0,this.cameraChangedCallback=void 0,this.$mapContainer=void 0,this.handleCameraChanged=function(){var c=b.map.getCenter().wrap(),d=c.lat,y=c.lng;b.viewport.syncWithMapCamera({bearing:b.map.getBearing(),center:[y,d],viewportHeight:b.map.transform.height,pitch:b.map.getPitch(),viewportWidth:b.map.transform.width,zoom:b.map.getZoom(),cameraHeight:0}),b.viewport.getZoom()>hu?b.coordinateSystemService.setCoordinateSystem(Cn.CoordinateSystem.LNGLAT_OFFSET):b.coordinateSystemService.setCoordinateSystem(Cn.CoordinateSystem.LNGLAT),b.cameraChangedCallback(b.viewport)}}return bt()(w,[{key:"addMarkerContainer",value:function(){var c=this.map.getCanvasContainer();this.markerContainer=fn.a.create("div","l7-marker-container",c),this.markerContainer.setAttribute("tabindex","-1")}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"on",value:function(c,d){Cn.MapServiceEvent.indexOf(c)!==-1?this.eventEmitter.on(c,d):this.map.on(Ju[c]||c,d)}},{key:"off",value:function(c,d){this.map.off(Ju[c]||c,d)}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getMapCanvasContainer",value:function(){return this.map.getCanvasContainer()}},{key:"getSize",value:function(){var c=this.map.transform;return[c.width,c.height]}},{key:"getType",value:function(){return"mapbox"}},{key:"getZoom",value:function(){return this.map.getZoom()}},{key:"setZoom",value:function(c){return this.map.setZoom(c)}},{key:"getCenter",value:function(){return this.map.getCenter()}},{key:"setCenter",value:function(c){this.map.setCenter(c)}},{key:"getPitch",value:function(){return this.map.getPitch()}},{key:"getRotation",value:function(){return this.map.getBearing()}},{key:"getBounds",value:function(){return this.map.getBounds().toArray()}},{key:"getMinZoom",value:function(){return this.map.getMinZoom()}},{key:"getMaxZoom",value:function(){return this.map.getMaxZoom()}},{key:"setRotation",value:function(c){this.map.setBearing(c)}},{key:"zoomIn",value:function(c,d){this.map.zoomIn(c,d)}},{key:"zoomOut",value:function(c,d){this.map.zoomOut(c,d)}},{key:"setPitch",value:function(c){return this.map.setPitch(c)}},{key:"panTo",value:function(c){this.map.panTo(c)}},{key:"panBy",value:function(c){this.panTo(c)}},{key:"fitBounds",value:function(c,d){this.map.fitBounds(c,d)}},{key:"setMaxZoom",value:function(c){this.map.setMaxZoom(c)}},{key:"setMinZoom",value:function(c){this.map.setMinZoom(c)}},{key:"setMapStatus",value:function(c){c.doubleClickZoom===!0&&this.map.doubleClickZoom.enable(),c.doubleClickZoom===!1&&this.map.doubleClickZoom.disable(),c.dragEnable===!1&&this.map.dragPan.disable(),c.dragEnable===!0&&this.map.dragPan.enable(),c.rotateEnable===!1&&this.map.dragRotate.disable(),c.rotateEnable===!0&&this.map.dragRotate.enable(),c.keyboardEnable===!1&&this.map.keyboard.disable(),c.keyboardEnable===!0&&this.map.keyboard.enable(),c.zoomEnable===!1&&this.map.scrollZoom.disable(),c.zoomEnable===!0&&this.map.scrollZoom.enable()}},{key:"setZoomAndCenter",value:function(c,d){this.map.flyTo({zoom:c,center:d})}},{key:"setMapStyle",value:function(c){this.map.setStyle(this.getMapStyle(c))}},{key:"pixelToLngLat",value:function(c){return this.map.unproject(c)}},{key:"lngLatToPixel",value:function(c){return this.map.project(c)}},{key:"containerToLngLat",value:function(c){return this.map.unproject(c)}},{key:"lngLatToContainer",value:function(c){return this.map.project(c)}},{key:"lngLatToMercator",value:function(c,d){var y=window.mapboxgl.MercatorCoordinate.fromLngLat(c,d),I=y.x,te=I===void 0?0:I,B=y.y,k=B===void 0?0:B,Q=y.z,We=Q===void 0?0:Q;return{x:te,y:k,z:We}}},{key:"getModelMatrix",value:function(c,d,y){var I=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[1,1,1],te=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{x:0,y:0,z:0},B=window.mapboxgl.MercatorCoordinate.fromLngLat(c,d),k=B.meterInMercatorCoordinateUnits(),Q=tr.b.create();return tr.b.translate(Q,Q,tr.d.fromValues(B.x-te.x,B.y-te.y,B.z||0-te.z)),tr.b.scale(Q,Q,tr.d.fromValues(k*I[0],-k*I[1],k*I[2])),tr.b.rotateX(Q,Q,y[0]),tr.b.rotateY(Q,Q,y[1]),tr.b.rotateZ(Q,Q,y[2]),Q}},{key:"init",value:function(){var b=cr()(K.a.mark(function d(){var y,I,te,B,k,Q,We,rt,Pe,Qe,Tt,ke,vt;return K.a.wrap(function(Zt){for(;;)switch(Zt.prev=Zt.next){case 0:y=this.config,I=y.id,te=I===void 0?"map":I,B=y.attributionControl,k=B===void 0?!1:B,Q=y.style,We=Q===void 0?"light":Q,rt=y.token,Pe=rt===void 0?_u:rt,Qe=y.rotation,Tt=Qe===void 0?0:Qe,ke=y.mapInstance,vt=Ur()(y,["id","attributionControl","style","token","rotation","mapInstance"]),this.viewport=new fu,!ke&&!window.mapboxgl&&this.logger.error(this.configService.getSceneWarninfo("SDK")),Pe===_u&&We!=="blank"&&!window.mapboxgl.accessToken&&!ke&&this.logger.warn(this.configService.getSceneWarninfo("MapToken")),!ke&&!window.mapboxgl.accessToken&&(window.mapboxgl.accessToken=Pe),ke?(this.map=ke,this.$mapContainer=this.map.getContainer()):(this.$mapContainer=this.creatAmapContainer(te),this.map=new window.mapboxgl.Map(Pl({container:this.$mapContainer,style:this.getMapStyle(We),attributionControl:k,bearing:Tt},vt))),this.map.on("load",this.handleCameraChanged),this.map.on("move",this.handleCameraChanged),this.handleCameraChanged();case 9:case"end":return Zt.stop()}},d,this)}));function c(){return b.apply(this,arguments)}return c}()},{key:"destroy",value:function(){this.eventEmitter.removeAllListeners(),this.map&&(this.map.remove(),this.$mapContainer=null)}},{key:"emit",value:function(c){for(var d,y=arguments.length,I=new Array(y>1?y-1:0),te=1;te<y;te++)I[te-1]=arguments[te];(d=this.eventEmitter).emit.apply(d,[c].concat(I))}},{key:"once",value:function(c){for(var d,y=arguments.length,I=new Array(y>1?y-1:0),te=1;te<y;te++)I[te-1]=arguments[te];(d=this.eventEmitter).once.apply(d,[c].concat(I))}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"exportMap",value:function(c){var d=this.map.getCanvas(),y=c==="jpg"?d==null?void 0:d.toDataURL("image/jpeg"):d==null?void 0:d.toDataURL("image/png");return y}},{key:"onCameraChanged",value:function(c){this.cameraChangedCallback=c}},{key:"creatAmapContainer",value:function(c){var d=c;typeof c=="string"&&(d=document.getElementById(c));var y=document.createElement("div");return y.style.cssText+=`
      position: absolute;
      top: 0;
      height: 100%;
      width: 100%;
    `,y.id="l7_mapbox_div"+Rc++,d.appendChild(y),y}},{key:"getMapStyle",value:function(c){return typeof c!="string"?c:ju[c]?ju[c]:c}}]),w}(),Lc),Jc=$n()(gl.prototype,"config",[Mc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$i=$n()(gl.prototype,"configService",[hf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Tu=$n()(gl.prototype,"logger",[pi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yl=$n()(gl.prototype,"coordinateSystemService",[Pc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),os=$n()(gl.prototype,"eventEmitter",[mc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gl))||$c);function Yl(w){var b=Si();return function(){var d=hr()(w),y;if(b){var I=hr()(this).constructor;y=Reflect.construct(d,arguments,I)}else y=d.apply(this,arguments);return yt()(this,y)}}function Si(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(w){return!1}}o("BGjm")(`/* @antv/l7-maps */
.mapboxgl-ctrl-logo {
 display: none !important;
}
`);var qc=function(w){Fe()(c,w);var b=Yl(c);function c(){return Ke()(this,c),b.apply(this,arguments)}return bt()(c,[{key:"getServiceConstructor",value:function(){return Qc}}]),c}(Rt);function df(w,b){var c=Object.keys(w);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(w);b&&(d=d.filter(function(y){return Object.getOwnPropertyDescriptor(w,y).enumerable})),c.push.apply(c,d)}return c}function Kl(w){for(var b=1;b<arguments.length;b++){var c=arguments[b]!=null?arguments[b]:{};b%2?df(Object(c),!0).forEach(function(d){Ic(w,d,c[d])}):Object.getOwnPropertyDescriptors?Object.defineProperties(w,Object.getOwnPropertyDescriptors(c)):df(Object(c)).forEach(function(d){Object.defineProperty(w,d,Object.getOwnPropertyDescriptor(c,d))})}return w}function Ic(w,b,c){return b in w?Object.defineProperty(w,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):w[b]=c,w}function $l(w,b){return Jl(w)||Lo(w,b)||Fu(w,b)||Qu()}function Qu(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Fu(w,b){if(!w)return;if(typeof w=="string")return bl(w,b);var c=Object.prototype.toString.call(w).slice(8,-1);if(c==="Object"&&w.constructor&&(c=w.constructor.name),c==="Map"||c==="Set")return Array.from(w);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return bl(w,b)}function bl(w,b){(b==null||b>w.length)&&(b=w.length);for(var c=0,d=new Array(b);c<b;c++)d[c]=w[c];return d}function Lo(w,b){if(typeof Symbol=="undefined"||!(Symbol.iterator in Object(w)))return;var c=[],d=!0,y=!1,I=void 0;try{for(var te=w[Symbol.iterator](),B;!(d=(B=te.next()).done)&&!(c.push(B.value),b&&c.length===b);d=!0);}catch(k){y=!0,I=k}finally{try{!d&&te.return!=null&&te.return()}finally{if(y)throw I}}return c}function Jl(w){if(Array.isArray(w))return w}var Ll=Se.a.memo(function(w){var b=w.style,c=w.className,d=w.map,y=w.option,I=w.onSceneLoaded,te=Object(be.createRef)(),B=Object(be.useState)(),k=$l(B,2),Q=k[0],We=k[1];return Object(be.useEffect)(function(){var rt=new kt.Scene(Kl(Kl({id:te.current},y),{},{map:new qc(d)}));return rt.on("loaded",function(){We(rt),I&&I(rt)}),function(){rt.destroy()}},[]),Object(be.useEffect)(function(){Q&&d.style&&Q.setMapStyle(d.style)},[JSON.stringify(d.style)]),Object(be.useEffect)(function(){Q&&d.zoom&&Q.setZoom(d.zoom)},[d.zoom]),Object(be.useEffect)(function(){Q&&d.center&&Q.setCenter(d.center)},[JSON.stringify(d.center)]),Object(be.useEffect)(function(){Q&&d.pitch!==void 0&&Q.setPitch(d.pitch||0)},[d.pitch]),Object(be.useEffect)(function(){Q&&d.rotation&&Q.setRotation(d.rotation)},[d.rotation]),Se.a.createElement(ae.Provider,{value:Q},Object(be.createElement)("div",{ref:te,style:b,className:c},Q&&w.children))}),Rl=Ll,Dc=o("PJYZ"),xl=o.n(Dc),Qs=o("QkVN"),eo=o.n(Qs),pf=o("uhBA"),mf=o("cDf5"),El=o.n(mf),Ql=o("zvhG"),qu=o.n(Ql);function Il(w,b){var c;if(typeof Symbol=="undefined"||w[Symbol.iterator]==null){if(Array.isArray(w)||(c=gc(w))||b&&w&&typeof w.length=="number"){c&&(w=c);var d=0,y=function(){};return{s:y,n:function(){return d>=w.length?{done:!0}:{done:!1,value:w[d++]}},e:function(Q){throw Q},f:y}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var I=!0,te=!1,B;return{s:function(){c=w[Symbol.iterator]()},n:function(){var Q=c.next();return I=Q.done,Q},e:function(Q){te=!0,B=Q},f:function(){try{!I&&c.return!=null&&c.return()}finally{if(te)throw B}}}}function gc(w,b){if(!w)return;if(typeof w=="string")return yc(w,b);var c=Object.prototype.toString.call(w).slice(8,-1);if(c==="Object"&&w.constructor&&(c=w.constructor.name),c==="Map"||c==="Set")return Array.from(w);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return yc(w,b)}function yc(w,b){(b==null||b>w.length)&&(b=w.length);for(var c=0,d=new Array(b);c<b;c++)d[c]=w[c];return d}var el;function ef(w,b,c){var d=c-b,y=((w-b)%d+d)%d+b;return y===b?c:y}function tl(w,b,c){return Math.min(c,Math.max(b,w))}function qs(w,b,c){return w*(1-c)+b*c}function Tl(w,b,c,d){var y=new qu.a(w,b,c,d);return function(I){return y.solve(I)}}var ql=Tl(.25,.1,.25,1);function Nc(){return window.matchMedia?(el==null&&(el=window.matchMedia("(prefers-reduced-motion: reduce)")),el.matches):!1}function tf(w,b){var c={},d=Il(b),y;try{for(d.s();!(y=d.n()).done;){var I=y.value;I in w&&(c[I]=w[I])}}catch(te){d.e(te)}finally{d.f()}return c}var zs=window.performance&&window.performance.now?window.performance.now.bind(window.performance):Date.now.bind(Date),vf=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame,rl=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame;function Pi(w){var b=vf(w);return{cancel:function(){return rl(b)}}}var nl=function(){bt()(w,null,[{key:"convert",value:function(c){return c instanceof w?c:new w(c)}}]);function w(b,c){Ke()(this,w),this.ne=void 0,this.sw=void 0,b&&(c?this.setSouthWest(b).setNorthEast(c):b.length===4?this.setSouthWest([b[0],b[1]]).setNorthEast([b[2],b[3]]):this.setSouthWest(b[0]).setNorthEast(b[1]))}return bt()(w,[{key:"setNorthEast",value:function(c){return this.ne=c instanceof fi?new fi(c.lng,c.lat):fi.convert(c),this}},{key:"setSouthWest",value:function(c){return this.sw=c instanceof fi?new fi(c.lng,c.lat):fi.convert(c),this}},{key:"extend",value:function(c){var d=this.sw,y=this.ne,I,te;if(c instanceof fi)I=c,te=c;else if(c instanceof w){if(I=c.sw,te=c.ne,!I||!te)return this}else{if(Array.isArray(c))if(c.length===4||c.every(Array.isArray)){var B=c;return this.extend(w.convert(B))}else{var k=c;return this.extend(fi.convert(k))}return this}return!d&&!y?(this.sw=new fi(I.lng,I.lat),this.ne=new fi(te.lng,te.lat)):(d.lng=Math.min(I.lng,d.lng),d.lat=Math.min(I.lat,d.lat),y.lng=Math.max(te.lng,y.lng),y.lat=Math.max(te.lat,y.lat)),this}},{key:"getCenter",value:function(){return new fi((this.sw.lng+this.ne.lng)/2,(this.sw.lat+this.ne.lat)/2)}},{key:"getSouthWest",value:function(){return this.sw}},{key:"getNorthEast",value:function(){return this.ne}},{key:"getNorthWest",value:function(){return new fi(this.getWest(),this.getNorth())}},{key:"getSouthEast",value:function(){return new fi(this.getEast(),this.getSouth())}},{key:"getWest",value:function(){return this.sw.lng}},{key:"getSouth",value:function(){return this.sw.lat}},{key:"getEast",value:function(){return this.ne.lng}},{key:"getNorth",value:function(){return this.ne.lat}},{key:"toArray",value:function(){return[this.sw.toArray(),this.ne.toArray()]}},{key:"toString",value:function(){return"LngLatBounds(".concat(this.sw.toString(),", ").concat(this.ne.toString(),")")}},{key:"isEmpty",value:function(){return!(this.sw&&this.ne)}},{key:"contains",value:function(c){var d=fi.convert(c),y=d.lng,I=d.lat,te=this.sw.lat<=I&&I<=this.ne.lat,B=this.sw.lng<=y&&y<=this.ne.lng;return this.sw.lng>this.ne.lng&&(B=this.sw.lng>=y&&y>=this.ne.lng),te&&B}}]),w}(),zu=63710088e-1,fi=function(){bt()(w,null,[{key:"convert",value:function(c){if(c instanceof w)return c;if(Array.isArray(c)&&(c.length===2||c.length===3))return new w(Number(c[0]),Number(c[1]));if(!Array.isArray(c)&&El()(c)==="object"&&c!==null){var d="lng"in c?c.lng:c.lon;return new w(Number(d),Number(c.lat))}throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}]);function w(b,c){if(Ke()(this,w),this.lng=void 0,this.lat=void 0,isNaN(b)||isNaN(c))throw new Error("Invalid LngLat object: (".concat(b,", ").concat(c,")"));if(this.lng=+b,this.lat=+c,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}return bt()(w,[{key:"wrap",value:function(){return new w(ef(this.lng,-180,180),this.lat)}},{key:"toArray",value:function(){return[this.lng,this.lat]}},{key:"toBounds",value:function(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,d=40075017,y=360*c/d,I=y/Math.cos(Math.PI/180*this.lat);return new nl(new w(this.lng-I,this.lat-y),new w(this.lng+I,this.lat+y))}},{key:"toString",value:function(){return"LngLat(".concat(this.lng,", ").concat(this.lat,")")}},{key:"distanceTo",value:function(c){var d=Math.PI/180,y=this.lat*d,I=c.lat*d,te=Math.sin(y)*Math.sin(I)+Math.cos(y)*Math.cos(I)*Math.cos((c.lng-this.lng)*d),B=zu*Math.acos(Math.min(te,1));return B}}]),w}(),kn=function(){bt()(w,null,[{key:"convert",value:function(c){return c instanceof w?c:Array.isArray(c)?new w(c[0],c[1]):c}}]);function w(b,c){Ke()(this,w),this.x=void 0,this.y=void 0,this.x=b,this.y=c}return bt()(w,[{key:"clone",value:function(){return new w(this.x,this.y)}},{key:"_add",value:function(c){return this.x+=c.x,this.y+=c.y,this}},{key:"add",value:function(c){return this.clone()._add(c)}},{key:"_sub",value:function(c){return this.x-=c.x,this.y-=c.y,this}},{key:"sub",value:function(c){return this.clone()._sub(c)}},{key:"_multByPoint",value:function(c){return this.x*=c.x,this.y*=c.y,this}},{key:"multByPoint",value:function(c){return this.clone()._multByPoint(c)}},{key:"_divByPoint",value:function(c){return this.x/=c.x,this.y/=c.y,this}},{key:"divByPoint",value:function(c){return this.clone()._divByPoint(c)}},{key:"_mult",value:function(c){return this.x*=c,this.y*=c,this}},{key:"mult",value:function(c){return this.clone()._mult(c)}},{key:"_div",value:function(c){return this.x/=c,this.y/=c,this}},{key:"div",value:function(c){return this.clone()._div(c)}},{key:"_rotate",value:function(c){var d=Math.cos(c),y=Math.sin(c),I=d*this.x-y*this.y,te=y*this.x+d*this.y;return this.x=I,this.y=te,this}},{key:"rotate",value:function(c){return this.clone()._rotate(c)}},{key:"_rotateAround",value:function(c,d){var y=Math.cos(c),I=Math.sin(c),te=d.x+y*(this.x-d.x)-I*(this.y-d.y),B=d.y+I*(this.x-d.x)+y*(this.y-d.y);return this.x=te,this.y=B,this}},{key:"roateAround",value:function(c,d){return this.clone()._rotateAround(c,d)}},{key:"_matMult",value:function(c){var d=c[0]*this.x+c[1]*this.y,y=c[2]*this.x+c[3]*this.y;return this.x=d,this.y=y,this}},{key:"matMult",value:function(c){return this.clone()._matMult(c)}},{key:"_unit",value:function(){return this.div(this.mag()),this}},{key:"unit",value:function(){return this.clone()._unit()}},{key:"_perp",value:function(){var c=this.y;return this.y=this.x,this.x=-c,this}},{key:"perp",value:function(){return this.clone()._perp()}},{key:"_round",value:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},{key:"round",value:function(){return this.clone()._round()}},{key:"mag",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y)}},{key:"equals",value:function(c){return this.x===c.x&&this.y===c.y}},{key:"dist",value:function(c){return Math.sqrt(this.distSqr(c))}},{key:"distSqr",value:function(c){var d=c.x-this.x,y=c.y-this.y;return d*d+y*y}},{key:"angle",value:function(){return Math.atan2(this.y,this.x)}},{key:"angleTo",value:function(c){return Math.atan2(this.y-c.y,this.x-c.x)}},{key:"angleWith",value:function(c){return this.angleWithSep(c.x,c.y)}},{key:"angleWithSep",value:function(c,d){return Math.atan2(this.x*d-this.y*c,this.x*c+this.y*d)}}]),w}(),Li=function(){function w(){var b=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,y=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(Ke()(this,w),this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,isNaN(b)||b<0||isNaN(c)||c<0||isNaN(d)||d<0||isNaN(y)||y<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=b,this.bottom=c,this.left=d,this.right=y}return bt()(w,[{key:"interpolate",value:function(c,d,y){return d.top!=null&&c.top!=null&&(this.top=qs(c.top,d.top,y)),d.bottom!=null&&c.bottom!=null&&(this.bottom=qs(c.bottom,d.bottom,y)),d.left!=null&&c.left!=null&&(this.left=qs(c.left,d.left,y)),d.right!=null&&c.right!=null&&(this.right=qs(c.right,d.right,y)),this}},{key:"getCenter",value:function(c,d){var y=tl((this.left+c-this.right)/2,0,c),I=tl((this.top+d-this.bottom)/2,0,d);return new kn(y,I)}},{key:"equals",value:function(c){return this.top===c.top&&this.bottom===c.bottom&&this.left===c.left&&this.right===c.right}},{key:"clone",value:function(){return new w(this.top,this.bottom,this.left,this.right)}},{key:"toJSON",value:function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}]),w}(),Ls=2*Math.PI*zu;function Dl(w){return Ls*Math.cos(w*Math.PI/180)}function Uu(w){return(180+w)/360}function al(w){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+w*Math.PI/360)))/360}function gf(w,b){return w/Dl(b)}function ss(w){return w*360-180}function _l(w){var b=180-w*360;return 360/Math.PI*Math.atan(Math.exp(b*Math.PI/180))-90}function il(w,b){return w*Dl(_l(b))}function ol(w){return 1/Math.cos(w*Math.PI/180)}var Ui=function(){bt()(w,null,[{key:"fromLngLat",value:function(c){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,y=fi.convert(c);return new w(Uu(y.lng),al(y.lat),gf(d,y.lat))}}]);function w(b,c){var d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;Ke()(this,w),this.x=void 0,this.y=void 0,this.z=void 0,this.x=+b,this.y=+c,this.z=+d}return bt()(w,[{key:"toLngLat",value:function(){return new fi(ss(this.x),_l(this.y))}},{key:"toAltitude",value:function(){return il(this.z,this.y)}},{key:"meterInMercatorCoordinateUnits",value:function(){return 1/Ls*ol(_l(this.y))}}]),w}();function As(w,b){var c;if(typeof Symbol=="undefined"||w[Symbol.iterator]==null){if(Array.isArray(w)||(c=Nl(w))||b&&w&&typeof w.length=="number"){c&&(w=c);var d=0,y=function(){};return{s:y,n:function(){return d>=w.length?{done:!0}:{done:!1,value:w[d++]}},e:function(Q){throw Q},f:y}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var I=!0,te=!1,B;return{s:function(){c=w[Symbol.iterator]()},n:function(){var Q=c.next();return I=Q.done,Q},e:function(Q){te=!0,B=Q},f:function(){try{!I&&c.return!=null&&c.return()}finally{if(te)throw B}}}}function Nl(w,b){if(!w)return;if(typeof w=="string")return to(w,b);var c=Object.prototype.toString.call(w).slice(8,-1);if(c==="Object"&&w.constructor&&(c=w.constructor.name),c==="Map"||c==="Set")return Array.from(w);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return to(w,b)}function to(w,b){(b==null||b>w.length)&&(b=w.length);for(var c=0,d=new Array(b);c<b;c++)d[c]=w[c];return d}var Rn=8192,Us=function(){bt()(w,[{key:"minZoom",get:function(){return this._minZoom},set:function(c){if(this._minZoom===c)return;this._minZoom=c,this.zoom=Math.max(this.zoom,c)}},{key:"maxZoom",get:function(){return this._maxZoom},set:function(c){if(this._maxZoom===c)return;this._maxZoom=c,this.zoom=Math.min(this.zoom,c)}},{key:"minPitch",get:function(){return this._minPitch},set:function(c){if(this._minPitch===c)return;this._minPitch=c,this._pitch=Math.max(this._pitch,c)}},{key:"maxPitch",get:function(){return this._maxPitch},set:function(c){if(this._maxPitch===c)return;this._maxPitch=c,this._pitch=Math.min(this._pitch,c)}},{key:"renderWorldCopies",get:function(){return this._renderWorldCopies},set:function(c){c===void 0?c=!0:c===null&&(c=!1),this._renderWorldCopies=c}},{key:"worldSize",get:function(){return this.tileSize*this.scale}},{key:"centerOffset",get:function(){return this.centerPoint._sub(this.size._div(2))}},{key:"size",get:function(){return new kn(this.width,this.height)}},{key:"bearing",get:function(){return-this.angle/Math.PI*180},set:function(c){var d=-ef(c,-180,180)*Math.PI/180;if(this.angle===d)return;this.unmodified=!1,this.angle=d,this.calcMatrices(),this.rotationMatrix=tr.a.create(),tr.a.rotate(this.rotationMatrix,this.rotationMatrix,this.angle)}},{key:"pitch",get:function(){return this._pitch/Math.PI*180},set:function(c){var d=tl(c,this._minPitch,this._maxPitch)/180*Math.PI;if(this._pitch===d)return;this.unmodified=!1,this._pitch=d,this.calcMatrices()}},{key:"fov",get:function(){return this._fov/Math.PI*180},set:function(c){if(c=Math.max(.01,Math.min(60,c)),this._fov===c)return;this.unmodified=!1,this._fov=c/180*Math.PI,this.calcMatrices()}},{key:"zoom",get:function(){return this._zoom},set:function(c){var d=Math.min(Math.max(c,this._minZoom),this._maxZoom);if(this._zoom===d)return;this.unmodified=!1,this._zoom=d,this.scale=this.zoomScale(d),this.tileZoom=Math.floor(d),this.zoomFraction=d-this.tileZoom,this.constrain(),this.calcMatrices()}},{key:"center",get:function(){return this._center},set:function(c){if(c.lat===this._center.lat&&c.lng===this._center.lng)return;this.unmodified=!1,this._center=c,this.constrain(),this.calcMatrices()}},{key:"padding",get:function(){return this.edgeInsets.toJSON()},set:function(c){if(this.edgeInsets.equals(c))return;this.unmodified=!1,this.edgeInsets.interpolate(this.edgeInsets,c,1),this.calcMatrices()}},{key:"centerPoint",get:function(){return this.edgeInsets.getCenter(this.width,this.height)}},{key:"point",get:function(){return this.project(this.center)}}]);function w(b,c,d,y,I){Ke()(this,w),this.tileSize=void 0,this.tileZoom=void 0,this.lngRange=void 0,this.latRange=void 0,this.maxValidLatitude=void 0,this.scale=void 0,this.width=void 0,this.height=void 0,this.angle=void 0,this.rotationMatrix=void 0,this.pixelsToGLUnits=void 0,this.cameraToCenterDistance=void 0,this.mercatorMatrix=void 0,this.projMatrix=void 0,this.invProjMatrix=void 0,this.alignedProjMatrix=void 0,this.pixelMatrix=void 0,this.pixelMatrixInverse=void 0,this.glCoordMatrix=void 0,this.labelPlaneMatrix=void 0,this._fov=void 0,this._pitch=void 0,this._zoom=void 0,this._renderWorldCopies=void 0,this._minZoom=void 0,this._maxZoom=void 0,this._minPitch=void 0,this._maxPitch=void 0,this._center=void 0,this.zoomFraction=void 0,this.unmodified=void 0,this.edgeInsets=void 0,this.constraining=void 0,this.posMatrixCache=void 0,this.alignedPosMatrixCache=void 0,this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=I===void 0?!0:I,this._minZoom=b||0,this._maxZoom=c||22,this._minPitch=d==null?0:d,this._maxPitch=y==null?60:y,this.setMaxBounds(),this.width=0,this.height=0,this._center=new fi(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this.unmodified=!0,this.edgeInsets=new Li,this.posMatrixCache={},this.alignedPosMatrixCache={}}return bt()(w,[{key:"clone",value:function(){var c=new w(this._minZoom,this._maxZoom,this._minPitch,this._maxPitch,this._renderWorldCopies);return c.tileSize=this.tileSize,c.latRange=this.latRange,c.width=this.width,c.height=this.height,c.center=this._center,c.zoom=this.zoom,c.angle=this.angle,c.fov=this._fov,c.pitch=this._pitch,c.unmodified=this.unmodified,c.edgeInsets=this.edgeInsets.clone(),c.calcMatrices(),c}},{key:"isPaddingEqual",value:function(c){return this.edgeInsets.equals(c)}},{key:"interpolatePadding",value:function(c,d,y){this.unmodified=!1,this.edgeInsets.interpolate(c,d,y),this.constrain(),this.calcMatrices()}},{key:"coveringZoomLevel",value:function(c){var d=(c.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/c.tileSize));return Math.max(0,d)}},{key:"resize",value:function(c,d){this.width=c,this.height=d,this.pixelsToGLUnits=[2/c,-2/d],this.constrain(),this.calcMatrices()}},{key:"zoomScale",value:function(c){return Math.pow(2,c)}},{key:"scaleZoom",value:function(c){return Math.log(c)/Math.LN2}},{key:"project",value:function(c){var d=tl(c.lat,-this.maxValidLatitude,this.maxValidLatitude);return new kn(Uu(c.lng)*this.worldSize,al(d)*this.worldSize)}},{key:"unproject",value:function(c){return new Ui(c.x/this.worldSize,c.y/this.worldSize).toLngLat()}},{key:"setLocationAtPoint",value:function(c,d){var y=this.pointCoordinate(d),I=this.pointCoordinate(this.centerPoint),te=this.locationCoordinate(c),B=new Ui(te.x-(y.x-I.x),te.y-(y.y-I.y));this.center=this.coordinateLocation(B),this._renderWorldCopies&&(this.center=this.center.wrap())}},{key:"pointCoordinate",value:function(c){var d=0,y=new Float32Array([c.x,c.y,0,1]),I=new Float32Array([c.x,c.y,1,1]);tr.e.transformMat4(y,y,this.pixelMatrixInverse),tr.e.transformMat4(I,I,this.pixelMatrixInverse);var te=y[3],B=I[3],k=y[0]/te,Q=I[0]/B,We=y[1]/te,rt=I[1]/B,Pe=y[2]/te,Qe=I[2]/B,Tt=Pe===Qe?0:(d-Pe)/(Qe-Pe);return new Ui(qs(k,Q,Tt)/this.worldSize,qs(We,rt,Tt)/this.worldSize)}},{key:"getBounds",value:function(){return new nl().extend(this.pointLocation(new kn(0,0))).extend(this.pointLocation(new kn(this.width,0))).extend(this.pointLocation(new kn(this.width,this.height))).extend(this.pointLocation(new kn(0,this.height)))}},{key:"getMaxBounds",value:function(){return!this.latRange||this.latRange.length!==2||!this.lngRange||this.lngRange.length!==2?null:new nl([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]])}},{key:"setMaxBounds",value:function(c){c?(this.lngRange=[c.getWest(),c.getEast()],this.latRange=[c.getSouth(),c.getNorth()],this.constrain()):(this.lngRange=void 0,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}},{key:"customLayerMatrix",value:function(){return this.mercatorMatrix.slice()}},{key:"maxPitchScaleFactor",value:function(){if(!this.pixelMatrixInverse)return 1;var c=this.pointCoordinate(new kn(0,0)),d=new Float32Array([c.x*this.worldSize,c.y*this.worldSize,0,1]),y=tr.e.transformMat4(d,d,this.pixelMatrix);return y[3]/this.cameraToCenterDistance}},{key:"getCameraPoint",value:function(){var c=this._pitch,d=Math.tan(c)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new kn(0,d))}},{key:"getCameraQueryGeometry",value:function(c){var d=this.getCameraPoint();if(c.length===1)return[c[0],d];var y=d.x,I=d.y,te=d.x,B=d.y,k=As(c),Q;try{for(k.s();!(Q=k.n()).done;){var We=Q.value;y=Math.min(y,We.x),I=Math.min(I,We.y),te=Math.max(te,We.x),B=Math.max(B,We.y)}}catch(rt){k.e(rt)}finally{k.f()}return[new kn(y,I),new kn(te,I),new kn(te,B),new kn(y,B),new kn(y,I)]}},{key:"coordinatePoint",value:function(c){var d=tr.e.fromValues(c.x*this.worldSize,c.y*this.worldSize,0,1);return tr.e.transformMat4(d,d,this.pixelMatrix),new kn(d[0]/d[3],d[1]/d[3])}},{key:"locationPoint",value:function(c){return this.coordinatePoint(this.locationCoordinate(c))}},{key:"pointLocation",value:function(c){return this.coordinateLocation(this.pointCoordinate(c))}},{key:"locationCoordinate",value:function(c){return Ui.fromLngLat(c)}},{key:"coordinateLocation",value:function(c){return c.toLngLat()}},{key:"getProjectionMatrix",value:function(){return this.projMatrix}},{key:"constrain",value:function(){if(!this.center||!this.width||!this.height||this.constraining)return;this.constraining=!0;var c=-90,d=90,y=-180,I=180,te,B,k,Q,We=this.size,rt=this.unmodified;if(this.latRange){var Pe=this.latRange;c=al(Pe[1])*this.worldSize,d=al(Pe[0])*this.worldSize,te=d-c<We.y?We.y/(d-c):0}if(this.lngRange){var Qe=this.lngRange;y=Uu(Qe[0])*this.worldSize,I=Uu(Qe[1])*this.worldSize,B=I-y<We.x?We.x/(I-y):0}var Tt=this.point,ke=Math.max(B||0,te||0);if(ke){this.center=this.unproject(new kn(B?(I+y)/2:Tt.x,te?(d+c)/2:Tt.y)),this.zoom+=this.scaleZoom(ke),this.unmodified=rt,this.constraining=!1;return}if(this.latRange){var vt=Tt.y,De=We.y/2;vt-De<c&&(Q=c+De),vt+De>d&&(Q=d-De)}if(this.lngRange){var Zt=Tt.x,Kt=We.x/2;Zt-Kt<y&&(k=y+Kt),Zt+Kt>I&&(k=I-Kt)}(k!==void 0||Q!==void 0)&&(this.center=this.unproject(new kn(k!==void 0?k:Tt.x,Q!==void 0?Q:Tt.y))),this.unmodified=rt,this.constraining=!1}},{key:"calcMatrices",value:function(){if(!this.height)return;var c=this._fov/2,d=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(c)*this.height;var y=Math.PI/2+this._pitch,I=this._fov*(.5+d.y/this.height),te=Math.sin(I)*this.cameraToCenterDistance/Math.sin(tl(Math.PI-y-I,.01,Math.PI-.01)),B=this.point,k=B.x,Q=B.y,We=Math.cos(Math.PI/2-this._pitch)*te+this.cameraToCenterDistance,rt=We*1.01,Pe=this.height/50,Qe=tr.b.create();tr.b.perspective(Qe,this._fov,this.width/this.height,Pe,rt),Qe[8]=-d.x*2/this.width,Qe[9]=d.y*2/this.height,tr.b.scale(Qe,Qe,[1,-1,1]),tr.b.translate(Qe,Qe,[0,0,-this.cameraToCenterDistance]),tr.b.rotateX(Qe,Qe,this._pitch),tr.b.rotateZ(Qe,Qe,this.angle),tr.b.translate(Qe,Qe,[-k,-Q,0]),this.mercatorMatrix=tr.b.scale(tr.b.create(),Qe,[this.worldSize,this.worldSize,this.worldSize]),tr.b.scale(Qe,Qe,tr.d.fromValues(1,1,gf(1,this.center.lat)*this.worldSize)),this.projMatrix=Qe,this.invProjMatrix=tr.b.invert(tr.b.create(),this.projMatrix);var Tt=this.width%2/2,ke=this.height%2/2,vt=Math.cos(this.angle),De=Math.sin(this.angle),Zt=k-Math.round(k)+vt*Tt+De*ke,Kt=Q-Math.round(Q)+vt*ke+De*Tt,dr=tr.b.clone(Qe);if(tr.b.translate(dr,dr,[Zt>.5?Zt-1:Zt,Kt>.5?Kt-1:Kt,0]),this.alignedProjMatrix=dr,Qe=tr.b.create(),tr.b.scale(Qe,Qe,[this.width/2,-this.height/2,1]),tr.b.translate(Qe,Qe,[1,-1,0]),this.labelPlaneMatrix=Qe,Qe=tr.b.create(),tr.b.scale(Qe,Qe,[1,-1,1]),tr.b.translate(Qe,Qe,[-1,-1,0]),tr.b.scale(Qe,Qe,[2/this.width,2/this.height,1]),this.glCoordMatrix=Qe,this.pixelMatrix=tr.b.multiply(tr.b.create(),this.labelPlaneMatrix,this.projMatrix),Qe=tr.b.invert(tr.b.create(),this.pixelMatrix),!Qe)throw new Error("failed to invert matrix");this.pixelMatrixInverse=Qe,this.posMatrixCache={},this.alignedPosMatrixCache={}}}]),w}(),ni=function w(b){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Ke()(this,w),this.type=void 0,eo()(this,c),this.type=b};function kl(w){var b=du();return function(){var d=hr()(w),y;if(b){var I=hr()(this).constructor;y=Reflect.construct(d,arguments,I)}else y=d.apply(this,arguments);return yt()(this,y)}}function du(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(w){return!1}}var Bs=function(w){Fe()(c,w);var b=kl(c);function c(d){var y;Ke()(this,c),y=b.call(this),y.transform=void 0,y.options=void 0,y.moving=void 0,y.zooming=void 0,y.rotating=void 0,y.pitching=void 0,y.padding=void 0,y.bearingSnap=void 0,y.easeEndTimeoutID=void 0,y.easeStart=void 0,y.easeOptions=void 0,y.easeId=void 0,y.onEaseFrame=void 0,y.onEaseEnd=void 0,y.easeFrameId=void 0,y.renderFrameCallback=function(){var We=Math.min((zs()-y.easeStart)/y.easeOptions.duration,1);y.onEaseFrame(y.easeOptions.easing(We)),We<1?y.easeFrameId=y.requestRenderFrame(y.renderFrameCallback):y.stop()},y.options=d;var I=d.minZoom,te=d.maxZoom,B=d.minPitch,k=d.maxPitch,Q=d.renderWorldCopies;return y.moving=!1,y.zooming=!1,y.bearingSnap=d.bearingSnap,y.transform=new Us(I,te,B,k,Q),y}return bt()(c,[{key:"requestRenderFrame",value:function(y){return 0}},{key:"cancelRenderFrame",value:function(y){return}},{key:"getCenter",value:function(){var y=this.transform.center,I=y.lng,te=y.lat;return new fi(I,te)}},{key:"getZoom",value:function(){return this.transform.zoom}},{key:"getPitch",value:function(){return this.transform.pitch}},{key:"setCenter",value:function(y,I){return this.jumpTo({center:y},I)}},{key:"setPitch",value:function(y,I){return this.jumpTo({pitch:y},I),this}},{key:"getBearing",value:function(){return this.transform.bearing}},{key:"panTo",value:function(y,I,te){return this.easeTo(eo()({center:y},I),te)}},{key:"zoomOut",value:function(y,I){return this.zoomTo(this.getZoom()-1,y,I),this}},{key:"setBearing",value:function(y,I){return this.jumpTo({bearing:y},I),this}},{key:"setZoom",value:function(y,I){return this.jumpTo({zoom:y},I),this}},{key:"zoomIn",value:function(y,I){return this.zoomTo(this.getZoom()+1,y,I),this}},{key:"zoomTo",value:function(y,I,te){return this.easeTo(eo()({zoom:y},I),te)}},{key:"getPadding",value:function(){return this.transform.padding}},{key:"setPadding",value:function(y,I){return this.jumpTo({padding:y},I),this}},{key:"rotateTo",value:function(y,I,te){return this.easeTo(eo()({bearing:y},I),te)}},{key:"resetNorth",value:function(y,I){return this.rotateTo(0,eo()({duration:1e3},y),I),this}},{key:"resetNorthPitch",value:function(y,I){return this.easeTo(eo()({bearing:0,pitch:0,duration:1e3},y),I),this}},{key:"fitBounds",value:function(y,I,te){return this.fitInternal(this.cameraForBounds(y,I),I,te)}},{key:"cameraForBounds",value:function(y,I){return y=nl.convert(y),this.cameraForBoxAndBearing(y.getNorthWest(),y.getSouthEast(),0,I)}},{key:"snapToNorth",value:function(y,I){return Math.abs(this.getBearing())<this.bearingSnap?this.resetNorth(y,I):this}},{key:"jumpTo",value:function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},I=arguments.length>1?arguments[1]:void 0;this.stop();var te=this.transform,B=!1,k=!1,Q=!1;return y.zoom&&te.zoom!==+y.zoom&&(B=!0,te.zoom=+y.zoom),y.center!==void 0&&(te.center=fi.convert(y.center)),y.bearing&&te.bearing!==+y.bearing&&(k=!0,te.bearing=+y.bearing),y.pitch&&te.pitch!==+y.pitch&&(Q=!0,te.pitch=+y.pitch),y.padding!=null&&!te.isPaddingEqual(y.padding)&&(te.padding=y.padding),this.emit("movestart",new ni("movestart",I)),this.emit("move",new ni("move",I)),B&&(this.emit("zoomstart",new ni("zoomstart",I)),this.emit("zoom",new ni("zoom",I)),this.emit("zoomend",new ni("zoomend",I))),k&&(this.emit("rotatestart",new ni("rotatestart",I)),this.emit("rotate",new ni("rotate",I)),this.emit("rotateend",new ni("rotateend",I))),Q&&(this.emit("pitchstart",new ni("pitchstart",I)),this.emit("pitch",new ni("pitch",I)),this.emit("pitchend",new ni("pitchend",I))),this.emit("moveend",new ni("moveend",I))}},{key:"easeTo",value:function(){var y=this,I=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},te=arguments.length>1?arguments[1]:void 0;I=eo()({offset:[0,0],duration:500,easing:ql},I),(I.animate===!1||!I.essential&&Nc())&&(I.duration=0);var B=this.transform,k=this.getZoom(),Q=this.getBearing(),We=this.getPitch(),rt=this.getPadding(),Pe=I.zoom?+I.zoom:k,Qe=I.bearing?this.normalizeBearing(I.bearing,Q):Q,Tt=I.pitch?+I.pitch:We,ke=I.padding?I.padding:B.padding,vt=kn.convert(I.offset),De=B.centerPoint.add(vt),Zt=B.pointLocation(De),Kt=fi.convert(I.center||Zt);this.normalizeCenter(Kt);var dr=B.project(Zt),rr=B.project(Kt).sub(dr),mr=B.zoomScale(Pe-k),Or,$r;I.around&&(Or=fi.convert(I.around),$r=B.locationPoint(Or));var Bn={moving:this.moving,zooming:this.zooming,rotating:this.rotating,pitching:this.pitching};return this.zooming=this.zooming||Pe!==k,this.rotating=this.rotating||Q!==Qe,this.pitching=this.pitching||Tt!==We,this.padding=!B.isPaddingEqual(ke),this.easeId=I.easeId,this.prepareEase(te,I.noMoveStart,Bn),clearTimeout(this.easeEndTimeoutID),this.ease(function(on){if(y.zooming&&(B.zoom=qs(k,Pe,on)),y.rotating&&(B.bearing=qs(Q,Qe,on)),y.pitching&&(B.pitch=qs(We,Tt,on)),y.padding&&(B.interpolatePadding(rt,ke,on),De=B.centerPoint.add(vt)),Or)B.setLocationAtPoint(Or,$r);else{var Dn=B.zoomScale(B.zoom-k),ca=Pe>k?Math.min(2,mr):Math.max(.5,mr),Na=Math.pow(ca,1-on),ri=B.unproject(dr.add(rr.mult(on*Na)).mult(Dn));B.setLocationAtPoint(B.renderWorldCopies?ri.wrap():ri,De)}y.fireMoveEvents(te)},function(on){y.afterEase(te,on)},I),this}},{key:"flyTo",value:function(){var y=this,I=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},te=arguments.length>1?arguments[1]:void 0;if(!I.essential&&Nc()){var B=tf(I,["center","zoom","bearing","pitch","around"]);return this.jumpTo(B,te)}this.stop(),I=eo()({offset:[0,0],speed:1.2,curve:1.42,easing:ql},I);var k=this.transform,Q=this.getZoom(),We=this.getBearing(),rt=this.getPitch(),Pe=this.getPadding(),Qe=I.zoom?tl(+I.zoom,k.minZoom,k.maxZoom):Q,Tt=I.bearing?this.normalizeBearing(I.bearing,We):We,ke=I.pitch?+I.pitch:rt,vt="padding"in I?I.padding:k.padding,De=k.zoomScale(Qe-Q),Zt=kn.convert(I.offset),Kt=k.centerPoint.add(Zt),dr=k.pointLocation(Kt),rr=fi.convert(I.center||dr);this.normalizeCenter(rr);var mr=k.project(dr),Or=k.project(rr).sub(mr),$r=I.curve,Bn=Math.max(k.width,k.height),on=Bn/De,Dn=Or.mag();if("minZoom"in I){var ca=tl(Math.min(I.minZoom,Q,Qe),k.minZoom,k.maxZoom),Na=Bn/k.zoomScale(ca-Q);$r=Math.sqrt(Na/Dn*2)}var ri=$r*$r;function co(Fa){var li=(on*on-Bn*Bn+(Fa?-1:1)*ri*ri*Dn*Dn)/(2*(Fa?on:Bn)*ri*Dn);return Math.log(Math.sqrt(li*li+1)-li)}function Hc(Fa){return(Math.exp(Fa)-Math.exp(-Fa))/2}function ys(Fa){return(Math.exp(Fa)+Math.exp(-Fa))/2}function fc(Fa){return Hc(Fa)/ys(Fa)}var xo=co(0),Wl=function(li){return ys(xo)/ys(xo+$r*li)},Xu=function(li){return Bn*((ys(xo)*fc(xo+$r*li)-Hc(xo))/ri)/Dn},pl=(co(1)-xo)/$r;if(Math.abs(Dn)<1e-6||!isFinite(pl)){if(Math.abs(Bn-on)<1e-6)return this.easeTo(I,te);var wl=on<Bn?-1:1;pl=Math.abs(Math.log(on/Bn))/$r,Xu=function(){return 0},Wl=function(li){return Math.exp(wl*$r*li)}}if("duration"in I)I.duration=+I.duration;else{var Mf="screenSpeed"in I?+I.screenSpeed/$r:+I.speed;I.duration=1e3*pl/Mf}return I.maxDuration&&I.duration>I.maxDuration&&(I.duration=0),this.zooming=!0,this.rotating=We!==Tt,this.pitching=ke!==rt,this.padding=!k.isPaddingEqual(vt),this.prepareEase(te,!1),this.ease(function(Fa){var li=Fa*pl,lh=1/Wl(li);k.zoom=Fa===1?Qe:Q+k.scaleZoom(lh),y.rotating&&(k.bearing=qs(We,Tt,Fa)),y.pitching&&(k.pitch=qs(rt,ke,Fa)),y.padding&&(k.interpolatePadding(Pe,vt,Fa),Kt=k.centerPoint.add(Zt));var th=Fa===1?rr:k.unproject(mr.add(Or.mult(Xu(li))).mult(lh));k.setLocationAtPoint(k.renderWorldCopies?th.wrap():th,Kt),y.fireMoveEvents(te)},function(){return y.afterEase(te)},I),this}},{key:"fitScreenCoordinates",value:function(y,I,te,B,k){return this.fitInternal(this.cameraForBoxAndBearing(this.transform.pointLocation(kn.convert(y)),this.transform.pointLocation(kn.convert(I)),te,B),B,k)}},{key:"stop",value:function(y,I){if(this.easeFrameId&&(this.cancelRenderFrame(this.easeFrameId),delete this.easeFrameId,delete this.onEaseFrame),this.onEaseEnd){var te=this.onEaseEnd;delete this.onEaseEnd,te.call(this,I)}return this}},{key:"normalizeBearing",value:function(y,I){y=ef(y,-180,180);var te=Math.abs(y-I);return Math.abs(y-360-I)<te&&(y-=360),Math.abs(y+360-I)<te&&(y+=360),y}},{key:"normalizeCenter",value:function(y){var I=this.transform;if(!I.renderWorldCopies||I.lngRange)return;var te=y.lng-I.center.lng;y.lng+=te>180?-360:te<-180?360:0}},{key:"fireMoveEvents",value:function(y){this.emit("move",new ni("move",y)),this.zooming&&this.emit("zoom",new ni("zoom",y)),this.rotating&&this.emit("rotate",new ni("rotate",y)),this.pitching&&this.emit("rotate",new ni("pitch",y))}},{key:"prepareEase",value:function(y){var I=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,te=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.moving=!0,!I&&!te.moving&&this.emit("movestart",new ni("movestart",y)),this.zooming&&!te.zooming&&this.emit("zoomstart",new ni("zoomstart",y)),this.rotating&&!te.rotating&&this.emit("rotatestart",new ni("rotatestart",y)),this.pitching&&!te.pitching&&this.emit("pitchstart",new ni("pitchstart",y))}},{key:"afterEase",value:function(y,I){if(this.easeId&&I&&this.easeId===I)return;delete this.easeId;var te=this.zooming,B=this.rotating,k=this.pitching;this.moving=!1,this.zooming=!1,this.rotating=!1,this.pitching=!1,this.padding=!1,te&&this.emit("zoomend",new ni("zoomend",y)),B&&this.emit("rotateend",new ni("rotateend",y)),k&&this.emit("pitchend",new ni("pitchend",y)),this.emit("moveend",new ni("moveend",y))}},{key:"ease",value:function(y,I,te){te.animate===!1||te.duration===0?(y(1),I()):(this.easeStart=zs(),this.easeOptions=te,this.onEaseFrame=y,this.onEaseEnd=I,this.easeFrameId=this.requestRenderFrame(this.renderFrameCallback))}},{key:"cameraForBoxAndBearing",value:function(y,I,te,B){var k={top:0,bottom:0,right:0,left:0};if(B=eo()({padding:k,offset:[0,0],maxZoom:this.transform.maxZoom},B),typeof B.padding=="number"){var Q=B.padding;B.padding={top:Q,bottom:Q,right:Q,left:Q}}B.padding=eo()(k,B.padding);var We=this.transform,rt=We.padding,Pe=We.project(fi.convert(y)),Qe=We.project(fi.convert(I)),Tt=Pe.rotate(-te*Math.PI/180),ke=Qe.rotate(-te*Math.PI/180),vt=new kn(Math.max(Tt.x,ke.x),Math.max(Tt.y,ke.y)),De=new kn(Math.min(Tt.x,ke.x),Math.min(Tt.y,ke.y)),Zt=vt.sub(De),Kt=(We.width-(rt.left+rt.right+B.padding.left+B.padding.right))/Zt.x,dr=(We.height-(rt.top+rt.bottom+B.padding.top+B.padding.bottom))/Zt.y;if(dr<0||Kt<0)return;var rr=Math.min(We.scaleZoom(We.scale*Math.min(Kt,dr)),B.maxZoom),mr=kn.convert(B.offset),Or=(B.padding.left-B.padding.right)/2,$r=(B.padding.top-B.padding.bottom)/2,Bn=new kn(mr.x+Or,mr.y+$r),on=Bn.mult(We.scale/We.zoomScale(rr)),Dn=We.unproject(Pe.add(Qe).div(2).sub(on));return{center:Dn,zoom:rr,bearing:te}}},{key:"fitInternal",value:function(y,I,te){return y?(I=eo()(y,I),delete I.padding,I.linear?this.easeTo(I,te):this.flyTo(I,te)):this}}]),c}(pf.EventEmitter);function sl(w,b){var c;if(typeof Symbol=="undefined"||w[Symbol.iterator]==null){if(Array.isArray(w)||(c=tn(w))||b&&w&&typeof w.length=="number"){c&&(w=c);var d=0,y=function(){};return{s:y,n:function(){return d>=w.length?{done:!0}:{done:!1,value:w[d++]}},e:function(Q){throw Q},f:y}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var I=!0,te=!1,B;return{s:function(){c=w[Symbol.iterator]()},n:function(){var Q=c.next();return I=Q.done,Q},e:function(Q){te=!0,B=Q},f:function(){try{!I&&c.return!=null&&c.return()}finally{if(te)throw B}}}}function tn(w,b){if(!w)return;if(typeof w=="string")return bc(w,b);var c=Object.prototype.toString.call(w).slice(8,-1);if(c==="Object"&&w.constructor&&(c=w.constructor.name),c==="Map"||c==="Set")return Array.from(w);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return bc(w,b)}function bc(w,b){(b==null||b>w.length)&&(b=w.length);for(var c=0,d=new Array(b);c<b;c++)d[c]=w[c];return d}var us={},ro=us;us.create=function(w,b,c){var d=window.document.createElement(w);return b!==void 0&&(d.className=b),c&&c.appendChild(d),d},us.createNS=function(w,b){var c=window.document.createElementNS(w,b);return c};var qo=window.document&&window.document.documentElement.style;function Rs(w){if(!qo)return w[0];var b=sl(w),c;try{for(b.s();!(c=b.n()).done;){var d=c.value;if(d in qo)return d}}catch(y){b.e(y)}finally{b.f()}return w[0]}var jl=Rs(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),kc;us.disableDrag=function(){qo&&jl&&(kc=qo[jl],qo[jl]="none")},us.enableDrag=function(){qo&&jl&&(qo[jl]=kc)};var Vs=Rs(["transform","WebkitTransform"]);us.setTransform=function(w,b){w.style[Vs]=b};var Su=!1;try{var Fl=Object.defineProperty({},"passive",{get:function(){Su=!0}});window.addEventListener("test",Fl,Fl),window.removeEventListener("test",Fl,Fl)}catch(w){Su=!1}us.addEventListener=function(w,b,c){var d=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};"passive"in d&&Su?w.addEventListener(b,c,d):w.addEventListener(b,c,d.capture)},us.removeEventListener=function(w,b,c){var d=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};"passive"in d&&Su?w.removeEventListener(b,c,d):w.removeEventListener(b,c,d.capture)};var zl=function w(b){b.preventDefault(),b.stopPropagation(),window.removeEventListener("click",w,!0)};us.suppressClick=function(){window.addEventListener("click",zl,!0),window.setTimeout(function(){window.removeEventListener("click",zl,!0)},0)},us.mousePos=function(w,b){var c=w.getBoundingClientRect();return new kn(b.clientX-c.left-w.clientLeft,b.clientY-c.top-w.clientTop)},us.touchPos=function(w,b){var c=w.getBoundingClientRect(),d=[],y=sl(b),I;try{for(y.s();!(I=y.n()).done;){var te=I.value;d.push(new kn(te.clientX-c.left-w.clientLeft,te.clientY-c.top-w.clientTop))}}catch(B){y.e(B)}finally{y.f()}return d},us.mouseButton=function(w){return typeof window.InstallTrigger!="undefined"&&w.button===2&&w.ctrlKey&&window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:w.button},us.remove=function(w){w.parentNode&&w.parentNode.removeChild(w)};function rf(w){var b=jc();return function(){var d=hr()(w),y;if(b){var I=hr()(this).constructor;y=Reflect.construct(d,arguments,I)}else y=d.apply(this,arguments);return yt()(this,y)}}function jc(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(w){return!1}}var Ro=function(w){Fe()(c,w);var b=rf(c);function c(d,y,I){var te,B=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};Ke()(this,c);var k=ro.mousePos(y.getCanvasContainer(),I),Q=y.unproject(k);return te=b.call(this,d,eo()({point:k,lngLat:Q,originalEvent:I},B)),te.type=void 0,te.target=void 0,te.originalEvent=void 0,te.point=void 0,te.lngLat=void 0,te.defaultPrevented=void 0,te.defaultPrevented=!1,te.target=y,te}return bt()(c,[{key:"preventDefault",value:function(){this.defaultPrevented=!0}}]),c}(ni);function ls(w){var b=Pa();return function(){var d=hr()(w),y;if(b){var I=hr()(this).constructor;y=Reflect.construct(d,arguments,I)}else y=d.apply(this,arguments);return yt()(this,y)}}function Pa(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(w){return!1}}var eu=function(w){Fe()(c,w);var b=ls(c);function c(d,y,I){var te;Ke()(this,c);var B=d==="touchend"?I.changedTouches:I.touches,k=ro.touchPos(y.getCanvasContainer(),B),Q=k.map(function(Pe){return y.unproject(Pe)}),We=k.reduce(function(Pe,Qe,Tt,ke){return Pe.add(Qe.div(ke.length))},new kn(0,0)),rt=y.unproject(We);return te=b.call(this,d,{points:k,point:We,lngLats:Q,lngLat:rt,originalEvent:I}),te.type=void 0,te.target=void 0,te.originalEvent=void 0,te.lngLat=void 0,te.point=void 0,te.points=void 0,te.lngLats=void 0,te.defaultPrevented=void 0,te.defaultPrevented=!1,te}return bt()(c,[{key:"preventDefault",value:function(){this.defaultPrevented=!0}}]),c}(ni);function Io(w){var b=So();return function(){var d=hr()(w),y;if(b){var I=hr()(this).constructor;y=Reflect.construct(d,arguments,I)}else y=d.apply(this,arguments);return yt()(this,y)}}function So(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(w){return!1}}var Sl=function(w){Fe()(c,w);var b=Io(c);function c(d,y,I){var te;return Ke()(this,c),te=b.call(this,d,{originalEvent:I}),te.type=void 0,te.originalEvent=void 0,te.defaultPrevented=void 0,te.target=void 0,te.defaultPrevented=!1,te}return bt()(c,[{key:"preventDefault",value:function(){this.defaultPrevented=!0}}]),c}(ni),ul=function(){function w(b){Ke()(this,w),this.map=void 0,this.delayContextMenu=void 0,this.contextMenuEvent=void 0,this.map=b}return bt()(w,[{key:"reset",value:function(){this.delayContextMenu=!1,delete this.contextMenuEvent}},{key:"mousemove",value:function(c){this.map.emit(c.type,new Ro(c.type,this.map,c))}},{key:"mousedown",value:function(){this.delayContextMenu=!0}},{key:"mouseup",value:function(){this.delayContextMenu=!1,this.contextMenuEvent&&(this.map.emit("contextmenu",new Ro("contextmenu",this.map,this.contextMenuEvent)),delete this.contextMenuEvent)}},{key:"contextmenu",value:function(c){this.delayContextMenu?this.contextMenuEvent=c:this.map.emit(c.type,new Ro(c.type,this.map,c)),this.map.listeners("contextmenu")&&c.preventDefault()}},{key:"isEnabled",value:function(){return!0}},{key:"isActive",value:function(){return!1}},{key:"enable",value:function(){return!0}},{key:"disable",value:function(){return!1}}]),w}(),pu=function(){function w(b,c){Ke()(this,w),this.map=void 0,this.el=void 0,this.container=void 0,this.enabled=void 0,this.active=void 0,this.startPos=void 0,this.lastPos=void 0,this.box=void 0,this.clickTolerance=void 0,this.map=b,this.el=b.getCanvasContainer(),this.container=b.getContainer(),this.clickTolerance=c.clickTolerance||1}return bt()(w,[{key:"isEnabled",value:function(){return!!this.enabled}},{key:"isActive",value:function(){return!!this.active}},{key:"enable",value:function(){if(this.isEnabled())return;this.enabled=!0}},{key:"disable",value:function(){if(!this.isEnabled())return;this.enabled=!1}},{key:"mousedown",value:function(c,d){if(!this.isEnabled())return;if(!(c.shiftKey&&c.button===0))return;ro.disableDrag(),this.startPos=this.lastPos=d,this.active=!0}},{key:"mousemoveWindow",value:function(c,d){if(!this.active)return;var y=d;if(this.lastPos.equals(y)||!this.box&&y.dist(this.startPos)<this.clickTolerance)return;var I=this.startPos;this.lastPos=y,this.box||(this.box=ro.create("div","l7-boxzoom",this.container),this.container.classList.add("l7-crosshair"),this.fireEvent("boxzoomstart",c));var te=Math.min(I.x,y.x),B=Math.max(I.x,y.x),k=Math.min(I.y,y.y),Q=Math.max(I.y,y.y);ro.setTransform(this.box,"translate(".concat(te,"px,").concat(k,"px)")),this.box&&(this.box.style.width="".concat(B-te,"px"),this.box.style.height="".concat(Q-k,"px"))}},{key:"mouseupWindow",value:function(c,d){var y=this;if(!this.active)return;if(c.button!==0)return;var I=this.startPos,te=d;if(this.reset(),ro.suppressClick(),I.x===te.x&&I.y===te.y)this.fireEvent("boxzoomcancel",c);else return this.map.emit("boxzoomend",new ni("boxzoomend",{originalEvent:c})),{cameraAnimation:function(k){return k.fitScreenCoordinates(I,te,y.map.getBearing(),{linear:!0})}}}},{key:"keydown",value:function(c){if(!this.active)return;c.keyCode===27&&(this.reset(),this.fireEvent("boxzoomcancel",c))}},{key:"reset",value:function(){this.active=!1,this.container.classList.remove("l7-crosshair"),this.box&&(ro.remove(this.box),this.box=null),ro.enableDrag(),delete this.startPos,delete this.lastPos}},{key:"fireEvent",value:function(c,d){return this.map.emit(c,new ni(c,{originalEvent:d}))}}]),w}(),Cs=pu,xc=function(){function w(){Ke()(this,w),this.enabled=void 0,this.active=void 0,this.reset()}return bt()(w,[{key:"reset",value:function(){this.active=!1}},{key:"dblclick",value:function(c,d){return c.preventDefault(),{cameraAnimation:function(I){I.easeTo({duration:300,zoom:I.getZoom()+(c.shiftKey?-1:1),around:I.unproject(d)},{originalEvent:c})}}}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}}]),w}();function Jn(w){var b=jn();return function(){var d=hr()(w),y;if(b){var I=hr()(this).constructor;y=Reflect.construct(d,arguments,I)}else y=d.apply(this,arguments);return yt()(this,y)}}function jn(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(w){return!1}}var Ec=function(w){Fe()(c,w);var b=Jn(c);function c(){var d;Ke()(this,c);for(var y=arguments.length,I=new Array(y),te=0;te<y;te++)I[te]=arguments[te];return d=b.call.apply(b,[this].concat(I)),d.type="renderFrame",d.timeStamp=void 0,d}return c}(ni);function cs(w,b){var c;if(typeof Symbol=="undefined"||w[Symbol.iterator]==null){if(Array.isArray(w)||(c=Do(w))||b&&w&&typeof w.length=="number"){c&&(w=c);var d=0,y=function(){};return{s:y,n:function(){return d>=w.length?{done:!0}:{done:!1,value:w[d++]}},e:function(Q){throw Q},f:y}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var I=!0,te=!1,B;return{s:function(){c=w[Symbol.iterator]()},n:function(){var Q=c.next();return I=Q.done,Q},e:function(Q){te=!0,B=Q},f:function(){try{!I&&c.return!=null&&c.return()}finally{if(te)throw B}}}}function Do(w,b){if(!w)return;if(typeof w=="string")return vo(w,b);var c=Object.prototype.toString.call(w).slice(8,-1);if(c==="Object"&&w.constructor&&(c=w.constructor.name),c==="Map"||c==="Set")return Array.from(w);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return vo(w,b)}function vo(w,b){(b==null||b>w.length)&&(b=w.length);for(var c=0,d=new Array(b);c<b;c++)d[c]=w[c];return d}var ws={linearity:.3,easing:Tl(0,0,.3,1)},Au=eo()({deceleration:2500,maxSpeed:1400},ws),ec=eo()({deceleration:20,maxSpeed:1400},ws),$a=eo()({deceleration:1e3,maxSpeed:360},ws),no=eo()({deceleration:1e3,maxSpeed:90},ws),ll=function(){function w(b){Ke()(this,w),this.map=void 0,this.inertiaBuffer=void 0,this.map=b,this.clear()}return bt()(w,[{key:"clear",value:function(){this.inertiaBuffer=[]}},{key:"record",value:function(c){this.drainInertiaBuffer(),this.inertiaBuffer.push({time:zs(),settings:c})}},{key:"drainInertiaBuffer",value:function(){for(var c=this.inertiaBuffer,d=zs(),y=160;c.length>0&&d-c[0].time>y;)c.shift()}},{key:"onMoveEnd",value:function(c){if(this.drainInertiaBuffer(),this.inertiaBuffer.length<2)return;var d={zoom:0,bearing:0,pitch:0,pan:new kn(0,0),pinchAround:void 0,around:void 0},y=cs(this.inertiaBuffer),I;try{for(y.s();!(I=y.n()).done;){var te=I.value.settings;d.zoom+=te.zoomDelta||0,d.bearing+=te.bearingDelta||0,d.pitch+=te.pitchDelta||0,te.panDelta&&d.pan._add(te.panDelta),te.around&&(d.around=te.around),te.pinchAround&&(d.pinchAround=te.pinchAround)}}catch(ke){y.e(ke)}finally{y.f()}var B=this.inertiaBuffer[this.inertiaBuffer.length-1],k=B.time-this.inertiaBuffer[0].time,Q={};if(d.pan.mag()){var We=cl(d.pan.mag(),k,eo()({},Au,c||{}));Q.offset=d.pan.mult(We.amount/d.pan.mag()),Q.center=this.map.transform.center,mu(Q,We)}if(d.zoom){var rt=cl(d.zoom,k,ec);Q.zoom=this.map.transform.zoom+rt.amount,mu(Q,rt)}if(d.bearing){var Pe=cl(d.bearing,k,$a);Q.bearing=this.map.transform.bearing+tl(Pe.amount,-179,179),mu(Q,Pe)}if(d.pitch){var Qe=cl(d.pitch,k,no);Q.pitch=this.map.transform.pitch+Qe.amount,mu(Q,Qe)}if(Q.zoom||Q.bearing){var Tt=d.pinchAround===void 0?d.around:d.pinchAround;Q.around=Tt?this.map.unproject(Tt):this.map.getCenter()}return this.clear(),eo()(Q,{noMoveStart:!0})}}]),w}();function mu(w,b){(!w.duration||w.duration<b.duration)&&(w.duration=b.duration,w.easing=b.easing)}function cl(w,b,c){var d=c.maxSpeed,y=c.linearity,I=c.deceleration,te=tl(w*y/(b/1e3),-d,d),B=Math.abs(te)/(I*y);return{easing:c.easing,duration:B*1e3,amount:te*(B/2)}}var Cu={panStep:100,bearingStep:15,pitchStep:10},Is=function(){function w(){Ke()(this,w),this.enabled=void 0,this.active=void 0,this.panStep=void 0,this.bearingStep=void 0,this.pitchStep=void 0;var b=Cu;this.panStep=b.panStep,this.bearingStep=b.bearingStep,this.pitchStep=b.pitchStep}return bt()(w,[{key:"reset",value:function(){this.active=!1}},{key:"keydown",value:function(c){var d=this;if(c.altKey||c.ctrlKey||c.metaKey)return;var y=0,I=0,te=0,B=0,k=0;switch(c.keyCode){case 61:case 107:case 171:case 187:y=1;break;case 189:case 109:case 173:y=-1;break;case 37:c.shiftKey?I=-1:(c.preventDefault(),B=-1);break;case 39:c.shiftKey?I=1:(c.preventDefault(),B=1);break;case 38:c.shiftKey?te=1:(c.preventDefault(),k=-1);break;case 40:c.shiftKey?te=-1:(c.preventDefault(),k=1);break;default:return}return{cameraAnimation:function(We){var rt=We.getZoom();We.easeTo({duration:300,easeId:"keyboardHandler",easing:Fc,zoom:y?Math.round(rt)+y*(c.shiftKey?2:1):rt,bearing:We.getBearing()+I*d.bearingStep,pitch:We.getPitch()+te*d.pitchStep,offset:[-B*d.panStep,-k*d.panStep],center:We.getCenter()},{originalEvent:c})}}}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}}]),w}();function Fc(w){return w*(2-w)}var Gs=Is,yf=function(){function w(b,c){Ke()(this,w),this.mousedownPos=void 0,this.clickTolerance=void 0,this.map=void 0,this.map=b,this.clickTolerance=c.clickTolerance}return bt()(w,[{key:"reset",value:function(){delete this.mousedownPos}},{key:"wheel",value:function(c){return this.firePreventable(new Sl(c.type,this.map,c))}},{key:"mousedown",value:function(c,d){return this.mousedownPos=d,this.firePreventable(new Ro(c.type,this.map,c))}},{key:"mouseup",value:function(c){this.map.emit(c.type,new Ro(c.type,this.map,c))}},{key:"click",value:function(c,d){if(this.mousedownPos&&this.mousedownPos.dist(d)>=this.clickTolerance)return;this.map.emit(c.type,new Ro(c.type,this.map,c))}},{key:"dblclick",value:function(c){return this.firePreventable(new Ro(c.type,this.map,c))}},{key:"mouseover",value:function(c){this.map.emit(c.type,new Ro(c.type,this.map,c))}},{key:"mouseout",value:function(c){this.map.emit(c.type,new Ro(c.type,this.map,c))}},{key:"touchstart",value:function(c){return this.firePreventable(new eu(c.type,this.map,c))}},{key:"touchmove",value:function(c){this.map.emit(c.type,new eu(c.type,this.map,c))}},{key:"touchend",value:function(c){this.map.emit(c.type,new eu(c.type,this.map,c))}},{key:"touchcancel",value:function(c){this.map.emit(c.type,new eu(c.type,this.map,c))}},{key:"firePreventable",value:function(c){if(this.map.emit(c.type,c),c.defaultPrevented)return{}}},{key:"isEnabled",value:function(){return!0}},{key:"isActive",value:function(){return!1}},{key:"enable",value:function(){return!1}},{key:"disable",value:function(){return!1}}]),w}(),Ul=o("iWIM"),Bl=o.n(Ul),Tc,fs=0,Bu=2,zc=(Tc={},yr()(Tc,fs,1),yr()(Tc,Bu,2),Tc);function Al(w,b){var c=zc[b];return w.buttons===void 0||(w.buttons&c)!==c}var Vu=function(){function w(b){Ke()(this,w),this.enabled=void 0,this.active=void 0,this.lastPoint=void 0,this.eventButton=void 0,this.moved=void 0,this.clickTolerance=void 0,this.reset(),this.clickTolerance=b.clickTolerance||1}return bt()(w,[{key:"reset",value:function(){this.active=!1,this.moved=!1,delete this.lastPoint,delete this.eventButton}},{key:"mousedown",value:function(c,d){if(this.lastPoint)return;var y=ro.mouseButton(c);if(!this.correctButton(c,y))return;this.lastPoint=d,this.eventButton=y}},{key:"mousemoveWindow",value:function(c,d){var y=this.lastPoint;if(!y)return;if(c.preventDefault(),Al(c,this.eventButton)){this.reset();return}return!this.moved&&d.dist(y)<this.clickTolerance?void 0:(this.moved=!0,this.lastPoint=d,this.move(y,d))}},{key:"mouseupWindow",value:function(c){if(!this.lastPoint)return;var d=ro.mouseButton(c);if(d!==this.eventButton)return;this.moved&&ro.suppressClick(),this.reset()}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}},{key:"correctButton",value:function(c,d){return!1}},{key:"move",value:function(c,d){return}}]),w}();function tc(w){var b=Gu();return function(){var d=hr()(w),y;if(b){var I=hr()(this).constructor;y=Reflect.construct(d,arguments,I)}else y=d.apply(this,arguments);return yt()(this,y)}}function Gu(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(w){return!1}}var Ds=function(w){Fe()(c,w);var b=tc(c);function c(){return Ke()(this,c),b.apply(this,arguments)}return bt()(c,[{key:"mousedown",value:function(y,I){Bl()(hr()(c.prototype),"mousedown",this).call(this,y,I),this.lastPoint&&(this.active=!0)}},{key:"move",value:function(y,I){return{around:I,panDelta:I.sub(y)}}},{key:"correctButton",value:function(y,I){return I===fs&&!y.ctrlKey}}]),c}(Vu);function nf(w){var b=rc();return function(){var d=hr()(w),y;if(b){var I=hr()(this).constructor;y=Reflect.construct(d,arguments,I)}else y=d.apply(this,arguments);return yt()(this,y)}}function rc(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(w){return!1}}var nc=function(w){Fe()(c,w);var b=nf(c);function c(){return Ke()(this,c),b.apply(this,arguments)}return bt()(c,[{key:"correctButton",value:function(y,I){return I===fs&&y.ctrlKey||I===Bu}},{key:"move",value:function(y,I){var te=-.5,B=(I.y-y.y)*te;if(B)return this.active=!0,{pitchDelta:B}}},{key:"contextmenu",value:function(y){y.preventDefault()}}]),c}(Vu);function ac(w){var b=s();return function(){var d=hr()(w),y;if(b){var I=hr()(this).constructor;y=Reflect.construct(d,arguments,I)}else y=d.apply(this,arguments);return yt()(this,y)}}function s(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(w){return!1}}var a=function(w){Fe()(c,w);var b=ac(c);function c(){return Ke()(this,c),b.apply(this,arguments)}return bt()(c,[{key:"contextmenu",value:function(y){y.preventDefault()}},{key:"correctButton",value:function(y,I){return I===fs&&y.ctrlKey||I===Bu}},{key:"move",value:function(y,I){var te=.8,B=(I.x-y.x)*te;if(B)return this.active=!0,{bearingDelta:B}}}]),c}(Vu),n=4.000244140625,l=1/100,v=1/450,O=2,L=function(){function w(b,c){var d=this;Ke()(this,w),this.map=void 0,this.el=void 0,this.enabled=void 0,this.active=void 0,this.zooming=void 0,this.aroundCenter=void 0,this.around=void 0,this.aroundPoint=void 0,this.type=void 0,this.lastValue=void 0,this.timeout=void 0,this.finishTimeout=void 0,this.lastWheelEvent=void 0,this.lastWheelEventTime=void 0,this.startZoom=void 0,this.targetZoom=void 0,this.delta=void 0,this.easing=void 0,this.prevEase=void 0,this.frameId=void 0,this.handler=void 0,this.defaultZoomRate=void 0,this.wheelZoomRate=void 0,this.onScrollFrame=function(){if(!d.frameId)return;if(d.frameId=null,!d.isActive())return;var y=d.map.transform;if(d.delta!==0){var I=d.type==="wheel"&&Math.abs(d.delta)>n?d.wheelZoomRate:d.defaultZoomRate,te=O/(1+Math.exp(-Math.abs(d.delta*I)));d.delta<0&&te!==0&&(te=1/te);var B=typeof d.targetZoom=="number"?y.zoomScale(d.targetZoom):y.scale;d.targetZoom=Math.min(y.maxZoom,Math.max(y.minZoom,y.scaleZoom(B*te))),d.type==="wheel"&&(d.startZoom=y.zoom,d.easing=d.smoothOutEasing(200)),d.delta=0}var k=typeof d.targetZoom=="number"?d.targetZoom:y.zoom,Q=d.startZoom,We=d.easing,rt=!1,Pe;if(d.type==="wheel"&&Q&&We){var Qe=Math.min((zs()-d.lastWheelEventTime)/200,1),Tt=We(Qe);Pe=qs(Q,k,Tt),Qe<1?d.frameId||(d.frameId=!0):rt=!0}else Pe=k,rt=!0;return d.active=!0,rt&&(d.active=!1,d.finishTimeout=setTimeout(function(){d.zooming=!1,d.handler.triggerRenderFrame(),delete d.targetZoom,delete d.finishTimeout},200)),{noInertia:!0,needsRenderFrame:!rt,zoomDelta:Pe-y.zoom,around:d.aroundPoint,originalEvent:d.lastWheelEvent}},this.map=b,this.el=b.getCanvasContainer(),this.handler=c,this.delta=0,this.defaultZoomRate=l,this.wheelZoomRate=v}return bt()(w,[{key:"setZoomRate",value:function(c){this.defaultZoomRate=c}},{key:"setWheelZoomRate",value:function(c){this.wheelZoomRate=c}},{key:"isEnabled",value:function(){return!!this.enabled}},{key:"isActive",value:function(){return!!this.active||this.finishTimeout!==void 0}},{key:"isZooming",value:function(){return!!this.zooming}},{key:"enable",value:function(c){if(this.isEnabled())return;this.enabled=!0,this.aroundCenter=c&&c.around==="center"}},{key:"disable",value:function(){if(!this.isEnabled())return;this.enabled=!1}},{key:"wheel",value:function(c){if(!this.isEnabled())return;var d=c.deltaMode===window.WheelEvent.DOM_DELTA_LINE?c.deltaY*40:c.deltaY,y=zs(),I=y-(this.lastWheelEventTime||0);this.lastWheelEventTime=y,d!==0&&d%n===0?this.type="wheel":d!==0&&Math.abs(d)<4?this.type="trackpad":I>400?(this.type=null,this.lastValue=d,this.timeout=setTimeout(this.onTimeout,40,c)):this.type||(this.type=Math.abs(I*d)<200?"trackpad":"wheel",this.timeout&&(clearTimeout(this.timeout),this.timeout=null,d+=this.lastValue)),c.shiftKey&&d&&(d=d/4),this.type&&(this.lastWheelEvent=c,this.delta-=d,this.active||this.start(c)),c.preventDefault()}},{key:"renderFrame",value:function(){return this.onScrollFrame()}},{key:"reset",value:function(){this.active=!1}},{key:"onTimeout",value:function(c){this.type="wheel",this.delta-=this.lastValue,this.active||this.start(c)}},{key:"start",value:function(c){if(!this.delta)return;this.frameId&&(this.frameId=null),this.active=!0,this.isZooming()||(this.zooming=!0),this.finishTimeout&&(clearTimeout(this.finishTimeout),delete this.finishTimeout);var d=ro.mousePos(this.el,c);this.around=fi.convert(this.aroundCenter?this.map.getCenter():this.map.unproject(d)),this.aroundPoint=this.map.transform.locationPoint(this.around),this.frameId||(this.frameId=!0,this.handler.triggerRenderFrame())}},{key:"smoothOutEasing",value:function(c){var d=ql;if(this.prevEase){var y=this.prevEase,I=(zs()-y.start)/y.duration,te=y.easing(I+.01)-y.easing(I),B=.27/Math.sqrt(te*te+1e-4)*.01,k=Math.sqrt(.27*.27-B*B);d=Tl(B,k,.25,1)}return this.prevEase={start:zs(),duration:c,easing:d},d}}]),w}(),j=L,ue=function(){function w(b,c){Ke()(this,w),this.clickZoom=void 0,this.tapZoom=void 0,this.clickZoom=b,this.tapZoom=c}return bt()(w,[{key:"enable",value:function(){this.clickZoom.enable(),this.tapZoom.enable()}},{key:"disable",value:function(){this.clickZoom.disable(),this.tapZoom.disable()}},{key:"isEnabled",value:function(){return this.clickZoom.isEnabled()&&this.tapZoom.isEnabled()}},{key:"isActive",value:function(){return this.clickZoom.isActive()||this.tapZoom.isActive()}}]),w}(),Ee=function(){function w(b,c,d){Ke()(this,w),this.inertiaOptions=void 0,this.el=void 0,this.mousePan=void 0,this.touchPan=void 0,this.el=b,this.mousePan=c,this.touchPan=d}return bt()(w,[{key:"enable",value:function(c){this.inertiaOptions=c||{},this.mousePan.enable(),this.touchPan.enable(),this.el.classList.add("l7-touch-drag-pan")}},{key:"disable",value:function(){this.mousePan.disable(),this.touchPan.disable(),this.el.classList.remove("l7-touch-drag-pan")}},{key:"isEnabled",value:function(){return this.mousePan.isEnabled()&&this.touchPan.isEnabled()}},{key:"isActive",value:function(){return this.mousePan.isActive()||this.touchPan.isActive()}}]),w}(),$e=function(){function w(b,c,d){Ke()(this,w),this.mouseRotate=void 0,this.mousePitch=void 0,this.pitchWithRotate=void 0,this.pitchWithRotate=b.pitchWithRotate,this.mouseRotate=c,this.mousePitch=d}return bt()(w,[{key:"enable",value:function(){this.mouseRotate.enable(),this.pitchWithRotate&&this.mousePitch.enable()}},{key:"disable",value:function(){this.mouseRotate.disable(),this.mousePitch.disable()}},{key:"isEnabled",value:function(){return this.mouseRotate.isEnabled()&&(!this.pitchWithRotate||this.mousePitch.isEnabled())}},{key:"isActive",value:function(){return this.mouseRotate.isActive()||this.mousePitch.isActive()}}]),w}(),nt=function(){function w(b,c,d,y){Ke()(this,w),this.el=void 0,this.touchZoom=void 0,this.touchRotate=void 0,this.tapDragZoom=void 0,this.rotationDisabled=void 0,this.enabled=void 0,this.el=b,this.touchZoom=c,this.touchRotate=d,this.tapDragZoom=y,this.rotationDisabled=!1,this.enabled=!0}return bt()(w,[{key:"enable",value:function(c){this.touchZoom.enable(c),this.rotationDisabled||this.touchRotate.enable(c),this.tapDragZoom.enable(),this.el.classList.add("l7-touch-zoom-rotate")}},{key:"disable",value:function(){this.touchZoom.disable(),this.touchRotate.disable(),this.tapDragZoom.disable(),this.el.classList.remove("l7-touch-zoom-rotate")}},{key:"isEnabled",value:function(){return this.touchZoom.isEnabled()&&(this.rotationDisabled||this.touchRotate.isEnabled())&&this.tapDragZoom.isEnabled()}},{key:"isActive",value:function(){return this.touchZoom.isActive()||this.touchRotate.isActive()||this.tapDragZoom.isActive()}},{key:"disableRotation",value:function(){this.rotationDisabled=!0,this.touchRotate.disable()}},{key:"enableRotation",value:function(){this.rotationDisabled=!1,this.touchZoom.isEnabled()&&this.touchRotate.enable()}}]),w}();function at(w,b){for(var c={},d=0;d<w.length;d++)c[w[d].identifier]=b[d];return c}function Ft(w,b){var c;if(typeof Symbol=="undefined"||w[Symbol.iterator]==null){if(Array.isArray(w)||(c=Nt(w))||b&&w&&typeof w.length=="number"){c&&(w=c);var d=0,y=function(){};return{s:y,n:function(){return d>=w.length?{done:!0}:{done:!1,value:w[d++]}},e:function(Q){throw Q},f:y}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var I=!0,te=!1,B;return{s:function(){c=w[Symbol.iterator]()},n:function(){var Q=c.next();return I=Q.done,Q},e:function(Q){te=!0,B=Q},f:function(){try{!I&&c.return!=null&&c.return()}finally{if(te)throw B}}}}function Nt(w,b){if(!w)return;if(typeof w=="string")return Jt(w,b);var c=Object.prototype.toString.call(w).slice(8,-1);if(c==="Object"&&w.constructor&&(c=w.constructor.name),c==="Map"||c==="Set")return Array.from(w);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return Jt(w,b)}function Jt(w,b){(b==null||b>w.length)&&(b=w.length);for(var c=0,d=new Array(b);c<b;c++)d[c]=w[c];return d}function jt(w){var b=new kn(0,0),c=Ft(w),d;try{for(c.s();!(d=c.n()).done;){var y=d.value;b._add(y)}}catch(I){c.e(I)}finally{c.f()}return b.div(w.length)}var Gt=500,ar=500,nr=30,Rr=function(){function w(b){Ke()(this,w),this.numTouches=void 0,this.centroid=void 0,this.startTime=void 0,this.aborted=void 0,this.touches=void 0,this.reset(),this.numTouches=b.numTouches}return bt()(w,[{key:"reset",value:function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}},{key:"touchstart",value:function(c,d,y){if((this.centroid||y.length>this.numTouches)&&(this.aborted=!0),this.aborted)return;this.startTime===void 0&&(this.startTime=c.timeStamp),y.length===this.numTouches&&(this.centroid=jt(d),this.touches=at(y,d))}},{key:"touchmove",value:function(c,d,y){if(this.aborted||!this.centroid)return;var I=at(y,d);for(var te in this.touches)if(this.touches[te]){var B=this.touches[te],k=I[te];(!k||k.dist(B)>nr)&&(this.aborted=!0)}}},{key:"touchend",value:function(c,d,y){if((!this.centroid||c.timeStamp-this.startTime>ar)&&(this.aborted=!0),y.length===0){var I=!this.aborted&&this.centroid;if(this.reset(),I)return I}}}]),w}(),gr=function(){function w(b){Ke()(this,w),this.singleTap=void 0,this.numTaps=void 0,this.lastTime=void 0,this.lastTap=void 0,this.count=void 0,this.singleTap=new Rr(b),this.numTaps=b.numTaps,this.reset()}return bt()(w,[{key:"reset",value:function(){this.lastTime=Infinity,delete this.lastTap,this.count=0,this.singleTap.reset()}},{key:"touchstart",value:function(c,d,y){this.singleTap.touchstart(c,d,y)}},{key:"touchmove",value:function(c,d,y){this.singleTap.touchmove(c,d,y)}},{key:"touchend",value:function(c,d,y){var I=this.singleTap.touchend(c,d,y);if(I){var te=c.timeStamp-this.lastTime<Gt,B=!this.lastTap||this.lastTap.dist(I)<nr;if((!te||!B)&&this.reset(),this.count++,this.lastTime=c.timeStamp,this.lastTap=I,this.count===this.numTaps)return this.reset(),I}}}]),w}(),Ar=function(){function w(){Ke()(this,w),this.enabled=void 0,this.active=void 0,this.swipePoint=void 0,this.swipeTouch=void 0,this.tapTime=void 0,this.tap=void 0,this.tap=new gr({numTouches:1,numTaps:1}),this.reset()}return bt()(w,[{key:"reset",value:function(){this.active=!1,delete this.swipePoint,delete this.swipeTouch,delete this.tapTime,this.tap.reset()}},{key:"touchstart",value:function(c,d,y){if(this.swipePoint)return;this.tapTime&&c.timeStamp-this.tapTime>Gt&&this.reset(),this.tapTime?y.length>0&&(this.swipePoint=d[0],this.swipeTouch=y[0].identifier):this.tap.touchstart(c,d,y)}},{key:"touchmove",value:function(c,d,y){if(!this.tapTime)this.tap.touchmove(c,d,y);else if(this.swipePoint){if(y[0].identifier!==this.swipeTouch)return;var I=d[0],te=I.y-this.swipePoint.y;return this.swipePoint=I,c.preventDefault(),this.active=!0,{zoomDelta:te/128}}}},{key:"touchend",value:function(c,d,y){if(this.tapTime)this.swipePoint&&(y.length===0&&this.reset());else{var I=this.tap.touchend(c,d,y);I&&(this.tapTime=c.timeStamp)}}},{key:"touchcancel",value:function(){this.reset()}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}}]),w}(),Cr=function(){function w(){Ke()(this,w),this.enabled=void 0,this.active=void 0,this.zoomIn=void 0,this.zoomOut=void 0,this.zoomIn=new gr({numTouches:1,numTaps:2}),this.zoomOut=new gr({numTouches:2,numTaps:1}),this.reset()}return bt()(w,[{key:"reset",value:function(){this.active=!1,this.zoomIn.reset(),this.zoomOut.reset()}},{key:"touchstart",value:function(c,d,y){this.zoomIn.touchstart(c,d,y),this.zoomOut.touchstart(c,d,y)}},{key:"touchmove",value:function(c,d,y){this.zoomIn.touchmove(c,d,y),this.zoomOut.touchmove(c,d,y)}},{key:"touchend",value:function(c,d,y){var I=this,te=this.zoomIn.touchend(c,d,y),B=this.zoomOut.touchend(c,d,y);if(te)return this.active=!0,c.preventDefault(),setTimeout(function(){return I.reset()},0),{cameraAnimation:function(Q){return Q.easeTo({duration:300,zoom:Q.getZoom()+1,around:Q.unproject(te)},{originalEvent:c})}};if(B)return this.active=!0,c.preventDefault(),setTimeout(function(){return I.reset()},0),{cameraAnimation:function(Q){return Q.easeTo({duration:300,zoom:Q.getZoom()-1,around:Q.unproject(B)},{originalEvent:c})}}}},{key:"touchcancel",value:function(){this.reset()}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}}]),w}(),an=function(){function w(b){Ke()(this,w),this.enabled=void 0,this.active=void 0,this.touches=void 0,this.minTouches=void 0,this.clickTolerance=void 0,this.sum=void 0,this.minTouches=1,this.clickTolerance=b.clickTolerance||1,this.reset()}return bt()(w,[{key:"reset",value:function(){this.active=!1,this.touches={},this.sum=new kn(0,0)}},{key:"touchstart",value:function(c,d,y){return this.calculateTransform(c,d,y)}},{key:"touchmove",value:function(c,d,y){return this.active?(c.preventDefault(),this.calculateTransform(c,d,y)):void 0}},{key:"touchend",value:function(c,d,y){this.calculateTransform(c,d,y),this.active&&y.length<this.minTouches&&this.reset()}},{key:"touchcancel",value:function(){this.reset()}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}},{key:"calculateTransform",value:function(c,d,y){y.length>0&&(this.active=!0);var I=at(y,d),te=new kn(0,0),B=new kn(0,0),k=0;for(var Q in I)if(I[Q]){var We=I[Q],rt=this.touches[Q];rt&&(te._add(We),B._add(We.sub(rt)),k++,I[Q]=We)}if(this.touches=I,k<this.minTouches||!B.mag())return;var Pe=B.div(k);if(this.sum._add(Pe),this.sum.mag()<this.clickTolerance)return;var Qe=te.div(k);return{around:Qe,panDelta:Pe}}}]),w}(),Yr=function(){function w(){Ke()(this,w),this.enabled=void 0,this.active=void 0,this.firstTwoTouches=void 0,this.vector=void 0,this.startVector=void 0,this.aroundCenter=void 0,this.reset()}return bt()(w,[{key:"reset",value:function(){this.active=!1,delete this.firstTwoTouches}},{key:"start",value:function(c){return}},{key:"move",value:function(c,d,y){return}},{key:"touchstart",value:function(c,d,y){if(this.firstTwoTouches||y.length<2)return;this.firstTwoTouches=[y[0].identifier,y[1].identifier],this.start([d[0],d[1]])}},{key:"touchmove",value:function(c,d,y){if(!this.firstTwoTouches)return;c.preventDefault();var I=bn()(this.firstTwoTouches,2),te=I[0],B=I[1],k=vn(y,d,te),Q=vn(y,d,B);if(!k||!Q)return;var We=this.aroundCenter?null:k.add(Q).div(2);return this.move([k,Q],We,c)}},{key:"touchend",value:function(c,d,y){if(!this.firstTwoTouches)return;var I=bn()(this.firstTwoTouches,2),te=I[0],B=I[1],k=vn(y,d,te),Q=vn(y,d,B);if(k&&Q)return;this.active&&ro.suppressClick(),this.reset()}},{key:"touchcancel",value:function(){this.reset()}},{key:"enable",value:function(c){this.enabled=!0,this.aroundCenter=!!c&&c.around==="center"}},{key:"disable",value:function(){this.enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this.enabled}},{key:"isActive",value:function(){return this.active}}]),w}();function vn(w,b,c){for(var d=0;d<w.length;d++)if(w[d].identifier===c)return b[d]}function Pn(w){var b=qn();return function(){var d=hr()(w),y;if(b){var I=hr()(this).constructor;y=Reflect.construct(d,arguments,I)}else y=d.apply(this,arguments);return yt()(this,y)}}function qn(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(w){return!1}}function sa(w){return Math.abs(w.y)>Math.abs(w.x)}var Aa=100,Wa=function(w){Fe()(c,w);var b=Pn(c);function c(){var d;Ke()(this,c);for(var y=arguments.length,I=new Array(y),te=0;te<y;te++)I[te]=arguments[te];return d=b.call.apply(b,[this].concat(I)),d.valid=void 0,d.firstMove=void 0,d.lastPoints=void 0,d}return bt()(c,[{key:"reset",value:function(){Bl()(hr()(c.prototype),"reset",this).call(this),this.valid=void 0,delete this.firstMove,delete this.lastPoints}},{key:"start",value:function(y){this.lastPoints=y,sa(y[0].sub(y[1]))&&(this.valid=!1)}},{key:"move",value:function(y,I,te){var B=y[0].sub(this.lastPoints[0]),k=y[1].sub(this.lastPoints[1]);if(this.valid=this.gestureBeginsVertically(B,k,te.timeStamp),!this.valid)return;this.lastPoints=y,this.active=!0;var Q=(B.y+k.y)/2,We=-.5;return{pitchDelta:Q*We}}},{key:"gestureBeginsVertically",value:function(y,I,te){if(this.valid!==void 0)return this.valid;var B=2,k=y.mag()>=B,Q=I.mag()>=B;if(!k&&!Q)return;if(!k||!Q)return this.firstMove===void 0&&(this.firstMove=te),te-this.firstMove<Aa?void 0:!1;var We=y.y>0===I.y>0;return sa(y)&&sa(I)&&We}}]),c}(Yr);function _n(w){var b=ua();return function(){var d=hr()(w),y;if(b){var I=hr()(this).constructor;y=Reflect.construct(d,arguments,I)}else y=d.apply(this,arguments);return yt()(this,y)}}function ua(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(w){return!1}}var xa=25;function Zn(w,b){return w.angleWith(b)*180/Math.PI}var Ca=function(w){Fe()(c,w);var b=_n(c);function c(){var d;Ke()(this,c);for(var y=arguments.length,I=new Array(y),te=0;te<y;te++)I[te]=arguments[te];return d=b.call.apply(b,[this].concat(I)),d.minDiameter=void 0,d}return bt()(c,[{key:"reset",value:function(){Bl()(hr()(c.prototype),"reset",this).call(this),delete this.minDiameter,delete this.startVector,delete this.vector}},{key:"start",value:function(y){this.startVector=this.vector=y[0].sub(y[1]),this.minDiameter=y[0].dist(y[1])}},{key:"move",value:function(y,I){var te=this.vector;return this.vector=y[0].sub(y[1]),!this.active&&this.isBelowThreshold(this.vector)?void 0:(this.active=!0,{bearingDelta:Zn(this.vector,te),pinchAround:I})}},{key:"isBelowThreshold",value:function(y){this.minDiameter=Math.min(this.minDiameter,y.mag());var I=Math.PI*this.minDiameter,te=xa/I*360,B=Zn(y,this.startVector);return Math.abs(B)<te}}]),c}(Yr);function ia(w){var b=La();return function(){var d=hr()(w),y;if(b){var I=hr()(this).constructor;y=Reflect.construct(d,arguments,I)}else y=d.apply(this,arguments);return yt()(this,y)}}function La(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(w){return!1}}var za=.1;function Hi(w,b){return Math.log(w/b)/Math.LN2}var Ai=function(w){Fe()(c,w);var b=ia(c);function c(){var d;Ke()(this,c);for(var y=arguments.length,I=new Array(y),te=0;te<y;te++)I[te]=arguments[te];return d=b.call.apply(b,[this].concat(I)),d.distance=void 0,d.startDistance=void 0,d}return bt()(c,[{key:"reset",value:function(){Bl()(hr()(c.prototype),"reset",this).call(this),delete this.distance,delete this.startDistance}},{key:"start",value:function(y){this.startDistance=this.distance=y[0].dist(y[1])}},{key:"move",value:function(y,I){var te=this.distance;return this.distance=y[0].dist(y[1]),!this.active&&Math.abs(Hi(this.distance,this.startDistance))<za?void 0:(this.active=!0,{zoomDelta:Hi(this.distance,te),pinchAround:I})}}]),c}(Yr);function Ni(w,b){var c;if(typeof Symbol=="undefined"||w[Symbol.iterator]==null){if(Array.isArray(w)||(c=Ei(w))||b&&w&&typeof w.length=="number"){c&&(w=c);var d=0,y=function(){};return{s:y,n:function(){return d>=w.length?{done:!0}:{done:!1,value:w[d++]}},e:function(Q){throw Q},f:y}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var I=!0,te=!1,B;return{s:function(){c=w[Symbol.iterator]()},n:function(){var Q=c.next();return I=Q.done,Q},e:function(Q){te=!0,B=Q},f:function(){try{!I&&c.return!=null&&c.return()}finally{if(te)throw B}}}}function Ei(w,b){if(!w)return;if(typeof w=="string")return Bi(w,b);var c=Object.prototype.toString.call(w).slice(8,-1);if(c==="Object"&&w.constructor&&(c=w.constructor.name),c==="Map"||c==="Set")return Array.from(w);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return Bi(w,b)}function Bi(w,b){(b==null||b>w.length)&&(b=w.length);for(var c=0,d=new Array(b);c<b;c++)d[c]=w[c];return d}var es=function(b){return b.zoom||b.drag||b.pitch||b.rotate};function ts(w){return w.panDelta&&w.panDelta.mag()||w.zoomDelta||w.bearingDelta||w.pitchDelta}var vu=function(){function w(b,c){var d=this;Ke()(this,w),this.map=void 0,this.el=void 0,this.handlers=void 0,this.eventsInProgress=void 0,this.frameId=void 0,this.inertia=void 0,this.bearingSnap=void 0,this.handlersById=void 0,this.updatingCamera=void 0,this.changes=void 0,this.previousActiveHandlers=void 0,this.bearingChanged=void 0,this.listeners=void 0,this.handleWindowEvent=function(rt){d.handleEvent(rt,"".concat(rt.type,"Window"))},this.handleEvent=function(rt,Pe){if(rt.type==="blur"){d.stop();return}d.updatingCamera=!0;var Qe=rt.type==="renderFrame"?void 0:rt,Tt={needsRenderFrame:!1},ke={},vt={},De=rt.touches?d.getMapTouches(rt.touches):void 0,Zt=De?ro.touchPos(d.el,De):ro.mousePos(d.el,rt),Kt=Ni(d.handlers),dr;try{for(Kt.s();!(dr=Kt.n()).done;){var rr=dr.value,mr=rr.handlerName,Or=rr.handler,$r=rr.allowed;if(!Or.isEnabled())continue;var Bn=void 0;if(d.blockedByActive(vt,$r,mr))Or.reset();else{var on=Pe||rt.type;Or&&Or[on]&&(Bn=Or[on](rt,Zt,De),d.mergeIHandlerResult(Tt,ke,Bn,mr,Qe),Bn&&Bn.needsRenderFrame&&d.triggerRenderFrame())}(Bn||Or.isActive())&&(vt[mr]=Or)}}catch(ri){Kt.e(ri)}finally{Kt.f()}var Dn={};for(var ca in d.previousActiveHandlers)vt[ca]||(Dn[ca]=Qe);d.previousActiveHandlers=vt,(Object.keys(Dn).length||ts(Tt))&&(d.changes.push([Tt,ke,Dn]),d.triggerRenderFrame()),(Object.keys(vt).length||ts(Tt))&&d.map.stop(!0),d.updatingCamera=!1;var Na=Tt.cameraAnimation;Na&&(d.inertia.clear(),d.fireEvents({},{}),d.changes=[],Na(d.map))},this.map=b,this.el=this.map.getCanvasContainer(),this.handlers=[],this.handlersById={},this.changes=[],this.inertia=new ll(b),this.bearingSnap=c.bearingSnap,this.previousActiveHandlers={},this.eventsInProgress={},this.addDefaultHandlers(c);var y=this.el;this.listeners=[[y,"touchstart",{passive:!1}],[y,"touchmove",{passive:!1}],[y,"touchend",void 0],[y,"touchcancel",void 0],[y,"mousedown",void 0],[y,"mousemove",void 0],[y,"mouseup",void 0],[window.document,"mousemove",{capture:!0}],[window.document,"mouseup",void 0],[y,"mouseover",void 0],[y,"mouseout",void 0],[y,"dblclick",void 0],[y,"click",void 0],[y,"keydown",{capture:!1}],[y,"keyup",void 0],[y,"wheel",{passive:!1}],[y,"contextmenu",void 0],[window,"blur",void 0]];var I=Ni(this.listeners),te;try{for(I.s();!(te=I.n()).done;){var B=bn()(te.value,3),k=B[0],Q=B[1],We=B[2];ro.addEventListener(k,Q,k===window.document?this.handleWindowEvent:this.handleEvent,We)}}catch(rt){I.e(rt)}finally{I.f()}}return bt()(w,[{key:"destroy",value:function(){var c=Ni(this.listeners),d;try{for(c.s();!(d=c.n()).done;){var y=bn()(d.value,3),I=y[0],te=y[1],B=y[2];ro.removeEventListener(I,te,I===window.document?this.handleWindowEvent:this.handleEvent,B)}}catch(k){c.e(k)}finally{c.f()}}},{key:"stop",value:function(){if(this.updatingCamera)return;var c=Ni(this.handlers),d;try{for(c.s();!(d=c.n()).done;){var y=d.value.handler;y.reset()}}catch(I){c.e(I)}finally{c.f()}this.inertia.clear(),this.fireEvents({},{}),this.changes=[]}},{key:"isActive",value:function(){var c=Ni(this.handlers),d;try{for(c.s();!(d=c.n()).done;){var y=d.value.handler;if(y.isActive())return!0}}catch(I){c.e(I)}finally{c.f()}return!1}},{key:"isZooming",value:function(){return!!this.eventsInProgress.zoom||this.map.scrollZoom.isZooming()}},{key:"isRotating",value:function(){return!!this.eventsInProgress.rotate}},{key:"isMoving",value:function(){return Boolean(es(this.eventsInProgress))||this.isZooming()}},{key:"mergeIHandlerResult",value:function(c,d,y,I,te){if(!y)return;eo()(c,y);var B={handlerName:I,originalEvent:y.originalEvent||te};y.zoomDelta!==void 0&&(d.zoom=B),y.panDelta!==void 0&&(d.drag=B),y.pitchDelta!==void 0&&(d.pitch=B),y.bearingDelta!==void 0&&(d.rotate=B)}},{key:"triggerRenderFrame",value:function(){var c=this;this.frameId===void 0&&(this.frameId=this.map.requestRenderFrame(function(d){delete c.frameId,c.handleEvent(new Ec("renderFrame",{timeStamp:d})),c.applyChanges()}))}},{key:"addDefaultHandlers",value:function(c){var d=this.map,y=d.getCanvasContainer();this.add("mapEvent",new yf(d,c));var I=d.boxZoom=new Cs(d,c);this.add("boxZoom",I);var te=new Cr,B=new xc;d.doubleClickZoom=new ue(B,te),this.add("tapZoom",te),this.add("clickZoom",B);var k=new Ar;this.add("tapDragZoom",k);var Q=d.touchPitch=new Wa;this.add("touchPitch",Q);var We=new nc(c),rt=new a(c);d.dragRotate=new $e(c,We,rt),this.add("mouseRotate",We,["mousePitch"]),this.add("mousePitch",rt,["mouseRotate"]);var Pe=new Ds(c),Qe=new an(c);d.dragPan=new Ee(y,Pe,Qe),this.add("mousePan",Pe),this.add("touchPan",Qe,["touchZoom","touchRotate"]);var Tt=new Ca,ke=new Ai;d.touchZoomRotate=new nt(y,ke,Tt,k),this.add("touchRotate",Tt,["touchPan","touchZoom"]),this.add("touchZoom",ke,["touchPan","touchRotate"]);var vt=d.scrollZoom=new j(d,this);this.add("scrollZoom",vt,["mousePan"]);var De=d.keyboard=new Gs;this.add("keyboard",De),this.add("blockableMapEvent",new ul(d));for(var Zt=0,Kt=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];Zt<Kt.length;Zt++){var dr=Kt[Zt];c.interactive&&c[dr]&&d[dr].enable(c[dr])}}},{key:"add",value:function(c,d,y){this.handlers.push({handlerName:c,handler:d,allowed:y}),this.handlersById[c]=d}},{key:"blockedByActive",value:function(c,d,y){for(var I in c){if(I===y)continue;if(!d||d.indexOf(I)<0)return!0}return!1}},{key:"getMapTouches",value:function(c){var d=[],y=Ni(c),I;try{for(y.s();!(I=y.n()).done;){var te=I.value,B=te.target;this.el.contains(B)&&d.push(te)}}catch(k){y.e(k)}finally{y.f()}return d}},{key:"applyChanges",value:function(){var c={},d={},y={},I=Ni(this.changes),te;try{for(I.s();!(te=I.n()).done;){var B=bn()(te.value,3),k=B[0],Q=B[1],We=B[2];k.panDelta&&(c.panDelta=(c.panDelta||new kn(0,0))._add(k.panDelta)),k.zoomDelta&&(c.zoomDelta=(c.zoomDelta||0)+k.zoomDelta),k.bearingDelta&&(c.bearingDelta=(c.bearingDelta||0)+k.bearingDelta),k.pitchDelta&&(c.pitchDelta=(c.pitchDelta||0)+k.pitchDelta),k.around!==void 0&&(c.around=k.around),k.pinchAround!==void 0&&(c.pinchAround=k.pinchAround),k.noInertia&&(c.noInertia=k.noInertia),eo()(d,Q),eo()(y,We)}}catch(rt){I.e(rt)}finally{I.f()}this.updateMapTransform(c,d,y),this.changes=[]}},{key:"updateMapTransform",value:function(c,d,y){var I=this.map,te=I.transform;if(!ts(c))return this.fireEvents(d,y);var B=c.panDelta,k=c.zoomDelta,Q=c.bearingDelta,We=c.pitchDelta,rt=c.pinchAround,Pe=c.around;rt!==void 0&&(Pe=rt),I.stop(!0),Pe=Pe||I.transform.centerPoint;var Qe=te.pointLocation(B?Pe.sub(B):Pe);Q&&(te.bearing+=Q),We&&(te.pitch+=We),k&&(te.zoom+=k),te.setLocationAtPoint(Qe,Pe),this.map.update(),c.noInertia||this.inertia.record(c),this.fireEvents(d,y)}},{key:"fireEvents",value:function(c,d){var y=this,I=es(this.eventsInProgress),te=es(c),B={};for(var k in c)if(c[k]){var Q=c[k].originalEvent;this.eventsInProgress[k]||(B["".concat(k,"start")]=Q),this.eventsInProgress[k]=c[k]}!I&&te&&this.fireEvent("movestart",te.originalEvent);for(var We in B)B[We]&&this.fireEvent(We,B[We]);c.rotate&&(this.bearingChanged=!0),te&&this.fireEvent("move",te.originalEvent);for(var rt in c)if(c[rt]){var Pe=c[rt].originalEvent;this.fireEvent(rt,Pe)}var Qe={},Tt;for(var ke in this.eventsInProgress)if(this.eventsInProgress[ke]){var vt=this.eventsInProgress[ke],De=vt.handlerName,Zt=vt.originalEvent;this.handlersById[De].isActive()||(delete this.eventsInProgress[ke],Tt=d[De]||Zt,Qe["".concat(ke,"end")]=Tt)}for(var Kt in Qe)Qe[Kt]&&this.fireEvent(Kt,Qe[Kt]);var dr=es(this.eventsInProgress);if((I||te)&&!dr){this.updatingCamera=!0;var rr=this.inertia.onMoveEnd(this.map.dragPan.inertiaOptions),mr=function($r){return $r!==0&&-y.bearingSnap<$r&&$r<y.bearingSnap};rr?(mr(rr.bearing||this.map.getBearing())&&(rr.bearing=0),this.map.easeTo(rr,{originalEvent:Tt})):(this.map.emit("moveend",new ni("moveend",{originalEvent:Tt})),mr(this.map.getBearing())&&this.map.resetNorth()),this.bearingChanged=!1,this.updatingCamera=!1}}},{key:"fireEvent",value:function(c,d){this.map.emit(c,new ni(c,d?{originalEvent:d}:{}))}}]),w}(),wu=vu,hs=o("DzJC"),Hs=o.n(hs),Ou=function(){function w(b){var c=this;Ke()(this,w),this.map=void 0,this.updateHash=void 0,this.hashName=void 0,this.onHashChange=function(){var d=c.getCurrentHash();if(d.length>=3&&!d.some(function(I){return isNaN(+I)})){var y=c.map.dragRotate.isEnabled()&&c.map.touchZoomRotate.isEnabled()?+(d[3]||0):c.map.getBearing();return c.map.jumpTo({center:[+d[2],+d[1]],zoom:+d[0],bearing:y,pitch:+(d[4]||0)}),!0}return!1},this.getCurrentHash=function(){var d=window.location.hash.replace("#","");if(c.hashName){var y;return d.split("&").map(function(I){return I.split("=")}).forEach(function(I){I[0]===c.hashName&&(y=I)}),(y&&y[1]||"").split("/")}return d.split("/")},this.updateHashUnthrottled=function(){var d=c.getHashString();try{window.history.replaceState(window.history.state,"",d)}catch(y){}},this.hashName=b&&encodeURIComponent(b),this.updateHash=Hs()(this.updateHashUnthrottled,30*1e3/100)}return bt()(w,[{key:"addTo",value:function(c){return this.map=c,window.addEventListener("hashchange",this.onHashChange,!1),this.map.on("moveend",this.updateHash),this}},{key:"remove",value:function(){return window.removeEventListener("hashchange",this.onHashChange,!1),this.map.off("moveend",this.updateHash),delete this.map,this}},{key:"getHashString",value:function(c){var d=this.map.getCenter(),y=Math.round(this.map.getZoom()*100)/100,I=Math.ceil((y*Math.LN2+Math.log(512/360/.5))/Math.LN10),te=Math.pow(10,I),B=Math.round(d.lng*te)/te,k=Math.round(d.lat*te)/te,Q=this.map.getBearing(),We=this.map.getPitch(),rt="";if(c?rt+="/".concat(B,"/").concat(k,"/").concat(y):rt+="".concat(y,"/").concat(k,"/").concat(B),(Q||We)&&(rt+="/".concat(Math.round(Q*10)/10)),We&&(rt+="/".concat(Math.round(We))),this.hashName){var Pe=this.hashName,Qe=!1,Tt=window.location.hash.slice(1).split("&").map(function(ke){var vt=ke.split("=")[0];return vt===Pe?(Qe=!0,"".concat(vt,"=").concat(rt)):ke}).filter(function(ke){return ke});return Qe||Tt.push("".concat(Pe,"=").concat(rt)),"#".concat(Tt.join("&"))}return"#".concat(rt)}}]),w}(),ic=Ou,tu=null,Hu=[],oc=30,ru=1e3/oc,Mu=window.performance,ds={create:"create",load:"load",fullLoad:"fullLoad"},ao={mark:function(b){Mu.mark(b)},frame:function(b){var c=b;if(tu!=null){var d=c-tu;Hu.push(d)}tu=c},clearMetrics:function(){tu=null,Hu=[],Mu.clearMeasures("loadTime"),Mu.clearMeasures("fullLoadTime");for(var b in ds)Mu.clearMarks(ds[b])},getPerformanceMetrics:function(){var b=Mu.measure("loadTime",ds.create,ds.load).duration,c=Mu.measure("fullLoadTime",ds.create,ds.fullLoad).duration,d=Hu.length,y=Hu.reduce(function(k,Q){return k+Q},0)/d/1e3,I=1/y,te=Hu.filter(function(k){return k>ru}).reduce(function(k,Q){return k+(Q-ru)/ru},0),B=te/(d+te)*100;return{loadTime:b,fullLoadTime:c,fps:I,percentDroppedFrames:B}}};function Zu(w,b){var c;if(typeof Symbol=="undefined"||w[Symbol.iterator]==null){if(Array.isArray(w)||(c=Vl(w))||b&&w&&typeof w.length=="number"){c&&(w=c);var d=0,y=function(){};return{s:y,n:function(){return d>=w.length?{done:!0}:{done:!1,value:w[d++]}},e:function(Q){throw Q},f:y}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var I=!0,te=!1,B;return{s:function(){c=w[Symbol.iterator]()},n:function(){var Q=c.next();return I=Q.done,Q},e:function(Q){te=!0,B=Q},f:function(){try{!I&&c.return!=null&&c.return()}finally{if(te)throw B}}}}function Vl(w,b){if(!w)return;if(typeof w=="string")return ps(w,b);var c=Object.prototype.toString.call(w).slice(8,-1);if(c==="Object"&&w.constructor&&(c=w.constructor.name),c==="Map"||c==="Set")return Array.from(w);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return ps(w,b)}function ps(w,b){(b==null||b>w.length)&&(b=w.length);for(var c=0,d=new Array(b);c<b;c++)d[c]=w[c];return d}var No=function(){function w(){Ke()(this,w),this.queue=void 0,this.id=void 0,this.cleared=void 0,this.currentlyRunning=void 0,this.queue=[],this.id=0,this.cleared=!1,this.currentlyRunning=!1}return bt()(w,[{key:"add",value:function(c){var d=++this.id,y=this.queue;return y.push({callback:c,id:d,cancelled:!1}),d}},{key:"remove",value:function(c){var d=this.currentlyRunning,y=d?this.queue.concat(d):this.queue,I=Zu(y),te;try{for(I.s();!(te=I.n()).done;){var B=te.value;if(B.id===c){B.cancelled=!0;return}}}catch(k){I.e(k)}finally{I.f()}}},{key:"run",value:function(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,d=this.currentlyRunning=this.queue;this.queue=[];var y=Zu(d),I;try{for(y.s();!(I=y.n()).done;){var te=I.value;if(te.cancelled)continue;if(te.callback(c),this.cleared)break}}catch(B){y.e(B)}finally{y.f()}this.cleared=!1,this.currentlyRunning=!1}},{key:"clear",value:function(){this.currentlyRunning&&(this.cleared=!0),this.queue=[]}}]),w}(),ko=No;function Ko(w){var b=Ao();return function(){var d=hr()(w),y;if(b){var I=hr()(this).constructor;y=Reflect.construct(d,arguments,I)}else y=d.apply(this,arguments);return yt()(this,y)}}function Ao(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(w){return!1}}o("BGjm")(`/* @antv/l7-map */
.l7-map {
  font: 12px/20px 'Helvetica Neue', Arial, Helvetica, sans-serif;
  overflow: hidden;
  position: relative;
  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
}

.l7-canvas {
  position: absolute;
  left: 0;
  top: 0;
}

.l7-map:-webkit-full-screen {
  width: 100%;
  height: 100%;
}

.l7-canary {
  background-color: salmon;
}

.l7-canvas-container.l7-interactive,
.l7-ctrl-group button.l7-ctrl-compass {
  cursor: -webkit-grab;
  cursor: grab;
  -moz-user-select: none;
  -webkit-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.l7-canvas-container.l7-interactive.l7-track-pointer {
  cursor: pointer;
}

.l7-canvas-container.l7-interactive:active,
.l7-ctrl-group button.l7-ctrl-compass:active {
  cursor: -webkit-grabbing;
  cursor: grabbing;
}

.l7-canvas-container.l7-touch-zoom-rotate,
.l7-canvas-container.l7-touch-zoom-rotate .l7-canvas {
  -ms-touch-action: pan-x pan-y;
      touch-action: pan-x pan-y;
}

.l7-canvas-container.l7-touch-drag-pan,
.l7-canvas-container.l7-touch-drag-pan .l7-canvas {
  -ms-touch-action: pinch-zoom;
      touch-action: pinch-zoom;
}

.l7-canvas-container.l7-touch-zoom-rotate.l7-touch-drag-pan,
.l7-canvas-container.l7-touch-zoom-rotate.l7-touch-drag-pan .l7-canvas {
  -ms-touch-action: none;
      touch-action: none;
}

.l7-ctrl-top-left,
.l7-ctrl-top-right,
.l7-ctrl-bottom-left,
.l7-ctrl-bottom-right { position: absolute; pointer-events: none; z-index: 2; }
.l7-ctrl-top-left     { top: 0; left: 0; }
.l7-ctrl-top-right    { top: 0; right: 0; }
.l7-ctrl-bottom-left  { bottom: 0; left: 0; }
.l7-ctrl-bottom-right { right: 0; bottom: 0; }

.l7-ctrl {
  clear: both;
  pointer-events: auto;

  /* workaround for a Safari bug https://github.com/mapbox/mapbox-gl-js/issues/8185 */
  -webkit-transform: translate(0, 0);
          transform: translate(0, 0);
}
.l7-ctrl-top-left .l7-ctrl     { margin: 10px 0 0 10px; float: left; }
.l7-ctrl-top-right .l7-ctrl    { margin: 10px 10px 0 0; float: right; }
.l7-ctrl-bottom-left .l7-ctrl  { margin: 0 0 10px 10px; float: left; }
.l7-ctrl-bottom-right .l7-ctrl { margin: 0 10px 10px 0; float: right; }


.l7-crosshair,
.l7-crosshair .l7-interactive,
.l7-crosshair .l7-interactive:active {
    cursor: crosshair;
}

.l7-boxzoom {
    position: absolute;
    top: 0;
    left: 0;
    width: 0;
    height: 0;
    background: #fff;
    border: 2px dotted #202020;
    opacity: 0.5;
    z-index: 10;
}
`);var uo=-2,Ns=22,nu=0,Gl=60,Uc={hash:!1,zoom:-1,center:[112,32],pitch:0,bearing:0,interactive:!0,minZoom:uo,maxZoom:Ns,minPitch:nu,maxPitch:Gl,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,trackResize:!0,renderWorldCopies:!0},fl=function(w){Fe()(c,w);var b=Ko(c);function c(d){var y;Ke()(this,c),y=b.call(this,eo()({},Uc,d)),y.doubleClickZoom=void 0,y.dragRotate=void 0,y.dragPan=void 0,y.touchZoomRotate=void 0,y.scrollZoom=void 0,y.keyboard=void 0,y.touchPitch=void 0,y.boxZoom=void 0,y.handlers=void 0,y.container=void 0,y.canvas=void 0,y.canvasContainer=void 0,y.renderTaskQueue=new ko,y.frame=void 0,y.trackResize=!0,y.hash=void 0,y.onWindowOnline=function(){y.update()},y.onWindowResize=function(te){y.trackResize&&y.resize({originalEvent:te}).update()},y.initContainer(),y.resize(),y.handlers=new wu(xl()(y),y.options),typeof window!="undefined"&&(window.addEventListener("online",y.onWindowOnline,!1),window.addEventListener("resize",y.onWindowResize,!1),window.addEventListener("orientationchange",y.onWindowResize,!1));var I=typeof d.hash=="string"&&d.hash||void 0;return d.hash&&(y.hash=new ic(I).addTo(xl()(y))),(!y.hash||!y.hash.onHashChange())&&(y.jumpTo({center:d.center,zoom:d.zoom,bearing:d.bearing,pitch:d.pitch}),d.bounds&&(y.resize(),y.fitBounds(d.bounds,eo()({},d.fitBoundsOptions,{duration:0})))),y}return bt()(c,[{key:"resize",value:function(y){var I=this.containerDimensions(),te=I[0],B=I[1];this.transform.resize(te,B);var k=!this.moving;return k&&(this.stop(),this.emit("movestart",new Event("movestart",y)),this.emit("move",new Event("move",y))),this.emit("resize",new Event("resize",y)),k&&this.emit("moveend",new Event("moveend",y)),this}},{key:"getContainer",value:function(){return this.container}},{key:"getCanvas",value:function(){return this.canvas}},{key:"getCanvasContainer",value:function(){return this.canvasContainer}},{key:"project",value:function(y){return this.transform.locationPoint(fi.convert(y))}},{key:"unproject",value:function(y){return this.transform.pointLocation(kn.convert(y))}},{key:"getBounds",value:function(){return this.transform.getBounds()}},{key:"getMaxBounds",value:function(){return this.transform.getMaxBounds()}},{key:"setMaxBounds",value:function(y){this.transform.setMaxBounds(nl.convert(y))}},{key:"setStyle",value:function(y){return}},{key:"setMinZoom",value:function(y){if(y=y==null?uo:y,y>=uo&&y<=this.transform.maxZoom)return this.transform.minZoom=y,this.getZoom()<y&&this.setZoom(y),this;throw new Error("minZoom must be between ".concat(uo," and the current maxZoom, inclusive"))}},{key:"getMinZoom",value:function(){return this.transform.minZoom}},{key:"setMaxZoom",value:function(y){if(y=y==null?Ns:y,y>=this.transform.minZoom)return this.transform.maxZoom=y,this.getZoom()>y&&this.setZoom(y),this;throw new Error("maxZoom must be greater than the current minZoom")}},{key:"getMaxZoom",value:function(){return this.transform.maxZoom}},{key:"setMinPitch",value:function(y){if(y=y==null?nu:y,y<nu)throw new Error("minPitch must be greater than or equal to ".concat(nu));if(y>=nu&&y<=this.transform.maxPitch)return this.transform.minPitch=y,this.getPitch()<y&&this.setPitch(y),this;throw new Error("minPitch must be between ".concat(nu," and the current maxPitch, inclusive"))}},{key:"getMinPitch",value:function(){return this.transform.minPitch}},{key:"setMaxPitch",value:function(y){if(y=y==null?Gl:y,y>Gl)throw new Error("maxPitch must be less than or equal to ".concat(Gl));if(y>=this.transform.minPitch)return this.transform.maxPitch=y,this.getPitch()>y&&this.setPitch(y),this;throw new Error("maxPitch must be greater than the current minPitch")}},{key:"getMaxPitch",value:function(){return this.transform.maxPitch}},{key:"getRenderWorldCopies",value:function(){return this.transform.renderWorldCopies}},{key:"setRenderWorldCopies",value:function(y){this.transform.renderWorldCopies=!!y}},{key:"remove",value:function(){this.frame&&(this.frame.cancel(),this.frame=null),this.renderTaskQueue.clear()}},{key:"requestRenderFrame",value:function(y){return this.update(),this.renderTaskQueue.add(y)}},{key:"cancelRenderFrame",value:function(y){return this.renderTaskQueue.remove(y)}},{key:"triggerRepaint",value:function(){var y=this;this.frame||(this.frame=Pi(function(I){ao.frame(I),y.frame=null,y.update(I)}))}},{key:"update",value:function(y){var I=this;this.frame||(this.frame=Pi(function(te){ao.frame(te),I.frame=null,I.renderTaskQueue.run(y)}))}},{key:"initContainer",value:function(){if(typeof this.options.container=="string"){if(this.container=window.document.getElementById(this.options.container),!this.container)throw new Error("Container '".concat(this.options.container,"' not found."))}else if(this.options.container instanceof HTMLElement)this.container=this.options.container;else throw new Error("Invalid type: 'container' must be a String or HTMLElement.");var y=this.container;y.classList.add("l7-map");var I=this.canvasContainer=fn.a.create("div","l7-canvas-container",y);this.options.interactive&&I.classList.add("l7-interactive")}},{key:"containerDimensions",value:function(){var y=0,I=0;return this.container&&(y=this.container.clientWidth||400,I=this.container.clientHeight||300),[y,I]}},{key:"resizeCanvas",value:function(y,I){var te=window.devicePixelRatio||1;this.canvas.width=te*y,this.canvas.height=te*I,this.canvas.style.width="".concat(y,"px"),this.canvas.style.height="".concat(I,"px")}}]),c}(Bs),sc=function(){function w(){Ke()(this,w),this.viewport=void 0}return bt()(w,[{key:"syncWithMapCamera",value:function(c){var d=c.center,y=c.zoom,I=c.pitch,te=c.bearing,B=c.viewportHeight,k=c.viewportWidth;this.viewport=new Eu({width:k,height:B,longitude:d&&d[0],latitude:d&&d[1],zoom:y,pitch:I,bearing:te})}},{key:"getZoom",value:function(){return this.viewport.zoom}},{key:"getZoomScale",value:function(){return Math.pow(2,this.getZoom())}},{key:"getCenter",value:function(){return[this.viewport.longitude,this.viewport.latitude]}},{key:"getProjectionMatrix",value:function(){return this.viewport.projectionMatrix}},{key:"getViewMatrix",value:function(){return this.viewport.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.viewMatrixUncentered}},{key:"getViewProjectionMatrix",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(c,d){return this.viewport.projectFlat(c,d)}}]),w}(),hl={light:"mapbox://styles/zcxduo/ck2ypyb1r3q9o1co1766dex29",dark:"mapbox://styles/zcxduo/ck241p6413s0b1cpayzldv7x7",normal:"mapbox://styles/mapbox/streets-v11",blank:{version:8,sources:{},layers:[{id:"background",type:"background",layout:{visibility:"none"}}]}},ks,go,_c,ms,af,Sf,Af,Sc,Wu,bf,of,Cf,Pu,uc;function If(w,b){var c=Object.keys(w);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(w);b&&(d=d.filter(function(y){return Object.getOwnPropertyDescriptor(w,y).enumerable})),c.push.apply(c,d)}return c}function Bc(w){for(var b=1;b<arguments.length;b++){var c=arguments[b]!=null?arguments[b]:{};b%2?If(Object(c),!0).forEach(function(d){yr()(w,d,c[d])}):Object.getOwnPropertyDescriptors?Object.defineProperties(w,Object.getOwnPropertyDescriptors(c)):If(Object(c)).forEach(function(d){Object.defineProperty(w,d,Object.getOwnPropertyDescriptor(c,d))})}return w}var Ac={mapmove:"move",camerachange:"move",zoomchange:"zoom",dragging:"drag"},$f=12,Jf=(ks=Object(rn.injectable)(),go=Object(rn.inject)(Cn.TYPES.MapConfig),_c=Object(rn.inject)(Cn.TYPES.IGlobalConfigService),ms=Object(rn.inject)(Cn.TYPES.ILogService),af=Object(rn.inject)(Cn.TYPES.ICoordinateSystemService),Sf=Object(rn.inject)(Cn.TYPES.IEventEmitter),ks(Af=(Sc=(uc=function(){function w(){var b=this;Ke()(this,w),this.map=void 0,zn()(this,"config",Wu,this),zn()(this,"configService",bf,this),zn()(this,"logger",of,this),zn()(this,"coordinateSystemService",Cf,this),zn()(this,"eventEmitter",Pu,this),this.viewport=void 0,this.markerContainer=void 0,this.cameraChangedCallback=void 0,this.$mapContainer=void 0,this.handleCameraChanged=function(){var c=b.map.getCenter(),d=c.lat,y=c.lng;b.viewport.syncWithMapCamera({bearing:b.map.getBearing(),center:[y,d],viewportHeight:b.map.transform.height,pitch:b.map.getPitch(),viewportWidth:b.map.transform.width,zoom:b.map.getZoom(),cameraHeight:0}),b.viewport.getZoom()>$f?b.coordinateSystemService.setCoordinateSystem(Cn.CoordinateSystem.LNGLAT_OFFSET):b.coordinateSystemService.setCoordinateSystem(Cn.CoordinateSystem.LNGLAT),b.cameraChangedCallback(b.viewport)}}return bt()(w,[{key:"addMarkerContainer",value:function(){var c=this.map.getCanvasContainer();this.markerContainer=fn.a.create("div","l7-marker-container",c),this.markerContainer.setAttribute("tabindex","-1")}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"on",value:function(c,d){Cn.MapServiceEvent.indexOf(c)!==-1?this.eventEmitter.on(c,d):this.map.on(Ac[c]||c,d)}},{key:"off",value:function(c,d){this.map.off(Ac[c]||c,d)}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getMapCanvasContainer",value:function(){return this.map.getCanvasContainer()}},{key:"getSize",value:function(){var c=this.map.transform;return[c.width,c.height]}},{key:"getType",value:function(){return"default"}},{key:"getZoom",value:function(){return this.map.getZoom()}},{key:"setZoom",value:function(c){return this.map.setZoom(c)}},{key:"getCenter",value:function(){return this.map.getCenter()}},{key:"setCenter",value:function(c){this.map.setCenter(c)}},{key:"getPitch",value:function(){return this.map.getPitch()}},{key:"getRotation",value:function(){return this.map.getBearing()}},{key:"getBounds",value:function(){return this.map.getBounds().toArray()}},{key:"getMinZoom",value:function(){return this.map.getMinZoom()}},{key:"getMaxZoom",value:function(){return this.map.getMaxZoom()}},{key:"setRotation",value:function(c){this.map.setBearing(c)}},{key:"zoomIn",value:function(c,d){this.map.zoomIn(c,d)}},{key:"zoomOut",value:function(c,d){this.map.zoomOut(c,d)}},{key:"setPitch",value:function(c){return this.map.setPitch(c)}},{key:"panTo",value:function(c){this.map.panTo(c)}},{key:"panBy",value:function(c){this.panTo(c)}},{key:"fitBounds",value:function(c,d){this.map.fitBounds(c,d)}},{key:"setMaxZoom",value:function(c){this.map.setMaxZoom(c)}},{key:"setMinZoom",value:function(c){this.map.setMinZoom(c)}},{key:"setMapStatus",value:function(c){c.doubleClickZoom===!0&&this.map.doubleClickZoom.enable(),c.doubleClickZoom===!1&&this.map.doubleClickZoom.disable(),c.dragEnable===!1&&this.map.dragPan.disable(),c.dragEnable===!0&&this.map.dragPan.enable(),c.rotateEnable===!1&&this.map.dragRotate.disable(),c.dragEnable===!0&&this.map.dragRotate.enable(),c.keyboardEnable===!1&&this.map.keyboard.disable(),c.keyboardEnable===!0&&this.map.keyboard.enable(),c.zoomEnable===!1&&this.map.scrollZoom.disable(),c.zoomEnable===!0&&this.map.scrollZoom.enable()}},{key:"setZoomAndCenter",value:function(c,d){this.map.flyTo({zoom:c,center:d})}},{key:"setMapStyle",value:function(c){this.map.setStyle(this.getMapStyle(c))}},{key:"pixelToLngLat",value:function(c){return this.map.unproject(c)}},{key:"lngLatToPixel",value:function(c){return this.map.project(c)}},{key:"containerToLngLat",value:function(c){return this.map.unproject(c)}},{key:"lngLatToContainer",value:function(c){return this.map.project(c)}},{key:"lngLatToMercator",value:function(c,d){throw new Error("not implement")}},{key:"getModelMatrix",value:function(c,d,y){var I=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[1,1,1],te=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{x:0,y:0,z:0};throw new Error("not implement")}},{key:"init",value:function(){var b=cr()(K.a.mark(function d(){var y,I,te,B,k,Q,We,rt,Pe,Qe,Tt;return K.a.wrap(function(vt){for(;;)switch(vt.prev=vt.next){case 0:y=this.config,I=y.id,te=I===void 0?"map":I,B=y.attributionControl,k=B===void 0?!1:B,Q=y.style,We=Q===void 0?"light":Q,rt=y.rotation,Pe=rt===void 0?0:rt,Qe=y.mapInstance,Tt=Ur()(y,["id","attributionControl","style","rotation","mapInstance"]),this.viewport=new sc,Qe?(this.map=Qe,this.$mapContainer=this.map.getContainer()):(this.$mapContainer=this.creatAmapContainer(te),this.map=new fl(Bc({container:this.$mapContainer,style:this.getMapStyle(We),bearing:Pe},Tt))),this.map.on("load",this.handleCameraChanged),this.map.on("move",this.handleCameraChanged),this.handleCameraChanged();case 6:case"end":return vt.stop()}},d,this)}));function c(){return b.apply(this,arguments)}return c}()},{key:"destroy",value:function(){this.eventEmitter.removeAllListeners(),this.map&&(this.map.remove(),this.$mapContainer=null)}},{key:"emit",value:function(c){for(var d,y=arguments.length,I=new Array(y>1?y-1:0),te=1;te<y;te++)I[te-1]=arguments[te];(d=this.eventEmitter).emit.apply(d,[c].concat(I))}},{key:"once",value:function(c){for(var d,y=arguments.length,I=new Array(y>1?y-1:0),te=1;te<y;te++)I[te-1]=arguments[te];(d=this.eventEmitter).once.apply(d,[c].concat(I))}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"exportMap",value:function(c){var d=this.map.getCanvas(),y=c==="jpg"?d==null?void 0:d.toDataURL("image/jpeg"):d==null?void 0:d.toDataURL("image/png");return y}},{key:"onCameraChanged",value:function(c){this.cameraChangedCallback=c}},{key:"creatAmapContainer",value:function(c){var d=c;return typeof c=="string"&&(d=document.getElementById(c)),d}},{key:"getMapStyle",value:function(c){return typeof c!="string"?c:hl[c]?hl[c]:c}}]),w}(),uc),Wu=$n()(Sc.prototype,"config",[go],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bf=$n()(Sc.prototype,"configService",[_c],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),of=$n()(Sc.prototype,"logger",[ms],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Cf=$n()(Sc.prototype,"coordinateSystemService",[af],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Pu=$n()(Sc.prototype,"eventEmitter",[Sf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Sc))||Af);function Qf(w){var b=qf();return function(){var d=hr()(w),y;if(b){var I=hr()(this).constructor;y=Reflect.construct(d,arguments,I)}else y=d.apply(this,arguments);return yt()(this,y)}}function qf(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(w){return!1}}var wf=function(w){Fe()(c,w);var b=Qf(c);function c(){return Ke()(this,c),b.apply(this,arguments)}return bt()(c,[{key:"getServiceConstructor",value:function(){return Jf}}]),c}(Rt);function eh(w,b){var c=Object.keys(w);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(w);b&&(d=d.filter(function(y){return Object.getOwnPropertyDescriptor(w,y).enumerable})),c.push.apply(c,d)}return c}function Hl(w){for(var b=1;b<arguments.length;b++){var c=arguments[b]!=null?arguments[b]:{};b%2?eh(Object(c),!0).forEach(function(d){sf(w,d,c[d])}):Object.getOwnPropertyDescriptors?Object.defineProperties(w,Object.getOwnPropertyDescriptors(c)):eh(Object(c)).forEach(function(d){Object.defineProperty(w,d,Object.getOwnPropertyDescriptor(c,d))})}return w}function sf(w,b,c){return b in w?Object.defineProperty(w,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):w[b]=c,w}function io(w,b){return Cl(w)||au(w,b)||xf(w,b)||lc()}function lc(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function xf(w,b){if(!w)return;if(typeof w=="string")return Cc(w,b);var c=Object.prototype.toString.call(w).slice(8,-1);if(c==="Object"&&w.constructor&&(c=w.constructor.name),c==="Map"||c==="Set")return Array.from(w);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return Cc(w,b)}function Cc(w,b){(b==null||b>w.length)&&(b=w.length);for(var c=0,d=new Array(b);c<b;c++)d[c]=w[c];return d}function au(w,b){if(typeof Symbol=="undefined"||!(Symbol.iterator in Object(w)))return;var c=[],d=!0,y=!1,I=void 0;try{for(var te=w[Symbol.iterator](),B;!(d=(B=te.next()).done)&&!(c.push(B.value),b&&c.length===b);d=!0);}catch(k){y=!0,I=k}finally{try{!d&&te.return!=null&&te.return()}finally{if(y)throw I}}return c}function Cl(w){if(Array.isArray(w))return w}var Ef=Se.a.memo(function(w){var b=w.style,c=w.className,d=w.map,y=w.option,I=w.onSceneLoaded,te=Object(be.createRef)(),B=Object(be.useState)(),k=io(B,2),Q=k[0],We=k[1];return Object(be.useEffect)(function(){var rt=new kt.Scene(Hl(Hl({id:te.current},y),{},{map:new wf(d)}));return rt.on("loaded",function(){We(rt),I&&I(rt)}),function(){rt.destroy()}},[]),Object(be.useEffect)(function(){Q&&d.style&&Q.setMapStyle(d.style)},[JSON.stringify(d.style)]),Object(be.useEffect)(function(){Q&&d.zoom&&Q.setZoom(d.zoom)},[d.zoom]),Object(be.useEffect)(function(){Q&&d.center&&Q.setCenter(d.center)},[JSON.stringify(d.center)]),Object(be.useEffect)(function(){Q&&d.pitch&&Q.setPitch(d.pitch)},[d.pitch]),Object(be.useEffect)(function(){Q&&d.rotation&&Q.setRotation(d.rotation)},[d.rotation]),Se.a.createElement(ae.Provider,{value:Q},Object(be.createElement)("div",{ref:te,style:b,className:c},Q&&w.children))}),Df=Ef;function Vc(w,b){return se(w)||ne(w,b)||Gc(w,b)||uf()}function uf(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Gc(w,b){if(!w)return;if(typeof w=="string")return dl(w,b);var c=Object.prototype.toString.call(w).slice(8,-1);if(c==="Object"&&w.constructor&&(c=w.constructor.name),c==="Map"||c==="Set")return Array.from(w);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return dl(w,b)}function dl(w,b){(b==null||b>w.length)&&(b=w.length);for(var c=0,d=new Array(b);c<b;c++)d[c]=w[c];return d}function ne(w,b){if(typeof Symbol=="undefined"||!(Symbol.iterator in Object(w)))return;var c=[],d=!0,y=!1,I=void 0;try{for(var te=w[Symbol.iterator](),B;!(d=(B=te.next()).done)&&!(c.push(B.value),b&&c.length===b);d=!0);}catch(k){y=!0,I=k}finally{try{!d&&te.return!=null&&te.return()}finally{if(y)throw I}}return c}function se(w){if(Array.isArray(w))return w}var N=Se.a.memo(function(w){var b=w.style,c=w.className,d=w.map,y=Object(be.createRef)(),I=Object(be.useState)(),te=Vc(I,2),B=te[0],k=te[1];return Object(be.useEffect)(function(){var Q=new kt.Scene({id:y.current,map:d});return Q.on("loaded",function(){k(Q)}),function(){Q.destroy()}},[]),Se.a.createElement(ae.Provider,{value:B},Object(be.createElement)("div",{ref:y,style:b,className:c},B&&w.children))});function G(w,b){return or(w)||sr(w,b)||ft(w,b)||Ce()}function Ce(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ft(w,b){if(!w)return;if(typeof w=="string")return Yt(w,b);var c=Object.prototype.toString.call(w).slice(8,-1);if(c==="Object"&&w.constructor&&(c=w.constructor.name),c==="Map"||c==="Set")return Array.from(w);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return Yt(w,b)}function Yt(w,b){(b==null||b>w.length)&&(b=w.length);for(var c=0,d=new Array(b);c<b;c++)d[c]=w[c];return d}function sr(w,b){if(typeof Symbol=="undefined"||!(Symbol.iterator in Object(w)))return;var c=[],d=!0,y=!1,I=void 0;try{for(var te=w[Symbol.iterator](),B;!(d=(B=te.next()).done)&&!(c.push(B.value),b&&c.length===b);d=!0);}catch(k){y=!0,I=k}finally{try{!d&&te.return!=null&&te.return()}finally{if(y)throw I}}return c}function or(w){if(Array.isArray(w))return w}var Dr=Se.a.memo(function(b){var c=tt(),d=Object(be.useState)(),y=G(d,2),I=y[1],te=b.type,B=b.position;return Object(be.useEffect)(function(){var k;switch(te){case"scale":k=new kt.Scale({position:B||"bottomright"});break;case"zoom":k=new kt.Zoom({position:B||"topright"});break;case"logo":k=new kt.Logo({position:B||"bottomleft"})}return I(k),c.addControl(k),function(){c.removeControl(k)}},[te,B]),null}),sn=o("i8i4"),Hn=be.useEffect,ea=be.useState;function la(w){var b=w.className,c=w.style,d=w.children,y=w.position,I=tt(),te=document.createElement("div");return Hn(function(){var B=new kt.Control({position:y});return B.onAdd=function(){if(b&&(te.className=b),c){var k=Object.keys(c).map(function(Q){return"".concat(Q,":").concat(c[Q])}).join(";");te.style.cssText=k}return te},I.addControl(B),function(){I.removeControl(B)}},[]),Object(sn.createPortal)(d,te)}var ti=Object(be.createContext)({});function ja(){return Object(be.useContext)(ti)}var Ti=be.useEffect,Qa=be.memo(function(b){var c=b.layer,d=b.active;return Ti(function(){c.active(d.option)},[JSON.stringify(d)]),null}),Vi=be.useEffect,Co=be.memo(function(b){var c=b.layer,d=b.animate;return Vi(function(){c.animate(d)},[JSON.stringify(d)]),null}),yo=be.useEffect,Zi=be.memo(function(b){var c=b.layer,d=b.color;return yo(function(){d.field?c.color(d.field,d.values):c.color(d.values)},[d.field,d.scale,JSON.stringify(d.values),JSON.stringify(d.options)]),null}),jo=be.useEffect,qa=be.memo(function(b){var c=b.layer,d=b.filter;return jo(function(){d.field&&c.filter(d.field,d.values)},[d.field,d.values,JSON.stringify(d.values),JSON.stringify(d.options)]),null}),lo=be.useEffect,iu=be.memo(function(b){var c=b.layer,d=b.scale;return lo(function(){c.scale(d.values)},[d.values]),null}),_i=be.useEffect,ki=be.memo(function(b){var c=b.layer,d=b.select;return _i(function(){c.select(d.option)},[JSON.stringify(d)]),null}),Ea=be.useEffect,wo=be.memo(function(b){var c=b.layer,d=b.shape;return Ea(function(){d.field?c.shape(d.field,d.values):c.shape(d.values)},[d.field,JSON.stringify(d.values),JSON.stringify(d.options)]),null}),cc=be.useEffect,Nf=be.memo(function(b){var c=b.layer,d=b.size;return cc(function(){d.field?c.size(d.field,d.values):c.size(d.values)},[d.field,d.scale,JSON.stringify(d.values),JSON.stringify(d.options)]),null});function oh(w,b){if(w==null)return{};var c=kf(w,b),d,y;if(Object.getOwnPropertySymbols){var I=Object.getOwnPropertySymbols(w);for(y=0;y<I.length;y++){if(d=I[y],b.indexOf(d)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(w,d))continue;c[d]=w[d]}}return c}function kf(w,b){if(w==null)return{};var c={},d=Object.keys(w),y,I;for(I=0;I<d.length;I++){if(y=d[I],b.indexOf(y)>=0)continue;c[y]=w[y]}return c}var Lu=be.useEffect,jf=be.memo(function(b){var c=b.layer,d=b.source,y=d.data,I=oh(d,["data"]);return Lu(function(){c.inited?c.setData(y,I):c.source(y,I),I.autoFit&&c.fitBounds(I&&I.fitBoundsOptions)},[y,JSON.stringify(I)]),null}),lf=be.useEffect,Ff=be.memo(function(b){var c=b.layer,d=b.style;return lf(function(){c.style(d)},Object.keys(d).map(function(y){return d[y]})),null});function Eh(w,b){return uh(w)||Uf(w,b)||Tf(w,b)||sh()}function sh(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Tf(w,b){if(!w)return;if(typeof w=="string")return zf(w,b);var c=Object.prototype.toString.call(w).slice(8,-1);if(c==="Object"&&w.constructor&&(c=w.constructor.name),c==="Map"||c==="Set")return Array.from(w);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return zf(w,b)}function zf(w,b){(b==null||b>w.length)&&(b=w.length);for(var c=0,d=new Array(b);c<b;c++)d[c]=w[c];return d}function Uf(w,b){if(typeof Symbol=="undefined"||!(Symbol.iterator in Object(w)))return;var c=[],d=!0,y=!1,I=void 0;try{for(var te=w[Symbol.iterator](),B;!(d=(B=te.next()).done)&&!(c.push(B.value),b&&c.length===b);d=!0);}catch(k){y=!0,I=k}finally{try{!d&&te.return!=null&&te.return()}finally{if(y)throw I}}return c}function uh(w){if(Array.isArray(w))return w}var Bf=be.useEffect,Of=be.useState;function Zl(w,b){var c=b.source,d=b.color,y=b.shape,I=b.style,te=b.size,B=b.scale,k=b.active,Q=b.select,We=b.filter,rt=b.animate,Pe=b.options,Qe=b.onLayerLoaded,Tt=tt(),ke=Of(),vt=Eh(ke,2),De=vt[0],Zt=vt[1];if(!De){var Kt;switch(w){case"polygonLayer":Kt=new kt.PolygonLayer(Pe);break;case"lineLayer":Kt=new kt.LineLayer(Pe);break;case"pointLayer":Kt=new kt.PointLayer(Pe);break;case"heatmapLayer":Kt=new kt.HeatmapLayer(Pe);break;case"rasterLayer":Kt=new kt.RasterLayer(Pe);break;case"imageLayer":Kt=new kt.ImageLayer(Pe);break;case"citybuildingLayer":Kt=new kt.CityBuildingLayer(Pe);break;default:Kt=new kt.PolygonLayer(Pe)}Kt.on("inited",function(){Qe&&Qe(Kt,Tt)}),Zt(Kt)}return Bf(function(){if(De!==void 0)return Tt.addLayer(De),function(){Tt.removeLayer(De)}},[]),Bf(function(){De&&Tt.render()}),Bf(function(){De&&De.inited&&Pe&&De.updateLayerConfig(Pe)},[Pe==null?void 0:Pe.minZoom,Pe==null?void 0:Pe.maxZoom,Pe==null?void 0:Pe.visible]),Bf(function(){De&&De.inited&&Pe&&Pe.zIndex&&De.setIndex(Pe.zIndex)},[Pe==null?void 0:Pe.zIndex]),Bf(function(){De&&De.inited&&Pe&&Pe.blend&&De.setBlend(Pe.blend)},[Pe==null?void 0:Pe.blend]),De!=null?be.createElement(ti.Provider,{value:De},be.createElement(jf,{layer:De,source:c}),B&&be.createElement(iu,{layer:De,scale:B}),d&&be.createElement(Zi,{layer:De,color:d}),te&&be.createElement(Nf,{layer:De,size:te}),y&&be.createElement(wo,{layer:De,shape:y}),I&&be.createElement(Ff,{layer:De,style:I}),k&&be.createElement(Qa,{layer:De,active:k}),Q&&be.createElement(ki,{layer:De,select:Q}),We&&be.createElement(qa,{layer:De,filter:We}),rt&&be.createElement(Co,{layer:De,animate:rt}),b.children):null}var Ih=be.memo(function(b){return Zl("polygonLayer",b)}),ge=be.memo(function(b){return Zl("lineLayer",b)}),je=be.memo(function(b){return Zl("pointLayer",b)}),Mt=be.memo(function(b){return Zl("heatmapLayer",b)}),Er=be.memo(function(b){return Zl("rasterLayer",b)}),Lr=be.memo(function(b){return Zl("imageLayer",b)}),wr=be.memo(function(b){return Zl("citybuildingLayer",b)}),Tr=be.useEffect,Wr=be.memo(function(w){var b=w.type,c=w.handler,d=ja();return Tr(function(){return d.off(b,c),d.on(b,c),function(){d.off(b,c)}},[b,c]),null}),un=be.memo(function(w){var b=w.className,c=w.style,d=w.title,y=[{title:"1",color:"rgb(239,243,255)"},{title:"10",color:"rgb(198,219,239)"},{title:"30",color:"rgb(158,202,225)"},{title:"50",color:"rgb(107,174,214)"},{title:"60",color:"rgb(49,130,189)"},{title:"100",color:"rgb(8,81,156)"}];return be.createElement("div",null,be.createElement("div",null,y.map(function(I,te){return be.createElement("div",{key:te.toString(),style:{background:I.color,height:"100%",display:"inline-block",cursor:"pointer",width:""+(100-y.length)/y.length+"%",marginRight:"1%",padding:5}})})),be.createElement("div",null,y.map(function(I,te){return be.createElement("div",{key:te.toString()+"122",style:{background:"#fff",height:"100%",display:"inline-block",textAlign:"left",cursor:"pointer",width:""+(100-y.length)/y.length+"%",marginRight:"1%"}},I.title)})))});function Jr(w){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Jr=function(c){return typeof c}:Jr=function(c){return c&&typeof Symbol=="function"&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c},Jr(w)}function Qr(w,b){var c=Object.keys(w);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(w);b&&(d=d.filter(function(y){return Object.getOwnPropertyDescriptor(w,y).enumerable})),c.push.apply(c,d)}return c}function ln(w){for(var b=1;b<arguments.length;b++){var c=arguments[b]!=null?arguments[b]:{};b%2?Qr(Object(c),!0).forEach(function(d){Sn(w,d,c[d])}):Object.getOwnPropertyDescriptors?Object.defineProperties(w,Object.getOwnPropertyDescriptors(c)):Qr(Object(c)).forEach(function(d){Object.defineProperty(w,d,Object.getOwnPropertyDescriptor(c,d))})}return w}function Sn(w,b,c){return b in w?Object.defineProperty(w,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):w[b]=c,w}function pn(w,b){if(!(w instanceof b))throw new TypeError("Cannot call a class as a function")}function nn(w,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(w,d.key,d)}}function _r(w,b,c){return b&&nn(w.prototype,b),c&&nn(w,c),w}function xr(w,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function");w.prototype=Object.create(b&&b.prototype,{constructor:{value:w,writable:!0,configurable:!0}}),b&&Xr(w,b)}function Xr(w,b){return Xr=Object.setPrototypeOf||function(d,y){return d.__proto__=y,d},Xr(w,b)}function On(w){var b=qr();return function(){var d=zr(w),y;if(b){var I=zr(this).constructor;y=Reflect.construct(d,arguments,I)}else y=d.apply(this,arguments);return Ir(this,y)}}function Ir(w,b){return b&&(Jr(b)==="object"||typeof b=="function")?b:ta(w)}function ta(w){if(w===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return w}function qr(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(w){return!1}}function zr(w){return zr=Object.setPrototypeOf?Object.getPrototypeOf:function(c){return c.__proto__||Object.getPrototypeOf(c)},zr(w)}var Vr=function(w){xr(c,w);var b=On(c);function c(d){var y;return pn(this,c),y=b.call(this,d),y.el=document.createElement("div"),y}return _r(c,[{key:"componentDidMount",value:function(){var y=this.props,I=y.lnglat,te=y.children,B=y.option,k=new kt.Popup(ln(ln({},B),{},{stopPropagation:!1}));I&&k.setLnglat(I),te&&k.setDOMContent(this.el),this.popup=k,this.scene.addPopup(k)}},{key:"componentDidUpdate",value:function(y){var I,te,B,k,Q,We,rt=Array.isArray(y.lnglat)?y.lnglat:[y==null||((I=y.lnglat)===null||I===void 0)?void 0:I.lng,y==null||((te=y.lnglat)===null||te===void 0)?void 0:te.lat],Pe=Array.isArray(this.props.lnglat)?this.props.lnglat:[(B=this.props)===null||B===void 0||((k=B.lnglat)===null||k===void 0)?void 0:k.lng,(Q=this.props)===null||Q===void 0||((We=Q.lnglat)===null||We===void 0)?void 0:We.lat],Qe=rt.toString()!==Pe.toString();Qe&&(this.popup.remove(),this.popup=new kt.Popup(ln(ln({},this.props.option),{},{stopPropagation:!1})),this.popup.setLnglat(this.props.lnglat),this.popup.setDOMContent(this.el),this.scene.addPopup(this.popup))}},{key:"componentWillUnmount",value:function(){this.popup.remove()}},{key:"render",value:function(){var y=this;return be.createElement(ae.Consumer,{},function(I){return I&&(y.scene=I),Object(sn.createPortal)(y.props.children,y.el)})}}]),c}(be.PureComponent);function Kr(w){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Kr=function(c){return typeof c}:Kr=function(c){return c&&typeof Symbol=="function"&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c},Kr(w)}function Xn(w,b){if(!(w instanceof b))throw new TypeError("Cannot call a class as a function")}function na(w,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(w,d.key,d)}}function cn(w,b,c){return b&&na(w.prototype,b),c&&na(w,c),w}function Hr(w,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function");w.prototype=Object.create(b&&b.prototype,{constructor:{value:w,writable:!0,configurable:!0}}),b&&jr(w,b)}function jr(w,b){return jr=Object.setPrototypeOf||function(d,y){return d.__proto__=y,d},jr(w,b)}function ma(w){var b=Ua();return function(){var d=Ta(w),y;if(b){var I=Ta(this).constructor;y=Reflect.construct(d,arguments,I)}else y=d.apply(this,arguments);return pa(this,y)}}function pa(w,b){return b&&(Kr(b)==="object"||typeof b=="function")?b:Un(w)}function Un(w){if(w===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return w}function Ua(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(w){return!1}}function Ta(w){return Ta=Object.setPrototypeOf?Object.getPrototypeOf:function(c){return c.__proto__||Object.getPrototypeOf(c)},Ta(w)}var Ba=function(w){Hr(c,w);var b=ma(c);function c(d){var y;return Xn(this,c),y=b.call(this,d),y.el=document.createElement("div"),y}return cn(c,[{key:"componentDidMount",value:function(){var y=this.props,I=y.lnglat,te=y.children,B=y.option,k=y.onMarkerLoaded,Q=new kt.Marker(B);I&&Q.setLnglat(I),te&&Q.setElement(this.el),this.marker=Q,k&&k(Q),this.scene.addMarker(Q)}},{key:"componentDidUpdate",value:function(y){var I,te=(y==null?void 0:y.lnglat.toString())!==((I=this.props)===null||I===void 0?void 0:I.lnglat.toString());te&&this.marker.setLnglat(this.props.lnglat)}},{key:"componentWillUnmount",value:function(){this.marker&&this.marker.remove()}},{key:"render",value:function(){var y=this;return be.createElement(ae.Consumer,{},function(I){return I&&(y.scene=I),Object(sn.createPortal)(y.props.children,y.el)})}}]),c}(be.PureComponent),hi=be.useEffect,Fo=be.memo(function(w){var b=w.type,c=w.handler,d=tt();return hi(function(){return d.on(b,c),function(){d.off(b,c)}},[b]),null}),Os=Fo,ei=be.useEffect,bo=be.memo(function(b){var c=b.name,d=b.url,y=tt();return ei(function(){y.addImage(c,d)},[c,d]),null}),Ci=o("tbuW"),vs=["#eff3ff","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#084594"],zo=function(w){Object(ee.a)(c,w);var b=Object(ce.a)(c);function c(){var d;Object(D.a)(this,c);for(var y=arguments.length,I=new Array(y),te=0;te<y;te++)I[te]=arguments[te];return d=b.call.apply(b,[this].concat(I)),d.state={data:null,grid:null,loading:!1},d}return Object(J.a)(c,[{key:"componentDidMount",value:function(){var d=Object(qe.a)(K.a.mark(function I(){var te,B,k,Q;return K.a.wrap(function(rt){for(;;)switch(rt.prev=rt.next){case 0:return rt.next=2,Promise.all([fetch("https://gw.alipayobjects.com/os/bmw-prod/c5dba875-b6ea-4e88-b778-66a862906c93.json").then(function(Pe){return Pe.json()}),fetch("https://gw.alipayobjects.com/os/bmw-prod/8990e8b4-c58e-419b-afb9-8ea3daff2dd1.json").then(function(Pe){return Pe.json()})]);case 2:te=rt.sent,B=Object(C.a)(te,2),k=B[0],Q=B[1],this.setState({data:k,grid:Q,loading:!0});case 7:case"end":return rt.stop()}},I,this)}));function y(){return d.apply(this,arguments)}return y}()},{key:"render",value:function(){var y=this.state,I=y.data,te=y.grid,B=y.loading;return B===!1?be.createElement(Ci.a,null):be.createElement(Rl,{map:{center:[110.19382669582967,50.258134],pitch:0,style:"blank",zoom:1},style:{position:"relative",width:"100%",height:"452px"}},te&&be.createElement(Mt,{key:"1",source:{data:te,transforms:[{type:"hexagon",size:8e5,field:"capacity",method:"sum"}]},color:{values:"#ddd"},shape:{values:"hexagon"},style:{coverage:.7,opacity:.8}}),I&&[be.createElement(je,{key:"2",options:{autoFit:!0},source:{data:I},scale:{values:{color:{field:"cum_conf",type:"quantile"},size:{field:"cum_conf",type:"log"}}},color:{field:"cum_conf",values:vs},shape:{values:"circle"},active:{option:{color:"#0c2c84"}},size:{field:"cum_conf",values:[0,30]},style:{opacity:.8}}),be.createElement(je,{key:"5",source:{data:I},color:{values:"#fff"},shape:{field:"Short_Name_ZH",values:"text"},filter:{field:"cum_conf",values:function(Q){return Q>2e3}},size:{values:12},style:{opacity:1,strokeOpacity:1,strokeWidth:0}})])}}]),c}(be.Component),gs={Pie:gt,WaterWave:ot,Gauge:Wt,MiniArea:$,TagCloud:He,Map:zo},Uo=o("KQm4"),Bo={activeChart:"activeChart___15gpK",activeChartGrid:"activeChartGrid___3PL4c",activeChartLegend:"activeChartLegend___2Ieyc",dashedLine:"dashedLine___2fgZX",line:"line___2cxqk"};function Vo(w){return w*1<10?"0".concat(w):w}function aa(){for(var w=[],b=0;b<24;b+=1)w.push({x:"".concat(Vo(b),":00"),y:Math.floor(Math.random()*200)+b*50});return w}var ou=function(w){Object(ee.a)(c,w);var b=Object(ce.a)(c);function c(){var d;Object(D.a)(this,c);for(var y=arguments.length,I=new Array(y),te=0;te<y;te++)I[te]=arguments[te];return d=b.call.apply(b,[this].concat(I)),d.state={activeData:aa()},d.timer=void 0,d.requestRef=void 0,d.loopData=function(){d.requestRef=requestAnimationFrame(function(){d.timer=window.setTimeout(function(){d.setState({activeData:aa()},function(){d.loopData()})},1e3)})},d}return Object(J.a)(c,[{key:"componentDidMount",value:function(){this.loopData()}},{key:"componentWillUnmount",value:function(){clearTimeout(this.timer),this.requestRef&&cancelAnimationFrame(this.requestRef)}},{key:"render",value:function(){var y=this.state.activeData,I=y===void 0?[]:y;return Se.a.createElement("div",{className:Bo.activeChart},Se.a.createElement(ze.a,{title:"\u76EE\u6807\u8BC4\u4F30",value:"\u6709\u671B\u8FBE\u5230\u9884\u671F"}),Se.a.createElement("div",{style:{marginTop:32}},Se.a.createElement($,{animate:!1,line:!0,borderWidth:2,height:84,scale:{y:{tickCount:3}},yAxis:{tickLine:void 0,label:void 0,title:void 0,line:void 0},data:I})),I&&Se.a.createElement("div",null,Se.a.createElement("div",{className:Bo.activeChartGrid},Se.a.createElement("p",null,Object(Uo.a)(I).sort()[I.length-1].y+200," \u4EBF\u5143"),Se.a.createElement("p",null,Object(Uo.a)(I).sort()[Math.floor(I.length/2)].y," \u4EBF\u5143")),Se.a.createElement("div",{className:Bo.dashedLine},Se.a.createElement("div",{className:Bo.line})),Se.a.createElement("div",{className:Bo.dashedLine},Se.a.createElement("div",{className:Bo.line}))),I&&Se.a.createElement("div",{className:Bo.activeChartLegend},Se.a.createElement("span",null,"00:00"),Se.a.createElement("span",null,I[Math.floor(I.length/2)].x),Se.a.createElement("span",null,I[I.length-1].x)))}}]),c}(be.Component),yi={mapChart:"mapChart___4fQJB",pieCard:"pieCard___1ETZj"},An=ze.a.Countdown,Ra=Date.now()+1e3*60*60*24*2+1e3*30,Va=function(w){Object(ee.a)(c,w);var b=Object(ce.a)(c);function c(){return Object(D.a)(this,c),b.apply(this,arguments)}return Object(J.a)(c,[{key:"componentDidMount",value:function(){var y=this.props.dispatch;y({type:"dashboardAndmonitor/fetchTags"})}},{key:"render",value:function(){var y=this.props,I=y.dashboardAndmonitor,te=y.loading,B=I.tags;return Se.a.createElement(mt.a,null,Se.a.createElement(Se.a.Fragment,null,Se.a.createElement(F.a,{gutter:24},Se.a.createElement(Z.a,{xl:18,lg:24,md:24,sm:24,xs:24,style:{marginBottom:24}},Se.a.createElement(p.a,{title:Se.a.createElement(Xe.a,{id:"dashboardandmonitor.monitor.trading-activity",defaultMessage:"Real-Time Trading Activity"}),bordered:!1},Se.a.createElement(F.a,null,Se.a.createElement(Z.a,{md:6,sm:12,xs:24},Se.a.createElement(ze.a,{title:Se.a.createElement(Xe.a,{id:"dashboardandmonitor.monitor.total-transactions",defaultMessage:"Total transactions today"}),suffix:"\u5143",value:St()(124543233).format("0,0")})),Se.a.createElement(Z.a,{md:6,sm:12,xs:24},Se.a.createElement(ze.a,{title:Se.a.createElement(Xe.a,{id:"dashboardandmonitor.monitor.sales-target",defaultMessage:"Sales target completion rate"}),value:"92%"})),Se.a.createElement(Z.a,{md:6,sm:12,xs:24},Se.a.createElement(An,{title:Se.a.createElement(Xe.a,{id:"dashboardandmonitor.monitor.remaining-time",defaultMessage:"Remaining time of activity"}),value:Ra,format:"HH:mm:ss:SSS"})),Se.a.createElement(Z.a,{md:6,sm:12,xs:24},Se.a.createElement(ze.a,{title:Se.a.createElement(Xe.a,{id:"dashboardandmonitor.monitor.total-transactions-per-second",defaultMessage:"Total transactions per second"}),suffix:"\u5143",value:St()(234).format("0,0")}))),Se.a.createElement("div",{className:yi.mapChart},Se.a.createElement(zo,null)))),Se.a.createElement(Z.a,{xl:6,lg:24,md:24,sm:24,xs:24},Se.a.createElement(p.a,{title:Se.a.createElement(Xe.a,{id:"dashboardandmonitor.monitor.activity-forecast",defaultMessage:"Activity forecast"}),style:{marginBottom:24},bordered:!1},Se.a.createElement(ou,null)),Se.a.createElement(p.a,{title:Se.a.createElement(Xe.a,{id:"dashboardandmonitor.monitor.efficiency",defaultMessage:"Efficiency"}),style:{marginBottom:24},bodyStyle:{textAlign:"center"},bordered:!1},Se.a.createElement(Wt,{title:Object(Xe.d)({id:"dashboardandmonitor.monitor.ratio",defaultMessage:"Ratio"}),height:180,percent:87})))),Se.a.createElement(F.a,{gutter:24},Se.a.createElement(Z.a,{xl:12,lg:24,sm:24,xs:24,style:{marginBottom:24}},Se.a.createElement(p.a,{title:Se.a.createElement(Xe.a,{id:"dashboardandmonitor.monitor.proportion-per-category",defaultMessage:"Proportion Per Category"}),bordered:!1,className:yi.pieCard},Se.a.createElement(F.a,{style:{padding:"16px 0"}},Se.a.createElement(Z.a,{span:8},Se.a.createElement(gt,{animate:!1,percent:28,title:Se.a.createElement(Xe.a,{id:"dashboardandmonitor.monitor.fast-food",defaultMessage:"Fast food"}),total:"28%",height:128,lineWidth:2})),Se.a.createElement(Z.a,{span:8},Se.a.createElement(gt,{animate:!1,color:"#5DDECF",percent:22,title:Se.a.createElement(Xe.a,{id:"dashboardandmonitor.monitor.western-food",defaultMessage:"Western food"}),total:"22%",height:128,lineWidth:2})),Se.a.createElement(Z.a,{span:8},Se.a.createElement(gt,{animate:!1,color:"#2FC25B",percent:32,title:Se.a.createElement(Xe.a,{id:"dashboardandmonitor.monitor.hot-pot",defaultMessage:"Hot pot"}),total:"32%",height:128,lineWidth:2}))))),Se.a.createElement(Z.a,{xl:6,lg:12,sm:24,xs:24,style:{marginBottom:24}},Se.a.createElement(p.a,{title:Se.a.createElement(Xe.a,{id:"dashboardandmonitor.monitor.popular-searches",defaultMessage:"Popular Searches"}),loading:te,bordered:!1,bodyStyle:{overflow:"hidden"}},Se.a.createElement(He,{data:B||[],height:161}))),Se.a.createElement(Z.a,{xl:6,lg:12,sm:24,xs:24,style:{marginBottom:24}},Se.a.createElement(p.a,{title:Se.a.createElement(Xe.a,{id:"dashboardandmonitor.monitor.resource-surplus",defaultMessage:"Resource Surplus"}),bodyStyle:{textAlign:"center",fontSize:0},bordered:!1},Se.a.createElement(ot,{height:161,title:Se.a.createElement(Xe.a,{id:"dashboardandmonitor.monitor.fund-surplus",defaultMessage:"Fund Surplus"}),percent:34}))))))}}]),c}(be.Component),rs=g.default=Object(Xe.c)(function(w){var b=w.dashboardAndmonitor,c=w.loading;return{dashboardAndmonitor:b,loading:c.models.dashboardAndmonitor}})(Va)},aF1E:function(Ue,g,o){"use strict";o.d(g,"a",function(){return i});var E=o("lSNA"),p=o.n(E);function X(Z,D){var J=Object.keys(Z);if(Object.getOwnPropertySymbols){var ee=Object.getOwnPropertySymbols(Z);D&&(ee=ee.filter(function(ce){return Object.getOwnPropertyDescriptor(Z,ce).enumerable})),J.push.apply(J,ee)}return J}function F(Z){for(var D=1;D<arguments.length;D++){var J=arguments[D]!=null?arguments[D]:{};D%2?X(Object(J),!0).forEach(function(ee){p()(Z,ee,J[ee])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Z,Object.getOwnPropertyDescriptors(J)):X(Object(J)).forEach(function(ee){Object.defineProperty(Z,ee,Object.getOwnPropertyDescriptor(J,ee))})}return Z}function i(Z,D){var J=D.sourceField,ee=D.targetField,ce=D.data,Y={};return ce.forEach(function(ze){Y[ze[J]]=ze}),Z.dataArray=Z.dataArray.map(function(ze){var Xe=ze[ee];return F(F({},ze),Y[Xe])}),Z}},aHsQ:function(Ue,g,o){"use strict";var E=o("cIOH"),p=o("cWXX")},aPG5:function(Ue,g,o){"use strict";Object.defineProperty(g,"__esModule",{value:!0}),g.resolve=void 0;var E=o("MON2"),p=o("FV85"),X=o("qK8v"),F=o("ujMp"),i=o("cSJO"),Z=function(ce,Y,ze){try{return ze()}catch(Xe){throw X.isStackOverflowExeption(Xe)?new Error(E.CIRCULAR_DEPENDENCY_IN_FACTORY(ce,Y.toString())):Xe}},D=function ee(ce){return function(Y){Y.parentContext.setCurrentRequest(Y);var ze=Y.bindings,Xe=Y.childRequests,be=Y.target&&Y.target.isArray(),Se=!Y.parentRequest||!Y.parentRequest.target||!Y.target||!Y.parentRequest.target.matchesArray(Y.target.serviceIdentifier);if(be&&Se)return Xe.map(function(Je){var wt=ee(ce);return wt(Je)});var mt=null;if(Y.target.isOptional()&&ze.length===0)return;var Le=ze[0],St=Le.scope===p.BindingScopeEnum.Singleton,Ye=Le.scope===p.BindingScopeEnum.Request;if(St&&Le.activated)return Le.cache;if(Ye&&ce!==null&&ce.has(Le.id))return ce.get(Le.id);if(Le.type===p.BindingTypeEnum.ConstantValue)mt=Le.cache;else if(Le.type===p.BindingTypeEnum.Function)mt=Le.cache;else if(Le.type===p.BindingTypeEnum.Constructor)mt=Le.implementationType;else if(Le.type===p.BindingTypeEnum.DynamicValue&&Le.dynamicValue!==null)mt=Z("toDynamicValue",Le.serviceIdentifier,function(){return Le.dynamicValue(Y.parentContext)});else if(Le.type===p.BindingTypeEnum.Factory&&Le.factory!==null)mt=Z("toFactory",Le.serviceIdentifier,function(){return Le.factory(Y.parentContext)});else if(Le.type===p.BindingTypeEnum.Provider&&Le.provider!==null)mt=Z("toProvider",Le.serviceIdentifier,function(){return Le.provider(Y.parentContext)});else if(Le.type===p.BindingTypeEnum.Instance&&Le.implementationType!==null)mt=i.resolveInstance(Le.implementationType,Xe,ee(ce));else{var dt=F.getServiceIdentifierAsString(Y.serviceIdentifier);throw new Error(E.INVALID_BINDING_TYPE+" "+dt)}return typeof Le.onActivation=="function"&&(mt=Le.onActivation(Y.parentContext,mt)),St&&(Le.cache=mt,Le.activated=!0),Ye&&ce!==null&&!ce.has(Le.id)&&ce.set(Le.id,mt),mt}};function J(ee){var ce=D(ee.plan.rootRequest.requestScope);return ce(ee.plan.rootRequest)}g.resolve=J},asDA:function(Ue,g){function o(E,p,X,F){var i=-1,Z=E==null?0:E.length;for(F&&Z&&(X=E[++i]);++i<Z;)X=p(X,E[i],i,E);return X}Ue.exports=o},b2z7:function(Ue,g){var o=/\w*$/;function E(p){var X=new p.constructor(p.source,o.exec(p));return X.lastIndex=p.lastIndex,X}Ue.exports=E},bB6j:function(Ue,g,o){"use strict";o.d(g,"a",function(){return E});var E={IEventEmitter:Symbol.for("IEventEmitter"),ISceneService:Symbol.for("ISceneService"),IGlobalConfigService:Symbol.for("IGlobalConfigService"),ICameraService:Symbol.for("ICameraService"),ICoordinateSystemService:Symbol.for("ICoordinateSystemService"),ILayerService:Symbol.for("ILayerService"),ILayerMappingService:Symbol.for("ILayerMappingService"),ILayerStyleService:Symbol.for("ILayerStyleService"),ILogService:Symbol.for("ILogService"),IMapService:Symbol.for("IMapService"),IMarkerService:Symbol.for("IMarkerService"),IPopupService:Symbol.for("PopupService"),IFactoryMapService:Symbol.for("Factory<IMapService>"),IRendererService:Symbol.for("IRendererService"),IShaderModuleService:Symbol.for("IShaderModuleService"),IIconService:Symbol.for("IIconService"),IFontService:Symbol.for("IFontService"),IInteractionService:Symbol.for("IInteractionService"),IPickingService:Symbol.for("IPickingService"),IControlService:Symbol.for("IControlService"),IStyleAttributeService:Symbol.for("IStyleAttributeService"),ILayer:Symbol.for("ILayer"),ILayerPlugin:Symbol.for("ILayerPlugin"),INormalPass:Symbol.for("INormalPass"),IPostProcessor:Symbol.for("IPostProcessor"),IPostProcessingPass:Symbol.for("IPostProcessingPass"),IFactoryPostProcessingPass:Symbol.for("Factory<IPostProcessingPass>"),IFactoryNormalPass:Symbol.for("Factory<IFactoryNormalPass>"),IMultiPassRenderer:Symbol.for("IMultiPassRenderer"),SceneID:Symbol.for("SceneID"),MapConfig:Symbol.for("MapConfig")}},bPkA:function(Ue,g,o){"use strict";o.d(g,"a",function(){return E});var E;(function(p){p.Normal="normal",p.PostProcessing="post-processing"})(E||(E={}))},bTtR:function(Ue,g){},bYl4:function(Ue,g){},bahg:function(Ue,g){function o(E){return E.split("")}Ue.exports=o},bl9R:function(Ue,g,o){"use strict";o.r(g),o.d(g,"create",function(){return p}),o.d(g,"clone",function(){return X}),o.d(g,"fromValues",function(){return F}),o.d(g,"copy",function(){return i}),o.d(g,"set",function(){return Z}),o.d(g,"add",function(){return D}),o.d(g,"subtract",function(){return J}),o.d(g,"multiply",function(){return ee}),o.d(g,"divide",function(){return ce}),o.d(g,"ceil",function(){return Y}),o.d(g,"floor",function(){return ze}),o.d(g,"min",function(){return Xe}),o.d(g,"max",function(){return be}),o.d(g,"round",function(){return Se}),o.d(g,"scale",function(){return mt}),o.d(g,"scaleAndAdd",function(){return Le}),o.d(g,"distance",function(){return St}),o.d(g,"squaredDistance",function(){return Ye}),o.d(g,"length",function(){return dt}),o.d(g,"squaredLength",function(){return Je}),o.d(g,"negate",function(){return wt}),o.d(g,"inverse",function(){return At}),o.d(g,"normalize",function(){return Ie}),o.d(g,"dot",function(){return Ne}),o.d(g,"cross",function(){return Ve}),o.d(g,"lerp",function(){return ct}),o.d(g,"random",function(){return Me}),o.d(g,"transformMat4",function(){return ht}),o.d(g,"transformQuat",function(){return Wt}),o.d(g,"zero",function(){return Qt}),o.d(g,"str",function(){return ur}),o.d(g,"exactEquals",function(){return oe}),o.d(g,"equals",function(){return $}),o.d(g,"sub",function(){return H}),o.d(g,"mul",function(){return Ae}),o.d(g,"div",function(){return ye}),o.d(g,"dist",function(){return Te}),o.d(g,"sqrDist",function(){return pe}),o.d(g,"len",function(){return it}),o.d(g,"sqrLen",function(){return qt}),o.d(g,"forEach",function(){return Pt});var E=o("yU0y");function p(){var me=new E.a(4);return E.a!=Float32Array&&(me[0]=0,me[1]=0,me[2]=0,me[3]=0),me}function X(me){var ve=new E.a(4);return ve[0]=me[0],ve[1]=me[1],ve[2]=me[2],ve[3]=me[3],ve}function F(me,ve,Ge,st){var Oe=new E.a(4);return Oe[0]=me,Oe[1]=ve,Oe[2]=Ge,Oe[3]=st,Oe}function i(me,ve){return me[0]=ve[0],me[1]=ve[1],me[2]=ve[2],me[3]=ve[3],me}function Z(me,ve,Ge,st,Oe){return me[0]=ve,me[1]=Ge,me[2]=st,me[3]=Oe,me}function D(me,ve,Ge){return me[0]=ve[0]+Ge[0],me[1]=ve[1]+Ge[1],me[2]=ve[2]+Ge[2],me[3]=ve[3]+Ge[3],me}function J(me,ve,Ge){return me[0]=ve[0]-Ge[0],me[1]=ve[1]-Ge[1],me[2]=ve[2]-Ge[2],me[3]=ve[3]-Ge[3],me}function ee(me,ve,Ge){return me[0]=ve[0]*Ge[0],me[1]=ve[1]*Ge[1],me[2]=ve[2]*Ge[2],me[3]=ve[3]*Ge[3],me}function ce(me,ve,Ge){return me[0]=ve[0]/Ge[0],me[1]=ve[1]/Ge[1],me[2]=ve[2]/Ge[2],me[3]=ve[3]/Ge[3],me}function Y(me,ve){return me[0]=Math.ceil(ve[0]),me[1]=Math.ceil(ve[1]),me[2]=Math.ceil(ve[2]),me[3]=Math.ceil(ve[3]),me}function ze(me,ve){return me[0]=Math.floor(ve[0]),me[1]=Math.floor(ve[1]),me[2]=Math.floor(ve[2]),me[3]=Math.floor(ve[3]),me}function Xe(me,ve,Ge){return me[0]=Math.min(ve[0],Ge[0]),me[1]=Math.min(ve[1],Ge[1]),me[2]=Math.min(ve[2],Ge[2]),me[3]=Math.min(ve[3],Ge[3]),me}function be(me,ve,Ge){return me[0]=Math.max(ve[0],Ge[0]),me[1]=Math.max(ve[1],Ge[1]),me[2]=Math.max(ve[2],Ge[2]),me[3]=Math.max(ve[3],Ge[3]),me}function Se(me,ve){return me[0]=Math.round(ve[0]),me[1]=Math.round(ve[1]),me[2]=Math.round(ve[2]),me[3]=Math.round(ve[3]),me}function mt(me,ve,Ge){return me[0]=ve[0]*Ge,me[1]=ve[1]*Ge,me[2]=ve[2]*Ge,me[3]=ve[3]*Ge,me}function Le(me,ve,Ge,st){return me[0]=ve[0]+Ge[0]*st,me[1]=ve[1]+Ge[1]*st,me[2]=ve[2]+Ge[2]*st,me[3]=ve[3]+Ge[3]*st,me}function St(me,ve){var Ge=ve[0]-me[0],st=ve[1]-me[1],Oe=ve[2]-me[2],gt=ve[3]-me[3];return Math.hypot(Ge,st,Oe,gt)}function Ye(me,ve){var Ge=ve[0]-me[0],st=ve[1]-me[1],Oe=ve[2]-me[2],gt=ve[3]-me[3];return Ge*Ge+st*st+Oe*Oe+gt*gt}function dt(me){var ve=me[0],Ge=me[1],st=me[2],Oe=me[3];return Math.hypot(ve,Ge,st,Oe)}function Je(me){var ve=me[0],Ge=me[1],st=me[2],Oe=me[3];return ve*ve+Ge*Ge+st*st+Oe*Oe}function wt(me,ve){return me[0]=-ve[0],me[1]=-ve[1],me[2]=-ve[2],me[3]=-ve[3],me}function At(me,ve){return me[0]=1/ve[0],me[1]=1/ve[1],me[2]=1/ve[2],me[3]=1/ve[3],me}function Ie(me,ve){var Ge=ve[0],st=ve[1],Oe=ve[2],gt=ve[3],C=Ge*Ge+st*st+Oe*Oe+gt*gt;return C>0&&(C=1/Math.sqrt(C)),me[0]=Ge*C,me[1]=st*C,me[2]=Oe*C,me[3]=gt*C,me}function Ne(me,ve){return me[0]*ve[0]+me[1]*ve[1]+me[2]*ve[2]+me[3]*ve[3]}function Ve(me,ve,Ge,st){var Oe=Ge[0]*st[1]-Ge[1]*st[0],gt=Ge[0]*st[2]-Ge[2]*st[0],C=Ge[0]*st[3]-Ge[3]*st[0],R=Ge[1]*st[2]-Ge[2]*st[1],q=Ge[1]*st[3]-Ge[3]*st[1],fe=Ge[2]*st[3]-Ge[3]*st[2],He=ve[0],et=ve[1],_t=ve[2],ot=ve[3];return me[0]=et*fe-_t*q+ot*R,me[1]=-(He*fe)+_t*C-ot*gt,me[2]=He*q-et*C+ot*Oe,me[3]=-(He*R)+et*gt-_t*Oe,me}function ct(me,ve,Ge,st){var Oe=ve[0],gt=ve[1],C=ve[2],R=ve[3];return me[0]=Oe+st*(Ge[0]-Oe),me[1]=gt+st*(Ge[1]-gt),me[2]=C+st*(Ge[2]-C),me[3]=R+st*(Ge[3]-R),me}function Me(me,ve){ve=ve||1;var Ge,st,Oe,gt,C,R;do Ge=E.c()*2-1,st=E.c()*2-1,C=Ge*Ge+st*st;while(C>=1);do Oe=E.c()*2-1,gt=E.c()*2-1,R=Oe*Oe+gt*gt;while(R>=1);var q=Math.sqrt((1-C)/R);return me[0]=ve*Ge,me[1]=ve*st,me[2]=ve*Oe*q,me[3]=ve*gt*q,me}function ht(me,ve,Ge){var st=ve[0],Oe=ve[1],gt=ve[2],C=ve[3];return me[0]=Ge[0]*st+Ge[4]*Oe+Ge[8]*gt+Ge[12]*C,me[1]=Ge[1]*st+Ge[5]*Oe+Ge[9]*gt+Ge[13]*C,me[2]=Ge[2]*st+Ge[6]*Oe+Ge[10]*gt+Ge[14]*C,me[3]=Ge[3]*st+Ge[7]*Oe+Ge[11]*gt+Ge[15]*C,me}function Wt(me,ve,Ge){var st=ve[0],Oe=ve[1],gt=ve[2],C=Ge[0],R=Ge[1],q=Ge[2],fe=Ge[3],He=fe*st+R*gt-q*Oe,et=fe*Oe+q*st-C*gt,_t=fe*gt+C*Oe-R*st,ot=-C*st-R*Oe-q*gt;return me[0]=He*fe+ot*-C+et*-q-_t*-R,me[1]=et*fe+ot*-R+_t*-C-He*-q,me[2]=_t*fe+ot*-q+He*-R-et*-C,me[3]=ve[3],me}function Qt(me){return me[0]=0,me[1]=0,me[2]=0,me[3]=0,me}function ur(me){return"vec4("+me[0]+", "+me[1]+", "+me[2]+", "+me[3]+")"}function oe(me,ve){return me[0]===ve[0]&&me[1]===ve[1]&&me[2]===ve[2]&&me[3]===ve[3]}function $(me,ve){var Ge=me[0],st=me[1],Oe=me[2],gt=me[3],C=ve[0],R=ve[1],q=ve[2],fe=ve[3];return Math.abs(Ge-C)<=E.b*Math.max(1,Math.abs(Ge),Math.abs(C))&&Math.abs(st-R)<=E.b*Math.max(1,Math.abs(st),Math.abs(R))&&Math.abs(Oe-q)<=E.b*Math.max(1,Math.abs(Oe),Math.abs(q))&&Math.abs(gt-fe)<=E.b*Math.max(1,Math.abs(gt),Math.abs(fe))}var H=J,Ae=ee,ye=ce,Te=St,pe=Ye,it=dt,qt=Je,Pt=function(){var me=p();return function(ve,Ge,st,Oe,gt,C){var R,q;for(Ge||(Ge=4),st||(st=0),Oe?q=Math.min(Oe*Ge+st,ve.length):q=ve.length,R=st;R<q;R+=Ge)me[0]=ve[R],me[1]=ve[R+1],me[2]=ve[R+2],me[3]=ve[R+3],gt(me,me,C),ve[R]=me[0],ve[R+1]=me[1],ve[R+2]=me[2],ve[R+3]=me[3];return ve}}()},bzyH:function(Ue,g){},cSJO:function(Ue,g,o){"use strict";var E=this&&this.__spreadArrays||function(){for(var ee=0,ce=0,Y=arguments.length;ce<Y;ce++)ee+=arguments[ce].length;for(var ze=Array(ee),Xe=0,ce=0;ce<Y;ce++)for(var be=arguments[ce],Se=0,mt=be.length;Se<mt;Se++,Xe++)ze[Xe]=be[Se];return ze};Object.defineProperty(g,"__esModule",{value:!0}),g.resolveInstance=void 0;var p=o("MON2"),X=o("FV85"),F=o("xfSm");function i(ee,ce,Y){var ze=ce.filter(function(be){return be.target!==null&&be.target.type===X.TargetTypeEnum.ClassProperty}),Xe=ze.map(Y);return ze.forEach(function(be,Se){var mt="";mt=be.target.name.value();var Le=Xe[Se];ee[mt]=Le}),ee}function Z(ee,ce){return new(ee.bind.apply(ee,E([void 0],ce)))}function D(ee,ce){if(Reflect.hasMetadata(F.POST_CONSTRUCT,ee)){var Y=Reflect.getMetadata(F.POST_CONSTRUCT,ee);try{ce[Y.value]()}catch(ze){throw new Error(p.POST_CONSTRUCT_ERROR(ee.name,ze.message))}}}function J(ee,ce,Y){var ze=null;if(ce.length>0){var Xe=ce.filter(function(Se){return Se.target!==null&&Se.target.type===X.TargetTypeEnum.ConstructorArgument}),be=Xe.map(Y);ze=Z(ee,be),ze=i(ze,ce,Y)}else ze=new ee;return D(ee,ze),ze}g.resolveInstance=J},cWXX:function(Ue,g,o){"use strict";var E=o("cIOH")},cWyK:function(Ue,g,o){"use strict";Object.defineProperty(g,"__esModule",{value:!0});var E=o("/rf6");function p(Ye,dt,Je){if(Ye===null)return;for(var wt,At,Ie,Ne,Ve,ct,Me,ht=0,Wt=0,Qt,ur=Ye.type,oe=ur==="FeatureCollection",$=ur==="Feature",H=oe?Ye.features.length:1,Ae=0;Ae<H;Ae++){Me=oe?Ye.features[Ae].geometry:$?Ye.geometry:Ye,Qt=Me?Me.type==="GeometryCollection":!1,Ve=Qt?Me.geometries.length:1;for(var ye=0;ye<Ve;ye++){var Te=0,pe=0;if(Ne=Qt?Me.geometries[ye]:Me,Ne===null)continue;ct=Ne.coordinates;var it=Ne.type;ht=Je&&(it==="Polygon"||it==="MultiPolygon")?1:0;switch(it){case null:break;case"Point":if(dt(ct,Wt,Ae,Te,pe)===!1)return!1;Wt++,Te++;break;case"LineString":case"MultiPoint":for(wt=0;wt<ct.length;wt++){if(dt(ct[wt],Wt,Ae,Te,pe)===!1)return!1;Wt++,it==="MultiPoint"&&Te++}it==="LineString"&&Te++;break;case"Polygon":case"MultiLineString":for(wt=0;wt<ct.length;wt++){for(At=0;At<ct[wt].length-ht;At++){if(dt(ct[wt][At],Wt,Ae,Te,pe)===!1)return!1;Wt++}it==="MultiLineString"&&Te++,it==="Polygon"&&pe++}it==="Polygon"&&Te++;break;case"MultiPolygon":for(wt=0;wt<ct.length;wt++){for(pe=0,At=0;At<ct[wt].length;At++){for(Ie=0;Ie<ct[wt][At].length-ht;Ie++){if(dt(ct[wt][At][Ie],Wt,Ae,Te,pe)===!1)return!1;Wt++}pe++}Te++}break;case"GeometryCollection":for(wt=0;wt<Ne.geometries.length;wt++)if(p(Ne.geometries[wt],dt,Je)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}function X(Ye,dt,Je,wt){var At=Je;return p(Ye,function(Ie,Ne,Ve,ct,Me){Ne===0&&Je===void 0?At=Ie:At=dt(At,Ie,Ne,Ve,ct,Me)},wt),At}function F(Ye,dt){var Je;switch(Ye.type){case"FeatureCollection":for(Je=0;Je<Ye.features.length&&!(dt(Ye.features[Je].properties,Je)===!1);Je++);break;case"Feature":dt(Ye.properties,0);break}}function i(Ye,dt,Je){var wt=Je;return F(Ye,function(At,Ie){Ie===0&&Je===void 0?wt=At:wt=dt(wt,At,Ie)}),wt}function Z(Ye,dt){if(Ye.type==="Feature")dt(Ye,0);else if(Ye.type==="FeatureCollection")for(var Je=0;Je<Ye.features.length&&!(dt(Ye.features[Je],Je)===!1);Je++);}function D(Ye,dt,Je){var wt=Je;return Z(Ye,function(At,Ie){Ie===0&&Je===void 0?wt=At:wt=dt(wt,At,Ie)}),wt}function J(Ye){var dt=[];return p(Ye,function(Je){dt.push(Je)}),dt}function ee(Ye,dt){var Je,wt,At,Ie,Ne,Ve,ct,Me,ht,Wt,Qt=0,ur=Ye.type==="FeatureCollection",oe=Ye.type==="Feature",$=ur?Ye.features.length:1;for(Je=0;Je<$;Je++){for(Ve=ur?Ye.features[Je].geometry:oe?Ye.geometry:Ye,Me=ur?Ye.features[Je].properties:oe?Ye.properties:{},ht=ur?Ye.features[Je].bbox:oe?Ye.bbox:void 0,Wt=ur?Ye.features[Je].id:oe?Ye.id:void 0,ct=Ve?Ve.type==="GeometryCollection":!1,Ne=ct?Ve.geometries.length:1,At=0;At<Ne;At++){if(Ie=ct?Ve.geometries[At]:Ve,Ie===null){if(dt(null,Qt,Me,ht,Wt)===!1)return!1;continue}switch(Ie.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(dt(Ie,Qt,Me,ht,Wt)===!1)return!1;break}case"GeometryCollection":{for(wt=0;wt<Ie.geometries.length;wt++)if(dt(Ie.geometries[wt],Qt,Me,ht,Wt)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}Qt++}}function ce(Ye,dt,Je){var wt=Je;return ee(Ye,function(At,Ie,Ne,Ve,ct){Ie===0&&Je===void 0?wt=At:wt=dt(wt,At,Ie,Ne,Ve,ct)}),wt}function Y(Ye,dt){ee(Ye,function(Je,wt,At,Ie,Ne){var Ve=Je===null?null:Je.type;switch(Ve){case null:case"Point":case"LineString":case"Polygon":return dt(E.feature(Je,At,{bbox:Ie,id:Ne}),wt,0)===!1?!1:void 0}var ct;switch(Ve){case"MultiPoint":ct="Point";break;case"MultiLineString":ct="LineString";break;case"MultiPolygon":ct="Polygon";break}for(var Me=0;Me<Je.coordinates.length;Me++){var ht=Je.coordinates[Me],Wt={type:ct,coordinates:ht};if(dt(E.feature(Wt,At),wt,Me)===!1)return!1}})}function ze(Ye,dt,Je){var wt=Je;return Y(Ye,function(At,Ie,Ne){Ie===0&&Ne===0&&Je===void 0?wt=At:wt=dt(wt,At,Ie,Ne)}),wt}function Xe(Ye,dt){Y(Ye,function(Je,wt,At){var Ie=0;if(!Je.geometry)return;var Ne=Je.geometry.type;if(Ne==="Point"||Ne==="MultiPoint")return;var Ve,ct=0,Me=0,ht=0;if(p(Je,function(Wt,Qt,ur,oe,$){if(Ve===void 0||wt>ct||oe>Me||$>ht){Ve=Wt,ct=wt,Me=oe,ht=$,Ie=0;return}var H=E.lineString([Ve,Wt],Je.properties);if(dt(H,wt,At,$,Ie)===!1)return!1;Ie++,Ve=Wt})===!1)return!1})}function be(Ye,dt,Je){var wt=Je,At=!1;return Xe(Ye,function(Ie,Ne,Ve,ct,Me){At===!1&&Je===void 0?wt=Ie:wt=dt(wt,Ie,Ne,Ve,ct,Me),At=!0}),wt}function Se(Ye,dt){if(!Ye)throw new Error("geojson is required");Y(Ye,function(Je,wt,At){if(Je.geometry===null)return;var Ie=Je.geometry.type,Ne=Je.geometry.coordinates;switch(Ie){case"LineString":if(dt(Je,wt,At,0,0)===!1)return!1;break;case"Polygon":for(var Ve=0;Ve<Ne.length;Ve++)if(dt(E.lineString(Ne[Ve],Je.properties),wt,At,Ve)===!1)return!1;break}})}function mt(Ye,dt,Je){var wt=Je;return Se(Ye,function(At,Ie,Ne,Ve){Ie===0&&Je===void 0?wt=At:wt=dt(wt,At,Ie,Ne,Ve)}),wt}function Le(Ye,dt){if(dt=dt||{},!E.isObject(dt))throw new Error("options is invalid");var Je=dt.featureIndex||0,wt=dt.multiFeatureIndex||0,At=dt.geometryIndex||0,Ie=dt.segmentIndex||0,Ne=dt.properties,Ve;switch(Ye.type){case"FeatureCollection":Je<0&&(Je=Ye.features.length+Je),Ne=Ne||Ye.features[Je].properties,Ve=Ye.features[Je].geometry;break;case"Feature":Ne=Ne||Ye.properties,Ve=Ye.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":Ve=Ye;break;default:throw new Error("geojson is invalid")}if(Ve===null)return null;var ct=Ve.coordinates;switch(Ve.type){case"Point":case"MultiPoint":return null;case"LineString":return Ie<0&&(Ie=ct.length+Ie-1),E.lineString([ct[Ie],ct[Ie+1]],Ne,dt);case"Polygon":return At<0&&(At=ct.length+At),Ie<0&&(Ie=ct[At].length+Ie-1),E.lineString([ct[At][Ie],ct[At][Ie+1]],Ne,dt);case"MultiLineString":return wt<0&&(wt=ct.length+wt),Ie<0&&(Ie=ct[wt].length+Ie-1),E.lineString([ct[wt][Ie],ct[wt][Ie+1]],Ne,dt);case"MultiPolygon":return wt<0&&(wt=ct.length+wt),At<0&&(At=ct[wt].length+At),Ie<0&&(Ie=ct[wt][At].length-Ie-1),E.lineString([ct[wt][At][Ie],ct[wt][At][Ie+1]],Ne,dt)}throw new Error("geojson is invalid")}function St(Ye,dt){if(dt=dt||{},!E.isObject(dt))throw new Error("options is invalid");var Je=dt.featureIndex||0,wt=dt.multiFeatureIndex||0,At=dt.geometryIndex||0,Ie=dt.coordIndex||0,Ne=dt.properties,Ve;switch(Ye.type){case"FeatureCollection":Je<0&&(Je=Ye.features.length+Je),Ne=Ne||Ye.features[Je].properties,Ve=Ye.features[Je].geometry;break;case"Feature":Ne=Ne||Ye.properties,Ve=Ye.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":Ve=Ye;break;default:throw new Error("geojson is invalid")}if(Ve===null)return null;var ct=Ve.coordinates;switch(Ve.type){case"Point":return E.point(ct,Ne,dt);case"MultiPoint":return wt<0&&(wt=ct.length+wt),E.point(ct[wt],Ne,dt);case"LineString":return Ie<0&&(Ie=ct.length+Ie),E.point(ct[Ie],Ne,dt);case"Polygon":return At<0&&(At=ct.length+At),Ie<0&&(Ie=ct[At].length+Ie),E.point(ct[At][Ie],Ne,dt);case"MultiLineString":return wt<0&&(wt=ct.length+wt),Ie<0&&(Ie=ct[wt].length+Ie),E.point(ct[wt][Ie],Ne,dt);case"MultiPolygon":return wt<0&&(wt=ct.length+wt),At<0&&(At=ct[wt].length+At),Ie<0&&(Ie=ct[wt][At].length-Ie),E.point(ct[wt][At][Ie],Ne,dt)}throw new Error("geojson is invalid")}g.coordEach=p,g.coordReduce=X,g.propEach=F,g.propReduce=i,g.featureEach=Z,g.featureReduce=D,g.coordAll=J,g.geomEach=ee,g.geomReduce=ce,g.flattenEach=Y,g.flattenReduce=ze,g.segmentEach=Xe,g.segmentReduce=be,g.lineEach=Se,g.lineReduce=mt,g.findSegment=Le,g.findPoint=St},cZ5Q:function(Ue,g,o){"use strict";Object.defineProperty(g,"__esModule",{value:!0}),g.injectable=void 0;var E=o("MON2"),p=o("xfSm");function X(){return function(F){if(Reflect.hasOwnMetadata(p.PARAM_TYPES,F))throw new Error(E.DUPLICATED_INJECTABLE_DECORATOR);var i=Reflect.getMetadata(p.DESIGN_PARAM_TYPES,F)||[];return Reflect.defineMetadata(p.PARAM_TYPES,i,F),F}}g.injectable=X},cZlC:function(Ue,g,o){"use strict";o.d(g,"b",function(){return E}),o.d(g,"c",function(){return p}),o.d(g,"a",function(){return X});var E;(function(F){F.LINEAR="linear",F.POWER="power",F.LOG="log",F.IDENTITY="identity",F.TIME="time",F.QUANTILE="quantile",F.QUANTIZE="quantize",F.THRESHOLD="threshold",F.CAT="cat"})(E||(E={}));var p;(function(F){F.CONSTANT="constant",F.VARIABLE="variable"})(p||(p={}));var X;(function(F){F[F.Attribute=0]="Attribute",F[F.InstancedAttribute=1]="InstancedAttribute",F[F.Uniform=2]="Uniform"})(X||(X={}))},"cq/+":function(Ue,g,o){var E=o("mc0g"),p=E();Ue.exports=p},cvCv:function(Ue,g){function o(E){return function(){return E}}Ue.exports=o},d9O0:function(Ue,g,o){"use strict";Object.defineProperty(g,"__esModule",{value:!0}),g.id=void 0;var E=0;function p(){return E++}g.id=p},dQpi:function(Ue,g,o){var E=o("yGk4"),p=o("vN+2"),X=o("rEGp"),F=1/0,i=E&&1/X(new E([,-0]))[1]==F?function(Z){return new E(Z)}:p;Ue.exports=i},dTAl:function(Ue,g,o){var E=o("GoyQ"),p=Object.create,X=function(){function F(){}return function(i){if(!E(i))return{};if(p)return p(i);F.prototype=i;var Z=new F;return F.prototype=void 0,Z}}();Ue.exports=X},dVn5:function(Ue,g){var o=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;function E(p){return p.match(o)||[]}Ue.exports=E},dX1H:function(Ue,g,o){"use strict";Object.defineProperty(g,"__esModule",{value:!0}),g.Target=void 0;var E=o("xfSm"),p=o("d9O0"),X=o("GXnB"),F=o("zxMA"),i=function(){function Z(D,J,ee,ce){this.id=p.id(),this.type=D,this.serviceIdentifier=ee,this.name=new F.QueryableString(J||""),this.metadata=new Array;var Y=null;typeof ce=="string"?Y=new X.Metadata(E.NAMED_TAG,ce):ce instanceof X.Metadata&&(Y=ce),Y!==null&&this.metadata.push(Y)}return Z.prototype.hasTag=function(D){for(var J=0,ee=this.metadata;J<ee.length;J++){var ce=ee[J];if(ce.key===D)return!0}return!1},Z.prototype.isArray=function(){return this.hasTag(E.MULTI_INJECT_TAG)},Z.prototype.matchesArray=function(D){return this.matchesTag(E.MULTI_INJECT_TAG)(D)},Z.prototype.isNamed=function(){return this.hasTag(E.NAMED_TAG)},Z.prototype.isTagged=function(){return this.metadata.some(function(D){return D.key!==E.INJECT_TAG&&D.key!==E.MULTI_INJECT_TAG&&D.key!==E.NAME_TAG&&D.key!==E.UNMANAGED_TAG&&D.key!==E.NAMED_TAG})},Z.prototype.isOptional=function(){return this.matchesTag(E.OPTIONAL_TAG)(!0)},Z.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter(function(D){return D.key===E.NAMED_TAG})[0]:null},Z.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter(function(D){return D.key!==E.INJECT_TAG&&D.key!==E.MULTI_INJECT_TAG&&D.key!==E.NAME_TAG&&D.key!==E.UNMANAGED_TAG&&D.key!==E.NAMED_TAG}):null},Z.prototype.matchesNamedTag=function(D){return this.matchesTag(E.NAMED_TAG)(D)},Z.prototype.matchesTag=function(D){var J=this;return function(ee){for(var ce=0,Y=J.metadata;ce<Y.length;ce++){var ze=Y[ce];if(ze.key===D&&ze.value===ee)return!0}return!1}},Z}();g.Target=i},doU7:function(Ue,g,o){"use strict";Object.defineProperty(g,"__esModule",{value:!0}),g.BindingCount=void 0;var E={MultipleBindingsAvailable:2,NoBindingsAvailable:0,OnlyOneBindingAvailable:1};g.BindingCount=E},dt0z:function(Ue,g,o){var E=o("zoYe");function p(X){return X==null?"":E(X)}Ue.exports=p},dxzI:function(Ue,g,o){"use strict";Object.defineProperty(g,"__esModule",{value:!0}),g.AsyncContainerModule=g.ContainerModule=void 0;var E=o("d9O0"),p=function(){function F(i){this.id=E.id(),this.registry=i}return F}();g.ContainerModule=p;var X=function(){function F(i){this.id=E.id(),this.registry=i}return F}();g.AsyncContainerModule=X},eUgh:function(Ue,g){function o(E,p){for(var X=-1,F=E==null?0:E.length,i=Array(F);++X<F;)i[X]=p(E[X],X,E);return i}Ue.exports=o},"eg+a":function(Ue,g,o){"use strict";o.d(g,"a",function(){return E});var E=["loaded","maploaded","resize","destroy","dragstart","dragging","dragend","dragcancel"]},fX6N:function(Ue,g,o){"use strict";o.d(g,"d",function(){return Ef}),o.d(g,"b",function(){return Gc}),o.d(g,"a",function(){return dl});var E=o("mNvP"),p=o("uhBA"),X=o.n(p),F=o("4cb6"),i=o("APxj"),Z=o.n(i),D=o("bB6j"),J=o("lSNA"),ee=o.n(J),ce=o("lwsE"),Y=o.n(ce),ze=o("W8MJ"),Xe=o.n(ze),be=o("Hel2"),Se=o("rxlC"),mt=o.n(Se);function Le(ne,se){var N=Object.keys(ne);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(ne);se&&(G=G.filter(function(Ce){return Object.getOwnPropertyDescriptor(ne,Ce).enumerable})),N.push.apply(N,G)}return N}function St(ne){for(var se=1;se<arguments.length;se++){var N=arguments[se]!=null?arguments[se]:{};se%2?Le(Object(N),!0).forEach(function(G){ee()(ne,G,N[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(N)):Le(Object(N)).forEach(function(G){Object.defineProperty(ne,G,Object.getOwnPropertyDescriptor(N,G))})}return ne}function Ye(ne,se){var N;if(typeof Symbol=="undefined"||ne[Symbol.iterator]==null){if(Array.isArray(ne)||(N=dt(ne))||se&&ne&&typeof ne.length=="number"){N&&(ne=N);var G=0,Ce=function(){};return{s:Ce,n:function(){return G>=ne.length?{done:!0}:{done:!1,value:ne[G++]}},e:function(Dr){throw Dr},f:Ce}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var ft=!0,Yt=!1,sr;return{s:function(){N=ne[Symbol.iterator]()},n:function(){var Dr=N.next();return ft=Dr.done,Dr},e:function(Dr){Yt=!0,sr=Dr},f:function(){try{!ft&&N.return!=null&&N.return()}finally{if(Yt)throw sr}}}}function dt(ne,se){if(!ne)return;if(typeof ne=="string")return Je(ne,se);var N=Object.prototype.toString.call(ne).slice(8,-1);if(N==="Object"&&ne.constructor&&(N=ne.constructor.name),N==="Map"||N==="Set")return Array.from(ne);if(N==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(N))return Je(ne,se)}function Je(ne,se){(se==null||se>ne.length)&&(se=ne.length);for(var N=0,G=new Array(se);N<se;N++)G[N]=ne[N];return G}var wt=30;function At(ne){var se=ne.characterSet,N=ne.getFontWidth,G=ne.fontHeight,Ce=ne.buffer,ft=ne.maxCanvasWidth,Yt=ne.mapping,sr=Yt===void 0?{}:Yt,or=ne.xOffset,Dr=or===void 0?0:or,sn=ne.yOffset,Hn=sn===void 0?0:sn,ea=0,la=Dr;Array.from(se).forEach(function(ja,Ti){if(!sr[ja]){var Qa=N(ja,Ti);la+wt>ft&&(la=0,ea++),sr[ja]={x:la,y:Hn+ea*wt,width:wt,height:wt,advance:Qa},la+=wt}});var ti=G+Ce*2;return{mapping:sr,xOffset:la,yOffset:Hn+ea*ti,canvasHeight:Ve(Hn+(ea+1)*ti)}}function Ie(ne,se,N){var G=0,Ce=0,ft=0,Yt=[],sr={},or=Ye(ne),Dr;try{for(or.s();!(Dr=or.n()).done;){var sn=Dr.value;if(!sr[sn.id]){var Hn=sn.height,ea=sn.width;G+ea+se>N&&(Ne(sr,Yt,Ce),G=0,Ce=ft+Ce+se,ft=0,Yt=[]),Yt.push({icon:sn,xOffset:G}),G=G+ea+se,ft=Math.max(ft,Hn)}}}catch(ti){or.e(ti)}finally{or.f()}Yt.length>0&&Ne(sr,Yt,Ce);var la=Ve(ft+Ce+se);return{mapping:sr,canvasHeight:la}}function Ne(ne,se,N){var G=Ye(se),Ce;try{for(G.s();!(Ce=G.n()).done;){var ft=Ce.value,Yt=ft.icon,sr=ft.xOffset;ne[Yt.id]=St(St({},Yt),{},{x:sr,y:N,image:Yt.image})}}catch(or){G.e(or)}finally{G.f()}}function Ve(ne){return Math.pow(2,Math.ceil(Math.log2(ne)))}var ct,Me,ht;function Wt(ne,se){var N;if(typeof Symbol=="undefined"||ne[Symbol.iterator]==null){if(Array.isArray(ne)||(N=Qt(ne))||se&&ne&&typeof ne.length=="number"){N&&(ne=N);var G=0,Ce=function(){};return{s:Ce,n:function(){return G>=ne.length?{done:!0}:{done:!1,value:ne[G++]}},e:function(Dr){throw Dr},f:Ce}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var ft=!0,Yt=!1,sr;return{s:function(){N=ne[Symbol.iterator]()},n:function(){var Dr=N.next();return ft=Dr.done,Dr},e:function(Dr){Yt=!0,sr=Dr},f:function(){try{!ft&&N.return!=null&&N.return()}finally{if(Yt)throw sr}}}}function Qt(ne,se){if(!ne)return;if(typeof ne=="string")return ur(ne,se);var N=Object.prototype.toString.call(ne).slice(8,-1);if(N==="Object"&&ne.constructor&&(N=ne.constructor.name),N==="Map"||N==="Set")return Array.from(ne);if(N==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(N))return ur(ne,se)}function ur(ne,se){(se==null||se>ne.length)&&(se=ne.length);for(var N=0,G=new Array(se);N<se;N++)G[N]=ne[N];return G}function oe(ne,se){var N=Object.keys(ne);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(ne);se&&(G=G.filter(function(Ce){return Object.getOwnPropertyDescriptor(ne,Ce).enumerable})),N.push.apply(N,G)}return N}function $(ne){for(var se=1;se<arguments.length;se++){var N=arguments[se]!=null?arguments[se]:{};se%2?oe(Object(N),!0).forEach(function(G){ee()(ne,G,N[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(N)):oe(Object(N)).forEach(function(G){Object.defineProperty(ne,G,Object.getOwnPropertyDescriptor(N,G))})}return ne}var H=Oe(),Ae="sans-serif",ye="normal",Te=24,pe=3,it=.25,qt=8,Pt=1024,me=1,ve=1,Ge=3,st=["fontFamily","fontWeight","characterSet","fontSize","sdf","buffer","cutoff","radius"];function Oe(){for(var ne=[],se=32;se<128;se++)ne.push(String.fromCharCode(se));return ne}function gt(ne,se,N,G){ne.font="".concat(G," ").concat(N,"px ").concat(se),ne.fillStyle="black",ne.textBaseline="middle"}function C(ne,se){for(var N=0;N<ne.length;N++)se.data[4*N+3]=ne[N]}var R=(ct=Object(F.injectable)(),ct(Me=(ht=function(){function ne(){Y()(this,ne),this.fontAtlas=void 0,this.iconFontGlyphs={},this.fontOptions=void 0,this.key=void 0,this.cache=new be.b(Ge)}return Xe()(ne,[{key:"init",value:function(){this.cache.clear(),this.fontOptions={fontFamily:Ae,fontWeight:ye,characterSet:H,fontSize:Te,buffer:pe,sdf:!0,cutoff:it,radius:qt},this.key=""}},{key:"addIconGlyphs",value:function(N){var G=this;N.forEach(function(Ce){G.iconFontGlyphs[Ce.name]=Ce.unicode})}},{key:"getGlyph",value:function(N){return this.iconFontGlyphs[N]?String.fromCharCode(parseInt(this.iconFontGlyphs[N],16)):""}},{key:"setFontOptions",value:function(N){this.fontOptions=$($({},this.fontOptions),N),this.key=this.getKey();var G=this.getNewChars(this.key,this.fontOptions.characterSet),Ce=this.cache.get(this.key);if(Ce&&G.length===0)return;var ft=this.generateFontAtlas(this.key,G,Ce);this.fontAtlas=ft,this.cache.set(this.key,ft)}},{key:"destroy",value:function(){this.cache.clear()}},{key:"generateFontAtlas",value:function(N,G,Ce){var ft=this.fontOptions,Yt=ft.fontFamily,sr=ft.fontWeight,or=ft.fontSize,Dr=ft.buffer,sn=ft.sdf,Hn=ft.radius,ea=ft.cutoff,la=Ce&&Ce.data;la||(la=document.createElement("canvas"),la.width=Pt);var ti=la.getContext("2d");gt(ti,Yt,or,sr);var ja=At($({getFontWidth:function(cc){return ti.measureText(cc).width},fontHeight:or*ve,buffer:Dr,characterSet:G,maxCanvasWidth:Pt},Ce&&{mapping:Ce.mapping,xOffset:Ce.xOffset,yOffset:Ce.yOffset})),Ti=ja.mapping,Qa=ja.canvasHeight,Vi=ja.xOffset,Co=ja.yOffset;if(la.height!==Qa){var yo=ti.getImageData(0,0,la.width,la.height);la.height=Qa,ti.putImageData(yo,0,0)}if(gt(ti,Yt,or,sr),sn){var Zi=new mt.a(or,Dr,Hn,ea,Yt,sr),jo=ti.getImageData(0,0,Zi.size,Zi.size),qa=Wt(G),lo;try{for(qa.s();!(lo=qa.n()).done;){var iu=lo.value;C(Zi.draw(iu),jo),ti.putImageData(jo,Ti[iu].x,Ti[iu].y)}}catch(wo){qa.e(wo)}finally{qa.f()}}else{var _i=Wt(G),ki;try{for(_i.s();!(ki=_i.n()).done;){var Ea=ki.value;ti.fillText(Ea,Ti[Ea].x,Ti[Ea].y+or*me)}}catch(wo){_i.e(wo)}finally{_i.f()}}return{xOffset:Vi,yOffset:Co,mapping:Ti,data:la,width:la.width,height:la.height}}},{key:"getKey",value:function(){var N=this.fontOptions,G=N.fontFamily,Ce=N.fontWeight,ft=N.fontSize,Yt=N.buffer,sr=N.sdf,or=N.radius,Dr=N.cutoff;return sr?"".concat(G," ").concat(Ce," ").concat(ft," ").concat(Yt," ").concat(or," ").concat(Dr):"".concat(G," ").concat(Ce," ").concat(ft," ").concat(Yt)}},{key:"getNewChars",value:function(N,G){var Ce=this.cache.get(N);if(!Ce)return G;var ft=[],Yt=Ce.mapping,sr=new Set(Object.keys(Yt)),or=new Set(G);return or.forEach(function(Dr){sr.has(Dr)||ft.push(Dr)}),ft}},{key:"scale",get:function(){return ve}},{key:"canvas",get:function(){var N=this.cache.get(this.key);return N&&N.data}},{key:"mapping",get:function(){var N=this.cache.get(this.key);return N&&N.mapping}}]),ne}(),ht))||Me),q=o("7W2i"),fe=o.n(q),He=o("a1gu"),et=o.n(He),_t=o("Nsbk"),ot=o.n(_t),Ut,K,qe;function ae(ne){var se=tt();return function(){var G=ot()(ne),Ce;if(se){var ft=ot()(this).constructor;Ce=Reflect.construct(G,arguments,ft)}else Ce=G.apply(this,arguments);return et()(this,Ce)}}function tt(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var kt=3,pr=1024,Ke=64,xt=(Ut=Object(F.injectable)(),Ut(K=(qe=function(ne){fe()(N,ne);var se=ae(N);function N(){var G;Y()(this,N);for(var Ce=arguments.length,ft=new Array(Ce),Yt=0;Yt<Ce;Yt++)ft[Yt]=arguments[Yt];return G=se.call.apply(se,[this].concat(ft)),G.canvasHeight=void 0,G.texture=void 0,G.canvas=void 0,G.iconData=void 0,G.iconMap=void 0,G.ctx=void 0,G}return Xe()(N,[{key:"init",value:function(){this.iconData=[],this.iconMap={},this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d")}},{key:"addImage",value:function(Ce,ft){var Yt=this,sr=new Image;if(this.hasImage(Ce))throw new Error("Image Id already exists");this.iconData.push({id:Ce,width:Ke,height:Ke}),this.updateIconMap(),this.loadImage(ft).then(function(or){sr=or;var Dr=Yt.iconData.find(function(sn){return sn.id===Ce});Dr&&(Dr.image=sr),Yt.update()})}},{key:"getTexture",value:function(){return this.texture}},{key:"getIconMap",value:function(){return this.iconMap}},{key:"getCanvas",value:function(){return this.canvas}},{key:"hasImage",value:function(Ce){return this.iconMap.hasOwnProperty(Ce)}},{key:"removeImage",value:function(Ce){this.hasImage(Ce)&&(this.iconData=this.iconData.filter(function(ft){return ft.id!==Ce}),delete this.iconMap[Ce],this.update())}},{key:"destroy",value:function(){this.iconData=[],this.iconMap={}}},{key:"update",value:function(){this.updateIconMap(),this.updateIconAtlas(),this.emit("imageUpdate")}},{key:"updateIconAtlas",value:function(){var Ce=this;this.canvas.width=pr,this.canvas.height=this.canvasHeight,Object.keys(this.iconMap).forEach(function(ft){var Yt=Ce.iconMap[ft],sr=Yt.x,or=Yt.y,Dr=Yt.image;Dr&&Ce.ctx.drawImage(Dr,sr,or,Ke,Ke)})}},{key:"updateIconMap",value:function(){var Ce=Ie(this.iconData,kt,pr),ft=Ce.mapping,Yt=Ce.canvasHeight;this.iconMap=ft,this.canvasHeight=Yt}},{key:"loadImage",value:function(Ce){return new Promise(function(ft,Yt){if(Ce instanceof HTMLImageElement){ft(Ce);return}var sr=new Image;sr.crossOrigin="anonymous",sr.onload=function(){ft(sr)},sr.onerror=function(){Yt(new Error("Could not load image at "+Ce))},sr.src=Ce instanceof File?URL.createObjectURL(Ce):Ce})}}]),N}(p.EventEmitter),qe))||K),bt=o("J4zp"),Et=o.n(bt),Fe=o("IOcx"),pt,yt,Ht,hr=(pt=Object(F.injectable)(),pt(yt=(Ht=function(){function ne(){Y()(this,ne),this.viewport=void 0,this.overridedViewProjectionMatrix=void 0,this.jitteredViewProjectionMatrix=void 0,this.jitteredProjectionMatrix=void 0,this.viewMatrixInverse=void 0,this.cameraPosition=void 0}return Xe()(ne,[{key:"init",value:function(){}},{key:"update",value:function(N){this.viewport=N,this.viewMatrixInverse=Fe.b.invert(Fe.b.create(),this.getViewMatrix()),this.cameraPosition=[this.viewMatrixInverse[12],this.viewMatrixInverse[13],this.viewMatrixInverse[14]]}},{key:"getProjectionMatrix",value:function(){return this.jitteredProjectionMatrix||this.viewport.getProjectionMatrix()}},{key:"getViewMatrix",value:function(){return this.viewport.getViewMatrix()}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.getViewMatrixUncentered()}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.getViewProjectionMatrixUncentered()}},{key:"getViewProjectionMatrix",value:function(){return this.overridedViewProjectionMatrix||this.jitteredViewProjectionMatrix||this.viewport.getViewProjectionMatrix()}},{key:"getZoom",value:function(){return this.viewport.getZoom()}},{key:"getZoomScale",value:function(){return this.viewport.getZoomScale()}},{key:"getCenter",value:function(){var N=this.viewport.getCenter(),G=Et()(N,2),Ce=G[0],ft=G[1];return[Ce,ft]}},{key:"getFocalDistance",value:function(){return this.viewport.getFocalDistance()}},{key:"getCameraPosition",value:function(){return this.cameraPosition}},{key:"projectFlat",value:function(N,G){return this.viewport.projectFlat(N,G)}},{key:"setViewProjectionMatrix",value:function(N){this.overridedViewProjectionMatrix=N}},{key:"jitterProjectionMatrix",value:function(N,G){var Ce=Fe.b.fromTranslation(Fe.b.create(),[N,G,0]);this.jitteredProjectionMatrix=Fe.b.multiply(Fe.b.create(),Ce,this.viewport.getProjectionMatrix()),this.jitteredViewProjectionMatrix=Fe.b.multiply(Fe.b.create(),this.jitteredProjectionMatrix,this.viewport.getViewMatrix())}},{key:"clearJitterProjectionMatrix",value:function(){this.jitteredProjectionMatrix=void 0,this.jitteredViewProjectionMatrix=void 0}}]),ne}(),Ht))||yt),Zr,yr,Vn;function zn(ne,se){var N;if(typeof Symbol=="undefined"||ne[Symbol.iterator]==null){if(Array.isArray(ne)||(N=oa(ne))||se&&ne&&typeof ne.length=="number"){N&&(ne=N);var G=0,Ce=function(){};return{s:Ce,n:function(){return G>=ne.length?{done:!0}:{done:!1,value:ne[G++]}},e:function(Dr){throw Dr},f:Ce}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var ft=!0,Yt=!1,sr;return{s:function(){N=ne[Symbol.iterator]()},n:function(){var Dr=N.next();return ft=Dr.done,Dr},e:function(Dr){Yt=!0,sr=Dr},f:function(){try{!ft&&N.return!=null&&N.return()}finally{if(Yt)throw sr}}}}function oa(ne,se){if(!ne)return;if(typeof ne=="string")return $n(ne,se);var N=Object.prototype.toString.call(ne).slice(8,-1);if(N==="Object"&&ne.constructor&&(N=ne.constructor.name),N==="Map"||N==="Set")return Array.from(ne);if(N==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(N))return $n(ne,se)}function $n(ne,se){(se==null||se>ne.length)&&(se=ne.length);for(var N=0,G=new Array(se);N<se;N++)G[N]=ne[N];return G}var Kn=(Zr=Object(F.injectable)(),Zr(yr=(Vn=function(){function ne(){Y()(this,ne),this.container=void 0,this.controlCorners=void 0,this.controlContainer=void 0,this.scene=void 0,this.mapsService=void 0,this.controls=[],this.unAddControls=[]}return Xe()(ne,[{key:"init",value:function(N,G){this.container=N.container,this.scene=G,this.mapsService=G.get(D.a.IMapService),this.initControlPos()}},{key:"addControl",value:function(N,G){var Ce=G.get(D.a.IMapService);Ce.map?(N.addTo(this.scene),this.controls.push(N)):this.unAddControls.push(N)}},{key:"getControlByName",value:function(N){return this.controls.find(function(G){return G.controlOption.name===N})}},{key:"removeControl",value:function(N){var G=this.controls.indexOf(N);return G>-1&&this.controls.splice(G,1),N.remove(),this}},{key:"addControls",value:function(){var N=this;this.unAddControls.forEach(function(G){G.addTo(N.scene),N.controls.push(G)}),this.unAddControls=[]}},{key:"destroy",value:function(){var N=zn(this.controls),G;try{for(N.s();!(G=N.n()).done;){var Ce=G.value;Ce.remove()}}catch(ft){N.e(ft)}finally{N.f()}this.controls=[],this.clearControlPos()}},{key:"initControlPos",value:function(){var N=this.controlCorners={},G="l7-",Ce=this.controlContainer=be.a.create("div",G+"control-container",this.container);function ft(Yt,sr){var or=G+Yt+" "+G+sr;N[Yt+sr]=be.a.create("div",or,Ce)}ft("top","left"),ft("top","right"),ft("bottom","left"),ft("bottom","right")}},{key:"clearControlPos",value:function(){for(var N in this.controlCorners)this.controlCorners[N]&&be.a.remove(this.controlCorners[N]);this.controlContainer&&be.a.remove(this.controlContainer),delete this.controlCorners,delete this.controlContainer}}]),ne}(),Vn))||yr),Cn,z,W,le=(Cn=Object(F.injectable)(),Cn(z=(W=function(){function ne(){Y()(this,ne),this.container=void 0,this.scene=void 0,this.mapsService=void 0,this.markers=[],this.markerLayers=[],this.unAddMarkers=[],this.unAddMarkerLayers=[]}return Xe()(ne,[{key:"addMarkerLayer",value:function(N){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markerLayers.push(N),N.addTo(this.scene)):this.unAddMarkerLayers.push(N)}},{key:"removeMarkerLayer",value:function(N){N.destroy(),this.markerLayers.indexOf(N);var G=this.markerLayers.indexOf(N);G>-1&&this.markerLayers.splice(G,1)}},{key:"addMarker",value:function(N){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markers.push(N),N.addTo(this.scene)):this.unAddMarkers.push(N)}},{key:"addMarkers",value:function(){var N=this;this.unAddMarkers.forEach(function(G){G.addTo(N.scene),N.markers.push(G)}),this.unAddMarkers=[]}},{key:"addMarkerLayers",value:function(){var N=this;this.unAddMarkerLayers.forEach(function(G){N.markerLayers.push(G),G.addTo(N.scene)}),this.unAddMarkers=[]}},{key:"removeMarker",value:function(N){N.remove(),this.markers.indexOf(N);var G=this.markers.indexOf(N);G>-1&&this.markers.splice(G,1)}},{key:"removeAllMarkers",value:function(){this.destroy()}},{key:"init",value:function(N){this.scene=N,this.mapsService=N.get(D.a.IMapService)}},{key:"destroy",value:function(){this.markers.forEach(function(N){N.remove()}),this.markers=[],this.markerLayers.forEach(function(N){N.destroy()}),this.markerLayers=[]}},{key:"removeMakerLayerMarker",value:function(N){N.destroy()}}]),ne}(),W))||z),xe,ut,Ot,Bt=(xe=Object(F.injectable)(),xe(ut=(Ot=function(){function ne(){Y()(this,ne),this.scene=void 0,this.popup=void 0,this.mapsService=void 0,this.unAddPopup=void 0}return Xe()(ne,[{key:"removePopup",value:function(N){N.remove()}},{key:"destroy",value:function(){this.popup.remove()}},{key:"addPopup",value:function(N){this.popup&&this.popup.remove(),this.mapsService.map&&this.mapsService.getMarkerContainer()?(N.addTo(this.scene),this.popup=N):this.unAddPopup=N}},{key:"initPopup",value:function(){this.unAddPopup&&(this.addPopup(this.unAddPopup),this.unAddPopup=null)}},{key:"init",value:function(N){this.scene=N,this.mapsService=N.get(D.a.IMapService)}}]),ne}(),Ot))||ut),Ze=o("QkVN"),Rt=o.n(Ze),lr={MapToken:"\u60A8\u6B63\u5728\u4F7F\u7528 Demo\u6D4B\u8BD5\u5730\u56FEtoken\uFF0C\u5982\u679C\u751F\u4EA7\u73AF\u5883\u4E2D\u4F7F\u7528\u53BB\u5BF9\u5E94\u5730\u56FE\u8BF7\u6CE8\u518CToken",SDK:"\u8BF7\u786E\u8BA4\u5F15\u5165\u4E86mapbox-gl api\u4E14\u5728L7\u4E4B\u524D\u5F15\u5165"},Ur=lr,Gr,cr,Br;function wn(ne,se){var N=Object.keys(ne);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(ne);se&&(G=G.filter(function(Ce){return Object.getOwnPropertyDescriptor(ne,Ce).enumerable})),N.push.apply(N,G)}return N}function fn(ne){for(var se=1;se<arguments.length;se++){var N=arguments[se]!=null?arguments[se]:{};se%2?wn(Object(N),!0).forEach(function(G){ee()(ne,G,N[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(N)):wn(Object(N)).forEach(function(G){Object.defineProperty(ne,G,Object.getOwnPropertyDescriptor(N,G))})}return ne}var tr={id:"map",logoPosition:"bottomleft",logoVisible:!0,antialias:!0,preserveDrawingBuffer:!1,pickBufferScale:1,fitBoundsOptions:{animate:!1}},rn={colors:["rgb(103,0,31)","rgb(178,24,43)","rgb(214,96,77)","rgb(244,165,130)","rgb(253,219,199)","rgb(247,247,247)","rgb(209,229,240)","rgb(146,197,222)","rgb(67,147,195)","rgb(33,102,172)","rgb(5,48,97)"],size:10,shape:"circle",scales:{},shape2d:["circle","triangle","square","pentagon","hexagon","octogon","hexagram","rhombus","vesica"],shape3d:["cylinder","triangleColumn","hexagonColumn","squareColumn"],minZoom:-1,maxZoom:24,visible:!0,autoFit:!1,pickingBuffer:0,enablePropagation:!1,zIndex:0,blend:"normal",pickedFeatureID:-1,enableMultiPassRenderer:!1,enablePicking:!0,active:!1,activeColor:"#2f54eb",enableHighlight:!1,enableSelect:!1,highlightColor:"#2f54eb",selectColor:"blue",enableTAA:!1,jitterScale:1,enableLighting:!1,animateOption:{enable:!1,interval:.2,duration:4,trailLength:.15}},dn=(Gr=Object(F.injectable)(),Gr(cr=(Br=function(){function ne(){Y()(this,ne),this.sceneConfigCache={},this.layerConfigCache={}}return Xe()(ne,[{key:"getSceneConfig",value:function(N){return this.sceneConfigCache[N]}},{key:"getSceneWarninfo",value:function(N){return Ur[N]}},{key:"setSceneConfig",value:function(N,G){this.sceneConfigCache[N]=fn(fn({},tr),G)}},{key:"getLayerConfig",value:function(N){return this.layerConfigCache[N]}},{key:"setLayerConfig",value:function(N,G,Ce){this.layerConfigCache[G]=fn({},Rt()({},this.sceneConfigCache[N],rn,Ce))}},{key:"clean",value:function(){this.sceneConfigCache={},this.layerConfigCache={}}}]),ne}(),Br))||cr),En=o("yG8O"),bn=o.n(En),gn=o("U+yc"),Mn=o.n(gn),Ga=o("1ABj"),ga=Math.PI/180,Ma=512,Ia=4003e4;function Wi(ne){var se=ne.latitude,N=se===void 0?0:se,G=ne.zoom,Ce=G===void 0?0:G,ft=ne.scale,Yt=ne.highPrecision,sr=Yt===void 0?!1:Yt,or=ne.flipY,Dr=or===void 0?!1:or;ft=ft!==void 0?ft:Math.pow(2,Ce);var sn={},Hn=Ma*ft,ea=Math.cos(N*ga),la=Hn/360,ti=la/ea,ja=Hn/Ia/ea;if(sn.pixelsPerMeter=[ja,-ja,ja],sn.metersPerPixel=[1/ja,-1/ja,1/ja],sn.pixelsPerDegree=[la,-ti,ja],sn.degreesPerPixel=[1/la,-1/ti,1/ja],sr){var Ti=ga*Math.tan(N*ga)/ea,Qa=la*Ti/2,Vi=Hn/Ia*Ti,Co=Vi/ti*ja;sn.pixelsPerDegree2=[0,-Qa,Vi],sn.pixelsPerMeter2=[Co,0,Co],Dr&&(sn.pixelsPerDegree2[1]=-sn.pixelsPerDegree2[1],sn.pixelsPerMeter2[1]=-sn.pixelsPerMeter2[1])}return Dr&&(sn.pixelsPerMeter[1]=-sn.pixelsPerMeter[1],sn.metersPerPixel[1]=-sn.metersPerPixel[1],sn.pixelsPerDegree[1]=-sn.pixelsPerDegree[1],sn.degreesPerPixel[1]=-sn.degreesPerPixel[1]),sn}var da=o("HthE"),vi,ya,ba,ha,wi,is,Xi=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],Xo=(vi=Object(F.injectable)(),ya=Object(F.inject)(D.a.ICameraService),vi(ba=(ha=(is=function(){function ne(){Y()(this,ne),this.needRefresh=!0,bn()(this,"cameraService",wi,this),this.coordinateSystem=void 0,this.viewportCenter=void 0,this.viewportCenterProjection=void 0,this.pixelsPerDegree=void 0,this.pixelsPerDegree2=void 0,this.pixelsPerMeter=void 0}return Xe()(ne,[{key:"refresh",value:function(){var N=this.cameraService.getZoom(),G=this.cameraService.getZoomScale(),Ce=this.cameraService.getCenter(),ft=Wi({latitude:Ce[1],zoom:N}),Yt=ft.pixelsPerMeter,sr=ft.pixelsPerDegree;this.viewportCenter=Ce,this.viewportCenterProjection=[0,0,0,0],this.pixelsPerMeter=Yt,this.pixelsPerDegree=sr,this.pixelsPerDegree2=[0,0,0],this.coordinateSystem===da.a.LNGLAT||this.coordinateSystem===da.a.P20?this.cameraService.setViewProjectionMatrix(void 0):this.coordinateSystem===da.a.LNGLAT_OFFSET?this.calculateLnglatOffset(Ce,N):this.coordinateSystem===da.a.P20_OFFSET&&this.calculateLnglatOffset(Ce,N,G,!0),this.needRefresh=!1}},{key:"getCoordinateSystem",value:function(){return this.coordinateSystem}},{key:"setCoordinateSystem",value:function(N){this.coordinateSystem=N}},{key:"getViewportCenter",value:function(){return this.viewportCenter}},{key:"getViewportCenterProjection",value:function(){return this.viewportCenterProjection}},{key:"getPixelsPerDegree",value:function(){return this.pixelsPerDegree}},{key:"getPixelsPerDegree2",value:function(){return this.pixelsPerDegree2}},{key:"getPixelsPerMeter",value:function(){return this.pixelsPerMeter}},{key:"calculateLnglatOffset",value:function(N,G,Ce,ft){var Yt=Wi({latitude:N[1],zoom:G,scale:Ce,flipY:ft,highPrecision:!0}),sr=Yt.pixelsPerMeter,or=Yt.pixelsPerDegree,Dr=Yt.pixelsPerDegree2,sn=this.cameraService.getViewMatrix(),Hn=this.cameraService.getProjectionMatrix(),ea=Fe.b.multiply([],Hn,sn),la=this.cameraService.projectFlat([Math.fround(N[0]),Math.fround(N[1])],Math.pow(2,G));this.viewportCenterProjection=Fe.e.transformMat4([],[la[0],la[1],0,1],ea),sn=this.cameraService.getViewMatrixUncentered()||sn,ea=Fe.b.multiply([],Hn,sn),ea=Fe.b.multiply([],ea,Xi),this.cameraService.setViewProjectionMatrix(ea),this.pixelsPerMeter=sr,this.pixelsPerDegree=or,this.pixelsPerDegree2=Dr}}]),ne}(),is),wi=Mn()(ha.prototype,"cameraService",[ya],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ha))||ba),Du=o("PJYZ"),Ha=o.n(Du),Oi=o("yLV6"),Jo=o.n(Oi),ui=o("V1cb"),Yi,Oo,Za,oo,so,bu,Qo,Xl;function js(ne){var se=ho();return function(){var G=ot()(ne),Ce;if(se){var ft=ot()(this).constructor;Ce=Reflect.construct(G,arguments,ft)}else Ce=G.apply(this,arguments);return et()(this,Ce)}}function ho(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var Vt={panstart:"dragstart",panmove:"dragging",panend:"dragend",pancancel:"dragcancle"},Re=(Yi=Object(F.injectable)(),Oo=Object(F.inject)(D.a.IMapService),Za=Object(F.inject)(D.a.ILogService),Yi(oo=(so=(Xl=function(ne){fe()(N,ne);var se=js(N);function N(){var G;Y()(this,N);for(var Ce=arguments.length,ft=new Array(Ce),Yt=0;Yt<Ce;Yt++)ft[Yt]=arguments[Yt];return G=se.call.apply(se,[this].concat(ft)),bn()(G,"mapService",bu,Ha()(G)),bn()(G,"logger",Qo,Ha()(G)),G.hammertime=void 0,G.lastClickTime=0,G.lastClickXY=[-1,-1],G.clickTimer=void 0,G.$containter=void 0,G.onDrag=function(sr){var or=G.interactionEvent(sr);or.type=Vt[or.type],G.emit(ui.a.Drag,or)},G.onHammer=function(sr){sr.srcEvent.stopPropagation();var or=G.interactionEvent(sr);G.emit(ui.a.Hover,or)},G.onTouch=function(sr){var or=sr.touches[0];G.onHover({x:or.pageX,y:or.pageY,type:"touch"})},G.onHover=function(sr){var or=sr.clientX,Dr=sr.clientY,sn=or,Hn=Dr,ea=sr.type,la=G.mapService.getMapContainer();if(la){var ti=la.getBoundingClientRect(),ja=ti.top,Ti=ti.left;sn=sn-Ti-la.clientLeft,Hn=Hn-ja-la.clientTop}var Qa=G.mapService.containerToLngLat([sn,Hn]);if(ea==="click"){if("ontouchstart"in document.documentElement===!0)return;G.isDoubleTap(sn,Hn,Qa);return}if(ea==="touch"){G.isDoubleTap(sn,Hn,Qa);return}ea!=="click"&&ea!=="dblclick"&&G.emit(ui.a.Hover,{x:sn,y:Hn,lngLat:Qa,type:ea,target:sr})},G}return Xe()(N,[{key:"init",value:function(){this.addEventListenerOnMap(),this.$containter=this.mapService.getMapContainer()}},{key:"destroy",value:function(){this.hammertime&&this.hammertime.destroy(),this.removeEventListenerOnMap(),this.off(ui.a.Hover)}},{key:"triggerHover",value:function(Ce){var ft=Ce.x,Yt=Ce.y;this.emit(ui.a.Hover,{x:ft,y:Yt})}},{key:"triggerSelect",value:function(Ce){this.emit(ui.a.Select,{featureId:Ce})}},{key:"triggerActive",value:function(Ce){this.emit(ui.a.Active,{featureId:Ce})}},{key:"addEventListenerOnMap",value:function(){var Ce=this.mapService.getMapContainer();if(Ce){var ft=new Jo.a.Manager(Ce);ft.add(new Jo.a.Tap({event:"dblclick",taps:2})),ft.add(new Jo.a.Tap({event:"click"})),ft.add(new Jo.a.Pan({threshold:0,pointers:0})),ft.add(new Jo.a.Press({})),ft.on("dblclick click",this.onHammer),ft.on("panstart panmove panend pancancel",this.onDrag),Ce.addEventListener("mousemove",this.onHover),Ce.addEventListener("mousedown",this.onHover),Ce.addEventListener("mouseup",this.onHover),Ce.addEventListener("contextmenu",this.onHover),this.hammertime=ft,this.logger.debug("add event listeners on canvas")}}},{key:"removeEventListenerOnMap",value:function(){var Ce=this.mapService.getMapContainer();Ce&&(Ce.removeEventListener("mousemove",this.onHover),this.hammertime.off("panstart panmove panend pancancel",this.onDrag),Ce.removeEventListener("mousedown",this.onHover),Ce.removeEventListener("mouseup",this.onHover),Ce.removeEventListener("contextmenu",this.onHover))}},{key:"interactionEvent",value:function(Ce){var ft=Ce.type,Yt=Ce.pointerType,sr,or;Yt==="touch"?(or=Math.floor(Ce.pointers[0].clientY),sr=Math.floor(Ce.pointers[0].clientX)):(or=Math.floor(Ce.srcEvent.y),sr=Math.floor(Ce.srcEvent.x));var Dr=this.mapService.getMapContainer();if(Dr){var sn=Dr.getBoundingClientRect(),Hn=sn.top,ea=sn.left;sr-=ea,or-=Hn}var la=this.mapService.containerToLngLat([sr,or]);return{x:sr,y:or,lngLat:la,type:ft,target:Ce.srcEvent}}},{key:"isDoubleTap",value:function(Ce,ft,Yt){var sr=this,or=new Date().getTime(),Dr="click";or-this.lastClickTime<400&&Math.abs(this.lastClickXY[0]-Ce)<10&&Math.abs(this.lastClickXY[1]-ft)<10?(this.lastClickTime=0,this.lastClickXY=[-1,-1],this.clickTimer&&clearTimeout(this.clickTimer),Dr="dblclick",this.emit(ui.a.Hover,{x:Ce,y:ft,lngLat:Yt,type:Dr})):(this.lastClickTime=or,this.lastClickXY=[Ce,ft],this.clickTimer=setTimeout(function(){Dr="click",sr.emit(ui.a.Hover,{x:Ce,y:ft,lngLat:Yt,type:Dr})},400))}}]),N}(X.a),Xl),bu=Mn()(so.prototype,"mapService",[Oo],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Qo=Mn()(so.prototype,"logger",[Za],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),so))||oo),Dt=o("o0o1"),vr=o.n(Dt),en=o("yXPU"),Tn=o.n(en),Gn=o("o+pz"),Mi,po,mo,Mo,Nu,Ol,Ts,pc,xu,Po,ku,_o;function zi(ne,se){var N=Object.keys(ne);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(ne);se&&(G=G.filter(function(Ce){return Object.getOwnPropertyDescriptor(ne,Ce).enumerable})),N.push.apply(N,G)}return N}function Ys(ne){for(var se=1;se<arguments.length;se++){var N=arguments[se]!=null?arguments[se]:{};se%2?zi(Object(N),!0).forEach(function(G){ee()(ne,G,N[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(N)):zi(Object(N)).forEach(function(G){Object.defineProperty(ne,G,Object.getOwnPropertyDescriptor(N,G))})}return ne}var Ks=(Mi=Object(F.injectable)(),po=Object(F.inject)(D.a.IRendererService),mo=Object(F.inject)(D.a.IGlobalConfigService),Mo=Object(F.inject)(D.a.IInteractionService),Nu=Object(F.inject)(D.a.ILayerService),Mi(Ol=(Ts=(_o=function(){function ne(){var se=this;Y()(this,ne),bn()(this,"rendererService",pc,this),bn()(this,"configService",xu,this),bn()(this,"interactionService",Po,this),bn()(this,"layerService",ku,this),this.pickingFBO=void 0,this.width=0,this.height=0,this.alreadyInPicking=!1,this.pickBufferScale=1,this.pickFromPickingFBO=function(N,G){var Ce,ft=G.x,Yt=G.y,sr=G.lngLat,or=G.type,Dr=G.target,sn=!1,Hn=se.rendererService,ea=Hn.getViewportSize,la=Hn.readPixels,ti=Hn.getContainer,ja=ti().getBoundingClientRect(),Ti=ja.width,Qa=ja.height;Ti*=window.devicePixelRatio,Qa*=window.devicePixelRatio;var Vi=N.getLayerConfig(),Co=Vi.enableHighlight,yo=Vi.enableSelect,Zi=ft*window.devicePixelRatio,jo=Yt*window.devicePixelRatio;if(Zi>Ti-1*window.devicePixelRatio||Zi<0||jo>Qa-1*window.devicePixelRatio||jo<0)return!1;var qa;if(qa=la({x:Math.floor(Zi/se.pickBufferScale),y:Math.floor((Qa-(Yt+1)*window.devicePixelRatio)/se.pickBufferScale),width:1,height:1,data:new Uint8Array(1*1*4),framebuffer:se.pickingFBO}),qa[0]!==0||qa[1]!==0||qa[2]!==0){var lo=Object(be.k)(qa),iu=N.getSource().getFeatureById(lo);lo!==N.getCurrentPickId()&&or==="mousemove"&&(or="mouseenter");var _i={x:ft,y:Yt,type:or,lngLat:sr,featureId:lo,feature:iu,target:Dr};iu&&(sn=!0,N.setCurrentPickId(lo),se.triggerHoverOnLayer(N,_i))}else{var ki={x:ft,y:Yt,lngLat:sr,type:N.getCurrentPickId()!==null&&or==="mousemove"?"mouseout":"un"+or,featureId:null,target:Dr,feature:null};se.triggerHoverOnLayer(N,Ys(Ys({},ki),{},{type:"unpick"})),se.triggerHoverOnLayer(N,ki),N.setCurrentPickId(null)}if(Co&&se.highlightPickedFeature(N,qa),yo&&or==="click"&&((Ce=qa)===null||Ce===void 0?void 0:Ce.toString())!==[0,0,0,0].toString()){var Ea=Object(be.k)(qa);N.getCurrentSelectedId()===null||Ea!==N.getCurrentSelectedId()?(se.selectFeature(N,qa),N.setCurrentSelectedId(Ea)):(se.selectFeature(N,new Uint8Array([0,0,0,0])),N.setCurrentSelectedId(null))}return sn}}return Xe()(ne,[{key:"init",value:function(N){var G=this.rendererService,Ce=G.createTexture2D,ft=G.createFramebuffer,Yt=G.getViewportSize,sr=G.getContainer,or=sr().getBoundingClientRect(),Dr=or.width,sn=or.height;Dr*=window.devicePixelRatio,sn*=window.devicePixelRatio,this.pickBufferScale=this.configService.getSceneConfig(N).pickBufferScale||1,this.pickingFBO=ft({color:Ce({width:Math.round(Dr/this.pickBufferScale),height:Math.round(sn/this.pickBufferScale),wrapS:Gn.a.CLAMP_TO_EDGE,wrapT:Gn.a.CLAMP_TO_EDGE})}),this.interactionService.on(ui.a.Hover,this.pickingAllLayer.bind(this))}},{key:"pickingAllLayer",value:function(){var se=Tn()(vr.a.mark(function G(Ce){return vr.a.wrap(function(Yt){for(;;)switch(Yt.prev=Yt.next){case 0:if(!(this.alreadyInPicking||this.layerService.alreadyInRendering)){Yt.next=2;break}return Yt.abrupt("return");case 2:return this.alreadyInPicking=!0,Yt.next=5,this.pickingLayers(Ce);case 5:this.layerService.renderLayers(),this.alreadyInPicking=!1;case 7:case"end":return Yt.stop()}},G,this)}));function N(G){return se.apply(this,arguments)}return N}()},{key:"pickingLayers",value:function(){var se=Tn()(vr.a.mark(function G(Ce){var ft=this,Yt,sr,or,Dr,sn,Hn,ea,la;return vr.a.wrap(function(ja){for(;;)switch(ja.prev=ja.next){case 0:Yt=this.rendererService,sr=Yt.getViewportSize,or=Yt.useFramebuffer,Dr=Yt.clear,sn=Yt.getContainer,Hn=sn().getBoundingClientRect(),ea=Hn.width,la=Hn.height,ea*=window.devicePixelRatio,la*=window.devicePixelRatio,(this.width!==ea||this.height!==la)&&(this.pickingFBO.resize({width:Math.round(ea/this.pickBufferScale),height:Math.round(la/this.pickBufferScale)}),this.width=ea,this.height=la),or(this.pickingFBO,function(){var Ti=ft.layerService.getLayers();Ti.filter(function(Qa){return Qa.needPick(Ce.type)}).reverse().some(function(Qa){Dr({framebuffer:ft.pickingFBO,color:[0,0,0,0],stencil:0,depth:1}),Qa.hooks.beforePickingEncode.call(),Qa.renderModels(),Qa.hooks.afterPickingEncode.call();var Vi=ft.pickFromPickingFBO(Qa,Ce);return Vi&&!Qa.getLayerConfig().enablePropagation})});case 6:case"end":return ja.stop()}},G,this)}));function N(G){return se.apply(this,arguments)}return N}()},{key:"triggerHoverOnLayer",value:function(N,G){N.emit(G.type,G)}},{key:"highlightPickedFeature",value:function(N,G){var Ce=Et()(G,3),ft=Ce[0],Yt=Ce[1],sr=Ce[2];N.hooks.beforeHighlight.call([ft,Yt,sr])}},{key:"selectFeature",value:function(N,G){var Ce=Et()(G,3),ft=Ce[0],Yt=Ce[1],sr=Ce[2];N.hooks.beforeSelect.call([ft,Yt,sr])}}]),ne}(),_o),pc=Mn()(Ts.prototype,"rendererService",[po],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xu=Mn()(Ts.prototype,"configService",[mo],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Po=Mn()(Ts.prototype,"interactionService",[Mo],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ku=Mn()(Ts.prototype,"layerService",[Nu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ts))||Ol),Fs=function(){function ne(){var se=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;Y()(this,ne),this.autoStart=void 0,this.startTime=0,this.oldTime=0,this.running=!1,this.elapsedTime=0,this.autoStart=se}return Xe()(ne,[{key:"start",value:function(){this.startTime=(typeof performance=="undefined"?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}},{key:"stop",value:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}},{key:"getElapsedTime",value:function(){return this.getDelta(),this.elapsedTime}},{key:"getDelta",value:function(){var N=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var G=(typeof performance=="undefined"?Date:performance).now();N=(G-this.oldTime)/1e3,this.oldTime=G,this.elapsedTime+=N}return N}}]),ne}(),Ii,Gi,_s,ml,$u,It,fr,Pr,Wn=(Ii=Object(F.injectable)(),Gi=Object(F.inject)(D.a.IRendererService),_s=Object(F.inject)(D.a.IGlobalConfigService),Ii(ml=($u=(Pr=function(){function ne(){Y()(this,ne),this.clock=new Fs,this.alreadyInRendering=!1,this.layers=[],this.layerRenderID=void 0,this.sceneInited=!1,this.animateInstanceCount=0,bn()(this,"renderService",It,this),bn()(this,"configService",fr,this)}return Xe()(ne,[{key:"add",value:function(N){this.sceneInited&&N.init(),this.layers.push(N)}},{key:"initLayers",value:function(){this.sceneInited=!0,this.layers.forEach(function(N){N.inited||N.init()})}},{key:"getLayers",value:function(){return this.layers}},{key:"getLayer",value:function(N){return this.layers.find(function(G){return G.id===N})}},{key:"getLayerByName",value:function(N){return this.layers.find(function(G){return G.name===N})}},{key:"remove",value:function(N){var G=this.layers.indexOf(N);G>-1&&this.layers.splice(G,1),N.emit("remove",null),N.destroy(),this.renderLayers()}},{key:"removeAllLayers",value:function(){this.destroy()}},{key:"renderLayers",value:function(){if(this.alreadyInRendering)return;this.alreadyInRendering=!0,this.clear(),this.updateRenderOrder(),this.layers.filter(function(N){return N.inited}).filter(function(N){return N.isVisible()}).forEach(function(N){N.hooks.beforeRenderData.call(),N.hooks.beforeRender.call(),N.render(),N.hooks.afterRender.call()}),this.alreadyInRendering=!1}},{key:"updateRenderOrder",value:function(){this.layers.sort(function(N,G){return N.zIndex-G.zIndex})}},{key:"destroy",value:function(){this.layers.forEach(function(N){return N.destroy()}),this.layers=[],this.renderLayers()}},{key:"startAnimate",value:function(){this.animateInstanceCount++===0&&(this.clock.start(),this.runRender())}},{key:"stopAnimate",value:function(){--this.animateInstanceCount===0&&(this.stopRender(),this.clock.stop())}},{key:"clear",value:function(){this.renderService.clear({color:[0,0,0,0],depth:1,stencil:0,framebuffer:null})}},{key:"runRender",value:function(){this.renderLayers(),this.layerRenderID=requestAnimationFrame(this.runRender.bind(this))}},{key:"stopRender",value:function(){cancelAnimationFrame(this.layerRenderID)}}]),ne}(),Pr),It=Mn()($u.prototype,"renderService",[Gi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fr=Mn()($u.prototype,"configService",[_s],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$u))||ml),Ya=o("QILm"),xi=o.n(Ya),Ki=o("RIqP"),Ka=o.n(Ki),Di=o("J2iB"),Yo=o.n(Di),Ps=function(){function ne(se){var N=this;Y()(this,ne),this.name=void 0,this.type=void 0,this.scale=void 0,this.descriptor=void 0,this.featureBufferLayout=[],this.needRescale=!1,this.needRemapping=!1,this.needRegenerateVertices=!1,this.featureRange={startIndex:0,endIndex:Infinity},this.vertexAttribute=void 0,this.defaultCallback=function(G){if(G.length===0){var Ce;return((Ce=N.scale)===null||Ce===void 0?void 0:Ce.defaultValues)||[]}return G.map(function(ft,Yt){var sr,or=(sr=N.scale)===null||sr===void 0?void 0:sr.scalers[Yt].func,Dr=or(ft);return Dr})},this.setProps(se)}return Xe()(ne,[{key:"setProps",value:function(N){Object.assign(this,N)}},{key:"mapping",value:function(N){var G;if((G=this.scale)===null||G===void 0?void 0:G.callback){var Ce,ft=(Ce=this.scale)===null||Ce===void 0?void 0:Ce.callback.apply(Ce,Ka()(N));if(!Yo()(ft))return[ft]}return this.defaultCallback(N)}},{key:"resetDescriptor",value:function(){this.descriptor&&(this.descriptor.buffer.data=[])}}]),ne}(),gi,Ml,$s,Ss,vl,cu,Eu;function fu(ne,se){var N=Object.keys(ne);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(ne);se&&(G=G.filter(function(Ce){return Object.getOwnPropertyDescriptor(ne,Ce).enumerable})),N.push.apply(N,G)}return N}function ju(ne){for(var se=1;se<arguments.length;se++){var N=arguments[se]!=null?arguments[se]:{};se%2?fu(Object(N),!0).forEach(function(G){ee()(ne,G,N[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(N)):fu(Object(N)).forEach(function(G){Object.defineProperty(ne,G,Object.getOwnPropertyDescriptor(N,G))})}return ne}function Js(ne){return new Promise(function(se){return setTimeout(se,ne)})}var Mc=(gi={},ee()(gi,Gn.a.FLOAT,4),ee()(gi,Gn.a.UNSIGNED_BYTE,1),ee()(gi,Gn.a.UNSIGNED_SHORT,2),gi),hf=(Ml=Object(F.injectable)(),$s=Object(F.inject)(D.a.IRendererService),Ml(Ss=(vl=(Eu=function(){function ne(){Y()(this,ne),this.attributesAndIndices=void 0,bn()(this,"rendererService",cu,this),this.attributes=[],this.triangulation=void 0,this.featureLayout={sizePerElement:0,elements:[]}}return Xe()(ne,[{key:"registerStyleAttribute",value:function(N){var G=this.getLayerStyleAttribute(N.name||"");return G?G.setProps(N):(G=new Ps(N),this.attributes.push(G)),G}},{key:"updateStyleAttribute",value:function(N,G,Ce){var ft=this.getLayerStyleAttribute(N);ft||(ft=this.registerStyleAttribute(ju(ju({},G),{},{name:N})));var Yt=G.scale;Yt&&ft&&(ft.scale=Yt,ft.needRescale=!0,ft.needRemapping=!0,ft.needRegenerateVertices=!0,Ce&&Ce.featureRange&&(ft.featureRange=Ce.featureRange))}},{key:"getLayerStyleAttributes",value:function(){return this.attributes}},{key:"getLayerStyleAttribute",value:function(N){return this.attributes.find(function(G){return G.name===N})}},{key:"getLayerAttributeScale",value:function(N){var G,Ce=this.getLayerStyleAttribute(N),ft=Ce==null||((G=Ce.scale)===null||G===void 0)?void 0:G.scalers;return ft&&ft[0]?ft[0].func:null}},{key:"updateAttributeByFeatureRange",value:function(N,G){var Ce=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,ft=arguments.length>3?arguments[3]:void 0,Yt=this.attributes.find(function(yo){return yo.name===N});if(Yt&&Yt.descriptor){var sr=Yt.descriptor,or=sr.update,Dr=sr.buffer,sn=sr.size,Hn=sn===void 0?0:sn,ea=Mc[Dr.type||Gn.a.FLOAT];if(or){var la=this.featureLayout,ti=la.elements,ja=la.sizePerElement,Ti=ti.slice(Ce,ft);if(!Ti.length)return;var Qa=Ti[0].offset,Vi=Qa*Hn*ea,Co=Ti.map(function(yo,Zi){for(var jo=yo.featureIdx,qa=yo.vertices,lo=yo.normals,iu=qa.length/ja,_i=[],ki=0;ki<iu;ki++){var Ea=lo?lo.slice(ki*3,ki*3+3):[];_i.push.apply(_i,Ka()(or(G[jo],jo,qa.slice(ki*ja,ki*ja+ja),Zi,Ea)))}return _i}).reduce(function(yo,Zi){return yo.push.apply(yo,Ka()(Zi)),yo},[]);Yt.vertexAttribute.updateBuffer({data:Co,offset:Vi})}}}},{key:"createAttributesAndIndices",value:function(N,G){var Ce=this;this.featureLayout={sizePerElement:0,elements:[]},G&&(this.triangulation=G);var ft=this.attributes.map(function(Qa){return Qa.resetDescriptor(),Qa.descriptor}),Yt=0,sr=[],or=[],Dr=[],sn=3;N.forEach(function(Qa,Vi){var Co=Ce.triangulation(Qa),yo=Co.indices,Zi=Co.vertices,jo=Co.normals,qa=Co.size;yo.forEach(function(ki){or.push(ki+Yt)}),sn=qa;var lo=Zi.length/qa;Ce.featureLayout.sizePerElement=sn,Ce.featureLayout.elements.push({featureIdx:Vi,vertices:Zi,normals:jo,offset:Yt}),Yt+=lo;for(var iu=function(Ea){var wo=(jo==null?void 0:jo.slice(Ea*3,Ea*3+3))||[],cc=Zi.slice(Ea*qa,Ea*qa+qa);ft.forEach(function(Nf,oh){if(Nf&&Nf.update){var kf;(kf=Nf.buffer.data).push.apply(kf,Ka()(Nf.update(Qa,Vi,cc,Ea,wo)))}})},_i=0;_i<lo;_i++)iu(_i)});var Hn=this.rendererService,ea=Hn.createAttribute,la=Hn.createBuffer,ti=Hn.createElements,ja={};ft.forEach(function(Qa,Vi){if(Qa){var Co=Qa.buffer,yo=Qa.update,Zi=Qa.name,jo=xi()(Qa,["buffer","update","name"]),qa=ea(ju({buffer:la(Co)},jo));ja[Qa.name||""]=qa,Ce.attributes[Vi].vertexAttribute=qa}});var Ti=ti({data:or,type:Gn.a.UNSIGNED_INT,count:or.length});return this.attributesAndIndices={attributes:ja,elements:Ti},this.attributesAndIndices}},{key:"clearAllAttributes",value:function(){var N;this.attributes.forEach(function(G){G.vertexAttribute&&G.vertexAttribute.destroy()}),(N=this.attributesAndIndices)===null||N===void 0||N.elements.destroy(),this.attributes=[]}}]),ne}(),Eu),cu=Mn()(vl.prototype,"rendererService",[$s],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vl))||Ss),pi=o("U8pU"),Pc=o("KQm4"),mc=o("rePB"),$c=o("1OyB"),gl=o("vuIU"),Jc=o("5ku3"),$i=typeof __VERSION__!="undefined"?__VERSION__:"untranspiled source",Tu=Object(Jc.a)();function yl(ne){try{var se=window[ne],N="__storage_test__";return se.setItem(N,N),se.removeItem(N),se}catch(G){return null}}var os=function(){function ne(se,N){var G=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";Object($c.a)(this,ne),this.storage=yl(G),this.id=se,this.config={},Object.assign(this.config,N),this._loadConfiguration()}return Object(gl.a)(ne,[{key:"getConfiguration",value:function(){return this.config}},{key:"setConfiguration",value:function(N){return this.config={},this.updateConfiguration(N)}},{key:"updateConfiguration",value:function(N){if(Object.assign(this.config,N),this.storage){var G=JSON.stringify(this.config);this.storage.setItem(this.id,G)}return this}},{key:"_loadConfiguration",value:function(){var N={};if(this.storage){var G=this.storage.getItem(this.id);N=G?JSON.parse(G):{}}return Object.assign(this.config,N),this}}]),ne}();function Lc(ne){var se;return ne<10?se="".concat(ne.toFixed(2),"ms"):ne<100?se="".concat(ne.toFixed(1),"ms"):ne<1e3?se="".concat(ne.toFixed(0),"ms"):se="".concat((ne/1e3).toFixed(2),"s"),se}function vc(ne){var se=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8,N=Math.max(se-ne.length,0);return"".concat(" ".repeat(N)).concat(ne)}function Pl(ne){var se=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8,N=Math.max(se-ne.length,0);return"".concat(ne).concat(" ".repeat(N))}function Ju(ne){var se=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},N=1e-16,G=se.isInteger,Ce=G===void 0?!1:G;if(Array.isArray(ne)||ArrayBuffer.isView(ne))return Rc(ne,se);if(!Number.isFinite(ne))return String(ne);if(Math.abs(ne)<N)return Ce?"0":"0.";if(Ce)return ne.toFixed(0);if(Math.abs(ne)>100&&Math.abs(ne)<1e4)return ne.toFixed(0);var ft=ne.toPrecision(2),Yt=ft.indexOf(".0");return Yt===ft.length-2?ft.slice(0,-1):ft}function Rc(ne,se){for(var N=se.maxElts,G=N===void 0?16:N,Ce=se.size,ft=Ce===void 0?1:Ce,Yt="[",sr=0;sr<ne.length&&sr<G;++sr)sr>0&&(Yt+=",".concat(sr%ft===0?" ":"")),Yt+=Ju(ne[sr],se);var or=ne.length>G?"...":"]";return"".concat(Yt).concat(or)}function hu(ne,se,N){var G=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600,Ce=ne.src.replace(/\(/g,"%28").replace(/\)/g,"%29");ne.width>G&&(N=Math.min(N,G/ne.width));var ft=ne.width*N,Yt=ne.height*N,sr=["font-size:1px;","padding:".concat(Math.floor(Yt/2),"px ").concat(Math.floor(ft/2),"px;"),"line-height:".concat(Yt,"px;"),"background:url(".concat(Ce,");"),"background-size:".concat(ft,"px ").concat(Yt,"px;"),"color:transparent;"].join("");return["".concat(se," %c+"),sr]}var _u={BLACK:30,RED:31,GREEN:32,YELLOW:33,BLUE:34,MAGENTA:35,CYAN:36,WHITE:37,BRIGHT_BLACK:90,BRIGHT_RED:91,BRIGHT_GREEN:92,BRIGHT_YELLOW:93,BRIGHT_BLUE:94,BRIGHT_MAGENTA:95,BRIGHT_CYAN:96,BRIGHT_WHITE:97};function Qc(ne){return typeof ne=="string"?_u[ne.toUpperCase()]||_u.WHITE:ne}function Yl(ne,se,N){return!Tu&&typeof ne=="string"&&(se&&(se=Qc(se),ne="[".concat(se,"m").concat(ne,"[39m")),N&&(se=Qc(N),ne="[".concat(N+10,"m").concat(ne,"[49m"))),ne}function Si(ne){if(typeof Symbol=="undefined"||ne[Symbol.iterator]==null){if(Array.isArray(ne)||(ne=qc(ne))){var se=0,N=function(){};return{s:N,n:function(){return se>=ne.length?{done:!0}:{done:!1,value:ne[se++]}},e:function(or){throw or},f:N}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var G,Ce=!0,ft=!1,Yt;return{s:function(){G=ne[Symbol.iterator]()},n:function(){var or=G.next();return Ce=or.done,or},e:function(or){ft=!0,Yt=or},f:function(){try{!Ce&&G.return!=null&&G.return()}finally{if(ft)throw Yt}}}}function qc(ne,se){if(!ne)return;if(typeof ne=="string")return df(ne,se);var N=Object.prototype.toString.call(ne).slice(8,-1);if(N==="Object"&&ne.constructor&&(N=ne.constructor.name),N==="Map"||N==="Set")return Array.from(N);if(N==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(N))return df(ne,se)}function df(ne,se){(se==null||se>ne.length)&&(se=ne.length);for(var N=0,G=new Array(se);N<se;N++)G[N]=ne[N];return G}function Kl(ne){var se=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"],N=Object.getPrototypeOf(ne),G=Object.getOwnPropertyNames(N),Ce=Si(G),ft;try{var Yt=function(){var or=ft.value;typeof ne[or]=="function"&&(se.find(function(Dr){return or===Dr})||(ne[or]=ne[or].bind(ne)))};for(Ce.s();!(ft=Ce.n()).done;)Yt()}catch(sr){Ce.e(sr)}finally{Ce.f()}}function Ic(ne,se){if(!ne)throw new Error(se||"Assertion failed")}var $l=o("K9nA");function Qu(){var ne;if(Tu&&$l.b.performance)ne=$l.b.performance.now();else if($l.a.hrtime){var se=$l.a.hrtime();ne=se[0]*1e3+se[1]/1e6}else ne=Date.now();return ne}var Fu={debug:Tu&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},bl={enabled:!0,level:0};function Lo(){}var Jl={},Ll={once:!0};function Rl(ne){for(var se in ne)for(var N in ne[se])return N||"untitled";return"empty"}var Dc=function(){function ne(){var se=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},N=se.id;Object($c.a)(this,ne),this.id=N,this.VERSION=$i,this._startTs=Qu(),this._deltaTs=Qu(),this.LOG_THROTTLE_TIMEOUT=0,this._storage=new os("__probe-".concat(this.id,"__"),bl),this.userData={},this.timeStamp("".concat(this.id," started")),Kl(this),Object.seal(this)}return Object(gl.a)(ne,[{key:"isEnabled",value:function(){return this._storage.config.enabled}},{key:"getLevel",value:function(){return this._storage.config.level}},{key:"getTotal",value:function(){return Number((Qu()-this._startTs).toPrecision(10))}},{key:"getDelta",value:function(){return Number((Qu()-this._deltaTs).toPrecision(10))}},{key:"getPriority",value:function(){return this.level}},{key:"enable",value:function(){var N=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.updateConfiguration({enabled:N}),this}},{key:"setLevel",value:function(N){return this._storage.updateConfiguration({level:N}),this}},{key:"assert",value:function(N,G){Ic(N,G)}},{key:"warn",value:function(N){return this._getLogFunction(0,N,Fu.warn,arguments,Ll)}},{key:"error",value:function(N){return this._getLogFunction(0,N,Fu.error,arguments)}},{key:"deprecated",value:function(N,G){return this.warn("`".concat(N,"` is deprecated and will be removed in a later version. Use `").concat(G,"` instead"))}},{key:"removed",value:function(N,G){return this.error("`".concat(N,"` has been removed. Use `").concat(G,"` instead"))}},{key:"probe",value:function(N,G){return this._getLogFunction(N,G,Fu.log,arguments,{time:!0,once:!0})}},{key:"log",value:function(N,G){return this._getLogFunction(N,G,Fu.debug,arguments)}},{key:"info",value:function(N,G){return this._getLogFunction(N,G,console.info,arguments)}},{key:"once",value:function(N,G){return this._getLogFunction(N,G,Fu.debug||Fu.info,arguments,Ll)}},{key:"table",value:function(N,G,Ce){return G?this._getLogFunction(N,G,console.table||Lo,Ce&&[Ce],{tag:Rl(G)}):Lo}},{key:"image",value:function(N){var G=N.logLevel,Ce=N.priority,ft=N.image,Yt=N.message,sr=Yt===void 0?"":Yt,or=N.scale,Dr=or===void 0?1:or;return this._shouldLog(G||Ce)?Tu?mf({image:ft,message:sr,scale:Dr}):pf({image:ft,message:sr,scale:Dr}):Lo}},{key:"settings",value:function(){console.table?console.table(this._storage.config):console.log(this._storage.config)}},{key:"get",value:function(N){return this._storage.config[N]}},{key:"set",value:function(N,G){this._storage.updateConfiguration(Object(mc.a)({},N,G))}},{key:"time",value:function(N,G){return this._getLogFunction(N,G,console.time?console.time:console.info)}},{key:"timeEnd",value:function(N,G){return this._getLogFunction(N,G,console.timeEnd?console.timeEnd:console.info)}},{key:"timeStamp",value:function(N,G){return this._getLogFunction(N,G,console.timeStamp||Lo)}},{key:"group",value:function(N,G){var Ce=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};Ce=Qs({logLevel:N,message:G,opts:Ce});var ft=Ce,Yt=ft.collapsed;return Ce.method=(Yt?console.groupCollapsed:console.group)||console.info,this._getLogFunction(Ce)}},{key:"groupCollapsed",value:function(N,G){var Ce=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(N,G,Object.assign({},Ce,{collapsed:!0}))}},{key:"groupEnd",value:function(N){return this._getLogFunction(N,"",console.groupEnd||Lo)}},{key:"withGroup",value:function(N,G,Ce){this.group(N,G)();try{Ce()}finally{this.groupEnd(N)()}}},{key:"trace",value:function(){console.trace&&console.trace()}},{key:"_shouldLog",value:function(N){return this.isEnabled()&&this.getLevel()>=xl(N)}},{key:"_getLogFunction",value:function(N,G,Ce){var ft=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[],Yt=arguments.length>4?arguments[4]:void 0;if(this._shouldLog(N)){var sr;Yt=Qs({logLevel:N,message:G,args:ft,opts:Yt}),Ce=Ce||Yt.method,Ic(Ce),Yt.total=this.getTotal(),Yt.delta=this.getDelta(),this._deltaTs=Qu();var or=Yt.tag||Yt.message;if(Yt.once)if(!Jl[or])Jl[or]=Qu();else return Lo;return G=eo(this.id,Yt.message,Yt),(sr=Ce).bind.apply(sr,[console,G].concat(Object(Pc.a)(Yt.args)))}return Lo}},{key:"level",set:function(N){this.setLevel(N)},get:function(){return this.getLevel()}},{key:"priority",set:function(N){this.level=N},get:function(){return this.level}}]),ne}();Dc.VERSION=$i;function xl(ne){if(!ne)return 0;var se;switch(Object(pi.a)(ne)){case"number":se=ne;break;case"object":se=ne.logLevel||ne.priority||0;break;default:return 0}return Ic(Number.isFinite(se)&&se>=0),se}function Qs(ne){var se=ne.logLevel,N=ne.message;ne.logLevel=xl(se);for(var G=ne.args?Array.from(ne.args):[];G.length&&G.shift()!==N;);ne.args=G;switch(Object(pi.a)(se)){case"string":case"function":N!==void 0&&G.unshift(N),ne.message=se;break;case"object":Object.assign(ne,se);break;default:}typeof ne.message=="function"&&(ne.message=ne.message());var Ce=Object(pi.a)(ne.message);return Ic(Ce==="string"||Ce==="object"),Object.assign(ne,ne.opts)}function eo(ne,se,N){if(typeof se=="string"){var G=N.time?vc(Lc(N.total)):"";se=N.time?"".concat(ne,": ").concat(G,"  ").concat(se):"".concat(ne,": ").concat(se),se=Yl(se,N.color,N.background)}return se}function pf(ne){var se=ne.image,N=ne.message,G=N===void 0?"":N,Ce=ne.scale,ft=Ce===void 0?1:Ce,Yt=null;try{Yt=o(2)}catch(sr){}return Yt?function(){return Yt(se,{fit:"box",width:"".concat(Math.round(80*ft),"%")}).then(function(sr){return console.log(sr)})}:Lo}function mf(ne){var se=ne.image,N=ne.message,G=N===void 0?"":N,Ce=ne.scale,ft=Ce===void 0?1:Ce;if(typeof se=="string"){var Yt=new Image;return Yt.onload=function(){var sn,Hn=hu(Yt,G,ft);(sn=console).log.apply(sn,Object(Pc.a)(Hn))},Yt.src=se,Lo}var sr=se.nodeName||"";if(sr.toLowerCase()==="img"){var or;return(or=console).log.apply(or,Object(Pc.a)(hu(se,G,ft))),Lo}if(sr.toLowerCase()==="canvas"){var Dr=new Image;return Dr.onload=function(){var sn;return(sn=console).log.apply(sn,Object(Pc.a)(hu(Dr,G,ft)))},Dr.src=se.toDataURL(),Lo}return Lo}var El,Ql,qu=new Dc({id:"L7"}).enable(!1);qu.priority=5;var Il=(El=Object(F.injectable)(),El(Ql=function(){function ne(){Y()(this,ne)}return Xe()(ne,[{key:"error",value:function(N){qu.error(N)()}},{key:"warn",value:function(N){qu.probe(1,N)()}},{key:"info",value:function(N){qu.info(3,N)()}},{key:"debug",value:function(N){qu.probe(4,N)()}}]),ne}())||Ql),gc=o("xp6e"),yc=o("iegG"),el=o.n(yc),ef=window.document.documentElement.style,tl=0;function qs(ne){var se=ne;if(typeof ne=="string"&&(se=document.getElementById(ne)),se){var N=document.createElement("div");return N.style.cssText+=`
      position: absolute;
      z-index:2;
      height: 100%;
      width: 100%;
      pointer-events: none;
    `,N.id="l7-scene-".concat(tl++),N.classList.add("l7-scene"),se.appendChild(N),N}return null}var Tl,ql,Nc,tf,zs,vf,rl,Pi,nl,zu,fi,kn,Li,Ls,Dl,Uu,al,gf,ss,_l,il,ol,Ui,As,Nl,to,Rn,Us,ni,kl,du,Bs,sl,tn,bc,us;function ro(ne){var se=qo();return function(){var G=ot()(ne),Ce;if(se){var ft=ot()(this).constructor;Ce=Reflect.construct(G,arguments,ft)}else Ce=G.apply(this,arguments);return et()(this,Ce)}}function qo(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var Rs=(Tl=Object(F.injectable)(),ql=Object(F.inject)(D.a.SceneID),Nc=Object(F.inject)(D.a.IIconService),tf=Object(F.inject)(D.a.IFontService),zs=Object(F.inject)(D.a.IControlService),vf=Object(F.inject)(D.a.ILogService),rl=Object(F.inject)(D.a.IGlobalConfigService),Pi=Object(F.inject)(D.a.IMapService),nl=Object(F.inject)(D.a.ICoordinateSystemService),zu=Object(F.inject)(D.a.IRendererService),fi=Object(F.inject)(D.a.ILayerService),kn=Object(F.inject)(D.a.ICameraService),Li=Object(F.inject)(D.a.IInteractionService),Ls=Object(F.inject)(D.a.IPickingService),Dl=Object(F.inject)(D.a.IShaderModuleService),Uu=Object(F.inject)(D.a.IMarkerService),al=Object(F.inject)(D.a.IPopupService),Tl(gf=(ss=(us=function(ne){fe()(N,ne);var se=ro(N);function N(){var G;return Y()(this,N),G=se.call(this),G.destroyed=!1,G.loaded=!1,bn()(G,"id",_l,Ha()(G)),bn()(G,"iconService",il,Ha()(G)),bn()(G,"fontService",ol,Ha()(G)),bn()(G,"controlService",Ui,Ha()(G)),bn()(G,"logger",As,Ha()(G)),bn()(G,"configService",Nl,Ha()(G)),bn()(G,"map",to,Ha()(G)),bn()(G,"coordinateSystemService",Rn,Ha()(G)),bn()(G,"rendererService",Us,Ha()(G)),bn()(G,"layerService",ni,Ha()(G)),bn()(G,"cameraService",kl,Ha()(G)),bn()(G,"interactionService",du,Ha()(G)),bn()(G,"pickingService",Bs,Ha()(G)),bn()(G,"shaderModuleService",sl,Ha()(G)),bn()(G,"markerService",tn,Ha()(G)),bn()(G,"popupService",bc,Ha()(G)),G.inited=!1,G.initPromise=void 0,G.rendering=!1,G.$container=void 0,G.canvas=void 0,G.markerContainer=void 0,G.hooks=void 0,G.handleWindowResized=function(){G.emit("resize"),G.$container&&(G.initContainer(),be.a.triggerResize(),G.coordinateSystemService.needRefresh=!0,G.render())},G.handleMapCameraChanged=function(Ce){G.cameraService.update(Ce),G.render()},G.hooks={init:new gc.a},G}return Xe()(N,[{key:"init",value:function(Ce){var ft=this;this.configService.setSceneConfig(this.id,Ce),this.shaderModuleService.registerBuiltinModules(),this.iconService.init(),this.fontService.init(),this.hooks.init.tapPromise("initMap",Tn()(vr.a.mark(function Yt(){return vr.a.wrap(function(or){for(;;)switch(or.prev=or.next){case 0:return or.next=2,new Promise(function(Dr){ft.map.onCameraChanged(function(sn){ft.cameraService.init(),ft.cameraService.update(sn),Dr()}),ft.map.init()});case 2:ft.map.onCameraChanged(ft.handleMapCameraChanged),ft.map.addMarkerContainer(),ft.markerService.addMarkers(),ft.markerService.addMarkerLayers(),ft.popupService.initPopup(),ft.interactionService.init(),ft.interactionService.on(ui.a.Drag,ft.addSceneEvent.bind(ft)),ft.logger.debug("map ".concat(ft.id," loaded"));case 10:case"end":return or.stop()}},Yt)}))),this.hooks.init.tapPromise("initRenderer",Tn()(vr.a.mark(function Yt(){var sr;return vr.a.wrap(function(Dr){for(;;)switch(Dr.prev=Dr.next){case 0:if(sr=qs(ft.configService.getSceneConfig(ft.id).id||""),ft.$container=sr,!sr){Dr.next=11;break}return ft.canvas=be.a.create("canvas","",sr),ft.setCanvas(),Dr.next=7,ft.rendererService.init(ft.canvas,ft.configService.getSceneConfig(ft.id));case 7:el()(ft.$container,ft.handleWindowResized),window.matchMedia("screen and (-webkit-min-device-pixel-ratio: 1.5)").addListener(ft.handleWindowResized),Dr.next=12;break;case 11:ft.logger.error("\u5BB9\u5668 id \u4E0D\u5B58\u5728");case 12:ft.pickingService.init(ft.id),ft.logger.debug("scene ".concat(ft.id," renderer loaded"));case 14:case"end":return Dr.stop()}},Yt)}))),this.initPromise=this.hooks.init.promise(),this.render()}},{key:"addLayer",value:function(Ce){this.logger.debug("add layer ".concat(Ce.name," to scene ").concat(this.id)),this.layerService.add(Ce),this.render()}},{key:"render",value:function(){var G=Tn()(vr.a.mark(function ft(){return vr.a.wrap(function(sr){for(;;)switch(sr.prev=sr.next){case 0:if(!(this.rendering||this.destroyed)){sr.next=2;break}return sr.abrupt("return");case 2:if(this.rendering=!0,this.inited){sr.next=13;break}return sr.next=6,this.initPromise;case 6:this.destroyed&&this.destroy(),this.logger.info(" render inited"),this.layerService.initLayers(),this.controlService.addControls(),this.loaded=!0,this.emit("loaded"),this.inited=!0;case 13:this.layerService.renderLayers(),this.logger.debug("scene ".concat(this.id," render")),this.rendering=!1;case 16:case"end":return sr.stop()}},ft,this)}));function Ce(){return G.apply(this,arguments)}return Ce}()},{key:"getSceneContainer",value:function(){return this.$container}},{key:"exportPng",value:function(Ce){var ft,Yt=(ft=this.$container)===null||ft===void 0?void 0:ft.getElementsByTagName("canvas")[0];this.render();var sr=Ce==="jpg"?Yt==null?void 0:Yt.toDataURL("image/jpeg"):Yt==null?void 0:Yt.toDataURL("image/png");return sr}},{key:"getSceneConfig",value:function(){return this.configService.getSceneConfig(this.id)}},{key:"addMarkerContainer",value:function(){var Ce=this.$container.parentElement;Ce!==null&&(this.markerContainer=be.a.create("div","l7-marker-container",Ce))}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"destroy",value:function(){if(!this.inited){this.destroyed=!0;return}this.emit("destroy"),this.layerService.destroy(),this.rendererService.destroy(),this.map.destroy(),this.interactionService.destroy(),this.controlService.destroy(),this.markerService.destroy(),this.removeAllListeners(),this.inited=!1,Object(yc.unbind)(this.$container,this.handleWindowResized),window.matchMedia("screen and (min-resolution: 2dppx)").removeListener(this.handleWindowResized)}},{key:"initContainer",value:function(){var Ce,ft,Yt=window.devicePixelRatio,sr=((Ce=this.$container)===null||Ce===void 0?void 0:Ce.clientWidth)||400,or=((ft=this.$container)===null||ft===void 0?void 0:ft.clientHeight)||300,Dr=this.canvas;Dr&&(Dr.width=sr*Yt,Dr.height=or*Yt,Dr.style.width="".concat(sr,"px"),Dr.style.height="".concat(or,"px")),this.rendererService.viewport({x:0,y:0,width:Yt*sr,height:Yt*or})}},{key:"setCanvas",value:function(){var Ce,ft,Yt=window.devicePixelRatio,sr=((Ce=this.$container)===null||Ce===void 0?void 0:Ce.clientWidth)||400,or=((ft=this.$container)===null||ft===void 0?void 0:ft.clientHeight)||300,Dr=this.canvas;Dr.width=sr*Yt,Dr.height=or*Yt,Dr.style.width="".concat(sr,"px"),Dr.style.height="".concat(or,"px")}},{key:"addSceneEvent",value:function(Ce){this.emit(Ce.type,Ce)}}]),N}(p.EventEmitter),us),_l=Mn()(ss.prototype,"id",[ql],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),il=Mn()(ss.prototype,"iconService",[Nc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ol=Mn()(ss.prototype,"fontService",[tf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ui=Mn()(ss.prototype,"controlService",[zs],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),As=Mn()(ss.prototype,"logger",[vf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Nl=Mn()(ss.prototype,"configService",[rl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),to=Mn()(ss.prototype,"map",[Pi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Rn=Mn()(ss.prototype,"coordinateSystemService",[nl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Us=Mn()(ss.prototype,"rendererService",[zu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ni=Mn()(ss.prototype,"layerService",[fi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kl=Mn()(ss.prototype,"cameraService",[kn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),du=Mn()(ss.prototype,"interactionService",[Li],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Bs=Mn()(ss.prototype,"pickingService",[Ls],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sl=Mn()(ss.prototype,"shaderModuleService",[Dl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tn=Mn()(ss.prototype,"markerService",[Uu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bc=Mn()(ss.prototype,"popupService",[al],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ss))||gf),jl=o("7tbW"),kc=o.n(jl);function Vs(ne){var se=0;switch(ne){case"vec2":case"ivec2":se=2;break;case"vec3":case"ivec3":se=3;break;case"vec4":case"ivec4":case"mat2":se=4;break;case"mat3":se=9;break;case"mat4":se=16;break;default:}return se}var Su=/uniform\s+(bool|float|int|vec2|vec3|vec4|ivec2|ivec3|ivec4|mat2|mat3|mat4|sampler2D|samplerCube)\s+([\s\S]*?);/g;function Fl(ne){var se={};return ne=ne.replace(Su,function(N,G,Ce){var ft=Ce.split(":"),Yt=ft[0].trim(),sr="";ft.length>1&&(sr=ft[1].trim());switch(G){case"bool":sr=sr==="true";break;case"float":case"int":sr=Number(sr);break;case"vec2":case"vec3":case"vec4":case"ivec2":case"ivec3":case"ivec4":case"mat2":case"mat3":case"mat4":sr?sr=sr.replace("[","").replace("]","").split(",").reduce(function(or,Dr){return or.push(Number(Dr.trim())),or},[]):sr=new Array(Vs(G)).fill(0);break;default:}return se[Yt]=sr,"uniform ".concat(G," ").concat(Yt,`;
`)}),{content:ne,uniforms:se}}var zl,rf,jc;function Ro(ne,se){var N=Object.keys(ne);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(ne);se&&(G=G.filter(function(Ce){return Object.getOwnPropertyDescriptor(ne,Ce).enumerable})),N.push.apply(N,G)}return N}function ls(ne){for(var se=1;se<arguments.length;se++){var N=arguments[se]!=null?arguments[se]:{};se%2?Ro(Object(N),!0).forEach(function(G){ee()(ne,G,N[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(N)):Ro(Object(N)).forEach(function(G){Object.defineProperty(ne,G,Object.getOwnPropertyDescriptor(N,G))})}return ne}var Pa="#define PI 3.14159265359",eu=`#define SHIFT_RIGHT17 1.0 / 131072.0
#define SHIFT_RIGHT18 1.0 / 262144.0
#define SHIFT_RIGHT19 1.0 / 524288.0
#define SHIFT_RIGHT20 1.0 / 1048576.0
#define SHIFT_RIGHT21 1.0 / 2097152.0
#define SHIFT_RIGHT22 1.0 / 4194304.0
#define SHIFT_RIGHT23 1.0 / 8388608.0
#define SHIFT_RIGHT24 1.0 / 16777216.0

#define SHIFT_LEFT17 131072.0
#define SHIFT_LEFT18 262144.0
#define SHIFT_LEFT19 524288.0
#define SHIFT_LEFT20 1048576.0
#define SHIFT_LEFT21 2097152.0
#define SHIFT_LEFT22 4194304.0
#define SHIFT_LEFT23 8388608.0
#define SHIFT_LEFT24 16777216.0

vec2 unpack_float(float packedValue) {
  int packedIntValue = int(packedValue);
  int v0 = packedIntValue / 256;
  return vec2(v0, packedIntValue - v0 * 256);
}

vec4 decode_color(vec2 encodedColor) {
  return vec4(
    unpack_float(encodedColor[0]) / 255.0,
    unpack_float(encodedColor[1]) / 255.0
  );
}
`,Io=`#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2


float calc_lighting(vec4 pos) {

    vec3 worldPos = vec3(pos * u_ModelMatrix);

    vec3 worldNormal = a_Normal;
      // //cal light weight
    vec3 viewDir = normalize(u_CameraPosition - worldPos);

    vec3 lightDir = normalize(vec3(1, -10.5, 12));

    vec3 halfDir = normalize(viewDir+lightDir);
      // //lambert
    float lambert = dot(worldNormal, lightDir);
        //specular
    float specular = pow(max(0.0, dot(worldNormal, halfDir)), 32.0);
        //sum to light weight
    float lightWeight = ambientRatio + diffuseRatio * lambert + specularRatio * specular;

    return lightWeight;
}
`,So=`// Blinn-Phong model
// apply lighting in vertex shader instead of fragment shader
// @see https://learnopengl.com/Advanced-Lighting/Advanced-Lighting
uniform float u_Ambient : 1.0;
uniform float u_Diffuse : 1.0;
uniform float u_Specular : 1.0;
uniform int u_NumOfDirectionalLights : 1;
uniform int u_NumOfSpotLights : 0;

#define SHININESS 32.0
#define MAX_NUM_OF_DIRECTIONAL_LIGHTS 3
#define MAX_NUM_OF_SPOT_LIGHTS 3

struct DirectionalLight {
  vec3 direction;
  vec3 ambient;
  vec3 diffuse;
  vec3 specular;
};

struct SpotLight {
  vec3 position;
  vec3 direction;
  vec3 ambient;
  vec3 diffuse;
  vec3 specular;
  float constant;
  float linear;
  float quadratic;
  float angle;
  float blur;
  float exponent;
};

uniform DirectionalLight u_DirectionalLights[MAX_NUM_OF_DIRECTIONAL_LIGHTS];
uniform SpotLight u_SpotLights[MAX_NUM_OF_SPOT_LIGHTS];

vec3 calc_directional_light(DirectionalLight light, vec3 normal, vec3 viewDir) {
  vec3 lightDir = normalize(light.direction);
  // diffuse shading
  float diff = max(dot(normal, lightDir), 0.0);
  // Blinn-Phong specular shading
  vec3 halfwayDir = normalize(lightDir + viewDir);
  float spec = pow(max(dot(normal, halfwayDir), 0.0), SHININESS);

  vec3 ambient = light.ambient * u_Ambient;
  vec3 diffuse = light.diffuse * diff * u_Diffuse;
  vec3 specular = light.specular * spec * u_Specular;

  return ambient + diffuse + specular;
}

// vec3 calc_spot_light(SpotLight light, vec3 normal, vec3 fragPos, vec3 viewDir) {
//   vec3 lightDir = normalize(light.position - fragPos);
//   // diffuse shading
//   float diff = max(dot(normal, lightDir), 0.0);
//   // specular shading
//   vec3 reflectDir = reflect(-lightDir, normal);
//   float spec = pow(max(dot(viewDir, reflectDir), 0.0), SHININESS);
//   // attenuation
//   float distance = length(light.position - fragPos);
//   float attenuation = 1.0 / (light.constant + light.linear * distance +
//           light.quadratic * (distance * distance));

//   vec3 ambient = light.ambient * u_Ambient;
//   vec3 diffuse = light.diffuse * diff * u_Diffuse;
//   vec3 specular = light.specular * spec * u_Specular;

//   float spotEffect = dot(normalize(light.direction), -lightDir);
//   float spotCosCutoff = cos(light.angle / 180.0 * PI);
//   float spotCosOuterCutoff = cos((light.angle + light.blur) / 180.0 * PI);
//   float spotCosInnerCutoff = cos((light.angle - light.blur) / 180.0 * PI);
//   if (spotEffect > spotCosCutoff) {
//     spotEffect = pow(smoothstep(spotCosOuterCutoff, spotCosInnerCutoff, spotEffect), light.exponent);
//   } else {
//     spotEffect = 0.0;
//   }

//   return ambient + attenuation * (spotEffect * diffuse + specular);
// }

vec3 calc_lighting(vec3 position, vec3 normal, vec3 viewDir) {
  vec3 weight = vec3(0.0);
  for (int i = 0; i < MAX_NUM_OF_DIRECTIONAL_LIGHTS; i++) {
    if (i >= u_NumOfDirectionalLights) {
      break;
    }
    weight += calc_directional_light(u_DirectionalLights[i], normal, viewDir);
  }
  // for (int i = 0; i < MAX_NUM_OF_SPOT_LIGHTS; i++) {
  //   if (i >= u_NumOfSpotLights) {
  //     break;
  //   }
  //   weight += calc_spot_light(u_SpotLights[i], normal, position, viewDir);
  // }
  return weight;
}
`,Sl=`varying vec4 v_PickingResult;
uniform vec4 u_HighlightColor : [0, 0, 0, 0];
uniform float u_PickingStage : 0.0;

#define PICKING_NONE 0.0
#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

/*
 * Returns highlight color if this item is selected.
 */
vec4 filterHighlightColor(vec4 color) {
  bool selected = bool(v_PickingResult.a);

  if (selected) {
    vec4 highLightColor = u_HighlightColor * COLOR_SCALE;

    float highLightAlpha = highLightColor.a;
    float highLightRatio = highLightAlpha / (highLightAlpha + color.a * (1.0 - highLightAlpha));

    vec3 resultRGB = mix(color.rgb, highLightColor.rgb, highLightRatio);
    return vec4(resultRGB, color.a);
  } else {
    return color;
  }
}

/*
 * Returns picking color if picking enabled else unmodified argument.
 */
vec4 filterPickingColor(vec4 color) {
  vec3 pickingColor = v_PickingResult.rgb;
  if (u_PickingStage == PICKING_ENCODE && length(pickingColor) < 0.001) {
    discard;
  }
  return u_PickingStage == PICKING_ENCODE ? vec4(pickingColor, step(0.001,color.a)): color;
}

/*
 * Returns picking color if picking is enabled if not
 * highlight color if this item is selected, otherwise unmodified argument.
 */
vec4 filterColor(vec4 color) {
  return filterPickingColor(filterHighlightColor(color));
}
`,ul=`attribute vec3 a_PickingColor;
varying vec4 v_PickingResult;

uniform vec3 u_PickingColor : [0, 0, 0];
uniform vec4 u_HighlightColor : [0, 0, 0, 0];
uniform float u_PickingStage : 0.0;
uniform float u_PickingThreshold : 1.0;
uniform float u_PickingBuffer: 0.0;

#define PICKING_NONE 0.0
#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

bool isVertexPicked(vec3 vertexColor) {
  return
    abs(vertexColor.r - u_PickingColor.r) < u_PickingThreshold &&
    abs(vertexColor.g - u_PickingColor.g) < u_PickingThreshold &&
    abs(vertexColor.b - u_PickingColor.b) < u_PickingThreshold;
}

void setPickingColor(vec3 pickingColor) {
  // compares only in highlight stage
  v_PickingResult.a = float((u_PickingStage == PICKING_HIGHLIGHT) && isVertexPicked(pickingColor));

  // Stores the picking color so that the fragment shader can render it during picking
  v_PickingResult.rgb = pickingColor * COLOR_SCALE;
}

float setPickingSize(float x) {
   return u_PickingStage == PICKING_ENCODE ? x + u_PickingBuffer : x;
}
`,pu=`
#define E 2.718281828459045
vec2 ProjectFlat(vec2 lnglat){
  float maxs=85.0511287798;
  float lat=max(min(maxs,lnglat.y),-maxs);
  float scale= 268435456.;
  float d=PI/180.;
  float x=lnglat.x*d;
  float y=lat*d;
  y=log(tan((PI/4.)+(y/2.)));

  float a=.5/PI,
  b=.5,
  c=-.5/PI;
  d=.5;
  x=scale*(a*x+b);
  y=scale*(c*y+d);
  return vec2(x,y);
}

vec2 unProjectFlat(vec2 px){
  float a=.5/PI;
  float b=.5;
  float c=-.5/PI;
  float d=.5;
  float scale = 268435456.;
  float x=(px.x/scale-b)/a;
  float y=(px.y/scale-d)/c;
  y=(atan(pow(E,y))-(PI/4.))*2.;
  d=PI/180.;
  float lat=y/d;
  float lng=x/d;
  return vec2(lng,lat);
}

float pixelDistance(vec2 from, vec2 to) {
 vec2 a1 = ProjectFlat(from);
 vec2 b1 = ProjectFlat(to);
 return distance(a1, b1);
}
`,Cs=`#define TILE_SIZE 512.0
#define PI 3.1415926536
#define WORLD_SCALE TILE_SIZE / (PI * 2.0)

#define COORDINATE_SYSTEM_LNGLAT 1.0
#define COORDINATE_SYSTEM_LNGLAT_OFFSET 2.0
#define COORDINATE_SYSTEM_VECTOR_TILE 3.0
#define COORDINATE_SYSTEM_IDENTITY 4.0
#define COORDINATE_SYSTEM_P20 5.0
#define COORDINATE_SYSTEM_P20_OFFSET 6.0
#define COORDINATE_SYSTEM_METER_OFFSET 7.0

uniform mat4 u_ViewMatrix;
uniform mat4 u_ProjectionMatrix;
uniform mat4 u_ViewProjectionMatrix;
uniform float u_Zoom : 1;
uniform float u_ZoomScale : 1;

uniform float u_CoordinateSystem;
uniform vec2 u_ViewportCenter;
uniform vec4 u_ViewportCenterProjection;
uniform vec3 u_PixelsPerDegree;
uniform vec3 u_PixelsPerDegree2;
uniform vec3 u_PixelsPerMeter;

uniform vec2 u_ViewportSize;
uniform float u_DevicePixelRatio;
uniform float u_FocalDistance;
uniform vec3 u_CameraPosition;

// web mercator coords -> world coords
vec2 project_mercator(vec2 lnglat) {
  float x = lnglat.x;
  return vec2(
    radians(x) + PI,
    PI - log(tan(PI * 0.25 + radians(lnglat.y) * 0.5))
  );
}

float project_scale(float meters) {
  return meters * u_PixelsPerMeter.z;
}


// offset coords -> world coords
vec4 project_offset(vec4 offset) {
  float dy = offset.y;
  dy = clamp(dy, -1., 1.);
  vec3 pixels_per_unit = u_PixelsPerDegree + u_PixelsPerDegree2 * dy;
  return vec4(offset.xyz * pixels_per_unit, offset.w);
}

vec3 project_normal(vec3 normal) {
  vec4 normal_modelspace = u_ModelMatrix * vec4(normal, 0.0);
  return normalize(normal_modelspace.xyz * u_PixelsPerMeter);
}

vec3 project_offset_normal(vec3 vector) {
  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01
    || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // normals generated by the polygon tesselator are in lnglat offsets instead of meters
    return normalize(vector * u_PixelsPerDegree);
  }
  return project_normal(vector);
}
// || u_CoordinateSystem < COORDINATE_SYSTEM_P20_OFFSET + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_P20_OFFSET - 0.01
// reverse Y
vec3 reverse_offset_normal(vec3 vector) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 ||u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET ) {
    return vector * vec3(1.0, -1.0, 1.0);
  }
  return vector;
}

vec4 project_position(vec4 position) {
  float a = COORDINATE_SYSTEM_LNGLAT_OFFSET;
  float b = COORDINATE_SYSTEM_P20_OFFSET;
  float c = COORDINATE_SYSTEM_LNGLAT;
  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
    || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    float X = position.x - u_ViewportCenter.x;
    float Y = position.y - u_ViewportCenter.y;
    return project_offset(vec4(X, Y, position.z, position.w));
  }
  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01) {
    return vec4(
      project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale,
      project_scale(position.z),
      position.w
    );
  }

  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20) {
    return vec4(
      (project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale - vec2(215440491., 106744817.)) * vec2(1., -1.),
      project_scale(position.z),
      position.w
    );
  }
  return position;

  // TODO: \u74E6\u7247\u5750\u6807\u7CFB & \u5E38\u89C4\u4E16\u754C\u5750\u6807\u7CFB
}
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
  vec2 offset = pixels / u_ViewportSize * u_DevicePixelRatio * 2.0;
  return offset * u_FocalDistance;
}

float project_pixel(float pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom));
  }
  return pixel;
}
vec2 project_pixel(vec2 pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom));
  }
  return pixel * -1.;
}

vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // Needs to be divided with project_uCommonUnitsPerMeter
    position.w *= u_PixelsPerMeter.z;
  }
  return viewProjectionMatrix * position + center;
}

// Projects from common space coordinates to clip space
vec4 project_common_position_to_clipspace(vec4 position) {
  return project_common_position_to_clipspace(
    position,
    u_ViewProjectionMatrix,
    u_ViewportCenterProjection
  );
}

vec4 unproject_clipspace_to_position(vec4 clipspacePos, mat4 u_InverseViewProjectionMatrix) {
  vec4 pos = u_InverseViewProjectionMatrix * (clipspacePos - u_ViewportCenterProjection);

  if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // Needs to be divided with project_uCommonUnitsPerMeter
     pos.w = pos.w / u_PixelsPerMeter.z;
  }
  return pos;
}


bool isEqual( float a,  float b) {
    return  a< b + 0.001 && a > b - 0.001;
}

`,xc=`/**
 * 2D signed distance field functions
 * @see http://www.iquilezles.org/www/articles/distfunctions2d/distfunctions2d.htm
 */

float ndot(vec2 a, vec2 b ) { return a.x*b.x - a.y*b.y; }

float sdCircle(vec2 p, float r) {
  return length(p) - r;
}

float sdEquilateralTriangle(vec2 p) {
  float k = sqrt(3.0);
  p.x = abs(p.x) - 1.0;
  p.y = p.y + 1.0/k;
  if( p.x + k*p.y > 0.0 ) p = vec2(p.x-k*p.y,-k*p.x-p.y)/2.0;
  p.x -= clamp( p.x, -2.0, 0.0 );
  return -length(p)*sign(p.y);
}

float sdBox(vec2 p, vec2 b) {
  vec2 d = abs(p)-b;
  return length(max(d,vec2(0))) + min(max(d.x,d.y),0.0);
}

float sdPentagon(vec2 p, float r) {
  vec3 k = vec3(0.809016994,0.587785252,0.726542528);
  p.x = abs(p.x);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= vec2(clamp(p.x,-r*k.z,r*k.z),r);
  return length(p)*sign(p.y);
}

float sdHexagon(vec2 p, float r) {
  vec3 k = vec3(-0.866025404,0.5,0.577350269);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdOctogon(vec2 p, float r) {
  vec3 k = vec3(-0.9238795325, 0.3826834323, 0.4142135623 );
  p = abs(p);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdHexagram(vec2 p, float r) {
  vec4 k=vec4(-0.5,0.8660254038,0.5773502692,1.7320508076);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= 2.0*min(dot(k.yx,p),0.0)*k.yx;
  p -= vec2(clamp(p.x,r*k.z,r*k.w),r);
  return length(p)*sign(p.y);
}

float sdRhombus(vec2 p, vec2 b) {
  vec2 q = abs(p);
  float h = clamp((-2.0*ndot(q,b)+ndot(b,b))/dot(b,b),-1.0,1.0);
  float d = length( q - 0.5*b*vec2(1.0-h,1.0+h) );
  return d * sign( q.x*b.y + q.y*b.x - b.x*b.y );
}

float sdVesica(vec2 p, float r, float d) {
  p = abs(p);
  float b = sqrt(r*r-d*d); // can delay this sqrt
  return ((p.y-b)*d>p.x*b)
          ? length(p-vec2(0.0,b))
          : length(p-vec2(-d,0.0))-r;
}
`,Jn=/precision\s+(high|low|medium)p\s+float/,jn=`#ifdef GL_FRAGMENT_PRECISION_HIGH
 precision highp float;
 #else
 precision mediump float;
#endif
`,Ec=/#pragma include (["^+"]?["\ "[a-zA-Z_0-9](.*)"]*?)/g,cs=(zl=Object(F.injectable)(),zl(rf=(jc=function(){function ne(){Y()(this,ne),this.moduleCache={},this.rawContentCache={}}return Xe()(ne,[{key:"registerBuiltinModules",value:function(){this.destroy(),this.registerModule("common",{vs:Pa,fs:Pa}),this.registerModule("decode",{vs:eu,fs:""}),this.registerModule("projection",{vs:Cs,fs:""}),this.registerModule("project",{vs:pu,fs:""}),this.registerModule("sdf_2d",{vs:"",fs:xc}),this.registerModule("lighting",{vs:So,fs:""}),this.registerModule("light",{vs:Io,fs:""}),this.registerModule("picking",{vs:ul,fs:Sl})}},{key:"registerModule",value:function(N,G){if(this.rawContentCache[N])return;var Ce=G.vs,ft=G.fs,Yt=G.uniforms,sr=Fl(Ce),or=sr.content,Dr=sr.uniforms,sn=Fl(ft),Hn=sn.content,ea=sn.uniforms;this.rawContentCache[N]={fs:Hn,uniforms:ls(ls(ls({},Dr),ea),Yt),vs:or}}},{key:"destroy",value:function(){this.moduleCache={},this.rawContentCache={}}},{key:"getModule",value:function(N){var G=this;if(this.moduleCache[N])return this.moduleCache[N];var Ce=this.rawContentCache[N].vs,ft=this.rawContentCache[N].fs,Yt=this.processModule(Ce,[],"vs"),sr=Yt.content,or=Yt.includeList,Dr=this.processModule(ft,[],"fs"),sn=Dr.content,Hn=Dr.includeList,ea=sn,la=kc()(or.concat(Hn).concat(N)).reduce(function(ti,ja){return ls(ls({},ti),G.rawContentCache[ja].uniforms)},{});return Jn.test(sn)||(ea=jn+sn),this.moduleCache[N]={fs:ea.trim(),uniforms:la,vs:sr.trim()},this.moduleCache[N]}},{key:"processModule",value:function(N,G,Ce){var ft=this,Yt=N.replace(Ec,function(sr,or){var Dr=or.split(" "),sn=Dr[0].replace(/"/g,"");if(G.indexOf(sn)>-1)return"";var Hn=ft.rawContentCache[sn][Ce];G.push(sn);var ea=ft.processModule(Hn,G,Ce),la=ea.content;return la});return{content:Yt,includeList:G}}}]),ne}(),jc))||rf),Do=o("iWIM"),vo=o.n(Do),ws=o("bPkA"),Au,ec,$a,no,ll,mu,cl=(Au=Object(F.injectable)(),ec=Object(F.inject)(D.a.IShaderModuleService),Au($a=(no=(mu=function(){function ne(){Y()(this,ne),bn()(this,"shaderModuleService",ll,this),this.rendererService=void 0,this.cameraService=void 0,this.mapService=void 0,this.interactionService=void 0,this.layerService=void 0,this.config=void 0}return Xe()(ne,[{key:"getName",value:function(){return""}},{key:"getType",value:function(){return ws.a.Normal}},{key:"init",value:function(N,G){this.config=G,this.rendererService=N.getContainer().get(D.a.IRendererService),this.cameraService=N.getContainer().get(D.a.ICameraService),this.mapService=N.getContainer().get(D.a.IMapService),this.interactionService=N.getContainer().get(D.a.IInteractionService),this.layerService=N.getContainer().get(D.a.ILayerService)}},{key:"render",value:function(N){}}]),ne}(),mu),ll=Mn()(no.prototype,"shaderModuleService",[ec],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),no))||$a),Cu,Is;function Fc(ne){var se=Gs();return function(){var G=ot()(ne),Ce;if(se){var ft=ot()(this).constructor;Ce=Reflect.construct(G,arguments,ft)}else Ce=G.apply(this,arguments);return et()(this,Ce)}}function Gs(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var yf=(Cu=Object(F.injectable)(),Cu(Is=function(ne){fe()(N,ne);var se=Fc(N);function N(){return Y()(this,N),se.apply(this,arguments)}return Xe()(N,[{key:"getName",value:function(){return"clear"}},{key:"init",value:function(Ce,ft){vo()(ot()(N.prototype),"init",this).call(this,Ce,ft)}},{key:"render",value:function(){this.rendererService.clear({color:[0,0,0,0],depth:1,framebuffer:null})}}]),N}(cl))||Is),Ul,Bl,Tc,fs,Bu,zc;function Al(ne,se){var N;if(typeof Symbol=="undefined"||ne[Symbol.iterator]==null){if(Array.isArray(ne)||(N=Vu(ne))||se&&ne&&typeof ne.length=="number"){N&&(ne=N);var G=0,Ce=function(){};return{s:Ce,n:function(){return G>=ne.length?{done:!0}:{done:!1,value:ne[G++]}},e:function(Dr){throw Dr},f:Ce}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var ft=!0,Yt=!1,sr;return{s:function(){N=ne[Symbol.iterator]()},n:function(){var Dr=N.next();return ft=Dr.done,Dr},e:function(Dr){Yt=!0,sr=Dr},f:function(){try{!ft&&N.return!=null&&N.return()}finally{if(Yt)throw sr}}}}function Vu(ne,se){if(!ne)return;if(typeof ne=="string")return tc(ne,se);var N=Object.prototype.toString.call(ne).slice(8,-1);if(N==="Object"&&ne.constructor&&(N=ne.constructor.name),N==="Map"||N==="Set")return Array.from(ne);if(N==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(N))return tc(ne,se)}function tc(ne,se){(se==null||se>ne.length)&&(se=ne.length);for(var N=0,G=new Array(se);N<se;N++)G[N]=ne[N];return G}var Gu=(Ul=Object(F.injectable)(),Bl=Object(F.inject)(D.a.IPostProcessor),Ul(Tc=(fs=(zc=function(){function ne(){Y()(this,ne),this.passes=[],bn()(this,"postProcessor",Bu,this),this.layer=void 0,this.renderFlag=void 0,this.width=0,this.height=0}return Xe()(ne,[{key:"setLayer",value:function(N){this.layer=N}},{key:"setRenderFlag",value:function(N){this.renderFlag=N}},{key:"getRenderFlag",value:function(){return this.renderFlag}},{key:"getPostProcessor",value:function(){return this.postProcessor}},{key:"render",value:function(){var se=Tn()(vr.a.mark(function G(){var Ce,ft,Yt;return vr.a.wrap(function(or){for(;;)switch(or.prev=or.next){case 0:Ce=Al(this.passes),or.prev=1,Ce.s();case 3:if((ft=Ce.n()).done){or.next=9;break}return Yt=ft.value,or.next=7,Yt.render(this.layer);case 7:or.next=3;break;case 9:or.next=14;break;case 11:or.prev=11,or.t0=or.catch(1),Ce.e(or.t0);case 14:return or.prev=14,Ce.f(),or.finish(14);case 17:this.layer.renderModels();case 18:case"end":return or.stop()}},G,this,[[1,11,14,17]])}));function N(){return se.apply(this,arguments)}return N}()},{key:"resize",value:function(N,G){(this.width!==N||this.height!==G)&&(this.width=N,this.height=G)}},{key:"add",value:function(N,G){N.getType()===ws.a.PostProcessing?this.postProcessor.add(N,this.layer,G):(N.init(this.layer,G),this.passes.push(N))}},{key:"insert",value:function(N,G,Ce){N.init(this.layer,G),this.passes.splice(Ce,0,N)}},{key:"destroy",value:function(){this.passes.length=0}}]),ne}(),zc),Bu=Mn()(fs.prototype,"postProcessor",[Bl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fs))||Tc),Ds,nf,rc,nc,ac,s;function a(ne,se){var N=Object.keys(ne);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(ne);se&&(G=G.filter(function(Ce){return Object.getOwnPropertyDescriptor(ne,Ce).enumerable})),N.push.apply(N,G)}return N}function n(ne){for(var se=1;se<arguments.length;se++){var N=arguments[se]!=null?arguments[se]:{};se%2?a(Object(N),!0).forEach(function(G){ee()(ne,G,N[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(N)):a(Object(N)).forEach(function(G){Object.defineProperty(ne,G,Object.getOwnPropertyDescriptor(N,G))})}return ne}function l(ne){var se=v();return function(){var G=ot()(ne),Ce;if(se){var ft=ot()(this).constructor;Ce=Reflect.construct(G,arguments,ft)}else Ce=G.apply(this,arguments);return et()(this,Ce)}}function v(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var O=(Ds=Object(F.injectable)(),nf=Object(F.inject)(D.a.ILogService),Ds(rc=(nc=(s=function(ne){fe()(N,ne);var se=l(N);function N(){var G;Y()(this,N);for(var Ce=arguments.length,ft=new Array(Ce),Yt=0;Yt<Ce;Yt++)ft[Yt]=arguments[Yt];return G=se.call.apply(se,[this].concat(ft)),bn()(G,"logger",ac,Ha()(G)),G.pickingFBO=void 0,G.layer=void 0,G.width=0,G.height=0,G.alreadyInRendering=!1,G.pickFromPickingFBO=function(sr){var or=sr.x,Dr=sr.y,sn=sr.lngLat,Hn=sr.type;if(!G.layer.isVisible()||!G.layer.needPick(Hn))return;var ea=G.rendererService,la=ea.getViewportSize,ti=ea.readPixels,ja=ea.useFramebuffer,Ti=la(),Qa=Ti.width,Vi=Ti.height,Co=G.layer.getLayerConfig(),yo=Co.enableHighlight,Zi=Co.enableSelect,jo=or*window.devicePixelRatio,qa=Dr*window.devicePixelRatio;if(jo>Qa||jo<0||qa>Vi||qa<0)return;var lo;ja(G.pickingFBO,function(){var iu;if(lo=ti({x:Math.round(jo),y:Math.round(Vi-(Dr+1)*window.devicePixelRatio),width:1,height:1,data:new Uint8Array(1*1*4),framebuffer:G.pickingFBO}),lo[0]!==0||lo[1]!==0||lo[2]!==0){G.logger.debug("picked");var _i=Object(be.k)(lo),ki=G.layer.getSource().getFeatureById(_i),Ea={x:or,y:Dr,type:Hn,lngLat:sn,featureId:_i,feature:ki};ki&&(G.layer.setCurrentPickId(_i),G.triggerHoverOnLayer(Ea))}else{var wo={x:or,y:Dr,lngLat:sn,type:G.layer.getCurrentPickId()===null?"un"+Hn:"mouseout",featureId:null,feature:null};G.triggerHoverOnLayer(n(n({},wo),{},{type:"unpick"})),G.triggerHoverOnLayer(wo),G.layer.setCurrentPickId(null)}yo&&G.highlightPickedFeature(lo),Zi&&Hn==="click"&&((iu=lo)===null||iu===void 0?void 0:iu.toString())!==[0,0,0,0].toString()&&G.selectFeature(lo)})},G}return Xe()(N,[{key:"getType",value:function(){return ws.a.Normal}},{key:"getName",value:function(){return"pixelPicking"}},{key:"init",value:function(Ce,ft){vo()(ot()(N.prototype),"init",this).call(this,Ce,ft),this.layer=Ce;var Yt=this.rendererService,sr=Yt.createTexture2D,or=Yt.createFramebuffer,Dr=Yt.getViewportSize,sn=Dr(),Hn=sn.width,ea=sn.height;this.pickingFBO=or({color:sr({width:Hn,height:ea,wrapS:Gn.a.CLAMP_TO_EDGE,wrapT:Gn.a.CLAMP_TO_EDGE})}),this.interactionService.on(ui.a.Hover,this.pickFromPickingFBO),this.interactionService.on(ui.a.Select,this.selectFeatureHandle.bind(this)),this.interactionService.on(ui.a.Active,this.highlightFeatureHandle.bind(this))}},{key:"render",value:function(Ce){var ft=this;if(this.alreadyInRendering)return;var Yt=this.rendererService,sr=Yt.getViewportSize,or=Yt.useFramebuffer,Dr=Yt.clear,sn=sr(),Hn=sn.width,ea=sn.height;this.alreadyInRendering=!0,(this.width!==Hn||this.height!==ea)&&(this.pickingFBO.resize({width:Hn,height:ea}),this.width=Hn,this.height=ea),or(this.pickingFBO,function(){Dr({framebuffer:ft.pickingFBO,color:[0,0,0,0],stencil:0,depth:1});var la=ft.layer.multiPassRenderer.getRenderFlag();ft.layer.multiPassRenderer.setRenderFlag(!1),Ce.hooks.beforePickingEncode.call(),Ce.render(),Ce.hooks.afterPickingEncode.call(),ft.layer.multiPassRenderer.setRenderFlag(la),ft.alreadyInRendering=!1})}},{key:"triggerHoverOnLayer",value:function(Ce){this.layer.emit(Ce.type,Ce)}},{key:"highlightPickedFeature",value:function(Ce){var ft=Et()(Ce,3),Yt=ft[0],sr=ft[1],or=ft[2];this.layer.hooks.beforeHighlight.call([Yt,sr,or]),this.layerService.renderLayers()}},{key:"selectFeature",value:function(Ce){var ft=Et()(Ce,3),Yt=ft[0],sr=ft[1],or=ft[2];this.layer.hooks.beforeSelect.call([Yt,sr,or]),this.layerService.renderLayers()}},{key:"selectFeatureHandle",value:function(Ce){var ft=Ce.featureId,Yt=Object(be.l)(ft);this.selectFeature(new Uint8Array(Yt))}},{key:"highlightFeatureHandle",value:function(Ce){var ft=Ce.featureId,Yt=Object(be.l)(ft);this.highlightPickedFeature(new Uint8Array(Yt))}}]),N}(cl),s),ac=Mn()(nc.prototype,"logger",[nf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nc))||rc),L=o("+em5"),j,ue;function Ee(ne,se){var N=Object.keys(ne);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(ne);se&&(G=G.filter(function(Ce){return Object.getOwnPropertyDescriptor(ne,Ce).enumerable})),N.push.apply(N,G)}return N}function $e(ne){for(var se=1;se<arguments.length;se++){var N=arguments[se]!=null?arguments[se]:{};se%2?Ee(Object(N),!0).forEach(function(G){ee()(ne,G,N[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(N)):Ee(Object(N)).forEach(function(G){Object.defineProperty(ne,G,Object.getOwnPropertyDescriptor(N,G))})}return ne}function nt(ne){var se=at();return function(){var G=ot()(ne),Ce;if(se){var ft=ot()(this).constructor;Ce=Reflect.construct(G,arguments,ft)}else Ce=G.apply(this,arguments);return et()(this,Ce)}}function at(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var Ft=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_BlurDir: [1.0, 0.0];

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

void main() {
  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);
}`,Nt=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,Jt=(j=Object(F.injectable)(),j(ue=function(ne){fe()(N,ne);var se=nt(N);function N(){return Y()(this,N),se.apply(this,arguments)}return Xe()(N,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:Nt,fs:Ft});var Ce=this.shaderModuleService.getModule("blur-pass"),ft=Ce.vs,Yt=Ce.fs,sr=Ce.uniforms,or=this.rendererService.getViewportSize(),Dr=or.width,sn=or.height;return{vs:ft,fs:Yt,uniforms:$e($e({},sr),{},{u_ViewportSize:[Dr,sn]})}}},{key:"convertOptionsToUniforms",value:function(Ce){var ft={};return Yo()(Ce.blurRadius)||(ft.u_BlurDir=[Ce.blurRadius,0]),ft}}]),N}(L.a))||ue),jt,Gt;function ar(ne,se){var N=Object.keys(ne);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(ne);se&&(G=G.filter(function(Ce){return Object.getOwnPropertyDescriptor(ne,Ce).enumerable})),N.push.apply(N,G)}return N}function nr(ne){for(var se=1;se<arguments.length;se++){var N=arguments[se]!=null?arguments[se]:{};se%2?ar(Object(N),!0).forEach(function(G){ee()(ne,G,N[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(N)):ar(Object(N)).forEach(function(G){Object.defineProperty(ne,G,Object.getOwnPropertyDescriptor(N,G))})}return ne}function Rr(ne){var se=gr();return function(){var G=ot()(ne),Ce;if(se){var ft=ot()(this).constructor;Ce=Reflect.construct(G,arguments,ft)}else Ce=G.apply(this,arguments);return et()(this,Ce)}}function gr(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var Ar=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_BlurDir: [1.0, 0.0];

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

void main() {
  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);
}`,Cr=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,an=(jt=Object(F.injectable)(),jt(Gt=function(ne){fe()(N,ne);var se=Rr(N);function N(){return Y()(this,N),se.apply(this,arguments)}return Xe()(N,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:Cr,fs:Ar});var Ce=this.shaderModuleService.getModule("blur-pass"),ft=Ce.vs,Yt=Ce.fs,sr=Ce.uniforms,or=this.rendererService.getViewportSize(),Dr=or.width,sn=or.height;return{vs:ft,fs:Yt,uniforms:nr(nr({},sr),{},{u_ViewportSize:[Dr,sn]})}}},{key:"convertOptionsToUniforms",value:function(Ce){var ft={};return Yo()(Ce.blurRadius)||(ft.u_BlurDir=[0,Ce.blurRadius]),ft}}]),N}(L.a))||Gt),Yr,vn;function Pn(ne,se){var N=Object.keys(ne);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(ne);se&&(G=G.filter(function(Ce){return Object.getOwnPropertyDescriptor(ne,Ce).enumerable})),N.push.apply(N,G)}return N}function qn(ne){for(var se=1;se<arguments.length;se++){var N=arguments[se]!=null?arguments[se]:{};se%2?Pn(Object(N),!0).forEach(function(G){ee()(ne,G,N[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(N)):Pn(Object(N)).forEach(function(G){Object.defineProperty(ne,G,Object.getOwnPropertyDescriptor(N,G))})}return ne}function sa(ne){var se=Aa();return function(){var G=ot()(ne),Ce;if(se){var ft=ot()(this).constructor;Ce=Reflect.construct(G,arguments,ft)}else Ce=G.apply(this,arguments);return et()(this,Ce)}}function Aa(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var Wa=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_Center : [0.5, 0.5];
uniform float u_Angle : 0;
uniform float u_Size : 8;

#pragma include "common"

float scale = PI / u_Size;

float pattern(float u_Angle, vec2 texSize, vec2 texCoord) {
  float s = sin(u_Angle), c = cos(u_Angle);
  vec2 tex = texCoord * texSize - u_Center * texSize;
  vec2 point = vec2(
    c * tex.x - s * tex.y,
    s * tex.x + c * tex.y
  ) * scale;
  return (sin(point.x) * sin(point.y)) * 4.0;
}

// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/colorhalftone.js
vec4 colorHalftone_filterColor(vec4 color, vec2 texSize, vec2 texCoord) {
  vec3 cmy = 1.0 - color.rgb;
  float k = min(cmy.x, min(cmy.y, cmy.z));
  cmy = (cmy - k) / (1.0 - k);
  cmy = clamp(
    cmy * 10.0 - 3.0 + vec3(
      pattern(u_Angle + 0.26179, texSize, texCoord),
      pattern(u_Angle + 1.30899, texSize, texCoord),
      pattern(u_Angle, texSize, texCoord)
    ),
    0.0,
    1.0
  );
  k = clamp(k * 10.0 - 5.0 + pattern(u_Angle + 0.78539, texSize, texCoord), 0.0, 1.0);
  return vec4(1.0 - cmy - k, color.a);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = colorHalftone_filterColor(gl_FragColor, u_ViewportSize, v_UV);
}`,_n=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,ua=(Yr=Object(F.injectable)(),Yr(vn=function(ne){fe()(N,ne);var se=sa(N);function N(){return Y()(this,N),se.apply(this,arguments)}return Xe()(N,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("colorhalftone-pass",{vs:_n,fs:Wa});var Ce=this.shaderModuleService.getModule("colorhalftone-pass"),ft=Ce.vs,Yt=Ce.fs,sr=Ce.uniforms,or=this.rendererService.getViewportSize(),Dr=or.width,sn=or.height;return{vs:ft,fs:Yt,uniforms:qn(qn({},sr),{},{u_ViewportSize:[Dr,sn]})}}}]),N}(L.a))||vn),xa,Zn;function Ca(ne){var se=ia();return function(){var G=ot()(ne),Ce;if(se){var ft=ot()(this).constructor;Ce=Reflect.construct(G,arguments,ft)}else Ce=G.apply(this,arguments);return et()(this,Ce)}}function ia(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var La=`varying vec2 v_UV;

uniform sampler2D u_Texture;

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
}`,za=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,Hi=(xa=Object(F.injectable)(),xa(Zn=function(ne){fe()(N,ne);var se=Ca(N);function N(){return Y()(this,N),se.apply(this,arguments)}return Xe()(N,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("copy-pass",{vs:za,fs:La}),this.shaderModuleService.getModule("copy-pass")}}]),N}(L.a))||Zn),Ai,Ni;function Ei(ne,se){var N=Object.keys(ne);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(ne);se&&(G=G.filter(function(Ce){return Object.getOwnPropertyDescriptor(ne,Ce).enumerable})),N.push.apply(N,G)}return N}function Bi(ne){for(var se=1;se<arguments.length;se++){var N=arguments[se]!=null?arguments[se]:{};se%2?Ei(Object(N),!0).forEach(function(G){ee()(ne,G,N[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(N)):Ei(Object(N)).forEach(function(G){Object.defineProperty(ne,G,Object.getOwnPropertyDescriptor(N,G))})}return ne}function es(ne){var se=ts();return function(){var G=ot()(ne),Ce;if(se){var ft=ot()(this).constructor;Ce=Reflect.construct(G,arguments,ft)}else Ce=G.apply(this,arguments);return et()(this,Ce)}}function ts(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var vu=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_Center : [0.5, 0.5];
uniform float u_Scale : 10;

// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/hexagonalpixelate.js
vec4 hexagonalPixelate_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {
  vec2 tex = (texCoord * texSize - u_Center * texSize) / u_Scale;
  tex.y /= 0.866025404;
  tex.x -= tex.y * 0.5;
  vec2 a;
  if (tex.x + tex.y - floor(tex.x) - floor(tex.y) < 1.0) {
    a = vec2(floor(tex.x), floor(tex.y));
  }
  else a = vec2(ceil(tex.x), ceil(tex.y));
  vec2 b = vec2(ceil(tex.x), floor(tex.y));
  vec2 c = vec2(floor(tex.x), ceil(tex.y));
  vec3 TEX = vec3(tex.x, tex.y, 1.0 - tex.x - tex.y);
  vec3 A = vec3(a.x, a.y, 1.0 - a.x - a.y);
  vec3 B = vec3(b.x, b.y, 1.0 - b.x - b.y);
  vec3 C = vec3(c.x, c.y, 1.0 - c.x - c.y);
  float alen = length(TEX - A);
  float blen = length(TEX - B);
  float clen = length(TEX - C);
  vec2 choice;
  if (alen < blen) {
    if (alen < clen) choice = a;
    else choice = c;
  } else {
    if (blen < clen) choice = b;
    else choice = c;
  }
  choice.x += choice.y * 0.5;
  choice.y *= 0.866025404;
  choice *= u_Scale / texSize;
  return texture2D(texture, choice + u_Center);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = hexagonalPixelate_sampleColor(u_Texture, u_ViewportSize, v_UV);
}`,wu=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,hs=(Ai=Object(F.injectable)(),Ai(Ni=function(ne){fe()(N,ne);var se=es(N);function N(){return Y()(this,N),se.apply(this,arguments)}return Xe()(N,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("hexagonalpixelate-pass",{vs:wu,fs:vu});var Ce=this.shaderModuleService.getModule("hexagonalpixelate-pass"),ft=Ce.vs,Yt=Ce.fs,sr=Ce.uniforms,or=this.rendererService.getViewportSize(),Dr=or.width,sn=or.height;return{vs:ft,fs:Yt,uniforms:Bi(Bi({},sr),{},{u_ViewportSize:[Dr,sn]})}}}]),N}(L.a))||Ni),Hs,Ou;function ic(ne,se){var N=Object.keys(ne);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(ne);se&&(G=G.filter(function(Ce){return Object.getOwnPropertyDescriptor(ne,Ce).enumerable})),N.push.apply(N,G)}return N}function tu(ne){for(var se=1;se<arguments.length;se++){var N=arguments[se]!=null?arguments[se]:{};se%2?ic(Object(N),!0).forEach(function(G){ee()(ne,G,N[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(N)):ic(Object(N)).forEach(function(G){Object.defineProperty(ne,G,Object.getOwnPropertyDescriptor(N,G))})}return ne}function Hu(ne){var se=oc();return function(){var G=ot()(ne),Ce;if(se){var ft=ot()(this).constructor;Ce=Reflect.construct(G,arguments,ft)}else Ce=G.apply(this,arguments);return et()(this,Ce)}}function oc(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var ru=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform float u_Strength : 0.6;

vec4 ink_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {
  vec2 dx = vec2(1.0 / texSize.x, 0.0);
  vec2 dy = vec2(0.0, 1.0 / texSize.y);
  vec4 color = texture2D(texture, texCoord);
  float bigTotal = 0.0;
  float smallTotal = 0.0;
  vec3 bigAverage = vec3(0.0);
  vec3 smallAverage = vec3(0.0);
  for (float x = -2.0; x <= 2.0; x += 1.0) {
    for (float y = -2.0; y <= 2.0; y += 1.0) {
      vec3 sample = texture2D(texture, texCoord + dx * x + dy * y).rgb;
      bigAverage += sample;
      bigTotal += 1.0;
      if (abs(x) + abs(y) < 2.0) {
        smallAverage += sample;
        smallTotal += 1.0;
      }
    }
  }
  vec3 edge = max(vec3(0.0), bigAverage / bigTotal - smallAverage / smallTotal);
  float power = u_Strength * u_Strength * u_Strength * u_Strength * u_Strength;
  return vec4(color.rgb - dot(edge, edge) * power * 100000.0, color.a);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = ink_sampleColor(u_Texture, u_ViewportSize, v_UV);
}`,Mu=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,ds=(Hs=Object(F.injectable)(),Hs(Ou=function(ne){fe()(N,ne);var se=Hu(N);function N(){return Y()(this,N),se.apply(this,arguments)}return Xe()(N,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("ink-pass",{vs:Mu,fs:ru});var Ce=this.shaderModuleService.getModule("ink-pass"),ft=Ce.vs,Yt=Ce.fs,sr=Ce.uniforms,or=this.rendererService.getViewportSize(),Dr=or.width,sn=or.height;return{vs:ft,fs:Yt,uniforms:tu(tu({},sr),{},{u_ViewportSize:[Dr,sn]})}}}]),N}(L.a))||Ou),ao,Zu;function Vl(ne){var se=ps();return function(){var G=ot()(ne),Ce;if(se){var ft=ot()(this).constructor;Ce=Reflect.construct(G,arguments,ft)}else Ce=G.apply(this,arguments);return et()(this,Ce)}}function ps(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var No=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform float u_Amount : 0.5;

float rand(vec2 co) {
  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);
}

// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/noise.js
vec4 noise_filterColor(vec4 color, vec2 texCoord) {
  float diff = (rand(texCoord) - 0.5) * u_Amount;
  color.r += diff;
  color.g += diff;
  color.b += diff;
  return color;
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = noise_filterColor(gl_FragColor, v_UV);
}`,ko=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,Ko=(ao=Object(F.injectable)(),ao(Zu=function(ne){fe()(N,ne);var se=Vl(N);function N(){return Y()(this,N),se.apply(this,arguments)}return Xe()(N,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("noise-pass",{vs:ko,fs:No}),this.shaderModuleService.getModule("noise-pass")}}]),N}(L.a))||Zu),Ao,uo;function Ns(ne){var se=nu();return function(){var G=ot()(ne),Ce;if(se){var ft=ot()(this).constructor;Ce=Reflect.construct(G,arguments,ft)}else Ce=G.apply(this,arguments);return et()(this,Ce)}}function nu(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var Gl=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,Uc=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform float u_Amount : 0.5;

// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/sepia.js
vec4 sepia_filterColor(vec4 color) {
  float r = color.r;
  float g = color.g;
  float b = color.b;
  color.r =
    min(1.0, (r * (1.0 - (0.607 * u_Amount))) + (g * (0.769 * u_Amount)) + (b * (0.189 * u_Amount)));
  color.g = min(1.0, (r * 0.349 * u_Amount) + (g * (1.0 - (0.314 * u_Amount))) + (b * 0.168 * u_Amount));
  color.b = min(1.0, (r * 0.272 * u_Amount) + (g * 0.534 * u_Amount) + (b * (1.0 - (0.869 * u_Amount))));
  return color;
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = sepia_filterColor(gl_FragColor);
}`,fl=(Ao=Object(F.injectable)(),Ao(uo=function(ne){fe()(N,ne);var se=Ns(N);function N(){return Y()(this,N),se.apply(this,arguments)}return Xe()(N,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("sepia-pass",{vs:Gl,fs:Uc}),this.shaderModuleService.getModule("sepia-pass")}}]),N}(L.a))||uo),sc,hl,ks,go,_c,ms,af,Sf=(sc=Object(F.injectable)(),hl=Object(F.inject)(D.a.IRendererService),ks=Object(F.postConstruct)(),sc(go=(_c=(af=function(){function ne(){Y()(this,ne),bn()(this,"rendererService",ms,this),this.passes=[],this.readFBO=void 0,this.writeFBO=void 0}return Xe()(ne,[{key:"getReadFBO",value:function(){return this.readFBO}},{key:"getWriteFBO",value:function(){return this.writeFBO}},{key:"render",value:function(){var se=Tn()(vr.a.mark(function G(Ce){var ft,Yt;return vr.a.wrap(function(or){for(;;)switch(or.prev=or.next){case 0:ft=0;case 1:if(!(ft<this.passes.length)){or.next=10;break}return Yt=this.passes[ft],Yt.setRenderToScreen(this.isLastEnabledPass(ft)),or.next=6,Yt.render(Ce);case 6:ft!==this.passes.length-1&&this.swap();case 7:ft++,or.next=1;break;case 10:case"end":return or.stop()}},G,this)}));function N(G){return se.apply(this,arguments)}return N}()},{key:"resize",value:function(N,G){this.readFBO.resize({width:N,height:G}),this.writeFBO.resize({width:N,height:G})}},{key:"add",value:function(N,G,Ce){N.init(G,Ce),this.passes.push(N)}},{key:"insert",value:function(N,G,Ce,ft){N.init(Ce,ft),this.passes.splice(G,0,N)}},{key:"getPostProcessingPassByName",value:function(N){return this.passes.find(function(G){return G.getName()===N})}},{key:"init",value:function(){}},{key:"isLastEnabledPass",value:function(N){for(var G=N+1;G<this.passes.length;G++)if(this.passes[G].isEnabled())return!1;return!0}},{key:"swap",value:function(){var N=this.readFBO;this.readFBO=this.writeFBO,this.writeFBO=N}}]),ne}(),af),ms=Mn()(_c.prototype,"rendererService",[hl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mn()(_c.prototype,"init",[ks],Object.getOwnPropertyDescriptor(_c.prototype,"init"),_c.prototype),_c))||go),Af,Sc;function Wu(ne){var se=bf();return function(){var G=ot()(ne),Ce;if(se){var ft=ot()(this).constructor;Ce=Reflect.construct(G,arguments,ft)}else Ce=G.apply(this,arguments);return et()(this,Ce)}}function bf(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var of=(Af=Object(F.injectable)(),Af(Sc=function(ne){fe()(N,ne);var se=Wu(N);function N(){return Y()(this,N),se.apply(this,arguments)}return Xe()(N,[{key:"getType",value:function(){return ws.a.Normal}},{key:"getName",value:function(){return"render"}},{key:"init",value:function(Ce,ft){vo()(ot()(N.prototype),"init",this).call(this,Ce,ft)}},{key:"render",value:function(Ce){var ft=this.rendererService,Yt=ft.useFramebuffer,sr=ft.clear;Yt(null,function(){sr({color:[0,0,0,0],depth:1,stencil:0}),Ce.multiPassRenderer.setRenderFlag(!1),Ce.render(),Ce.multiPassRenderer.setRenderFlag(!0)})}}]),N}(cl))||Sc),Cf,Pu,uc,If,Bc,Ac,$f,Jf;function Qf(ne,se){var N=Object.keys(ne);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(ne);se&&(G=G.filter(function(Ce){return Object.getOwnPropertyDescriptor(ne,Ce).enumerable})),N.push.apply(N,G)}return N}function qf(ne){for(var se=1;se<arguments.length;se++){var N=arguments[se]!=null?arguments[se]:{};se%2?Qf(Object(N),!0).forEach(function(G){ee()(ne,G,N[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(N)):Qf(Object(N)).forEach(function(G){Object.defineProperty(ne,G,Object.getOwnPropertyDescriptor(N,G))})}return ne}function wf(ne){var se=eh();return function(){var G=ot()(ne),Ce;if(se){var ft=ot()(this).constructor;Ce=Reflect.construct(G,arguments,ft)}else Ce=G.apply(this,arguments);return et()(this,Ce)}}function eh(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ne){return!1}}var Hl=`uniform float u_opacity : 1.0;
uniform float u_MixRatio : 0.5;

uniform sampler2D u_Diffuse1;
uniform sampler2D u_Diffuse2;

varying vec2 v_UV;

void main() {
  vec4 texel1 = texture2D(u_Diffuse1, v_UV);
  vec4 texel2 = texture2D(u_Diffuse2, v_UV);
  gl_FragColor = u_opacity * mix(texel1, texel2, u_MixRatio);
}
`,sf=`varying vec2 v_UV;

uniform sampler2D u_Texture;

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
}`,io=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`;function lc(ne,se){for(var N=0,G=1/se,Ce=ne;Ce>0;)N=N+G*(Ce%se),Ce=Math.floor(Ce/se),G=G/se;return N}var xf=1,Cc=(Cf=Object(F.injectable)(),Pu=Object(F.inject)(D.a.IShaderModuleService),uc=Object(F.inject)(D.a.ILogService),Cf(If=(Bc=(Jf=function(ne){fe()(N,ne);var se=wf(N);function N(){var G;Y()(this,N);for(var Ce=arguments.length,ft=new Array(Ce),Yt=0;Yt<Ce;Yt++)ft[Yt]=arguments[Yt];return G=se.call.apply(se,[this].concat(ft)),bn()(G,"shaderModuleService",Ac,Ha()(G)),bn()(G,"logger",$f,Ha()(G)),G.haltonSequence=[],G.accumulatingId=0,G.frame=0,G.timer=void 0,G.sampleRenderTarget=void 0,G.prevRenderTarget=void 0,G.outputRenderTarget=void 0,G.copyRenderTarget=void 0,G.blendModel=void 0,G.outputModel=void 0,G.copyModel=void 0,G}return Xe()(N,[{key:"getType",value:function(){return ws.a.Normal}},{key:"getName",value:function(){return"taa"}},{key:"init",value:function(Ce,ft){vo()(ot()(N.prototype),"init",this).call(this,Ce,ft);var Yt=this.rendererService,sr=Yt.createFramebuffer,or=Yt.createTexture2D;this.sampleRenderTarget=sr({color:or({width:1,height:1,wrapS:Gn.a.CLAMP_TO_EDGE,wrapT:Gn.a.CLAMP_TO_EDGE})}),this.prevRenderTarget=sr({color:or({width:1,height:1,wrapS:Gn.a.CLAMP_TO_EDGE,wrapT:Gn.a.CLAMP_TO_EDGE})}),this.outputRenderTarget=sr({color:or({width:1,height:1,wrapS:Gn.a.CLAMP_TO_EDGE,wrapT:Gn.a.CLAMP_TO_EDGE})}),this.copyRenderTarget=sr({color:or({width:1,height:1,wrapS:Gn.a.CLAMP_TO_EDGE,wrapT:Gn.a.CLAMP_TO_EDGE})});for(var Dr=0;Dr<30;Dr++)this.haltonSequence.push([lc(Dr,2),lc(Dr,3)]);this.blendModel=this.createTriangleModel("blend-pass",Hl),this.outputModel=this.createTriangleModel("copy-pass",sf,{blend:{enable:!0,func:{srcRGB:Gn.a.ONE,dstRGB:Gn.a.ONE_MINUS_SRC_ALPHA,srcAlpha:Gn.a.ONE,dstAlpha:Gn.a.ONE_MINUS_SRC_ALPHA},equation:{rgb:Gn.a.FUNC_ADD,alpha:Gn.a.FUNC_ADD}}}),this.copyModel=this.createTriangleModel("copy-pass",sf)}},{key:"render",value:function(Ce){var ft=this,Yt=this.rendererService,sr=Yt.clear,or=Yt.getViewportSize,Dr=Yt.useFramebuffer,sn=or(),Hn=sn.width,ea=sn.height;this.sampleRenderTarget.resize({width:Hn,height:ea}),this.prevRenderTarget.resize({width:Hn,height:ea}),this.outputRenderTarget.resize({width:Hn,height:ea}),this.copyRenderTarget.resize({width:Hn,height:ea}),this.resetFrame(),this.stopAccumulating();var la=Ce.multiPassRenderer.getPostProcessor().getReadFBO();Dr(la,function(){sr({color:[0,0,0,0],depth:1,stencil:0,framebuffer:la}),Ce.multiPassRenderer.setRenderFlag(!1),Ce.render(),Ce.multiPassRenderer.setRenderFlag(!0)});var ti=function ja(Ti){if(!ft.accumulatingId||Ti!==ft.accumulatingId)return;ft.isFinished()||(ft.doRender(Ce),requestAnimationFrame(function(){ja(Ti)}))};this.accumulatingId=xf++,this.timer=window.setTimeout(function(){ti(ft.accumulatingId)},50)}},{key:"doRender",value:function(Ce){var ft=this;this.logger.debug("accumulatingId: ".concat(this.accumulatingId));var Yt=this.rendererService,sr=Yt.clear,or=Yt.getViewportSize,Dr=Yt.useFramebuffer,sn=or(),Hn=sn.width,ea=sn.height,la=Ce.getLayerConfig(),ti=la.jitterScale,ja=ti===void 0?1:ti,Ti=this.haltonSequence[this.frame%this.haltonSequence.length];this.cameraService.jitterProjectionMatrix((Ti[0]*2-1)/Hn*ja,(Ti[1]*2-1)/ea*ja),Ce.multiPassRenderer.setRenderFlag(!1),Ce.hooks.beforeRender.call(),Dr(this.sampleRenderTarget,function(){sr({color:[0,0,0,0],depth:1,stencil:0,framebuffer:ft.sampleRenderTarget}),Ce.render()}),Ce.hooks.afterRender.call(),Ce.multiPassRenderer.setRenderFlag(!0);var Qa=Ce.getLayerConfig();Dr(this.outputRenderTarget,function(){ft.blendModel.draw({uniforms:{u_opacity:Qa.opacity||1,u_MixRatio:ft.frame===0?1:.9,u_Diffuse1:ft.sampleRenderTarget,u_Diffuse2:ft.frame===0?Ce.multiPassRenderer.getPostProcessor().getReadFBO():ft.prevRenderTarget}})}),this.frame===0&&sr({color:[0,0,0,0],depth:1,stencil:0,framebuffer:this.copyRenderTarget}),this.frame>=1&&(Dr(this.copyRenderTarget,function(){ft.outputModel.draw({uniforms:{u_Texture:ft.outputRenderTarget}})}),Dr(Ce.multiPassRenderer.getPostProcessor().getReadFBO(),function(){ft.copyModel.draw({uniforms:{u_Texture:ft.copyRenderTarget}})}),Ce.multiPassRenderer.getPostProcessor().render(Ce));var Vi=this.prevRenderTarget;this.prevRenderTarget=this.outputRenderTarget,this.outputRenderTarget=Vi,this.frame++,this.cameraService.clearJitterProjectionMatrix()}},{key:"isFinished",value:function(){return this.frame>=this.haltonSequence.length}},{key:"resetFrame",value:function(){this.frame=0}},{key:"stopAccumulating",value:function(){this.accumulatingId=0,window.clearTimeout(this.timer)}},{key:"createTriangleModel",value:function(Ce,ft,Yt){this.shaderModuleService.registerModule(Ce,{vs:io,fs:ft});var sr=this.shaderModuleService.getModule(Ce),or=sr.vs,Dr=sr.fs,sn=sr.uniforms,Hn=this.rendererService,ea=Hn.createAttribute,la=Hn.createBuffer,ti=Hn.createModel;return ti(qf({vs:or,fs:Dr,attributes:{a_Position:ea({buffer:la({data:[-4,-4,4,-4,0,4],type:Gn.a.FLOAT}),size:2})},uniforms:qf({},sn),depth:{enable:!1},count:3},Yt))}}]),N}(cl),Jf),Ac=Mn()(Bc.prototype,"shaderModuleService",[Pu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$f=Mn()(Bc.prototype,"logger",[uc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Bc))||If),au=new F.Container;au.bind(D.a.IGlobalConfigService).to(dn).inSingletonScope(),au.bind(D.a.IShaderModuleService).to(cs).inSingletonScope(),au.bind(D.a.ILogService).to(Il).inSingletonScope(),Object(F.decorate)(Object(F.injectable)(),p.EventEmitter),au.bind(D.a.IEventEmitter).to(p.EventEmitter);var Cl=Z()(au,!1),Ef=function(se){var N=Cl.lazyInject(se);return function(G,Ce,ft){N.call(this,G,Ce),ft&&(ft.initializer=function(){return G[Ce]})}},Df=function(se){var N=Cl.lazyMultiInject(se);return function(G,Ce,ft){N.call(this,G,Ce),ft&&(ft.initializer=function(){return G[Ce]})}},Vc=g.c=au,uf=0;function Gc(){var ne=new F.Container;return ne.parent=au,ne.bind(D.a.SceneID).toConstantValue("".concat(uf++)),ne.bind(D.a.ILayerService).to(Wn).inSingletonScope(),ne.bind(D.a.ISceneService).to(Rs).inSingletonScope(),ne.bind(D.a.ICameraService).to(hr).inSingletonScope(),ne.bind(D.a.ICoordinateSystemService).to(Xo).inSingletonScope(),ne.bind(D.a.IInteractionService).to(Re).inSingletonScope(),ne.bind(D.a.IPickingService).to(Ks).inSingletonScope(),ne.bind(D.a.IControlService).to(Kn).inSingletonScope(),ne.bind(D.a.IMarkerService).to(le).inSingletonScope(),ne.bind(D.a.IIconService).to(xt).inSingletonScope(),ne.bind(D.a.IFontService).to(R).inSingletonScope(),ne.bind(D.a.IPopupService).to(Bt).inSingletonScope(),ne.bind(D.a.INormalPass).to(yf).whenTargetNamed("clear"),ne.bind(D.a.INormalPass).to(O).whenTargetNamed("pixelPicking"),ne.bind(D.a.INormalPass).to(of).whenTargetNamed("render"),ne.bind(D.a.INormalPass).to(Cc).whenTargetNamed("taa"),ne.bind(D.a.IFactoryNormalPass).toFactory(function(se){return function(N){return se.container.getNamed(D.a.INormalPass,N)}}),ne.bind(D.a.IPostProcessingPass).to(Hi).whenTargetNamed("copy"),ne.bind(D.a.IPostProcessingPass).to(Jt).whenTargetNamed("blurH"),ne.bind(D.a.IPostProcessingPass).to(an).whenTargetNamed("blurV"),ne.bind(D.a.IPostProcessingPass).to(Ko).whenTargetNamed("noise"),ne.bind(D.a.IPostProcessingPass).to(fl).whenTargetNamed("sepia"),ne.bind(D.a.IPostProcessingPass).to(ua).whenTargetNamed("colorHalftone"),ne.bind(D.a.IPostProcessingPass).to(hs).whenTargetNamed("hexagonalPixelate"),ne.bind(D.a.IPostProcessingPass).to(ds).whenTargetNamed("ink"),ne.bind(D.a.IFactoryPostProcessingPass).toFactory(function(se){return function(N){var G=se.container.getNamed(D.a.IPostProcessingPass,N);return G.setName(N),G}}),ne}function dl(ne){var se=new F.Container;return se.parent=ne,se.bind(D.a.IStyleAttributeService).to(hf).inSingletonScope(),se.bind(D.a.IMultiPassRenderer).to(Gu).inSingletonScope(),se.bind(D.a.IPostProcessor).to(Sf).inSingletonScope(),se}},fbrv:function(Ue,g,o){"use strict";var E=this&&this.__spreadArrays||function(){for(var Se=0,mt=0,Le=arguments.length;mt<Le;mt++)Se+=arguments[mt].length;for(var St=Array(Se),Ye=0,mt=0;mt<Le;mt++)for(var dt=arguments[mt],Je=0,wt=dt.length;Je<wt;Je++,Ye++)St[Ye]=dt[Je];return St};Object.defineProperty(g,"__esModule",{value:!0}),g.getFunctionName=g.getBaseClassDependencyCount=g.getDependencies=void 0;var p=o("Yk9n"),X=o("MON2"),F=o("FV85"),i=o("xfSm"),Z=o("ujMp");Object.defineProperty(g,"getFunctionName",{enumerable:!0,get:function(){return Z.getFunctionName}});var D=o("dX1H");function J(Se,mt){var Le=Z.getFunctionName(mt),St=ee(Se,Le,mt,!1);return St}g.getDependencies=J;function ee(Se,mt,Le,St){var Ye=Se.getConstructorMetadata(Le),dt=Ye.compilerGeneratedMetadata;if(dt===void 0){var Je=X.MISSING_INJECTABLE_ANNOTATION+" "+mt+".";throw new Error(Je)}var wt=Ye.userGeneratedMetadata,At=Object.keys(wt),Ie=Le.length===0&&At.length>0,Ne=Ie?At.length:Le.length,Ve=Y(St,mt,dt,wt,Ne),ct=ze(Se,Le),Me=E(Ve,ct);return Me}function ce(Se,mt,Le,St,Ye){var dt=Ye[Se.toString()]||[],Je=be(dt),wt=Je.unmanaged!==!0,At=St[Se],Ie=Je.inject||Je.multiInject;if(At=Ie||At,At instanceof p.LazyServiceIdentifer&&(At=At.unwrap()),wt){var Ne=At===Object,Ve=At===Function,ct=At===void 0,Me=Ne||Ve||ct;if(!mt&&Me){var ht=X.MISSING_INJECT_ANNOTATION+" argument "+Se+" in class "+Le+".";throw new Error(ht)}var Wt=new D.Target(F.TargetTypeEnum.ConstructorArgument,Je.targetName,At);return Wt.metadata=dt,Wt}return null}function Y(Se,mt,Le,St,Ye){for(var dt=[],Je=0;Je<Ye;Je++){var wt=Je,At=ce(wt,Se,mt,Le,St);At!==null&&dt.push(At)}return dt}function ze(Se,mt){for(var Le=Se.getPropertiesMetadata(mt),St=[],Ye=Object.keys(Le),dt=0,Je=Ye;dt<Je.length;dt++){var wt=Je[dt],At=Le[wt],Ie=be(Le[wt]),Ne=Ie.targetName||wt,Ve=Ie.inject||Ie.multiInject,ct=new D.Target(F.TargetTypeEnum.ClassProperty,Ne,Ve);ct.metadata=At,St.push(ct)}var Me=Object.getPrototypeOf(mt.prototype).constructor;if(Me!==Object){var ht=ze(Se,Me);St=E(St,ht)}return St}function Xe(Se,mt){var Le=Object.getPrototypeOf(mt.prototype).constructor;if(Le!==Object){var St=Z.getFunctionName(Le),Ye=ee(Se,St,Le,!0),dt=Ye.map(function(At){return At.metadata.filter(function(Ie){return Ie.key===i.UNMANAGED_TAG})}),Je=[].concat.apply([],dt).length,wt=Ye.length-Je;return wt>0?wt:Xe(Se,Le)}else return 0}g.getBaseClassDependencyCount=Xe;function be(Se){var mt={};return Se.forEach(function(Le){mt[Le.key.toString()]=Le.value}),{inject:mt[i.INJECT_TAG],multiInject:mt[i.MULTI_INJECT_TAG],targetName:mt[i.NAME_TAG],unmanaged:mt[i.UNMANAGED_TAG]}}},fbvF:function(Ue,g,o){(function(E,p){Ue.exports=p()})(this,function(){"use strict";var E=function(je){return je instanceof Uint8Array||je instanceof Uint16Array||je instanceof Uint32Array||je instanceof Int8Array||je instanceof Int16Array||je instanceof Int32Array||je instanceof Float32Array||je instanceof Float64Array||je instanceof Uint8ClampedArray},p=function(je,Mt){for(var Er=Object.keys(Mt),Lr=0;Lr<Er.length;++Lr)je[Er[Lr]]=Mt[Er[Lr]];return je},X=`
`;function F(ge){return typeof atob!="undefined"?atob(ge):"base64:"+ge}function i(ge){var je=new Error("(regl) "+ge);throw console.error(je),je}function Z(ge,je){ge||i(je)}function D(ge){return ge?": "+ge:""}function J(ge,je,Mt){ge in je||i("unknown parameter ("+ge+")"+D(Mt)+". possible values: "+Object.keys(je).join())}function ee(ge,je){E(ge)||i("invalid parameter type"+D(je)+". must be a typed array")}function ce(ge,je){switch(je){case"number":return typeof ge=="number";case"object":return typeof ge=="object";case"string":return typeof ge=="string";case"boolean":return typeof ge=="boolean";case"function":return typeof ge=="function";case"undefined":return typeof ge=="undefined";case"symbol":return typeof ge=="symbol"}}function Y(ge,je,Mt){ce(ge,je)||i("invalid parameter type"+D(Mt)+". expected "+je+", got "+typeof ge)}function ze(ge,je){ge>=0&&(ge|0)===ge||i("invalid parameter type, ("+ge+")"+D(je)+". must be a nonnegative integer")}function Xe(ge,je,Mt){je.indexOf(ge)<0&&i("invalid value"+D(Mt)+". must be one of: "+je)}var be=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function Se(ge){Object.keys(ge).forEach(function(je){be.indexOf(je)<0&&i('invalid regl constructor argument "'+je+'". must be one of '+be)})}function mt(ge,je){for(ge=ge+"";ge.length<je;)ge=" "+ge;return ge}function Le(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function St(ge,je){this.number=ge,this.line=je,this.errors=[]}function Ye(ge,je,Mt){this.file=ge,this.line=je,this.message=Mt}function dt(){var ge=new Error,je=(ge.stack||ge).toString(),Mt=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(je);if(Mt)return Mt[1];var Er=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(je);return Er?Er[1]:"unknown"}function Je(){var ge=new Error,je=(ge.stack||ge).toString(),Mt=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(je);if(Mt)return Mt[1];var Er=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(je);return Er?Er[1]:"unknown"}function wt(ge,je){var Mt=ge.split(`
`),Er=1,Lr=0,wr={unknown:new Le,0:new Le};wr.unknown.name=wr[0].name=je||dt(),wr.unknown.lines.push(new St(0,""));for(var Tr=0;Tr<Mt.length;++Tr){var Wr=Mt[Tr],un=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(Wr);if(un)switch(un[1]){case"line":var Jr=/(\d+)(\s+\d+)?/.exec(un[2]);Jr&&(Er=Jr[1]|0,Jr[2]&&(Lr=Jr[2]|0,Lr in wr||(wr[Lr]=new Le)));break;case"define":var Qr=/SHADER_NAME(_B64)?\s+(.*)$/.exec(un[2]);Qr&&(wr[Lr].name=Qr[1]?F(Qr[2]):Qr[2]);break}wr[Lr].lines.push(new St(Er++,Wr))}return Object.keys(wr).forEach(function(ln){var Sn=wr[ln];Sn.lines.forEach(function(pn){Sn.index[pn.number]=pn})}),wr}function At(ge){var je=[];return ge.split(`
`).forEach(function(Mt){if(Mt.length<5)return;var Er=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(Mt);Er?je.push(new Ye(Er[1]|0,Er[2]|0,Er[3].trim())):Mt.length>0&&je.push(new Ye("unknown",0,Mt))}),je}function Ie(ge,je){je.forEach(function(Mt){var Er=ge[Mt.file];if(Er){var Lr=Er.index[Mt.line];if(Lr){Lr.errors.push(Mt),Er.hasErrors=!0;return}}ge.unknown.hasErrors=!0,ge.unknown.lines[0].errors.push(Mt)})}function Ne(ge,je,Mt,Er,Lr){if(!ge.getShaderParameter(je,ge.COMPILE_STATUS)){var wr=ge.getShaderInfoLog(je),Tr=Er===ge.FRAGMENT_SHADER?"fragment":"vertex";ur(Mt,"string",Tr+" shader source must be a string",Lr);var Wr=wt(Mt,Lr),un=At(wr);Ie(Wr,un),Object.keys(Wr).forEach(function(Jr){var Qr=Wr[Jr];if(!Qr.hasErrors)return;var ln=[""],Sn=[""];function pn(nn,_r){ln.push(nn),Sn.push(_r||"")}pn("file number "+Jr+": "+Qr.name+`
`,"color:red;text-decoration:underline;font-weight:bold"),Qr.lines.forEach(function(nn){if(nn.errors.length>0){pn(mt(nn.number,4)+"|  ","background-color:yellow; font-weight:bold"),pn(nn.line+X,"color:red; background-color:yellow; font-weight:bold");var _r=0;nn.errors.forEach(function(xr){var Xr=xr.message,On=/^\s*'(.*)'\s*:\s*(.*)$/.exec(Xr);if(On){var Ir=On[1];Xr=On[2];switch(Ir){case"assign":Ir="=";break}_r=Math.max(nn.line.indexOf(Ir,_r),0)}else _r=0;pn(mt("| ",6)),pn(mt("^^^",_r+3)+X,"font-weight:bold"),pn(mt("| ",6)),pn(Xr+X,"font-weight:bold")}),pn(mt("| ",6)+X)}else pn(mt(nn.number,4)+"|  "),pn(nn.line+X,"color:red")}),typeof document!="undefined"&&!window.chrome?(Sn[0]=ln.join("%c"),console.log.apply(console,Sn)):console.log(ln.join(""))}),Z.raise("Error compiling "+Tr+" shader, "+Wr[0].name)}}function Ve(ge,je,Mt,Er,Lr){if(!ge.getProgramParameter(je,ge.LINK_STATUS)){var wr=ge.getProgramInfoLog(je),Tr=wt(Mt,Lr),Wr=wt(Er,Lr),un='Error linking program with vertex shader, "'+Wr[0].name+'", and fragment shader "'+Tr[0].name+'"';typeof document!="undefined"?console.log("%c"+un+X+"%c"+wr,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(un+X+wr),Z.raise(un)}}function ct(ge){ge._commandRef=dt()}function Me(ge,je,Mt,Er){ct(ge);function Lr(un){return un?Er.id(un):0}ge._fragId=Lr(ge.static.frag),ge._vertId=Lr(ge.static.vert);function wr(un,Jr){Object.keys(Jr).forEach(function(Qr){un[Er.id(Qr)]=!0})}var Tr=ge._uniformSet={};wr(Tr,je.static),wr(Tr,je.dynamic);var Wr=ge._attributeSet={};wr(Wr,Mt.static),wr(Wr,Mt.dynamic),ge._hasCount="count"in ge.static||"count"in ge.dynamic||"elements"in ge.static||"elements"in ge.dynamic}function ht(ge,je){var Mt=Je();i(ge+" in command "+(je||dt())+(Mt==="unknown"?"":" called from "+Mt))}function Wt(ge,je,Mt){ge||ht(je,Mt||dt())}function Qt(ge,je,Mt,Er){ge in je||ht("unknown parameter ("+ge+")"+D(Mt)+". possible values: "+Object.keys(je).join(),Er||dt())}function ur(ge,je,Mt,Er){ce(ge,je)||ht("invalid parameter type"+D(Mt)+". expected "+je+", got "+typeof ge,Er||dt())}function oe(ge){ge()}function $(ge,je,Mt){ge.texture?Xe(ge.texture._texture.internalformat,je,"unsupported texture format for attachment"):Xe(ge.renderbuffer._renderbuffer.format,Mt,"unsupported renderbuffer format for attachment")}var H=33071,Ae=9728,ye=9984,Te=9985,pe=9986,it=9987,qt=5120,Pt=5121,me=5122,ve=5123,Ge=5124,st=5125,Oe=5126,gt=32819,C=32820,R=33635,q=34042,fe=36193,He={};He[qt]=He[Pt]=1,He[me]=He[ve]=He[fe]=He[R]=He[gt]=He[C]=2,He[Ge]=He[st]=He[Oe]=He[q]=4;function et(ge,je){return ge===C||ge===gt||ge===R?2:ge===q?4:He[ge]*je}function _t(ge){return!(ge&ge-1)&&!!ge}function ot(ge,je,Mt){var Er,Lr=je.width,wr=je.height,Tr=je.channels;Z(Lr>0&&Lr<=Mt.maxTextureSize&&wr>0&&wr<=Mt.maxTextureSize,"invalid texture shape"),(ge.wrapS!==H||ge.wrapT!==H)&&Z(_t(Lr)&&_t(wr),"incompatible wrap mode for texture, both width and height must be power of 2"),je.mipmask===1?Lr!==1&&wr!==1&&Z(ge.minFilter!==ye&&ge.minFilter!==pe&&ge.minFilter!==Te&&ge.minFilter!==it,"min filter requires mipmap"):(Z(_t(Lr)&&_t(wr),"texture must be a square power of 2 to support mipmapping"),Z(je.mipmask===(Lr<<1)-1,"missing or incomplete mipmap data")),je.type===Oe&&(Mt.extensions.indexOf("oes_texture_float_linear")<0&&Z(ge.minFilter===Ae&&ge.magFilter===Ae,"filter not supported, must enable oes_texture_float_linear"),Z(!ge.genMipmaps,"mipmap generation not supported with float textures"));var Wr=je.images;for(Er=0;Er<16;++Er)if(Wr[Er]){var un=Lr>>Er,Jr=wr>>Er;Z(je.mipmask&1<<Er,"missing mipmap data");var Qr=Wr[Er];if(Z(Qr.width===un&&Qr.height===Jr,"invalid shape for mip images"),Z(Qr.format===je.format&&Qr.internalformat===je.internalformat&&Qr.type===je.type,"incompatible type for mip image"),!Qr.compressed)if(Qr.data){var ln=Math.ceil(et(Qr.type,Tr)*un/Qr.unpackAlignment)*Qr.unpackAlignment;Z(Qr.data.byteLength===ln*Jr,"invalid data for image, buffer size is inconsistent with image format")}else Qr.element||Qr.copy}else ge.genMipmaps||Z((je.mipmask&1<<Er)===0,"extra mipmap data");je.compressed&&Z(!ge.genMipmaps,"mipmap generation for compressed images not supported")}function Ut(ge,je,Mt,Er){var Lr=ge.width,wr=ge.height,Tr=ge.channels;Z(Lr>0&&Lr<=Er.maxTextureSize&&wr>0&&wr<=Er.maxTextureSize,"invalid texture shape"),Z(Lr===wr,"cube map must be square"),Z(je.wrapS===H&&je.wrapT===H,"wrap mode not supported by cube map");for(var Wr=0;Wr<Mt.length;++Wr){var un=Mt[Wr];Z(un.width===Lr&&un.height===wr,"inconsistent cube map face shape"),je.genMipmaps&&(Z(!un.compressed,"can not generate mipmap for compressed textures"),Z(un.mipmask===1,"can not specify mipmaps and generate mipmaps"));for(var Jr=un.images,Qr=0;Qr<16;++Qr){var ln=Jr[Qr];if(ln){var Sn=Lr>>Qr,pn=wr>>Qr;Z(un.mipmask&1<<Qr,"missing mipmap data"),Z(ln.width===Sn&&ln.height===pn,"invalid shape for mip images"),Z(ln.format===ge.format&&ln.internalformat===ge.internalformat&&ln.type===ge.type,"incompatible type for mip image"),ln.compressed||(ln.data?Z(ln.data.byteLength===Sn*pn*Math.max(et(ln.type,Tr),ln.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):ln.element||ln.copy)}}}}var K=p(Z,{optional:oe,raise:i,commandRaise:ht,command:Wt,parameter:J,commandParameter:Qt,constructor:Se,type:Y,commandType:ur,isTypedArray:ee,nni:ze,oneOf:Xe,shaderError:Ne,linkError:Ve,callSite:Je,saveCommandRef:ct,saveDrawInfo:Me,framebufferFormat:$,guessCommand:dt,texture2D:ot,textureCube:Ut}),qe=0,ae=0,tt=5,kt=6;function pr(ge,je){this.id=qe++,this.type=ge,this.data=je}function Ke(ge){return ge.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function xt(ge){if(ge.length===0)return[];var je=ge.charAt(0),Mt=ge.charAt(ge.length-1);if(ge.length>1&&je===Mt&&(je==='"'||je==="'"))return['"'+Ke(ge.substr(1,ge.length-2))+'"'];var Er=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(ge);if(Er)return xt(ge.substr(0,Er.index)).concat(xt(Er[1])).concat(xt(ge.substr(Er.index+Er[0].length)));var Lr=ge.split(".");if(Lr.length===1)return['"'+Ke(ge)+'"'];for(var wr=[],Tr=0;Tr<Lr.length;++Tr)wr=wr.concat(xt(Lr[Tr]));return wr}function bt(ge){return"["+xt(ge).join("][")+"]"}function Et(ge,je){return new pr(ge,bt(je+""))}function Fe(ge){return typeof ge=="function"&&!ge._reglType||ge instanceof pr}function pt(ge,je){if(typeof ge=="function")return new pr(ae,ge);if(typeof ge=="number"||typeof ge=="boolean")return new pr(tt,ge);if(Array.isArray(ge))return new pr(kt,ge.map(function(Mt,Er){return pt(Mt,je+"["+Er+"]")}));if(ge instanceof pr)return ge;K(!1,"invalid option type in uniform "+je)}var yt={DynamicVariable:pr,define:Et,isDynamic:Fe,unbox:pt,accessor:bt},Ht={next:typeof requestAnimationFrame=="function"?function(ge){return requestAnimationFrame(ge)}:function(ge){return setTimeout(ge,16)},cancel:typeof cancelAnimationFrame=="function"?function(ge){return cancelAnimationFrame(ge)}:clearTimeout},hr=typeof performance!="undefined"&&performance.now?function(){return performance.now()}:function(){return+new Date};function Zr(){var ge={"":0},je=[""];return{id:function(Er){var Lr=ge[Er];return Lr||(Lr=ge[Er]=je.length,je.push(Er),Lr)},str:function(Er){return je[Er]}}}function yr(ge,je,Mt){var Er=document.createElement("canvas");p(Er.style,{border:0,margin:0,padding:0,top:0,left:0}),ge.appendChild(Er),ge===document.body&&(Er.style.position="absolute",p(ge.style,{margin:0,padding:0}));function Lr(){var Wr=window.innerWidth,un=window.innerHeight;if(ge!==document.body){var Jr=ge.getBoundingClientRect();Wr=Jr.right-Jr.left,un=Jr.bottom-Jr.top}Er.width=Mt*Wr,Er.height=Mt*un,p(Er.style,{width:Wr+"px",height:un+"px"})}var wr;ge!==document.body&&typeof ResizeObserver=="function"?(wr=new ResizeObserver(function(){setTimeout(Lr)}),wr.observe(ge)):window.addEventListener("resize",Lr,!1);function Tr(){wr?wr.disconnect():window.removeEventListener("resize",Lr),ge.removeChild(Er)}return Lr(),{canvas:Er,onDestroy:Tr}}function Vn(ge,je){function Mt(Er){try{return ge.getContext(Er,je)}catch(Lr){return null}}return Mt("webgl")||Mt("experimental-webgl")||Mt("webgl-experimental")}function zn(ge){return typeof ge.nodeName=="string"&&typeof ge.appendChild=="function"&&typeof ge.getBoundingClientRect=="function"}function oa(ge){return typeof ge.drawArrays=="function"||typeof ge.drawElements=="function"}function $n(ge){return typeof ge=="string"?ge.split():(K(Array.isArray(ge),"invalid extension array"),ge)}function Kn(ge){return typeof ge=="string"?(K(typeof document!="undefined","not supported outside of DOM"),document.querySelector(ge)):ge}function Cn(ge){var je=ge||{},Mt,Er,Lr,wr,Tr={},Wr=[],un=[],Jr=typeof window=="undefined"?1:window.devicePixelRatio,Qr=!1,ln=function(_r){_r&&K.raise(_r)},Sn=function(){};if(typeof je=="string"?(K(typeof document!="undefined","selector queries only supported in DOM enviroments"),Mt=document.querySelector(je),K(Mt,"invalid query string for element")):typeof je=="object"?zn(je)?Mt=je:oa(je)?(wr=je,Lr=wr.canvas):(K.constructor(je),"gl"in je?wr=je.gl:"canvas"in je?Lr=Kn(je.canvas):"container"in je&&(Er=Kn(je.container)),"attributes"in je&&(Tr=je.attributes,K.type(Tr,"object","invalid context attributes")),"extensions"in je&&(Wr=$n(je.extensions)),"optionalExtensions"in je&&(un=$n(je.optionalExtensions)),"onDone"in je&&(K.type(je.onDone,"function","invalid or missing onDone callback"),ln=je.onDone),"profile"in je&&(Qr=!!je.profile),"pixelRatio"in je&&(Jr=+je.pixelRatio,K(Jr>0,"invalid pixel ratio"))):K.raise("invalid arguments to regl"),Mt&&(Mt.nodeName.toLowerCase()==="canvas"?Lr=Mt:Er=Mt),!wr){if(!Lr){K(typeof document!="undefined","must manually specify webgl context outside of DOM environments");var pn=yr(Er||document.body,ln,Jr);if(!pn)return null;Lr=pn.canvas,Sn=pn.onDestroy}Tr.premultipliedAlpha===void 0&&(Tr.premultipliedAlpha=!0),wr=Vn(Lr,Tr)}return wr?{gl:wr,canvas:Lr,container:Er,extensions:Wr,optionalExtensions:un,pixelRatio:Jr,profile:Qr,onDone:ln,onDestroy:Sn}:(Sn(),ln("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function z(ge,je){var Mt={};function Er(Tr){K.type(Tr,"string","extension name must be string");var Wr=Tr.toLowerCase(),un;try{un=Mt[Wr]=ge.getExtension(Wr)}catch(Jr){}return!!un}for(var Lr=0;Lr<je.extensions.length;++Lr){var wr=je.extensions[Lr];if(!Er(wr))return je.onDestroy(),je.onDone('"'+wr+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return je.optionalExtensions.forEach(Er),{extensions:Mt,restore:function(){Object.keys(Mt).forEach(function(Wr){if(Mt[Wr]&&!Er(Wr))throw new Error("(regl): error restoring extension "+Wr)})}}}function W(ge,je){for(var Mt=Array(ge),Er=0;Er<ge;++Er)Mt[Er]=je(Er);return Mt}var le=5120,xe=5121,ut=5122,Ot=5123,Bt=5124,Ze=5125,Rt=5126;function lr(ge){for(var je=16;je<=1<<28;je*=16)if(ge<=je)return je;return 0}function Ur(ge){var je,Mt;return je=(ge>65535)<<4,ge>>>=je,Mt=(ge>255)<<3,ge>>>=Mt,je|=Mt,Mt=(ge>15)<<2,ge>>>=Mt,je|=Mt,Mt=(ge>3)<<1,ge>>>=Mt,je|=Mt,je|ge>>1}function Gr(){var ge=W(8,function(){return[]});function je(wr){var Tr=lr(wr),Wr=ge[Ur(Tr)>>2];return Wr.length>0?Wr.pop():new ArrayBuffer(Tr)}function Mt(wr){ge[Ur(wr.byteLength)>>2].push(wr)}function Er(wr,Tr){var Wr=null;switch(wr){case le:Wr=new Int8Array(je(Tr),0,Tr);break;case xe:Wr=new Uint8Array(je(Tr),0,Tr);break;case ut:Wr=new Int16Array(je(2*Tr),0,Tr);break;case Ot:Wr=new Uint16Array(je(2*Tr),0,Tr);break;case Bt:Wr=new Int32Array(je(4*Tr),0,Tr);break;case Ze:Wr=new Uint32Array(je(4*Tr),0,Tr);break;case Rt:Wr=new Float32Array(je(4*Tr),0,Tr);break;default:return null}return Wr.length!==Tr?Wr.subarray(0,Tr):Wr}function Lr(wr){Mt(wr.buffer)}return{alloc:je,free:Mt,allocType:Er,freeType:Lr}}var cr=Gr();cr.zero=Gr();var Br=3408,wn=3410,fn=3411,tr=3412,rn=3413,dn=3414,En=3415,bn=33901,gn=33902,Mn=3379,Ga=3386,ga=34921,Ma=36347,Ia=36348,Wi=35661,da=35660,vi=34930,ya=36349,ba=34076,ha=34024,wi=7936,is=7937,Xi=7938,Xo=35724,Du=34047,Ha=36063,Oi=34852,Jo=3553,ui=34067,Yi=34069,Oo=33984,Za=6408,oo=5126,so=5121,bu=36160,Qo=36053,Xl=36064,js=16384,ho=function(je,Mt){var Er=1;Mt.ext_texture_filter_anisotropic&&(Er=je.getParameter(Du));var Lr=1,wr=1;Mt.webgl_draw_buffers&&(Lr=je.getParameter(Oi),wr=je.getParameter(Ha));var Tr=!!Mt.oes_texture_float;if(Tr){var Wr=je.createTexture();je.bindTexture(Jo,Wr),je.texImage2D(Jo,0,Za,1,1,0,Za,oo,null);var un=je.createFramebuffer();if(je.bindFramebuffer(bu,un),je.framebufferTexture2D(bu,Xl,Jo,Wr,0),je.bindTexture(Jo,null),je.checkFramebufferStatus(bu)!==Qo)Tr=!1;else{je.viewport(0,0,1,1),je.clearColor(1,0,0,1),je.clear(js);var Jr=cr.allocType(oo,4);je.readPixels(0,0,1,1,Za,oo,Jr),je.getError()?Tr=!1:(je.deleteFramebuffer(un),je.deleteTexture(Wr),Tr=Jr[0]===1),cr.freeType(Jr)}}var Qr=typeof navigator!="undefined"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent)),ln=!0;if(!Qr){var Sn=je.createTexture(),pn=cr.allocType(so,36);je.activeTexture(Oo),je.bindTexture(ui,Sn),je.texImage2D(Yi,0,Za,3,3,0,Za,so,pn),cr.freeType(pn),je.bindTexture(ui,null),je.deleteTexture(Sn),ln=!je.getError()}return{colorBits:[je.getParameter(wn),je.getParameter(fn),je.getParameter(tr),je.getParameter(rn)],depthBits:je.getParameter(dn),stencilBits:je.getParameter(En),subpixelBits:je.getParameter(Br),extensions:Object.keys(Mt).filter(function(nn){return!!Mt[nn]}),maxAnisotropic:Er,maxDrawbuffers:Lr,maxColorAttachments:wr,pointSizeDims:je.getParameter(bn),lineWidthDims:je.getParameter(gn),maxViewportDims:je.getParameter(Ga),maxCombinedTextureUnits:je.getParameter(Wi),maxCubeMapSize:je.getParameter(ba),maxRenderbufferSize:je.getParameter(ha),maxTextureUnits:je.getParameter(vi),maxTextureSize:je.getParameter(Mn),maxAttributes:je.getParameter(ga),maxVertexUniforms:je.getParameter(Ma),maxVertexTextureUnits:je.getParameter(da),maxVaryingVectors:je.getParameter(Ia),maxFragmentUniforms:je.getParameter(ya),glsl:je.getParameter(Xo),renderer:je.getParameter(is),vendor:je.getParameter(wi),version:je.getParameter(Xi),readFloat:Tr,npotTextureCube:ln}};function Vt(ge){return!!ge&&typeof ge=="object"&&Array.isArray(ge.shape)&&Array.isArray(ge.stride)&&typeof ge.offset=="number"&&ge.shape.length===ge.stride.length&&(Array.isArray(ge.data)||E(ge.data))}var Re=function(je){return Object.keys(je).map(function(Mt){return je[Mt]})},Dt={shape:po,flatten:Mi};function vr(ge,je,Mt){for(var Er=0;Er<je;++Er)Mt[Er]=ge[Er]}function en(ge,je,Mt,Er){for(var Lr=0,wr=0;wr<je;++wr)for(var Tr=ge[wr],Wr=0;Wr<Mt;++Wr)Er[Lr++]=Tr[Wr]}function Tn(ge,je,Mt,Er,Lr,wr){for(var Tr=wr,Wr=0;Wr<je;++Wr)for(var un=ge[Wr],Jr=0;Jr<Mt;++Jr)for(var Qr=un[Jr],ln=0;ln<Er;++ln)Lr[Tr++]=Qr[ln]}function Gn(ge,je,Mt,Er,Lr){for(var wr=1,Tr=Mt+1;Tr<je.length;++Tr)wr*=je[Tr];var Wr=je[Mt];if(je.length-Mt===4){var un=je[Mt+1],Jr=je[Mt+2],Qr=je[Mt+3];for(Tr=0;Tr<Wr;++Tr)Tn(ge[Tr],un,Jr,Qr,Er,Lr),Lr+=wr}else for(Tr=0;Tr<Wr;++Tr)Gn(ge[Tr],je,Mt+1,Er,Lr),Lr+=wr}function Mi(ge,je,Mt,Er){var Lr=1;if(je.length)for(var wr=0;wr<je.length;++wr)Lr*=je[wr];else Lr=0;var Tr=Er||cr.allocType(Mt,Lr);switch(je.length){case 0:break;case 1:vr(ge,je[0],Tr);break;case 2:en(ge,je[0],je[1],Tr);break;case 3:Tn(ge,je[0],je[1],je[2],Tr,0);break;default:Gn(ge,je,0,Tr,0)}return Tr}function po(ge){for(var je=[],Mt=ge;Mt.length;Mt=Mt[0])je.push(Mt.length);return je}var mo={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},Mo=5120,Nu=5122,Ol=5124,Ts=5121,pc=5123,xu=5125,Po=5126,ku=5126,_o={int8:Mo,int16:Nu,int32:Ol,uint8:Ts,uint16:pc,uint32:xu,float:Po,float32:ku},zi=35048,Ys=35040,Ks={dynamic:zi,stream:Ys,static:35044},Fs=Dt.flatten,Ii=Dt.shape,Gi=35044,_s=35040,ml=5121,$u=5126,It=[];It[5120]=1,It[5122]=2,It[5124]=4,It[5121]=1,It[5123]=2,It[5125]=4,It[5126]=4;function fr(ge){return mo[Object.prototype.toString.call(ge)]|0}function Pr(ge,je){for(var Mt=0;Mt<je.length;++Mt)ge[Mt]=je[Mt]}function Wn(ge,je,Mt,Er,Lr,wr,Tr){for(var Wr=0,un=0;un<Mt;++un)for(var Jr=0;Jr<Er;++Jr)ge[Wr++]=je[Lr*un+wr*Jr+Tr]}function Ya(ge,je,Mt,Er){var Lr=0,wr={};function Tr(_r){this.id=Lr++,this.buffer=ge.createBuffer(),this.type=_r,this.usage=Gi,this.byteLength=0,this.dimension=1,this.dtype=ml,this.persistentData=null,Mt.profile&&(this.stats={size:0})}Tr.prototype.bind=function(){ge.bindBuffer(this.type,this.buffer)},Tr.prototype.destroy=function(){Sn(this)};var Wr=[];function un(_r,xr){var Xr=Wr.pop();return Xr||(Xr=new Tr(_r)),Xr.bind(),ln(Xr,xr,_s,0,1,!1),Xr}function Jr(_r){Wr.push(_r)}function Qr(_r,xr,Xr){_r.byteLength=xr.byteLength,ge.bufferData(_r.type,xr,Xr)}function ln(_r,xr,Xr,On,Ir,ta){var qr;if(_r.usage=Xr,Array.isArray(xr)){if(_r.dtype=On||$u,xr.length>0){var zr;if(Array.isArray(xr[0])){qr=Ii(xr);for(var Vr=1,Kr=1;Kr<qr.length;++Kr)Vr*=qr[Kr];_r.dimension=Vr,zr=Fs(xr,qr,_r.dtype),Qr(_r,zr,Xr),ta?_r.persistentData=zr:cr.freeType(zr)}else if(typeof xr[0]=="number"){_r.dimension=Ir;var Xn=cr.allocType(_r.dtype,xr.length);Pr(Xn,xr),Qr(_r,Xn,Xr),ta?_r.persistentData=Xn:cr.freeType(Xn)}else E(xr[0])?(_r.dimension=xr[0].length,_r.dtype=On||fr(xr[0])||$u,zr=Fs(xr,[xr.length,xr[0].length],_r.dtype),Qr(_r,zr,Xr),ta?_r.persistentData=zr:cr.freeType(zr)):K.raise("invalid buffer data")}}else if(E(xr))_r.dtype=On||fr(xr),_r.dimension=Ir,Qr(_r,xr,Xr),ta&&(_r.persistentData=new Uint8Array(new Uint8Array(xr.buffer)));else if(Vt(xr)){qr=xr.shape;var na=xr.stride,cn=xr.offset,Hr=0,jr=0,ma=0,pa=0;qr.length===1?(Hr=qr[0],jr=1,ma=na[0],pa=0):qr.length===2?(Hr=qr[0],jr=qr[1],ma=na[0],pa=na[1]):K.raise("invalid shape"),_r.dtype=On||fr(xr.data)||$u,_r.dimension=jr;var Un=cr.allocType(_r.dtype,Hr*jr);Wn(Un,xr.data,Hr,jr,ma,pa,cn),Qr(_r,Un,Xr),ta?_r.persistentData=Un:cr.freeType(Un)}else xr instanceof ArrayBuffer?(_r.dtype=ml,_r.dimension=Ir,Qr(_r,xr,Xr),ta&&(_r.persistentData=new Uint8Array(new Uint8Array(xr)))):K.raise("invalid buffer data")}function Sn(_r){je.bufferCount--,Er(_r);var xr=_r.buffer;K(xr,"buffer must not be deleted already"),ge.deleteBuffer(xr),_r.buffer=null,delete wr[_r.id]}function pn(_r,xr,Xr,On){je.bufferCount++;var Ir=new Tr(xr);wr[Ir.id]=Ir;function ta(Vr){var Kr=Gi,Xn=null,na=0,cn=0,Hr=1;return Array.isArray(Vr)||E(Vr)||Vt(Vr)||Vr instanceof ArrayBuffer?Xn=Vr:typeof Vr=="number"?na=Vr|0:Vr&&(K.type(Vr,"object","buffer arguments must be an object, a number or an array"),"data"in Vr&&(K(Xn===null||Array.isArray(Xn)||E(Xn)||Vt(Xn),"invalid data for buffer"),Xn=Vr.data),"usage"in Vr&&(K.parameter(Vr.usage,Ks,"invalid buffer usage"),Kr=Ks[Vr.usage]),"type"in Vr&&(K.parameter(Vr.type,_o,"invalid buffer type"),cn=_o[Vr.type]),"dimension"in Vr&&(K.type(Vr.dimension,"number","invalid dimension"),Hr=Vr.dimension|0),"length"in Vr&&(K.nni(na,"buffer length must be a nonnegative integer"),na=Vr.length|0)),Ir.bind(),Xn?ln(Ir,Xn,Kr,cn,Hr,On):(na&&ge.bufferData(Ir.type,na,Kr),Ir.dtype=cn||ml,Ir.usage=Kr,Ir.dimension=Hr,Ir.byteLength=na),Mt.profile&&(Ir.stats.size=Ir.byteLength*It[Ir.dtype]),ta}function qr(Vr,Kr){K(Kr+Vr.byteLength<=Ir.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+Vr.byteLength+" starting from offset "+Kr+" to a buffer of size "+Ir.byteLength),ge.bufferSubData(Ir.type,Kr,Vr)}function zr(Vr,Kr){var Xn=(Kr||0)|0,na;if(Ir.bind(),E(Vr)||Vr instanceof ArrayBuffer)qr(Vr,Xn);else if(Array.isArray(Vr)){if(Vr.length>0)if(typeof Vr[0]=="number"){var cn=cr.allocType(Ir.dtype,Vr.length);Pr(cn,Vr),qr(cn,Xn),cr.freeType(cn)}else if(Array.isArray(Vr[0])||E(Vr[0])){na=Ii(Vr);var Hr=Fs(Vr,na,Ir.dtype);qr(Hr,Xn),cr.freeType(Hr)}else K.raise("invalid buffer data")}else if(Vt(Vr)){na=Vr.shape;var jr=Vr.stride,ma=0,pa=0,Un=0,Ua=0;na.length===1?(ma=na[0],pa=1,Un=jr[0],Ua=0):na.length===2?(ma=na[0],pa=na[1],Un=jr[0],Ua=jr[1]):K.raise("invalid shape");var Ta=Array.isArray(Vr.data)?Ir.dtype:fr(Vr.data),Ba=cr.allocType(Ta,ma*pa);Wn(Ba,Vr.data,ma,pa,Un,Ua,Vr.offset),qr(Ba,Xn),cr.freeType(Ba)}else K.raise("invalid data for buffer subdata");return ta}return Xr||ta(_r),ta._reglType="buffer",ta._buffer=Ir,ta.subdata=zr,Mt.profile&&(ta.stats=Ir.stats),ta.destroy=function(){Sn(Ir)},ta}function nn(){Re(wr).forEach(function(_r){_r.buffer=ge.createBuffer(),ge.bindBuffer(_r.type,_r.buffer),ge.bufferData(_r.type,_r.persistentData||_r.byteLength,_r.usage)})}return Mt.profile&&(je.getTotalBufferSize=function(){var _r=0;return Object.keys(wr).forEach(function(xr){_r+=wr[xr].stats.size}),_r}),{create:pn,createStream:un,destroyStream:Jr,clear:function(){Re(wr).forEach(Sn),Wr.forEach(Sn)},getBuffer:function(xr){return xr&&xr._buffer instanceof Tr?xr._buffer:null},restore:nn,_initBuffer:ln}}var xi=0,Ki=0,Ka=1,Di=1,Yo=4,Ps=4,gi={points:xi,point:Ki,lines:Ka,line:Di,triangles:Yo,triangle:Ps,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},Ml=0,$s=1,Ss=4,vl=5120,cu=5121,Eu=5122,fu=5123,ju=5124,Js=5125,Mc=34963,hf=35040,pi=35044;function Pc(ge,je,Mt,Er){var Lr={},wr=0,Tr={uint8:cu,uint16:fu};je.oes_element_index_uint&&(Tr.uint32=Js);function Wr(nn){this.id=wr++,Lr[this.id]=this,this.buffer=nn,this.primType=Ss,this.vertCount=0,this.type=0}Wr.prototype.bind=function(){this.buffer.bind()};var un=[];function Jr(nn){var _r=un.pop();return _r||(_r=new Wr(Mt.create(null,Mc,!0,!1)._buffer)),ln(_r,nn,hf,-1,-1,0,0),_r}function Qr(nn){un.push(nn)}function ln(nn,_r,xr,Xr,On,Ir,ta){nn.buffer.bind();var qr;if(_r){var zr=ta;!ta&&(!E(_r)||Vt(_r)&&!E(_r.data))&&(zr=je.oes_element_index_uint?Js:fu),Mt._initBuffer(nn.buffer,_r,xr,zr,3)}else ge.bufferData(Mc,Ir,xr),nn.buffer.dtype=qr||cu,nn.buffer.usage=xr,nn.buffer.dimension=3,nn.buffer.byteLength=Ir;if(qr=ta,!ta){switch(nn.buffer.dtype){case cu:case vl:qr=cu;break;case fu:case Eu:qr=fu;break;case Js:case ju:qr=Js;break;default:K.raise("unsupported type for element array")}nn.buffer.dtype=qr}nn.type=qr,K(qr!==Js||!!je.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var Vr=On;Vr<0&&(Vr=nn.buffer.byteLength,qr===fu?Vr>>=1:qr===Js&&(Vr>>=2)),nn.vertCount=Vr;var Kr=Xr;if(Xr<0){Kr=Ss;var Xn=nn.buffer.dimension;Xn===1&&(Kr=Ml),Xn===2&&(Kr=$s),Xn===3&&(Kr=Ss)}nn.primType=Kr}function Sn(nn){Er.elementsCount--,K(nn.buffer!==null,"must not double destroy elements"),delete Lr[nn.id],nn.buffer.destroy(),nn.buffer=null}function pn(nn,_r){var xr=Mt.create(null,Mc,!0),Xr=new Wr(xr._buffer);Er.elementsCount++;function On(Ir){if(!Ir)xr(),Xr.primType=Ss,Xr.vertCount=0,Xr.type=cu;else if(typeof Ir=="number")xr(Ir),Xr.primType=Ss,Xr.vertCount=Ir|0,Xr.type=cu;else{var ta=null,qr=pi,zr=-1,Vr=-1,Kr=0,Xn=0;Array.isArray(Ir)||E(Ir)||Vt(Ir)?ta=Ir:(K.type(Ir,"object","invalid arguments for elements"),"data"in Ir&&(ta=Ir.data,K(Array.isArray(ta)||E(ta)||Vt(ta),"invalid data for element buffer")),"usage"in Ir&&(K.parameter(Ir.usage,Ks,"invalid element buffer usage"),qr=Ks[Ir.usage]),"primitive"in Ir&&(K.parameter(Ir.primitive,gi,"invalid element buffer primitive"),zr=gi[Ir.primitive]),"count"in Ir&&(K(typeof Ir.count=="number"&&Ir.count>=0,"invalid vertex count for elements"),Vr=Ir.count|0),"type"in Ir&&(K.parameter(Ir.type,Tr,"invalid buffer type"),Xn=Tr[Ir.type]),"length"in Ir?Kr=Ir.length|0:(Kr=Vr,Xn===fu||Xn===Eu?Kr*=2:(Xn===Js||Xn===ju)&&(Kr*=4))),ln(Xr,ta,qr,zr,Vr,Kr,Xn)}return On}return On(nn),On._reglType="elements",On._elements=Xr,On.subdata=function(Ir,ta){return xr.subdata(Ir,ta),On},On.destroy=function(){Sn(Xr)},On}return{create:pn,createStream:Jr,destroyStream:Qr,getElements:function(_r){return typeof _r=="function"&&_r._elements instanceof Wr?_r._elements:null},clear:function(){Re(Lr).forEach(Sn)}}}var mc=new Float32Array(1),$c=new Uint32Array(mc.buffer),gl=5123;function Jc(ge){for(var je=cr.allocType(gl,ge.length),Mt=0;Mt<ge.length;++Mt)if(isNaN(ge[Mt]))je[Mt]=65535;else if(ge[Mt]===Infinity)je[Mt]=31744;else if(ge[Mt]===-Infinity)je[Mt]=64512;else{mc[0]=ge[Mt];var Er=$c[0],Lr=Er>>>31<<15,wr=(Er<<1>>>24)-127,Tr=Er>>13&(1<<10)-1;if(wr<-24)je[Mt]=Lr;else if(wr<-14){var Wr=-14-wr;je[Mt]=Lr+(Tr+(1<<10)>>Wr)}else wr>15?je[Mt]=Lr+31744:je[Mt]=Lr+(wr+15<<10)+Tr}return je}function $i(ge){return Array.isArray(ge)||E(ge)}var Tu=function(je){return!(je&je-1)&&!!je},yl=34467,os=3553,Lc=34067,vc=34069,Pl=6408,Ju=6406,Rc=6407,hu=6409,_u=6410,Qc=32854,Yl=32855,Si=36194,qc=32819,df=32820,Kl=33635,Ic=34042,$l=6402,Qu=34041,Fu=35904,bl=35906,Lo=36193,Jl=33776,Ll=33777,Rl=33778,Dc=33779,xl=35986,Qs=35987,eo=34798,pf=35840,mf=35841,El=35842,Ql=35843,qu=36196,Il=5121,gc=5123,yc=5125,el=5126,ef=10242,tl=10243,qs=10497,Tl=33071,ql=33648,Nc=10240,tf=10241,zs=9728,vf=9729,rl=9984,Pi=9985,nl=9986,zu=9987,fi=33170,kn=4352,Li=4353,Ls=4354,Dl=34046,Uu=3317,al=37440,gf=37441,ss=37443,_l=37444,il=33984,ol=[rl,nl,Pi,zu],Ui=[0,hu,_u,Rc,Pl],As={};As[hu]=As[Ju]=As[$l]=1,As[Qu]=As[_u]=2,As[Rc]=As[Fu]=3,As[Pl]=As[bl]=4;function Nl(ge){return"[object "+ge+"]"}var to=Nl("HTMLCanvasElement"),Rn=Nl("OffscreenCanvas"),Us=Nl("CanvasRenderingContext2D"),ni=Nl("ImageBitmap"),kl=Nl("HTMLImageElement"),du=Nl("HTMLVideoElement"),Bs=Object.keys(mo).concat([to,Rn,Us,ni,kl,du]),sl=[];sl[Il]=1,sl[el]=4,sl[Lo]=2,sl[gc]=2,sl[yc]=4;var tn=[];tn[Qc]=2,tn[Yl]=2,tn[Si]=2,tn[Qu]=4,tn[Jl]=.5,tn[Ll]=.5,tn[Rl]=1,tn[Dc]=1,tn[xl]=.5,tn[Qs]=1,tn[eo]=1,tn[pf]=.5,tn[mf]=.25,tn[El]=.5,tn[Ql]=.25,tn[qu]=.5;function bc(ge){return Array.isArray(ge)&&(ge.length===0||typeof ge[0]=="number")}function us(ge){if(!Array.isArray(ge))return!1;var je=ge.length;return!(je===0||!$i(ge[0]))}function ro(ge){return Object.prototype.toString.call(ge)}function qo(ge){return ro(ge)===to}function Rs(ge){return ro(ge)===Rn}function jl(ge){return ro(ge)===Us}function kc(ge){return ro(ge)===ni}function Vs(ge){return ro(ge)===kl}function Su(ge){return ro(ge)===du}function Fl(ge){if(!ge)return!1;var je=ro(ge);return Bs.indexOf(je)>=0?!0:bc(ge)||us(ge)||Vt(ge)}function zl(ge){return mo[Object.prototype.toString.call(ge)]|0}function rf(ge,je){var Mt=je.length;switch(ge.type){case Il:case gc:case yc:case el:var Er=cr.allocType(ge.type,Mt);Er.set(je),ge.data=Er;break;case Lo:ge.data=Jc(je);break;default:K.raise("unsupported texture type, must specify a typed array")}}function jc(ge,je){return cr.allocType(ge.type===Lo?el:ge.type,je)}function Ro(ge,je){ge.type===Lo?(ge.data=Jc(je),cr.freeType(je)):ge.data=je}function ls(ge,je,Mt,Er,Lr,wr){for(var Tr=ge.width,Wr=ge.height,un=ge.channels,Jr=Tr*Wr*un,Qr=jc(ge,Jr),ln=0,Sn=0;Sn<Wr;++Sn)for(var pn=0;pn<Tr;++pn)for(var nn=0;nn<un;++nn)Qr[ln++]=je[Mt*pn+Er*Sn+Lr*nn+wr];Ro(ge,Qr)}function Pa(ge,je,Mt,Er,Lr,wr){var Tr;if(typeof tn[ge]!="undefined"?Tr=tn[ge]:Tr=As[ge]*sl[je],wr&&(Tr*=6),Lr){for(var Wr=0,un=Mt;un>=1;)Wr+=Tr*un*un,un/=2;return Wr}else return Tr*Mt*Er}function eu(ge,je,Mt,Er,Lr,wr,Tr){var Wr={"don't care":kn,"dont care":kn,nice:Ls,fast:Li},un={repeat:qs,clamp:Tl,mirror:ql},Jr={nearest:zs,linear:vf},Qr=p({mipmap:zu,"nearest mipmap nearest":rl,"linear mipmap nearest":Pi,"nearest mipmap linear":nl,"linear mipmap linear":zu},Jr),ln={none:0,browser:_l},Sn={uint8:Il,rgba4:qc,rgb565:Kl,"rgb5 a1":df},pn={alpha:Ju,luminance:hu,"luminance alpha":_u,rgb:Rc,rgba:Pl,rgba4:Qc,"rgb5 a1":Yl,rgb565:Si},nn={};je.ext_srgb&&(pn.srgb=Fu,pn.srgba=bl),je.oes_texture_float&&(Sn.float32=Sn.float=el),je.oes_texture_half_float&&(Sn.float16=Sn["half float"]=Lo),je.webgl_depth_texture&&(p(pn,{depth:$l,"depth stencil":Qu}),p(Sn,{uint16:gc,uint32:yc,"depth stencil":Ic})),je.webgl_compressed_texture_s3tc&&p(nn,{"rgb s3tc dxt1":Jl,"rgba s3tc dxt1":Ll,"rgba s3tc dxt3":Rl,"rgba s3tc dxt5":Dc}),je.webgl_compressed_texture_atc&&p(nn,{"rgb atc":xl,"rgba atc explicit alpha":Qs,"rgba atc interpolated alpha":eo}),je.webgl_compressed_texture_pvrtc&&p(nn,{"rgb pvrtc 4bppv1":pf,"rgb pvrtc 2bppv1":mf,"rgba pvrtc 4bppv1":El,"rgba pvrtc 2bppv1":Ql}),je.webgl_compressed_texture_etc1&&(nn["rgb etc1"]=qu);var _r=Array.prototype.slice.call(ge.getParameter(yl));Object.keys(nn).forEach(function(c){var d=nn[c];_r.indexOf(d)>=0&&(pn[c]=d)});var xr=Object.keys(pn);Mt.textureFormats=xr;var Xr=[];Object.keys(pn).forEach(function(c){var d=pn[c];Xr[d]=c});var On=[];Object.keys(Sn).forEach(function(c){var d=Sn[c];On[d]=c});var Ir=[];Object.keys(Jr).forEach(function(c){var d=Jr[c];Ir[d]=c});var ta=[];Object.keys(Qr).forEach(function(c){var d=Qr[c];ta[d]=c});var qr=[];Object.keys(un).forEach(function(c){var d=un[c];qr[d]=c});var zr=xr.reduce(function(c,d){var y=pn[d];return y===hu||y===Ju||y===hu||y===_u||y===$l||y===Qu||je.ext_srgb&&(y===Fu||y===bl)?c[y]=y:y===Yl||d.indexOf("rgba")>=0?c[y]=Pl:c[y]=Rc,c},{});function Vr(){this.internalformat=Pl,this.format=Pl,this.type=Il,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=_l,this.width=0,this.height=0,this.channels=0}function Kr(c,d){c.internalformat=d.internalformat,c.format=d.format,c.type=d.type,c.compressed=d.compressed,c.premultiplyAlpha=d.premultiplyAlpha,c.flipY=d.flipY,c.unpackAlignment=d.unpackAlignment,c.colorSpace=d.colorSpace,c.width=d.width,c.height=d.height,c.channels=d.channels}function Xn(c,d){if(typeof d!="object"||!d)return;if("premultiplyAlpha"in d&&(K.type(d.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),c.premultiplyAlpha=d.premultiplyAlpha),"flipY"in d&&(K.type(d.flipY,"boolean","invalid texture flip"),c.flipY=d.flipY),"alignment"in d&&(K.oneOf(d.alignment,[1,2,4,8],"invalid texture unpack alignment"),c.unpackAlignment=d.alignment),"colorSpace"in d&&(K.parameter(d.colorSpace,ln,"invalid colorSpace"),c.colorSpace=ln[d.colorSpace]),"type"in d){var y=d.type;K(je.oes_texture_float||!(y==="float"||y==="float32"),"you must enable the OES_texture_float extension in order to use floating point textures."),K(je.oes_texture_half_float||!(y==="half float"||y==="float16"),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),K(je.webgl_depth_texture||!(y==="uint16"||y==="uint32"||y==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),K.parameter(y,Sn,"invalid texture type"),c.type=Sn[y]}var I=c.width,te=c.height,B=c.channels,k=!1;"shape"in d?(K(Array.isArray(d.shape)&&d.shape.length>=2,"shape must be an array"),I=d.shape[0],te=d.shape[1],d.shape.length===3&&(B=d.shape[2],K(B>0&&B<=4,"invalid number of channels"),k=!0),K(I>=0&&I<=Mt.maxTextureSize,"invalid width"),K(te>=0&&te<=Mt.maxTextureSize,"invalid height")):("radius"in d&&(I=te=d.radius,K(I>=0&&I<=Mt.maxTextureSize,"invalid radius")),"width"in d&&(I=d.width,K(I>=0&&I<=Mt.maxTextureSize,"invalid width")),"height"in d&&(te=d.height,K(te>=0&&te<=Mt.maxTextureSize,"invalid height")),"channels"in d&&(B=d.channels,K(B>0&&B<=4,"invalid number of channels"),k=!0)),c.width=I|0,c.height=te|0,c.channels=B|0;var Q=!1;if("format"in d){var We=d.format;K(je.webgl_depth_texture||!(We==="depth"||We==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),K.parameter(We,pn,"invalid texture format");var rt=c.internalformat=pn[We];c.format=zr[rt],We in Sn&&("type"in d||(c.type=Sn[We])),We in nn&&(c.compressed=!0),Q=!0}!k&&Q?c.channels=As[c.format]:k&&!Q?c.channels!==Ui[c.format]&&(c.format=c.internalformat=Ui[c.channels]):Q&&k&&K(c.channels===As[c.format],"number of channels inconsistent with specified format")}function na(c){ge.pixelStorei(al,c.flipY),ge.pixelStorei(gf,c.premultiplyAlpha),ge.pixelStorei(ss,c.colorSpace),ge.pixelStorei(Uu,c.unpackAlignment)}function cn(){Vr.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function Hr(c,d){var y=null;if(Fl(d)?y=d:d&&(K.type(d,"object","invalid pixel data type"),Xn(c,d),"x"in d&&(c.xOffset=d.x|0),"y"in d&&(c.yOffset=d.y|0),Fl(d.data)&&(y=d.data)),K(!c.compressed||y instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),d.copy){K(!y,"can not specify copy and data field for the same texture");var I=Lr.viewportWidth,te=Lr.viewportHeight;c.width=c.width||I-c.xOffset,c.height=c.height||te-c.yOffset,c.needsCopy=!0,K(c.xOffset>=0&&c.xOffset<I&&c.yOffset>=0&&c.yOffset<te&&c.width>0&&c.width<=I&&c.height>0&&c.height<=te,"copy texture read out of bounds")}else if(!y)c.width=c.width||1,c.height=c.height||1,c.channels=c.channels||4;else if(E(y))c.channels=c.channels||4,c.data=y,!("type"in d)&&c.type===Il&&(c.type=zl(y));else if(bc(y))c.channels=c.channels||4,rf(c,y),c.alignment=1,c.needsFree=!0;else if(Vt(y)){var B=y.data;!Array.isArray(B)&&c.type===Il&&(c.type=zl(B));var k=y.shape,Q=y.stride,We,rt,Pe,Qe,Tt,ke;k.length===3?(Pe=k[2],ke=Q[2]):(K(k.length===2,"invalid ndarray pixel data, must be 2 or 3D"),Pe=1,ke=1),We=k[0],rt=k[1],Qe=Q[0],Tt=Q[1],c.alignment=1,c.width=We,c.height=rt,c.channels=Pe,c.format=c.internalformat=Ui[Pe],c.needsFree=!0,ls(c,B,Qe,Tt,ke,y.offset)}else if(qo(y)||Rs(y)||jl(y))qo(y)||Rs(y)?c.element=y:c.element=y.canvas,c.width=c.element.width,c.height=c.element.height,c.channels=4;else if(kc(y))c.element=y,c.width=y.width,c.height=y.height,c.channels=4;else if(Vs(y))c.element=y,c.width=y.naturalWidth,c.height=y.naturalHeight,c.channels=4;else if(Su(y))c.element=y,c.width=y.videoWidth,c.height=y.videoHeight,c.channels=4;else if(us(y)){var vt=c.width||y[0].length,De=c.height||y.length,Zt=c.channels;$i(y[0][0])?Zt=Zt||y[0][0].length:Zt=Zt||1;for(var Kt=Dt.shape(y),dr=1,rr=0;rr<Kt.length;++rr)dr*=Kt[rr];var mr=jc(c,dr);Dt.flatten(y,Kt,"",mr),Ro(c,mr),c.alignment=1,c.width=vt,c.height=De,c.channels=Zt,c.format=c.internalformat=Ui[Zt],c.needsFree=!0}c.type===el?K(Mt.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):c.type===Lo&&K(Mt.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function jr(c,d,y){var I=c.element,te=c.data,B=c.internalformat,k=c.format,Q=c.type,We=c.width,rt=c.height;na(c),I?ge.texImage2D(d,y,k,k,Q,I):c.compressed?ge.compressedTexImage2D(d,y,B,We,rt,0,te):c.needsCopy?(Er(),ge.copyTexImage2D(d,y,k,c.xOffset,c.yOffset,We,rt,0)):ge.texImage2D(d,y,k,We,rt,0,k,Q,te||null)}function ma(c,d,y,I,te){var B=c.element,k=c.data,Q=c.internalformat,We=c.format,rt=c.type,Pe=c.width,Qe=c.height;na(c),B?ge.texSubImage2D(d,te,y,I,We,rt,B):c.compressed?ge.compressedTexSubImage2D(d,te,y,I,Q,Pe,Qe,k):c.needsCopy?(Er(),ge.copyTexSubImage2D(d,te,y,I,c.xOffset,c.yOffset,Pe,Qe)):ge.texSubImage2D(d,te,y,I,Pe,Qe,We,rt,k)}var pa=[];function Un(){return pa.pop()||new cn}function Ua(c){c.needsFree&&cr.freeType(c.data),cn.call(c),pa.push(c)}function Ta(){Vr.call(this),this.genMipmaps=!1,this.mipmapHint=kn,this.mipmask=0,this.images=Array(16)}function Ba(c,d,y){var I=c.images[0]=Un();c.mipmask=1,I.width=c.width=d,I.height=c.height=y,I.channels=c.channels=4}function hi(c,d){var y=null;if(Fl(d))y=c.images[0]=Un(),Kr(y,c),Hr(y,d),c.mipmask=1;else if(Xn(c,d),Array.isArray(d.mipmap))for(var I=d.mipmap,te=0;te<I.length;++te)y=c.images[te]=Un(),Kr(y,c),y.width>>=te,y.height>>=te,Hr(y,I[te]),c.mipmask|=1<<te;else y=c.images[0]=Un(),Kr(y,c),Hr(y,d),c.mipmask=1;Kr(c,c.images[0]),c.compressed&&(c.internalformat===Jl||c.internalformat===Ll||c.internalformat===Rl||c.internalformat===Dc)&&K(c.width%4===0&&c.height%4===0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function Fo(c,d){for(var y=c.images,I=0;I<y.length;++I){if(!y[I])return;jr(y[I],d,I)}}var Os=[];function ei(){var c=Os.pop()||new Ta;Vr.call(c),c.mipmask=0;for(var d=0;d<16;++d)c.images[d]=null;return c}function bo(c){for(var d=c.images,y=0;y<d.length;++y)d[y]&&Ua(d[y]),d[y]=null;Os.push(c)}function Ci(){this.minFilter=zs,this.magFilter=zs,this.wrapS=Tl,this.wrapT=Tl,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=kn}function vs(c,d){if("min"in d){var y=d.min;K.parameter(y,Qr),c.minFilter=Qr[y],ol.indexOf(c.minFilter)>=0&&!("faces"in d)&&(c.genMipmaps=!0)}if("mag"in d){var I=d.mag;K.parameter(I,Jr),c.magFilter=Jr[I]}var te=c.wrapS,B=c.wrapT;if("wrap"in d){var k=d.wrap;typeof k=="string"?(K.parameter(k,un),te=B=un[k]):Array.isArray(k)&&(K.parameter(k[0],un),K.parameter(k[1],un),te=un[k[0]],B=un[k[1]])}else{if("wrapS"in d){var Q=d.wrapS;K.parameter(Q,un),te=un[Q]}if("wrapT"in d){var We=d.wrapT;K.parameter(We,un),B=un[We]}}if(c.wrapS=te,c.wrapT=B,"anisotropic"in d){var rt=d.anisotropic;K(typeof rt=="number"&&rt>=1&&rt<=Mt.maxAnisotropic,"aniso samples must be between 1 and "),c.anisotropic=d.anisotropic}if("mipmap"in d){var Pe=!1;switch(typeof d.mipmap){case"string":K.parameter(d.mipmap,Wr,"invalid mipmap hint"),c.mipmapHint=Wr[d.mipmap],c.genMipmaps=!0,Pe=!0;break;case"boolean":Pe=c.genMipmaps=d.mipmap;break;case"object":K(Array.isArray(d.mipmap),"invalid mipmap type"),c.genMipmaps=!1,Pe=!0;break;default:K.raise("invalid mipmap type")}Pe&&!("min"in d)&&(c.minFilter=rl)}}function zo(c,d){ge.texParameteri(d,tf,c.minFilter),ge.texParameteri(d,Nc,c.magFilter),ge.texParameteri(d,ef,c.wrapS),ge.texParameteri(d,tl,c.wrapT),je.ext_texture_filter_anisotropic&&ge.texParameteri(d,Dl,c.anisotropic),c.genMipmaps&&(ge.hint(fi,c.mipmapHint),ge.generateMipmap(d))}var gs=0,Uo={},Bo=Mt.maxTextureUnits,Vo=Array(Bo).map(function(){return null});function aa(c){Vr.call(this),this.mipmask=0,this.internalformat=Pl,this.id=gs++,this.refCount=1,this.target=c,this.texture=ge.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new Ci,Tr.profile&&(this.stats={size:0})}function ou(c){ge.activeTexture(il),ge.bindTexture(c.target,c.texture)}function yi(){var c=Vo[0];c?ge.bindTexture(c.target,c.texture):ge.bindTexture(os,null)}function An(c){var d=c.texture;K(d,"must not double destroy texture");var y=c.unit,I=c.target;y>=0&&(ge.activeTexture(il+y),ge.bindTexture(I,null),Vo[y]=null),ge.deleteTexture(d),c.texture=null,c.params=null,c.pixels=null,c.refCount=0,delete Uo[c.id],wr.textureCount--}p(aa.prototype,{bind:function(){var d=this;d.bindCount+=1;var y=d.unit;if(y<0){for(var I=0;I<Bo;++I){var te=Vo[I];if(te){if(te.bindCount>0)continue;te.unit=-1}Vo[I]=d,y=I;break}y>=Bo&&K.raise("insufficient number of texture units"),Tr.profile&&wr.maxTextureUnits<y+1&&(wr.maxTextureUnits=y+1),d.unit=y,ge.activeTexture(il+y),ge.bindTexture(d.target,d.texture)}return y},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&An(this)}});function Ra(c,d){var y=new aa(os);Uo[y.id]=y,wr.textureCount++;function I(k,Q){var We=y.texInfo;Ci.call(We);var rt=ei();return typeof k=="number"?typeof Q=="number"?Ba(rt,k|0,Q|0):Ba(rt,k|0,k|0):k?(K.type(k,"object","invalid arguments to regl.texture"),vs(We,k),hi(rt,k)):Ba(rt,1,1),We.genMipmaps&&(rt.mipmask=(rt.width<<1)-1),y.mipmask=rt.mipmask,Kr(y,rt),K.texture2D(We,rt,Mt),y.internalformat=rt.internalformat,I.width=rt.width,I.height=rt.height,ou(y),Fo(rt,os),zo(We,os),yi(),bo(rt),Tr.profile&&(y.stats.size=Pa(y.internalformat,y.type,rt.width,rt.height,We.genMipmaps,!1)),I.format=Xr[y.internalformat],I.type=On[y.type],I.mag=Ir[We.magFilter],I.min=ta[We.minFilter],I.wrapS=qr[We.wrapS],I.wrapT=qr[We.wrapT],I}function te(k,Q,We,rt){K(!!k,"must specify image data");var Pe=Q|0,Qe=We|0,Tt=rt|0,ke=Un();return Kr(ke,y),ke.width=0,ke.height=0,Hr(ke,k),ke.width=ke.width||(y.width>>Tt)-Pe,ke.height=ke.height||(y.height>>Tt)-Qe,K(y.type===ke.type&&y.format===ke.format&&y.internalformat===ke.internalformat,"incompatible format for texture.subimage"),K(Pe>=0&&Qe>=0&&Pe+ke.width<=y.width&&Qe+ke.height<=y.height,"texture.subimage write out of bounds"),K(y.mipmask&1<<Tt,"missing mipmap data"),K(ke.data||ke.element||ke.needsCopy,"missing image data"),ou(y),ma(ke,os,Pe,Qe,Tt),yi(),Ua(ke),I}function B(k,Q){var We=k|0,rt=Q|0||We;if(We===y.width&&rt===y.height)return I;I.width=y.width=We,I.height=y.height=rt,ou(y);for(var Pe=0;y.mipmask>>Pe;++Pe){var Qe=We>>Pe,Tt=rt>>Pe;if(!Qe||!Tt)break;ge.texImage2D(os,Pe,y.format,Qe,Tt,0,y.format,y.type,null)}return yi(),Tr.profile&&(y.stats.size=Pa(y.internalformat,y.type,We,rt,!1,!1)),I}return I(c,d),I.subimage=te,I.resize=B,I._reglType="texture2d",I._texture=y,Tr.profile&&(I.stats=y.stats),I.destroy=function(){y.decRef()},I}function Va(c,d,y,I,te,B){var k=new aa(Lc);Uo[k.id]=k,wr.cubeCount++;var Q=new Array(6);function We(Qe,Tt,ke,vt,De,Zt){var Kt,dr=k.texInfo;for(Ci.call(dr),Kt=0;Kt<6;++Kt)Q[Kt]=ei();if(typeof Qe=="number"||!Qe){var rr=Qe|0||1;for(Kt=0;Kt<6;++Kt)Ba(Q[Kt],rr,rr)}else if(typeof Qe=="object")if(Tt)hi(Q[0],Qe),hi(Q[1],Tt),hi(Q[2],ke),hi(Q[3],vt),hi(Q[4],De),hi(Q[5],Zt);else if(vs(dr,Qe),Xn(k,Qe),"faces"in Qe){var mr=Qe.faces;for(K(Array.isArray(mr)&&mr.length===6,"cube faces must be a length 6 array"),Kt=0;Kt<6;++Kt)K(typeof mr[Kt]=="object"&&!!mr[Kt],"invalid input for cube map face"),Kr(Q[Kt],k),hi(Q[Kt],mr[Kt])}else for(Kt=0;Kt<6;++Kt)hi(Q[Kt],Qe);else K.raise("invalid arguments to cube map");for(Kr(k,Q[0]),Mt.npotTextureCube||K(Tu(k.width)&&Tu(k.height),"your browser does not support non power or two texture dimensions"),dr.genMipmaps?k.mipmask=(Q[0].width<<1)-1:k.mipmask=Q[0].mipmask,K.textureCube(k,dr,Q,Mt),k.internalformat=Q[0].internalformat,We.width=Q[0].width,We.height=Q[0].height,ou(k),Kt=0;Kt<6;++Kt)Fo(Q[Kt],vc+Kt);for(zo(dr,Lc),yi(),Tr.profile&&(k.stats.size=Pa(k.internalformat,k.type,We.width,We.height,dr.genMipmaps,!0)),We.format=Xr[k.internalformat],We.type=On[k.type],We.mag=Ir[dr.magFilter],We.min=ta[dr.minFilter],We.wrapS=qr[dr.wrapS],We.wrapT=qr[dr.wrapT],Kt=0;Kt<6;++Kt)bo(Q[Kt]);return We}function rt(Qe,Tt,ke,vt,De){K(!!Tt,"must specify image data"),K(typeof Qe=="number"&&Qe===(Qe|0)&&Qe>=0&&Qe<6,"invalid face");var Zt=ke|0,Kt=vt|0,dr=De|0,rr=Un();return Kr(rr,k),rr.width=0,rr.height=0,Hr(rr,Tt),rr.width=rr.width||(k.width>>dr)-Zt,rr.height=rr.height||(k.height>>dr)-Kt,K(k.type===rr.type&&k.format===rr.format&&k.internalformat===rr.internalformat,"incompatible format for texture.subimage"),K(Zt>=0&&Kt>=0&&Zt+rr.width<=k.width&&Kt+rr.height<=k.height,"texture.subimage write out of bounds"),K(k.mipmask&1<<dr,"missing mipmap data"),K(rr.data||rr.element||rr.needsCopy,"missing image data"),ou(k),ma(rr,vc+Qe,Zt,Kt,dr),yi(),Ua(rr),We}function Pe(Qe){var Tt=Qe|0;if(Tt===k.width)return;We.width=k.width=Tt,We.height=k.height=Tt,ou(k);for(var ke=0;ke<6;++ke)for(var vt=0;k.mipmask>>vt;++vt)ge.texImage2D(vc+ke,vt,k.format,Tt>>vt,Tt>>vt,0,k.format,k.type,null);return yi(),Tr.profile&&(k.stats.size=Pa(k.internalformat,k.type,We.width,We.height,!1,!0)),We}return We(c,d,y,I,te,B),We.subimage=rt,We.resize=Pe,We._reglType="textureCube",We._texture=k,Tr.profile&&(We.stats=k.stats),We.destroy=function(){k.decRef()},We}function rs(){for(var c=0;c<Bo;++c)ge.activeTexture(il+c),ge.bindTexture(os,null),Vo[c]=null;Re(Uo).forEach(An),wr.cubeCount=0,wr.textureCount=0}Tr.profile&&(wr.getTotalTextureSize=function(){var c=0;return Object.keys(Uo).forEach(function(d){c+=Uo[d].stats.size}),c});function w(){for(var c=0;c<Bo;++c){var d=Vo[c];d&&(d.bindCount=0,d.unit=-1,Vo[c]=null)}Re(Uo).forEach(function(y){y.texture=ge.createTexture(),ge.bindTexture(y.target,y.texture);for(var I=0;I<32;++I){if((y.mipmask&1<<I)===0)continue;if(y.target===os)ge.texImage2D(os,I,y.internalformat,y.width>>I,y.height>>I,0,y.internalformat,y.type,null);else for(var te=0;te<6;++te)ge.texImage2D(vc+te,I,y.internalformat,y.width>>I,y.height>>I,0,y.internalformat,y.type,null)}zo(y.texInfo,y.target)})}function b(){for(var c=0;c<Bo;++c){var d=Vo[c];d&&(d.bindCount=0,d.unit=-1,Vo[c]=null),ge.activeTexture(il+c),ge.bindTexture(os,null),ge.bindTexture(Lc,null)}}return{create2D:Ra,createCube:Va,clear:rs,getTexture:function(d){return null},restore:w,refresh:b}}var Io=36161,So=32854,Sl=32855,ul=36194,pu=33189,Cs=36168,xc=34041,Jn=35907,jn=34836,Ec=34842,cs=34843,Do=[];Do[So]=2,Do[Sl]=2,Do[ul]=2,Do[pu]=2,Do[Cs]=1,Do[xc]=4,Do[Jn]=4,Do[jn]=16,Do[Ec]=8,Do[cs]=6;function vo(ge,je,Mt){return Do[ge]*je*Mt}var ws=function(je,Mt,Er,Lr,wr){var Tr={rgba4:So,rgb565:ul,"rgb5 a1":Sl,depth:pu,stencil:Cs,"depth stencil":xc};Mt.ext_srgb&&(Tr.srgba=Jn),Mt.ext_color_buffer_half_float&&(Tr.rgba16f=Ec,Tr.rgb16f=cs),Mt.webgl_color_buffer_float&&(Tr.rgba32f=jn);var Wr=[];Object.keys(Tr).forEach(function(nn){var _r=Tr[nn];Wr[_r]=nn});var un=0,Jr={};function Qr(nn){this.id=un++,this.refCount=1,this.renderbuffer=nn,this.format=So,this.width=0,this.height=0,wr.profile&&(this.stats={size:0})}Qr.prototype.decRef=function(){--this.refCount<=0&&ln(this)};function ln(nn){var _r=nn.renderbuffer;K(_r,"must not double destroy renderbuffer"),je.bindRenderbuffer(Io,null),je.deleteRenderbuffer(_r),nn.renderbuffer=null,nn.refCount=0,delete Jr[nn.id],Lr.renderbufferCount--}function Sn(nn,_r){var xr=new Qr(je.createRenderbuffer());Jr[xr.id]=xr,Lr.renderbufferCount++;function Xr(Ir,ta){var qr=0,zr=0,Vr=So;if(typeof Ir=="object"&&Ir){var Kr=Ir;if("shape"in Kr){var Xn=Kr.shape;K(Array.isArray(Xn)&&Xn.length>=2,"invalid renderbuffer shape"),qr=Xn[0]|0,zr=Xn[1]|0}else"radius"in Kr&&(qr=zr=Kr.radius|0),"width"in Kr&&(qr=Kr.width|0),"height"in Kr&&(zr=Kr.height|0);"format"in Kr&&(K.parameter(Kr.format,Tr,"invalid renderbuffer format"),Vr=Tr[Kr.format])}else typeof Ir=="number"?(qr=Ir|0,typeof ta=="number"?zr=ta|0:zr=qr):Ir?K.raise("invalid arguments to renderbuffer constructor"):qr=zr=1;return K(qr>0&&zr>0&&qr<=Er.maxRenderbufferSize&&zr<=Er.maxRenderbufferSize,"invalid renderbuffer size"),qr===xr.width&&zr===xr.height&&Vr===xr.format?void 0:(Xr.width=xr.width=qr,Xr.height=xr.height=zr,xr.format=Vr,je.bindRenderbuffer(Io,xr.renderbuffer),je.renderbufferStorage(Io,Vr,qr,zr),K(je.getError()===0,"invalid render buffer format"),wr.profile&&(xr.stats.size=vo(xr.format,xr.width,xr.height)),Xr.format=Wr[xr.format],Xr)}function On(Ir,ta){var qr=Ir|0,zr=ta|0||qr;return qr===xr.width&&zr===xr.height||(K(qr>0&&zr>0&&qr<=Er.maxRenderbufferSize&&zr<=Er.maxRenderbufferSize,"invalid renderbuffer size"),Xr.width=xr.width=qr,Xr.height=xr.height=zr,je.bindRenderbuffer(Io,xr.renderbuffer),je.renderbufferStorage(Io,xr.format,qr,zr),K(je.getError()===0,"invalid render buffer format"),wr.profile&&(xr.stats.size=vo(xr.format,xr.width,xr.height))),Xr}return Xr(nn,_r),Xr.resize=On,Xr._reglType="renderbuffer",Xr._renderbuffer=xr,wr.profile&&(Xr.stats=xr.stats),Xr.destroy=function(){xr.decRef()},Xr}wr.profile&&(Lr.getTotalRenderbufferSize=function(){var nn=0;return Object.keys(Jr).forEach(function(_r){nn+=Jr[_r].stats.size}),nn});function pn(){Re(Jr).forEach(function(nn){nn.renderbuffer=je.createRenderbuffer(),je.bindRenderbuffer(Io,nn.renderbuffer),je.renderbufferStorage(Io,nn.format,nn.width,nn.height)}),je.bindRenderbuffer(Io,null)}return{create:Sn,clear:function(){Re(Jr).forEach(ln)},restore:pn}},Au=36160,ec=36161,$a=3553,no=34069,ll=36064,mu=36096,cl=36128,Cu=33306,Is=36053,Fc=36054,Gs=36055,yf=36057,Ul=36061,Bl=36193,Tc=5121,fs=5126,Bu=6407,zc=6408,Al=6402,Vu=[Bu,zc],tc=[];tc[zc]=4,tc[Bu]=3;var Gu=[];Gu[Tc]=1,Gu[fs]=4,Gu[Bl]=2;var Ds=32854,nf=32855,rc=36194,nc=33189,ac=36168,s=34041,a=35907,n=34836,l=34842,v=34843,O=[Ds,nf,rc,a,l,v,n],L={};L[Is]="complete",L[Fc]="incomplete attachment",L[yf]="incomplete dimensions",L[Gs]="incomplete, missing attachment",L[Ul]="unsupported";function j(ge,je,Mt,Er,Lr,wr){var Tr={cur:null,next:null,dirty:!1,setFBO:null},Wr=["rgba"],un=["rgba4","rgb565","rgb5 a1"];je.ext_srgb&&un.push("srgba"),je.ext_color_buffer_half_float&&un.push("rgba16f","rgb16f"),je.webgl_color_buffer_float&&un.push("rgba32f");var Jr=["uint8"];je.oes_texture_half_float&&Jr.push("half float","float16"),je.oes_texture_float&&Jr.push("float","float32");function Qr(cn,Hr,jr){this.target=cn,this.texture=Hr,this.renderbuffer=jr;var ma=0,pa=0;Hr?(ma=Hr.width,pa=Hr.height):jr&&(ma=jr.width,pa=jr.height),this.width=ma,this.height=pa}function ln(cn){cn&&(cn.texture&&cn.texture._texture.decRef(),cn.renderbuffer&&cn.renderbuffer._renderbuffer.decRef())}function Sn(cn,Hr,jr){if(!cn)return;if(cn.texture){var ma=cn.texture._texture,pa=Math.max(1,ma.width),Un=Math.max(1,ma.height);K(pa===Hr&&Un===jr,"inconsistent width/height for supplied texture"),ma.refCount+=1}else{var Ua=cn.renderbuffer._renderbuffer;K(Ua.width===Hr&&Ua.height===jr,"inconsistent width/height for renderbuffer"),Ua.refCount+=1}}function pn(cn,Hr){Hr&&(Hr.texture?ge.framebufferTexture2D(Au,cn,Hr.target,Hr.texture._texture.texture,0):ge.framebufferRenderbuffer(Au,cn,ec,Hr.renderbuffer._renderbuffer.renderbuffer))}function nn(cn){var Hr=$a,jr=null,ma=null,pa=cn;typeof cn=="object"&&(pa=cn.data,"target"in cn&&(Hr=cn.target|0)),K.type(pa,"function","invalid attachment data");var Un=pa._reglType;return Un==="texture2d"?(jr=pa,K(Hr===$a)):Un==="textureCube"?(jr=pa,K(Hr>=no&&Hr<no+6,"invalid cube map target")):Un==="renderbuffer"?(ma=pa,Hr=ec):K.raise("invalid regl object for attachment"),new Qr(Hr,jr,ma)}function _r(cn,Hr,jr,ma,pa){if(jr){var Un=Er.create2D({width:cn,height:Hr,format:ma,type:pa});return Un._texture.refCount=0,new Qr($a,Un,null)}else{var Ua=Lr.create({width:cn,height:Hr,format:ma});return Ua._renderbuffer.refCount=0,new Qr(ec,null,Ua)}}function xr(cn){return cn&&(cn.texture||cn.renderbuffer)}function Xr(cn,Hr,jr){cn&&(cn.texture?cn.texture.resize(Hr,jr):cn.renderbuffer&&cn.renderbuffer.resize(Hr,jr),cn.width=Hr,cn.height=jr)}var On=0,Ir={};function ta(){this.id=On++,Ir[this.id]=this,this.framebuffer=ge.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function qr(cn){cn.colorAttachments.forEach(ln),ln(cn.depthAttachment),ln(cn.stencilAttachment),ln(cn.depthStencilAttachment)}function zr(cn){var Hr=cn.framebuffer;K(Hr,"must not double destroy framebuffer"),ge.deleteFramebuffer(Hr),cn.framebuffer=null,wr.framebufferCount--,delete Ir[cn.id]}function Vr(cn){var Hr;ge.bindFramebuffer(Au,cn.framebuffer);var jr=cn.colorAttachments;for(Hr=0;Hr<jr.length;++Hr)pn(ll+Hr,jr[Hr]);for(Hr=jr.length;Hr<Mt.maxColorAttachments;++Hr)ge.framebufferTexture2D(Au,ll+Hr,$a,null,0);ge.framebufferTexture2D(Au,Cu,$a,null,0),ge.framebufferTexture2D(Au,mu,$a,null,0),ge.framebufferTexture2D(Au,cl,$a,null,0),pn(mu,cn.depthAttachment),pn(cl,cn.stencilAttachment),pn(Cu,cn.depthStencilAttachment);var ma=ge.checkFramebufferStatus(Au);!ge.isContextLost()&&ma!==Is&&K.raise("framebuffer configuration not supported, status = "+L[ma]),ge.bindFramebuffer(Au,Tr.next?Tr.next.framebuffer:null),Tr.cur=Tr.next,ge.getError()}function Kr(cn,Hr){var jr=new ta;wr.framebufferCount++;function ma(Un,Ua){var Ta;K(Tr.next!==jr,"can not update framebuffer which is currently in use");var Ba=0,hi=0,Fo=!0,Os=!0,ei=null,bo=!0,Ci="rgba",vs="uint8",zo=1,gs=null,Uo=null,Bo=null,Vo=!1;if(typeof Un=="number")Ba=Un|0,hi=Ua|0||Ba;else if(!Un)Ba=hi=1;else{K.type(Un,"object","invalid arguments for framebuffer");var aa=Un;if("shape"in aa){var ou=aa.shape;K(Array.isArray(ou)&&ou.length>=2,"invalid shape for framebuffer"),Ba=ou[0],hi=ou[1]}else"radius"in aa&&(Ba=hi=aa.radius),"width"in aa&&(Ba=aa.width),"height"in aa&&(hi=aa.height);("color"in aa||"colors"in aa)&&(ei=aa.color||aa.colors,Array.isArray(ei)&&K(ei.length===1||je.webgl_draw_buffers,"multiple render targets not supported")),ei||("colorCount"in aa&&(zo=aa.colorCount|0,K(zo>0,"invalid color buffer count")),"colorTexture"in aa&&(bo=!!aa.colorTexture,Ci="rgba4"),"colorType"in aa&&(vs=aa.colorType,bo?(K(je.oes_texture_float||!(vs==="float"||vs==="float32"),"you must enable OES_texture_float in order to use floating point framebuffer objects"),K(je.oes_texture_half_float||!(vs==="half float"||vs==="float16"),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):vs==="half float"||vs==="float16"?(K(je.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),Ci="rgba16f"):(vs==="float"||vs==="float32")&&(K(je.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),Ci="rgba32f"),K.oneOf(vs,Jr,"invalid color type")),"colorFormat"in aa&&(Ci=aa.colorFormat,Wr.indexOf(Ci)>=0?bo=!0:un.indexOf(Ci)>=0?bo=!1:bo?K.oneOf(aa.colorFormat,Wr,"invalid color format for texture"):K.oneOf(aa.colorFormat,un,"invalid color format for renderbuffer"))),("depthTexture"in aa||"depthStencilTexture"in aa)&&(Vo=!!(aa.depthTexture||aa.depthStencilTexture),K(!Vo||je.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in aa&&(typeof aa.depth=="boolean"?Fo=aa.depth:(gs=aa.depth,Os=!1)),"stencil"in aa&&(typeof aa.stencil=="boolean"?Os=aa.stencil:(Uo=aa.stencil,Fo=!1)),"depthStencil"in aa&&(typeof aa.depthStencil=="boolean"?Fo=Os=aa.depthStencil:(Bo=aa.depthStencil,Fo=!1,Os=!1))}var yi=null,An=null,Ra=null,Va=null;if(Array.isArray(ei))yi=ei.map(nn);else if(ei)yi=[nn(ei)];else for(yi=new Array(zo),Ta=0;Ta<zo;++Ta)yi[Ta]=_r(Ba,hi,bo,Ci,vs);K(je.webgl_draw_buffers||yi.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),K(yi.length<=Mt.maxColorAttachments,"too many color attachments, not supported"),Ba=Ba||yi[0].width,hi=hi||yi[0].height,gs?An=nn(gs):Fo&&!Os&&(An=_r(Ba,hi,Vo,"depth","uint32")),Uo?Ra=nn(Uo):Os&&!Fo&&(Ra=_r(Ba,hi,!1,"stencil","uint8")),Bo?Va=nn(Bo):!gs&&!Uo&&Os&&Fo&&(Va=_r(Ba,hi,Vo,"depth stencil","depth stencil")),K(!!gs+!!Uo+!!Bo<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var rs=null;for(Ta=0;Ta<yi.length;++Ta)if(Sn(yi[Ta],Ba,hi),K(!yi[Ta]||yi[Ta].texture&&Vu.indexOf(yi[Ta].texture._texture.format)>=0||yi[Ta].renderbuffer&&O.indexOf(yi[Ta].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+Ta+" is invalid"),yi[Ta]&&yi[Ta].texture){var w=tc[yi[Ta].texture._texture.format]*Gu[yi[Ta].texture._texture.type];rs===null?rs=w:K(rs===w,"all color attachments much have the same number of bits per pixel.")}return Sn(An,Ba,hi),K(!An||An.texture&&An.texture._texture.format===Al||An.renderbuffer&&An.renderbuffer._renderbuffer.format===nc,"invalid depth attachment for framebuffer object"),Sn(Ra,Ba,hi),K(!Ra||Ra.renderbuffer&&Ra.renderbuffer._renderbuffer.format===ac,"invalid stencil attachment for framebuffer object"),Sn(Va,Ba,hi),K(!Va||Va.texture&&Va.texture._texture.format===s||Va.renderbuffer&&Va.renderbuffer._renderbuffer.format===s,"invalid depth-stencil attachment for framebuffer object"),qr(jr),jr.width=Ba,jr.height=hi,jr.colorAttachments=yi,jr.depthAttachment=An,jr.stencilAttachment=Ra,jr.depthStencilAttachment=Va,ma.color=yi.map(xr),ma.depth=xr(An),ma.stencil=xr(Ra),ma.depthStencil=xr(Va),ma.width=jr.width,ma.height=jr.height,Vr(jr),ma}function pa(Un,Ua){K(Tr.next!==jr,"can not resize a framebuffer which is currently in use");var Ta=Math.max(Un|0,1),Ba=Math.max(Ua|0||Ta,1);if(Ta===jr.width&&Ba===jr.height)return ma;for(var hi=jr.colorAttachments,Fo=0;Fo<hi.length;++Fo)Xr(hi[Fo],Ta,Ba);return Xr(jr.depthAttachment,Ta,Ba),Xr(jr.stencilAttachment,Ta,Ba),Xr(jr.depthStencilAttachment,Ta,Ba),jr.width=ma.width=Ta,jr.height=ma.height=Ba,Vr(jr),ma}return ma(cn,Hr),p(ma,{resize:pa,_reglType:"framebuffer",_framebuffer:jr,destroy:function(){zr(jr),qr(jr)},use:function(Ua){Tr.setFBO({framebuffer:ma},Ua)}})}function Xn(cn){var Hr=Array(6);function jr(pa){var Un;K(Hr.indexOf(Tr.next)<0,"can not update framebuffer which is currently in use");var Ua={color:null},Ta=0,Ba=null,hi="rgba",Fo="uint8",Os=1;if(typeof pa=="number")Ta=pa|0;else if(!pa)Ta=1;else{K.type(pa,"object","invalid arguments for framebuffer");var ei=pa;if("shape"in ei){var bo=ei.shape;K(Array.isArray(bo)&&bo.length>=2,"invalid shape for framebuffer"),K(bo[0]===bo[1],"cube framebuffer must be square"),Ta=bo[0]}else"radius"in ei&&(Ta=ei.radius|0),"width"in ei?(Ta=ei.width|0,"height"in ei&&K(ei.height===Ta,"must be square")):"height"in ei&&(Ta=ei.height|0);("color"in ei||"colors"in ei)&&(Ba=ei.color||ei.colors,Array.isArray(Ba)&&K(Ba.length===1||je.webgl_draw_buffers,"multiple render targets not supported")),Ba||("colorCount"in ei&&(Os=ei.colorCount|0,K(Os>0,"invalid color buffer count")),"colorType"in ei&&(K.oneOf(ei.colorType,Jr,"invalid color type"),Fo=ei.colorType),"colorFormat"in ei&&(hi=ei.colorFormat,K.oneOf(ei.colorFormat,Wr,"invalid color format for texture"))),"depth"in ei&&(Ua.depth=ei.depth),"stencil"in ei&&(Ua.stencil=ei.stencil),"depthStencil"in ei&&(Ua.depthStencil=ei.depthStencil)}var Ci;if(Ba)if(Array.isArray(Ba))for(Ci=[],Un=0;Un<Ba.length;++Un)Ci[Un]=Ba[Un];else Ci=[Ba];else{Ci=Array(Os);var vs={radius:Ta,format:hi,type:Fo};for(Un=0;Un<Os;++Un)Ci[Un]=Er.createCube(vs)}for(Ua.color=Array(Ci.length),Un=0;Un<Ci.length;++Un){var zo=Ci[Un];K(typeof zo=="function"&&zo._reglType==="textureCube","invalid cube map"),Ta=Ta||zo.width,K(zo.width===Ta&&zo.height===Ta,"invalid cube map shape"),Ua.color[Un]={target:no,data:Ci[Un]}}for(Un=0;Un<6;++Un){for(var gs=0;gs<Ci.length;++gs)Ua.color[gs].target=no+Un;Un>0&&(Ua.depth=Hr[0].depth,Ua.stencil=Hr[0].stencil,Ua.depthStencil=Hr[0].depthStencil),Hr[Un]?Hr[Un](Ua):Hr[Un]=Kr(Ua)}return p(jr,{width:Ta,height:Ta,color:Ci})}function ma(pa){var Un,Ua=pa|0;if(K(Ua>0&&Ua<=Mt.maxCubeMapSize,"invalid radius for cube fbo"),Ua===jr.width)return jr;var Ta=jr.color;for(Un=0;Un<Ta.length;++Un)Ta[Un].resize(Ua);for(Un=0;Un<6;++Un)Hr[Un].resize(Ua);return jr.width=jr.height=Ua,jr}return jr(cn),p(jr,{faces:Hr,resize:ma,_reglType:"framebufferCube",destroy:function(){Hr.forEach(function(Un){Un.destroy()})}})}function na(){Tr.cur=null,Tr.next=null,Tr.dirty=!0,Re(Ir).forEach(function(cn){cn.framebuffer=ge.createFramebuffer(),Vr(cn)})}return p(Tr,{getFramebuffer:function(Hr){if(typeof Hr=="function"&&Hr._reglType==="framebuffer"){var jr=Hr._framebuffer;if(jr instanceof ta)return jr}return null},create:Kr,createCube:Xn,clear:function(){Re(Ir).forEach(zr)},restore:na})}var ue=5126,Ee=34962;function $e(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=ue,this.offset=0,this.stride=0,this.divisor=0}function nt(ge,je,Mt,Er,Lr){for(var wr=Mt.maxAttributes,Tr=new Array(wr),Wr=0;Wr<wr;++Wr)Tr[Wr]=new $e;var un=0,Jr={},Qr={Record:$e,scope:{},state:Tr,currentVAO:null,targetVAO:null,restore:Sn()?Ir:function(){},createVAO:ta,getVAO:nn,destroyBuffer:ln,setVAO:Sn()?_r:xr,clear:Sn()?Xr:function(){}};function ln(qr){for(var zr=0;zr<Tr.length;++zr){var Vr=Tr[zr];Vr.buffer===qr&&(ge.disableVertexAttribArray(zr),Vr.buffer=null)}}function Sn(){return je.oes_vertex_array_object}function pn(){return je.angle_instanced_arrays}function nn(qr){return typeof qr=="function"&&qr._vao?qr._vao:null}function _r(qr){if(qr===Qr.currentVAO)return;var zr=Sn();qr?zr.bindVertexArrayOES(qr.vao):zr.bindVertexArrayOES(null),Qr.currentVAO=qr}function xr(qr){if(qr===Qr.currentVAO)return;if(qr)qr.bindAttrs();else for(var zr=pn(),Vr=0;Vr<Tr.length;++Vr){var Kr=Tr[Vr];Kr.buffer?(ge.enableVertexAttribArray(Vr),ge.vertexAttribPointer(Vr,Kr.size,Kr.type,Kr.normalized,Kr.stride,Kr.offfset),zr&&Kr.divisor&&zr.vertexAttribDivisorANGLE(Vr,Kr.divisor)):(ge.disableVertexAttribArray(Vr),ge.vertexAttrib4f(Vr,Kr.x,Kr.y,Kr.z,Kr.w))}Qr.currentVAO=qr}function Xr(){Re(Jr).forEach(function(qr){qr.destroy()})}function On(){this.id=++un,this.attributes=[];var qr=Sn();qr?this.vao=qr.createVertexArrayOES():this.vao=null,Jr[this.id]=this,this.buffers=[]}On.prototype.bindAttrs=function(){for(var qr=pn(),zr=this.attributes,Vr=0;Vr<zr.length;++Vr){var Kr=zr[Vr];Kr.buffer?(ge.enableVertexAttribArray(Vr),ge.bindBuffer(Ee,Kr.buffer.buffer),ge.vertexAttribPointer(Vr,Kr.size,Kr.type,Kr.normalized,Kr.stride,Kr.offset),qr&&Kr.divisor&&qr.vertexAttribDivisorANGLE(Vr,Kr.divisor)):(ge.disableVertexAttribArray(Vr),ge.vertexAttrib4f(Vr,Kr.x,Kr.y,Kr.z,Kr.w))}for(var Xn=zr.length;Xn<wr;++Xn)ge.disableVertexAttribArray(Xn)},On.prototype.refresh=function(){var qr=Sn();qr&&(qr.bindVertexArrayOES(this.vao),this.bindAttrs(),Qr.currentVAO=this)},On.prototype.destroy=function(){if(this.vao){var qr=Sn();this===Qr.currentVAO&&(Qr.currentVAO=null,qr.bindVertexArrayOES(null)),qr.deleteVertexArrayOES(this.vao),this.vao=null}Jr[this.id]&&(delete Jr[this.id],Er.vaoCount-=1)};function Ir(){var qr=Sn();qr&&Re(Jr).forEach(function(zr){zr.refresh()})}function ta(qr){var zr=new On;Er.vaoCount+=1;function Vr(Kr){K(Array.isArray(Kr),"arguments to vertex array constructor must be an array"),K(Kr.length<wr,"too many attributes"),K(Kr.length>0,"must specify at least one attribute");var Xn={},na=zr.attributes;na.length=Kr.length;for(var cn=0;cn<Kr.length;++cn){var Hr=Kr[cn],jr=na[cn]=new $e,ma=Hr.data||Hr;if(Array.isArray(ma)||E(ma)||Vt(ma)){var pa;zr.buffers[cn]&&(pa=zr.buffers[cn],E(ma)&&pa._buffer.byteLength>=ma.byteLength?pa.subdata(ma):(pa.destroy(),zr.buffers[cn]=null)),zr.buffers[cn]||(pa=zr.buffers[cn]=Lr.create(Hr,Ee,!1,!0)),jr.buffer=Lr.getBuffer(pa),jr.size=jr.buffer.dimension|0,jr.normalized=!1,jr.type=jr.buffer.dtype,jr.offset=0,jr.stride=0,jr.divisor=0,jr.state=1,Xn[cn]=1}else Lr.getBuffer(Hr)?(jr.buffer=Lr.getBuffer(Hr),jr.size=jr.buffer.dimension|0,jr.normalized=!1,jr.type=jr.buffer.dtype,jr.offset=0,jr.stride=0,jr.divisor=0,jr.state=1):Lr.getBuffer(Hr.buffer)?(jr.buffer=Lr.getBuffer(Hr.buffer),jr.size=(+Hr.size||jr.buffer.dimension)|0,jr.normalized=!!Hr.normalized||!1,"type"in Hr?(K.parameter(Hr.type,_o,"invalid buffer type"),jr.type=_o[Hr.type]):jr.type=jr.buffer.dtype,jr.offset=(Hr.offset||0)|0,jr.stride=(Hr.stride||0)|0,jr.divisor=(Hr.divisor||0)|0,jr.state=1,K(jr.size>=1&&jr.size<=4,"size must be between 1 and 4"),K(jr.offset>=0,"invalid offset"),K(jr.stride>=0&&jr.stride<=255,"stride must be between 0 and 255"),K(jr.divisor>=0,"divisor must be positive"),K(!jr.divisor||!!je.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in Hr?(K(cn>0,"first attribute must not be a constant"),jr.x=+Hr.x||0,jr.y=+Hr.y||0,jr.z=+Hr.z||0,jr.w=+Hr.w||0,jr.state=2):K(!1,"invalid attribute spec for location "+cn)}for(var Un=0;Un<zr.buffers.length;++Un)!Xn[Un]&&zr.buffers[Un]&&(zr.buffers[Un].destroy(),zr.buffers[Un]=null);return zr.refresh(),Vr}return Vr.destroy=function(){for(var Kr=0;Kr<zr.buffers.length;++Kr)zr.buffers[Kr]&&zr.buffers[Kr].destroy();zr.buffers.length=0,zr.destroy()},Vr._vao=zr,Vr._reglType="vao",Vr(qr)}return Qr}var at=35632,Ft=35633,Nt=35718,Jt=35721;function jt(ge,je,Mt,Er){var Lr={},wr={};function Tr(_r,xr,Xr,On){this.name=_r,this.id=xr,this.location=Xr,this.info=On}function Wr(_r,xr){for(var Xr=0;Xr<_r.length;++Xr)if(_r[Xr].id===xr.id){_r[Xr].location=xr.location;return}_r.push(xr)}function un(_r,xr,Xr){var On=_r===at?Lr:wr,Ir=On[xr];if(!Ir){var ta=je.str(xr);Ir=ge.createShader(_r),ge.shaderSource(Ir,ta),ge.compileShader(Ir),K.shaderError(ge,Ir,ta,_r,Xr),On[xr]=Ir}return Ir}var Jr={},Qr=[],ln=0;function Sn(_r,xr){this.id=ln++,this.fragId=_r,this.vertId=xr,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,Er.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function pn(_r,xr,Xr){var On,Ir,ta=un(at,_r.fragId),qr=un(Ft,_r.vertId),zr=_r.program=ge.createProgram();if(ge.attachShader(zr,ta),ge.attachShader(zr,qr),Xr)for(On=0;On<Xr.length;++On){var Vr=Xr[On];ge.bindAttribLocation(zr,Vr[0],Vr[1])}ge.linkProgram(zr),K.linkError(ge,zr,je.str(_r.fragId),je.str(_r.vertId),xr);var Kr=ge.getProgramParameter(zr,Nt);Er.profile&&(_r.stats.uniformsCount=Kr);var Xn=_r.uniforms;for(On=0;On<Kr;++On)if(Ir=ge.getActiveUniform(zr,On),Ir)if(Ir.size>1)for(var na=0;na<Ir.size;++na){var cn=Ir.name.replace("[0]","["+na+"]");Wr(Xn,new Tr(cn,je.id(cn),ge.getUniformLocation(zr,cn),Ir))}else Wr(Xn,new Tr(Ir.name,je.id(Ir.name),ge.getUniformLocation(zr,Ir.name),Ir));var Hr=ge.getProgramParameter(zr,Jt);Er.profile&&(_r.stats.attributesCount=Hr);var jr=_r.attributes;for(On=0;On<Hr;++On)Ir=ge.getActiveAttrib(zr,On),Ir&&Wr(jr,new Tr(Ir.name,je.id(Ir.name),ge.getAttribLocation(zr,Ir.name),Ir))}Er.profile&&(Mt.getMaxUniformsCount=function(){var _r=0;return Qr.forEach(function(xr){xr.stats.uniformsCount>_r&&(_r=xr.stats.uniformsCount)}),_r},Mt.getMaxAttributesCount=function(){var _r=0;return Qr.forEach(function(xr){xr.stats.attributesCount>_r&&(_r=xr.stats.attributesCount)}),_r});function nn(){Lr={},wr={};for(var _r=0;_r<Qr.length;++_r)pn(Qr[_r],null,Qr[_r].attributes.map(function(xr){return[xr.location,xr.name]}))}return{clear:function(){var xr=ge.deleteShader.bind(ge);Re(Lr).forEach(xr),Lr={},Re(wr).forEach(xr),wr={},Qr.forEach(function(Xr){ge.deleteProgram(Xr.program)}),Qr.length=0,Jr={},Mt.shaderCount=0},program:function(xr,Xr,On,Ir){K.command(xr>=0,"missing vertex shader",On),K.command(Xr>=0,"missing fragment shader",On);var ta=Jr[Xr];ta||(ta=Jr[Xr]={});var qr=ta[xr];if(qr&&(qr.refCount++,!Ir))return qr;var zr=new Sn(Xr,xr);return Mt.shaderCount++,pn(zr,On,Ir),qr||(ta[xr]=zr),Qr.push(zr),p(zr,{destroy:function(){if(zr.refCount--,zr.refCount<=0){ge.deleteProgram(zr.program);var Kr=Qr.indexOf(zr);Qr.splice(Kr,1),Mt.shaderCount--}ta[zr.vertId].refCount<=0&&(ge.deleteShader(wr[zr.vertId]),delete wr[zr.vertId],delete Jr[zr.fragId][zr.vertId]),Object.keys(Jr[zr.fragId]).length||(ge.deleteShader(Lr[zr.fragId]),delete Lr[zr.fragId],delete Jr[zr.fragId])}})},restore:nn,shader:un,frag:-1,vert:-1}}var Gt=6408,ar=5121,nr=3333,Rr=5126;function gr(ge,je,Mt,Er,Lr,wr,Tr){function Wr(Qr){var ln;je.next===null?(K(Lr.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),ln=ar):(K(je.next.colorAttachments[0].texture!==null,"You cannot read from a renderbuffer"),ln=je.next.colorAttachments[0].texture._texture.type,wr.oes_texture_float?(K(ln===ar||ln===Rr,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),ln===Rr&&K(Tr.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):K(ln===ar,"Reading from a framebuffer is only allowed for the type 'uint8'"));var Sn=0,pn=0,nn=Er.framebufferWidth,_r=Er.framebufferHeight,xr=null;E(Qr)?xr=Qr:Qr&&(K.type(Qr,"object","invalid arguments to regl.read()"),Sn=Qr.x|0,pn=Qr.y|0,K(Sn>=0&&Sn<Er.framebufferWidth,"invalid x offset for regl.read"),K(pn>=0&&pn<Er.framebufferHeight,"invalid y offset for regl.read"),nn=(Qr.width||Er.framebufferWidth-Sn)|0,_r=(Qr.height||Er.framebufferHeight-pn)|0,xr=Qr.data||null),xr&&(ln===ar?K(xr instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):ln===Rr&&K(xr instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),K(nn>0&&nn+Sn<=Er.framebufferWidth,"invalid width for read pixels"),K(_r>0&&_r+pn<=Er.framebufferHeight,"invalid height for read pixels"),Mt();var Xr=nn*_r*4;return xr||(ln===ar?xr=new Uint8Array(Xr):ln===Rr&&(xr=xr||new Float32Array(Xr))),K.isTypedArray(xr,"data buffer for regl.read() must be a typedarray"),K(xr.byteLength>=Xr,"data buffer for regl.read() too small"),ge.pixelStorei(nr,4),ge.readPixels(Sn,pn,nn,_r,Gt,ln,xr),xr}function un(Qr){var ln;return je.setFBO({framebuffer:Qr.framebuffer},function(){ln=Wr(Qr)}),ln}function Jr(Qr){return!Qr||!("framebuffer"in Qr)?Wr(Qr):un(Qr)}return Jr}function Ar(ge){return Array.prototype.slice.call(ge)}function Cr(ge){return Ar(ge).join("")}function an(){var ge=0,je=[],Mt=[];function Er(ln){for(var Sn=0;Sn<Mt.length;++Sn)if(Mt[Sn]===ln)return je[Sn];var pn="g"+ge++;return je.push(pn),Mt.push(ln),pn}function Lr(){var ln=[];function Sn(){ln.push.apply(ln,Ar(arguments))}var pn=[];function nn(){var _r="v"+ge++;return pn.push(_r),arguments.length>0&&(ln.push(_r,"="),ln.push.apply(ln,Ar(arguments)),ln.push(";")),_r}return p(Sn,{def:nn,toString:function(){return Cr([pn.length>0?"var "+pn.join(",")+";":"",Cr(ln)])}})}function wr(){var ln=Lr(),Sn=Lr(),pn=ln.toString,nn=Sn.toString;function _r(xr,Xr){Sn(xr,Xr,"=",ln.def(xr,Xr),";")}return p(function(){ln.apply(ln,Ar(arguments))},{def:ln.def,entry:ln,exit:Sn,save:_r,set:function(Xr,On,Ir){_r(Xr,On),ln(Xr,On,"=",Ir,";")},toString:function(){return pn()+nn()}})}function Tr(){var ln=Cr(arguments),Sn=wr(),pn=wr(),nn=Sn.toString,_r=pn.toString;return p(Sn,{then:function(){return Sn.apply(Sn,Ar(arguments)),this},else:function(){return pn.apply(pn,Ar(arguments)),this},toString:function(){var Xr=_r();return Xr&&(Xr="else{"+Xr+"}"),Cr(["if(",ln,"){",nn(),"}",Xr])}})}var Wr=Lr(),un={};function Jr(ln,Sn){var pn=[];function nn(){var Ir="a"+pn.length;return pn.push(Ir),Ir}Sn=Sn||0;for(var _r=0;_r<Sn;++_r)nn();var xr=wr(),Xr=xr.toString,On=un[ln]=p(xr,{arg:nn,toString:function(){return Cr(["function(",pn.join(),"){",Xr(),"}"])}});return On}function Qr(){var ln=['"use strict";',Wr,"return {"];Object.keys(un).forEach(function(nn){ln.push('"',nn,'":',un[nn].toString(),",")}),ln.push("}");var Sn=Cr(ln).replace(/;/g,`;
`).replace(/}/g,`}
`).replace(/{/g,`{
`),pn=Function.apply(null,je.concat(Sn));return pn.apply(null,Mt)}return{global:Wr,link:Er,block:Lr,proc:Jr,scope:wr,cond:Tr,compile:Qr}}var Yr="xyzw".split(""),vn=5121,Pn=1,qn=2,sa=0,Aa=1,Wa=2,_n=3,ua=4,xa=5,Zn=6,Ca="dither",ia="blend.enable",La="blend.color",za="blend.equation",Hi="blend.func",Ai="depth.enable",Ni="depth.func",Ei="depth.range",Bi="depth.mask",es="colorMask",ts="cull.enable",vu="cull.face",wu="frontFace",hs="lineWidth",Hs="polygonOffset.enable",Ou="polygonOffset.offset",ic="sample.alpha",tu="sample.enable",Hu="sample.coverage",oc="stencil.enable",ru="stencil.mask",Mu="stencil.func",ds="stencil.opFront",ao="stencil.opBack",Zu="scissor.enable",Vl="scissor.box",ps="viewport",No="profile",ko="framebuffer",Ko="vert",Ao="frag",uo="elements",Ns="primitive",nu="count",Gl="offset",Uc="instances",fl="vao",sc="Width",hl="Height",ks=ko+sc,go=ko+hl,_c=ps+sc,ms=ps+hl,af="drawingBuffer",Sf=af+sc,Af=af+hl,Sc=[Hi,za,Mu,ds,ao,Hu,ps,Vl,Ou],Wu=34962,bf=34963,of=35632,Cf=35633,Pu=3553,uc=34067,If=2884,Bc=3042,Ac=3024,$f=2960,Jf=2929,Qf=3089,qf=32823,wf=32926,eh=32928,Hl=5126,sf=35664,io=35665,lc=35666,xf=5124,Cc=35667,au=35668,Cl=35669,Ef=35670,Df=35671,Vc=35672,uf=35673,Gc=35674,dl=35675,ne=35676,se=35678,N=35680,G=4,Ce=1028,ft=1029,Yt=2304,sr=2305,or=32775,Dr=32776,sn=519,Hn=7680,ea=0,la=1,ti=32774,ja=513,Ti=36160,Qa=36064,Vi={"0":0,"1":1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},Co=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],yo={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},Zi={"0":0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},jo={frag:of,vert:Cf},qa={cw:Yt,ccw:sr};function lo(ge){return Array.isArray(ge)||E(ge)||Vt(ge)}function iu(ge){return ge.sort(function(je,Mt){return je===ps?-1:Mt===ps?1:je<Mt?-1:1})}function _i(ge,je,Mt,Er){this.thisDep=ge,this.contextDep=je,this.propDep=Mt,this.append=Er}function ki(ge){return ge&&!(ge.thisDep||ge.contextDep||ge.propDep)}function Ea(ge){return new _i(!1,!1,!1,ge)}function wo(ge,je){var Mt=ge.type;if(Mt===sa){var Er=ge.data.length;return new _i(!0,Er>=1,Er>=2,je)}else if(Mt===ua){var Lr=ge.data;return new _i(Lr.thisDep,Lr.contextDep,Lr.propDep,je)}else{if(Mt===xa)return new _i(!1,!1,!1,je);if(Mt===Zn){for(var wr=!1,Tr=!1,Wr=!1,un=0;un<ge.data.length;++un){var Jr=ge.data[un];if(Jr.type===Aa)Wr=!0;else if(Jr.type===Wa)Tr=!0;else if(Jr.type===_n)wr=!0;else if(Jr.type===sa){wr=!0;var Qr=Jr.data;Qr>=1&&(Tr=!0),Qr>=2&&(Wr=!0)}else Jr.type===ua&&(wr=wr||Jr.data.thisDep,Tr=Tr||Jr.data.contextDep,Wr=Wr||Jr.data.propDep)}return new _i(wr,Tr,Wr,je)}else return new _i(Mt===_n,Mt===Wa,Mt===Aa,je)}}var cc=new _i(!1,!1,!1,function(){});function Nf(ge,je,Mt,Er,Lr,wr,Tr,Wr,un,Jr,Qr,ln,Sn,pn,nn){var _r=Jr.Record,xr={add:32774,subtract:32778,"reverse subtract":32779};Mt.ext_blend_minmax&&(xr.min=or,xr.max=Dr);var Xr=Mt.angle_instanced_arrays,On=Mt.webgl_draw_buffers,Ir={dirty:!0,profile:nn.profile},ta={},qr=[],zr={},Vr={};function Kr(B){return B.replace(".","_")}function Xn(B,k,Q){var We=Kr(B);qr.push(B),ta[We]=Ir[We]=!!Q,zr[We]=k}function na(B,k,Q){var We=Kr(B);qr.push(B),Array.isArray(Q)?(Ir[We]=Q.slice(),ta[We]=Q.slice()):Ir[We]=ta[We]=Q,Vr[We]=k}Xn(Ca,Ac),Xn(ia,Bc),na(La,"blendColor",[0,0,0,0]),na(za,"blendEquationSeparate",[ti,ti]),na(Hi,"blendFuncSeparate",[la,ea,la,ea]),Xn(Ai,Jf,!0),na(Ni,"depthFunc",ja),na(Ei,"depthRange",[0,1]),na(Bi,"depthMask",!0),na(es,es,[!0,!0,!0,!0]),Xn(ts,If),na(vu,"cullFace",ft),na(wu,wu,sr),na(hs,hs,1),Xn(Hs,qf),na(Ou,"polygonOffset",[0,0]),Xn(ic,wf),Xn(tu,eh),na(Hu,"sampleCoverage",[1,!1]),Xn(oc,$f),na(ru,"stencilMask",-1),na(Mu,"stencilFunc",[sn,0,-1]),na(ds,"stencilOpSeparate",[Ce,Hn,Hn,Hn]),na(ao,"stencilOpSeparate",[ft,Hn,Hn,Hn]),Xn(Zu,Qf),na(Vl,"scissor",[0,0,ge.drawingBufferWidth,ge.drawingBufferHeight]),na(ps,ps,[0,0,ge.drawingBufferWidth,ge.drawingBufferHeight]);var cn={gl:ge,context:Sn,strings:je,next:ta,current:Ir,draw:ln,elements:wr,buffer:Lr,shader:Qr,attributes:Jr.state,vao:Jr,uniforms:un,framebuffer:Wr,extensions:Mt,timer:pn,isBufferArgs:lo},Hr={primTypes:gi,compareFuncs:yo,blendFuncs:Vi,blendEquations:xr,stencilOps:Zi,glTypes:_o,orientationType:qa};K.optional(function(){cn.isArrayLike=$i}),On&&(Hr.backBuffer=[ft],Hr.drawBuffer=W(Er.maxDrawbuffers,function(B){return B===0?[0]:W(B,function(k){return Qa+k})}));var jr=0;function ma(){var B=an(),k=B.link,Q=B.global;B.id=jr++,B.batchId="0";var We=k(cn),rt=B.shared={props:"a0"};Object.keys(cn).forEach(function(vt){rt[vt]=Q.def(We,".",vt)}),K.optional(function(){B.CHECK=k(K),B.commandStr=K.guessCommand(),B.command=k(B.commandStr),B.assert=function(vt,De,Zt){vt("if(!(",De,"))",this.CHECK,".commandRaise(",k(Zt),",",this.command,");")},Hr.invalidBlendCombinations=Co});var Pe=B.next={},Qe=B.current={};Object.keys(Vr).forEach(function(vt){Array.isArray(Ir[vt])&&(Pe[vt]=Q.def(rt.next,".",vt),Qe[vt]=Q.def(rt.current,".",vt))});var Tt=B.constants={};Object.keys(Hr).forEach(function(vt){Tt[vt]=Q.def(JSON.stringify(Hr[vt]))}),B.invoke=function(vt,De){switch(De.type){case sa:var Zt=["this",rt.context,rt.props,B.batchId];return vt.def(k(De.data),".call(",Zt.slice(0,Math.max(De.data.length+1,4)),")");case Aa:return vt.def(rt.props,De.data);case Wa:return vt.def(rt.context,De.data);case _n:return vt.def("this",De.data);case ua:return De.data.append(B,vt),De.data.ref;case xa:return De.data.toString();case Zn:return De.data.map(function(Kt){return B.invoke(vt,Kt)})}},B.attribCache={};var ke={};return B.scopeAttrib=function(vt){var De=je.id(vt);if(De in ke)return ke[De];var Zt=Jr.scope[De];Zt||(Zt=Jr.scope[De]=new _r);var Kt=ke[De]=k(Zt);return Kt},B}function pa(B){var k=B.static,Q=B.dynamic,We;if(No in k){var rt=!!k[No];We=Ea(function(Qe,Tt){return rt}),We.enable=rt}else if(No in Q){var Pe=Q[No];We=wo(Pe,function(Qe,Tt){return Qe.invoke(Tt,Pe)})}return We}function Un(B,k){var Q=B.static,We=B.dynamic;if(ko in Q){var rt=Q[ko];return rt?(rt=Wr.getFramebuffer(rt),K.command(rt,"invalid framebuffer object"),Ea(function(Qe,Tt){var ke=Qe.link(rt),vt=Qe.shared;Tt.set(vt.framebuffer,".next",ke);var De=vt.context;return Tt.set(De,"."+ks,ke+".width"),Tt.set(De,"."+go,ke+".height"),ke})):Ea(function(Qe,Tt){var ke=Qe.shared;Tt.set(ke.framebuffer,".next","null");var vt=ke.context;return Tt.set(vt,"."+ks,vt+"."+Sf),Tt.set(vt,"."+go,vt+"."+Af),"null"})}else if(ko in We){var Pe=We[ko];return wo(Pe,function(Qe,Tt){var ke=Qe.invoke(Tt,Pe),vt=Qe.shared,De=vt.framebuffer,Zt=Tt.def(De,".getFramebuffer(",ke,")");K.optional(function(){Qe.assert(Tt,"!"+ke+"||"+Zt,"invalid framebuffer object")}),Tt.set(De,".next",Zt);var Kt=vt.context;return Tt.set(Kt,"."+ks,Zt+"?"+Zt+".width:"+Kt+"."+Sf),Tt.set(Kt,"."+go,Zt+"?"+Zt+".height:"+Kt+"."+Af),Zt})}else return null}function Ua(B,k,Q){var We=B.static,rt=B.dynamic;function Pe(ke){if(ke in We){var vt=We[ke];K.commandType(vt,"object","invalid "+ke,Q.commandStr);var De=!0,Zt=vt.x|0,Kt=vt.y|0,dr,rr;return"width"in vt?(dr=vt.width|0,K.command(dr>=0,"invalid "+ke,Q.commandStr)):De=!1,"height"in vt?(rr=vt.height|0,K.command(rr>=0,"invalid "+ke,Q.commandStr)):De=!1,new _i(!De&&k&&k.thisDep,!De&&k&&k.contextDep,!De&&k&&k.propDep,function($r,Bn){var on=$r.shared.context,Dn=dr;"width"in vt||(Dn=Bn.def(on,".",ks,"-",Zt));var ca=rr;return"height"in vt||(ca=Bn.def(on,".",go,"-",Kt)),[Zt,Kt,Dn,ca]})}else if(ke in rt){var mr=rt[ke],Or=wo(mr,function($r,Bn){var on=$r.invoke(Bn,mr);K.optional(function(){$r.assert(Bn,on+"&&typeof "+on+'==="object"',"invalid "+ke)});var Dn=$r.shared.context,ca=Bn.def(on,".x|0"),Na=Bn.def(on,".y|0"),ri=Bn.def('"width" in ',on,"?",on,".width|0:","(",Dn,".",ks,"-",ca,")"),co=Bn.def('"height" in ',on,"?",on,".height|0:","(",Dn,".",go,"-",Na,")");return K.optional(function(){$r.assert(Bn,ri+">=0&&"+co+">=0","invalid "+ke)}),[ca,Na,ri,co]});return k&&(Or.thisDep=Or.thisDep||k.thisDep,Or.contextDep=Or.contextDep||k.contextDep,Or.propDep=Or.propDep||k.propDep),Or}else return k?new _i(k.thisDep,k.contextDep,k.propDep,function($r,Bn){var on=$r.shared.context;return[0,0,Bn.def(on,".",ks),Bn.def(on,".",go)]}):null}var Qe=Pe(ps);if(Qe){var Tt=Qe;Qe=new _i(Qe.thisDep,Qe.contextDep,Qe.propDep,function(ke,vt){var De=Tt.append(ke,vt),Zt=ke.shared.context;return vt.set(Zt,"."+_c,De[2]),vt.set(Zt,"."+ms,De[3]),De})}return{viewport:Qe,scissor_box:Pe(Vl)}}function Ta(B,k){var Q=B.static,We=typeof Q[Ao]=="string"&&typeof Q[Ko]=="string";if(We){if(Object.keys(k.dynamic).length>0)return null;var rt=k.static,Pe=Object.keys(rt);if(Pe.length>0&&typeof rt[Pe[0]]=="number"){for(var Qe=[],Tt=0;Tt<Pe.length;++Tt)K(typeof rt[Pe[Tt]]=="number","must specify all vertex attribute locations when using vaos"),Qe.push([rt[Pe[Tt]]|0,Pe[Tt]]);return Qe}}return null}function Ba(B,k,Q){var We=B.static,rt=B.dynamic;function Pe(De){if(De in We){var Zt=je.id(We[De]);K.optional(function(){Qr.shader(jo[De],Zt,K.guessCommand())});var Kt=Ea(function(){return Zt});return Kt.id=Zt,Kt}else if(De in rt){var dr=rt[De];return wo(dr,function(rr,mr){var Or=rr.invoke(mr,dr),$r=mr.def(rr.shared.strings,".id(",Or,")");return K.optional(function(){mr(rr.shared.shader,".shader(",jo[De],",",$r,",",rr.command,");")}),$r})}return null}var Qe=Pe(Ao),Tt=Pe(Ko),ke=null,vt;return ki(Qe)&&ki(Tt)?(ke=Qr.program(Tt.id,Qe.id,null,Q),vt=Ea(function(De,Zt){return De.link(ke)})):vt=new _i(Qe&&Qe.thisDep||Tt&&Tt.thisDep,Qe&&Qe.contextDep||Tt&&Tt.contextDep,Qe&&Qe.propDep||Tt&&Tt.propDep,function(De,Zt){var Kt=De.shared.shader,dr;Qe?dr=Qe.append(De,Zt):dr=Zt.def(Kt,".",Ao);var rr;Tt?rr=Tt.append(De,Zt):rr=Zt.def(Kt,".",Ko);var mr=Kt+".program("+rr+","+dr;return K.optional(function(){mr+=","+De.command}),Zt.def(mr+")")}),{frag:Qe,vert:Tt,progVar:vt,program:ke}}function hi(B,k){var Q=B.static,We=B.dynamic;function rt(){if(uo in Q){var De=Q[uo];lo(De)?De=wr.getElements(wr.create(De,!0)):De&&(De=wr.getElements(De),K.command(De,"invalid elements",k.commandStr));var Zt=Ea(function(dr,rr){if(De){var mr=dr.link(De);return dr.ELEMENTS=mr,mr}return dr.ELEMENTS=null,null});return Zt.value=De,Zt}else if(uo in We){var Kt=We[uo];return wo(Kt,function(dr,rr){var mr=dr.shared,Or=mr.isBufferArgs,$r=mr.elements,Bn=dr.invoke(rr,Kt),on=rr.def("null"),Dn=rr.def(Or,"(",Bn,")"),ca=dr.cond(Dn).then(on,"=",$r,".createStream(",Bn,");").else(on,"=",$r,".getElements(",Bn,");");return K.optional(function(){dr.assert(ca.else,"!"+Bn+"||"+on,"invalid elements")}),rr.entry(ca),rr.exit(dr.cond(Dn).then($r,".destroyStream(",on,");")),dr.ELEMENTS=on,on})}return null}var Pe=rt();function Qe(){if(Ns in Q){var De=Q[Ns];return K.commandParameter(De,gi,"invalid primitve",k.commandStr),Ea(function(Kt,dr){return gi[De]})}else if(Ns in We){var Zt=We[Ns];return wo(Zt,function(Kt,dr){var rr=Kt.constants.primTypes,mr=Kt.invoke(dr,Zt);return K.optional(function(){Kt.assert(dr,mr+" in "+rr,"invalid primitive, must be one of "+Object.keys(gi))}),dr.def(rr,"[",mr,"]")})}else if(Pe)return ki(Pe)?Pe.value?Ea(function(Kt,dr){return dr.def(Kt.ELEMENTS,".primType")}):Ea(function(){return G}):new _i(Pe.thisDep,Pe.contextDep,Pe.propDep,function(Kt,dr){var rr=Kt.ELEMENTS;return dr.def(rr,"?",rr,".primType:",G)});return null}function Tt(De,Zt){if(De in Q){var Kt=Q[De]|0;return K.command(!Zt||Kt>=0,"invalid "+De,k.commandStr),Ea(function(rr,mr){return Zt&&(rr.OFFSET=Kt),Kt})}else if(De in We){var dr=We[De];return wo(dr,function(rr,mr){var Or=rr.invoke(mr,dr);return Zt&&(rr.OFFSET=Or,K.optional(function(){rr.assert(mr,Or+">=0","invalid "+De)})),Or})}else if(Zt&&Pe)return Ea(function(rr,mr){return rr.OFFSET="0",0});return null}var ke=Tt(Gl,!0);function vt(){if(nu in Q){var De=Q[nu]|0;return K.command(typeof De=="number"&&De>=0,"invalid vertex count",k.commandStr),Ea(function(){return De})}else if(nu in We){var Zt=We[nu];return wo(Zt,function(rr,mr){var Or=rr.invoke(mr,Zt);return K.optional(function(){rr.assert(mr,"typeof "+Or+'==="number"&&'+Or+">=0&&"+Or+"===("+Or+"|0)","invalid vertex count")}),Or})}else if(Pe)if(ki(Pe)){if(Pe)return ke?new _i(ke.thisDep,ke.contextDep,ke.propDep,function(rr,mr){var Or=mr.def(rr.ELEMENTS,".vertCount-",rr.OFFSET);return K.optional(function(){rr.assert(mr,Or+">=0","invalid vertex offset/element buffer too small")}),Or}):Ea(function(rr,mr){return mr.def(rr.ELEMENTS,".vertCount")});var Kt=Ea(function(){return-1});return K.optional(function(){Kt.MISSING=!0}),Kt}else{var dr=new _i(Pe.thisDep||ke.thisDep,Pe.contextDep||ke.contextDep,Pe.propDep||ke.propDep,function(rr,mr){var Or=rr.ELEMENTS;return rr.OFFSET?mr.def(Or,"?",Or,".vertCount-",rr.OFFSET,":-1"):mr.def(Or,"?",Or,".vertCount:-1")});return K.optional(function(){dr.DYNAMIC=!0}),dr}return null}return{elements:Pe,primitive:Qe(),count:vt(),instances:Tt(Uc,!1),offset:ke}}function Fo(B,k){var Q=B.static,We=B.dynamic,rt={};return qr.forEach(function(Pe){var Qe=Kr(Pe);function Tt(ke,vt){if(Pe in Q){var De=ke(Q[Pe]);rt[Qe]=Ea(function(){return De})}else if(Pe in We){var Zt=We[Pe];rt[Qe]=wo(Zt,function(Kt,dr){return vt(Kt,dr,Kt.invoke(dr,Zt))})}}switch(Pe){case ts:case ia:case Ca:case oc:case Ai:case Zu:case Hs:case ic:case tu:case Bi:return Tt(function(ke){return K.commandType(ke,"boolean",Pe,k.commandStr),ke},function(ke,vt,De){return K.optional(function(){ke.assert(vt,"typeof "+De+'==="boolean"',"invalid flag "+Pe,ke.commandStr)}),De});case Ni:return Tt(function(ke){return K.commandParameter(ke,yo,"invalid "+Pe,k.commandStr),yo[ke]},function(ke,vt,De){var Zt=ke.constants.compareFuncs;return K.optional(function(){ke.assert(vt,De+" in "+Zt,"invalid "+Pe+", must be one of "+Object.keys(yo))}),vt.def(Zt,"[",De,"]")});case Ei:return Tt(function(ke){return K.command($i(ke)&&ke.length===2&&typeof ke[0]=="number"&&typeof ke[1]=="number"&&ke[0]<=ke[1],"depth range is 2d array",k.commandStr),ke},function(ke,vt,De){K.optional(function(){ke.assert(vt,ke.shared.isArrayLike+"("+De+")&&"+De+".length===2&&typeof "+De+'[0]==="number"&&typeof '+De+'[1]==="number"&&'+De+"[0]<="+De+"[1]","depth range must be a 2d array")});var Zt=vt.def("+",De,"[0]"),Kt=vt.def("+",De,"[1]");return[Zt,Kt]});case Hi:return Tt(function(ke){K.commandType(ke,"object","blend.func",k.commandStr);var vt="srcRGB"in ke?ke.srcRGB:ke.src,De="srcAlpha"in ke?ke.srcAlpha:ke.src,Zt="dstRGB"in ke?ke.dstRGB:ke.dst,Kt="dstAlpha"in ke?ke.dstAlpha:ke.dst;return K.commandParameter(vt,Vi,Qe+".srcRGB",k.commandStr),K.commandParameter(De,Vi,Qe+".srcAlpha",k.commandStr),K.commandParameter(Zt,Vi,Qe+".dstRGB",k.commandStr),K.commandParameter(Kt,Vi,Qe+".dstAlpha",k.commandStr),K.command(Co.indexOf(vt+", "+Zt)===-1,"unallowed blending combination (srcRGB, dstRGB) = ("+vt+", "+Zt+")",k.commandStr),[Vi[vt],Vi[Zt],Vi[De],Vi[Kt]]},function(ke,vt,De){var Zt=ke.constants.blendFuncs;K.optional(function(){ke.assert(vt,De+"&&typeof "+De+'==="object"',"invalid blend func, must be an object")});function Kt(on,Dn){var ca=vt.def('"',on,Dn,'" in ',De,"?",De,".",on,Dn,":",De,".",on);return K.optional(function(){ke.assert(vt,ca+" in "+Zt,"invalid "+Pe+"."+on+Dn+", must be one of "+Object.keys(Vi))}),ca}var dr=Kt("src","RGB"),rr=Kt("dst","RGB");K.optional(function(){var on=ke.constants.invalidBlendCombinations;ke.assert(vt,on+".indexOf("+dr+'+", "+'+rr+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var mr=vt.def(Zt,"[",dr,"]"),Or=vt.def(Zt,"[",Kt("src","Alpha"),"]"),$r=vt.def(Zt,"[",rr,"]"),Bn=vt.def(Zt,"[",Kt("dst","Alpha"),"]");return[mr,$r,Or,Bn]});case za:return Tt(function(ke){if(typeof ke=="string")return K.commandParameter(ke,xr,"invalid "+Pe,k.commandStr),[xr[ke],xr[ke]];if(typeof ke=="object")return K.commandParameter(ke.rgb,xr,Pe+".rgb",k.commandStr),K.commandParameter(ke.alpha,xr,Pe+".alpha",k.commandStr),[xr[ke.rgb],xr[ke.alpha]];K.commandRaise("invalid blend.equation",k.commandStr)},function(ke,vt,De){var Zt=ke.constants.blendEquations,Kt=vt.def(),dr=vt.def(),rr=ke.cond("typeof ",De,'==="string"');return K.optional(function(){function mr(Or,$r,Bn){ke.assert(Or,Bn+" in "+Zt,"invalid "+$r+", must be one of "+Object.keys(xr))}mr(rr.then,Pe,De),ke.assert(rr.else,De+"&&typeof "+De+'==="object"',"invalid "+Pe),mr(rr.else,Pe+".rgb",De+".rgb"),mr(rr.else,Pe+".alpha",De+".alpha")}),rr.then(Kt,"=",dr,"=",Zt,"[",De,"];"),rr.else(Kt,"=",Zt,"[",De,".rgb];",dr,"=",Zt,"[",De,".alpha];"),vt(rr),[Kt,dr]});case La:return Tt(function(ke){return K.command($i(ke)&&ke.length===4,"blend.color must be a 4d array",k.commandStr),W(4,function(vt){return+ke[vt]})},function(ke,vt,De){return K.optional(function(){ke.assert(vt,ke.shared.isArrayLike+"("+De+")&&"+De+".length===4","blend.color must be a 4d array")}),W(4,function(Zt){return vt.def("+",De,"[",Zt,"]")})});case ru:return Tt(function(ke){return K.commandType(ke,"number",Qe,k.commandStr),ke|0},function(ke,vt,De){return K.optional(function(){ke.assert(vt,"typeof "+De+'==="number"',"invalid stencil.mask")}),vt.def(De,"|0")});case Mu:return Tt(function(ke){K.commandType(ke,"object",Qe,k.commandStr);var vt=ke.cmp||"keep",De=ke.ref||0,Zt="mask"in ke?ke.mask:-1;return K.commandParameter(vt,yo,Pe+".cmp",k.commandStr),K.commandType(De,"number",Pe+".ref",k.commandStr),K.commandType(Zt,"number",Pe+".mask",k.commandStr),[yo[vt],De,Zt]},function(ke,vt,De){var Zt=ke.constants.compareFuncs;K.optional(function(){function mr(){ke.assert(vt,Array.prototype.join.call(arguments,""),"invalid stencil.func")}mr(De+"&&typeof ",De,'==="object"'),mr('!("cmp" in ',De,")||(",De,".cmp in ",Zt,")")});var Kt=vt.def('"cmp" in ',De,"?",Zt,"[",De,".cmp]",":",Hn),dr=vt.def(De,".ref|0"),rr=vt.def('"mask" in ',De,"?",De,".mask|0:-1");return[Kt,dr,rr]});case ds:case ao:return Tt(function(ke){K.commandType(ke,"object",Qe,k.commandStr);var vt=ke.fail||"keep",De=ke.zfail||"keep",Zt=ke.zpass||"keep";return K.commandParameter(vt,Zi,Pe+".fail",k.commandStr),K.commandParameter(De,Zi,Pe+".zfail",k.commandStr),K.commandParameter(Zt,Zi,Pe+".zpass",k.commandStr),[Pe===ao?ft:Ce,Zi[vt],Zi[De],Zi[Zt]]},function(ke,vt,De){var Zt=ke.constants.stencilOps;K.optional(function(){ke.assert(vt,De+"&&typeof "+De+'==="object"',"invalid "+Pe)});function Kt(dr){return K.optional(function(){ke.assert(vt,'!("'+dr+'" in '+De+")||("+De+"."+dr+" in "+Zt+")","invalid "+Pe+"."+dr+", must be one of "+Object.keys(Zi))}),vt.def('"',dr,'" in ',De,"?",Zt,"[",De,".",dr,"]:",Hn)}return[Pe===ao?ft:Ce,Kt("fail"),Kt("zfail"),Kt("zpass")]});case Ou:return Tt(function(ke){K.commandType(ke,"object",Qe,k.commandStr);var vt=ke.factor|0,De=ke.units|0;return K.commandType(vt,"number",Qe+".factor",k.commandStr),K.commandType(De,"number",Qe+".units",k.commandStr),[vt,De]},function(ke,vt,De){K.optional(function(){ke.assert(vt,De+"&&typeof "+De+'==="object"',"invalid "+Pe)});var Zt=vt.def(De,".factor|0"),Kt=vt.def(De,".units|0");return[Zt,Kt]});case vu:return Tt(function(ke){var vt=0;return ke==="front"?vt=Ce:ke==="back"&&(vt=ft),K.command(!!vt,Qe,k.commandStr),vt},function(ke,vt,De){return K.optional(function(){ke.assert(vt,De+'==="front"||'+De+'==="back"',"invalid cull.face")}),vt.def(De,'==="front"?',Ce,":",ft)});case hs:return Tt(function(ke){return K.command(typeof ke=="number"&&ke>=Er.lineWidthDims[0]&&ke<=Er.lineWidthDims[1],"invalid line width, must be a positive number between "+Er.lineWidthDims[0]+" and "+Er.lineWidthDims[1],k.commandStr),ke},function(ke,vt,De){return K.optional(function(){ke.assert(vt,"typeof "+De+'==="number"&&'+De+">="+Er.lineWidthDims[0]+"&&"+De+"<="+Er.lineWidthDims[1],"invalid line width")}),De});case wu:return Tt(function(ke){return K.commandParameter(ke,qa,Qe,k.commandStr),qa[ke]},function(ke,vt,De){return K.optional(function(){ke.assert(vt,De+'==="cw"||'+De+'==="ccw"',"invalid frontFace, must be one of cw,ccw")}),vt.def(De+'==="cw"?'+Yt+":"+sr)});case es:return Tt(function(ke){return K.command($i(ke)&&ke.length===4,"color.mask must be length 4 array",k.commandStr),ke.map(function(vt){return!!vt})},function(ke,vt,De){return K.optional(function(){ke.assert(vt,ke.shared.isArrayLike+"("+De+")&&"+De+".length===4","invalid color.mask")}),W(4,function(Zt){return"!!"+De+"["+Zt+"]"})});case Hu:return Tt(function(ke){K.command(typeof ke=="object"&&ke,Qe,k.commandStr);var vt="value"in ke?ke.value:1,De=!!ke.invert;return K.command(typeof vt=="number"&&vt>=0&&vt<=1,"sample.coverage.value must be a number between 0 and 1",k.commandStr),[vt,De]},function(ke,vt,De){K.optional(function(){ke.assert(vt,De+"&&typeof "+De+'==="object"',"invalid sample.coverage")});var Zt=vt.def('"value" in ',De,"?+",De,".value:1"),Kt=vt.def("!!",De,".invert");return[Zt,Kt]})}}),rt}function Os(B,k){var Q=B.static,We=B.dynamic,rt={};return Object.keys(Q).forEach(function(Pe){var Qe=Q[Pe],Tt;if(typeof Qe=="number"||typeof Qe=="boolean")Tt=Ea(function(){return Qe});else if(typeof Qe=="function"){var ke=Qe._reglType;ke==="texture2d"||ke==="textureCube"?Tt=Ea(function(vt){return vt.link(Qe)}):ke==="framebuffer"||ke==="framebufferCube"?(K.command(Qe.color.length>0,'missing color attachment for framebuffer sent to uniform "'+Pe+'"',k.commandStr),Tt=Ea(function(vt){return vt.link(Qe.color[0])})):K.commandRaise('invalid data for uniform "'+Pe+'"',k.commandStr)}else $i(Qe)?Tt=Ea(function(vt){var De=vt.global.def("[",W(Qe.length,function(Zt){return K.command(typeof Qe[Zt]=="number"||typeof Qe[Zt]=="boolean","invalid uniform "+Pe,vt.commandStr),Qe[Zt]}),"]");return De}):K.commandRaise('invalid or missing data for uniform "'+Pe+'"',k.commandStr);Tt.value=Qe,rt[Pe]=Tt}),Object.keys(We).forEach(function(Pe){var Qe=We[Pe];rt[Pe]=wo(Qe,function(Tt,ke){return Tt.invoke(ke,Qe)})}),rt}function ei(B,k){var Q=B.static,We=B.dynamic,rt={};return Object.keys(Q).forEach(function(Pe){var Qe=Q[Pe],Tt=je.id(Pe),ke=new _r;if(lo(Qe))ke.state=Pn,ke.buffer=Lr.getBuffer(Lr.create(Qe,Wu,!1,!0)),ke.type=0;else{var vt=Lr.getBuffer(Qe);if(vt)ke.state=Pn,ke.buffer=vt,ke.type=0;else if(K.command(typeof Qe=="object"&&Qe,"invalid data for attribute "+Pe,k.commandStr),"constant"in Qe){var De=Qe.constant;ke.buffer="null",ke.state=qn,typeof De=="number"?ke.x=De:(K.command($i(De)&&De.length>0&&De.length<=4,"invalid constant for attribute "+Pe,k.commandStr),Yr.forEach(function($r,Bn){Bn<De.length&&(ke[$r]=De[Bn])}))}else{lo(Qe.buffer)?vt=Lr.getBuffer(Lr.create(Qe.buffer,Wu,!1,!0)):vt=Lr.getBuffer(Qe.buffer),K.command(!!vt,'missing buffer for attribute "'+Pe+'"',k.commandStr);var Zt=Qe.offset|0;K.command(Zt>=0,'invalid offset for attribute "'+Pe+'"',k.commandStr);var Kt=Qe.stride|0;K.command(Kt>=0&&Kt<256,'invalid stride for attribute "'+Pe+'", must be integer betweeen [0, 255]',k.commandStr);var dr=Qe.size|0;K.command(!("size"in Qe)||dr>0&&dr<=4,'invalid size for attribute "'+Pe+'", must be 1,2,3,4',k.commandStr);var rr=!!Qe.normalized,mr=0;"type"in Qe&&(K.commandParameter(Qe.type,_o,"invalid type for attribute "+Pe,k.commandStr),mr=_o[Qe.type]);var Or=Qe.divisor|0;"divisor"in Qe&&(K.command(Or===0||Xr,'cannot specify divisor for attribute "'+Pe+'", instancing not supported',k.commandStr),K.command(Or>=0,'invalid divisor for attribute "'+Pe+'"',k.commandStr)),K.optional(function(){var $r=k.commandStr,Bn=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(Qe).forEach(function(on){K.command(Bn.indexOf(on)>=0,'unknown parameter "'+on+'" for attribute pointer "'+Pe+'" (valid parameters are '+Bn+")",$r)})}),ke.buffer=vt,ke.state=Pn,ke.size=dr,ke.normalized=rr,ke.type=mr||vt.dtype,ke.offset=Zt,ke.stride=Kt,ke.divisor=Or}}rt[Pe]=Ea(function($r,Bn){var on=$r.attribCache;if(Tt in on)return on[Tt];var Dn={isStream:!1};return Object.keys(ke).forEach(function(ca){Dn[ca]=ke[ca]}),ke.buffer&&(Dn.buffer=$r.link(ke.buffer),Dn.type=Dn.type||Dn.buffer+".dtype"),on[Tt]=Dn,Dn})}),Object.keys(We).forEach(function(Pe){var Qe=We[Pe];function Tt(ke,vt){var De=ke.invoke(vt,Qe),Zt=ke.shared,Kt=ke.constants,dr=Zt.isBufferArgs,rr=Zt.buffer;K.optional(function(){ke.assert(vt,De+"&&(typeof "+De+'==="object"||typeof '+De+'==="function")&&('+dr+"("+De+")||"+rr+".getBuffer("+De+")||"+rr+".getBuffer("+De+".buffer)||"+dr+"("+De+'.buffer)||("constant" in '+De+"&&(typeof "+De+'.constant==="number"||'+Zt.isArrayLike+"("+De+".constant))))",'invalid dynamic attribute "'+Pe+'"')});var mr={isStream:vt.def(!1)},Or=new _r;Or.state=Pn,Object.keys(Or).forEach(function(Dn){mr[Dn]=vt.def(""+Or[Dn])});var $r=mr.buffer,Bn=mr.type;vt("if(",dr,"(",De,")){",mr.isStream,"=true;",$r,"=",rr,".createStream(",Wu,",",De,");",Bn,"=",$r,".dtype;","}else{",$r,"=",rr,".getBuffer(",De,");","if(",$r,"){",Bn,"=",$r,".dtype;",'}else if("constant" in ',De,"){",mr.state,"=",qn,";","if(typeof "+De+'.constant === "number"){',mr[Yr[0]],"=",De,".constant;",Yr.slice(1).map(function(Dn){return mr[Dn]}).join("="),"=0;","}else{",Yr.map(function(Dn,ca){return mr[Dn]+"="+De+".constant.length>"+ca+"?"+De+".constant["+ca+"]:0;"}).join(""),"}}else{","if(",dr,"(",De,".buffer)){",$r,"=",rr,".createStream(",Wu,",",De,".buffer);","}else{",$r,"=",rr,".getBuffer(",De,".buffer);","}",Bn,'="type" in ',De,"?",Kt.glTypes,"[",De,".type]:",$r,".dtype;",mr.normalized,"=!!",De,".normalized;");function on(Dn){vt(mr[Dn],"=",De,".",Dn,"|0;")}return on("size"),on("offset"),on("stride"),on("divisor"),vt("}}"),vt.exit("if(",mr.isStream,"){",rr,".destroyStream(",$r,");","}"),mr}rt[Pe]=wo(Qe,Tt)}),rt}function bo(B,k){var Q=B.static,We=B.dynamic;if(fl in Q){var rt=Q[fl];return rt!==null&&Jr.getVAO(rt)===null&&(rt=Jr.createVAO(rt)),Ea(function(Qe){return Qe.link(Jr.getVAO(rt))})}else if(fl in We){var Pe=We[fl];return wo(Pe,function(Qe,Tt){var ke=Qe.invoke(Tt,Pe);return Tt.def(Qe.shared.vao+".getVAO("+ke+")")})}return null}function Ci(B){var k=B.static,Q=B.dynamic,We={};return Object.keys(k).forEach(function(rt){var Pe=k[rt];We[rt]=Ea(function(Qe,Tt){return typeof Pe=="number"||typeof Pe=="boolean"?""+Pe:Qe.link(Pe)})}),Object.keys(Q).forEach(function(rt){var Pe=Q[rt];We[rt]=wo(Pe,function(Qe,Tt){return Qe.invoke(Tt,Pe)})}),We}function vs(B,k,Q,We,rt){var Pe=B.static,Qe=B.dynamic;K.optional(function(){var on=[ko,Ko,Ao,uo,Ns,Gl,nu,Uc,No,fl].concat(qr);function Dn(ca){Object.keys(ca).forEach(function(Na){K.command(on.indexOf(Na)>=0,'unknown parameter "'+Na+'"',rt.commandStr)})}Dn(Pe),Dn(Qe)});var Tt=Ta(B,k),ke=Un(B,rt),vt=Ua(B,ke,rt),De=hi(B,rt),Zt=Fo(B,rt),Kt=Ba(B,rt,Tt);function dr(on){var Dn=vt[on];Dn&&(Zt[on]=Dn)}dr(ps),dr(Kr(Vl));var rr=Object.keys(Zt).length>0,mr={framebuffer:ke,draw:De,shader:Kt,state:Zt,dirty:rr,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(mr.profile=pa(B,rt),mr.uniforms=Os(Q,rt),mr.drawVAO=mr.scopeVAO=bo(B,rt),!mr.drawVAO&&Kt.program&&!Tt&&Mt.angle_instanced_arrays){var Or=!0,$r=Kt.program.attributes.map(function(on){var Dn=k.static[on];return Or=Or&&!!Dn,Dn});if(Or&&$r.length>0){var Bn=Jr.getVAO(Jr.createVAO($r));mr.drawVAO=new _i(null,null,null,function(on,Dn){return on.link(Bn)}),mr.useVAO=!0}}return Tt?mr.useVAO=!0:mr.attributes=ei(k,rt),mr.context=Ci(We,rt),mr}function zo(B,k,Q){var We=B.shared,rt=We.context,Pe=B.scope();Object.keys(Q).forEach(function(Qe){k.save(rt,"."+Qe);var Tt=Q[Qe],ke=Tt.append(B,k);Array.isArray(ke)?Pe(rt,".",Qe,"=[",ke.join(),"];"):Pe(rt,".",Qe,"=",ke,";")}),k(Pe)}function gs(B,k,Q,We){var rt=B.shared,Pe=rt.gl,Qe=rt.framebuffer,Tt;On&&(Tt=k.def(rt.extensions,".webgl_draw_buffers"));var ke=B.constants,vt=ke.drawBuffer,De=ke.backBuffer,Zt;Q?Zt=Q.append(B,k):Zt=k.def(Qe,".next"),We||k("if(",Zt,"!==",Qe,".cur){"),k("if(",Zt,"){",Pe,".bindFramebuffer(",Ti,",",Zt,".framebuffer);"),On&&k(Tt,".drawBuffersWEBGL(",vt,"[",Zt,".colorAttachments.length]);"),k("}else{",Pe,".bindFramebuffer(",Ti,",null);"),On&&k(Tt,".drawBuffersWEBGL(",De,");"),k("}",Qe,".cur=",Zt,";"),We||k("}")}function Uo(B,k,Q){var We=B.shared,rt=We.gl,Pe=B.current,Qe=B.next,Tt=We.current,ke=We.next,vt=B.cond(Tt,".dirty");qr.forEach(function(De){var Zt=Kr(De);if(Zt in Q.state)return;var Kt,dr;if(Zt in Qe){Kt=Qe[Zt],dr=Pe[Zt];var rr=W(Ir[Zt].length,function(Or){return vt.def(Kt,"[",Or,"]")});vt(B.cond(rr.map(function(Or,$r){return Or+"!=="+dr+"["+$r+"]"}).join("||")).then(rt,".",Vr[Zt],"(",rr,");",rr.map(function(Or,$r){return dr+"["+$r+"]="+Or}).join(";"),";"))}else{Kt=vt.def(ke,".",Zt);var mr=B.cond(Kt,"!==",Tt,".",Zt);vt(mr),Zt in zr?mr(B.cond(Kt).then(rt,".enable(",zr[Zt],");").else(rt,".disable(",zr[Zt],");"),Tt,".",Zt,"=",Kt,";"):mr(rt,".",Vr[Zt],"(",Kt,");",Tt,".",Zt,"=",Kt,";")}}),Object.keys(Q.state).length===0&&vt(Tt,".dirty=false;"),k(vt)}function Bo(B,k,Q,We){var rt=B.shared,Pe=B.current,Qe=rt.current,Tt=rt.gl;iu(Object.keys(Q)).forEach(function(ke){var vt=Q[ke];if(We&&!We(vt))return;var De=vt.append(B,k);if(zr[ke]){var Zt=zr[ke];ki(vt)?De?k(Tt,".enable(",Zt,");"):k(Tt,".disable(",Zt,");"):k(B.cond(De).then(Tt,".enable(",Zt,");").else(Tt,".disable(",Zt,");")),k(Qe,".",ke,"=",De,";")}else if($i(De)){var Kt=Pe[ke];k(Tt,".",Vr[ke],"(",De,");",De.map(function(dr,rr){return Kt+"["+rr+"]="+dr}).join(";"),";")}else k(Tt,".",Vr[ke],"(",De,");",Qe,".",ke,"=",De,";")})}function Vo(B,k){Xr&&(B.instancing=k.def(B.shared.extensions,".angle_instanced_arrays"))}function aa(B,k,Q,We,rt){var Pe=B.shared,Qe=B.stats,Tt=Pe.current,ke=Pe.timer,vt=Q.profile;function De(){return typeof performance=="undefined"?"Date.now()":"performance.now()"}var Zt,Kt;function dr(on){Zt=k.def(),on(Zt,"=",De(),";"),typeof rt=="string"?on(Qe,".count+=",rt,";"):on(Qe,".count++;"),pn&&(We?(Kt=k.def(),on(Kt,"=",ke,".getNumPendingQueries();")):on(ke,".beginQuery(",Qe,");"))}function rr(on){on(Qe,".cpuTime+=",De(),"-",Zt,";"),pn&&(We?on(ke,".pushScopeStats(",Kt,",",ke,".getNumPendingQueries(),",Qe,");"):on(ke,".endQuery();"))}function mr(on){var Dn=k.def(Tt,".profile");k(Tt,".profile=",on,";"),k.exit(Tt,".profile=",Dn,";")}var Or;if(vt){if(ki(vt)){vt.enable?(dr(k),rr(k.exit),mr("true")):mr("false");return}Or=vt.append(B,k),mr(Or)}else Or=k.def(Tt,".profile");var $r=B.block();dr($r),k("if(",Or,"){",$r,"}");var Bn=B.block();rr(Bn),k.exit("if(",Or,"){",Bn,"}")}function ou(B,k,Q,We,rt){var Pe=B.shared;function Qe(ke){switch(ke){case sf:case Cc:case Df:return 2;case io:case au:case Vc:return 3;case lc:case Cl:case uf:return 4;default:return 1}}function Tt(ke,vt,De){var Zt=Pe.gl,Kt=k.def(ke,".location"),dr=k.def(Pe.attributes,"[",Kt,"]"),rr=De.state,mr=De.buffer,Or=[De.x,De.y,De.z,De.w],$r=["buffer","normalized","offset","stride"];function Bn(){k("if(!",dr,".buffer){",Zt,".enableVertexAttribArray(",Kt,");}");var Dn=De.type,ca;if(De.size?ca=k.def(De.size,"||",vt):ca=vt,k("if(",dr,".type!==",Dn,"||",dr,".size!==",ca,"||",$r.map(function(ri){return dr+"."+ri+"!=="+De[ri]}).join("||"),"){",Zt,".bindBuffer(",Wu,",",mr,".buffer);",Zt,".vertexAttribPointer(",[Kt,ca,Dn,De.normalized,De.stride,De.offset],");",dr,".type=",Dn,";",dr,".size=",ca,";",$r.map(function(ri){return dr+"."+ri+"="+De[ri]+";"}).join(""),"}"),Xr){var Na=De.divisor;k("if(",dr,".divisor!==",Na,"){",B.instancing,".vertexAttribDivisorANGLE(",[Kt,Na],");",dr,".divisor=",Na,";}")}}function on(){k("if(",dr,".buffer){",Zt,".disableVertexAttribArray(",Kt,");",dr,".buffer=null;","}if(",Yr.map(function(Dn,ca){return dr+"."+Dn+"!=="+Or[ca]}).join("||"),"){",Zt,".vertexAttrib4f(",Kt,",",Or,");",Yr.map(function(Dn,ca){return dr+"."+Dn+"="+Or[ca]+";"}).join(""),"}")}rr===Pn?Bn():rr===qn?on():(k("if(",rr,"===",Pn,"){"),Bn(),k("}else{"),on(),k("}"))}We.forEach(function(ke){var vt=ke.name,De=Q.attributes[vt],Zt;if(De){if(!rt(De))return;Zt=De.append(B,k)}else{if(!rt(cc))return;var Kt=B.scopeAttrib(vt);K.optional(function(){B.assert(k,Kt+".state","missing attribute "+vt)}),Zt={},Object.keys(new _r).forEach(function(dr){Zt[dr]=k.def(Kt,".",dr)})}Tt(B.link(ke),Qe(ke.info.type),Zt)})}function yi(B,k,Q,We,rt){for(var Pe=B.shared,Qe=Pe.gl,Tt,ke=0;ke<We.length;++ke){var vt=We[ke],De=vt.name,Zt=vt.info.type,Kt=Q.uniforms[De],dr=B.link(vt),rr=dr+".location",mr;if(Kt){if(!rt(Kt))continue;if(ki(Kt)){var Or=Kt.value;if(K.command(Or!==null&&typeof Or!="undefined",'missing uniform "'+De+'"',B.commandStr),Zt===se||Zt===N){K.command(typeof Or=="function"&&(Zt===se&&(Or._reglType==="texture2d"||Or._reglType==="framebuffer")||Zt===N&&(Or._reglType==="textureCube"||Or._reglType==="framebufferCube")),"invalid texture for uniform "+De,B.commandStr);var $r=B.link(Or._texture||Or.color[0]._texture);k(Qe,".uniform1i(",rr,",",$r+".bind());"),k.exit($r,".unbind();")}else if(Zt===Gc||Zt===dl||Zt===ne){K.optional(function(){K.command($i(Or),"invalid matrix for uniform "+De,B.commandStr),K.command(Zt===Gc&&Or.length===4||Zt===dl&&Or.length===9||Zt===ne&&Or.length===16,"invalid length for matrix uniform "+De,B.commandStr)});var Bn=B.global.def("new Float32Array(["+Array.prototype.slice.call(Or)+"])"),on=2;Zt===dl?on=3:Zt===ne&&(on=4),k(Qe,".uniformMatrix",on,"fv(",rr,",false,",Bn,");")}else{switch(Zt){case Hl:K.commandType(Or,"number","uniform "+De,B.commandStr),Tt="1f";break;case sf:K.command($i(Or)&&Or.length===2,"uniform "+De,B.commandStr),Tt="2f";break;case io:K.command($i(Or)&&Or.length===3,"uniform "+De,B.commandStr),Tt="3f";break;case lc:K.command($i(Or)&&Or.length===4,"uniform "+De,B.commandStr),Tt="4f";break;case Ef:K.commandType(Or,"boolean","uniform "+De,B.commandStr),Tt="1i";break;case xf:K.commandType(Or,"number","uniform "+De,B.commandStr),Tt="1i";break;case Df:K.command($i(Or)&&Or.length===2,"uniform "+De,B.commandStr),Tt="2i";break;case Cc:K.command($i(Or)&&Or.length===2,"uniform "+De,B.commandStr),Tt="2i";break;case Vc:K.command($i(Or)&&Or.length===3,"uniform "+De,B.commandStr),Tt="3i";break;case au:K.command($i(Or)&&Or.length===3,"uniform "+De,B.commandStr),Tt="3i";break;case uf:K.command($i(Or)&&Or.length===4,"uniform "+De,B.commandStr),Tt="4i";break;case Cl:K.command($i(Or)&&Or.length===4,"uniform "+De,B.commandStr),Tt="4i";break}k(Qe,".uniform",Tt,"(",rr,",",$i(Or)?Array.prototype.slice.call(Or):Or,");")}continue}else mr=Kt.append(B,k)}else{if(!rt(cc))continue;mr=k.def(Pe.uniforms,"[",je.id(De),"]")}Zt===se?(K(!Array.isArray(mr),"must specify a scalar prop for textures"),k("if(",mr,"&&",mr,'._reglType==="framebuffer"){',mr,"=",mr,".color[0];","}")):Zt===N&&(K(!Array.isArray(mr),"must specify a scalar prop for cube maps"),k("if(",mr,"&&",mr,'._reglType==="framebufferCube"){',mr,"=",mr,".color[0];","}")),K.optional(function(){function co(xo,Wl){B.assert(k,xo,'bad data or missing for uniform "'+De+'".  '+Wl)}function Hc(xo){K(!Array.isArray(mr),"must not specify an array type for uniform"),co("typeof "+mr+'==="'+xo+'"',"invalid type, expected "+xo)}function ys(xo,Wl){Array.isArray(mr)?K(mr.length===xo,"must have length "+xo):co(Pe.isArrayLike+"("+mr+")&&"+mr+".length==="+xo,"invalid vector, should have length "+xo,B.commandStr)}function fc(xo){K(!Array.isArray(mr),"must not specify a value type"),co("typeof "+mr+'==="function"&&'+mr+'._reglType==="texture'+(xo===Pu?"2d":"Cube")+'"',"invalid texture type",B.commandStr)}switch(Zt){case xf:Hc("number");break;case Cc:ys(2,"number");break;case au:ys(3,"number");break;case Cl:ys(4,"number");break;case Hl:Hc("number");break;case sf:ys(2,"number");break;case io:ys(3,"number");break;case lc:ys(4,"number");break;case Ef:Hc("boolean");break;case Df:ys(2,"boolean");break;case Vc:ys(3,"boolean");break;case uf:ys(4,"boolean");break;case Gc:ys(4,"number");break;case dl:ys(9,"number");break;case ne:ys(16,"number");break;case se:fc(Pu);break;case N:fc(uc);break}});var Dn=1;switch(Zt){case se:case N:var ca=k.def(mr,"._texture");k(Qe,".uniform1i(",rr,",",ca,".bind());"),k.exit(ca,".unbind();");continue;case xf:case Ef:Tt="1i";break;case Cc:case Df:Tt="2i",Dn=2;break;case au:case Vc:Tt="3i",Dn=3;break;case Cl:case uf:Tt="4i",Dn=4;break;case Hl:Tt="1f";break;case sf:Tt="2f",Dn=2;break;case io:Tt="3f",Dn=3;break;case lc:Tt="4f",Dn=4;break;case Gc:Tt="Matrix2fv";break;case dl:Tt="Matrix3fv";break;case ne:Tt="Matrix4fv";break}if(k(Qe,".uniform",Tt,"(",rr,","),Tt.charAt(0)==="M"){var Na=Math.pow(Zt-Gc+2,2),ri=B.global.def("new Float32Array(",Na,")");Array.isArray(mr)?k("false,(",W(Na,function(co){return ri+"["+co+"]="+mr[co]}),",",ri,")"):k("false,(Array.isArray(",mr,")||",mr," instanceof Float32Array)?",mr,":(",W(Na,function(co){return ri+"["+co+"]="+mr+"["+co+"]"}),",",ri,")")}else Dn>1?k(W(Dn,function(co){return Array.isArray(mr)?mr[co]:mr+"["+co+"]"})):(K(!Array.isArray(mr),"uniform value must not be an array"),k(mr));k(");")}}function An(B,k,Q,We){var rt=B.shared,Pe=rt.gl,Qe=rt.draw,Tt=We.draw;function ke(){var ca=Tt.elements,Na,ri=k;return ca?((ca.contextDep&&We.contextDynamic||ca.propDep)&&(ri=Q),Na=ca.append(B,ri)):Na=ri.def(Qe,".",uo),Na&&ri("if("+Na+")"+Pe+".bindBuffer("+bf+","+Na+".buffer.buffer);"),Na}function vt(){var ca=Tt.count,Na,ri=k;return ca?((ca.contextDep&&We.contextDynamic||ca.propDep)&&(ri=Q),Na=ca.append(B,ri),K.optional(function(){ca.MISSING&&B.assert(k,"false","missing vertex count"),ca.DYNAMIC&&B.assert(ri,Na+">=0","missing vertex count")})):(Na=ri.def(Qe,".",nu),K.optional(function(){B.assert(ri,Na+">=0","missing vertex count")})),Na}var De=ke();function Zt(ca){var Na=Tt[ca];return Na?Na.contextDep&&We.contextDynamic||Na.propDep?Na.append(B,Q):Na.append(B,k):k.def(Qe,".",ca)}var Kt=Zt(Ns),dr=Zt(Gl),rr=vt();if(typeof rr=="number"){if(rr===0)return}else Q("if(",rr,"){"),Q.exit("}");var mr,Or;Xr&&(mr=Zt(Uc),Or=B.instancing);var $r=De+".type",Bn=Tt.elements&&ki(Tt.elements);function on(){function ca(){Q(Or,".drawElementsInstancedANGLE(",[Kt,rr,$r,dr+"<<(("+$r+"-"+vn+")>>1)",mr],");")}function Na(){Q(Or,".drawArraysInstancedANGLE(",[Kt,dr,rr,mr],");")}De?Bn?ca():(Q("if(",De,"){"),ca(),Q("}else{"),Na(),Q("}")):Na()}function Dn(){function ca(){Q(Pe+".drawElements("+[Kt,rr,$r,dr+"<<(("+$r+"-"+vn+")>>1)"]+");")}function Na(){Q(Pe+".drawArrays("+[Kt,dr,rr]+");")}De?Bn?ca():(Q("if(",De,"){"),ca(),Q("}else{"),Na(),Q("}")):Na()}Xr&&(typeof mr!="number"||mr>=0)?typeof mr=="string"?(Q("if(",mr,">0){"),on(),Q("}else if(",mr,"<0){"),Dn(),Q("}")):on():Dn()}function Ra(B,k,Q,We,rt){var Pe=ma(),Qe=Pe.proc("body",rt);return K.optional(function(){Pe.commandStr=k.commandStr,Pe.command=Pe.link(k.commandStr)}),Xr&&(Pe.instancing=Qe.def(Pe.shared.extensions,".angle_instanced_arrays")),B(Pe,Qe,Q,We),Pe.compile().body}function Va(B,k,Q,We){Vo(B,k),Q.useVAO?Q.drawVAO?k(B.shared.vao,".setVAO(",Q.drawVAO.append(B,k),");"):k(B.shared.vao,".setVAO(",B.shared.vao,".targetVAO);"):(k(B.shared.vao,".setVAO(null);"),ou(B,k,Q,We.attributes,function(){return!0})),yi(B,k,Q,We.uniforms,function(){return!0}),An(B,k,k,Q)}function rs(B,k){var Q=B.proc("draw",1);Vo(B,Q),zo(B,Q,k.context),gs(B,Q,k.framebuffer),Uo(B,Q,k),Bo(B,Q,k.state),aa(B,Q,k,!1,!0);var We=k.shader.progVar.append(B,Q);if(Q(B.shared.gl,".useProgram(",We,".program);"),k.shader.program)Va(B,Q,k,k.shader.program);else{Q(B.shared.vao,".setVAO(null);");var rt=B.global.def("{}"),Pe=Q.def(We,".id"),Qe=Q.def(rt,"[",Pe,"]");Q(B.cond(Qe).then(Qe,".call(this,a0);").else(Qe,"=",rt,"[",Pe,"]=",B.link(function(Tt){return Ra(Va,B,k,Tt,1)}),"(",We,");",Qe,".call(this,a0);"))}Object.keys(k.state).length>0&&Q(B.shared.current,".dirty=true;")}function w(B,k,Q,We){B.batchId="a1",Vo(B,k);function rt(){return!0}ou(B,k,Q,We.attributes,rt),yi(B,k,Q,We.uniforms,rt),An(B,k,k,Q)}function b(B,k,Q,We){Vo(B,k);var rt=Q.contextDep,Pe=k.def(),Qe="a0",Tt="a1",ke=k.def();B.shared.props=ke,B.batchId=Pe;var vt=B.scope(),De=B.scope();k(vt.entry,"for(",Pe,"=0;",Pe,"<",Tt,";++",Pe,"){",ke,"=",Qe,"[",Pe,"];",De,"}",vt.exit);function Zt($r){return $r.contextDep&&rt||$r.propDep}function Kt($r){return!Zt($r)}if(Q.needsContext&&zo(B,De,Q.context),Q.needsFramebuffer&&gs(B,De,Q.framebuffer),Bo(B,De,Q.state,Zt),Q.profile&&Zt(Q.profile)&&aa(B,De,Q,!1,!0),We)Q.useVAO?Q.drawVAO?Zt(Q.drawVAO)?De(B.shared.vao,".setVAO(",Q.drawVAO.append(B,De),");"):vt(B.shared.vao,".setVAO(",Q.drawVAO.append(B,vt),");"):vt(B.shared.vao,".setVAO(",B.shared.vao,".targetVAO);"):(vt(B.shared.vao,".setVAO(null);"),ou(B,vt,Q,We.attributes,Kt),ou(B,De,Q,We.attributes,Zt)),yi(B,vt,Q,We.uniforms,Kt),yi(B,De,Q,We.uniforms,Zt),An(B,vt,De,Q);else{var dr=B.global.def("{}"),rr=Q.shader.progVar.append(B,De),mr=De.def(rr,".id"),Or=De.def(dr,"[",mr,"]");De(B.shared.gl,".useProgram(",rr,".program);","if(!",Or,"){",Or,"=",dr,"[",mr,"]=",B.link(function($r){return Ra(w,B,Q,$r,2)}),"(",rr,");}",Or,".call(this,a0[",Pe,"],",Pe,");")}}function c(B,k){var Q=B.proc("batch",2);B.batchId="0",Vo(B,Q);var We=!1,rt=!0;Object.keys(k.context).forEach(function(dr){We=We||k.context[dr].propDep}),We||(zo(B,Q,k.context),rt=!1);var Pe=k.framebuffer,Qe=!1;Pe?(Pe.propDep?We=Qe=!0:Pe.contextDep&&We&&(Qe=!0),Qe||gs(B,Q,Pe)):gs(B,Q,null),k.state.viewport&&k.state.viewport.propDep&&(We=!0);function Tt(dr){return dr.contextDep&&We||dr.propDep}Uo(B,Q,k),Bo(B,Q,k.state,function(dr){return!Tt(dr)}),(!k.profile||!Tt(k.profile))&&aa(B,Q,k,!1,"a1"),k.contextDep=We,k.needsContext=rt,k.needsFramebuffer=Qe;var ke=k.shader.progVar;if(ke.contextDep&&We||ke.propDep)b(B,Q,k,null);else{var vt=ke.append(B,Q);if(Q(B.shared.gl,".useProgram(",vt,".program);"),k.shader.program)b(B,Q,k,k.shader.program);else{Q(B.shared.vao,".setVAO(null);");var De=B.global.def("{}"),Zt=Q.def(vt,".id"),Kt=Q.def(De,"[",Zt,"]");Q(B.cond(Kt).then(Kt,".call(this,a0,a1);").else(Kt,"=",De,"[",Zt,"]=",B.link(function(dr){return Ra(b,B,k,dr,2)}),"(",vt,");",Kt,".call(this,a0,a1);"))}}Object.keys(k.state).length>0&&Q(B.shared.current,".dirty=true;")}function d(B,k){var Q=B.proc("scope",3);B.batchId="a2";var We=B.shared,rt=We.current;zo(B,Q,k.context),k.framebuffer&&k.framebuffer.append(B,Q),iu(Object.keys(k.state)).forEach(function(Qe){var Tt=k.state[Qe],ke=Tt.append(B,Q);$i(ke)?ke.forEach(function(vt,De){Q.set(B.next[Qe],"["+De+"]",vt)}):Q.set(We.next,"."+Qe,ke)}),aa(B,Q,k,!0,!0),[uo,Gl,nu,Uc,Ns].forEach(function(Qe){var Tt=k.draw[Qe];if(!Tt)return;Q.set(We.draw,"."+Qe,""+Tt.append(B,Q))}),Object.keys(k.uniforms).forEach(function(Qe){var Tt=k.uniforms[Qe].append(B,Q);Array.isArray(Tt)&&(Tt="["+Tt.join()+"]"),Q.set(We.uniforms,"["+je.id(Qe)+"]",Tt)}),Object.keys(k.attributes).forEach(function(Qe){var Tt=k.attributes[Qe].append(B,Q),ke=B.scopeAttrib(Qe);Object.keys(new _r).forEach(function(vt){Q.set(ke,"."+vt,Tt[vt])})}),k.scopeVAO&&Q.set(We.vao,".targetVAO",k.scopeVAO.append(B,Q));function Pe(Qe){var Tt=k.shader[Qe];Tt&&Q.set(We.shader,"."+Qe,Tt.append(B,Q))}Pe(Ko),Pe(Ao),Object.keys(k.state).length>0&&(Q(rt,".dirty=true;"),Q.exit(rt,".dirty=true;")),Q("a1(",B.shared.context,",a0,",B.batchId,");")}function y(B){if(typeof B!="object"||$i(B))return;for(var k=Object.keys(B),Q=0;Q<k.length;++Q)if(yt.isDynamic(B[k[Q]]))return!0;return!1}function I(B,k,Q){var We=k.static[Q];if(!We||!y(We))return;var rt=B.global,Pe=Object.keys(We),Qe=!1,Tt=!1,ke=!1,vt=B.global.def("{}");Pe.forEach(function(Zt){var Kt=We[Zt];if(yt.isDynamic(Kt)){typeof Kt=="function"&&(Kt=We[Zt]=yt.unbox(Kt));var dr=wo(Kt,null);Qe=Qe||dr.thisDep,ke=ke||dr.propDep,Tt=Tt||dr.contextDep}else{rt(vt,".",Zt,"=");switch(typeof Kt){case"number":rt(Kt);break;case"string":rt('"',Kt,'"');break;case"object":Array.isArray(Kt)&&rt("[",Kt.join(),"]");break;default:rt(B.link(Kt));break}rt(";")}});function De(Zt,Kt){Pe.forEach(function(dr){var rr=We[dr];if(!yt.isDynamic(rr))return;var mr=Zt.invoke(Kt,rr);Kt(vt,".",dr,"=",mr,";")})}k.dynamic[Q]=new yt.DynamicVariable(ua,{thisDep:Qe,contextDep:Tt,propDep:ke,ref:vt,append:De}),delete k.static[Q]}function te(B,k,Q,We,rt){var Pe=ma();Pe.stats=Pe.link(rt),Object.keys(k.static).forEach(function(Tt){I(Pe,k,Tt)}),Sc.forEach(function(Tt){I(Pe,B,Tt)});var Qe=vs(B,k,Q,We,Pe);return rs(Pe,Qe),d(Pe,Qe),c(Pe,Qe),p(Pe.compile(),{destroy:function(){Qe.shader.program.destroy()}})}return{next:ta,current:Ir,procs:function(){var B=ma(),k=B.proc("poll"),Q=B.proc("refresh"),We=B.block();k(We),Q(We);var rt=B.shared,Pe=rt.gl,Qe=rt.next,Tt=rt.current;We(Tt,".dirty=false;"),gs(B,k),gs(B,Q,null,!0);var ke;Xr&&(ke=B.link(Xr)),Mt.oes_vertex_array_object&&Q(B.link(Mt.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var vt=0;vt<Er.maxAttributes;++vt){var De=Q.def(rt.attributes,"[",vt,"]"),Zt=B.cond(De,".buffer");Zt.then(Pe,".enableVertexAttribArray(",vt,");",Pe,".bindBuffer(",Wu,",",De,".buffer.buffer);",Pe,".vertexAttribPointer(",vt,",",De,".size,",De,".type,",De,".normalized,",De,".stride,",De,".offset);").else(Pe,".disableVertexAttribArray(",vt,");",Pe,".vertexAttrib4f(",vt,",",De,".x,",De,".y,",De,".z,",De,".w);",De,".buffer=null;"),Q(Zt),Xr&&Q(ke,".vertexAttribDivisorANGLE(",vt,",",De,".divisor);")}return Q(B.shared.vao,".currentVAO=null;",B.shared.vao,".setVAO(",B.shared.vao,".targetVAO);"),Object.keys(zr).forEach(function(Kt){var dr=zr[Kt],rr=We.def(Qe,".",Kt),mr=B.block();mr("if(",rr,"){",Pe,".enable(",dr,")}else{",Pe,".disable(",dr,")}",Tt,".",Kt,"=",rr,";"),Q(mr),k("if(",rr,"!==",Tt,".",Kt,"){",mr,"}")}),Object.keys(Vr).forEach(function(Kt){var dr=Vr[Kt],rr=Ir[Kt],mr,Or,$r=B.block();if($r(Pe,".",dr,"("),$i(rr)){var Bn=rr.length;mr=B.global.def(Qe,".",Kt),Or=B.global.def(Tt,".",Kt),$r(W(Bn,function(on){return mr+"["+on+"]"}),");",W(Bn,function(on){return Or+"["+on+"]="+mr+"["+on+"];"}).join("")),k("if(",W(Bn,function(on){return mr+"["+on+"]!=="+Or+"["+on+"]"}).join("||"),"){",$r,"}")}else mr=We.def(Qe,".",Kt),Or=We.def(Tt,".",Kt),$r(mr,");",Tt,".",Kt,"=",mr,";"),k("if(",mr,"!==",Or,"){",$r,"}");Q($r)}),B.compile()}(),compile:te}}function oh(){return{vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}var kf=34918,Lu=34919,jf=35007,lf=function(je,Mt){if(!Mt.ext_disjoint_timer_query)return null;var Er=[];function Lr(){return Er.pop()||Mt.ext_disjoint_timer_query.createQueryEXT()}function wr(On){Er.push(On)}var Tr=[];function Wr(On){var Ir=Lr();Mt.ext_disjoint_timer_query.beginQueryEXT(jf,Ir),Tr.push(Ir),nn(Tr.length-1,Tr.length,On)}function un(){Mt.ext_disjoint_timer_query.endQueryEXT(jf)}function Jr(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var Qr=[];function ln(){return Qr.pop()||new Jr}function Sn(On){Qr.push(On)}var pn=[];function nn(On,Ir,ta){var qr=ln();qr.startQueryIndex=On,qr.endQueryIndex=Ir,qr.sum=0,qr.stats=ta,pn.push(qr)}var _r=[],xr=[];function Xr(){var On,Ir,ta=Tr.length;if(ta===0)return;xr.length=Math.max(xr.length,ta+1),_r.length=Math.max(_r.length,ta+1),_r[0]=0,xr[0]=0;var qr=0;for(On=0,Ir=0;Ir<Tr.length;++Ir){var zr=Tr[Ir];Mt.ext_disjoint_timer_query.getQueryObjectEXT(zr,Lu)?(qr+=Mt.ext_disjoint_timer_query.getQueryObjectEXT(zr,kf),wr(zr)):Tr[On++]=zr,_r[Ir+1]=qr,xr[Ir+1]=On}for(Tr.length=On,On=0,Ir=0;Ir<pn.length;++Ir){var Vr=pn[Ir],Kr=Vr.startQueryIndex,Xn=Vr.endQueryIndex;Vr.sum+=_r[Xn]-_r[Kr];var na=xr[Kr],cn=xr[Xn];cn===na?(Vr.stats.gpuTime+=Vr.sum/1e6,Sn(Vr)):(Vr.startQueryIndex=na,Vr.endQueryIndex=cn,pn[On++]=Vr)}pn.length=On}return{beginQuery:Wr,endQuery:un,pushScopeStats:nn,update:Xr,getNumPendingQueries:function(){return Tr.length},clear:function(){Er.push.apply(Er,Tr);for(var Ir=0;Ir<Er.length;Ir++)Mt.ext_disjoint_timer_query.deleteQueryEXT(Er[Ir]);Tr.length=0,Er.length=0},restore:function(){Tr.length=0,Er.length=0}}},Ff=16384,Eh=256,sh=1024,Tf=34962,zf="webglcontextlost",Uf="webglcontextrestored",uh=1,Bf=2,Of=3;function Zl(ge,je){for(var Mt=0;Mt<ge.length;++Mt)if(ge[Mt]===je)return Mt;return-1}function Ih(ge){var je=Cn(ge);if(!je)return null;var Mt=je.gl,Er=Mt.getContextAttributes(),Lr=Mt.isContextLost(),wr=z(Mt,je);if(!wr)return null;var Tr=Zr(),Wr=oh(),un=wr.extensions,Jr=lf(Mt,un),Qr=hr(),ln=Mt.drawingBufferWidth,Sn=Mt.drawingBufferHeight,pn={tick:0,time:0,viewportWidth:ln,viewportHeight:Sn,framebufferWidth:ln,framebufferHeight:Sn,drawingBufferWidth:ln,drawingBufferHeight:Sn,pixelRatio:je.pixelRatio},nn={},_r={elements:null,primitive:4,count:-1,offset:0,instances:-1},xr=ho(Mt,un),Xr=Ya(Mt,Wr,je,Ir),On=nt(Mt,un,xr,Wr,Xr);function Ir(An){return On.destroyBuffer(An)}var ta=Pc(Mt,un,Xr,Wr),qr=jt(Mt,Tr,Wr,je),zr=eu(Mt,un,xr,function(){Xn.procs.poll()},pn,Wr,je),Vr=ws(Mt,un,xr,Wr,je),Kr=j(Mt,un,xr,zr,Vr,Wr),Xn=Nf(Mt,Tr,un,xr,Xr,ta,zr,Kr,nn,On,qr,_r,pn,Jr,je),na=gr(Mt,Kr,Xn.procs.poll,pn,Er,un,xr),cn=Xn.next,Hr=Mt.canvas,jr=[],ma=[],pa=[],Un=[je.onDestroy],Ua=null;function Ta(){if(jr.length===0){Jr&&Jr.update(),Ua=null;return}Ua=Ht.next(Ta),Bo();for(var An=jr.length-1;An>=0;--An){var Ra=jr[An];Ra&&Ra(pn,null,0)}Mt.flush(),Jr&&Jr.update()}function Ba(){!Ua&&jr.length>0&&(Ua=Ht.next(Ta))}function hi(){Ua&&(Ht.cancel(Ta),Ua=null)}function Fo(An){An.preventDefault(),Lr=!0,hi(),ma.forEach(function(Ra){Ra()})}function Os(An){Mt.getError(),Lr=!1,wr.restore(),qr.restore(),Xr.restore(),zr.restore(),Vr.restore(),Kr.restore(),On.restore(),Jr&&Jr.restore(),Xn.procs.refresh(),Ba(),pa.forEach(function(Ra){Ra()})}Hr&&(Hr.addEventListener(zf,Fo,!1),Hr.addEventListener(Uf,Os,!1));function ei(){jr.length=0,hi(),Hr&&(Hr.removeEventListener(zf,Fo),Hr.removeEventListener(Uf,Os)),qr.clear(),Kr.clear(),Vr.clear(),zr.clear(),ta.clear(),Xr.clear(),On.clear(),Jr&&Jr.clear(),Un.forEach(function(An){An()})}function bo(An){K(!!An,"invalid args to regl({...})"),K.type(An,"object","invalid args to regl({...})");function Ra(rt){var Pe=p({},rt);delete Pe.uniforms,delete Pe.attributes,delete Pe.context,delete Pe.vao,"stencil"in Pe&&Pe.stencil.op&&(Pe.stencil.opBack=Pe.stencil.opFront=Pe.stencil.op,delete Pe.stencil.op);function Qe(Tt){if(Tt in Pe){var ke=Pe[Tt];delete Pe[Tt],Object.keys(ke).forEach(function(vt){Pe[Tt+"."+vt]=ke[vt]})}}return Qe("blend"),Qe("depth"),Qe("cull"),Qe("stencil"),Qe("polygonOffset"),Qe("scissor"),Qe("sample"),"vao"in rt&&(Pe.vao=rt.vao),Pe}function Va(rt,Pe){var Qe={},Tt={};return Object.keys(rt).forEach(function(ke){var vt=rt[ke];if(yt.isDynamic(vt)){Tt[ke]=yt.unbox(vt,ke);return}else if(Pe&&Array.isArray(vt)){for(var De=0;De<vt.length;++De)if(yt.isDynamic(vt[De])){Tt[ke]=yt.unbox(vt,ke);return}}Qe[ke]=vt}),{dynamic:Tt,static:Qe}}var rs=Va(An.context||{},!0),w=Va(An.uniforms||{},!0),b=Va(An.attributes||{},!1),c=Va(Ra(An),!1),d={gpuTime:0,cpuTime:0,count:0},y=Xn.compile(c,b,w,rs,d),I=y.draw,te=y.batch,B=y.scope,k=[];function Q(rt){for(;k.length<rt;)k.push(null);return k}function We(rt,Pe){var Qe;if(Lr&&K.raise("context lost"),typeof rt=="function")return B.call(this,null,rt,0);if(typeof Pe=="function")if(typeof rt=="number")for(Qe=0;Qe<rt;++Qe)B.call(this,null,Pe,Qe);else if(Array.isArray(rt))for(Qe=0;Qe<rt.length;++Qe)B.call(this,rt[Qe],Pe,Qe);else return B.call(this,rt,Pe,0);else if(typeof rt=="number"){if(rt>0)return te.call(this,Q(rt|0),rt|0)}else if(Array.isArray(rt)){if(rt.length)return te.call(this,rt,rt.length)}else return I.call(this,rt)}return p(We,{stats:d,destroy:function(){y.destroy()}})}var Ci=Kr.setFBO=bo({framebuffer:yt.define.call(null,uh,"framebuffer")});function vs(An,Ra){var Va=0;Xn.procs.poll();var rs=Ra.color;rs&&(Mt.clearColor(+rs[0]||0,+rs[1]||0,+rs[2]||0,+rs[3]||0),Va|=Ff),"depth"in Ra&&(Mt.clearDepth(+Ra.depth),Va|=Eh),"stencil"in Ra&&(Mt.clearStencil(Ra.stencil|0),Va|=sh),K(!!Va,"called regl.clear with no buffer specified"),Mt.clear(Va)}function zo(An){if(K(typeof An=="object"&&An,"regl.clear() takes an object as input"),"framebuffer"in An)if(An.framebuffer&&An.framebuffer_reglType==="framebufferCube")for(var Ra=0;Ra<6;++Ra)Ci(p({framebuffer:An.framebuffer.faces[Ra]},An),vs);else Ci(An,vs);else vs(null,An)}function gs(An){K.type(An,"function","regl.frame() callback must be a function"),jr.push(An);function Ra(){var Va=Zl(jr,An);K(Va>=0,"cannot cancel a frame twice");function rs(){var w=Zl(jr,rs);jr[w]=jr[jr.length-1],jr.length-=1,jr.length<=0&&hi()}jr[Va]=rs}return Ba(),{cancel:Ra}}function Uo(){var An=cn.viewport,Ra=cn.scissor_box;An[0]=An[1]=Ra[0]=Ra[1]=0,pn.viewportWidth=pn.framebufferWidth=pn.drawingBufferWidth=An[2]=Ra[2]=Mt.drawingBufferWidth,pn.viewportHeight=pn.framebufferHeight=pn.drawingBufferHeight=An[3]=Ra[3]=Mt.drawingBufferHeight}function Bo(){pn.tick+=1,pn.time=aa(),Uo(),Xn.procs.poll()}function Vo(){zr.refresh(),Uo(),Xn.procs.refresh(),Jr&&Jr.update()}function aa(){return(hr()-Qr)/1e3}Vo();function ou(An,Ra){K.type(Ra,"function","listener callback must be a function");var Va;switch(An){case"frame":return gs(Ra);case"lost":Va=ma;break;case"restore":Va=pa;break;case"destroy":Va=Un;break;default:K.raise("invalid event, must be one of frame,lost,restore,destroy")}return Va.push(Ra),{cancel:function(){for(var w=0;w<Va.length;++w)if(Va[w]===Ra){Va[w]=Va[Va.length-1],Va.pop();return}}}}var yi=p(bo,{clear:zo,prop:yt.define.bind(null,uh),context:yt.define.bind(null,Bf),this:yt.define.bind(null,Of),draw:bo({}),buffer:function(Ra){return Xr.create(Ra,Tf,!1,!1)},elements:function(Ra){return ta.create(Ra,!1)},texture:zr.create2D,cube:zr.createCube,renderbuffer:Vr.create,framebuffer:Kr.create,framebufferCube:Kr.createCube,vao:On.createVAO,attributes:Er,frame:gs,on:ou,limits:xr,hasExtension:function(Ra){return xr.extensions.indexOf(Ra.toLowerCase())>=0},read:na,destroy:ei,_gl:Mt,_refresh:Vo,poll:function(){Bo(),Jr&&Jr.update()},now:aa,stats:Wr});return je.onDone(null,yi),yi}return Ih})},fdMe:function(Ue,g,o){"use strict";o.d(g,"a",function(){return E});function E(p,X){var F=X.callback;return F&&(p.dataArray=p.dataArray.map(F)),p}},fo6e:function(Ue,g){var o=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;function E(p){return o.test(p)}Ue.exports=E},g4R6:function(Ue,g){function o(E,p,X){return E===E&&(X!==void 0&&(E=E<=X?E:X),p!==void 0&&(E=E>=p?E:p)),E}Ue.exports=o},gFfm:function(Ue,g){function o(E,p){for(var X=-1,F=E==null?0:E.length;++X<F&&!(p(E[X],X,E)===!1););return E}Ue.exports=o},gMG2:function(Ue,g,o){"use strict";o.d(g,"a",function(){return wt});var E={},p={},X=34,F=10,i=13;function Z(At){return new Function("d","return {"+At.map(function(Ie,Ne){return JSON.stringify(Ie)+": d["+Ne+'] || ""'}).join(",")+"}")}function D(At,Ie){var Ne=Z(At);return function(Ve,ct){return Ie(Ne(Ve),ct,At)}}function J(At){var Ie=Object.create(null),Ne=[];return At.forEach(function(Ve){for(var ct in Ve)ct in Ie||Ne.push(Ie[ct]=ct)}),Ne}function ee(At,Ie){var Ne=At+"",Ve=Ne.length;return Ve<Ie?new Array(Ie-Ve+1).join(0)+Ne:Ne}function ce(At){return At<0?"-"+ee(-At,6):At>9999?"+"+ee(At,6):ee(At,4)}function Y(At){var Ie=At.getUTCHours(),Ne=At.getUTCMinutes(),Ve=At.getUTCSeconds(),ct=At.getUTCMilliseconds();return isNaN(At)?"Invalid Date":ce(At.getUTCFullYear(),4)+"-"+ee(At.getUTCMonth()+1,2)+"-"+ee(At.getUTCDate(),2)+(ct?"T"+ee(Ie,2)+":"+ee(Ne,2)+":"+ee(Ve,2)+"."+ee(ct,3)+"Z":Ve?"T"+ee(Ie,2)+":"+ee(Ne,2)+":"+ee(Ve,2)+"Z":Ne||Ie?"T"+ee(Ie,2)+":"+ee(Ne,2)+"Z":"")}var ze=function(At){var Ie=new RegExp('["'+At+`
\r]`),Ne=At.charCodeAt(0);function Ve($,H){var Ae,ye,Te=ct($,function(pe,it){if(Ae)return Ae(pe,it-1);ye=pe,Ae=H?D(pe,H):Z(pe)});return Te.columns=ye||[],Te}function ct($,H){var Ae=[],ye=$.length,Te=0,pe=0,it,qt=ye<=0,Pt=!1;$.charCodeAt(ye-1)===F&&--ye,$.charCodeAt(ye-1)===i&&--ye;function me(){if(qt)return p;if(Pt)return Pt=!1,E;var Ge,st=Te,Oe;if($.charCodeAt(st)===X){for(;Te++<ye&&$.charCodeAt(Te)!==X||$.charCodeAt(++Te)===X;);return(Ge=Te)>=ye?qt=!0:(Oe=$.charCodeAt(Te++))===F?Pt=!0:Oe===i&&(Pt=!0,$.charCodeAt(Te)===F&&++Te),$.slice(st+1,Ge-1).replace(/""/g,'"')}for(;Te<ye;){if((Oe=$.charCodeAt(Ge=Te++))===F)Pt=!0;else if(Oe===i)Pt=!0,$.charCodeAt(Te)===F&&++Te;else if(Oe!==Ne)continue;return $.slice(st,Ge)}return qt=!0,$.slice(st,ye)}for(;(it=me())!==p;){for(var ve=[];it!==E&&it!==p;)ve.push(it),it=me();if(H&&(ve=H(ve,pe++))==null)continue;Ae.push(ve)}return Ae}function Me($,H){return $.map(function(Ae){return H.map(function(ye){return oe(Ae[ye])}).join(At)})}function ht($,H){return H==null&&(H=J($)),[H.map(oe).join(At)].concat(Me($,H)).join(`
`)}function Wt($,H){return H==null&&(H=J($)),Me($,H).join(`
`)}function Qt($){return $.map(ur).join(`
`)}function ur($){return $.map(oe).join(At)}function oe($){return $==null?"":$ instanceof Date?Y($):Ie.test($+="")?'"'+$.replace(/"/g,'""')+'"':$}return{parse:Ve,parseRows:ct,format:ht,formatBody:Wt,formatRows:Qt,formatRow:ur,formatValue:oe}},Xe=ze(","),be=Xe.parse,Se=Xe.parseRows,mt=Xe.format,Le=Xe.formatBody,St=Xe.formatRows,Ye=Xe.formatRow,dt=Xe.formatValue,Je=o("5zYK");function wt(At,Ie){var Ne=be(At);return Object(Je.a)(Ne,Ie)}},gQMU:function(Ue,g,o){var E=o("0ZTe"),p=E("toUpperCase");Ue.exports=p},gzZq:function(Ue,g,o){"use strict";Object.defineProperty(g,"__esModule",{value:!0}),g.BindingToSyntax=void 0;var E=o("MON2"),p=o("FV85"),X=o("D9lx"),F=o("LKzl"),i=function(){function Z(D){this._binding=D}return Z.prototype.to=function(D){return this._binding.type=p.BindingTypeEnum.Instance,this._binding.implementationType=D,new X.BindingInWhenOnSyntax(this._binding)},Z.prototype.toSelf=function(){if(typeof this._binding.serviceIdentifier!="function")throw new Error(""+E.INVALID_TO_SELF_VALUE);var D=this._binding.serviceIdentifier;return this.to(D)},Z.prototype.toConstantValue=function(D){return this._binding.type=p.BindingTypeEnum.ConstantValue,this._binding.cache=D,this._binding.dynamicValue=null,this._binding.implementationType=null,new F.BindingWhenOnSyntax(this._binding)},Z.prototype.toDynamicValue=function(D){return this._binding.type=p.BindingTypeEnum.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=D,this._binding.implementationType=null,new X.BindingInWhenOnSyntax(this._binding)},Z.prototype.toConstructor=function(D){return this._binding.type=p.BindingTypeEnum.Constructor,this._binding.implementationType=D,new F.BindingWhenOnSyntax(this._binding)},Z.prototype.toFactory=function(D){return this._binding.type=p.BindingTypeEnum.Factory,this._binding.factory=D,new F.BindingWhenOnSyntax(this._binding)},Z.prototype.toFunction=function(D){if(typeof D!="function")throw new Error(E.INVALID_FUNCTION_BINDING);var J=this.toConstantValue(D);return this._binding.type=p.BindingTypeEnum.Function,J},Z.prototype.toAutoFactory=function(D){return this._binding.type=p.BindingTypeEnum.Factory,this._binding.factory=function(J){var ee=function(){return J.container.get(D)};return ee},new F.BindingWhenOnSyntax(this._binding)},Z.prototype.toProvider=function(D){return this._binding.type=p.BindingTypeEnum.Provider,this._binding.provider=D,new F.BindingWhenOnSyntax(this._binding)},Z.prototype.toService=function(D){this.toDynamicValue(function(J){return J.container.get(D)})},Z}();g.BindingToSyntax=i},h1nZ:function(Ue,g,o){"use strict";var E=o("fX6N");o.d(g,"container",function(){return E.c}),o.d(g,"createSceneContainer",function(){return E.b}),o.d(g,"createLayerContainer",function(){return E.a}),o.d(g,"lazyInject",function(){return E.d});var p=o("+em5"),X=o("bB6j");o.d(g,"TYPES",function(){return X.a});var F=o("8/Fi"),i=o("PUg6");o.d(g,"BlendType",function(){return i.a});var Z=o("cZlC");o.d(g,"AttributeType",function(){return Z.a}),o.d(g,"ScaleTypes",function(){return Z.b}),o.d(g,"StyleScaleType",function(){return Z.c});var D=o("O1je"),J=o.n(D);o.o(D,"CameraUniform")&&o.d(g,"CameraUniform",function(){return D.CameraUniform}),o.o(D,"CityBuildingLayer")&&o.d(g,"CityBuildingLayer",function(){return D.CityBuildingLayer}),o.o(D,"Control")&&o.d(g,"Control",function(){return D.Control}),o.o(D,"CoordinateSystem")&&o.d(g,"CoordinateSystem",function(){return D.CoordinateSystem}),o.o(D,"CoordinateUniform")&&o.d(g,"CoordinateUniform",function(){return D.CoordinateUniform}),o.o(D,"HeatmapLayer")&&o.d(g,"HeatmapLayer",function(){return D.HeatmapLayer}),o.o(D,"ImageLayer")&&o.d(g,"ImageLayer",function(){return D.ImageLayer}),o.o(D,"LineLayer")&&o.d(g,"LineLayer",function(){return D.LineLayer}),o.o(D,"Logo")&&o.d(g,"Logo",function(){return D.Logo}),o.o(D,"MapServiceEvent")&&o.d(g,"MapServiceEvent",function(){return D.MapServiceEvent}),o.o(D,"Marker")&&o.d(g,"Marker",function(){return D.Marker}),o.o(D,"PointLayer")&&o.d(g,"PointLayer",function(){return D.PointLayer}),o.o(D,"PolygonLayer")&&o.d(g,"PolygonLayer",function(){return D.PolygonLayer}),o.o(D,"Popup")&&o.d(g,"Popup",function(){return D.Popup}),o.o(D,"PositionType")&&o.d(g,"PositionType",function(){return D.PositionType}),o.o(D,"RasterLayer")&&o.d(g,"RasterLayer",function(){return D.RasterLayer}),o.o(D,"Scale")&&o.d(g,"Scale",function(){return D.Scale}),o.o(D,"Scene")&&o.d(g,"Scene",function(){return D.Scene}),o.o(D,"SceneEventList")&&o.d(g,"SceneEventList",function(){return D.SceneEventList}),o.o(D,"Zoom")&&o.d(g,"Zoom",function(){return D.Zoom}),o.o(D,"gl")&&o.d(g,"gl",function(){return D.gl});var ee=o("L56e");o.d(g,"MapServiceEvent",function(){return ee.a});var ce=o("HthE");o.d(g,"CoordinateSystem",function(){return ce.a}),o.d(g,"CoordinateUniform",function(){return ce.b});var Y=o("/33/"),ze=o.n(Y);o.o(Y,"CameraUniform")&&o.d(g,"CameraUniform",function(){return Y.CameraUniform}),o.o(Y,"CityBuildingLayer")&&o.d(g,"CityBuildingLayer",function(){return Y.CityBuildingLayer}),o.o(Y,"Control")&&o.d(g,"Control",function(){return Y.Control}),o.o(Y,"HeatmapLayer")&&o.d(g,"HeatmapLayer",function(){return Y.HeatmapLayer}),o.o(Y,"ImageLayer")&&o.d(g,"ImageLayer",function(){return Y.ImageLayer}),o.o(Y,"LineLayer")&&o.d(g,"LineLayer",function(){return Y.LineLayer}),o.o(Y,"Logo")&&o.d(g,"Logo",function(){return Y.Logo}),o.o(Y,"Marker")&&o.d(g,"Marker",function(){return Y.Marker}),o.o(Y,"PointLayer")&&o.d(g,"PointLayer",function(){return Y.PointLayer}),o.o(Y,"PolygonLayer")&&o.d(g,"PolygonLayer",function(){return Y.PolygonLayer}),o.o(Y,"Popup")&&o.d(g,"Popup",function(){return Y.Popup}),o.o(Y,"PositionType")&&o.d(g,"PositionType",function(){return Y.PositionType}),o.o(Y,"RasterLayer")&&o.d(g,"RasterLayer",function(){return Y.RasterLayer}),o.o(Y,"Scale")&&o.d(g,"Scale",function(){return Y.Scale}),o.o(Y,"Scene")&&o.d(g,"Scene",function(){return Y.Scene}),o.o(Y,"SceneEventList")&&o.d(g,"SceneEventList",function(){return Y.SceneEventList}),o.o(Y,"Zoom")&&o.d(g,"Zoom",function(){return Y.Zoom}),o.o(Y,"gl")&&o.d(g,"gl",function(){return Y.gl});var Xe=o("EfZ0");o.d(g,"CameraUniform",function(){return Xe.a});var be=o("riiI"),Se=o.n(be);o.o(be,"CityBuildingLayer")&&o.d(g,"CityBuildingLayer",function(){return be.CityBuildingLayer}),o.o(be,"Control")&&o.d(g,"Control",function(){return be.Control}),o.o(be,"HeatmapLayer")&&o.d(g,"HeatmapLayer",function(){return be.HeatmapLayer}),o.o(be,"ImageLayer")&&o.d(g,"ImageLayer",function(){return be.ImageLayer}),o.o(be,"LineLayer")&&o.d(g,"LineLayer",function(){return be.LineLayer}),o.o(be,"Logo")&&o.d(g,"Logo",function(){return be.Logo}),o.o(be,"Marker")&&o.d(g,"Marker",function(){return be.Marker}),o.o(be,"PointLayer")&&o.d(g,"PointLayer",function(){return be.PointLayer}),o.o(be,"PolygonLayer")&&o.d(g,"PolygonLayer",function(){return be.PolygonLayer}),o.o(be,"Popup")&&o.d(g,"Popup",function(){return be.Popup}),o.o(be,"PositionType")&&o.d(g,"PositionType",function(){return be.PositionType}),o.o(be,"RasterLayer")&&o.d(g,"RasterLayer",function(){return be.RasterLayer}),o.o(be,"Scale")&&o.d(g,"Scale",function(){return be.Scale}),o.o(be,"Scene")&&o.d(g,"Scene",function(){return be.Scene}),o.o(be,"SceneEventList")&&o.d(g,"SceneEventList",function(){return be.SceneEventList}),o.o(be,"Zoom")&&o.d(g,"Zoom",function(){return be.Zoom}),o.o(be,"gl")&&o.d(g,"gl",function(){return be.gl});var mt=o("eg+a");o.d(g,"SceneEventList",function(){return mt.a});var Le=o("bYl4"),St=o.n(Le);o.o(Le,"CityBuildingLayer")&&o.d(g,"CityBuildingLayer",function(){return Le.CityBuildingLayer}),o.o(Le,"Control")&&o.d(g,"Control",function(){return Le.Control}),o.o(Le,"HeatmapLayer")&&o.d(g,"HeatmapLayer",function(){return Le.HeatmapLayer}),o.o(Le,"ImageLayer")&&o.d(g,"ImageLayer",function(){return Le.ImageLayer}),o.o(Le,"LineLayer")&&o.d(g,"LineLayer",function(){return Le.LineLayer}),o.o(Le,"Logo")&&o.d(g,"Logo",function(){return Le.Logo}),o.o(Le,"Marker")&&o.d(g,"Marker",function(){return Le.Marker}),o.o(Le,"PointLayer")&&o.d(g,"PointLayer",function(){return Le.PointLayer}),o.o(Le,"PolygonLayer")&&o.d(g,"PolygonLayer",function(){return Le.PolygonLayer}),o.o(Le,"Popup")&&o.d(g,"Popup",function(){return Le.Popup}),o.o(Le,"PositionType")&&o.d(g,"PositionType",function(){return Le.PositionType}),o.o(Le,"RasterLayer")&&o.d(g,"RasterLayer",function(){return Le.RasterLayer}),o.o(Le,"Scale")&&o.d(g,"Scale",function(){return Le.Scale}),o.o(Le,"Scene")&&o.d(g,"Scene",function(){return Le.Scene}),o.o(Le,"Zoom")&&o.d(g,"Zoom",function(){return Le.Zoom}),o.o(Le,"gl")&&o.d(g,"gl",function(){return Le.gl});var Ye=o("FI6e"),dt=o.n(Ye);o.o(Ye,"CityBuildingLayer")&&o.d(g,"CityBuildingLayer",function(){return Ye.CityBuildingLayer}),o.o(Ye,"Control")&&o.d(g,"Control",function(){return Ye.Control}),o.o(Ye,"HeatmapLayer")&&o.d(g,"HeatmapLayer",function(){return Ye.HeatmapLayer}),o.o(Ye,"ImageLayer")&&o.d(g,"ImageLayer",function(){return Ye.ImageLayer}),o.o(Ye,"LineLayer")&&o.d(g,"LineLayer",function(){return Ye.LineLayer}),o.o(Ye,"Logo")&&o.d(g,"Logo",function(){return Ye.Logo}),o.o(Ye,"Marker")&&o.d(g,"Marker",function(){return Ye.Marker}),o.o(Ye,"PointLayer")&&o.d(g,"PointLayer",function(){return Ye.PointLayer}),o.o(Ye,"PolygonLayer")&&o.d(g,"PolygonLayer",function(){return Ye.PolygonLayer}),o.o(Ye,"Popup")&&o.d(g,"Popup",function(){return Ye.Popup}),o.o(Ye,"PositionType")&&o.d(g,"PositionType",function(){return Ye.PositionType}),o.o(Ye,"RasterLayer")&&o.d(g,"RasterLayer",function(){return Ye.RasterLayer}),o.o(Ye,"Scale")&&o.d(g,"Scale",function(){return Ye.Scale}),o.o(Ye,"Scene")&&o.d(g,"Scene",function(){return Ye.Scene}),o.o(Ye,"Zoom")&&o.d(g,"Zoom",function(){return Ye.Zoom}),o.o(Ye,"gl")&&o.d(g,"gl",function(){return Ye.gl});var Je=o("D+ow"),wt=o.n(Je);o.o(Je,"CityBuildingLayer")&&o.d(g,"CityBuildingLayer",function(){return Je.CityBuildingLayer}),o.o(Je,"Control")&&o.d(g,"Control",function(){return Je.Control}),o.o(Je,"HeatmapLayer")&&o.d(g,"HeatmapLayer",function(){return Je.HeatmapLayer}),o.o(Je,"ImageLayer")&&o.d(g,"ImageLayer",function(){return Je.ImageLayer}),o.o(Je,"LineLayer")&&o.d(g,"LineLayer",function(){return Je.LineLayer}),o.o(Je,"Logo")&&o.d(g,"Logo",function(){return Je.Logo}),o.o(Je,"Marker")&&o.d(g,"Marker",function(){return Je.Marker}),o.o(Je,"PointLayer")&&o.d(g,"PointLayer",function(){return Je.PointLayer}),o.o(Je,"PolygonLayer")&&o.d(g,"PolygonLayer",function(){return Je.PolygonLayer}),o.o(Je,"Popup")&&o.d(g,"Popup",function(){return Je.Popup}),o.o(Je,"PositionType")&&o.d(g,"PositionType",function(){return Je.PositionType}),o.o(Je,"RasterLayer")&&o.d(g,"RasterLayer",function(){return Je.RasterLayer}),o.o(Je,"Scale")&&o.d(g,"Scale",function(){return Je.Scale}),o.o(Je,"Scene")&&o.d(g,"Scene",function(){return Je.Scene}),o.o(Je,"Zoom")&&o.d(g,"Zoom",function(){return Je.Zoom}),o.o(Je,"gl")&&o.d(g,"gl",function(){return Je.gl});var At=o("AFH1");o.d(g,"PositionType",function(){return At.a});var Ie=o("8uyu"),Ne=o.n(Ie);o.o(Ie,"CityBuildingLayer")&&o.d(g,"CityBuildingLayer",function(){return Ie.CityBuildingLayer}),o.o(Ie,"Control")&&o.d(g,"Control",function(){return Ie.Control}),o.o(Ie,"HeatmapLayer")&&o.d(g,"HeatmapLayer",function(){return Ie.HeatmapLayer}),o.o(Ie,"ImageLayer")&&o.d(g,"ImageLayer",function(){return Ie.ImageLayer}),o.o(Ie,"LineLayer")&&o.d(g,"LineLayer",function(){return Ie.LineLayer}),o.o(Ie,"Logo")&&o.d(g,"Logo",function(){return Ie.Logo}),o.o(Ie,"Marker")&&o.d(g,"Marker",function(){return Ie.Marker}),o.o(Ie,"PointLayer")&&o.d(g,"PointLayer",function(){return Ie.PointLayer}),o.o(Ie,"PolygonLayer")&&o.d(g,"PolygonLayer",function(){return Ie.PolygonLayer}),o.o(Ie,"Popup")&&o.d(g,"Popup",function(){return Ie.Popup}),o.o(Ie,"RasterLayer")&&o.d(g,"RasterLayer",function(){return Ie.RasterLayer}),o.o(Ie,"Scale")&&o.d(g,"Scale",function(){return Ie.Scale}),o.o(Ie,"Scene")&&o.d(g,"Scene",function(){return Ie.Scene}),o.o(Ie,"Zoom")&&o.d(g,"Zoom",function(){return Ie.Zoom}),o.o(Ie,"gl")&&o.d(g,"gl",function(){return Ie.gl});var Ve=o("J7lC"),ct=o.n(Ve);o.o(Ve,"CityBuildingLayer")&&o.d(g,"CityBuildingLayer",function(){return Ve.CityBuildingLayer}),o.o(Ve,"Control")&&o.d(g,"Control",function(){return Ve.Control}),o.o(Ve,"HeatmapLayer")&&o.d(g,"HeatmapLayer",function(){return Ve.HeatmapLayer}),o.o(Ve,"ImageLayer")&&o.d(g,"ImageLayer",function(){return Ve.ImageLayer}),o.o(Ve,"LineLayer")&&o.d(g,"LineLayer",function(){return Ve.LineLayer}),o.o(Ve,"Logo")&&o.d(g,"Logo",function(){return Ve.Logo}),o.o(Ve,"Marker")&&o.d(g,"Marker",function(){return Ve.Marker}),o.o(Ve,"PointLayer")&&o.d(g,"PointLayer",function(){return Ve.PointLayer}),o.o(Ve,"PolygonLayer")&&o.d(g,"PolygonLayer",function(){return Ve.PolygonLayer}),o.o(Ve,"Popup")&&o.d(g,"Popup",function(){return Ve.Popup}),o.o(Ve,"RasterLayer")&&o.d(g,"RasterLayer",function(){return Ve.RasterLayer}),o.o(Ve,"Scale")&&o.d(g,"Scale",function(){return Ve.Scale}),o.o(Ve,"Scene")&&o.d(g,"Scene",function(){return Ve.Scene}),o.o(Ve,"Zoom")&&o.d(g,"Zoom",function(){return Ve.Zoom}),o.o(Ve,"gl")&&o.d(g,"gl",function(){return Ve.gl});var Me=o("QGbF"),ht=o.n(Me);o.o(Me,"CityBuildingLayer")&&o.d(g,"CityBuildingLayer",function(){return Me.CityBuildingLayer}),o.o(Me,"Control")&&o.d(g,"Control",function(){return Me.Control}),o.o(Me,"HeatmapLayer")&&o.d(g,"HeatmapLayer",function(){return Me.HeatmapLayer}),o.o(Me,"ImageLayer")&&o.d(g,"ImageLayer",function(){return Me.ImageLayer}),o.o(Me,"LineLayer")&&o.d(g,"LineLayer",function(){return Me.LineLayer}),o.o(Me,"Logo")&&o.d(g,"Logo",function(){return Me.Logo}),o.o(Me,"Marker")&&o.d(g,"Marker",function(){return Me.Marker}),o.o(Me,"PointLayer")&&o.d(g,"PointLayer",function(){return Me.PointLayer}),o.o(Me,"PolygonLayer")&&o.d(g,"PolygonLayer",function(){return Me.PolygonLayer}),o.o(Me,"Popup")&&o.d(g,"Popup",function(){return Me.Popup}),o.o(Me,"RasterLayer")&&o.d(g,"RasterLayer",function(){return Me.RasterLayer}),o.o(Me,"Scale")&&o.d(g,"Scale",function(){return Me.Scale}),o.o(Me,"Scene")&&o.d(g,"Scene",function(){return Me.Scene}),o.o(Me,"Zoom")&&o.d(g,"Zoom",function(){return Me.Zoom}),o.o(Me,"gl")&&o.d(g,"gl",function(){return Me.gl});var Wt=o("V1cb"),Qt=o("bzyH"),ur=o.n(Qt);o.o(Qt,"CityBuildingLayer")&&o.d(g,"CityBuildingLayer",function(){return Qt.CityBuildingLayer}),o.o(Qt,"Control")&&o.d(g,"Control",function(){return Qt.Control}),o.o(Qt,"HeatmapLayer")&&o.d(g,"HeatmapLayer",function(){return Qt.HeatmapLayer}),o.o(Qt,"ImageLayer")&&o.d(g,"ImageLayer",function(){return Qt.ImageLayer}),o.o(Qt,"LineLayer")&&o.d(g,"LineLayer",function(){return Qt.LineLayer}),o.o(Qt,"Logo")&&o.d(g,"Logo",function(){return Qt.Logo}),o.o(Qt,"Marker")&&o.d(g,"Marker",function(){return Qt.Marker}),o.o(Qt,"PointLayer")&&o.d(g,"PointLayer",function(){return Qt.PointLayer}),o.o(Qt,"PolygonLayer")&&o.d(g,"PolygonLayer",function(){return Qt.PolygonLayer}),o.o(Qt,"Popup")&&o.d(g,"Popup",function(){return Qt.Popup}),o.o(Qt,"RasterLayer")&&o.d(g,"RasterLayer",function(){return Qt.RasterLayer}),o.o(Qt,"Scale")&&o.d(g,"Scale",function(){return Qt.Scale}),o.o(Qt,"Scene")&&o.d(g,"Scene",function(){return Qt.Scene}),o.o(Qt,"Zoom")&&o.d(g,"Zoom",function(){return Qt.Zoom}),o.o(Qt,"gl")&&o.d(g,"gl",function(){return Qt.gl});var oe=o("0eqD"),$=o.n(oe);o.o(oe,"CityBuildingLayer")&&o.d(g,"CityBuildingLayer",function(){return oe.CityBuildingLayer}),o.o(oe,"Control")&&o.d(g,"Control",function(){return oe.Control}),o.o(oe,"HeatmapLayer")&&o.d(g,"HeatmapLayer",function(){return oe.HeatmapLayer}),o.o(oe,"ImageLayer")&&o.d(g,"ImageLayer",function(){return oe.ImageLayer}),o.o(oe,"LineLayer")&&o.d(g,"LineLayer",function(){return oe.LineLayer}),o.o(oe,"Logo")&&o.d(g,"Logo",function(){return oe.Logo}),o.o(oe,"Marker")&&o.d(g,"Marker",function(){return oe.Marker}),o.o(oe,"PointLayer")&&o.d(g,"PointLayer",function(){return oe.PointLayer}),o.o(oe,"PolygonLayer")&&o.d(g,"PolygonLayer",function(){return oe.PolygonLayer}),o.o(oe,"Popup")&&o.d(g,"Popup",function(){return oe.Popup}),o.o(oe,"RasterLayer")&&o.d(g,"RasterLayer",function(){return oe.RasterLayer}),o.o(oe,"Scale")&&o.d(g,"Scale",function(){return oe.Scale}),o.o(oe,"Scene")&&o.d(g,"Scene",function(){return oe.Scene}),o.o(oe,"Zoom")&&o.d(g,"Zoom",function(){return oe.Zoom}),o.o(oe,"gl")&&o.d(g,"gl",function(){return oe.gl});var H=o("/Uc5"),Ae=o.n(H);o.o(H,"CityBuildingLayer")&&o.d(g,"CityBuildingLayer",function(){return H.CityBuildingLayer}),o.o(H,"Control")&&o.d(g,"Control",function(){return H.Control}),o.o(H,"HeatmapLayer")&&o.d(g,"HeatmapLayer",function(){return H.HeatmapLayer}),o.o(H,"ImageLayer")&&o.d(g,"ImageLayer",function(){return H.ImageLayer}),o.o(H,"LineLayer")&&o.d(g,"LineLayer",function(){return H.LineLayer}),o.o(H,"Logo")&&o.d(g,"Logo",function(){return H.Logo}),o.o(H,"Marker")&&o.d(g,"Marker",function(){return H.Marker}),o.o(H,"PointLayer")&&o.d(g,"PointLayer",function(){return H.PointLayer}),o.o(H,"PolygonLayer")&&o.d(g,"PolygonLayer",function(){return H.PolygonLayer}),o.o(H,"Popup")&&o.d(g,"Popup",function(){return H.Popup}),o.o(H,"RasterLayer")&&o.d(g,"RasterLayer",function(){return H.RasterLayer}),o.o(H,"Scale")&&o.d(g,"Scale",function(){return H.Scale}),o.o(H,"Scene")&&o.d(g,"Scene",function(){return H.Scene}),o.o(H,"Zoom")&&o.d(g,"Zoom",function(){return H.Zoom}),o.o(H,"gl")&&o.d(g,"gl",function(){return H.gl});var ye=o("RMtq"),Te=o.n(ye);o.o(ye,"CityBuildingLayer")&&o.d(g,"CityBuildingLayer",function(){return ye.CityBuildingLayer}),o.o(ye,"Control")&&o.d(g,"Control",function(){return ye.Control}),o.o(ye,"HeatmapLayer")&&o.d(g,"HeatmapLayer",function(){return ye.HeatmapLayer}),o.o(ye,"ImageLayer")&&o.d(g,"ImageLayer",function(){return ye.ImageLayer}),o.o(ye,"LineLayer")&&o.d(g,"LineLayer",function(){return ye.LineLayer}),o.o(ye,"Logo")&&o.d(g,"Logo",function(){return ye.Logo}),o.o(ye,"Marker")&&o.d(g,"Marker",function(){return ye.Marker}),o.o(ye,"PointLayer")&&o.d(g,"PointLayer",function(){return ye.PointLayer}),o.o(ye,"PolygonLayer")&&o.d(g,"PolygonLayer",function(){return ye.PolygonLayer}),o.o(ye,"Popup")&&o.d(g,"Popup",function(){return ye.Popup}),o.o(ye,"RasterLayer")&&o.d(g,"RasterLayer",function(){return ye.RasterLayer}),o.o(ye,"Scale")&&o.d(g,"Scale",function(){return ye.Scale}),o.o(ye,"Scene")&&o.d(g,"Scene",function(){return ye.Scene}),o.o(ye,"Zoom")&&o.d(g,"Zoom",function(){return ye.Zoom}),o.o(ye,"gl")&&o.d(g,"gl",function(){return ye.gl});var pe=o("1jvM"),it=o.n(pe);o.o(pe,"CityBuildingLayer")&&o.d(g,"CityBuildingLayer",function(){return pe.CityBuildingLayer}),o.o(pe,"Control")&&o.d(g,"Control",function(){return pe.Control}),o.o(pe,"HeatmapLayer")&&o.d(g,"HeatmapLayer",function(){return pe.HeatmapLayer}),o.o(pe,"ImageLayer")&&o.d(g,"ImageLayer",function(){return pe.ImageLayer}),o.o(pe,"LineLayer")&&o.d(g,"LineLayer",function(){return pe.LineLayer}),o.o(pe,"Logo")&&o.d(g,"Logo",function(){return pe.Logo}),o.o(pe,"Marker")&&o.d(g,"Marker",function(){return pe.Marker}),o.o(pe,"PointLayer")&&o.d(g,"PointLayer",function(){return pe.PointLayer}),o.o(pe,"PolygonLayer")&&o.d(g,"PolygonLayer",function(){return pe.PolygonLayer}),o.o(pe,"Popup")&&o.d(g,"Popup",function(){return pe.Popup}),o.o(pe,"RasterLayer")&&o.d(g,"RasterLayer",function(){return pe.RasterLayer}),o.o(pe,"Scale")&&o.d(g,"Scale",function(){return pe.Scale}),o.o(pe,"Scene")&&o.d(g,"Scene",function(){return pe.Scene}),o.o(pe,"Zoom")&&o.d(g,"Zoom",function(){return pe.Zoom}),o.o(pe,"gl")&&o.d(g,"gl",function(){return pe.gl});var qt=o("bPkA"),Pt=o("PSsN"),me=o.n(Pt);o.o(Pt,"CityBuildingLayer")&&o.d(g,"CityBuildingLayer",function(){return Pt.CityBuildingLayer}),o.o(Pt,"Control")&&o.d(g,"Control",function(){return Pt.Control}),o.o(Pt,"HeatmapLayer")&&o.d(g,"HeatmapLayer",function(){return Pt.HeatmapLayer}),o.o(Pt,"ImageLayer")&&o.d(g,"ImageLayer",function(){return Pt.ImageLayer}),o.o(Pt,"LineLayer")&&o.d(g,"LineLayer",function(){return Pt.LineLayer}),o.o(Pt,"Logo")&&o.d(g,"Logo",function(){return Pt.Logo}),o.o(Pt,"Marker")&&o.d(g,"Marker",function(){return Pt.Marker}),o.o(Pt,"PointLayer")&&o.d(g,"PointLayer",function(){return Pt.PointLayer}),o.o(Pt,"PolygonLayer")&&o.d(g,"PolygonLayer",function(){return Pt.PolygonLayer}),o.o(Pt,"Popup")&&o.d(g,"Popup",function(){return Pt.Popup}),o.o(Pt,"RasterLayer")&&o.d(g,"RasterLayer",function(){return Pt.RasterLayer}),o.o(Pt,"Scale")&&o.d(g,"Scale",function(){return Pt.Scale}),o.o(Pt,"Scene")&&o.d(g,"Scene",function(){return Pt.Scene}),o.o(Pt,"Zoom")&&o.d(g,"Zoom",function(){return Pt.Zoom}),o.o(Pt,"gl")&&o.d(g,"gl",function(){return Pt.gl});var ve=o("6NqC"),Ge=o.n(ve);o.o(ve,"CityBuildingLayer")&&o.d(g,"CityBuildingLayer",function(){return ve.CityBuildingLayer}),o.o(ve,"Control")&&o.d(g,"Control",function(){return ve.Control}),o.o(ve,"HeatmapLayer")&&o.d(g,"HeatmapLayer",function(){return ve.HeatmapLayer}),o.o(ve,"ImageLayer")&&o.d(g,"ImageLayer",function(){return ve.ImageLayer}),o.o(ve,"LineLayer")&&o.d(g,"LineLayer",function(){return ve.LineLayer}),o.o(ve,"Logo")&&o.d(g,"Logo",function(){return ve.Logo}),o.o(ve,"Marker")&&o.d(g,"Marker",function(){return ve.Marker}),o.o(ve,"PointLayer")&&o.d(g,"PointLayer",function(){return ve.PointLayer}),o.o(ve,"PolygonLayer")&&o.d(g,"PolygonLayer",function(){return ve.PolygonLayer}),o.o(ve,"Popup")&&o.d(g,"Popup",function(){return ve.Popup}),o.o(ve,"RasterLayer")&&o.d(g,"RasterLayer",function(){return ve.RasterLayer}),o.o(ve,"Scale")&&o.d(g,"Scale",function(){return ve.Scale}),o.o(ve,"Scene")&&o.d(g,"Scene",function(){return ve.Scene}),o.o(ve,"Zoom")&&o.d(g,"Zoom",function(){return ve.Zoom}),o.o(ve,"gl")&&o.d(g,"gl",function(){return ve.gl});var st=o("bTtR"),Oe=o.n(st);o.o(st,"CityBuildingLayer")&&o.d(g,"CityBuildingLayer",function(){return st.CityBuildingLayer}),o.o(st,"Control")&&o.d(g,"Control",function(){return st.Control}),o.o(st,"HeatmapLayer")&&o.d(g,"HeatmapLayer",function(){return st.HeatmapLayer}),o.o(st,"ImageLayer")&&o.d(g,"ImageLayer",function(){return st.ImageLayer}),o.o(st,"LineLayer")&&o.d(g,"LineLayer",function(){return st.LineLayer}),o.o(st,"Logo")&&o.d(g,"Logo",function(){return st.Logo}),o.o(st,"Marker")&&o.d(g,"Marker",function(){return st.Marker}),o.o(st,"PointLayer")&&o.d(g,"PointLayer",function(){return st.PointLayer}),o.o(st,"PolygonLayer")&&o.d(g,"PolygonLayer",function(){return st.PolygonLayer}),o.o(st,"Popup")&&o.d(g,"Popup",function(){return st.Popup}),o.o(st,"RasterLayer")&&o.d(g,"RasterLayer",function(){return st.RasterLayer}),o.o(st,"Scale")&&o.d(g,"Scale",function(){return st.Scale}),o.o(st,"Scene")&&o.d(g,"Scene",function(){return st.Scene}),o.o(st,"Zoom")&&o.d(g,"Zoom",function(){return st.Zoom}),o.o(st,"gl")&&o.d(g,"gl",function(){return st.gl});var gt=o("o+pz");o.d(g,"gl",function(){return gt.a})},h7MG:function(Ue,g,o){"use strict";Object.defineProperty(g,"__esModule",{value:!0}),g.getBindingDictionary=g.createMockRequest=g.plan=void 0;var E=o("doU7"),p=o("MON2"),X=o("FV85"),F=o("xfSm"),i=o("qK8v"),Z=o("ujMp"),D=o("oy+k"),J=o("GXnB"),ee=o("yMAV"),ce=o("fbrv"),Y=o("xiII"),ze=o("dX1H");function Xe(Je){return Je._bindingDictionary}g.getBindingDictionary=Xe;function be(Je,wt,At,Ie,Ne,Ve){var ct=Je?F.MULTI_INJECT_TAG:F.INJECT_TAG,Me=new J.Metadata(ct,At),ht=new ze.Target(wt,Ie,At,Me);if(Ne!==void 0){var Wt=new J.Metadata(Ne,Ve);ht.metadata.push(Wt)}return ht}function Se(Je,wt,At,Ie,Ne){var Ve=St(At.container,Ne.serviceIdentifier),ct=[];return Ve.length===E.BindingCount.NoBindingsAvailable&&At.container.options.autoBindInjectable&&typeof Ne.serviceIdentifier=="function"&&Je.getConstructorMetadata(Ne.serviceIdentifier).compilerGeneratedMetadata&&(At.container.bind(Ne.serviceIdentifier).toSelf(),Ve=St(At.container,Ne.serviceIdentifier)),wt?ct=Ve:ct=Ve.filter(function(Me){var ht=new Y.Request(Me.serviceIdentifier,At,Ie,Me,Ne);return Me.constraint(ht)}),mt(Ne.serviceIdentifier,ct,Ne,At.container),ct}function mt(Je,wt,At,Ie){switch(wt.length){case E.BindingCount.NoBindingsAvailable:if(At.isOptional())return wt;var Ne=Z.getServiceIdentifierAsString(Je),Ve=p.NOT_REGISTERED;throw Ve+=Z.listMetadataForTarget(Ne,At),Ve+=Z.listRegisteredBindingsForServiceIdentifier(Ie,Ne,St),new Error(Ve);case E.BindingCount.OnlyOneBindingAvailable:if(!At.isArray())return wt;case E.BindingCount.MultipleBindingsAvailable:default:if(At.isArray())return wt;var Ne=Z.getServiceIdentifierAsString(Je),Ve=p.AMBIGUOUS_MATCH+" "+Ne;throw Ve+=Z.listRegisteredBindingsForServiceIdentifier(Ie,Ne,St),new Error(Ve)}}function Le(Je,wt,At,Ie,Ne,Ve){var ct,Me;if(Ne===null){ct=Se(Je,wt,Ie,null,Ve),Me=new Y.Request(At,Ie,null,ct,Ve);var ht=new ee.Plan(Ie,Me);Ie.addPlan(ht)}else ct=Se(Je,wt,Ie,Ne,Ve),Me=Ne.addChildRequest(Ve.serviceIdentifier,ct,Ve);ct.forEach(function(Wt){var Qt=null;if(Ve.isArray())Qt=Me.addChildRequest(Wt.serviceIdentifier,Wt,Ve);else{if(Wt.cache)return;Qt=Me}if(Wt.type===X.BindingTypeEnum.Instance&&Wt.implementationType!==null){var ur=ce.getDependencies(Je,Wt.implementationType);if(!Ie.container.options.skipBaseClassChecks){var oe=ce.getBaseClassDependencyCount(Je,Wt.implementationType);if(ur.length<oe){var $=p.ARGUMENTS_LENGTH_MISMATCH(ce.getFunctionName(Wt.implementationType));throw new Error($)}}ur.forEach(function(H){Le(Je,!1,H.serviceIdentifier,Ie,Qt,H)})}})}function St(Je,wt){var At=[],Ie=Xe(Je);return Ie.hasKey(wt)?At=Ie.get(wt):Je.parent!==null&&(At=St(Je.parent,wt)),At}function Ye(Je,wt,At,Ie,Ne,Ve,ct,Me){Me===void 0&&(Me=!1);var ht=new D.Context(wt),Wt=be(At,Ie,Ne,"",Ve,ct);try{return Le(Je,Me,Ne,ht,null,Wt),ht}catch(Qt){throw i.isStackOverflowExeption(Qt)&&(ht.plan&&Z.circularDependencyToException(ht.plan.rootRequest)),Qt}}g.plan=Ye;function dt(Je,wt,At,Ie){var Ne=new ze.Target(X.TargetTypeEnum.Variable,"",wt,new J.Metadata(At,Ie)),Ve=new D.Context(Je),ct=new Y.Request(wt,Ve,null,[],Ne);return ct}g.createMockRequest=dt},heNW:function(Ue,g){function o(E,p,X){switch(X.length){case 0:return E.call(p);case 1:return E.call(p,X[0]);case 2:return E.call(p,X[0],X[1]);case 3:return E.call(p,X[0],X[1],X[2])}return E.apply(p,X)}Ue.exports=o},hi0z:function(Ue,g,o){"use strict";(function(E,p){Ue.exports=p()})(this,function(){function E(ce){var Y=[];return ce.AMapUI&&Y.push(p(ce.AMapUI)),ce.Loca&&Y.push(X(ce.Loca)),Promise.all(Y)}function p(ce){return new Promise(function(Y,ze){var Xe=[];if(ce.plugins)for(var be=0;be<ce.plugins.length;be+=1)i.AMapUI.plugins.indexOf(ce.plugins[be])==-1&&Xe.push(ce.plugins[be]);if(Z.AMapUI===F.failed)ze("\u524D\u6B21\u8BF7\u6C42 AMapUI \u5931\u8D25");else if(Z.AMapUI===F.notload){Z.AMapUI=F.loading,i.AMapUI.version=ce.version||i.AMapUI.version,be=i.AMapUI.version;var Se=document.body||document.head,mt=document.createElement("script");mt.type="text/javascript",mt.src="https://webapi.amap.com/ui/"+be+"/main.js",mt.onerror=function(Le){Z.AMapUI=F.failed,ze("\u8BF7\u6C42 AMapUI \u5931\u8D25")},mt.onload=function(){if(Z.AMapUI=F.loaded,Xe.length)window.AMapUI.loadUI(Xe,function(){for(var Le=0,St=Xe.length;Le<St;Le++){var Ye=Xe[Le].split("/").slice(-1)[0];window.AMapUI[Ye]=arguments[Le]}for(Y();D.AMapUI.length;)D.AMapUI.splice(0,1)[0]()});else for(Y();D.AMapUI.length;)D.AMapUI.splice(0,1)[0]()},Se.appendChild(mt)}else Z.AMapUI===F.loaded?ce.version&&ce.version!==i.AMapUI.version?ze("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C AMapUI \u6DF7\u7528"):Xe.length?window.AMapUI.loadUI(Xe,function(){for(var Le=0,St=Xe.length;Le<St;Le++){var Ye=Xe[Le].split("/").slice(-1)[0];window.AMapUI[Ye]=arguments[Le]}Y()}):Y():ce.version&&ce.version!==i.AMapUI.version?ze("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C AMapUI \u6DF7\u7528"):D.AMapUI.push(function(Le){Le?ze(Le):Xe.length?window.AMapUI.loadUI(Xe,function(){for(var St=0,Ye=Xe.length;St<Ye;St++){var dt=Xe[St].split("/").slice(-1)[0];window.AMapUI[dt]=arguments[St]}Y()}):Y()})})}function X(ce){return new Promise(function(Y,ze){if(i.AMap.version.startsWith("2.0"))ze("Loca \u6682\u4E0D\u9002\u914D JSAPI 2.0,\u8BF7\u4F7F\u7528 1.4.15");else if(Z.Loca===F.failed)ze("\u524D\u6B21\u8BF7\u6C42 Loca \u5931\u8D25");else if(Z.Loca===F.notload){Z.Loca=F.loading,i.Loca.version=ce.version||i.Loca.version;var Xe=i.Loca.version,be=i.key,Se=document.body||document.head,mt=document.createElement("script");mt.type="text/javascript",mt.src="https://webapi.amap.com/loca?v="+Xe+"&key="+be,mt.onerror=function(Le){Z.Loca=F.failed,ze("\u8BF7\u6C42 AMapUI \u5931\u8D25")},mt.onload=function(){for(Z.Loca=F.loaded,Y();D.Loca.length;)D.Loca.splice(0,1)[0]()},Se.appendChild(mt)}else Z.Loca===F.loaded?ce.version&&ce.version!==i.Loca.version?ze("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C Loca \u6DF7\u7528"):Y():ce.version&&ce.version!==i.Loca.version?ze("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C Loca \u6DF7\u7528"):D.Loca.push(function(Le){Le?ze(Le):ze()})})}if(!window)throw Error("AMap JSAPI can only be used in Browser.");var F;(function(ce){ce.notload="notload",ce.loading="loading",ce.loaded="loaded",ce.failed="failed"})(F||(F={}));var i={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},Z={AMap:F.notload,AMapUI:F.notload,Loca:F.notload},D={AMap:[],AMapUI:[],Loca:[]},J=[],ee=function(Y){typeof Y=="function"&&(Z.AMap===F.loaded?Y(window.AMap):J.push(Y))};return{load:function(Y){return new Promise(function(ze,Xe){if(Z.AMap==F.failed)Xe("");else if(Z.AMap==F.notload){var be=Y.key,Se=Y.version,mt=Y.plugins;be?(window.AMap&&location.host!=="lbs.amap.com"&&Xe("\u7981\u6B62\u591A\u79CDAPI\u52A0\u8F7D\u65B9\u5F0F\u6DF7\u7528"),i.key=be,i.AMap.version=Se||i.AMap.version,i.AMap.plugins=mt||i.AMap.plugins,Z.AMap=F.loading,Se=document.body||document.head,window.___onAPILoaded=function(St){if(delete window.___onAPILoaded,St)Z.AMap=F.failed,Xe(St);else for(Z.AMap=F.loaded,E(Y).then(function(){ze(window.AMap)}).catch(Xe);J.length;)J.splice(0,1)[0]()},mt=document.createElement("script"),mt.type="text/javascript",mt.src="https://webapi.amap.com/maps?callback=___onAPILoaded&v="+i.AMap.version+"&key="+be+"&plugin="+i.AMap.plugins.join(","),mt.onerror=function(St){Z.AMap=F.failed,Xe(St)},Se.appendChild(mt)):Xe("\u8BF7\u586B\u5199key")}else if(Z.AMap==F.loaded)if(Y.key&&Y.key!==i.key)Xe("\u591A\u4E2A\u4E0D\u4E00\u81F4\u7684 key");else if(Y.version&&Y.version!==i.AMap.version)Xe("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C JSAPI \u6DF7\u7528");else{if(be=[],Y.plugins)for(Se=0;Se<Y.plugins.length;Se+=1)i.AMap.plugins.indexOf(Y.plugins[Se])==-1&&be.push(Y.plugins[Se]);be.length?window.AMap.plugin(be,function(){E(Y).then(function(){ze(window.AMap)}).catch(Xe)}):E(Y).then(function(){ze(window.AMap)}).catch(Xe)}else if(Y.key&&Y.key!==i.key)Xe("\u591A\u4E2A\u4E0D\u4E00\u81F4\u7684 key");else if(Y.version&&Y.version!==i.AMap.version)Xe("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C JSAPI \u6DF7\u7528");else{var Le=[];if(Y.plugins)for(Se=0;Se<Y.plugins.length;Se+=1)i.AMap.plugins.indexOf(Y.plugins[Se])==-1&&Le.push(Y.plugins[Se]);ee(function(){Le.length?window.AMap.plugin(Le,function(){E(Y).then(function(){ze(window.AMap)}).catch(Xe)}):E(Y).then(function(){ze(window.AMap)}).catch(Xe)})}})},reset:function(){delete window.AMap,delete window.AMapUI,delete window.Loca,i={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},Z={AMap:F.notload,AMapUI:F.notload,Loca:F.notload},D={AMap:[],AMapUI:[],Loca:[]}}}})},hypo:function(Ue,g,o){var E=o("O0oS");function p(X,F,i){F=="__proto__"&&E?E(X,F,{configurable:!0,enumerable:!0,value:i,writable:!0}):X[F]=i}Ue.exports=p},iWIM:function(Ue,g,o){var E=o("n3AX");function p(X,F,i){return typeof Reflect!="undefined"&&Reflect.get?Ue.exports=p=Reflect.get:Ue.exports=p=function(D,J,ee){var ce=E(D,J);if(!ce)return;var Y=Object.getOwnPropertyDescriptor(ce,J);return Y.get?Y.get.call(ee):Y.value},p(X,F,i||X)}Ue.exports=p},iegG:function(Ue,g){function o(E){var p=E.target||E.srcElement;p.__resizeRAF__&&cancelAnimationFrame(p.__resizeRAF__),p.__resizeRAF__=requestAnimationFrame(function(){var X=p.__resizeTrigger__,F=X&&X.__resizeListeners__;F&&F.forEach(function(i){i.call(X,E)})})}var g=function(p,X){var F=this,i=F.document,Z,D=i.attachEvent;typeof navigator!="undefined"&&(Z=navigator.userAgent.match(/Trident/)||navigator.userAgent.match(/Edge/));function J(){this.contentDocument.defaultView.__resizeTrigger__=this.__resizeElement__,this.contentDocument.defaultView.addEventListener("resize",o)}if(!p.__resizeListeners__)if(p.__resizeListeners__=[],D)p.__resizeTrigger__=p,p.attachEvent("onresize",o);else{getComputedStyle(p).position==="static"&&(p.style.position="relative");var ee=p.__resizeTrigger__=i.createElement("object");ee.setAttribute("style","position: absolute; top: 0; left: 0; height: 100%; width: 100%; pointer-events: none; z-index: -1; opacity: 0;"),ee.setAttribute("class","resize-sensor"),ee.setAttribute("tabindex","-1"),ee.__resizeElement__=p,ee.onload=J,ee.type="text/html",Z&&p.appendChild(ee),ee.data="about:blank",Z||p.appendChild(ee)}p.__resizeListeners__.push(X)};Ue.exports=typeof window=="undefined"?g:g.bind(window),Ue.exports.unbind=function(E,p){var X=document.attachEvent,F=E.__resizeListeners__||[];if(p){var i=F.indexOf(p);i!==-1&&F.splice(i,1)}else F=E.__resizeListeners__=[];if(!F.length){if(X)E.detachEvent("onresize",o);else if(E.__resizeTrigger__){var Z=E.__resizeTrigger__.contentDocument,D=Z&&Z.defaultView;D&&(D.removeEventListener("resize",o),delete D.__resizeTrigger__),E.__resizeTrigger__=!E.removeChild(E.__resizeTrigger__)}delete E.__resizeListeners__}}},itsj:function(Ue,g){function o(E,p){return p==="constructor"&&typeof E[p]=="function"||p=="__proto__"?void 0:E[p]}Ue.exports=o},jCWc:function(Ue,g,o){"use strict";var E=o("cIOH"),p=o("1GLa")},"jIg/":function(Ue,g,o){"use strict";Object.defineProperty(g,"__esModule",{value:!0}),g.multiInject=void 0;var E=o("xfSm"),p=o("GXnB"),X=o("Ztfv");function F(i){return function(Z,D,J){var ee=new p.Metadata(E.MULTI_INJECT_TAG,i);typeof J=="number"?X.tagParameter(Z,D,J,ee):X.tagProperty(Z,D,ee)}}g.multiInject=F},jYQm:function(Ue,g,o){"use strict";var E=o("q1tI"),p=o.n(E),X=Object(E.createContext)({});g.a=X},jYx5:function(Ue,g,o){"use strict";Object.defineProperty(g,"__esModule",{value:!0}),g.optional=void 0;var E=o("xfSm"),p=o("GXnB"),X=o("Ztfv");function F(){return function(i,Z,D){var J=new p.Metadata(E.OPTIONAL_TAG,!0);typeof D=="number"?X.tagParameter(i,Z,D,J):X.tagProperty(i,Z,J)}}g.optional=F},"jbM+":function(Ue,g,o){var E=o("R/W3");function p(X,F){var i=X==null?0:X.length;return!!i&&E(X,F,0)>-1}Ue.exports=p},jeLo:function(Ue,g,o){var E=o("juv8"),p=o("mTTR");function X(F){return E(F,p(F))}Ue.exports=X},juv8:function(Ue,g,o){var E=o("MrPd"),p=o("hypo");function X(F,i,Z,D){var J=!Z;Z||(Z={});for(var ee=-1,ce=i.length;++ee<ce;){var Y=i[ee],ze=D?D(Z[Y],F[Y],Y,Z,F):void 0;ze===void 0&&(ze=F[Y]),J?p(Z,Y,ze):E(Z,Y,ze)}return Z}Ue.exports=X},"k5/I":function(Ue,g,o){"use strict";o.d(g,"a",function(){return wt}),o.d(g,"b",function(){return Wt}),o.d(g,"e",function(){return oe}),o.d(g,"f",function(){return Ae}),o.d(g,"c",function(){return qt}),o.d(g,"d",function(){return _t});var E=o("lSNA"),p=o.n(E),X=o("lwsE"),F=o.n(X),i=o("W8MJ"),Z=o.n(i),D=o("7W2i"),J=o.n(D),ee=o("a1gu"),ce=o.n(ee),Y=o("Nsbk"),ze=o.n(Y),Xe=o("h1nZ"),be=o("Hel2"),Se=o("uhBA");function mt(ot,Ut){var K=Object.keys(ot);if(Object.getOwnPropertySymbols){var qe=Object.getOwnPropertySymbols(ot);Ut&&(qe=qe.filter(function(ae){return Object.getOwnPropertyDescriptor(ot,ae).enumerable})),K.push.apply(K,qe)}return K}function Le(ot){for(var Ut=1;Ut<arguments.length;Ut++){var K=arguments[Ut]!=null?arguments[Ut]:{};Ut%2?mt(Object(K),!0).forEach(function(qe){p()(ot,qe,K[qe])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ot,Object.getOwnPropertyDescriptors(K)):mt(Object(K)).forEach(function(qe){Object.defineProperty(ot,qe,Object.getOwnPropertyDescriptor(K,qe))})}return ot}function St(ot){var Ut=Ye();return function(){var qe=ze()(ot),ae;if(Ut){var tt=ze()(this).constructor;ae=Reflect.construct(qe,arguments,tt)}else ae=qe.apply(this,arguments);return ce()(this,ae)}}function Ye(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ot){return!1}}var dt;(function(ot){ot.TOPRIGHT="topright",ot.TOPLEFT="topleft",ot.BOTTOMRIGHT="bottomright",ot.BOTTOMLEFT="bottomleft"})(dt||(dt={}));var Je=0,wt=function(ot){J()(K,ot);var Ut=St(K);function K(qe){var ae;return F()(this,K),ae=Ut.call(this),ae.controlOption=void 0,ae.container=void 0,ae.sceneContainer=void 0,ae.mapsService=void 0,ae.renderService=void 0,ae.layerService=void 0,ae.controlService=void 0,ae.isShow=void 0,ae.controlOption=Le(Le({},ae.getDefault()),qe||{}),ae}return Z()(K,[{key:"getDefault",value:function(){return{position:dt.TOPRIGHT,name:"".concat(Je++)}}},{key:"setPosition",value:function(ae){var tt=this.controlService;return tt&&tt.removeControl(this),this.controlOption.position=ae,tt&&tt.addControl(this,this.sceneContainer),this}},{key:"addTo",value:function(ae){this.mapsService=ae.get(Xe.TYPES.IMapService),this.renderService=ae.get(Xe.TYPES.IRendererService),this.layerService=ae.get(Xe.TYPES.ILayerService),this.controlService=ae.get(Xe.TYPES.IControlService),this.sceneContainer=ae,this.isShow=!0,this.container=this.onAdd();var tt=this.container,kt=this.controlOption.position,pr=this.controlService.controlCorners[kt];return be.a.addClass(tt,"l7-control"),kt.indexOf("bottom")!==-1?pr.insertBefore(tt,pr.firstChild):pr.appendChild(tt),this}},{key:"onAdd",value:function(){throw new Error("Method not implemented.")}},{key:"onRemove",value:function(){throw new Error("Method not implemented.")}},{key:"hide",value:function(){var ae=this.container;be.a.addClass(ae,"l7-control-hide"),this.isShow=!1}},{key:"show",value:function(){var ae=this.container;be.a.removeClass(ae,"l7-control-hide"),this.isShow=!0}},{key:"remove",value:function(){if(!this.mapsService)return this;be.a.remove(this.container),this.onRemove()}},{key:"_refocusOnMap",value:function(ae){if(this.mapsService&&ae&&ae.screenX>0&&ae.screenY>0){var tt=this.mapsService.getContainer();tt!==null&&tt.focus()}}}]),K}(Se.EventEmitter),At=o("PJYZ"),Ie=o.n(At);function Ne(ot){var Ut=Ve();return function(){var qe=ze()(ot),ae;if(Ut){var tt=ze()(this).constructor;ae=Reflect.construct(qe,arguments,tt)}else ae=qe.apply(this,arguments);return ce()(this,ae)}}function Ve(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ot){return!1}}var ct=function(ot){J()(K,ot);var Ut=Ne(K);function K(qe){var ae;return F()(this,K),ae=Ut.call(this,qe),ae.layerControlInputs=void 0,ae.layers=void 0,ae.lastZIndex=void 0,ae.handlingClick=void 0,ae.layersLink=void 0,ae.baseLayersList=void 0,ae.separator=void 0,ae.overlaysList=void 0,ae.form=void 0,ae.layerControlInputs=[],ae.layers=[],ae.lastZIndex=0,ae.handlingClick=!1,ae.initLayers(),Object(be.i)(["checkDisabledLayers","onLayerChange","collapse","extend","expand","onInputClick"],Ie()(ae)),ae}return Z()(K,[{key:"getDefault",value:function(){return{collapsed:!0,position:Xe.PositionType.TOPRIGHT,autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,name:"layers"}}},{key:"onAdd",value:function(){var ae=this;return this.initLayout(),this.update(),this.mapsService.on("zoomend",this.checkDisabledLayers),this.layers.forEach(function(tt){tt.layer.on("remove",ae.onLayerChange),tt.layer.on("add",ae.onLayerChange)}),this.container}},{key:"addVisualLayer",value:function(ae,tt){return this.addLayer(ae,tt,!0),this.mapsService?this.update():this}},{key:"expand",value:function(){var ae=this.renderService.getViewportSize(),tt=ae.height;be.a.addClass(this.container,"l7-control-layers-expanded"),this.form.style.height="null";var kt=tt-(this.container.offsetTop+50);return kt<this.form.clientHeight?(be.a.addClass(this.form,"l7-control-layers-scrollbar"),this.form.style.height=kt+"px"):be.a.removeClass(this.form,"l7-control-layers-scrollbar"),this.checkDisabledLayers(),this}},{key:"collapse",value:function(){return be.a.removeClass(this.container,"l7-control-layers-expanded"),this}},{key:"onRemove",value:function(){var ae=this;if(!this.mapsService)return;this.mapsService.off("click",this.collapse),this.layers.forEach(function(tt){tt.layer.off("remove",ae.onLayerChange),tt.layer.off("add",ae.onLayerChange)})}},{key:"initLayout",value:function(){var ae="l7-control-layers",tt=this.container=be.a.create("div",ae),kt=this.controlOption.collapsed;tt.setAttribute("aria-haspopup","true");var pr=this.form=be.a.create("form",ae+"-list");kt&&(this.mapsService.on("click",this.collapse),tt.addEventListener("mouseenter",this.expand),tt.addEventListener("mouseleave",this.collapse)),this.layersLink=be.a.create("a",ae+"-toggle",tt);var Ke=this.layersLink;Ke.title="Layers",kt||this.expand(),this.baseLayersList=be.a.create("div",ae+"-base",pr),this.separator=be.a.create("div",ae+"-separator",pr),this.overlaysList=be.a.create("div",ae+"-overlays",pr),tt.appendChild(pr)}},{key:"initLayers",value:function(){var ae=this,tt=this.controlOption,kt=tt.baseLayers,pr=kt===void 0?{}:kt,Ke=tt.overlayers,xt=Ke===void 0?{}:Ke;Object.keys(pr).forEach(function(bt,Et){ae.addLayer(pr[bt],bt,!1)}),Object.keys(xt).forEach(function(bt,Et){ae.addLayer(xt[bt],bt,!0)})}},{key:"update",value:function(){if(!this.container)return this;be.a.empty(this.baseLayersList),be.a.empty(this.overlaysList),this.layerControlInputs=[];var ae,tt,kt,pr,Ke=0;for(kt=0;kt<this.layers.length;kt++)pr=this.layers[kt],this.addItem(pr),tt=tt||pr.overlay,ae=ae||!pr.overlay,Ke+=pr.overlay?0:1;return this.controlOption.hideSingleBase&&(ae=ae&&Ke>1,this.baseLayersList.style.display=ae?"":"none"),this.separator.style.display=tt&&ae?"":"none",this}},{key:"checkDisabledLayers",value:function(){for(var ae=this.layerControlInputs,tt,kt,pr=this.mapsService.getZoom(),Ke=ae.length-1;Ke>=0;Ke--)if(tt=ae[Ke],kt=this.layerService.getLayer(tt.layerId),kt&&kt.inited){var xt=kt.getMinZoom(),bt=kt.getMaxZoom();tt.disabled=pr<xt||pr>bt}}},{key:"addLayer",value:function(ae,tt,kt){this.mapsService&&(ae.on("add",this.onLayerChange),ae.on("remove",this.onLayerChange)),this.layers.push({layer:ae,name:tt,overlay:kt});var pr=this.controlOption,Ke=pr.sortLayers,xt=pr.sortFunction,bt=pr.autoZIndex;Ke&&this.layers.sort(function(Et,Fe){return xt(Et.layer,Fe.layer,Et.name,Fe.name)}),bt&&ae.setZIndex&&(this.lastZIndex++,ae.setZIndex(this.lastZIndex)),this.expandIfNotCollapsed()}},{key:"expandIfNotCollapsed",value:function(){return this.mapsService&&!this.controlOption.collapsed&&this.expand(),this}},{key:"onLayerChange",value:function(ae){this.handlingClick||this.update();var tt=this.layerService.getLayer(ae.target.layerId),kt=(tt==null?void 0:tt.overlay)?ae.type==="add"?"overlayadd":"overlayremove":ae.type==="add"?"baselayerchange":null;kt&&this.emit(kt,tt)}},{key:"createRadioElement",value:function(ae,tt){var kt='<input type="radio" class="l7-control-layers-selector" name="'+ae+'"'+(tt?' checked="checked"':"")+"/>",pr=document.createElement("div");return pr.innerHTML=kt,pr.firstChild}},{key:"addItem",value:function(ae){var tt=document.createElement("label"),kt=this.layerService.getLayer(ae.layer.id),pr=kt&&kt.inited&&ae.layer.isVisible(),Ke;ae.overlay?(Ke=document.createElement("input"),Ke.type="checkbox",Ke.className="l7-control-layers-selector",Ke.defaultChecked=pr):Ke=this.createRadioElement("l7-base-layers",pr),this.layerControlInputs.push(Ke),Ke.layerId=ae.layer.id,Ke.addEventListener("click",this.onInputClick);var xt=document.createElement("span");xt.innerHTML=" "+ae.name;var bt=document.createElement("div");tt.appendChild(bt),bt.appendChild(Ke),bt.appendChild(xt);var Et=ae.overlay?this.overlaysList:this.baseLayersList;return Et.appendChild(tt),this.checkDisabledLayers(),tt}},{key:"onInputClick",value:function(){var ae=this.layerControlInputs,tt,kt,pr=[],Ke=[];this.handlingClick=!0;for(var xt=ae.length-1;xt>=0;xt--)tt=ae[xt],kt=this.layerService.getLayer(tt.layerId),tt.checked?pr.push(kt):tt.checked||Ke.push(kt);Ke.forEach(function(bt){bt.hide()}),pr.forEach(function(bt){bt.show()}),this.handlingClick=!1}}]),K}(wt);function Me(ot){var Ut=ht();return function(){var qe=ze()(ot),ae;if(Ut){var tt=ze()(this).constructor;ae=Reflect.construct(qe,arguments,tt)}else ae=qe.apply(this,arguments);return ce()(this,ae)}}function ht(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ot){return!1}}var Wt=function(ot){J()(K,ot);var Ut=Me(K);function K(){return F()(this,K),Ut.apply(this,arguments)}return Z()(K,[{key:"getDefault",value:function(){return{position:dt.BOTTOMLEFT,name:"logo"}}},{key:"onAdd",value:function(){var ae="l7-control-logo",tt=be.a.create("div",ae),kt=be.a.create("a","l7-ctrl-logo");return kt.target="_blank",kt.rel="noopener nofollow",kt.href="https://antv.alipay.com/l7",kt.setAttribute("aria-label","AntV logo"),kt.setAttribute("rel","noopener nofollow"),tt.appendChild(kt),tt}},{key:"onRemove",value:function(){return null}}]),K}(wt);function Qt(ot){var Ut=ur();return function(){var qe=ze()(ot),ae;if(Ut){var tt=ze()(this).constructor;ae=Reflect.construct(qe,arguments,tt)}else ae=qe.apply(this,arguments);return ce()(this,ae)}}function ur(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ot){return!1}}var oe=function(ot){J()(K,ot);var Ut=Qt(K);function K(qe){var ae;return F()(this,K),ae=Ut.call(this,qe),ae.mScale=void 0,ae.iScale=void 0,Object(be.i)(["update"],Ie()(ae)),ae}return Z()(K,[{key:"getDefault",value:function(){return{position:dt.BOTTOMLEFT,maxWidth:100,metric:!0,updateWhenIdle:!1,imperial:!1,name:"scale"}}},{key:"onAdd",value:function(){var ae="l7-control-scale",tt=be.a.create("div",ae);this.addScales(ae+"-line",tt);var kt=this.controlOption.updateWhenIdle;return this.mapsService.on(kt?"moveend":"mapmove",this.update),this.mapsService.on(kt?"zoomend":"zoomchange",this.update),this.update(),tt}},{key:"onRemove",value:function(){var ae=this.controlOption.updateWhenIdle;this.mapsService.off(ae?"zoomend":"zoomchange",this.update),this.mapsService.off(ae?"moveend":"mapmove",this.update)}},{key:"update",value:function(){var ae=this.mapsService,tt=this.controlOption.maxWidth,kt=ae.getSize()[1]/2,pr=ae.containerToLngLat([0,kt]),Ke=ae.containerToLngLat([tt,kt]),xt=Object(be.q)([pr.lng,pr.lat],[Ke.lng,Ke.lat]);this.updateScales(xt)}},{key:"updateScales",value:function(ae){var tt=this.controlOption,kt=tt.metric,pr=tt.imperial;kt&&ae&&this.updateMetric(ae),pr&&ae&&this.updateImperial(ae)}},{key:"updateMetric",value:function(ae){var tt=this.getRoundNum(ae),kt=tt<1e3?tt+" m":tt/1e3+" km";this.updateScale(this.mScale,kt,tt/ae)}},{key:"updateImperial",value:function(ae){var tt=ae*3.2808399,kt,pr,Ke;tt>5280?(kt=tt/5280,pr=this.getRoundNum(kt),this.updateScale(this.iScale,pr+" mi",pr/kt)):(Ke=this.getRoundNum(tt),this.updateScale(this.iScale,Ke+" ft",Ke/tt))}},{key:"updateScale",value:function(ae,tt,kt){var pr=this.controlOption.maxWidth;ae.style.width=Math.round(pr*kt)+"px",ae.innerHTML=tt}},{key:"getRoundNum",value:function(ae){var tt=Math.pow(10,(Math.floor(ae)+"").length-1),kt=ae/tt;return kt=kt>=10?10:kt>=5?5:kt>=3?3:kt>=2?2:1,tt*kt}},{key:"addScales",value:function(ae,tt){var kt=this.controlOption,pr=kt.metric,Ke=kt.imperial;pr&&(this.mScale=be.a.create("div",ae,tt)),Ke&&(this.iScale=be.a.create("div",ae,tt))}}]),K}(wt);function $(ot){var Ut=H();return function(){var qe=ze()(ot),ae;if(Ut){var tt=ze()(this).constructor;ae=Reflect.construct(qe,arguments,tt)}else ae=qe.apply(this,arguments);return ce()(this,ae)}}function H(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ot){return!1}}var Ae=function(ot){J()(K,ot);var Ut=$(K);function K(qe){var ae;return F()(this,K),ae=Ut.call(this,qe),ae.disabled=void 0,ae.zoomInButton=void 0,ae.zoomOutButton=void 0,Object(be.i)(["updateDisabled","zoomIn","zoomOut"],Ie()(ae)),ae}return Z()(K,[{key:"getDefault",value:function(){return{position:dt.TOPLEFT,zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"&#x2212;",zoomOutTitle:"Zoom out",name:"zoom"}}},{key:"onAdd",value:function(){var ae="l7-control-zoom",tt=be.a.create("div",ae+" l7-bar");return this.zoomInButton=this.createButton(this.controlOption.zoomInText,this.controlOption.zoomInTitle,ae+"-in",tt,this.zoomIn),this.zoomOutButton=this.createButton(this.controlOption.zoomOutText,this.controlOption.zoomOutTitle,ae+"-out",tt,this.zoomOut),this.mapsService.on("zoomend",this.updateDisabled),this.mapsService.on("zoomchange",this.updateDisabled),this.updateDisabled(),tt}},{key:"onRemove",value:function(){this.mapsService.off("zoomend",this.updateDisabled),this.mapsService.off("zoomchange",this.updateDisabled)}},{key:"disable",value:function(){return this.disabled=!0,this.updateDisabled(),this}},{key:"enable",value:function(){return this.disabled=!1,this.updateDisabled(),this}},{key:"zoomIn",value:function(){!this.disabled&&this.mapsService.getZoom()<this.mapsService.getMaxZoom()&&this.mapsService.zoomIn()}},{key:"zoomOut",value:function(){!this.disabled&&this.mapsService.getZoom()>this.mapsService.getMinZoom()&&this.mapsService.zoomOut()}},{key:"createButton",value:function(ae,tt,kt,pr,Ke){var xt=be.a.create("a",kt,pr);return xt.innerHTML=ae,xt.title=tt,xt.href="javascript:void(0)",xt.addEventListener("click",Ke),xt}},{key:"updateDisabled",value:function(){var ae=this.mapsService,tt="l7-disabled";be.a.removeClass(this.zoomInButton,tt),be.a.removeClass(this.zoomOutButton,tt),(this.disabled||ae.getZoom()<=ae.getMinZoom())&&be.a.addClass(this.zoomOutButton,tt),(this.disabled||ae.getZoom()>=ae.getMaxZoom())&&be.a.addClass(this.zoomInButton,tt)}}]),K}(wt);function ye(ot,Ut){var K=Object.keys(ot);if(Object.getOwnPropertySymbols){var qe=Object.getOwnPropertySymbols(ot);Ut&&(qe=qe.filter(function(ae){return Object.getOwnPropertyDescriptor(ot,ae).enumerable})),K.push.apply(K,qe)}return K}function Te(ot){for(var Ut=1;Ut<arguments.length;Ut++){var K=arguments[Ut]!=null?arguments[Ut]:{};Ut%2?ye(Object(K),!0).forEach(function(qe){p()(ot,qe,K[qe])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ot,Object.getOwnPropertyDescriptors(K)):ye(Object(K)).forEach(function(qe){Object.defineProperty(ot,qe,Object.getOwnPropertyDescriptor(K,qe))})}return ot}function pe(ot){var Ut=it();return function(){var qe=ze()(ot),ae;if(Ut){var tt=ze()(this).constructor;ae=Reflect.construct(qe,arguments,tt)}else ae=qe.apply(this,arguments);return ce()(this,ae)}}function it(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ot){return!1}}var qt=function(ot){J()(K,ot);var Ut=pe(K);function K(qe){var ae;return F()(this,K),ae=Ut.call(this),ae.markerOption=void 0,ae.defaultMarker=void 0,ae.popup=void 0,ae.mapsService=void 0,ae.sceneSerive=void 0,ae.lngLat=void 0,ae.scene=void 0,ae.added=!1,ae.eventHandle=function(tt){ae.emit(tt.type,{target:tt,data:ae.markerOption.extData,lngLat:ae.lngLat})},ae.markerOption=Te(Te({},ae.getDefault()),qe),Object(be.i)(["update","onMove","onUp","addDragHandler","onMapClick"],Ie()(ae)),ae.init(),ae}return Z()(K,[{key:"getDefault",value:function(){return{element:void 0,anchor:be.f.BOTTOM,offsets:[0,0],color:"#5B8FF9",draggable:!1}}},{key:"addTo",value:function(ae){this.scene=ae,this.mapsService=ae.get(Xe.TYPES.IMapService),this.sceneSerive=ae.get(Xe.TYPES.ISceneService);var tt=this.markerOption,kt=tt.element,pr=tt.draggable;return this.mapsService.getMarkerContainer().appendChild(kt),this.registerMarkerEvent(kt),this.mapsService.on("camerachange",this.update),this.update(),this.added=!0,this.emit("added"),this}},{key:"remove",value:function(){this.mapsService&&(this.mapsService.off("click",this.onMapClick),this.mapsService.off("move",this.update),this.mapsService.off("moveend",this.update),this.mapsService.off("mousedown",this.addDragHandler),this.mapsService.off("touchstart",this.addDragHandler),this.mapsService.off("mouseup",this.onUp),this.mapsService.off("touchend",this.onUp)),this.unRegisterMarkerEvent(),this.removeAllListeners();var ae=this.markerOption.element;return ae&&be.a.remove(ae),this.popup&&this.popup.remove(),this}},{key:"setLnglat",value:function(ae){return this.lngLat=ae,Array.isArray(ae)&&(this.lngLat={lng:ae[0],lat:ae[1]}),this.popup&&this.popup.setLnglat(this.lngLat),this.update(),this}},{key:"getLnglat",value:function(){return this.lngLat}},{key:"getElement",value:function(){return this.markerOption.element}},{key:"setElement",value:function(ae){var tt=this;if(!this.added)return this.once("added",function(){tt.setElement(ae)}),this;var kt=this.markerOption.element;return kt&&be.a.remove(kt),this.markerOption.element=ae,this.init(),this.mapsService.getMarkerContainer().appendChild(ae),this.registerMarkerEvent(ae),this.update(),this}},{key:"openPopup",value:function(){var ae=this;if(!this.added)return this.once("added",function(){ae.openPopup()}),this;var tt=this.popup;return tt?(tt.isOpen()||tt.addTo(this.scene),this):this}},{key:"closePopup",value:function(){var ae=this;this.added||this.once("added",function(){ae.closePopup()});var tt=this.popup;return tt&&tt.remove(),this}},{key:"setPopup",value:function(ae){return this.popup=ae,this.lngLat&&this.popup.setLnglat(this.lngLat),this}},{key:"togglePopup",value:function(){var ae=this.popup;if(ae)ae.isOpen()?ae.remove():ae.addTo(this.scene);else return this;return this}},{key:"getPopup",value:function(){return this.popup}},{key:"getOffset",value:function(){return this.markerOption.offsets}},{key:"setDraggable",value:function(ae){throw new Error("Method not implemented.")}},{key:"isDraggable",value:function(){return this.markerOption.draggable}},{key:"getExtData",value:function(){return this.markerOption.extData}},{key:"setExtData",value:function(ae){this.markerOption.extData=ae}},{key:"update",value:function(){if(!this.mapsService)return;var ae=this.markerOption,tt=ae.element,kt=ae.anchor;this.updatePosition(),be.a.setTransform(tt,"".concat(be.e[kt]))}},{key:"onMapClick",value:function(ae){var tt=this.markerOption.element;this.popup&&tt&&this.togglePopup()}},{key:"updatePosition",value:function(){if(!this.mapsService)return;var ae=this.markerOption,tt=ae.element,kt=ae.offsets,pr=this.lngLat,Ke=pr.lng,xt=pr.lat,bt=this.mapsService.getBounds(),Et=this.mapsService.getZoom();if((Ke<bt[0][0]||Ke>bt[1][0]||xt<bt[0][1]||xt>bt[1][1])&&Et>3){tt&&(tt.style.display="none");return}var Fe=this.mapsService.lngLatToContainer([Ke,xt]);tt&&(tt.style.display="block",tt.style.left=Fe.x+kt[0]+"px",tt.style.top=Fe.y-kt[1]+"px")}},{key:"init",value:function(){var ae=this,tt=this.markerOption.element,kt=this.markerOption,pr=kt.color,Ke=kt.anchor;if(!tt){this.defaultMarker=!0,tt=be.a.create("div"),this.markerOption.element=tt;var xt=document.createElementNS("http://www.w3.org/2000/svg","svg");xt.setAttributeNS(null,"display","block"),xt.setAttributeNS(null,"height","48px"),xt.setAttributeNS(null,"width","48px"),xt.setAttributeNS(null,"viewBox","0 0 1024 1024");var bt=document.createElementNS("http://www.w3.org/2000/svg","path");bt.setAttributeNS(null,"d","M512 490.666667C453.12 490.666667 405.333333 442.88 405.333333 384 405.333333 325.12 453.12 277.333333 512 277.333333 570.88 277.333333 618.666667 325.12 618.666667 384 618.666667 442.88 570.88 490.666667 512 490.666667M512 85.333333C346.88 85.333333 213.333333 218.88 213.333333 384 213.333333 608 512 938.666667 512 938.666667 512 938.666667 810.666667 608 810.666667 384 810.666667 218.88 677.12 85.333333 512 85.333333Z"),bt.setAttributeNS(null,"fill",pr),xt.appendChild(bt),tt.appendChild(xt)}be.a.addClass(tt,"l7-marker"),tt.addEventListener("click",function(Et){ae.onMapClick(Et)}),tt.addEventListener("click",this.eventHandle),Object(be.g)(tt,Ke,"marker")}},{key:"registerMarkerEvent",value:function(ae){ae.addEventListener("mousemove",this.eventHandle),ae.addEventListener("click",this.eventHandle),ae.addEventListener("mousedown",this.eventHandle),ae.addEventListener("mouseup",this.eventHandle),ae.addEventListener("dblclick",this.eventHandle),ae.addEventListener("contextmenu",this.eventHandle),ae.addEventListener("mouseover",this.eventHandle),ae.addEventListener("mouseout",this.eventHandle)}},{key:"unRegisterMarkerEvent",value:function(){var ae=this.getElement();ae.removeEventListener("mousemove",this.eventHandle),ae.removeEventListener("click",this.eventHandle),ae.removeEventListener("mousedown",this.eventHandle),ae.removeEventListener("mouseup",this.eventHandle),ae.removeEventListener("dblclick",this.eventHandle),ae.removeEventListener("contextmenu",this.eventHandle),ae.removeEventListener("mouseover",this.eventHandle),ae.removeEventListener("mouseout",this.eventHandle)}},{key:"addDragHandler",value:function(ae){throw new Error("Method not implemented.")}},{key:"onUp",value:function(ae){throw new Error("Method not implemented.")}}]),K}(Se.EventEmitter),Pt=o("QkVN"),me=o.n(Pt),ve=o("mpbz"),Ge=o.n(ve);function st(ot,Ut){var K=Object.keys(ot);if(Object.getOwnPropertySymbols){var qe=Object.getOwnPropertySymbols(ot);Ut&&(qe=qe.filter(function(ae){return Object.getOwnPropertyDescriptor(ot,ae).enumerable})),K.push.apply(K,qe)}return K}function Oe(ot){for(var Ut=1;Ut<arguments.length;Ut++){var K=arguments[Ut]!=null?arguments[Ut]:{};Ut%2?st(Object(K),!0).forEach(function(qe){p()(ot,qe,K[qe])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ot,Object.getOwnPropertyDescriptors(K)):st(Object(K)).forEach(function(qe){Object.defineProperty(ot,qe,Object.getOwnPropertyDescriptor(K,qe))})}return ot}function gt(ot){var Ut=C();return function(){var qe=ze()(ot),ae;if(Ut){var tt=ze()(this).constructor;ae=Reflect.construct(qe,arguments,tt)}else ae=qe.apply(this,arguments);return ce()(this,ae)}}function C(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ot){return!1}}var R=function(ot){J()(K,ot);var Ut=gt(K);function K(qe){var ae,tt;return F()(this,K),tt=Ut.call(this),tt.markers=[],tt.markerLayerOption=void 0,tt.clusterIndex=void 0,tt.points=[],tt.clusterMarkers=[],tt.mapsService=void 0,tt.scene=void 0,tt.zoom=void 0,tt.bbox=void 0,tt.markerLayerOption=me()(tt.getDefault(),qe),Object(be.i)(["update"],Ie()(tt)),tt.zoom=((ae=tt.markerLayerOption.clusterOption)===null||ae===void 0?void 0:ae.zoom)||-99,tt}return Z()(K,[{key:"getDefault",value:function(){return{cluster:!1,clusterOption:{radius:80,maxZoom:20,minZoom:0,zoom:-99,style:{},className:""}}}},{key:"addTo",value:function(ae){return this.scene=ae,this.mapsService=ae.get(Xe.TYPES.IMapService),this.markerLayerOption.cluster&&(this.initCluster(),this.update(),this.mapsService.on("camerachange",this.update)),this.addMarkers(),this}},{key:"addMarker",value:function(ae){var tt=this.markerLayerOption.cluster;tt&&this.addPoint(ae,this.markers.length),this.markers.push(ae)}},{key:"removeMarker",value:function(ae){this.markers.indexOf(ae);var tt=this.markers.indexOf(ae);tt>-1&&this.markers.splice(tt,1)}},{key:"getMarkers",value:function(){var ae=this.markerLayerOption.cluster;return ae?this.clusterMarkers:this.markers}},{key:"addMarkers",value:function(){var ae=this;this.getMarkers().forEach(function(tt){tt.addTo(ae.scene)})}},{key:"clear",value:function(){this.markers.forEach(function(ae){ae.remove()}),this.clusterMarkers.forEach(function(ae){ae.remove()}),this.mapsService.off("camerachange",this.update),this.markers=[],this.clusterMarkers=[]}},{key:"destroy",value:function(){this.clear(),this.removeAllListeners()}},{key:"addPoint",value:function(ae,tt){var kt=ae.getLnglat(),pr=kt.lng,Ke=kt.lat,xt={geometry:{type:"Point",coordinates:[pr,Ke]},properties:Oe(Oe({},ae.getExtData()),{},{marker_id:tt})};this.points.push(xt)}},{key:"initCluster",value:function(){if(!this.markerLayerOption.cluster)return;var ae=this.markerLayerOption.clusterOption,tt=ae.radius,kt=ae.minZoom,pr=kt===void 0?0:kt,Ke=ae.maxZoom;this.clusterIndex=new Ge.a({radius:tt,minZoom:pr,maxZoom:Ke}),this.clusterIndex.load(this.points)}},{key:"getClusterMarker",value:function(ae,tt){var kt=this,pr=ae[0].concat(ae[1]),Ke=this.clusterIndex.getClusters(pr,tt);this.clusterMarkers.forEach(function(xt){xt.remove()}),this.clusterMarkers=[],Ke.forEach(function(xt){var bt,Et=kt.markerLayerOption.clusterOption,Fe=Et.field,pt=Et.method;if(xt.properties&&((bt=xt.properties)===null||bt===void 0?void 0:bt.cluster_id)){var yt,Ht=kt.getLeaves((yt=xt.properties)===null||yt===void 0?void 0:yt.cluster_id);if(xt.properties.clusterData=Ht,Fe&&pt){var hr=Ht==null?void 0:Ht.map(function(oa){var $n=p()({},Fe,oa.properties[Fe]);return $n}),Zr=be.c.getColumn(hr,Fe),yr=be.c.getSatByColumn(pt,Zr),Vn="point_"+pt;xt.properties[Vn]=yr.toFixed(2)}}var zn=kt.clusterMarker(xt);kt.clusterMarkers.push(zn),zn.addTo(kt.scene)})}},{key:"getLeaves",value:function(ae){var tt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Infinity,kt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return ae?this.clusterIndex.getLeaves(ae,tt,kt):null}},{key:"clusterMarker",value:function(ae){var tt=this.markerLayerOption.clusterOption,kt=tt,pr=kt.element,Ke=pr===void 0?this.generateElement.bind(this):pr,xt=new qt({element:Ke(ae)}).setLnglat({lng:ae.geometry.coordinates[0],lat:ae.geometry.coordinates[1]});return xt}},{key:"normalMarker",value:function(ae){var tt=ae.properties.marker_id;return this.markers[tt]}},{key:"update",value:function(){var ae=this.mapsService.getZoom(),tt=this.mapsService.getBounds();(!this.bbox||Math.abs(ae-this.zoom)>=1||!Object(be.j)(this.bbox,tt))&&(this.bbox=Object(be.r)(tt,.5),this.zoom=Math.floor(ae),this.getClusterMarker(this.bbox,this.zoom))}},{key:"generateElement",value:function(ae){var tt=be.a.create("div","l7-marker-cluster"),kt=be.a.create("div","",tt),pr=be.a.create("span","",kt),Ke=this.markerLayerOption.clusterOption,xt=Ke.field,bt=Ke.method;ae.properties.point_count=ae.properties.point_count||1;var Et=xt&&bt?ae.properties["point_"+bt]||ae.properties[xt]:ae.properties.point_count;return pr.textContent=Et,tt}}]),K}(Se.EventEmitter);function q(ot,Ut){var K=Object.keys(ot);if(Object.getOwnPropertySymbols){var qe=Object.getOwnPropertySymbols(ot);Ut&&(qe=qe.filter(function(ae){return Object.getOwnPropertyDescriptor(ot,ae).enumerable})),K.push.apply(K,qe)}return K}function fe(ot){for(var Ut=1;Ut<arguments.length;Ut++){var K=arguments[Ut]!=null?arguments[Ut]:{};Ut%2?q(Object(K),!0).forEach(function(qe){p()(ot,qe,K[qe])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ot,Object.getOwnPropertyDescriptors(K)):q(Object(K)).forEach(function(qe){Object.defineProperty(ot,qe,Object.getOwnPropertyDescriptor(K,qe))})}return ot}function He(ot){var Ut=et();return function(){var qe=ze()(ot),ae;if(Ut){var tt=ze()(this).constructor;ae=Reflect.construct(qe,arguments,tt)}else ae=qe.apply(this,arguments);return ce()(this,ae)}}function et(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(ot){return!1}}var _t=function(ot){J()(K,ot);var Ut=He(K);function K(qe){var ae;return F()(this,K),ae=Ut.call(this),ae.popupOption=void 0,ae.mapsService=void 0,ae.sceneSerive=void 0,ae.lngLat=void 0,ae.content=void 0,ae.closeButton=void 0,ae.timeoutInstance=void 0,ae.container=void 0,ae.tip=void 0,ae.scene=void 0,ae.popupOption=fe(fe({},ae.getdefault()),qe),Object(be.i)(["update","onClickClose","remove"],Ie()(ae)),ae}return Z()(K,[{key:"addTo",value:function(ae){var tt=this;return this.mapsService=ae.get(Xe.TYPES.IMapService),this.sceneSerive=ae.get(Xe.TYPES.ISceneService),this.mapsService.on("camerachange",this.update),this.scene=ae,this.update(),this.popupOption.closeOnClick&&(this.timeoutInstance=setTimeout(function(){tt.mapsService.on("click",tt.onClickClose)},30)),this.emit("open"),this}},{key:"close",value:function(){this.remove()}},{key:"open",value:function(){this.addTo(this.scene)}},{key:"setHTML",value:function(ae){var tt=window.document.createDocumentFragment(),kt=window.document.createElement("body"),pr;for(kt.innerHTML=ae;!(pr=kt.firstChild,!pr);)tt.appendChild(pr);return this.setDOMContent(tt)}},{key:"setLnglat",value:function(ae){return this.lngLat=ae,Array.isArray(ae)&&(this.lngLat={lng:ae[0],lat:ae[1]}),this.mapsService&&this.mapsService.on("camerachange",this.update),this.update(),this}},{key:"getLnglat",value:function(){return this.lngLat}},{key:"setText",value:function(ae){return this.setDOMContent(window.document.createTextNode(ae))}},{key:"setMaxWidth",value:function(ae){return this.popupOption.maxWidth=ae,this.update(),this}},{key:"setDOMContent",value:function(ae){return this.createContent(),this.content.appendChild(ae),this.update(),this}},{key:"remove",value:function(){return this.content&&this.removeDom(this.content),this.container&&(this.removeDom(this.container),delete this.container),this.mapsService&&(this.mapsService.off("camerachange",this.update),this.mapsService.off("click",this.onClickClose),delete this.mapsService),clearTimeout(this.timeoutInstance),this.emit("close"),this}},{key:"isOpen",value:function(){return!!this.mapsService}},{key:"createContent",value:function(){this.content&&be.a.remove(this.content),this.content=be.a.create("div","l7-popup-content",this.container),this.popupOption.closeButton&&(this.closeButton=be.a.create("button","l7-popup-close-button",this.content),this.closeButton.setAttribute("aria-label","Close popup"),this.closeButton.innerHTML="&#215;",this.closeButton.addEventListener("click",this.onClickClose))}},{key:"creatDom",value:function(ae,tt,kt){var pr=window.document.createElement(ae);return tt!==void 0&&(pr.className=tt),kt&&kt.appendChild(pr),pr}},{key:"removeDom",value:function(ae){ae.parentNode&&ae.parentNode.removeChild(ae)}},{key:"getdefault",value:function(){return{closeButton:!0,closeOnClick:!0,maxWidth:"240px",offsets:[0,0],anchor:be.f.BOTTOM,className:"",stopPropagation:!0}}},{key:"onClickClose",value:function(ae){ae.stopPropagation&&ae.stopPropagation(),this.remove()}},{key:"update",value:function(){var ae=this,tt=this.lngLat,kt=this.popupOption,pr=kt.className,Ke=kt.maxWidth,xt=kt.anchor;if(!this.mapsService||!tt||!this.content)return;var bt=this.mapsService.getMarkerContainer();if(!this.container&&bt){this.container=this.creatDom("div","l7-popup",bt),this.tip=this.creatDom("div","l7-popup-tip",this.container),this.container.appendChild(this.content),pr&&pr.split(" ").forEach(function(Fe){return ae.container.classList.add(Fe)});var Et=this.popupOption.stopPropagation;Et&&["mousemove","mousedown","mouseup","click","dblclick"].forEach(function(Fe){ae.container.addEventListener(Fe,function(pt){pt.stopPropagation()})})}Ke&&this.container.style.maxWidth!==Ke&&(this.container.style.maxWidth=Ke),this.updatePosition(),be.a.setTransform(this.container,"".concat(be.e[xt])),Object(be.g)(this.container,xt,"popup")}},{key:"updatePosition",value:function(){if(!this.mapsService)return;var ae=this.lngLat,tt=ae.lng,kt=ae.lat,pr=this.popupOption.offsets,Ke=this.mapsService.lngLatToContainer([tt,kt]);this.container.style.left=Ke.x+pr[0]+"px",this.container.style.top=Ke.y-pr[1]+"px"}}]),K}(Se.EventEmitter);o("BGjm")(`/* @antv/l7-component */
.l7-marker-container {
  width: 100%;
  height: 100%;
  overflow: hidden;
  position: absolute;
 }

.l7-marker {
	position: absolute !important;
	top: 0;
	left: 0;
  z-index: 5;
  cursor: pointer;
}

.l7-marker-cluster {
  background-clip: padding-box;
  border-radius: 20px;
  background-color: rgba(181, 226, 140, 0.6);
  width: 40px;
  height: 40px;
}
.l7-marker-cluster div {
  width: 30px;
  height: 30px;
  margin-left: 5px;
  margin-top: 5px;
  text-align: center;
  border-radius: 15px;
  font: 12px "Helvetica Neue", Arial, Helvetica, sans-serif;
  background-color: rgba(110, 204, 57, 0.6);
}
.l7-marker-cluster span {
  line-height: 30px;
}

.l7-popup-anchor-bottom,
.l7-popup-anchor-bottom-left,
.l7-popup-anchor-bottom-right {
    -webkit-flex-direction: column-reverse;
    -webkit-box-orient: vertical;
    -webkit-box-direction: reverse;
        -ms-flex-direction: column-reverse;
            flex-direction: column-reverse;
}

.l7-popup-close-button {
  position: absolute;
  right: 0;
  top: 0;
  border: 0;
  border-radius: 0 3px 0 0;
  cursor: pointer;
  background-color: transparent;
}

.l7-popup-close-button:hover {
  background-color: rgba(0, 0, 0, 0.05);
}

.l7-popup-content {
  position: relative;
  background: #fff;
  border-radius: 3px;
  -webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
          box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
  padding: 10px 10px 15px;
  pointer-events: auto;
}

	/* layers control */

.l7-control-layers {
	-webkit-box-shadow: 0 1px 5px rgba(0,0,0,0.4);
	        box-shadow: 0 1px 5px rgba(0,0,0,0.4);
	background: #fff;
	border-radius: 5px;
	}
.l7-popup-anchor-top,
.l7-popup-anchor-top-left,
.l7-popup-anchor-top-right {
    -webkit-flex-direction: column;
    -webkit-box-orient: vertical;
    -webkit-box-direction: normal;
        -ms-flex-direction: column;
            flex-direction: column;
}


.l7-popup-anchor-left {
    -webkit-flex-direction: row;
    -webkit-box-orient: horizontal;
    -webkit-box-direction: normal;
        -ms-flex-direction: row;
            flex-direction: row;
}

.l7-popup-anchor-right {
    -webkit-flex-direction: row-reverse;
    -webkit-box-orient: horizontal;
    -webkit-box-direction: reverse;
        -ms-flex-direction: row-reverse;
            flex-direction: row-reverse;
}
.l7-popup {
  position: absolute;
  top: 0;
  left: 0;
  display: -webkit-flex;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  will-change: transform;
  pointer-events: none;
  z-index: 5;
}
.l7-popup-tip {
  width: 0;
  height: 0;
  border: 10px solid transparent;
  z-index: 1;
}
.l7-popup-anchor-top .l7-popup-tip {
	-webkit-align-self: center;
	-ms-flex-item-align: center;
	    align-self: center;
	border-top: none;
	border-bottom-color: #fff;
}

.l7-popup-anchor-top-left .l7-popup-tip {
	-webkit-align-self: flex-start;
	-ms-flex-item-align: start;
	    align-self: flex-start;
	border-top: none;
	border-left: none;
	border-bottom-color: #fff;
}

.l7-popup-anchor-top-right .l7-popup-tip {
	-webkit-align-self: flex-end;
	-ms-flex-item-align: end;
	    align-self: flex-end;
	border-top: none;
	border-right: none;
	border-bottom-color: #fff;
}

.l7-popup-anchor-bottom .l7-popup-tip {
	-webkit-align-self: center;
	-ms-flex-item-align: center;
	    align-self: center;
	border-bottom: none;
	border-top-color: #fff;
}

.l7-popup-anchor-bottom-left .l7-popup-tip {
	-webkit-align-self: flex-start;
	-ms-flex-item-align: start;
	    align-self: flex-start;
	border-bottom: none;
	border-left: none;
	border-top-color: #fff;
}

.l7-popup-anchor-bottom-right .l7-popup-tip {
	-webkit-align-self: flex-end;
	-ms-flex-item-align: end;
	    align-self: flex-end;
	border-bottom: none;
	border-right: none;
	border-top-color: #fff;
}

.l7-popup-anchor-left .l7-popup-tip {
	-webkit-align-self: center;
	-ms-flex-item-align: center;
	    align-self: center;
	border-left: none;
	border-right-color: #fff;
}

.l7-popup-anchor-right .l7-popup-tip {
	-webkit-align-self: center;
	-ms-flex-item-align: center;
	    align-self: center;
	border-right: none;
	border-left-color: #fff;
}

.l7-popup-close-button {
	position: absolute;
	right: 0;
	top: 0;
	border: 0;
	padding: 0;
	font-size: 25px;
	line-height: 20px;
	border-radius: 0 3px 0 0;
	cursor: pointer;
	background-color: transparent;
}

.l7-popup-close-button:hover {
	background-color: rgba(0, 0, 0, 0.05);
}

.l7-popup-content {
	position: relative;
	background: #fff;
	border-radius: 3px;
	-webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
	        box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
	padding: 10px 10px 15px;
	pointer-events: auto;
}

.l7-popup-anchor-top-left .l7-popup-content {
	border-top-left-radius: 0;
}

.l7-popup-anchor-top-right .l7-popup-content {
	border-top-right-radius: 0;
}

.l7-popup-anchor-bottom-left .l7-popup-content {
	border-bottom-left-radius: 0;
}

.l7-popup-anchor-bottom-right .l7-popup-content {
	border-bottom-right-radius: 0;
}

.l7-popup-track-pointer {
	display: none;
}

.l7-popup-track-pointer * {
	pointer-events: none;
	-webkit-user-select: none;
	   -moz-user-select: none;
	    -ms-user-select: none;
	        user-select: none;
}

.l7-map:hover .l7-popup-track-pointer {
	display: -webkit-box;
	display: -webkit-flex;
	display: -ms-flexbox;
	display: flex;
}

.l7-map:active .l7-popup-track-pointer {
	display: none;
}


.l7-popup-close-button:hover {
  background-color: rgba(0, 0, 0, 0.05);
}

.l7-popup-content {
  position: relative;
  background: #fff;
  border-radius: 3px;
  -webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
          box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
  padding: 10px 10px 15px;
  pointer-events: auto;
}

/* general toolbar styles */

.l7-bar {
	-webkit-box-shadow: 0 1px 5px rgba(0,0,0,0.65);
	        box-shadow: 0 1px 5px rgba(0,0,0,0.65);
	border-radius: 4px;
	}
.l7-bar a,
.l7-bar a:hover {
	background-color: #fff;
	width: 30px;
	height: 30px;
  font-size: 20px;
	display: block;
	text-align: center;
	text-decoration: none;
	color: #8E9DAB;
	}
.l7-bar a,
.l7-control-layers-toggle {
	background-position: 50% 50%;
	background-repeat: no-repeat;
	display: block;
	}
.l7-bar a:hover {
	background-color: #f4f4f4;
	}
.l7-bar a:first-child {
	border-top-left-radius: 2px;
	border-top-right-radius: 2px;
	}
.l7-bar a:last-child {
	border-bottom-left-radius: 2px;
	border-bottom-right-radius: 2px;
	border-bottom: none;
	}
.l7-bar a.l7-disabled {
	cursor: default;
	background-color: #f4f4f4;
	color: #bbb;
	}


/* control positioning */

.l7-control-container {
	font: 12px/1.5 "Helvetica Neue", Arial, Helvetica, sans-serif;
}
.l7-control-hide {
	display: none;
}
.l7-control {
	position: relative;
	z-index: 800;
	pointer-events: visiblePainted; /* IE 9-10 doesn't have auto */
	pointer-events: auto;
	}
.l7-control {
	float: left;
	clear: both;
	}.l7-top,
  .l7-bottom {
    position: absolute;
    z-index: 1000;
    pointer-events: none;
    }
  .l7-top {
    top: 0;
    }
  .l7-right {
    right: 0;
    }
  .l7-bottom {
    bottom: 0;
    }
  .l7-left {
    left: 0;
    }

  .l7-control {
    float: left;
    clear: both;
    }
  .l7-right .l7-control {
    float: right;
    }
  .l7-top .l7-control {
    margin-top: 10px;
    }
  .l7-bottom .l7-control {
    margin-bottom: 10px;
    }
  .l7-left .l7-control {
    margin-left: 10px;
    }
  .l7-right .l7-control {
    margin-right: 10px;
    }

  /* attribution and scale controls */

.l7-control-container .l7-control-attribution {
	background: #fff;
	background: rgba(255, 255, 255, 0.7);
	margin: 0;
	}
.l7-control-attribution,
.l7-control-scale-line {
	padding: 0 5px;
  color: #333;
	}
.l7-control-attribution a {
	text-decoration: none;
	}
.l7-control-attribution a:hover {
	text-decoration: underline;
	}
.l7-container .l7-control-attribution,
.l7-container .l7-control-scale {
  font-size: 11px;
  padding: 5px 5px 2px 5px;
  background: rgba(255, 255, 255, 0.7);
	}
.l7-left .l7-control-scale {
	margin-left: 5px;
	}
.l7-bottom .l7-control-scale {
	margin-bottom: 5px;
	}
.l7-control-scale-line {
	border: 2px solid #000;
  border-top: none;
  color: #000;
	line-height: 1.1;
	padding: 2px 5px 1px;
	font-size: 11px;
	white-space: nowrap;
	overflow: hidden;
	-webkit-box-sizing: border-box;
	        box-sizing: border-box;

	background: #fff;
	}
.l7-control-scale-line:not(:first-child) {
	border-top: 2px solid #777;
	border-bottom: none;
	margin-top: -2px;
	}
.l7-control-scale-line:not(:first-child):not(:last-child) {
	border-bottom: 2px solid #777;
	}

.l7-touch .l7-control-attribution,
.l7-touch .l7-control-layers,
.l7-touch .l7-bar {
	-webkit-box-shadow: none;
	        box-shadow: none;
	}
.l7-touch .l7-control-layers,
.l7-touch .l7-bar {
	border: 2px solid rgba(0,0,0,0.2);
	background-clip: padding-box;
  }
  /*logo */

  .l7-ctrl-logo {
    background-size: 100% 100%;
    width: 89px;
    height: 16px;
    margin: 0 0 -3px -3px;
    display: -webkit-box;
    display: -webkit-flex;
    display: -ms-flexbox;
    display: flex;
    background-repeat: no-repeat;
    cursor: pointer;
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALIAAAAgCAYAAAHBIxK2AAAABGdBTUEAALGPC/xhBQAAIJZJREFUeAHtfAl8Tkf3/9z7PNmDRFbZSawhQcRSaqva1xCqpataqrT2UkuUUiqlaKtafe1VS1pUiypB0dIgIkpKRPZIELI/2/zO98akN48nltL3838//84nNzNzzpkzc+eee+bMOXMfxijNaMJ7LOrGO/HdYfZ8fb12gD2JJINJdR8WNHVQnRtSn7hilpz0u2DMKaEcFhZmhdzLNbiPyNVlwPxcm4Qh93Fr0gO4Ol5hfqiz6Q14G+QzGpYzQ9nXrUl7X/fgbrXdG3skX7m26+bNW2fQqJ5XmCs6RQKd6EQwB0zgtKgsvCidGF+N8wV/SBLqSKnXzx2WKIHw1xNxq2xtrKsBXqgrbePt1rivJFmloa5OoD129NcVQwa9Phxwaflw3ifvHCus1YIVjW7fwEF66dIhdYO/XV7Qk+9HY/5F7RA+w0G5TdRxq7gw10FBPWwA+3r9jpkYGcoJ5/7YiFxMiYCjLspsekOeCiJ1AhJJNER+8rfTX/j4BNcUMNCLMmhF+wC3cE9RZmMd/0IQjeTtGdwJjURD5EajsRQN1EwEHjAkUVce2LLhnKf8xGId3ZhkX4uxmj7MMKqJz0ZmMr3MJNZBmphV8WDBOCCgo+2QiE7DF3005wvU75e8vMLs4+P3HwwN7do5MzOu2NcjpPHRX/csCqjt2wvtxEAy8xJ3o+7j3jjkcurpn2xtrT0EPiS0oQPKSOfi/ygqL9H/qNbls8EXuer4+65xUa149QnBvGYFgapAN21EZ+pnuH3rrrnKdNA/zCRmjoqGzu36RoL21q38BLAAjRgo6iir63g1QAOcOoU27DAgwKtpPzVMKU+qBWIuve3Jx0zw4j/eQ0CASeNnjUi5mrYH72ZxUfFV0emJ479/BvrM9KxDAgZZEjziTp1d8+pL415sEdJloIAhF7QCZmnQoCkuLkkXNPfkozU8b4wVb30P4i4ADNQ41P08mtSBogHc27Vx70CPEHeUgRNwgUOuTqBR8wwODraGSIkrKipKxqVuI300mntri1jz9OOs0IHeHUdvms2t0iG+vn5nxmnan5QeUff6GGWttpidSjvGbCSZJdAAGTMwtjWSH2G5XrOp3oEv9wuWxqdeUPchZkW8OGqcedmcdujgUcMOH/zltmgL2YW2Fu22fbMz6q2xM+IEvmvHiCGyRq7AK3QLe959+T6v46co0uVBisLk0/9SqIIhcnQiVBPqULJ4dPVd2ypLg6Dx8wxuhAGDHrCOHTtqUfZ2b6KsYYIOuUiXL1/dKW4SMJRxkbbpG9nv5ecVutlt+PSoNvw7VPg8V4X5wqf4YQVp9g+NDQZDITr2cm/8lNIGlbvp+edGD/946eqJqOKmoBJRhjyjrclk0qlZAqeumw8YOEwE6ILdgh0raN9pcHeWx9n3mViPh9IKnlmBVBWI4bfoePDAEcOGPz9WWUDBzMe1cUdft5CnUfb2DvFR8rsz2avrkOdmT18wJisz5zDaqthVWjwAtzRgtBF9VbSdVofXIPWmB2CCouYqUBUFH59QbwwEqg0XykAi96/VuCEetRrm59msEfA+nqEtAUeqNEt324JGJEsDxpMi26gnaCpUxqJk6bahkGFp3akrZO8IBurcVGponpGW+VOdQP++uIAznzE1/cBBvRRZTc+OP0miUBJ78OiyxNxE6uX+KSP3vDIZuEE/z9BgWZZtHHj1oxZbkS6uJFNqIn+SWSy1AubjFtLd171xoHrQooyFQJRB7+0eHBrk2cxNtBW5mgYwoYNFXg5r7CvoFXWxajQ3mjiTc84wVkB2kTWt5NYk3lZ02SCvzphDDVrNZOY2p3mdA0wrhQoGSm5ig6SRyTsqwSxUaMKk+t4tXJIy4/IsoP82yNu7pYusKwk2WdslZmScvGHOyNs1tJ5GNrjVaeT2W2xsLCnuv5J6woQq/QtbXoLCMJqYtbWj208pKbGK4aamgWJR19XlCvpFEdxn6SDOl0byAjXB/cp8rlM/PteZ83k1T92PTuAw0Ly8GychmosWLB/v7xFSW+AeJQ/0auyLiYFEBgQ0dYKdDRsJfFOvpe0V76fgCVrgkNQTao63hAONr2vjFtAFltoTTFLzB415Al7RFdNipHRviWlLbzCHhZ05HxfEy9e7T/zX8FV+XLk+96e8Tl0xOJZfOpjdKp4kzboZXgGrouDj1rTunHnTQl1caoZ/unLNlKnTx32sNxobR0ZGakQTDCY8tEtEkG+LfihDg+NC2ccjpBXoyMTqVaLjTaFLduxe219XqH+67HYGKU5D0pbN30X5+vl0a9m6mZOPTxvFUIayPRAbM1RpS1uztp0a/SD6e9hcYlKVqgi7QEg/DAyRsAUsKSlNLyvT56Bs8e2Ias4LZzfnfEowJyOOVocZDs9jt8YnMDvUZzblZ+jis1rwtqg/KMHgwEThCUOCUS64U/An6iiL9oIGcFjwqMOQQB0JdTyEXd/tfR/1rMzsWCrPBxwPCxJMfJMELVYq0KO+fNkXk6CHRV/qXPSLXA0XZejpqiRZ0IgcY7hzu+AS2TB3quInaNnU2vzSlNqcT/fhHSqAVJgawAunEXxCPU4W9MMlcRN0ryZMAl2XcOHm6YlnYgMAToIOuxks+YBBErGrAa0YtKDDDkeYAaBFErjSUl2uKOfm5v1GE9y1nOLe/4IO+b3YchfKw0wy3lZ6m2arxyr4KV4RURH54qtS/fGufEMZZ7Hja/Ko0ptsgYML0+kKGM+4wbTbmGQUtPfLMfBrWWc3gIZenX4aJmUp9OQdqunk4nv2QmzMus0rO730wtj0qu2DqnuQjCYbrOjYrINq5JuRe/CKQp3QtRMweivm0yur+FBQf9xk6WFQX99Tvw2GDO0390jssWXW1vKf6n4q7Dc1EOXledJwQxF7RV/EomQbptMXssJlNyT5YSe4dq1m/s907eik1WprNKjdur9sW/1AWt7535Ur6/zvN2/lpcds/37eM892mEgTXGHuHD1y4qLRYK0YvrJsMly5knKu0tg0csmObbvfC2/ZbETK9bOnW4TU7xtGEw0a2geZbKysz/Xu9txQvV6fX6VOrMTw/hVsdF8b/tbGgX1feqF1m7Bq5hda+/o+pVgXm9Ztmzk0ctTBlMyEi/fnaoZ9g3HH1xmv5GgwI/m3+oAZUOzkj4fx7rQBt7qdxnhJDiuj/YlBe9dG1pLNbF9D8c2dem2xVMA3NQhjBk6WMyVaelmZVaL0+vmcB/Tz/zVa+8lIPlWW2SLMQh559ZSNCE2sbCq/FBuLyrrbLJVHsYZMr/sdfpiKJOv1pOxtyISp0tQRtHXqhNWQZffSy5d/LBOwJ5H71mrcAnzSSA2Z84ObJPlCbiujSZubkRefZI5X61hL5pavbzMvY4kuTCuzm6nXE4+Ztwf/lBRmcW1zcSkwxsXF6bWmEnbQSPJsoqWMZumwUqYC7QCVi3Y6tMmnCZdYDItiJezj0v3MaLJmRmXX58w0zKJ3w3ww2IwE+fk7JSUll9b2Crl4NfPcJXOav1OH7fyfdSs6cS7zl18Y65GRd36Pmk/S+dwex0/tHTN54pxNJ0/I2tTsM5WccqDFQgn9rW4nyphg4J95ut9gZis7p6Ym3BI4L9eQ+sS/ntrbLXDIE8/fLKaHVP7goyN5whKyKKMHcsWboSasqsznORfSRYEaz3v29uZt4JiDxMC8QVJLjzntg+ow+dBe7BhRJ1MwQ/AVkRbwQbBj7OtTXgVu49qt79LDrW/OX4yrqjEJ/OIPVrwlfM2CB/rW6XQ3wd9SgjsM41SsC9pLt+H0AptK2fdRjFdYHHwdhY0QOsL1VZDimkIHfLLD8xThcmCF+p3SjOxc0WlV+Zervm2x68dN/QQ+MLC2DVSHqOOVw6ZFXDRgCXjUBQ1y7Py+3bO+HyQLO0bArGV2auRrkxRv1orPPgjXF6XVARxJz0vCPvz4vbkoT50899yTenvAD0ljLx0L8Gr2Et4C9XXnTkEiecNKv/xiU/q1nHNXlQmN2iYVlpWwL0qLmSR3ZNFgQCpCogXuLDMa45WrTH8AcCVpTL8Q7ChbVDhAgO6XmwwGj7AWoa9lZ+UcBt3ufZvn6Ar0bUSbP/+42cJQ7NhbNjj3ybpW2p0G3LtP966DUIYk0TbZDr4Kk9Ho7lXLw1+0g6qo6Wtz8+f9sfmARQzqPZNWiCCBJ/NLtrOz9SkoKPxDlmT1SiJIHiuH6oAeF5e1o9XRGjWqa6pXrxbcqlm3YY7Wtifu6WDeU1xHF59an1cDki9wm8nnU7h3AV0fergDNrsln0+BtKUoP0yizYJr/57DhuJ1wnY5/mziepTVr6e3R0hrsbPLyck7BrxIZO/eAi2uuwE4I3Aok5rIAtzPPbjtxQuXtgCOOtQTwkqrPvlqMmBd2vcfDGeSpfGCXrS7H96SujCnBy+oj6LComSoEoGvUA0A6EvZ8DLaO9nYsUOoSzNy57Oi4mJyBu2SpuRcj2rGvZievUsRgleBf5gk6cpabd62egFoaYtr6NFl8DaUoz96LzTAq0kDlNWppLhE2UTg9Tuf8MdG2sw4DRjQU9H7e3b/FE2vomLoU3nJjm92rYSEwoXZuX3EJvDZsWtdz/+sjGlqMJqCXx/90jzALlz4syQl5awi7aj/EwnxPfC1srJy7ti232Sb6jZHRT+VJvm909I3pjKWayxjYdODeLkO1hnC2OLC/mhQWsJO6UvInCtjHQWDB+XKK2tvF3Dq5JkvVR4t/tzwiHk6namuefunwruvEq9ft86RW4Ef9sqQcK2WXRkzYtKBgtsFGYCNHjHpt3enzd+cnpvwo8pHbKQd2Wg9M3qDhjz9tqd+O7tao2XZqP+TKf8Ga3vyzP630EdGRpY+OTnutuiv0iQDqDOxVgaaSDLpjqMuResukoXHpwTw7jT5XnQlfHBBOgPcgxIiEqu+jG4NuoYN63a4mHzio0vJvy7Blhcwa2srWW0NAFZVgh0uaTSKj0LQYFERZVmy+WP1Z2uno25vZyd/tX5FO5T79x72faoF+xm4J5m4geLOPl7PHPvl1CeyLF1T875nkpdckq7qdOwIqY4aEz35i+XEXCYJ30MXs7dnSghSzaSqMunN2n36dZsBfG7uzYt3r0vpaVm/AHbkxJ4xJYWpD80PbapK6bmnL8+dvURRJXsPbXu5W49OU6n/ItA/zEapKr4PA8fC7OVVS1EXgwe8sq9Nh4aJ6nYWdyrFmayLvQsrIwleF8n4Jk9ntlCvo00gZ6ujE6UHBujQAZw2ZY52Cv8fvj/wwahXJu6VGFdu2sh4rdTs+M6+fl7dSAI+kTS0yfkbCWEndbhJIzPdjRu3TgcGBijqbcHc6Km21iz+b7C22KTEaGxFi1slHDyLsrGgKHr5kvYCsW3btkpeynskGYSrmaQnvTufLubhyL6WDGwK0zH9ypvSKMHoQXmuoaztz0diJoHu9VfePp6el3BYeOGstVYJ0Ys/VSR81OjhPmQqKAvbg3hqZNOd9PTsZNAt/3Rhi+5dW/cmy6SzaGfv7HS817NDlUUWsFWfrU9LzkxMFfjHyadMe3MZ7HPzCwJjMnK/8JbNI6rib1GSQfxpoTT7TRs+mYzLSJJoWkTYsKqYWIIbTNzWuaZTA0iWOT4l+2zKxx99fpXCUKxXv+5hn6/akP7n5eRztbw9O5rToi7cnx5+0rWIvi/uSU4/M2BgZJ/ZAwb2KiO9HynaXLp0rIAkTZeff/tc7MFju2Qm0T7r8RPcnJa43MjL1+PtocUif8SrE2ZkpWWX0Tmbex4q5q/KNFLLO8mcHSTXRc7nRsmzSkILCOzWsJkAypLjBXE4U+mdtmSCGclC+AEbC8US0Wh+u5Jz7jraIWREYfRGuJG064n7AAvxCHHIMxorpLcac4q9lHesYjLRb06qrgtZMoVpuecqzCi0tZRg2wq4pXEiKCDwlnIRMMD9WFvrjGqrwhK9RRj5kp+bwLgS37NI8C/wgTOgSPLyV7ibxoa9Rp7kV8nrVo1E3qSjJSr/CuNlBUxHTswSZmLFkhWTtLSGUqSEjO7yXEN1DZW1FBuQrQllxzK5FVuTc5HtnnOIwlRf1X6Waa1GM24KoNGQT69SkpiGFtIyYwwrMK1jb1+9/U9bApV6/7fyxGYAwewzZ1IdiosNBvF2PzHmD8FIWfcoKPIV7ZZ7Q8rImmJGPWPpR0jqdMxEAs5IgEkWCUm6mf6YRITIOXIFUC6heCvIyguhPIR5s1PE9TYrMixlWkM9ZqRwC2jLkywKSm4tPc005KKeOxe+qb+oKhE9fAUOvLLi0ubYH6AVNpoaLU++lnWezs8/OLbw8D09GUp8HkB7wHCEEwVHjBkOxqvX7x906kgOzMvn89qZWLm7SbSXmXwnqLHLMdVmWKAq5eolSY2wtDyp8aIcFNSqekl+Uftjhy5IbduGV0tKulrCdMEGrcRupeYm/iLoLOXkMpJqe4fUN+hZHRM3keQ9Wip3IGiSEIupmLjooXwByeoUA2daCrSw4nx2Kucye86qhJUq7MUKSznt+SqSHcq0KAqY1okZxqySrlcQUIEvJ7e+RDocW2JdmR3T8K0UT2lOwk1viKQnh2oUuaIqrFt120ct4ySGwaALHDPuVb8ZM9+OxjlFOh95oGXzrsvpxk2e/jb7ERB6VL6PQw9hS79427lUqzOOGBGZj5i64IcPYUp1paHDXxzs+UH07NUCvnrVumlzZ334h0ajuZqWc+68gKtz+Bq//CSmq4kbrRL/PDbPyalGKPDJySm7n27V+wtJywozshMPqduYl4Ugw/oHDm455A8ryDjEhp3CkV+/HxEYGKC0/XDRyreXLVmVbKeyE8HTPOE0DNmONhS3Gu0f4NPTHP+gOj7JGRwx4icYzRU7kUlfSzMW9+PJJMTLS03MztqahXs1YuuK8tmAqFgp70FM74eXxpeHTvhkR3eKY2wic6K5YmRoWBE51UdI825tuV/7h8Uh1qQzFAf26vusy8zZE1eKdt6+Xl1ooovbt+795fVUXRuC03rzzyecisZBYwoCsvETRgbcupFfunrl1mwSHtIW7EpqduKF5My4VBIG9w3rt7L+g3qtggsRI3t91IvzNq7d/sKVK1drk8bOtaSZ16zc3pw0sdV332/sLYSYzofd7tdj+H/Aw1O2/S0DhX8wlWvFv7eI0jpJqs1gs33brv09ej6TT7wqFKulIbt7utalw5RKxJwO4+yCEGMDFdjILbFCkNFw6k7py0XP8qu0Fm8nl4UTcW1nY81ORHXjPaL2SZcFcxq2xNbUXsSstB0oiCbA5TkWCCMvYQbda9KotCuVkCbTQGYyNCFb3ESh72wmayOlRbePV6L5m5UAOh+sK8wNh4tzxaeLF99lY6KjunGuri7h0BZf/GfZBfhQfDyaNEnPSUgw70o5bm8yuZrDUcdSTXftYL4EaiT5tobZJqXknsq+p52e+wB28vT+cfQyPYtyxOA+nw/oPXwPyiKl5ibE+Xs06UJb9x/OJB4OdXd3aUMmkPX2XWsnNAvu8EGZJDWhZfi62izyouPDRh2v9cabr/iGt2o6UvCa9c7CqfQFo0Gy0ZyJyyg/uiZw/0SuNocelX9qbvwv8F5+suxzv6VLPo211J6EvRZWnCXL5jUb+sKAoaDBh5SYKzyT1JxzRzAvlQQZRNN+kn6Oepq3JXn8gar+JKZBRPQbffnSJ+qEpAgdCTjnt/UbGCt7jkq+lbZwVmQqGPlcaVJWhRBHPcXd6ciG29xDbOecNtIGCm3VkKJLnqiy0JfcbIvxxx7fOc7Gxkpx6G3ZEDNn1rsLEy5cOb6GIkIuPXt3eef5FwaO3LxpByNteTM9Pb7yGO7az7+fPTBR+Km2bIyZPWPa/Pi1m1b0b0FONnt7Oz/0g0Su6oLLSVd+GP/G9G9154uLtZL2lsnGPo6XFjyDB0wx33JCC/8NBoavKQKBogB8noskH89jxs5dOw78MC7h5/VkUjiSQD+1fvPKDi8+/+ZhX0/lawzl5bv70jZ1dHTQTJ0xfr5gv+/HQ4vXr/smC/GC9Ixz6QL+T+aPo5ExrvT0E/BwX7I0RoR9TSajFebgmWc7TgINjk6OG/POKVnLctKzE06SECtNK2+67nKLOipdIEEOp7jI73QKg+lKWE3aDB56N5wPuUvCpInpCazEEM7yS86wQloh7tBVXFLEbpa8REL8fjkdl2Y158NItDOp/XnZimXM/ZW3lJY+WSH2dwttRt5o+6+3r+6C4A/6Tkq6EjNp4uz44pIS05wZi94V4164ZNYSN1cXKyz54hyowFnK+0X0GJGccXpneKuwQRcvJB3YvXPfAgSX6CPVeBK2avUb1huy79COLecuHp1Dx5fgU+wCId70zapnhNdZaGPwb9mq2SgBRx45uK87p1Xgjh3NjrV0FmHm92YtnirGggfYp09XV5PRFIBNIeDGohstke/9edtrCNmifC0l/YdXXxz3Cxy76dfPVz4DC4L/sYQvkhFh+HT1h62EEP+45+dFEGJ8xp6enXhSfUsWBRkEM45KubIDe5qE+DsE9XSlNM2lbMv0YP4OxaJIzsm+ePd6DivMb8vu6GKYviyJFRq7Se/d+hq4KMa104PZLBLgDXRiRkPhbU5h7s03PNgx4J9UCvBsGqDnBh/YoO07PDUefEtLyzK7tI9Yh80dQtTr1m7JPHL4+HLg6GxB9f2Hy0M1CNtg5wx4VUnWaO1bNn12YJBfizf69hr+5Zujpqx5PnLUp43rtZvVtFHHCBFAdHFxDlu28v1w8JEljf6FIaN/FseJ8DGe4I9wvYAj37Z113XZVnsaZxUyM8+nkYJJw5Gjn386/JFos3Tl+3NQ1nMpDB/aGbmpxkfL329Wu46fcqiD7je7U9u+n0M72jr5nhDt/ldzH7fgIJOJ+0+aNjaw34AeihI6ezph7YiX3zpGk3sjI/fsWfN7q1KQQUibvNIF51kECfMysmuNlFPUjy2sHchWvhzAyXNM9aWshDTsQOmD0vrShwWKkI704vZFddkXRDuXhJgsELKYS9n7CxKkF1b8KNFr8WQS3Gw6g74JztRNeefNDwXXyeNnzSIBI88gl40GpkRyhg4aeeD69RvKQ8aSHbNrfS+Exvy8yn9OQ7Q1z2kCd+D8BDZnGdcTTqTmJCTjRKgky3nQntezc0+JNl7etRT7WqM1XcOuX9ZoKnlvBB1yrdb6CmhwqU2cjNzEs/A2vPj82Nj0tMz9oLWzt/Pfd3DbYNjntJmr06x5Ywf6ZEIRbuBHvz5lWplOp7jrnvRxZPD/byZ8IE0u3IZ16wbaTpw8Zgn6pjBiQq9uQ2Po6/SyjJwEiy/qfQW5/AYkvviyNIEEcgIFqstweou07GgXA4sZ6cxrlNP89X9MDe7sILM9JK4v60CrYyUlejZy0Z/SrL+oHr8EB7w4q7hr78ZZcLMJritXL16jXr5FGZsoQdOqTfNRM2ZNrGvU81pVfXUGWnoZlN2seqOl8PgH/dFWtm4noF07te33KX0GmIv+GjdpOIzs4SCUN2xZ9Q5lyrPbuuW7uT/tPXjLykq6bMmzAfr/pVQs3WmG8W785rMRlCkr//w50eWrKWPx9zyHuzenvZs/MItOl1a85cGvajjbpJNYdYpd97C3YkfH2fGeK0qkdDCg3x4JoI3fXknH6hMNRnFLx9igZTnSwQd28IgExw9fpO9PTVbQVOR6CkFzslvP0pI/+36scLwRp+9A88a4Vxbt2bV3WHz8hUb0uzm3yn9i4H6tVbgHmCQqykcuptBX2/6uYXFk37d4+413pn62Jvo/YPLm+Nfmt+/QZouzs5PiL066dHnrhHEz4xB8QLDnkTv6hxuQtyWAPESKXV9VV5JReyM193QWBNTXlT4Y4boaeGF9fL26og3cbF9vjsmRtdqcq9nxVX6R9NCCDKYf50jfv+3EO5gYHYbjzItATZg1OzVG5t3IFrWmjeGPpL9cCQ8HXYpGw3rQB38XUX2SCd8ilOmMrouXzAmBpgJvsnUNg/u/shBlnMC2dD7Wzy24HTaAzVuFxtSrFxhBk6fd+u1X8+rXaT2Jlcmt6ZzVHQMYPKEk0SecYEVnd/WCpZNzjZoKjII28FrgvK9tDftjly//dkfQIL+WF5dF9nDyrl37WLeYZ+b3j+g5kzaX9s2aN3kV+OLC4iud2vXfiMMqdYJdfk2NBfT/jfTc0P49unXrVKXQiVEWFhUXvT12xgHaK+jpxf3doNH7IUjWf0DPZwXNvh8OHkFZMsiKshRw8/yRBBmNl+VLZ0fb8ZayzH4krdyEnpQnudbiKRxMAbry9Y5gJwnfOzpfUpZF804fp46dOwlxvY5dnnZ64aVIRbOC39ovN8/GAW9ZsrpoSYhBU82dnczPkbpiI5iUcrK1ra2Nl2M1x7oHf/lueOd2/TeYmEnxAID2iSSDdQbZVp6ff7J214IPZ3YnnnLdunUiyNSJuMvfSC/fi8eOnepAp6EOnss5Rydc/kp0EDORfuXOZeyoqSeDmzSIQVtg8Q3K4IGvzkSZW9vd87sdgP+3Ejw05n3hFxroMgffU6f7KBs4uM8fy5euTjFKRkf6ks4FRJ61PJojL7hTePH99z5Kwsuael3R2gBbTPcMwiKVBeBkxh0KtGw7mQ/dhbeUynihvrU2sKEr2JPb1Km7h238a+ylp4zc6IRNXsdObV3JTswqKCw0kUeCNmLxiWp68zLOBpTeLm5LGydt377dXJycnazhewUd/K/YLZPmk8aOf80/LSW96Ntvf8jFRGodXA5iyRf88Es5xQZda0GbkZZVtGP77ntocaKXlRW3wQOv5ugot+vUyqluUGB18CGT5hZ+jwuOfRx0FbzVOcLQaz7Z0Q6eCsDRHzayiodCI58URwXVbR6l/Lghavw6hYGZsDr/rYSNLSKQcfS7AwiOSGWF4eJewRAmRVAD59MPOjPytwUZncAN5yyzhVacDSFlbDJIbO1qkzQXuP9Gql+/bTXj7WLbUq1t4V3H+kN3q5zWOnq5Jn05Jdm6GvMTExPJnC9PCDgYC2/X1Mp6o38j1xv3m0Q1LT5wu985DghlzGcxdqUaKzvSRpLJXtaFhdUpND8mLsZhKQcPuhSTxRL+UWFCkM3bPexZC/N2/9b/nYF/Z+AxZuD/AA8zEhkTLyOGAAAAAElFTkSuQmCC');
}


	/* layers control */

.l7-control-layers {
	-webkit-box-shadow: 0 1px 8px rgba(0,0,0,0.4);
	        box-shadow: 0 1px 8px rgba(0,0,0,0.4);
	background: #fff;
	border-radius: 2px;
	}
.l7-control-layers-toggle {
	background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAkCAYAAAGf7Ah0AAAABGdBTUEAALGPC/xhBQAABzdJREFUWAnVV3lslEUUn/l2F0tpwdAih1HEqCReDcphNCo1EkgFkXa5PNpuC0Fo2e7Wgko8KiaKWrvbK5672xYFpNtiRRuNiY0aURA14BGviBcVlaKltVa6+42/N9v5Mrtt05rwj/PHzjt+8743b+a9N8vYwKgMNlUQyemnMtAkaJajvb3dToQSGp8e6boopkr4VYgEMYwO0vhCTfMVzBcMf8bx086YyODcuM80zTqp9IWat+7evW8sMdIxIqqCLa6oiAaJpuEtcBqcc2HEWMZ0JclgZR/Nchf++ubrzKjJSguXS4tVjXvPjfb3/UAAacGTn/MOMb7QnjNpNqP/bKZ50Ai0tqYmCi0n4zbM+W+lBc7JBOa+QPhDwcTsxJXE2+32edKCL9h8hRDmRzpIOWydAylhrcMfDN+ugBRKSdP3KwPhsFJIPth02FISIYQwYsDYcVfWhy/Bon4JgumffMGmiGTwQ0B/sHml4q2ZFAD3WQIQVhx0IdFw8B189lolN+w8w5PnjPmlhJgtA8/vfn3iye7u3yGzDljDxZEG4097Cp3rSSjBtMHunp6vFR+HHoIxmbgTe1xHKssDHecLNFUjMzbqMs5ZlHF7ute17M84+TMHDzr+OvR9JwKdCms9yRkzJq6bPTsWXh05QOPUN+PUHyPWMPhm6UHd7vaUohWZPSRE8OqxpTyibQa/qcTlbEP0vwF7AWUAT3JM9dy69FfSNza+MU4awNE8iQtXSkJuGLleV852ov2h5jkwVof0mUs8aO4LhTuYYFOAjExId0wcFIPahpaLTkWiX9ECfHG/sLNi1i8+HODfgLFFRI96+INNi0cNTgTS1obKQh03aAuk9DeELzcj4pACYivvwvXrFK/PcQZiQWo+hmidpYMUjQC7EOB6xdNsGfAHwk/RDdOVw9Dm+NTUSWtWLDohDVQ37JkbiUT2DwMeVswZP+gtdM4x3HnLDhjcGM2XLWOISaenIGee9MCSgqgMht/H/q/SZYk0qviV3oKcj5XcioESyOoqIseFYDYloxnAGm/hcrcuk3JV2XBMl+pKqn6mENux11+w12m6jpqMMFn7rPPTHdwfCm8yTfG4tMaNu+GepPUFiqbM7T105ARSPQU+dY/LOC/N2gI65WEkyWUEtjmSppfkLvlRLaQ5VnZFDtGGzbheNRROKZmbu/AvUvh3tE4Wff2/0IUC+y2q+4VVoXBW1BSvkR7Rb8BW84lWJQBdlGozcs7GLy3Nd35OSqTxBqtfgkc1+sPjcqbDgEl6xK0dH5lv545LOCVL1/F+3CoY4eyY1+WcBiC2KYEHQBd5XDkyndE17xCm2Ug6BLcSwb3LigE1AlOYu6TS4HUwVEw0Df1osfBnLDwnpiFDCQPuvQ73Fkqxg8/hEVYLXt66MXbbzOK8bKre1hhkgDT0RDja3fEHytwZxCMLH0YWPkD0fxqjqUZDejDSV3z1LbexqPkEPJxKWLqtKOGbvPnZL460NlE/KgfkIZiRrfjShsQcG2QQDUwwXjcuZcID61Ys6ErUJ/LDOiCfLUzUjVQdEg0O4jn/ABEq0iuIjrEcwE0x/KGWNbjPj4BO00Gni0ZOoIPzLR5X9vMqqaQDqDzzENra4V5zp8sBZQcROYjsLvYUOPdbEVBKeiZ193QjCmwtZCM+ldS6EWYTH3wuNSV1i+pFCj/IAaWgGUfBq0N78qPM3DZcp9TxcTQeyzZm3ON2LatXpSlOP8BIB6qDLddHmHnFrBlpNZmZmdZbNXEB9XsRlZXFennqGHzoXW5DaId4iSoc/Q365EjnRjszPnYXZL9NDWUtGsqzCjAw7xprTypbn7fkaILcYqkInzzeX06C8emO8sKlS7stZQLxVMPes/+O9FVAvEpXob+utY6gZmfrtMjf/RUI+2odhF7wJbq+Gzf3zTj5CAwyaoEwozVoCzN1KKK00z7WUbZx9dIOklsO6CAZpu87i5gpHoJ8gtLh9vZixSO2KckV7qysf5Sc5uq2tjOix3rL0FW3IJuSNV0XM/iDs85LqxvqeKUD8n3LxUobt5WVuLJlS9IM4O9i09VRwWtxLWfpcix+hXjs8mZdjn19YuOiuKRgufzXqOuqQi2r8O+yAk/tl2Q/RMW7ETe8UdX1GJhHDM5qjDHJ5e7bs07qBp7ZsTe9t6/vUXykkLKEdLFbLgLJSUn3rrt1yXEdX/1C23jzVG+5Keg/B5r2wJD9g/NcaUAJq4MvXxxl/TWoATcoGc0Av4eUKnIXZlsvXpLHO0CS2KgOtGQgdeuwqWuUjGbUgrdszLHRXXDLF0oe54AS0kyPnc5Iz/2CmV7EeIzSwcjvsHQPXkUhld/kCP6Xu+DRNjg/SWHh+SnODF+aPeVh9XCydAPEsA4kAqsCzcuiTPiw7+maTj6SwGsVk/9gY9xbUpizR8MNS47aAd0C7s35CG8VdrxYyjl/FcdUgo73nY77X9D/Au9RDMh+aBoVAAAAAElFTkSuQmCC');
	width: 30px;
  height: 30px;
  background-size: 20px 20px;
	}

.l7-touch .l7-control-layers-toggle {
	width: 44px;
	height: 44px;
	}
.l7-control-layers .l7-control-layers-list,
.l7-control-layers-expanded .l7-control-layers-toggle {
	display: none;
	}
.l7-control-layers-expanded .l7-control-layers-list {
	display: block;
	position: relative;
	}
.l7-control-layers-expanded {
	padding: 6px 10px 6px 6px;
	color: #59626B;
	background: #fff;
	}
.l7-control-layers-scrollbar {
	overflow-y: scroll;
	overflow-x: hidden;
	padding-right: 5px;
	}
.l7-control-layers-selector {
	margin-top: 2px;
	position: relative;
	top: 1px;
	}
.l7-control-layers label {
  display: block;
  padding: 8px;
  }
  .l7-control-layers label input[type="radio"],
  .l7-control-layers label input[type="checkbox"] {
  width: 14px;
  height: 14px;
  margin: 0;
}
.l7-control-layers-separator {
	height: 0;
	border-top: 1px solid #D8D8D8;
	margin: 5px -10px 5px -6px;
}
.mapboxgl-ctrl-logo {
  display: none !important;
 }
 .amap-logo{
  display: none !important;
 }


`)},kPKH:function(Ue,g,o){"use strict";var E=o("/kpp");g.a=E.a},"kQ+U":function(Ue,g,o){"use strict";o.d(g,"a",function(){return xt});var E=o("lSNA"),p=o.n(E),X=o("lwsE"),F=o.n(X),i=o("W8MJ"),Z=o.n(i),D=o("k5/I"),J=o("h1nZ"),ee=o("o0o1"),ce=o.n(ee),Y=o("yXPU"),ze=o.n(Y),Xe=o("4cb6"),be=o("fbvF"),Se=o.n(be),mt=function(){function bt(Et,Fe){F()(this,bt),this.attribute=void 0,this.buffer=void 0;var pt=Fe.buffer,yt=Fe.offset,Ht=Fe.stride,hr=Fe.normalized,Zr=Fe.size,yr=Fe.divisor;this.buffer=pt,this.attribute={buffer:pt.get(),offset:yt||0,stride:Ht||0,normalized:hr||!1,divisor:yr||0},Zr&&(this.attribute.size=Zr)}return Z()(bt,[{key:"get",value:function(){return this.attribute}},{key:"updateBuffer",value:function(Fe){this.buffer.subData(Fe)}},{key:"destroy",value:function(){this.buffer.destroy()}}]),bt}(),Le,St,Ye,dt,Je,wt,At,Ie,Ne,Ve,ct,Me,ht,Wt,Qt=(Le={},p()(Le,J.gl.POINTS,"points"),p()(Le,J.gl.LINES,"lines"),p()(Le,J.gl.LINE_LOOP,"line loop"),p()(Le,J.gl.LINE_STRIP,"line strip"),p()(Le,J.gl.TRIANGLES,"triangles"),p()(Le,J.gl.TRIANGLE_FAN,"triangle fan"),p()(Le,J.gl.TRIANGLE_STRIP,"triangle strip"),Le),ur=(St={},p()(St,J.gl.STATIC_DRAW,"static"),p()(St,J.gl.DYNAMIC_DRAW,"dynamic"),p()(St,J.gl.STREAM_DRAW,"stream"),St),oe=(Ye={},p()(Ye,J.gl.BYTE,"int8"),p()(Ye,J.gl.UNSIGNED_INT,"int16"),p()(Ye,J.gl.INT,"int32"),p()(Ye,J.gl.UNSIGNED_BYTE,"uint8"),p()(Ye,J.gl.UNSIGNED_SHORT,"uint16"),p()(Ye,J.gl.UNSIGNED_INT,"uint32"),p()(Ye,J.gl.FLOAT,"float"),Ye),$=(dt={},p()(dt,J.gl.ALPHA,"alpha"),p()(dt,J.gl.LUMINANCE,"luminance"),p()(dt,J.gl.LUMINANCE_ALPHA,"luminance alpha"),p()(dt,J.gl.RGB,"rgb"),p()(dt,J.gl.RGBA,"rgba"),p()(dt,J.gl.RGBA4,"rgba4"),p()(dt,J.gl.RGB5_A1,"rgb5 a1"),p()(dt,J.gl.RGB565,"rgb565"),p()(dt,J.gl.DEPTH_COMPONENT,"depth"),p()(dt,J.gl.DEPTH_STENCIL,"depth stencil"),dt),H=(Je={},p()(Je,J.gl.DONT_CARE,"dont care"),p()(Je,J.gl.NICEST,"nice"),p()(Je,J.gl.FASTEST,"fast"),Je),Ae=(wt={},p()(wt,J.gl.NEAREST,"nearest"),p()(wt,J.gl.LINEAR,"linear"),p()(wt,J.gl.LINEAR_MIPMAP_LINEAR,"mipmap"),p()(wt,J.gl.NEAREST_MIPMAP_LINEAR,"nearest mipmap linear"),p()(wt,J.gl.LINEAR_MIPMAP_NEAREST,"linear mipmap nearest"),p()(wt,J.gl.NEAREST_MIPMAP_NEAREST,"nearest mipmap nearest"),wt),ye=(At={},p()(At,J.gl.REPEAT,"repeat"),p()(At,J.gl.CLAMP_TO_EDGE,"clamp"),p()(At,J.gl.MIRRORED_REPEAT,"mirror"),At),Te=(Ie={},p()(Ie,J.gl.NONE,"none"),p()(Ie,J.gl.BROWSER_DEFAULT_WEBGL,"browser"),Ie),pe=(Ne={},p()(Ne,J.gl.NEVER,"never"),p()(Ne,J.gl.ALWAYS,"always"),p()(Ne,J.gl.LESS,"less"),p()(Ne,J.gl.LEQUAL,"lequal"),p()(Ne,J.gl.GREATER,"greater"),p()(Ne,J.gl.GEQUAL,"gequal"),p()(Ne,J.gl.EQUAL,"equal"),p()(Ne,J.gl.NOTEQUAL,"notequal"),Ne),it=(Ve={},p()(Ve,J.gl.FUNC_ADD,"add"),p()(Ve,J.gl.MIN_EXT,"min"),p()(Ve,J.gl.MAX_EXT,"max"),p()(Ve,J.gl.FUNC_SUBTRACT,"subtract"),p()(Ve,J.gl.FUNC_REVERSE_SUBTRACT,"reverse subtract"),Ve),qt=(ct={},p()(ct,J.gl.ZERO,"zero"),p()(ct,J.gl.ONE,"one"),p()(ct,J.gl.SRC_COLOR,"src color"),p()(ct,J.gl.ONE_MINUS_SRC_COLOR,"one minus src color"),p()(ct,J.gl.SRC_ALPHA,"src alpha"),p()(ct,J.gl.ONE_MINUS_SRC_ALPHA,"one minus src alpha"),p()(ct,J.gl.DST_COLOR,"dst color"),p()(ct,J.gl.ONE_MINUS_DST_COLOR,"one minus dst color"),p()(ct,J.gl.DST_ALPHA,"dst alpha"),p()(ct,J.gl.ONE_MINUS_DST_ALPHA,"one minus dst alpha"),p()(ct,J.gl.CONSTANT_COLOR,"constant color"),p()(ct,J.gl.ONE_MINUS_CONSTANT_COLOR,"one minus constant color"),p()(ct,J.gl.CONSTANT_ALPHA,"constant alpha"),p()(ct,J.gl.ONE_MINUS_CONSTANT_ALPHA,"one minus constant alpha"),p()(ct,J.gl.SRC_ALPHA_SATURATE,"src alpha saturate"),ct),Pt=(Me={},p()(Me,J.gl.NEVER,"never"),p()(Me,J.gl.ALWAYS,"always"),p()(Me,J.gl.LESS,"less"),p()(Me,J.gl.LEQUAL,"lequal"),p()(Me,J.gl.GREATER,"greater"),p()(Me,J.gl.GEQUAL,"gequal"),p()(Me,J.gl.EQUAL,"equal"),p()(Me,J.gl.NOTEQUAL,"notequal"),Me),me=(ht={},p()(ht,J.gl.ZERO,"zero"),p()(ht,J.gl.KEEP,"keep"),p()(ht,J.gl.REPLACE,"replace"),p()(ht,J.gl.INVERT,"invert"),p()(ht,J.gl.INCR,"increment"),p()(ht,J.gl.DECR,"decrement"),p()(ht,J.gl.INCR_WRAP,"increment wrap"),p()(ht,J.gl.DECR_WRAP,"decrement wrap"),ht),ve=(Wt={},p()(Wt,J.gl.FRONT,"front"),p()(Wt,J.gl.BACK,"back"),Wt),Ge=function(){function bt(Et,Fe){F()(this,bt),this.buffer=void 0;var pt=Fe.data,yt=Fe.usage,Ht=Fe.type;this.buffer=Et.buffer({data:pt,usage:ur[yt||J.gl.STATIC_DRAW],type:oe[Ht||J.gl.UNSIGNED_BYTE]})}return Z()(bt,[{key:"get",value:function(){return this.buffer}},{key:"destroy",value:function(){this.buffer.destroy()}},{key:"subData",value:function(Fe){var pt=Fe.data,yt=Fe.offset;this.buffer.subdata(pt,yt)}}]),bt}(),st=function(){function bt(Et,Fe){F()(this,bt),this.elements=void 0;var pt=Fe.data,yt=Fe.usage,Ht=Fe.type,hr=Fe.count;this.elements=Et.elements({data:pt,usage:ur[yt||J.gl.STATIC_DRAW],type:oe[Ht||J.gl.UNSIGNED_BYTE],count:hr})}return Z()(bt,[{key:"get",value:function(){return this.elements}},{key:"subData",value:function(Fe){var pt=Fe.data;this.elements.subdata(pt)}},{key:"destroy",value:function(){}}]),bt}(),Oe=function(){function bt(Et,Fe){F()(this,bt),this.framebuffer=void 0;var pt=Fe.width,yt=Fe.height,Ht=Fe.color,hr=Fe.colors,Zr=Fe.depth,yr=Fe.stencil,Vn={width:pt,height:yt};Array.isArray(hr)&&(Vn.colors=hr.map(function(zn){return zn.get()})),Ht&&typeof Ht!="boolean"&&(Vn.color=Ht.get()),this.framebuffer=Et.framebuffer(Vn)}return Z()(bt,[{key:"get",value:function(){return this.framebuffer}},{key:"destroy",value:function(){this.framebuffer.destroy()}},{key:"resize",value:function(Fe){var pt=Fe.width,yt=Fe.height;this.framebuffer.resize(pt,yt)}}]),bt}(),gt=o("cDf5"),C=o.n(gt),R=o("c6wG"),q=o.n(R),fe=o("YO3V"),He=o.n(fe);function et(bt,Et){var Fe=Object.keys(bt);if(Object.getOwnPropertySymbols){var pt=Object.getOwnPropertySymbols(bt);Et&&(pt=pt.filter(function(yt){return Object.getOwnPropertyDescriptor(bt,yt).enumerable})),Fe.push.apply(Fe,pt)}return Fe}function _t(bt){for(var Et=1;Et<arguments.length;Et++){var Fe=arguments[Et]!=null?arguments[Et]:{};Et%2?et(Object(Fe),!0).forEach(function(pt){p()(bt,pt,Fe[pt])}):Object.getOwnPropertyDescriptors?Object.defineProperties(bt,Object.getOwnPropertyDescriptors(Fe)):et(Object(Fe)).forEach(function(pt){Object.defineProperty(bt,pt,Object.getOwnPropertyDescriptor(Fe,pt))})}return bt}var ot=function(){function bt(Et,Fe){F()(this,bt),this.reGl=void 0,this.destroyed=!1,this.drawCommand=void 0,this.drawParams=void 0,this.options=void 0,this.uniforms={},this.reGl=Et;var pt=Fe.vs,yt=Fe.fs,Ht=Fe.attributes,hr=Fe.uniforms,Zr=Fe.primitive,yr=Fe.count,Vn=Fe.elements,zn=Fe.depth,oa=Fe.blend,$n=Fe.stencil,Kn=Fe.cull,Cn=Fe.instances,z={};this.options=Fe,hr&&(this.uniforms=this.extractUniforms(hr),Object.keys(hr).forEach(function(xe){z[xe]=Et.prop(xe)}));var W={};Object.keys(Ht).forEach(function(xe){W[xe]=Ht[xe].get()});var le={attributes:W,frag:yt,uniforms:z,vert:pt,primitive:Qt[Zr===void 0?J.gl.TRIANGLES:Zr]};Cn&&(le.instances=Cn),yr&&(le.count=yr),Vn&&(le.elements=Vn.get()),this.initDepthDrawParams({depth:zn},le),this.initBlendDrawParams({blend:oa},le),this.initStencilDrawParams({stencil:$n},le),this.initCullDrawParams({cull:Kn},le),this.drawCommand=Et(le),this.drawParams=le}return Z()(bt,[{key:"addUniforms",value:function(Fe){this.uniforms=_t(_t({},this.uniforms),this.extractUniforms(Fe))}},{key:"draw",value:function(Fe){if(this.drawParams.attributes&&Object.keys(this.drawParams.attributes).length===0)return;var pt=_t(_t({},this.uniforms),this.extractUniforms(Fe.uniforms||{})),yt={};Object.keys(pt).forEach(function(Ht){var hr=C()(pt[Ht]);hr==="boolean"||hr==="number"||Array.isArray(pt[Ht])||pt[Ht].BYTES_PER_ELEMENT?yt[Ht]=pt[Ht]:yt[Ht]=pt[Ht].get()}),this.drawCommand(yt)}},{key:"destroy",value:function(){this.drawParams.elements.destroy(),this.options.attributes&&Object.values(this.options.attributes).forEach(function(Fe){Fe.destroy()}),this.destroyed=!0}},{key:"initDepthDrawParams",value:function(Fe,pt){var yt=Fe.depth;yt&&(pt.depth={enable:yt.enable===void 0?!0:!!yt.enable,mask:yt.mask===void 0?!0:!!yt.mask,func:pe[yt.func||J.gl.LESS],range:yt.range||[0,1]})}},{key:"initBlendDrawParams",value:function(Fe,pt){var yt=Fe.blend;if(yt){var Ht=yt.enable,hr=yt.func,Zr=yt.equation,yr=yt.color,Vn=yr===void 0?[0,0,0,0]:yr;pt.blend={enable:!!Ht,func:{srcRGB:qt[hr&&hr.srcRGB||J.gl.SRC_ALPHA],srcAlpha:qt[hr&&hr.srcAlpha||J.gl.SRC_ALPHA],dstRGB:qt[hr&&hr.dstRGB||J.gl.ONE_MINUS_SRC_ALPHA],dstAlpha:qt[hr&&hr.dstAlpha||J.gl.ONE_MINUS_SRC_ALPHA]},equation:{rgb:it[Zr&&Zr.rgb||J.gl.FUNC_ADD],alpha:it[Zr&&Zr.alpha||J.gl.FUNC_ADD]},color:Vn}}}},{key:"initStencilDrawParams",value:function(Fe,pt){var yt=Fe.stencil;if(yt){var Ht=yt.enable,hr=yt.mask,Zr=hr===void 0?-1:hr,yr=yt.func,Vn=yr===void 0?{cmp:J.gl.ALWAYS,ref:0,mask:-1}:yr,zn=yt.opFront,oa=zn===void 0?{fail:J.gl.KEEP,zfail:J.gl.KEEP,zpass:J.gl.KEEP}:zn,$n=yt.opBack,Kn=$n===void 0?{fail:J.gl.KEEP,zfail:J.gl.KEEP,zpass:J.gl.KEEP}:$n;pt.stencil={enable:!!Ht,mask:Zr,func:_t(_t({},Vn),{},{cmp:Pt[Vn.cmp]}),opFront:{fail:me[oa.fail],zfail:me[oa.zfail],zpass:me[oa.zpass]},opBack:{fail:me[Kn.fail],zfail:me[Kn.zfail],zpass:me[Kn.zpass]}}}}},{key:"initCullDrawParams",value:function(Fe,pt){var yt=Fe.cull;if(yt){var Ht=yt.enable,hr=yt.face,Zr=hr===void 0?J.gl.BACK:hr;pt.cull={enable:!!Ht,face:ve[Zr]}}}},{key:"extractUniforms",value:function(Fe){var pt=this,yt={};return Object.keys(Fe).forEach(function(Ht){pt.extractUniformsRecursively(Ht,Fe[Ht],yt,"")}),yt}},{key:"extractUniformsRecursively",value:function(Fe,pt,yt,Ht){var hr=this;if(pt===null||typeof pt=="number"||typeof pt=="boolean"||Array.isArray(pt)&&typeof pt[0]=="number"||q()(pt)||pt===""||"resize"in pt){yt["".concat(Ht&&Ht+".").concat(Fe)]=pt;return}He()(pt)&&Object.keys(pt).forEach(function(Zr){hr.extractUniformsRecursively(Zr,pt[Zr],yt,"".concat(Ht&&Ht+".").concat(Fe))}),Array.isArray(pt)&&pt.forEach(function(Zr,yr){Object.keys(Zr).forEach(function(Vn){hr.extractUniformsRecursively(Vn,Zr[Vn],yt,"".concat(Ht&&Ht+".").concat(Fe,"[").concat(yr,"]"))})})}}]),bt}(),Ut=function(){function bt(Et,Fe){F()(this,bt),this.texture=void 0,this.width=void 0,this.height=void 0;var pt=Fe.data,yt=Fe.type,Ht=yt===void 0?J.gl.UNSIGNED_BYTE:yt,hr=Fe.width,Zr=Fe.height,yr=Fe.flipY,Vn=yr===void 0?!1:yr,zn=Fe.format,oa=zn===void 0?J.gl.RGBA:zn,$n=Fe.mipmap,Kn=$n===void 0?!1:$n,Cn=Fe.wrapS,z=Cn===void 0?J.gl.CLAMP_TO_EDGE:Cn,W=Fe.wrapT,le=W===void 0?J.gl.CLAMP_TO_EDGE:W,xe=Fe.aniso,ut=xe===void 0?0:xe,Ot=Fe.alignment,Bt=Ot===void 0?1:Ot,Ze=Fe.premultiplyAlpha,Rt=Ze===void 0?!1:Ze,lr=Fe.mag,Ur=lr===void 0?J.gl.NEAREST:lr,Gr=Fe.min,cr=Gr===void 0?J.gl.NEAREST:Gr,Br=Fe.colorSpace,wn=Br===void 0?J.gl.BROWSER_DEFAULT_WEBGL:Br;this.width=hr,this.height=Zr;var fn={width:hr,height:Zr,type:oe[Ht],format:$[oa],wrapS:ye[z],wrapT:ye[le],mag:Ae[Ur],min:Ae[cr],alignment:Bt,flipY:Vn,colorSpace:Te[wn],premultiplyAlpha:Rt,aniso:ut};pt&&(fn.data=pt),typeof Kn=="number"?fn.mipmap=H[Kn]:typeof Kn=="boolean"&&(fn.mipmap=Kn),this.texture=Et.texture(fn)}return Z()(bt,[{key:"get",value:function(){return this.texture}},{key:"update",value:function(){var Fe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.texture(Fe)}},{key:"bind",value:function(){this.texture._texture.bind()}},{key:"resize",value:function(Fe){var pt=Fe.width,yt=Fe.height;this.texture.resize(pt,yt),this.width=pt,this.height=yt}},{key:"destroy",value:function(){this.texture.destroy()}}]),bt}(),K,qe,ae,tt=(K=Object(Xe.injectable)(),K(qe=(ae=function(){function bt(){var Et=this;F()(this,bt),this.gl=void 0,this.$container=void 0,this.canvas=void 0,this.width=void 0,this.height=void 0,this.isDirty=void 0,this.createModel=function(Fe){return new ot(Et.gl,Fe)},this.createAttribute=function(Fe){return new mt(Et.gl,Fe)},this.createBuffer=function(Fe){return new Ge(Et.gl,Fe)},this.createElements=function(Fe){return new st(Et.gl,Fe)},this.createTexture2D=function(Fe){return new Ut(Et.gl,Fe)},this.createFramebuffer=function(Fe){return new Oe(Et.gl,Fe)},this.useFramebuffer=function(Fe,pt){Et.gl({framebuffer:Fe?Fe.get():null})(pt)},this.clear=function(Fe){var pt=Fe.color,yt=Fe.depth,Ht=Fe.stencil,hr=Fe.framebuffer,Zr=hr===void 0?null:hr,yr={color:pt,depth:yt,stencil:Ht};yr.framebuffer=Zr===null?Zr:Zr.get(),Et.gl.clear(yr)},this.viewport=function(Fe){var pt=Fe.x,yt=Fe.y,Ht=Fe.width,hr=Fe.height;Et.gl._gl.viewport(pt,yt,Ht,hr),Et.width=Ht,Et.height=hr,Et.gl._refresh()},this.readPixels=function(Fe){var pt=Fe.framebuffer,yt=Fe.x,Ht=Fe.y,hr=Fe.width,Zr=Fe.height,yr={x:yt,y:Ht,width:hr,height:Zr};return pt&&(yr.framebuffer=pt.get()),Et.gl.read(yr)},this.getViewportSize=function(){return{width:Et.gl._gl.drawingBufferWidth,height:Et.gl._gl.drawingBufferHeight}},this.getContainer=function(){var Fe;return(Fe=Et.canvas)===null||Fe===void 0?void 0:Fe.parentElement},this.getCanvas=function(){return Et.canvas},this.getGLContext=function(){return Et.gl._gl},this.destroy=function(){Et.gl.destroy()}}return Z()(bt,[{key:"init",value:function(){var Et=ze()(ce.a.mark(function pt(yt,Ht){var hr=this;return ce.a.wrap(function(yr){for(;;)switch(yr.prev=yr.next){case 0:return this.canvas=yt,yr.next=3,new Promise(function(Vn,zn){Se()({canvas:hr.canvas,attributes:{alpha:!0,antialias:Ht.antialias,premultipliedAlpha:!0,preserveDrawingBuffer:Ht.preserveDrawingBuffer},extensions:["OES_element_index_uint","OES_standard_derivatives","angle_instanced_arrays"],optionalExtensions:["oes_texture_float_linear","OES_texture_float","EXT_texture_filter_anisotropic","EXT_blend_minmax","WEBGL_depth_texture"],profile:!0,onDone:function($n,Kn){($n||!Kn)&&zn($n),Vn(Kn)}})});case 3:this.gl=yr.sent;case 4:case"end":return yr.stop()}},pt,this)}));function Fe(pt,yt){return Et.apply(this,arguments)}return Fe}()},{key:"setBaseState",value:function(){this.gl({cull:{enable:!1,face:"back"},viewport:{x:0,y:0,height:this.width,width:this.height},blend:{enable:!1,equation:"add"},framebuffer:null}),this.gl._refresh()}},{key:"setCustomLayerDefaults",value:function(){var Fe=this.getGLContext();Fe.disable(Fe.CULL_FACE)}},{key:"setDirty",value:function(Fe){this.isDirty=Fe}},{key:"getDirty",value:function(){return this.isDirty}}]),bt}(),ae))||qe),kt=o("Hel2");function pr(bt,Et){var Fe=Object.keys(bt);if(Object.getOwnPropertySymbols){var pt=Object.getOwnPropertySymbols(bt);Et&&(pt=pt.filter(function(yt){return Object.getOwnPropertyDescriptor(bt,yt).enumerable})),Fe.push.apply(Fe,pt)}return Fe}function Ke(bt){for(var Et=1;Et<arguments.length;Et++){var Fe=arguments[Et]!=null?arguments[Et]:{};Et%2?pr(Object(Fe),!0).forEach(function(pt){p()(bt,pt,Fe[pt])}):Object.getOwnPropertyDescriptors?Object.defineProperties(bt,Object.getOwnPropertyDescriptors(Fe)):pr(Object(Fe)).forEach(function(pt){Object.defineProperty(bt,pt,Object.getOwnPropertyDescriptor(Fe,pt))})}return bt}var xt=function(){function bt(Et){F()(this,bt),this.sceneService=void 0,this.mapService=void 0,this.controlService=void 0,this.layerService=void 0,this.iconService=void 0,this.markerService=void 0,this.popupService=void 0,this.fontService=void 0,this.interactionService=void 0,this.container=void 0;var Fe=Et.id,pt=Et.map,yt=Object(J.createSceneContainer)();this.container=yt,pt.setContainer(yt,Fe),yt.bind(J.TYPES.IRendererService).to(tt).inSingletonScope(),this.sceneService=yt.get(J.TYPES.ISceneService),this.mapService=yt.get(J.TYPES.IMapService),this.iconService=yt.get(J.TYPES.IIconService),this.fontService=yt.get(J.TYPES.IFontService),this.controlService=yt.get(J.TYPES.IControlService),this.layerService=yt.get(J.TYPES.ILayerService),this.markerService=yt.get(J.TYPES.IMarkerService),this.interactionService=yt.get(J.TYPES.IInteractionService),this.popupService=yt.get(J.TYPES.IPopupService),this.initComponent(Fe),this.sceneService.init(Et),this.initControl()}return Z()(bt,[{key:"getServiceContainer",value:function(){return this.container}},{key:"getSize",value:function(){return this.mapService.getSize()}},{key:"getMinZoom",value:function(){return this.mapService.getMinZoom()}},{key:"getMaxZoom",value:function(){return this.mapService.getMaxZoom()}},{key:"getType",value:function(){return this.mapService.getType()}},{key:"getMapContainer",value:function(){return this.mapService.getMapContainer()}},{key:"getMapCanvasContainer",value:function(){return this.mapService.getMapCanvasContainer()}},{key:"getMapService",value:function(){return this.mapService}},{key:"exportPng",value:function(Fe){return this.sceneService.exportPng(Fe)}},{key:"exportMap",value:function(Fe){return this.sceneService.exportPng(Fe)}},{key:"registerRenderService",value:function(Fe){var pt=this;if(this.sceneService.loaded){var yt=new Fe(this);yt.init()}else this.on("loaded",function(){var Ht=new Fe(pt);Ht.init()})}},{key:"addLayer",value:function(Fe){var pt=Object(J.createLayerContainer)(this.container);Fe.setContainer(pt),this.sceneService.addLayer(Fe)}},{key:"getLayers",value:function(){return this.layerService.getLayers()}},{key:"getLayer",value:function(Fe){return this.layerService.getLayer(Fe)}},{key:"getLayerByName",value:function(Fe){return this.layerService.getLayerByName(Fe)}},{key:"removeLayer",value:function(Fe){this.layerService.remove(Fe)}},{key:"removeAllLayer",value:function(){this.layerService.removeAllLayers()}},{key:"render",value:function(){this.sceneService.render()}},{key:"addImage",value:function(Fe,pt){this.iconService.addImage(Fe,pt)}},{key:"hasImage",value:function(Fe){return this.iconService.hasImage(Fe)}},{key:"removeImage",value:function(Fe){this.iconService.removeImage(Fe)}},{key:"addIconFontGlyphs",value:function(Fe,pt){this.fontService.addIconGlyphs(pt)}},{key:"addControl",value:function(Fe){this.controlService.addControl(Fe,this.container)}},{key:"removeControl",value:function(Fe){this.controlService.removeControl(Fe)}},{key:"getControlByName",value:function(Fe){return this.controlService.getControlByName(Fe)}},{key:"addMarker",value:function(Fe){this.markerService.addMarker(Fe)}},{key:"addMarkerLayer",value:function(Fe){this.markerService.addMarkerLayer(Fe)}},{key:"removeMarkerLayer",value:function(Fe){this.markerService.removeMarkerLayer(Fe)}},{key:"removeAllMakers",value:function(){this.markerService.removeAllMarkers()}},{key:"addPopup",value:function(Fe){this.popupService.addPopup(Fe)}},{key:"on",value:function(Fe,pt){J.SceneEventList.indexOf(Fe)===-1?this.mapService.on(Fe,pt):this.sceneService.on(Fe,pt)}},{key:"off",value:function(Fe,pt){J.SceneEventList.indexOf(Fe)===-1?this.mapService.off(Fe,pt):this.sceneService.off(Fe,pt)}},{key:"getZoom",value:function(){return this.mapService.getZoom()}},{key:"getCenter",value:function(){return this.mapService.getCenter()}},{key:"setCenter",value:function(Fe){return this.mapService.setCenter(Fe)}},{key:"getPitch",value:function(){return this.mapService.getPitch()}},{key:"setPitch",value:function(Fe){return this.mapService.setPitch(Fe)}},{key:"getRotation",value:function(){return this.mapService.getRotation()}},{key:"getBounds",value:function(){return this.mapService.getBounds()}},{key:"setRotation",value:function(Fe){this.mapService.setRotation(Fe)}},{key:"zoomIn",value:function(){this.mapService.zoomIn()}},{key:"zoomOut",value:function(){this.mapService.zoomOut()}},{key:"panTo",value:function(Fe){this.mapService.panTo(Fe)}},{key:"panBy",value:function(Fe){this.mapService.panBy(Fe)}},{key:"getContainer",value:function(){return this.mapService.getContainer()}},{key:"setZoom",value:function(Fe){this.mapService.setZoom(Fe)}},{key:"fitBounds",value:function(Fe,pt){var yt=this.sceneService.getSceneConfig(),Ht=yt.fitBoundsOptions,hr=yt.animate;this.mapService.fitBounds(Fe,pt||Ke(Ke({},Ht),{},{animate:hr}))}},{key:"setZoomAndCenter",value:function(Fe,pt){this.mapService.setZoomAndCenter(Fe,pt)}},{key:"setMapStyle",value:function(Fe){this.mapService.setMapStyle(Fe)}},{key:"setMapStatus",value:function(Fe){this.mapService.setMapStatus(Fe)}},{key:"pixelToLngLat",value:function(Fe){return this.mapService.pixelToLngLat(Fe)}},{key:"lngLatToPixel",value:function(Fe){return this.mapService.lngLatToPixel(Fe)}},{key:"containerToLngLat",value:function(Fe){return this.mapService.containerToLngLat(Fe)}},{key:"lngLatToContainer",value:function(Fe){return this.mapService.lngLatToContainer(Fe)}},{key:"destroy",value:function(){this.sceneService.destroy()}},{key:"registerPostProcessingPass",value:function(Fe,pt){this.container.bind(J.TYPES.IPostProcessingPass).to(Fe).whenTargetNamed(pt)}},{key:"initComponent",value:function(Fe){this.controlService.init({container:kt.a.getContainer(Fe)},this.container),this.markerService.init(this.container),this.popupService.init(this.container)}},{key:"initControl",value:function(){var Fe=this.sceneService.getSceneConfig(),pt=Fe.logoVisible,yt=Fe.logoPosition;pt&&this.addControl(new D.b({position:yt}))}},{key:"map",get:function(){return this.mapService.map}}]),bt}()},l94r:function(Ue,g,o){"use strict";o.d(g,"a",function(){return $});var E=o("lSNA"),p=o.n(E),X=o("lwsE"),F=o.n(X),i=o("W8MJ"),Z=o.n(i),D=o("7W2i"),J=o.n(D),ee=o("a1gu"),ce=o.n(ee),Y=o("Nsbk"),ze=o.n(Y),Xe=o("4qC0"),be=o.n(Xe),Se=o("lSCD"),mt=o.n(Se),Le=o("BkRI"),St=o.n(Le),Ye=o("xp6e"),dt=o("Hel2"),Je=o("uhBA"),wt=o("rlAn"),At=o("qxNg");function Ie(H){if(H.length===0)throw new Error("max requires at least one data point");for(var Ae=H[0],ye=1;ye<H.length;ye++)H[ye]>Ae&&(Ae=H[ye]);return Ae}function Ne(H){if(H.length===0)throw new Error("min requires at least one data point");for(var Ae=H[0],ye=1;ye<H.length;ye++)H[ye]<Ae&&(Ae=H[ye]);return Ae}function Ve(H){if(H.length===0)return 0;for(var Ae=H[0],ye=0,Te,pe=1;pe<H.length;pe++)Te=Ae+H[pe]*1,Math.abs(Ae)>=Math.abs(H[pe])?ye+=Ae-Te+H[pe]:ye+=H[pe]-Te+Ae,Ae=Te;return Ae+ye*1}function ct(H){if(H.length===0)throw new Error("mean requires at least one data point");return Ve(H)/H.length}var Me={min:Ne,max:Ie,mean:ct,sum:Ve};function ht(H,Ae){return H.map(function(ye){return ye[Ae]*1})}function Wt(H,Ae){var ye=Object.keys(H);if(Object.getOwnPropertySymbols){var Te=Object.getOwnPropertySymbols(H);Ae&&(Te=Te.filter(function(pe){return Object.getOwnPropertyDescriptor(H,pe).enumerable})),ye.push.apply(ye,Te)}return ye}function Qt(H){for(var Ae=1;Ae<arguments.length;Ae++){var ye=arguments[Ae]!=null?arguments[Ae]:{};Ae%2?Wt(Object(ye),!0).forEach(function(Te){p()(H,Te,ye[Te])}):Object.getOwnPropertyDescriptors?Object.defineProperties(H,Object.getOwnPropertyDescriptors(ye)):Wt(Object(ye)).forEach(function(Te){Object.defineProperty(H,Te,Object.getOwnPropertyDescriptor(ye,Te))})}return H}function ur(H){var Ae=oe();return function(){var Te=ze()(H),pe;if(Ae){var it=ze()(this).constructor;pe=Reflect.construct(Te,arguments,it)}else pe=Te.apply(this,arguments);return ce()(this,pe)}}function oe(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(H){return!1}}var $=function(H){J()(ye,H);var Ae=ur(ye);function ye(Te,pe){var it;return F()(this,ye),it=Ae.call(this),it.data=void 0,it.extent=void 0,it.hooks={init:new Ye.c},it.parser={type:"geojson"},it.transforms=[],it.cluster=!1,it.clusterOptions={enable:!1,radius:40,maxZoom:20,zoom:-99,method:"count"},it.originData=void 0,it.rawData=void 0,it.clusterIndex=void 0,it.originData=Te,it.initCfg(pe),it.hooks.init.tap("parser",function(){it.excuteParser()}),it.hooks.init.tap("cluster",function(){it.initCluster()}),it.hooks.init.tap("transform",function(){it.executeTrans()}),it.init(),it}return Z()(ye,[{key:"setData",value:function(pe,it){this.rawData=pe,this.originData=pe,this.initCfg(it),this.init(),this.emit("update")}},{key:"getClusters",value:function(pe){return this.clusterIndex.getClusters(this.extent,pe)}},{key:"getClustersLeaves",value:function(pe){return this.clusterIndex.getLeaves(pe,Infinity)}},{key:"updateClusterData",value:function(pe){var it=this,qt=this.clusterOptions,Pt=qt.method,me=Pt===void 0?"sum":Pt,ve=qt.field,Ge=Object(dt.r)(Object(dt.h)(this.extent),2),st=this.clusterIndex.getClusters(Ge[0].concat(Ge[1]),Math.floor(pe));this.clusterOptions.zoom=pe,st.forEach(function(Oe){Oe.id||(Oe.properties.point_count=1)}),(ve||mt()(me))&&(st=st.map(function(Oe){var gt=Oe.id;if(gt){var C=it.clusterIndex.getLeaves(gt,Infinity),R=C.map(function(He){return He.properties}),q;if(be()(me)&&ve){var fe=ht(R,ve);q=Me[me](fe)}mt()(me)&&(q=me(R)),Oe.properties.stat=q}else Oe.properties.point_count=1;return Oe})),this.data=Object(wt.getParser)("geojson")({type:"FeatureCollection",features:st}),this.executeTrans()}},{key:"getFeatureById",value:function(pe){var it=this.parser.type,qt=it===void 0?"geojson":it;if(qt==="geojson"&&!this.cluster){var Pt=pe<this.originData.features.length?this.originData.features[pe]:"null",me=St()(Pt);if(this.transforms.length!==0){var ve=this.data.dataArray.find(function(Ge){return Ge._id===pe});me.properties=ve}return me}else return pe<this.data.dataArray.length?this.data.dataArray[pe]:"null"}},{key:"getFeatureId",value:function(pe,it){var qt=this.data.dataArray.find(function(Pt){return Pt[pe]===name});return qt==null?void 0:qt._id}},{key:"destroy",value:function(){this.removeAllListeners(),this.originData=null,this.clusterIndex=null,this.data=null}},{key:"initCfg",value:function(pe){pe&&(pe.parser&&(this.parser=pe.parser),pe.transforms&&(this.transforms=pe.transforms),this.cluster=pe.cluster||!1,pe.clusterOptions&&(this.cluster=!0,this.clusterOptions=Qt(Qt({},this.clusterOptions),pe.clusterOptions)))}},{key:"excuteParser",value:function(){var pe=this.parser,it=pe.type||"geojson",qt=Object(wt.getParser)(it);this.data=qt(this.originData,pe),this.extent=Object(dt.m)(this.data.dataArray)}},{key:"executeTrans",value:function(){var pe=this,it=this.transforms;it.forEach(function(qt){var Pt=qt.type,me=Object(wt.getTransform)(Pt)(pe.data,qt);Object.assign(pe.data,me)})}},{key:"initCluster",value:function(){if(!this.cluster)return;var pe=this.clusterOptions||{};this.clusterIndex=Object(At.a)(this.data,pe)}},{key:"init",value:function(){this.hooks.init.call(this)}}]),ye}(Je.EventEmitter)},lJbI:function(Ue,g,o){"use strict";o.d(g,"a",function(){return E});function E(p,X){var F=X.extent,i=X.width,Z=X.height,D=X.min,J=X.max,ee={_id:1,dataArray:[{_id:1,data:Array.from(p),width:i,height:Z,min:D,max:J,coordinates:[[F[0],F[1]],[F[2],F[3]]]}]};return ee}},mNvP:function(Ue,g,o){(function(E,p){/*! *****************************************************************************
Copyright (C) Microsoft. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var X;(function(F){(function(i){var Z=typeof p=="object"?p:typeof self=="object"?self:typeof this=="object"?this:Function("return this;")(),D=J(F);typeof Z.Reflect=="undefined"?Z.Reflect=F:D=J(Z.Reflect,D),i(D);function J(ee,ce){return function(Y,ze){typeof ee[Y]!="function"&&Object.defineProperty(ee,Y,{configurable:!0,writable:!0,value:ze}),ce&&ce(Y,ze)}}})(function(i){var Z=Object.prototype.hasOwnProperty,D=typeof Symbol=="function",J=D&&typeof Symbol.toPrimitive!="undefined"?Symbol.toPrimitive:"@@toPrimitive",ee=D&&typeof Symbol.iterator!="undefined"?Symbol.iterator:"@@iterator",ce=typeof Object.create=="function",Y={__proto__:[]}instanceof Array,ze=!ce&&!Y,Xe={create:ce?function(){return pr(Object.create(null))}:Y?function(){return pr({__proto__:null})}:function(){return pr({})},has:ze?function(Ke,xt){return Z.call(Ke,xt)}:function(Ke,xt){return xt in Ke},get:ze?function(Ke,xt){return Z.call(Ke,xt)?Ke[xt]:void 0}:function(Ke,xt){return Ke[xt]}},be=Object.getPrototypeOf(Function),Se=typeof E=="object"&&Object({NODE_ENV:"production"})&&Object({NODE_ENV:"production"}).REFLECT_METADATA_USE_MAP_POLYFILL==="true",mt=!Se&&typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:ae(),Le=!Se&&typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:tt(),St=!Se&&typeof WeakMap=="function"?WeakMap:kt(),Ye=new St;function dt(Ke,xt,bt,Et){if(qt(bt)){if(!R(Ke))throw new TypeError;if(!fe(xt))throw new TypeError;return Wt(Ke,xt)}else{if(!R(Ke))throw new TypeError;if(!ve(xt))throw new TypeError;if(!ve(Et)&&!qt(Et)&&!Pt(Et))throw new TypeError;return Pt(Et)&&(Et=void 0),bt=C(bt),Qt(Ke,xt,bt,Et)}}i("decorate",dt);function Je(Ke,xt){function bt(Et,Fe){if(!ve(Et))throw new TypeError;if(!qt(Fe)&&!He(Fe))throw new TypeError;ye(Ke,xt,Et,Fe)}return bt}i("metadata",Je);function wt(Ke,xt,bt,Et){if(!ve(bt))throw new TypeError;return qt(Et)||(Et=C(Et)),ye(Ke,xt,bt,Et)}i("defineMetadata",wt);function At(Ke,xt,bt){if(!ve(xt))throw new TypeError;return qt(bt)||(bt=C(bt)),oe(Ke,xt,bt)}i("hasMetadata",At);function Ie(Ke,xt,bt){if(!ve(xt))throw new TypeError;return qt(bt)||(bt=C(bt)),$(Ke,xt,bt)}i("hasOwnMetadata",Ie);function Ne(Ke,xt,bt){if(!ve(xt))throw new TypeError;return qt(bt)||(bt=C(bt)),H(Ke,xt,bt)}i("getMetadata",Ne);function Ve(Ke,xt,bt){if(!ve(xt))throw new TypeError;return qt(bt)||(bt=C(bt)),Ae(Ke,xt,bt)}i("getOwnMetadata",Ve);function ct(Ke,xt){if(!ve(Ke))throw new TypeError;return qt(xt)||(xt=C(xt)),Te(Ke,xt)}i("getMetadataKeys",ct);function Me(Ke,xt){if(!ve(Ke))throw new TypeError;return qt(xt)||(xt=C(xt)),pe(Ke,xt)}i("getOwnMetadataKeys",Me);function ht(Ke,xt,bt){if(!ve(xt))throw new TypeError;qt(bt)||(bt=C(bt));var Et=ur(xt,bt,!1);if(qt(Et))return!1;if(!Et.delete(Ke))return!1;if(Et.size>0)return!0;var Fe=Ye.get(xt);return Fe.delete(bt),Fe.size>0||Ye.delete(xt),!0}i("deleteMetadata",ht);function Wt(Ke,xt){for(var bt=Ke.length-1;bt>=0;--bt){var Et=Ke[bt],Fe=Et(xt);if(!qt(Fe)&&!Pt(Fe)){if(!fe(Fe))throw new TypeError;xt=Fe}}return xt}function Qt(Ke,xt,bt,Et){for(var Fe=Ke.length-1;Fe>=0;--Fe){var pt=Ke[Fe],yt=pt(xt,bt,Et);if(!qt(yt)&&!Pt(yt)){if(!ve(yt))throw new TypeError;Et=yt}}return Et}function ur(Ke,xt,bt){var Et=Ye.get(Ke);if(qt(Et)){if(!bt)return;Et=new mt,Ye.set(Ke,Et)}var Fe=Et.get(xt);if(qt(Fe)){if(!bt)return;Fe=new mt,Et.set(xt,Fe)}return Fe}function oe(Ke,xt,bt){var Et=$(Ke,xt,bt);if(Et)return!0;var Fe=qe(xt);return Pt(Fe)?!1:oe(Ke,Fe,bt)}function $(Ke,xt,bt){var Et=ur(xt,bt,!1);return qt(Et)?!1:Oe(Et.has(Ke))}function H(Ke,xt,bt){var Et=$(Ke,xt,bt);if(Et)return Ae(Ke,xt,bt);var Fe=qe(xt);return Pt(Fe)?void 0:H(Ke,Fe,bt)}function Ae(Ke,xt,bt){var Et=ur(xt,bt,!1);return qt(Et)?void 0:Et.get(Ke)}function ye(Ke,xt,bt,Et){var Fe=ur(bt,Et,!0);Fe.set(Ke,xt)}function Te(Ke,xt){var bt=pe(Ke,xt),Et=qe(Ke);if(Et===null)return bt;var Fe=Te(Et,xt);if(Fe.length<=0)return bt;if(bt.length<=0)return Fe;for(var pt=new Le,yt=[],Ht=0,hr=bt;Ht<hr.length;Ht++){var Zr=hr[Ht],yr=pt.has(Zr);yr||(pt.add(Zr),yt.push(Zr))}for(var Vn=0,zn=Fe;Vn<zn.length;Vn++){var Zr=zn[Vn],yr=pt.has(Zr);yr||(pt.add(Zr),yt.push(Zr))}return yt}function pe(Ke,xt){var bt=[],Et=ur(Ke,xt,!1);if(qt(Et))return bt;for(var Fe=Et.keys(),pt=_t(Fe),yt=0;;){var Ht=Ut(pt);if(!Ht)return bt.length=yt,bt;var hr=ot(Ht);try{bt[yt]=hr}catch(Zr){try{K(pt)}finally{throw Zr}}yt++}}function it(Ke){if(Ke===null)return 1;switch(typeof Ke){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return Ke===null?1:6;default:return 6}}function qt(Ke){return Ke===void 0}function Pt(Ke){return Ke===null}function me(Ke){return typeof Ke=="symbol"}function ve(Ke){return typeof Ke=="object"?Ke!==null:typeof Ke=="function"}function Ge(Ke,xt){switch(it(Ke)){case 0:return Ke;case 1:return Ke;case 2:return Ke;case 3:return Ke;case 4:return Ke;case 5:return Ke}var bt=xt===3?"string":xt===5?"number":"default",Et=et(Ke,J);if(Et!==void 0){var Fe=Et.call(Ke,bt);if(ve(Fe))throw new TypeError;return Fe}return st(Ke,bt==="default"?"number":bt)}function st(Ke,xt){if(xt==="string"){var bt=Ke.toString;if(q(bt)){var Et=bt.call(Ke);if(!ve(Et))return Et}var Fe=Ke.valueOf;if(q(Fe)){var Et=Fe.call(Ke);if(!ve(Et))return Et}}else{var Fe=Ke.valueOf;if(q(Fe)){var Et=Fe.call(Ke);if(!ve(Et))return Et}var pt=Ke.toString;if(q(pt)){var Et=pt.call(Ke);if(!ve(Et))return Et}}throw new TypeError}function Oe(Ke){return!!Ke}function gt(Ke){return""+Ke}function C(Ke){var xt=Ge(Ke,3);return me(xt)?xt:gt(xt)}function R(Ke){return Array.isArray?Array.isArray(Ke):Ke instanceof Object?Ke instanceof Array:Object.prototype.toString.call(Ke)==="[object Array]"}function q(Ke){return typeof Ke=="function"}function fe(Ke){return typeof Ke=="function"}function He(Ke){switch(it(Ke)){case 3:return!0;case 4:return!0;default:return!1}}function et(Ke,xt){var bt=Ke[xt];if(bt==null)return;if(!q(bt))throw new TypeError;return bt}function _t(Ke){var xt=et(Ke,ee);if(!q(xt))throw new TypeError;var bt=xt.call(Ke);if(!ve(bt))throw new TypeError;return bt}function ot(Ke){return Ke.value}function Ut(Ke){var xt=Ke.next();return xt.done?!1:xt}function K(Ke){var xt=Ke.return;xt&&xt.call(Ke)}function qe(Ke){var xt=Object.getPrototypeOf(Ke);if(typeof Ke!="function"||Ke===be)return xt;if(xt!==be)return xt;var bt=Ke.prototype,Et=bt&&Object.getPrototypeOf(bt);if(Et==null||Et===Object.prototype)return xt;var Fe=Et.constructor;return typeof Fe!="function"||Fe===Ke?xt:Fe}function ae(){var Ke={},xt=[],bt=function(){function yt(Ht,hr,Zr){this._index=0,this._keys=Ht,this._values=hr,this._selector=Zr}return yt.prototype["@@iterator"]=function(){return this},yt.prototype[ee]=function(){return this},yt.prototype.next=function(){var Ht=this._index;if(Ht>=0&&Ht<this._keys.length){var hr=this._selector(this._keys[Ht],this._values[Ht]);return Ht+1>=this._keys.length?(this._index=-1,this._keys=xt,this._values=xt):this._index++,{value:hr,done:!1}}return{value:void 0,done:!0}},yt.prototype.throw=function(Ht){throw this._index>=0&&(this._index=-1,this._keys=xt,this._values=xt),Ht},yt.prototype.return=function(Ht){return this._index>=0&&(this._index=-1,this._keys=xt,this._values=xt),{value:Ht,done:!0}},yt}();return function(){function yt(){this._keys=[],this._values=[],this._cacheKey=Ke,this._cacheIndex=-2}return Object.defineProperty(yt.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),yt.prototype.has=function(Ht){return this._find(Ht,!1)>=0},yt.prototype.get=function(Ht){var hr=this._find(Ht,!1);return hr>=0?this._values[hr]:void 0},yt.prototype.set=function(Ht,hr){var Zr=this._find(Ht,!0);return this._values[Zr]=hr,this},yt.prototype.delete=function(Ht){var hr=this._find(Ht,!1);if(hr>=0){for(var Zr=this._keys.length,yr=hr+1;yr<Zr;yr++)this._keys[yr-1]=this._keys[yr],this._values[yr-1]=this._values[yr];return this._keys.length--,this._values.length--,Ht===this._cacheKey&&(this._cacheKey=Ke,this._cacheIndex=-2),!0}return!1},yt.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=Ke,this._cacheIndex=-2},yt.prototype.keys=function(){return new bt(this._keys,this._values,Et)},yt.prototype.values=function(){return new bt(this._keys,this._values,Fe)},yt.prototype.entries=function(){return new bt(this._keys,this._values,pt)},yt.prototype["@@iterator"]=function(){return this.entries()},yt.prototype[ee]=function(){return this.entries()},yt.prototype._find=function(Ht,hr){return this._cacheKey!==Ht&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=Ht)),this._cacheIndex<0&&hr&&(this._cacheIndex=this._keys.length,this._keys.push(Ht),this._values.push(void 0)),this._cacheIndex},yt}();function Et(yt,Ht){return yt}function Fe(yt,Ht){return Ht}function pt(yt,Ht){return[yt,Ht]}}function tt(){return function(){function Ke(){this._map=new mt}return Object.defineProperty(Ke.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),Ke.prototype.has=function(xt){return this._map.has(xt)},Ke.prototype.add=function(xt){return this._map.set(xt,xt),this},Ke.prototype.delete=function(xt){return this._map.delete(xt)},Ke.prototype.clear=function(){this._map.clear()},Ke.prototype.keys=function(){return this._map.keys()},Ke.prototype.values=function(){return this._map.values()},Ke.prototype.entries=function(){return this._map.entries()},Ke.prototype["@@iterator"]=function(){return this.keys()},Ke.prototype[ee]=function(){return this.keys()},Ke}()}function kt(){var Ke=16,xt=Xe.create(),bt=Et();return function(){function hr(){this._key=Et()}return hr.prototype.has=function(Zr){var yr=Fe(Zr,!1);return yr!==void 0?Xe.has(yr,this._key):!1},hr.prototype.get=function(Zr){var yr=Fe(Zr,!1);return yr!==void 0?Xe.get(yr,this._key):void 0},hr.prototype.set=function(Zr,yr){var Vn=Fe(Zr,!0);return Vn[this._key]=yr,this},hr.prototype.delete=function(Zr){var yr=Fe(Zr,!1);return yr!==void 0?delete yr[this._key]:!1},hr.prototype.clear=function(){this._key=Et()},hr}();function Et(){var hr;do hr="@@WeakMap@@"+Ht();while(Xe.has(xt,hr));return xt[hr]=!0,hr}function Fe(hr,Zr){if(!Z.call(hr,bt)){if(!Zr)return;Object.defineProperty(hr,bt,{value:Xe.create()})}return hr[bt]}function pt(hr,Zr){for(var yr=0;yr<Zr;++yr)hr[yr]=Math.random()*255|0;return hr}function yt(hr){return typeof Uint8Array=="function"?typeof crypto!="undefined"?crypto.getRandomValues(new Uint8Array(hr)):typeof msCrypto!="undefined"?msCrypto.getRandomValues(new Uint8Array(hr)):pt(new Uint8Array(hr),hr):pt(new Array(hr),hr)}function Ht(){var hr=yt(Ke);hr[6]=hr[6]&79|64,hr[8]=hr[8]&191|128;for(var Zr="",yr=0;yr<Ke;++yr){var Vn=hr[yr];(yr===4||yr===6||yr===8)&&(Zr+="-"),Vn<16&&(Zr+="0"),Zr+=Vn.toString(16).toLowerCase()}return Zr}}function pr(Ke){return Ke.__=void 0,delete Ke.__,Ke}})})(X||(X={}))}).call(this,o("Q2Ig"),o("yLpj"))},mTTR:function(Ue,g,o){var E=o("b80T"),p=o("QcOe"),X=o("MMmD");function F(i){return X(i)?E(i,!0):p(i)}Ue.exports=F},mc0g:function(Ue,g){function o(E){return function(p,X,F){for(var i=-1,Z=Object(p),D=F(p),J=D.length;J--;){var ee=D[E?J:++i];if(X(Z[ee],ee,Z)===!1)break}return p}}Ue.exports=o},mhV4:function(Ue,g,o){var E=o("ZK94");Ue.exports.geometry=p,Ue.exports.ring=F;function p(Z){var D=0,J;switch(Z.type){case"Polygon":return X(Z.coordinates);case"MultiPolygon":for(J=0;J<Z.coordinates.length;J++)D+=X(Z.coordinates[J]);return D;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(J=0;J<Z.geometries.length;J++)D+=p(Z.geometries[J]);return D}}function X(Z){var D=0;if(Z&&Z.length>0){D+=Math.abs(F(Z[0]));for(var J=1;J<Z.length;J++)D-=Math.abs(F(Z[J]))}return D}function F(Z){var D,J,ee,ce,Y,ze,Xe,be=0,Se=Z.length;if(Se>2){for(Xe=0;Xe<Se;Xe++)Xe===Se-2?(ce=Se-2,Y=Se-1,ze=0):Xe===Se-1?(ce=Se-1,Y=0,ze=1):(ce=Xe,Y=Xe+1,ze=Xe+2),D=Z[ce],J=Z[Y],ee=Z[ze],be+=(i(ee[0])-i(D[0]))*Math.sin(i(J[1]));be=be*E.RADIUS*E.RADIUS/2}return be}function i(Z){return Z*Math.PI/180}},mpbz:function(Ue,g,o){(function(E,p){Ue.exports=p()})(this,function(){"use strict";function E(Ie,Ne,Ve,ct,Me,ht){if(Me-ct<=Ve)return;var Wt=ct+Me>>1;p(Ie,Ne,Wt,ct,Me,ht%2),E(Ie,Ne,Ve,ct,Wt-1,ht+1),E(Ie,Ne,Ve,Wt+1,Me,ht+1)}function p(Ie,Ne,Ve,ct,Me,ht){for(;Me>ct;){if(Me-ct>600){var Wt=Me-ct+1,Qt=Ve-ct+1,ur=Math.log(Wt),oe=.5*Math.exp(2*ur/3),$=.5*Math.sqrt(ur*oe*(Wt-oe)/Wt)*(Qt-Wt/2<0?-1:1),H=Math.max(ct,Math.floor(Ve-Qt*oe/Wt+$)),Ae=Math.min(Me,Math.floor(Ve+(Wt-Qt)*oe/Wt+$));p(Ie,Ne,Ve,H,Ae,ht)}var ye=Ne[2*Ve+ht],Te=ct,pe=Me;for(X(Ie,Ne,ct,Ve),Ne[2*Me+ht]>ye&&X(Ie,Ne,ct,Me);Te<pe;){for(X(Ie,Ne,Te,pe),Te++,pe--;Ne[2*Te+ht]<ye;)Te++;for(;Ne[2*pe+ht]>ye;)pe--}Ne[2*ct+ht]===ye?X(Ie,Ne,ct,pe):(pe++,X(Ie,Ne,pe,Me)),pe<=Ve&&(ct=pe+1),Ve<=pe&&(Me=pe-1)}}function X(Ie,Ne,Ve,ct){F(Ie,Ve,ct),F(Ne,2*Ve,2*ct),F(Ne,2*Ve+1,2*ct+1)}function F(Ie,Ne,Ve){var ct=Ie[Ne];Ie[Ne]=Ie[Ve],Ie[Ve]=ct}function i(Ie,Ne,Ve,ct,Me,ht,Wt){for(var Qt=[0,Ie.length-1,0],ur=[],oe,$;Qt.length;){var H=Qt.pop(),Ae=Qt.pop(),ye=Qt.pop();if(Ae-ye<=Wt){for(var Te=ye;Te<=Ae;Te++)oe=Ne[2*Te],$=Ne[2*Te+1],oe>=Ve&&oe<=Me&&$>=ct&&$<=ht&&ur.push(Ie[Te]);continue}var pe=Math.floor((ye+Ae)/2);oe=Ne[2*pe],$=Ne[2*pe+1],oe>=Ve&&oe<=Me&&$>=ct&&$<=ht&&ur.push(Ie[pe]);var it=(H+1)%2;(H===0?Ve<=oe:ct<=$)&&(Qt.push(ye),Qt.push(pe-1),Qt.push(it)),(H===0?Me>=oe:ht>=$)&&(Qt.push(pe+1),Qt.push(Ae),Qt.push(it))}return ur}function Z(Ie,Ne,Ve,ct,Me,ht){for(var Wt=[0,Ie.length-1,0],Qt=[],ur=Me*Me;Wt.length;){var oe=Wt.pop(),$=Wt.pop(),H=Wt.pop();if($-H<=ht){for(var Ae=H;Ae<=$;Ae++)D(Ne[2*Ae],Ne[2*Ae+1],Ve,ct)<=ur&&Qt.push(Ie[Ae]);continue}var ye=Math.floor((H+$)/2),Te=Ne[2*ye],pe=Ne[2*ye+1];D(Te,pe,Ve,ct)<=ur&&Qt.push(Ie[ye]);var it=(oe+1)%2;(oe===0?Ve-Me<=Te:ct-Me<=pe)&&(Wt.push(H),Wt.push(ye-1),Wt.push(it)),(oe===0?Ve+Me>=Te:ct+Me>=pe)&&(Wt.push(ye+1),Wt.push($),Wt.push(it))}return Qt}function D(Ie,Ne,Ve,ct){var Me=Ie-Ve,ht=Ne-ct;return Me*Me+ht*ht}var J=function(Ne){return Ne[0]},ee=function(Ne){return Ne[1]},ce=function(Ne,Ve,ct,Me,ht){Ve===void 0&&(Ve=J),ct===void 0&&(ct=ee),Me===void 0&&(Me=64),ht===void 0&&(ht=Float64Array),this.nodeSize=Me,this.points=Ne;for(var Wt=Ne.length<65536?Uint16Array:Uint32Array,Qt=this.ids=new Wt(Ne.length),ur=this.coords=new ht(Ne.length*2),oe=0;oe<Ne.length;oe++)Qt[oe]=oe,ur[2*oe]=Ve(Ne[oe]),ur[2*oe+1]=ct(Ne[oe]);E(Qt,ur,Me,0,Qt.length-1,0)};ce.prototype.range=function(Ne,Ve,ct,Me){return i(this.ids,this.coords,Ne,Ve,ct,Me,this.nodeSize)},ce.prototype.within=function(Ne,Ve,ct){return Z(this.ids,this.coords,Ne,Ve,ct,this.nodeSize)};var Y={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(Ne){return Ne}},ze=function(Ne){this.options=Je(Object.create(Y),Ne),this.trees=new Array(this.options.maxZoom+1)};ze.prototype.load=function(Ne){var Ve=this.options,ct=Ve.log,Me=Ve.minZoom,ht=Ve.maxZoom,Wt=Ve.nodeSize;ct&&console.time("total time");var Qt="prepare "+Ne.length+" points";ct&&console.time(Qt),this.points=Ne;for(var ur=[],oe=0;oe<Ne.length;oe++){if(!Ne[oe].geometry)continue;ur.push(be(Ne[oe],oe))}this.trees[ht+1]=new ce(ur,wt,At,Wt,Float32Array),ct&&console.timeEnd(Qt);for(var $=ht;$>=Me;$--){var H=+Date.now();ur=this._cluster(ur,$),this.trees[$]=new ce(ur,wt,At,Wt,Float32Array),ct&&console.log("z%d: %d clusters in %dms",$,ur.length,+Date.now()-H)}return ct&&console.timeEnd("total time"),this},ze.prototype.getClusters=function(Ne,Ve){var ct=((Ne[0]+180)%360+360)%360-180,Me=Math.max(-90,Math.min(90,Ne[1])),ht=Ne[2]===180?180:((Ne[2]+180)%360+360)%360-180,Wt=Math.max(-90,Math.min(90,Ne[3]));if(Ne[2]-Ne[0]>=360)ct=-180,ht=180;else if(ct>ht){var Qt=this.getClusters([ct,Me,180,Wt],Ve),ur=this.getClusters([-180,Me,ht,Wt],Ve);return Qt.concat(ur)}for(var oe=this.trees[this._limitZoom(Ve)],$=oe.range(Le(ct),St(Wt),Le(ht),St(Me)),H=[],Ae=0,ye=$;Ae<ye.length;Ae+=1){var Te=ye[Ae],pe=oe.points[Te];H.push(pe.numPoints?Se(pe):this.points[pe.index])}return H},ze.prototype.getChildren=function(Ne){var Ve=this._getOriginId(Ne),ct=this._getOriginZoom(Ne),Me="No cluster with the specified id.",ht=this.trees[ct];if(!ht)throw new Error(Me);var Wt=ht.points[Ve];if(!Wt)throw new Error(Me);for(var Qt=this.options.radius/(this.options.extent*Math.pow(2,ct-1)),ur=ht.within(Wt.x,Wt.y,Qt),oe=[],$=0,H=ur;$<H.length;$+=1){var Ae=H[$],ye=ht.points[Ae];ye.parentId===Ne&&oe.push(ye.numPoints?Se(ye):this.points[ye.index])}if(oe.length===0)throw new Error(Me);return oe},ze.prototype.getLeaves=function(Ne,Ve,ct){Ve=Ve||10,ct=ct||0;var Me=[];return this._appendLeaves(Me,Ne,Ve,ct,0),Me},ze.prototype.getTile=function(Ne,Ve,ct){var Me=this.trees[this._limitZoom(Ne)],ht=Math.pow(2,Ne),Wt=this.options,Qt=Wt.extent,ur=Wt.radius,oe=ur/Qt,$=(ct-oe)/ht,H=(ct+1+oe)/ht,Ae={features:[]};return this._addTileFeatures(Me.range((Ve-oe)/ht,$,(Ve+1+oe)/ht,H),Me.points,Ve,ct,ht,Ae),Ve===0&&this._addTileFeatures(Me.range(1-oe/ht,$,1,H),Me.points,ht,ct,ht,Ae),Ve===ht-1&&this._addTileFeatures(Me.range(0,$,oe/ht,H),Me.points,-1,ct,ht,Ae),Ae.features.length?Ae:null},ze.prototype.getClusterExpansionZoom=function(Ne){for(var Ve=this._getOriginZoom(Ne)-1;Ve<=this.options.maxZoom;){var ct=this.getChildren(Ne);if(Ve++,ct.length!==1)break;Ne=ct[0].properties.cluster_id}return Ve},ze.prototype._appendLeaves=function(Ne,Ve,ct,Me,ht){for(var Wt=this.getChildren(Ve),Qt=0,ur=Wt;Qt<ur.length;Qt+=1){var oe=ur[Qt],$=oe.properties;if($&&$.cluster?ht+$.point_count<=Me?ht+=$.point_count:ht=this._appendLeaves(Ne,$.cluster_id,ct,Me,ht):ht<Me?ht++:Ne.push(oe),Ne.length===ct)break}return ht},ze.prototype._addTileFeatures=function(Ne,Ve,ct,Me,ht,Wt){for(var Qt=0,ur=Ne;Qt<ur.length;Qt+=1){var oe=ur[Qt],$=Ve[oe],H=$.numPoints,Ae={type:1,geometry:[[Math.round(this.options.extent*($.x*ht-ct)),Math.round(this.options.extent*($.y*ht-Me))]],tags:H?mt($):this.points[$.index].properties},ye=void 0;H?ye=$.id:this.options.generateId?ye=$.index:this.points[$.index].id&&(ye=this.points[$.index].id),ye!==void 0&&(Ae.id=ye),Wt.features.push(Ae)}},ze.prototype._limitZoom=function(Ne){return Math.max(this.options.minZoom,Math.min(+Ne,this.options.maxZoom+1))},ze.prototype._cluster=function(Ne,Ve){for(var ct=[],Me=this.options,ht=Me.radius,Wt=Me.extent,Qt=Me.reduce,ur=Me.minPoints,oe=ht/(Wt*Math.pow(2,Ve)),$=0;$<Ne.length;$++){var H=Ne[$];if(H.zoom<=Ve)continue;H.zoom=Ve;for(var Ae=this.trees[Ve+1],ye=Ae.within(H.x,H.y,oe),Te=H.numPoints||1,pe=Te,it=0,qt=ye;it<qt.length;it+=1){var Pt=qt[it],me=Ae.points[Pt];me.zoom>Ve&&(pe+=me.numPoints||1)}if(pe>=ur){for(var ve=H.x*Te,Ge=H.y*Te,st=Qt&&Te>1?this._map(H,!0):null,Oe=($<<5)+(Ve+1)+this.points.length,gt=0,C=ye;gt<C.length;gt+=1){var R=C[gt],q=Ae.points[R];if(q.zoom<=Ve)continue;q.zoom=Ve;var fe=q.numPoints||1;ve+=q.x*fe,Ge+=q.y*fe,q.parentId=Oe,Qt&&(st||(st=this._map(H,!0)),Qt(st,this._map(q)))}H.parentId=Oe,ct.push(Xe(ve/pe,Ge/pe,Oe,pe,st))}else if(ct.push(H),pe>1)for(var He=0,et=ye;He<et.length;He+=1){var _t=et[He],ot=Ae.points[_t];if(ot.zoom<=Ve)continue;ot.zoom=Ve,ct.push(ot)}}return ct},ze.prototype._getOriginId=function(Ne){return Ne-this.points.length>>5},ze.prototype._getOriginZoom=function(Ne){return(Ne-this.points.length)%32},ze.prototype._map=function(Ne,Ve){if(Ne.numPoints)return Ve?Je({},Ne.properties):Ne.properties;var ct=this.points[Ne.index].properties,Me=this.options.map(ct);return Ve&&Me===ct?Je({},Me):Me};function Xe(Ie,Ne,Ve,ct,Me){return{x:Ie,y:Ne,zoom:Infinity,id:Ve,parentId:-1,numPoints:ct,properties:Me}}function be(Ie,Ne){var Ve=Ie.geometry.coordinates,ct=Ve[0],Me=Ve[1];return{x:Le(ct),y:St(Me),zoom:Infinity,index:Ne,parentId:-1}}function Se(Ie){return{type:"Feature",id:Ie.id,properties:mt(Ie),geometry:{type:"Point",coordinates:[Ye(Ie.x),dt(Ie.y)]}}}function mt(Ie){var Ne=Ie.numPoints,Ve=Ne>=1e4?Math.round(Ne/1e3)+"k":Ne>=1e3?Math.round(Ne/100)/10+"k":Ne;return Je(Je({},Ie.properties),{cluster:!0,cluster_id:Ie.id,point_count:Ne,point_count_abbreviated:Ve})}function Le(Ie){return Ie/360+.5}function St(Ie){var Ne=Math.sin(Ie*Math.PI/180),Ve=.5-.25*Math.log((1+Ne)/(1-Ne))/Math.PI;return Ve<0?0:Ve>1?1:Ve}function Ye(Ie){return(Ie-.5)*360}function dt(Ie){var Ne=(180-Ie*360)*Math.PI/180;return 360*Math.atan(Math.exp(Ne))/Math.PI-90}function Je(Ie,Ne){for(var Ve in Ne)Ie[Ve]=Ne[Ve];return Ie}function wt(Ie){return Ie.x}function At(Ie){return Ie.y}return ze})},"mv/X":function(Ue,g,o){var E=o("ljhN"),p=o("MMmD"),X=o("wJg7"),F=o("GoyQ");function i(Z,D,J){if(!F(J))return!1;var ee=typeof D;return(ee=="number"?p(J)&&X(D,J.length):ee=="string"&&D in J)?E(J[D],Z):!1}Ue.exports=i},"n+fv":function(Ue,g,o){"use strict";o.r(g),o.d(g,"create",function(){return p}),o.d(g,"clone",function(){return X}),o.d(g,"length",function(){return F}),o.d(g,"fromValues",function(){return i}),o.d(g,"copy",function(){return Z}),o.d(g,"set",function(){return D}),o.d(g,"add",function(){return J}),o.d(g,"subtract",function(){return ee}),o.d(g,"multiply",function(){return ce}),o.d(g,"divide",function(){return Y}),o.d(g,"ceil",function(){return ze}),o.d(g,"floor",function(){return Xe}),o.d(g,"min",function(){return be}),o.d(g,"max",function(){return Se}),o.d(g,"round",function(){return mt}),o.d(g,"scale",function(){return Le}),o.d(g,"scaleAndAdd",function(){return St}),o.d(g,"distance",function(){return Ye}),o.d(g,"squaredDistance",function(){return dt}),o.d(g,"squaredLength",function(){return Je}),o.d(g,"negate",function(){return wt}),o.d(g,"inverse",function(){return At}),o.d(g,"normalize",function(){return Ie}),o.d(g,"dot",function(){return Ne}),o.d(g,"cross",function(){return Ve}),o.d(g,"lerp",function(){return ct}),o.d(g,"hermite",function(){return Me}),o.d(g,"bezier",function(){return ht}),o.d(g,"random",function(){return Wt}),o.d(g,"transformMat4",function(){return Qt}),o.d(g,"transformMat3",function(){return ur}),o.d(g,"transformQuat",function(){return oe}),o.d(g,"rotateX",function(){return $}),o.d(g,"rotateY",function(){return H}),o.d(g,"rotateZ",function(){return Ae}),o.d(g,"angle",function(){return ye}),o.d(g,"zero",function(){return Te}),o.d(g,"str",function(){return pe}),o.d(g,"exactEquals",function(){return it}),o.d(g,"equals",function(){return qt}),o.d(g,"sub",function(){return Pt}),o.d(g,"mul",function(){return me}),o.d(g,"div",function(){return ve}),o.d(g,"dist",function(){return Ge}),o.d(g,"sqrDist",function(){return st}),o.d(g,"len",function(){return Oe}),o.d(g,"sqrLen",function(){return gt}),o.d(g,"forEach",function(){return C});var E=o("yU0y");function p(){var R=new E.a(3);return E.a!=Float32Array&&(R[0]=0,R[1]=0,R[2]=0),R}function X(R){var q=new E.a(3);return q[0]=R[0],q[1]=R[1],q[2]=R[2],q}function F(R){var q=R[0],fe=R[1],He=R[2];return Math.hypot(q,fe,He)}function i(R,q,fe){var He=new E.a(3);return He[0]=R,He[1]=q,He[2]=fe,He}function Z(R,q){return R[0]=q[0],R[1]=q[1],R[2]=q[2],R}function D(R,q,fe,He){return R[0]=q,R[1]=fe,R[2]=He,R}function J(R,q,fe){return R[0]=q[0]+fe[0],R[1]=q[1]+fe[1],R[2]=q[2]+fe[2],R}function ee(R,q,fe){return R[0]=q[0]-fe[0],R[1]=q[1]-fe[1],R[2]=q[2]-fe[2],R}function ce(R,q,fe){return R[0]=q[0]*fe[0],R[1]=q[1]*fe[1],R[2]=q[2]*fe[2],R}function Y(R,q,fe){return R[0]=q[0]/fe[0],R[1]=q[1]/fe[1],R[2]=q[2]/fe[2],R}function ze(R,q){return R[0]=Math.ceil(q[0]),R[1]=Math.ceil(q[1]),R[2]=Math.ceil(q[2]),R}function Xe(R,q){return R[0]=Math.floor(q[0]),R[1]=Math.floor(q[1]),R[2]=Math.floor(q[2]),R}function be(R,q,fe){return R[0]=Math.min(q[0],fe[0]),R[1]=Math.min(q[1],fe[1]),R[2]=Math.min(q[2],fe[2]),R}function Se(R,q,fe){return R[0]=Math.max(q[0],fe[0]),R[1]=Math.max(q[1],fe[1]),R[2]=Math.max(q[2],fe[2]),R}function mt(R,q){return R[0]=Math.round(q[0]),R[1]=Math.round(q[1]),R[2]=Math.round(q[2]),R}function Le(R,q,fe){return R[0]=q[0]*fe,R[1]=q[1]*fe,R[2]=q[2]*fe,R}function St(R,q,fe,He){return R[0]=q[0]+fe[0]*He,R[1]=q[1]+fe[1]*He,R[2]=q[2]+fe[2]*He,R}function Ye(R,q){var fe=q[0]-R[0],He=q[1]-R[1],et=q[2]-R[2];return Math.hypot(fe,He,et)}function dt(R,q){var fe=q[0]-R[0],He=q[1]-R[1],et=q[2]-R[2];return fe*fe+He*He+et*et}function Je(R){var q=R[0],fe=R[1],He=R[2];return q*q+fe*fe+He*He}function wt(R,q){return R[0]=-q[0],R[1]=-q[1],R[2]=-q[2],R}function At(R,q){return R[0]=1/q[0],R[1]=1/q[1],R[2]=1/q[2],R}function Ie(R,q){var fe=q[0],He=q[1],et=q[2],_t=fe*fe+He*He+et*et;return _t>0&&(_t=1/Math.sqrt(_t)),R[0]=q[0]*_t,R[1]=q[1]*_t,R[2]=q[2]*_t,R}function Ne(R,q){return R[0]*q[0]+R[1]*q[1]+R[2]*q[2]}function Ve(R,q,fe){var He=q[0],et=q[1],_t=q[2],ot=fe[0],Ut=fe[1],K=fe[2];return R[0]=et*K-_t*Ut,R[1]=_t*ot-He*K,R[2]=He*Ut-et*ot,R}function ct(R,q,fe,He){var et=q[0],_t=q[1],ot=q[2];return R[0]=et+He*(fe[0]-et),R[1]=_t+He*(fe[1]-_t),R[2]=ot+He*(fe[2]-ot),R}function Me(R,q,fe,He,et,_t){var ot=_t*_t,Ut=ot*(2*_t-3)+1,K=ot*(_t-2)+_t,qe=ot*(_t-1),ae=ot*(3-2*_t);return R[0]=q[0]*Ut+fe[0]*K+He[0]*qe+et[0]*ae,R[1]=q[1]*Ut+fe[1]*K+He[1]*qe+et[1]*ae,R[2]=q[2]*Ut+fe[2]*K+He[2]*qe+et[2]*ae,R}function ht(R,q,fe,He,et,_t){var ot=1-_t,Ut=ot*ot,K=_t*_t,qe=Ut*ot,ae=3*_t*Ut,tt=3*K*ot,kt=K*_t;return R[0]=q[0]*qe+fe[0]*ae+He[0]*tt+et[0]*kt,R[1]=q[1]*qe+fe[1]*ae+He[1]*tt+et[1]*kt,R[2]=q[2]*qe+fe[2]*ae+He[2]*tt+et[2]*kt,R}function Wt(R,q){q=q||1;var fe=E.c()*2*Math.PI,He=E.c()*2-1,et=Math.sqrt(1-He*He)*q;return R[0]=Math.cos(fe)*et,R[1]=Math.sin(fe)*et,R[2]=He*q,R}function Qt(R,q,fe){var He=q[0],et=q[1],_t=q[2],ot=fe[3]*He+fe[7]*et+fe[11]*_t+fe[15];return ot=ot||1,R[0]=(fe[0]*He+fe[4]*et+fe[8]*_t+fe[12])/ot,R[1]=(fe[1]*He+fe[5]*et+fe[9]*_t+fe[13])/ot,R[2]=(fe[2]*He+fe[6]*et+fe[10]*_t+fe[14])/ot,R}function ur(R,q,fe){var He=q[0],et=q[1],_t=q[2];return R[0]=He*fe[0]+et*fe[3]+_t*fe[6],R[1]=He*fe[1]+et*fe[4]+_t*fe[7],R[2]=He*fe[2]+et*fe[5]+_t*fe[8],R}function oe(R,q,fe){var He=fe[0],et=fe[1],_t=fe[2],ot=fe[3],Ut=q[0],K=q[1],qe=q[2],ae=et*qe-_t*K,tt=_t*Ut-He*qe,kt=He*K-et*Ut,pr=et*kt-_t*tt,Ke=_t*ae-He*kt,xt=He*tt-et*ae,bt=ot*2;return ae*=bt,tt*=bt,kt*=bt,pr*=2,Ke*=2,xt*=2,R[0]=Ut+ae+pr,R[1]=K+tt+Ke,R[2]=qe+kt+xt,R}function $(R,q,fe,He){var et=[],_t=[];return et[0]=q[0]-fe[0],et[1]=q[1]-fe[1],et[2]=q[2]-fe[2],_t[0]=et[0],_t[1]=et[1]*Math.cos(He)-et[2]*Math.sin(He),_t[2]=et[1]*Math.sin(He)+et[2]*Math.cos(He),R[0]=_t[0]+fe[0],R[1]=_t[1]+fe[1],R[2]=_t[2]+fe[2],R}function H(R,q,fe,He){var et=[],_t=[];return et[0]=q[0]-fe[0],et[1]=q[1]-fe[1],et[2]=q[2]-fe[2],_t[0]=et[2]*Math.sin(He)+et[0]*Math.cos(He),_t[1]=et[1],_t[2]=et[2]*Math.cos(He)-et[0]*Math.sin(He),R[0]=_t[0]+fe[0],R[1]=_t[1]+fe[1],R[2]=_t[2]+fe[2],R}function Ae(R,q,fe,He){var et=[],_t=[];return et[0]=q[0]-fe[0],et[1]=q[1]-fe[1],et[2]=q[2]-fe[2],_t[0]=et[0]*Math.cos(He)-et[1]*Math.sin(He),_t[1]=et[0]*Math.sin(He)+et[1]*Math.cos(He),_t[2]=et[2],R[0]=_t[0]+fe[0],R[1]=_t[1]+fe[1],R[2]=_t[2]+fe[2],R}function ye(R,q){var fe=R[0],He=R[1],et=R[2],_t=q[0],ot=q[1],Ut=q[2],K=Math.sqrt(fe*fe+He*He+et*et),qe=Math.sqrt(_t*_t+ot*ot+Ut*Ut),ae=K*qe,tt=ae&&Ne(R,q)/ae;return Math.acos(Math.min(Math.max(tt,-1),1))}function Te(R){return R[0]=0,R[1]=0,R[2]=0,R}function pe(R){return"vec3("+R[0]+", "+R[1]+", "+R[2]+")"}function it(R,q){return R[0]===q[0]&&R[1]===q[1]&&R[2]===q[2]}function qt(R,q){var fe=R[0],He=R[1],et=R[2],_t=q[0],ot=q[1],Ut=q[2];return Math.abs(fe-_t)<=E.b*Math.max(1,Math.abs(fe),Math.abs(_t))&&Math.abs(He-ot)<=E.b*Math.max(1,Math.abs(He),Math.abs(ot))&&Math.abs(et-Ut)<=E.b*Math.max(1,Math.abs(et),Math.abs(Ut))}var Pt=ee,me=ce,ve=Y,Ge=Ye,st=dt,Oe=F,gt=Je,C=function(){var R=p();return function(q,fe,He,et,_t,ot){var Ut,K;for(fe||(fe=3),He||(He=0),et?K=Math.min(et*fe+He,q.length):K=q.length,Ut=He;Ut<K;Ut+=fe)R[0]=q[Ut],R[1]=q[Ut+1],R[2]=q[Ut+2],_t(R,R,ot),q[Ut]=R[0],q[Ut+1]=R[1],q[Ut+2]=R[2];return q}}()},n2J3:function(Ue,g,o){"use strict";Object.defineProperty(g,"__esModule",{value:!0}),g.unmanaged=void 0;var E=o("xfSm"),p=o("GXnB"),X=o("Ztfv");function F(){return function(i,Z,D){var J=new p.Metadata(E.UNMANAGED_TAG,!0);X.tagParameter(i,Z,D,J)}}g.unmanaged=F},n3AX:function(Ue,g,o){var E=o("Nsbk");function p(X,F){for(;!Object.prototype.hasOwnProperty.call(X,F)&&!(X=E(X),X===null););return X}Ue.exports=p},"o+pz":function(Ue,g,o){"use strict";o.d(g,"a",function(){return E});var E;(function(p){p[p.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",p[p.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",p[p.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",p[p.POINTS=0]="POINTS",p[p.LINES=1]="LINES",p[p.LINE_LOOP=2]="LINE_LOOP",p[p.LINE_STRIP=3]="LINE_STRIP",p[p.TRIANGLES=4]="TRIANGLES",p[p.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",p[p.TRIANGLE_FAN=6]="TRIANGLE_FAN",p[p.ZERO=0]="ZERO",p[p.ONE=1]="ONE",p[p.SRC_COLOR=768]="SRC_COLOR",p[p.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",p[p.SRC_ALPHA=770]="SRC_ALPHA",p[p.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",p[p.DST_ALPHA=772]="DST_ALPHA",p[p.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",p[p.DST_COLOR=774]="DST_COLOR",p[p.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",p[p.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",p[p.FUNC_ADD=32774]="FUNC_ADD",p[p.BLEND_EQUATION=32777]="BLEND_EQUATION",p[p.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",p[p.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",p[p.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",p[p.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",p[p.MAX_EXT=32776]="MAX_EXT",p[p.MIN_EXT=32775]="MIN_EXT",p[p.BLEND_DST_RGB=32968]="BLEND_DST_RGB",p[p.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",p[p.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",p[p.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",p[p.CONSTANT_COLOR=32769]="CONSTANT_COLOR",p[p.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",p[p.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",p[p.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",p[p.BLEND_COLOR=32773]="BLEND_COLOR",p[p.ARRAY_BUFFER=34962]="ARRAY_BUFFER",p[p.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",p[p.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",p[p.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",p[p.STREAM_DRAW=35040]="STREAM_DRAW",p[p.STATIC_DRAW=35044]="STATIC_DRAW",p[p.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",p[p.BUFFER_SIZE=34660]="BUFFER_SIZE",p[p.BUFFER_USAGE=34661]="BUFFER_USAGE",p[p.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",p[p.FRONT=1028]="FRONT",p[p.BACK=1029]="BACK",p[p.FRONT_AND_BACK=1032]="FRONT_AND_BACK",p[p.CULL_FACE=2884]="CULL_FACE",p[p.BLEND=3042]="BLEND",p[p.DITHER=3024]="DITHER",p[p.STENCIL_TEST=2960]="STENCIL_TEST",p[p.DEPTH_TEST=2929]="DEPTH_TEST",p[p.SCISSOR_TEST=3089]="SCISSOR_TEST",p[p.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",p[p.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",p[p.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",p[p.NO_ERROR=0]="NO_ERROR",p[p.INVALID_ENUM=1280]="INVALID_ENUM",p[p.INVALID_VALUE=1281]="INVALID_VALUE",p[p.INVALID_OPERATION=1282]="INVALID_OPERATION",p[p.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",p[p.CW=2304]="CW",p[p.CCW=2305]="CCW",p[p.LINE_WIDTH=2849]="LINE_WIDTH",p[p.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",p[p.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",p[p.CULL_FACE_MODE=2885]="CULL_FACE_MODE",p[p.FRONT_FACE=2886]="FRONT_FACE",p[p.DEPTH_RANGE=2928]="DEPTH_RANGE",p[p.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",p[p.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",p[p.DEPTH_FUNC=2932]="DEPTH_FUNC",p[p.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",p[p.STENCIL_FUNC=2962]="STENCIL_FUNC",p[p.STENCIL_FAIL=2964]="STENCIL_FAIL",p[p.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",p[p.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",p[p.STENCIL_REF=2967]="STENCIL_REF",p[p.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",p[p.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",p[p.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",p[p.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",p[p.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",p[p.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",p[p.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",p[p.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",p[p.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",p[p.VIEWPORT=2978]="VIEWPORT",p[p.SCISSOR_BOX=3088]="SCISSOR_BOX",p[p.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",p[p.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",p[p.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",p[p.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",p[p.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",p[p.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",p[p.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",p[p.RED_BITS=3410]="RED_BITS",p[p.GREEN_BITS=3411]="GREEN_BITS",p[p.BLUE_BITS=3412]="BLUE_BITS",p[p.ALPHA_BITS=3413]="ALPHA_BITS",p[p.DEPTH_BITS=3414]="DEPTH_BITS",p[p.STENCIL_BITS=3415]="STENCIL_BITS",p[p.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",p[p.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",p[p.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",p[p.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",p[p.SAMPLES=32937]="SAMPLES",p[p.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",p[p.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",p[p.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",p[p.DONT_CARE=4352]="DONT_CARE",p[p.FASTEST=4353]="FASTEST",p[p.NICEST=4354]="NICEST",p[p.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",p[p.BYTE=5120]="BYTE",p[p.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",p[p.SHORT=5122]="SHORT",p[p.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",p[p.INT=5124]="INT",p[p.UNSIGNED_INT=5125]="UNSIGNED_INT",p[p.FLOAT=5126]="FLOAT",p[p.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",p[p.ALPHA=6406]="ALPHA",p[p.RGB=6407]="RGB",p[p.RGBA=6408]="RGBA",p[p.LUMINANCE=6409]="LUMINANCE",p[p.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",p[p.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",p[p.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",p[p.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",p[p.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",p[p.VERTEX_SHADER=35633]="VERTEX_SHADER",p[p.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",p[p.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",p[p.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",p[p.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",p[p.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",p[p.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",p[p.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",p[p.SHADER_TYPE=35663]="SHADER_TYPE",p[p.DELETE_STATUS=35712]="DELETE_STATUS",p[p.LINK_STATUS=35714]="LINK_STATUS",p[p.VALIDATE_STATUS=35715]="VALIDATE_STATUS",p[p.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",p[p.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",p[p.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",p[p.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",p[p.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",p[p.NEVER=512]="NEVER",p[p.LESS=513]="LESS",p[p.EQUAL=514]="EQUAL",p[p.LEQUAL=515]="LEQUAL",p[p.GREATER=516]="GREATER",p[p.NOTEQUAL=517]="NOTEQUAL",p[p.GEQUAL=518]="GEQUAL",p[p.ALWAYS=519]="ALWAYS",p[p.KEEP=7680]="KEEP",p[p.REPLACE=7681]="REPLACE",p[p.INCR=7682]="INCR",p[p.DECR=7683]="DECR",p[p.INVERT=5386]="INVERT",p[p.INCR_WRAP=34055]="INCR_WRAP",p[p.DECR_WRAP=34056]="DECR_WRAP",p[p.VENDOR=7936]="VENDOR",p[p.RENDERER=7937]="RENDERER",p[p.VERSION=7938]="VERSION",p[p.NEAREST=9728]="NEAREST",p[p.LINEAR=9729]="LINEAR",p[p.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",p[p.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",p[p.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",p[p.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",p[p.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",p[p.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",p[p.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",p[p.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",p[p.TEXTURE_2D=3553]="TEXTURE_2D",p[p.TEXTURE=5890]="TEXTURE",p[p.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",p[p.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",p[p.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",p[p.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",p[p.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",p[p.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",p[p.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",p[p.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",p[p.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",p[p.TEXTURE0=33984]="TEXTURE0",p[p.TEXTURE1=33985]="TEXTURE1",p[p.TEXTURE2=33986]="TEXTURE2",p[p.TEXTURE3=33987]="TEXTURE3",p[p.TEXTURE4=33988]="TEXTURE4",p[p.TEXTURE5=33989]="TEXTURE5",p[p.TEXTURE6=33990]="TEXTURE6",p[p.TEXTURE7=33991]="TEXTURE7",p[p.TEXTURE8=33992]="TEXTURE8",p[p.TEXTURE9=33993]="TEXTURE9",p[p.TEXTURE10=33994]="TEXTURE10",p[p.TEXTURE11=33995]="TEXTURE11",p[p.TEXTURE12=33996]="TEXTURE12",p[p.TEXTURE13=33997]="TEXTURE13",p[p.TEXTURE14=33998]="TEXTURE14",p[p.TEXTURE15=33999]="TEXTURE15",p[p.TEXTURE16=34e3]="TEXTURE16",p[p.TEXTURE17=34001]="TEXTURE17",p[p.TEXTURE18=34002]="TEXTURE18",p[p.TEXTURE19=34003]="TEXTURE19",p[p.TEXTURE20=34004]="TEXTURE20",p[p.TEXTURE21=34005]="TEXTURE21",p[p.TEXTURE22=34006]="TEXTURE22",p[p.TEXTURE23=34007]="TEXTURE23",p[p.TEXTURE24=34008]="TEXTURE24",p[p.TEXTURE25=34009]="TEXTURE25",p[p.TEXTURE26=34010]="TEXTURE26",p[p.TEXTURE27=34011]="TEXTURE27",p[p.TEXTURE28=34012]="TEXTURE28",p[p.TEXTURE29=34013]="TEXTURE29",p[p.TEXTURE30=34014]="TEXTURE30",p[p.TEXTURE31=34015]="TEXTURE31",p[p.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",p[p.REPEAT=10497]="REPEAT",p[p.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",p[p.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",p[p.FLOAT_VEC2=35664]="FLOAT_VEC2",p[p.FLOAT_VEC3=35665]="FLOAT_VEC3",p[p.FLOAT_VEC4=35666]="FLOAT_VEC4",p[p.INT_VEC2=35667]="INT_VEC2",p[p.INT_VEC3=35668]="INT_VEC3",p[p.INT_VEC4=35669]="INT_VEC4",p[p.BOOL=35670]="BOOL",p[p.BOOL_VEC2=35671]="BOOL_VEC2",p[p.BOOL_VEC3=35672]="BOOL_VEC3",p[p.BOOL_VEC4=35673]="BOOL_VEC4",p[p.FLOAT_MAT2=35674]="FLOAT_MAT2",p[p.FLOAT_MAT3=35675]="FLOAT_MAT3",p[p.FLOAT_MAT4=35676]="FLOAT_MAT4",p[p.SAMPLER_2D=35678]="SAMPLER_2D",p[p.SAMPLER_CUBE=35680]="SAMPLER_CUBE",p[p.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",p[p.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",p[p.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",p[p.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",p[p.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",p[p.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",p[p.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",p[p.COMPILE_STATUS=35713]="COMPILE_STATUS",p[p.LOW_FLOAT=36336]="LOW_FLOAT",p[p.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",p[p.HIGH_FLOAT=36338]="HIGH_FLOAT",p[p.LOW_INT=36339]="LOW_INT",p[p.MEDIUM_INT=36340]="MEDIUM_INT",p[p.HIGH_INT=36341]="HIGH_INT",p[p.FRAMEBUFFER=36160]="FRAMEBUFFER",p[p.RENDERBUFFER=36161]="RENDERBUFFER",p[p.RGBA4=32854]="RGBA4",p[p.RGB5_A1=32855]="RGB5_A1",p[p.RGB565=36194]="RGB565",p[p.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",p[p.STENCIL_INDEX=6401]="STENCIL_INDEX",p[p.STENCIL_INDEX8=36168]="STENCIL_INDEX8",p[p.DEPTH_STENCIL=34041]="DEPTH_STENCIL",p[p.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",p[p.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",p[p.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",p[p.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",p[p.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",p[p.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",p[p.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",p[p.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",p[p.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",p[p.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",p[p.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",p[p.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",p[p.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",p[p.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",p[p.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",p[p.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",p[p.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",p[p.NONE=0]="NONE",p[p.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",p[p.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",p[p.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",p[p.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",p[p.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",p[p.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",p[p.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",p[p.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",p[p.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",p[p.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",p[p.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",p[p.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",p[p.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",p[p.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL"})(E||(E={}))},"oCl/":function(Ue,g,o){var E=o("CH3K"),p=o("LcsW"),X=o("MvSz"),F=o("0ycA"),i=Object.getOwnPropertySymbols,Z=i?function(D){for(var J=[];D;)E(J,X(D)),D=p(D);return J}:F;Ue.exports=Z},oShl:function(Ue,g,o){var E=o("Nsbk"),p=o("SksO"),X=o("xfeJ"),F=o("sXyB");function i(Z){var D=typeof Map=="function"?new Map:void 0;return Ue.exports=i=function(ee){if(ee===null||!X(ee))return ee;if(typeof ee!="function")throw new TypeError("Super expression must either be null or a function");if(typeof D!="undefined"){if(D.has(ee))return D.get(ee);D.set(ee,ce)}function ce(){return F(ee,arguments,E(this).constructor)}return ce.prototype=Object.create(ee.prototype,{constructor:{value:ce,enumerable:!1,writable:!0,configurable:!0}}),p(ce,ee)},i(Z)}Ue.exports=i},oaX6:function(Ue,g,o){"use strict";Object.defineProperty(g,"__esModule",{value:!0}),g.targetName=void 0;var E=o("xfSm"),p=o("GXnB"),X=o("Ztfv");function F(i){return function(Z,D,J){var ee=new p.Metadata(E.NAME_TAG,i);X.tagParameter(Z,D,J,ee)}}g.targetName=F},"otv/":function(Ue,g,o){var E=o("nmnc"),p=E?E.prototype:void 0,X=p?p.valueOf:void 0;function F(i){return X?Object(X.call(i)):{}}Ue.exports=F},"oy+k":function(Ue,g,o){"use strict";Object.defineProperty(g,"__esModule",{value:!0}),g.Context=void 0;var E=o("d9O0"),p=function(){function X(F){this.id=E.id(),this.container=F}return X.prototype.addPlan=function(F){this.plan=F},X.prototype.setCurrentRequest=function(F){this.currentRequest=F},X}();g.Context=p},pFRH:function(Ue,g,o){var E=o("cvCv"),p=o("O0oS"),X=o("zZ0H"),F=p?function(i,Z){return p(i,"toString",{configurable:!0,enumerable:!1,value:E(Z),writable:!0})}:X;Ue.exports=F},q4HE:function(Ue,g){var o="\\ud800-\\udfff",E="\\u0300-\\u036f",p="\\ufe20-\\ufe2f",X="\\u20d0-\\u20ff",F=E+p+X,i="\\ufe0e\\ufe0f",Z="["+o+"]",D="["+F+"]",J="\\ud83c[\\udffb-\\udfff]",ee="(?:"+D+"|"+J+")",ce="[^"+o+"]",Y="(?:\\ud83c[\\udde6-\\uddff]){2}",ze="[\\ud800-\\udbff][\\udc00-\\udfff]",Xe="\\u200d",be=ee+"?",Se="["+i+"]?",mt="(?:"+Xe+"(?:"+[ce,Y,ze].join("|")+")"+Se+be+")*",Le=Se+be+mt,St="(?:"+[ce+D+"?",D,Y,ze,Z].join("|")+")",Ye=RegExp(J+"(?="+J+")|"+St+Le,"g");function dt(Je){for(var wt=Ye.lastIndex=0;Ye.test(Je);)++wt;return wt}Ue.exports=dt},qK8v:function(Ue,g,o){"use strict";Object.defineProperty(g,"__esModule",{value:!0}),g.isStackOverflowExeption=void 0;var E=o("MON2");function p(X){return X instanceof RangeError||X.message===E.STACK_OVERFLOW}g.isStackOverflowExeption=p},qRkn:function(Ue,g,o){var E=o("3cYt"),p={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},X=E(p);Ue.exports=X},qd8s:function(Ue,g,o){(function(E,p){var X=200,F="__lodash_hash_undefined__",i=800,Z=16,D=9007199254740991,J="[object Arguments]",ee="[object Array]",ce="[object AsyncFunction]",Y="[object Boolean]",ze="[object Date]",Xe="[object Error]",be="[object Function]",Se="[object GeneratorFunction]",mt="[object Map]",Le="[object Number]",St="[object Null]",Ye="[object Object]",dt="[object Proxy]",Je="[object RegExp]",wt="[object Set]",At="[object String]",Ie="[object Undefined]",Ne="[object WeakMap]",Ve="[object ArrayBuffer]",ct="[object DataView]",Me="[object Float32Array]",ht="[object Float64Array]",Wt="[object Int8Array]",Qt="[object Int16Array]",ur="[object Int32Array]",oe="[object Uint8Array]",$="[object Uint8ClampedArray]",H="[object Uint16Array]",Ae="[object Uint32Array]",ye=/[\\^$.*+?()[\]{}|]/g,Te=/^\[object .+?Constructor\]$/,pe=/^(?:0|[1-9]\d*)$/,it={};it[Me]=it[ht]=it[Wt]=it[Qt]=it[ur]=it[oe]=it[$]=it[H]=it[Ae]=!0,it[J]=it[ee]=it[Ve]=it[Y]=it[ct]=it[ze]=it[Xe]=it[be]=it[mt]=it[Le]=it[Ye]=it[Je]=it[wt]=it[At]=it[Ne]=!1;var qt=typeof E=="object"&&E&&E.Object===Object&&E,Pt=typeof self=="object"&&self&&self.Object===Object&&self,me=qt||Pt||Function("return this")(),ve=g&&!g.nodeType&&g,Ge=ve&&typeof p=="object"&&p&&!p.nodeType&&p,st=Ge&&Ge.exports===ve,Oe=st&&qt.process,gt=function(){try{var It=Ge&&Ge.require&&Ge.require("util").types;return It||Oe&&Oe.binding&&Oe.binding("util")}catch(fr){}}(),C=gt&&gt.isTypedArray;function R(It,fr,Pr){switch(Pr.length){case 0:return It.call(fr);case 1:return It.call(fr,Pr[0]);case 2:return It.call(fr,Pr[0],Pr[1]);case 3:return It.call(fr,Pr[0],Pr[1],Pr[2])}return It.apply(fr,Pr)}function q(It,fr){for(var Pr=-1,Wn=Array(It);++Pr<It;)Wn[Pr]=fr(Pr);return Wn}function fe(It){return function(fr){return It(fr)}}function He(It,fr){return It==null?void 0:It[fr]}function et(It,fr){return function(Pr){return It(fr(Pr))}}var _t=Array.prototype,ot=Function.prototype,Ut=Object.prototype,K=me["__core-js_shared__"],qe=ot.toString,ae=Ut.hasOwnProperty,tt=function(){var It=/[^.]+$/.exec(K&&K.keys&&K.keys.IE_PROTO||"");return It?"Symbol(src)_1."+It:""}(),kt=Ut.toString,pr=qe.call(Object),Ke=RegExp("^"+qe.call(ae).replace(ye,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),xt=st?me.Buffer:void 0,bt=me.Symbol,Et=me.Uint8Array,Fe=xt?xt.allocUnsafe:void 0,pt=et(Object.getPrototypeOf,Object),yt=Object.create,Ht=Ut.propertyIsEnumerable,hr=_t.splice,Zr=bt?bt.toStringTag:void 0,yr=function(){try{var It=bu(Object,"defineProperty");return It({},"",{}),It}catch(fr){}}(),Vn=xt?xt.isBuffer:void 0,zn=Math.max,oa=Date.now,$n=bu(me,"Map"),Kn=bu(Object,"create"),Cn=function(){function It(){}return function(fr){if(!_o(fr))return{};if(yt)return yt(fr);It.prototype=fr;var Pr=new It;return It.prototype=void 0,Pr}}();function z(It){var fr=-1,Pr=It==null?0:It.length;for(this.clear();++fr<Pr;){var Wn=It[fr];this.set(Wn[0],Wn[1])}}function W(){this.__data__=Kn?Kn(null):{},this.size=0}function le(It){var fr=this.has(It)&&delete this.__data__[It];return this.size-=fr?1:0,fr}function xe(It){var fr=this.__data__;if(Kn){var Pr=fr[It];return Pr===F?void 0:Pr}return ae.call(fr,It)?fr[It]:void 0}function ut(It){var fr=this.__data__;return Kn?fr[It]!==void 0:ae.call(fr,It)}function Ot(It,fr){var Pr=this.__data__;return this.size+=this.has(It)?0:1,Pr[It]=Kn&&fr===void 0?F:fr,this}z.prototype.clear=W,z.prototype.delete=le,z.prototype.get=xe,z.prototype.has=ut,z.prototype.set=Ot;function Bt(It){var fr=-1,Pr=It==null?0:It.length;for(this.clear();++fr<Pr;){var Wn=It[fr];this.set(Wn[0],Wn[1])}}function Ze(){this.__data__=[],this.size=0}function Rt(It){var fr=this.__data__,Pr=Wi(fr,It);if(Pr<0)return!1;var Wn=fr.length-1;return Pr==Wn?fr.pop():hr.call(fr,Pr,1),--this.size,!0}function lr(It){var fr=this.__data__,Pr=Wi(fr,It);return Pr<0?void 0:fr[Pr][1]}function Ur(It){return Wi(this.__data__,It)>-1}function Gr(It,fr){var Pr=this.__data__,Wn=Wi(Pr,It);return Wn<0?(++this.size,Pr.push([It,fr])):Pr[Wn][1]=fr,this}Bt.prototype.clear=Ze,Bt.prototype.delete=Rt,Bt.prototype.get=lr,Bt.prototype.has=Ur,Bt.prototype.set=Gr;function cr(It){var fr=-1,Pr=It==null?0:It.length;for(this.clear();++fr<Pr;){var Wn=It[fr];this.set(Wn[0],Wn[1])}}function Br(){this.size=0,this.__data__={hash:new z,map:new($n||Bt),string:new z}}function wn(It){var fr=so(this,It).delete(It);return this.size-=fr?1:0,fr}function fn(It){return so(this,It).get(It)}function tr(It){return so(this,It).has(It)}function rn(It,fr){var Pr=so(this,It),Wn=Pr.size;return Pr.set(It,fr),this.size+=Pr.size==Wn?0:1,this}cr.prototype.clear=Br,cr.prototype.delete=wn,cr.prototype.get=fn,cr.prototype.has=tr,cr.prototype.set=rn;function dn(It){var fr=this.__data__=new Bt(It);this.size=fr.size}function En(){this.__data__=new Bt,this.size=0}function bn(It){var fr=this.__data__,Pr=fr.delete(It);return this.size=fr.size,Pr}function gn(It){return this.__data__.get(It)}function Mn(It){return this.__data__.has(It)}function Ga(It,fr){var Pr=this.__data__;if(Pr instanceof Bt){var Wn=Pr.__data__;if(!$n||Wn.length<X-1)return Wn.push([It,fr]),this.size=++Pr.size,this;Pr=this.__data__=new cr(Wn)}return Pr.set(It,fr),this.size=Pr.size,this}dn.prototype.clear=En,dn.prototype.delete=bn,dn.prototype.get=gn,dn.prototype.has=Mn,dn.prototype.set=Ga;function ga(It,fr){var Pr=Ol(It),Wn=!Pr&&Nu(It),Ya=!Pr&&!Wn&&xu(It),xi=!Pr&&!Wn&&!Ya&&Ks(It),Ki=Pr||Wn||Ya||xi,Ka=Ki?q(It.length,String):[],Di=Ka.length;for(var Yo in It)(fr||ae.call(It,Yo))&&!(Ki&&(Yo=="length"||Ya&&(Yo=="offset"||Yo=="parent")||xi&&(Yo=="buffer"||Yo=="byteLength"||Yo=="byteOffset")||js(Yo,Di)))&&Ka.push(Yo);return Ka}function Ma(It,fr,Pr){(Pr!==void 0&&!Mo(It[fr],Pr)||Pr===void 0&&!(fr in It))&&da(It,fr,Pr)}function Ia(It,fr,Pr){var Wn=It[fr];(!(ae.call(It,fr)&&Mo(Wn,Pr))||Pr===void 0&&!(fr in It))&&da(It,fr,Pr)}function Wi(It,fr){for(var Pr=It.length;Pr--;)if(Mo(It[Pr][0],fr))return Pr;return-1}function da(It,fr,Pr){fr=="__proto__"&&yr?yr(It,fr,{configurable:!0,enumerable:!0,value:Pr,writable:!0}):It[fr]=Pr}var vi=oo();function ya(It){return It==null?It===void 0?Ie:St:Zr&&Zr in Object(It)?Qo(It):en(It)}function ba(It){return zi(It)&&ya(It)==J}function ha(It){if(!_o(It)||Re(It))return!1;var fr=Po(It)?Ke:Te;return fr.test(mo(It))}function wi(It){return zi(It)&&ku(It.length)&&!!it[ya(It)]}function is(It){if(!_o(It))return vr(It);var fr=Dt(It),Pr=[];for(var Wn in It)Wn=="constructor"&&(fr||!ae.call(It,Wn))||Pr.push(Wn);return Pr}function Xi(It,fr,Pr,Wn,Ya){if(It===fr)return;vi(fr,function(xi,Ki){if(Ya||(Ya=new dn),_o(xi))Xo(It,fr,Ki,Pr,Xi,Wn,Ya);else{var Ka=Wn?Wn(Gn(It,Ki),xi,Ki+"",It,fr,Ya):void 0;Ka===void 0&&(Ka=xi),Ma(It,Ki,Ka)}},Ii)}function Xo(It,fr,Pr,Wn,Ya,xi,Ki){var Ka=Gn(It,Pr),Di=Gn(fr,Pr),Yo=Ki.get(Di);if(Yo){Ma(It,Pr,Yo);return}var Ps=xi?xi(Ka,Di,Pr+"",It,fr,Ki):void 0,gi=Ps===void 0;if(gi){var Ml=Ol(Di),$s=!Ml&&xu(Di),Ss=!Ml&&!$s&&Ks(Di);Ps=Di,Ml||$s||Ss?Ol(Ka)?Ps=Ka:pc(Ka)?Ps=Yi(Ka):$s?(gi=!1,Ps=Oi(Di,!0)):Ss?(gi=!1,Ps=ui(Di,!0)):Ps=[]:Ys(Di)||Nu(Di)?(Ps=Ka,Nu(Ka)?Ps=Fs(Ka):(!_o(Ka)||Po(Ka))&&(Ps=Xl(Di))):gi=!1}gi&&(Ki.set(Di,Ps),Ya(Ps,Di,Wn,xi,Ki),Ki.delete(Di)),Ma(It,Pr,Ps)}function Du(It,fr){return Mi(Tn(It,fr,ml),It+"")}var Ha=yr?function(It,fr){return yr(It,"toString",{configurable:!0,enumerable:!1,value:_s(fr),writable:!0})}:ml;function Oi(It,fr){if(fr)return It.slice();var Pr=It.length,Wn=Fe?Fe(Pr):new It.constructor(Pr);return It.copy(Wn),Wn}function Jo(It){var fr=new It.constructor(It.byteLength);return new Et(fr).set(new Et(It)),fr}function ui(It,fr){var Pr=fr?Jo(It.buffer):It.buffer;return new It.constructor(Pr,It.byteOffset,It.length)}function Yi(It,fr){var Pr=-1,Wn=It.length;for(fr||(fr=Array(Wn));++Pr<Wn;)fr[Pr]=It[Pr];return fr}function Oo(It,fr,Pr,Wn){var Ya=!Pr;Pr||(Pr={});for(var xi=-1,Ki=fr.length;++xi<Ki;){var Ka=fr[xi],Di=Wn?Wn(Pr[Ka],It[Ka],Ka,Pr,It):void 0;Di===void 0&&(Di=It[Ka]),Ya?da(Pr,Ka,Di):Ia(Pr,Ka,Di)}return Pr}function Za(It){return Du(function(fr,Pr){var Wn=-1,Ya=Pr.length,xi=Ya>1?Pr[Ya-1]:void 0,Ki=Ya>2?Pr[2]:void 0;for(xi=It.length>3&&typeof xi=="function"?(Ya--,xi):void 0,Ki&&ho(Pr[0],Pr[1],Ki)&&(xi=Ya<3?void 0:xi,Ya=1),fr=Object(fr);++Wn<Ya;){var Ka=Pr[Wn];Ka&&It(fr,Ka,Wn,xi)}return fr})}function oo(It){return function(fr,Pr,Wn){for(var Ya=-1,xi=Object(fr),Ki=Wn(fr),Ka=Ki.length;Ka--;){var Di=Ki[It?Ka:++Ya];if(Pr(xi[Di],Di,xi)===!1)break}return fr}}function so(It,fr){var Pr=It.__data__;return Vt(fr)?Pr[typeof fr=="string"?"string":"hash"]:Pr.map}function bu(It,fr){var Pr=He(It,fr);return ha(Pr)?Pr:void 0}function Qo(It){var fr=ae.call(It,Zr),Pr=It[Zr];try{It[Zr]=void 0;var Wn=!0}catch(xi){}var Ya=kt.call(It);return Wn&&(fr?It[Zr]=Pr:delete It[Zr]),Ya}function Xl(It){return typeof It.constructor=="function"&&!Dt(It)?Cn(pt(It)):{}}function js(It,fr){var Pr=typeof It;return fr=fr==null?D:fr,!!fr&&(Pr=="number"||Pr!="symbol"&&pe.test(It))&&It>-1&&It%1==0&&It<fr}function ho(It,fr,Pr){if(!_o(Pr))return!1;var Wn=typeof fr;return(Wn=="number"?Ts(Pr)&&js(fr,Pr.length):Wn=="string"&&fr in Pr)?Mo(Pr[fr],It):!1}function Vt(It){var fr=typeof It;return fr=="string"||fr=="number"||fr=="symbol"||fr=="boolean"?It!=="__proto__":It===null}function Re(It){return!!tt&&tt in It}function Dt(It){var fr=It&&It.constructor,Pr=typeof fr=="function"&&fr.prototype||Ut;return It===Pr}function vr(It){var fr=[];if(It!=null)for(var Pr in Object(It))fr.push(Pr);return fr}function en(It){return kt.call(It)}function Tn(It,fr,Pr){return fr=zn(fr===void 0?It.length-1:fr,0),function(){for(var Wn=arguments,Ya=-1,xi=zn(Wn.length-fr,0),Ki=Array(xi);++Ya<xi;)Ki[Ya]=Wn[fr+Ya];Ya=-1;for(var Ka=Array(fr+1);++Ya<fr;)Ka[Ya]=Wn[Ya];return Ka[fr]=Pr(Ki),R(It,this,Ka)}}function Gn(It,fr){return fr==="constructor"&&typeof It[fr]=="function"||fr=="__proto__"?void 0:It[fr]}var Mi=po(Ha);function po(It){var fr=0,Pr=0;return function(){var Wn=oa(),Ya=Z-(Wn-Pr);if(Pr=Wn,Ya>0){if(++fr>=i)return arguments[0]}else fr=0;return It.apply(void 0,arguments)}}function mo(It){if(It!=null){try{return qe.call(It)}catch(fr){}try{return It+""}catch(fr){}}return""}function Mo(It,fr){return It===fr||It!==It&&fr!==fr}var Nu=ba(function(){return arguments}())?ba:function(It){return zi(It)&&ae.call(It,"callee")&&!Ht.call(It,"callee")},Ol=Array.isArray;function Ts(It){return It!=null&&ku(It.length)&&!Po(It)}function pc(It){return zi(It)&&Ts(It)}var xu=Vn||$u;function Po(It){if(!_o(It))return!1;var fr=ya(It);return fr==be||fr==Se||fr==ce||fr==dt}function ku(It){return typeof It=="number"&&It>-1&&It%1==0&&It<=D}function _o(It){var fr=typeof It;return It!=null&&(fr=="object"||fr=="function")}function zi(It){return It!=null&&typeof It=="object"}function Ys(It){if(!zi(It)||ya(It)!=Ye)return!1;var fr=pt(It);if(fr===null)return!0;var Pr=ae.call(fr,"constructor")&&fr.constructor;return typeof Pr=="function"&&Pr instanceof Pr&&qe.call(Pr)==pr}var Ks=C?fe(C):wi;function Fs(It){return Oo(It,Ii(It))}function Ii(It){return Ts(It)?ga(It,!0):is(It)}var Gi=Za(function(It,fr,Pr,Wn){Xi(It,fr,Pr,Wn)});function _s(It){return function(){return It}}function ml(It){return It}function $u(){return!1}p.exports=Gi}).call(this,o("yLpj"),o("YuTi")(Ue))},quyA:function(Ue,g){var o="\\ud800-\\udfff",E="\\u0300-\\u036f",p="\\ufe20-\\ufe2f",X="\\u20d0-\\u20ff",F=E+p+X,i="\\ufe0e\\ufe0f",Z="\\u200d",D=RegExp("["+Z+o+F+i+"]");function J(ee){return D.test(ee)}Ue.exports=J},qxNg:function(Ue,g,o){"use strict";o.d(g,"a",function(){return D});var E=o("lSNA"),p=o.n(E),X=o("mpbz"),F=o.n(X);function i(ee,ce){var Y=Object.keys(ee);if(Object.getOwnPropertySymbols){var ze=Object.getOwnPropertySymbols(ee);ce&&(ze=ze.filter(function(Xe){return Object.getOwnPropertyDescriptor(ee,Xe).enumerable})),Y.push.apply(Y,ze)}return Y}function Z(ee){for(var ce=1;ce<arguments.length;ce++){var Y=arguments[ce]!=null?arguments[ce]:{};ce%2?i(Object(Y),!0).forEach(function(ze){p()(ee,ze,Y[ze])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ee,Object.getOwnPropertyDescriptors(Y)):i(Object(Y)).forEach(function(ze){Object.defineProperty(ee,ze,Object.getOwnPropertyDescriptor(Y,ze))})}return ee}function D(ee,ce){var Y=ce.radius,ze=Y===void 0?40:Y,Xe=ce.maxZoom,be=Xe===void 0?18:Xe,Se=ce.minZoom,mt=Se===void 0?0:Se,Le=ce.zoom,St=Le===void 0?2:Le;if(ee.pointIndex){var Ye=ee.pointIndex.getClusters(ee.extent,Math.floor(St));return ee.dataArray=J(Ye),ee}var dt=new F.a({radius:ze,minZoom:mt,maxZoom:be}),Je={type:"FeatureCollection",features:[]};return Je.features=ee.dataArray.map(function(wt){return{type:"Feature",geometry:{type:"Point",coordinates:wt.coordinates},properties:Z({},wt)}}),dt.load(Je.features),dt}function J(ee){return ee.map(function(ce,Y){return Z({coordinates:ce.geometry.coordinates,_id:Y+1},ce.properties)})}},riiI:function(Ue,g){},rlAn:function(Ue,g,o){"use strict";var E=o("ISu3"),p=o("gMG2"),X=o("5gLl"),F=o("BpBL"),i=o("5zYK"),Z=o("lJbI"),D=o("l94r"),J=o("qxNg"),ee=o("Y8BV"),ce=o("VIsB"),Y=o("+VLl"),ze=o("aF1E"),Xe=o("fdMe");o.d(g,"getTransform",function(){return E.b}),o.d(g,"getParser",function(){return E.a});var be=o("U1ZX"),Se=o.n(be);g.default=D.a,Object(E.c)("geojson",X.a),Object(E.c)("image",F.a),Object(E.c)("csv",p.a),Object(E.c)("json",i.a),Object(E.c)("raster",Z.a),Object(E.d)("cluster",J.a),Object(E.d)("filter",ee.a),Object(E.d)("join",ze.a),Object(E.d)("map",Xe.a),Object(E.d)("grid",ce.a),Object(E.d)("hexagon",Y.a)},rxlC:function(Ue,g,o){"use strict";Ue.exports=p,Ue.exports.default=p;var E=1e20;function p(i,Z,D,J,ee,ce){this.fontSize=i||24,this.buffer=Z===void 0?3:Z,this.cutoff=J||.25,this.fontFamily=ee||"sans-serif",this.fontWeight=ce||"normal",this.radius=D||8;var Y=this.size=this.fontSize+this.buffer*2;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=Y,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(Y*Y),this.gridInner=new Float64Array(Y*Y),this.f=new Float64Array(Y),this.d=new Float64Array(Y),this.z=new Float64Array(Y+1),this.v=new Int16Array(Y),this.middle=Math.round(Y/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}p.prototype.draw=function(i){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(i,this.buffer,this.middle);for(var Z=this.ctx.getImageData(0,0,this.size,this.size),D=new Uint8ClampedArray(this.size*this.size),J=0;J<this.size*this.size;J++){var ee=Z.data[J*4+3]/255;this.gridOuter[J]=ee===1?0:ee===0?E:Math.pow(Math.max(0,.5-ee),2),this.gridInner[J]=ee===1?E:ee===0?0:Math.pow(Math.max(0,ee-.5),2)}for(X(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),X(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),J=0;J<this.size*this.size;J++){var ce=this.gridOuter[J]-this.gridInner[J];D[J]=Math.max(0,Math.min(255,Math.round(255-255*(ce/this.radius+this.cutoff))))}return D};function X(i,Z,D,J,ee,ce,Y){for(var ze=0;ze<Z;ze++){for(var Xe=0;Xe<D;Xe++)J[Xe]=i[Xe*Z+ze];for(F(J,ee,ce,Y,D),Xe=0;Xe<D;Xe++)i[Xe*Z+ze]=ee[Xe]}for(Xe=0;Xe<D;Xe++){for(ze=0;ze<Z;ze++)J[ze]=i[Xe*Z+ze];for(F(J,ee,ce,Y,Z),ze=0;ze<Z;ze++)i[Xe*Z+ze]=Math.sqrt(ee[ze])}}function F(i,Z,D,J,ee){D[0]=0,J[0]=-E,J[1]=+E;for(var ce=1,Y=0;ce<ee;ce++){for(var ze=(i[ce]+ce*ce-(i[D[Y]]+D[Y]*D[Y]))/(2*ce-2*D[Y]);ze<=J[Y];)Y--,ze=(i[ce]+ce*ce-(i[D[Y]]+D[Y]*D[Y]))/(2*ce-2*D[Y]);Y++,D[Y]=ce,J[Y]=ze,J[Y+1]=+E}for(ce=0,Y=0;ce<ee;ce++){for(;J[Y+1]<ce;)Y++;Z[ce]=(ce-D[Y])*(ce-D[Y])+i[D[Y]]}}},sGsY:function(Ue,g,o){"use strict";var E=o("lSNA"),p=o.n(E),X=o("pVnL"),F=o.n(X),i=o("q1tI"),Z=o("TSYQ"),D=o.n(Z),J=o("H84U"),ee=o("/ezw"),ce=o("B6l+"),Y=o.n(ce),ze=function(pe){var it=pe.value,qt=pe.formatter,Pt=pe.precision,me=pe.decimalSeparator,ve=pe.groupSeparator,Ge=ve===void 0?"":ve,st=pe.prefixCls,Oe;if(typeof qt=="function")Oe=qt(it);else{var gt=String(it),C=gt.match(/^(-?)(\d*)(\.(\d+))?$/);if(!C||gt==="-")Oe=gt;else{var R=C[1],q=C[2]||"0",fe=C[4]||"";q=q.replace(/\B(?=(\d{3})+(?!\d))/g,Ge),typeof Pt=="number"&&(fe=Y()(fe,Pt,"0").slice(0,Pt)),fe&&(fe="".concat(me).concat(fe)),Oe=[i.createElement("span",{key:"int",className:"".concat(st,"-content-value-int")},R,q),fe&&i.createElement("span",{key:"decimal",className:"".concat(st,"-content-value-decimal")},fe)]}}return i.createElement("span",{className:"".concat(st,"-content-value")},Oe)},Xe=ze,be=function(pe){var it=pe.prefixCls,qt=pe.className,Pt=pe.style,me=pe.valueStyle,ve=pe.value,Ge=ve===void 0?0:ve,st=pe.title,Oe=pe.valueRender,gt=pe.prefix,C=pe.suffix,R=pe.loading,q=pe.direction,fe=pe.onMouseEnter,He=pe.onMouseLeave,et=i.createElement(Xe,F()({},pe,{value:Ge})),_t=D()(it,p()({},"".concat(it,"-rtl"),q==="rtl"),qt);return i.createElement("div",{className:_t,style:Pt,onMouseEnter:fe,onMouseLeave:He},st&&i.createElement("div",{className:"".concat(it,"-title")},st),i.createElement(ee.a,{paragraph:!1,loading:R},i.createElement("div",{style:me,className:"".concat(it,"-content")},gt&&i.createElement("span",{className:"".concat(it,"-content-prefix")},gt),Oe?Oe(et):et,C&&i.createElement("span",{className:"".concat(it,"-content-suffix")},C))))};be.defaultProps={decimalSeparator:".",groupSeparator:",",loading:!1};var Se=Object(J.c)({prefixCls:"statistic"})(be),mt=Se,Le=o("lwsE"),St=o.n(Le),Ye=o("W8MJ"),dt=o.n(Ye),Je=o("7W2i"),wt=o.n(Je),At=o("LQ03"),Ie=o.n(At),Ne=o("J4zp"),Ve=o.n(Ne),ct=o("QQZ/"),Me=o.n(ct),ht=[["Y",1e3*60*60*24*365],["M",1e3*60*60*24*30],["D",1e3*60*60*24],["H",1e3*60*60],["m",1e3*60],["s",1e3],["S",1]];function Wt(Te,pe){var it=Te,qt=/\[[^\]]*]/g,Pt=(pe.match(qt)||[]).map(function(st){return st.slice(1,-1)}),me=pe.replace(qt,"[]"),ve=ht.reduce(function(st,Oe){var gt=Ve()(Oe,2),C=gt[0],R=gt[1];if(st.indexOf(C)!==-1){var q=Math.floor(it/R);return it-=q*R,st.replace(new RegExp("".concat(C,"+"),"g"),function(fe){var He=fe.length;return Me()(q.toString(),He,"0")})}return st},me),Ge=0;return ve.replace(qt,function(){var st=Pt[Ge];return Ge+=1,st})}function Qt(Te,pe){var it=pe.format,qt=it===void 0?"":it,Pt=new Date(Te).getTime(),me=Date.now(),ve=Math.max(Pt-me,0);return Wt(ve,qt)}var ur=o("0n0R"),oe=1e3/30;function $(Te){return new Date(Te).getTime()}var H=function(Te){wt()(it,Te);var pe=Ie()(it);function it(){var qt;return St()(this,it),qt=pe.apply(this,arguments),qt.syncTimer=function(){var Pt=qt.props.value,me=$(Pt);me>=Date.now()?qt.startTimer():qt.stopTimer()},qt.startTimer=function(){if(qt.countdownId)return;qt.countdownId=window.setInterval(function(){qt.forceUpdate()},oe)},qt.stopTimer=function(){var Pt=qt.props,me=Pt.onFinish,ve=Pt.value;if(qt.countdownId){clearInterval(qt.countdownId),qt.countdownId=void 0;var Ge=$(ve);me&&Ge<Date.now()&&me()}},qt.formatCountdown=function(Pt,me){var ve=qt.props.format;return Qt(Pt,F()(F()({},me),{format:ve}))},qt.valueRender=function(Pt){return Object(ur.a)(Pt,{title:void 0})},qt}return dt()(it,[{key:"componentDidMount",value:function(){this.syncTimer()}},{key:"componentDidUpdate",value:function(){this.syncTimer()}},{key:"componentWillUnmount",value:function(){this.stopTimer()}},{key:"render",value:function(){return i.createElement(mt,F()({valueRender:this.valueRender},this.props,{formatter:this.formatCountdown}))}}]),it}(i.Component);H.defaultProps={format:"HH:mm:ss"};var Ae=H;mt.Countdown=Ae;var ye=g.a=mt},sKgW:function(Ue,g){var o=9007199254740991,E=Math.floor;function p(X,F){var i="";if(!X||F<1||F>o)return i;do F%2&&(i+=X),F=E(F/2),F&&(X+=X);while(F);return i}Ue.exports=p},sXyB:function(Ue,g,o){var E=o("SksO"),p=o("b48C");function X(F,i,Z){return p()?Ue.exports=X=Reflect.construct:Ue.exports=X=function(J,ee,ce){var Y=[null];Y.push.apply(Y,ee);var ze=Function.bind.apply(J,Y),Xe=new ze;return ce&&E(Xe,ce.prototype),Xe},X.apply(null,arguments)}Ue.exports=X},sgoq:function(Ue,g,o){var E=o("asDA"),p=o("TKrE"),X=o("6nK8"),F="['\u2019]",i=RegExp(F,"g");function Z(D){return function(J){return E(X(p(J).replace(i,"")),D,"")}}Ue.exports=Z},sxDa:function(Ue,g,o){"use strict";o.d(g,"e",function(){return ol}),o.d(g,"f",function(){return ro}),o.d(g,"d",function(){return Rc}),o.d(g,"a",function(){return so}),o.d(g,"c",function(){return Di}),o.d(g,"g",function(){return jc}),o.d(g,"b",function(){return ml});var E=o("h1nZ"),p=o("lwsE"),X=o.n(p),F=o("W8MJ"),i=o.n(F),Z=o("7W2i"),D=o.n(Z),J=o("a1gu"),ee=o.n(J),ce=o("Nsbk"),Y=o.n(ce),ze=o("QILm"),Xe=o.n(ze),be=o("lSNA"),Se=o.n(be),mt=o("yG8O"),Le=o.n(mt),St=o("PJYZ"),Ye=o.n(St),dt=o("U+yc"),Je=o.n(dt),wt=o("1ABj"),At=o("GoyQ"),Ie=o.n(At),Ne=o("lSCD"),Ve=o.n(Ne),ct=o("xp6e"),Me=o("Hel2"),ht=o("uhBA"),Wt=o("4U9+"),Qt=o.n(Wt),ur=o("4cb6"),oe,$,H,Ae,ye,Te;function pe(h){return h.map(function(_){return typeof _=="string"&&(_=[_,{}]),_})}var it=(oe=Object(ur.injectable)(),$=Object(ur.inject)(E.TYPES.IGlobalConfigService),oe(H=(Ae=(Te=function(){function h(){X()(this,h),Le()(this,"configService",ye,this),this.enabled=void 0}return i()(h,[{key:"apply",value:function(T,x){var A=this,M=x.rendererService,U=x.postProcessingPassFactory,ie=x.normalPassFactory;T.hooks.init.tap("MultiPassRendererPlugin",function(){var de=T.getLayerConfig(),Be=de.enableMultiPassRenderer,zt=de.passes,er=zt===void 0?[]:zt;A.enabled=!!Be&&T.getLayerConfig().enableMultiPassRenderer!==!1,A.enabled&&(T.multiPassRenderer=A.createMultiPassRenderer(T,er,U,ie),T.multiPassRenderer.setRenderFlag(!0))}),T.hooks.beforeRender.tap("MultiPassRendererPlugin",function(){})}},{key:"createMultiPassRenderer",value:function(T,x,A,M){var U=T.multiPassRenderer,ie=T.getLayerConfig(),de=ie.enablePicking,Be=ie.enableTAA;return de&&U.add(M("pixelPicking")),U}}]),h}(),Te),ye=Je()(Ae.prototype,"configService",[$],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ae))||H),qt,Pt=(qt={},Se()(qt,E.BlendType.additive,{enable:!0,func:{srcRGB:E.gl.ONE,dstRGB:E.gl.ONE,srcAlpha:1,dstAlpha:1}}),Se()(qt,E.BlendType.none,{enable:!1}),Se()(qt,E.BlendType.normal,{enable:!0,func:{srcRGB:E.gl.SRC_ALPHA,dstRGB:E.gl.ONE_MINUS_SRC_ALPHA,srcAlpha:1,dstAlpha:1}}),Se()(qt,E.BlendType.subtractive,{enable:!0,func:{srcRGB:E.gl.ONE,dstRGB:E.gl.ONE,srcAlpha:E.gl.ZERO,dstAlpha:E.gl.ONE_MINUS_SRC_COLOR},equation:{rgb:E.gl.FUNC_SUBTRACT,alpha:E.gl.FUNC_SUBTRACT}}),Se()(qt,E.BlendType.max,{enable:!0,func:{srcRGB:E.gl.ONE,dstRGB:E.gl.ONE},equation:{rgb:E.gl.MAX_EXT}}),Se()(qt,E.BlendType.min,{enable:!0,func:{srcRGB:E.gl.ONE,dstRGB:E.gl.ONE},equation:{rgb:E.gl.MIN_EXT}}),qt),me={properties:{enablePicking:{type:"boolean"},enableHighlight:{type:"boolean"},highlightColor:{oneOf:[{type:"array",items:{type:"number",minimum:0,maximum:1}},{type:"string"}]}}},ve,Ge,st,Oe,gt,C,R,q;function fe(h,_){var T;if(typeof Symbol=="undefined"||h[Symbol.iterator]==null){if(Array.isArray(h)||(T=He(h))||_&&h&&typeof h.length=="number"){T&&(h=T);var x=0,A=function(){};return{s:A,n:function(){return x>=h.length?{done:!0}:{done:!1,value:h[x++]}},e:function(Be){throw Be},f:A}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var M=!0,U=!1,ie;return{s:function(){T=h[Symbol.iterator]()},n:function(){var Be=T.next();return M=Be.done,Be},e:function(Be){U=!0,ie=Be},f:function(){try{!M&&T.return!=null&&T.return()}finally{if(U)throw ie}}}}function He(h,_){if(!h)return;if(typeof h=="string")return et(h,_);var T=Object.prototype.toString.call(h).slice(8,-1);if(T==="Object"&&h.constructor&&(T=h.constructor.name),T==="Map"||T==="Set")return Array.from(h);if(T==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(T))return et(h,_)}function et(h,_){(_==null||_>h.length)&&(_=h.length);for(var T=0,x=new Array(_);T<_;T++)x[T]=h[T];return x}function _t(h,_){var T=Object.keys(h);if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(h);_&&(x=x.filter(function(A){return Object.getOwnPropertyDescriptor(h,A).enumerable})),T.push.apply(T,x)}return T}function ot(h){for(var _=1;_<arguments.length;_++){var T=arguments[_]!=null?arguments[_]:{};_%2?_t(Object(T),!0).forEach(function(x){Se()(h,x,T[x])}):Object.getOwnPropertyDescriptors?Object.defineProperties(h,Object.getOwnPropertyDescriptors(T)):_t(Object(T)).forEach(function(x){Object.defineProperty(h,x,Object.getOwnPropertyDescriptor(T,x))})}return h}function Ut(h){var _=K();return function(){var x=Y()(h),A;if(_){var M=Y()(this).constructor;A=Reflect.construct(x,arguments,M)}else A=x.apply(this,arguments);return ee()(this,A)}}function K(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var qe=0,ae=(ve=Object(E.lazyInject)(E.TYPES.ILogService),Ge=Object(E.lazyInject)(E.TYPES.IGlobalConfigService),st=Object(E.lazyInject)(E.TYPES.IShaderModuleService),Oe=(q=function(h){D()(T,h);var _=Ut(T);function T(){var x,A=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return X()(this,T),x=_.call(this),x.id="".concat(qe++),x.name="".concat(qe),x.type=void 0,x.visible=!0,x.zIndex=0,x.minZoom=void 0,x.maxZoom=void 0,x.inited=!1,x.layerModelNeedUpdate=!1,x.pickedFeatureID=null,x.selectedFeatureID=null,x.styleNeedUpdate=!1,x.dataState={dataSourceNeedUpdate:!1,dataMappingNeedUpdate:!1,filterNeedUpdate:!1,featureScaleNeedUpdate:!1,StyleAttrNeedUpdate:!1},x.hooks={init:new ct.b,afterInit:new ct.b,beforeRender:new ct.b,beforeRenderData:new ct.d,afterRender:new ct.c,beforePickingEncode:new ct.c,afterPickingEncode:new ct.c,beforeHighlight:new ct.c(["pickedColor"]),afterHighlight:new ct.c,beforeSelect:new ct.c(["pickedColor"]),afterSelect:new ct.c,beforeDestroy:new ct.c,afterDestroy:new ct.c},x.models=[],x.multiPassRenderer=void 0,x.plugins=void 0,x.sourceOption=void 0,x.layerModel=void 0,Le()(x,"logger",gt,Ye()(x)),Le()(x,"configService",C,Ye()(x)),Le()(x,"shaderModuleService",R,Ye()(x)),x.cameraService=void 0,x.coordinateService=void 0,x.iconService=void 0,x.fontService=void 0,x.rendererService=void 0,x.layerService=void 0,x.interactionService=void 0,x.mapService=void 0,x.styleAttributeService=void 0,x.layerSource=void 0,x.postProcessingPassFactory=void 0,x.normalPassFactory=void 0,x.animateOptions={enable:!1},x.container=void 0,x.encodedData=void 0,x.configSchema=void 0,x.currentPickId=null,x.rawConfig=void 0,x.needUpdateConfig=void 0,x.pendingStyleAttributes=[],x.scaleOptions={},x.animateStartTime=void 0,x.aniamateStatus=!1,x.sourceEvent=function(){x.dataState.dataSourceNeedUpdate=!0;var M=x.getLayerConfig(),U=M.autoFit,ie=M.fitBoundsOptions;U&&x.fitBounds(ie),x.emit("dataUpdate"),x.reRender()},x.name=A.name||x.id,x.zIndex=A.zIndex||0,x.rawConfig=A,x}return i()(T,[{key:"getLayerConfig",value:function(){return this.configService.getLayerConfig(this.id)}},{key:"updateLayerConfig",value:function(A){if(!this.inited)this.needUpdateConfig=ot(ot({},this.needUpdateConfig),A);else{var M=this.container.get(E.TYPES.SceneID);this.configService.setLayerConfig(M,this.id,ot(ot(ot({},this.configService.getLayerConfig(this.id)),this.needUpdateConfig),A)),this.needUpdateConfig={}}}},{key:"setContainer",value:function(A){this.container=A}},{key:"getContainer",value:function(){return this.container}},{key:"addPlugin",value:function(A){return this.plugins.push(A),this}},{key:"init",value:function(){var A=this,M=this.container.get(E.TYPES.SceneID),U=this.rawConfig.enableMultiPassRenderer,ie=U===void 0?!1:U;this.configService.setLayerConfig(M,this.id,{enableMultiPassRenderer:ie}),this.iconService=this.container.get(E.TYPES.IIconService),this.fontService=this.container.get(E.TYPES.IFontService),this.rendererService=this.container.get(E.TYPES.IRendererService),this.layerService=this.container.get(E.TYPES.ILayerService),this.interactionService=this.container.get(E.TYPES.IInteractionService),this.mapService=this.container.get(E.TYPES.IMapService),this.cameraService=this.container.get(E.TYPES.ICameraService),this.coordinateService=this.container.get(E.TYPES.ICoordinateSystemService),this.postProcessingPassFactory=this.container.get(E.TYPES.IFactoryPostProcessingPass),this.normalPassFactory=this.container.get(E.TYPES.IFactoryNormalPass),this.styleAttributeService=this.container.get(E.TYPES.IStyleAttributeService),this.multiPassRenderer=this.container.get(E.TYPES.IMultiPassRenderer),this.multiPassRenderer.setLayer(this),this.pendingStyleAttributes.forEach(function(er){var Mr=er.attributeName,kr=er.attributeField,xn=er.attributeValues,yn=er.updateOptions;A.styleAttributeService.updateStyleAttribute(Mr,{scale:ot({field:kr},A.splitValuesAndCallbackInAttribute(xn,A.getLayerConfig()[Mr]))},yn)}),this.pendingStyleAttributes=[],this.plugins=this.container.getAll(E.TYPES.ILayerPlugin);var de=fe(this.plugins),Be;try{for(de.s();!(Be=de.n()).done;){var zt=Be.value;zt.apply(this,{rendererService:this.rendererService,mapService:this.mapService,styleAttributeService:this.styleAttributeService,normalPassFactory:this.normalPassFactory,postProcessingPassFactory:this.postProcessingPassFactory})}}catch(er){de.e(er)}finally{de.f()}return this.hooks.init.call(),this.hooks.afterInit.call(),this.emit("inited",{target:this,type:"inited"}),this.emit("add",{target:this,type:"add"}),this}},{key:"prepareBuildModel",value:function(){this.inited=!0,this.updateLayerConfig(ot(ot({},this.getDefaultConfig()),this.rawConfig));var A=this.getLayerConfig(),M=A.animateOption;(M==null?void 0:M.enable)&&(this.layerService.startAnimate(),this.aniamateStatus=!0)}},{key:"color",value:function(A,M,U){return this.updateStyleAttribute("color",A,M,U),this}},{key:"size",value:function(A,M,U){return this.updateStyleAttribute("size",A,M,U),this}},{key:"filter",value:function(A,M,U){return this.updateStyleAttribute("filter",A,M,U),this}},{key:"shape",value:function(A,M,U){return this.updateStyleAttribute("shape",A,M,U),this}},{key:"label",value:function(A,M,U){return this.pendingStyleAttributes.push({attributeName:"label",attributeField:A,attributeValues:M,updateOptions:U}),this}},{key:"animate",value:function(A){var M={};return Ie()(A)?(M.enable=!0,M=ot(ot({},M),A)):M.enable=A,this.updateLayerConfig({animateOption:M}),this}},{key:"source",value:function(A,M){return this.sourceOption={data:A,options:M},this}},{key:"setData",value:function(A,M){var U=this;return this.inited?this.layerSource.setData(A,M):this.on("inited",function(){U.layerSource.setData(A,M)}),this}},{key:"style",value:function(A){var M=this,U=A.passes,ie=Xe()(A,["passes"]);return U&&pe(U).forEach(function(de){var Be=M.multiPassRenderer.getPostProcessor().getPostProcessingPassByName(de[0]);Be&&Be.updateOptions(de[1])}),this.rawConfig=ot(ot({},this.rawConfig),ie),this.container&&(this.updateLayerConfig(this.rawConfig),this.styleNeedUpdate=!0),this}},{key:"scale",value:function(A,M){return Ie()(A)?this.scaleOptions=ot(ot({},this.scaleOptions),A):this.scaleOptions[A]=M,this}},{key:"render",value:function(){return this.renderModels(),this}},{key:"active",value:function(A){var M={};return M.enableHighlight=Ie()(A)?!0:A,Ie()(A)?(M.enableHighlight=!0,A.color&&(M.highlightColor=A.color)):M.enableHighlight=!!A,this.updateLayerConfig(M),this}},{key:"setActive",value:function(A,M){var U=this;if(Ie()(A)){var ie=A.x,de=ie===void 0?0:ie,Be=A.y,zt=Be===void 0?0:Be;this.updateLayerConfig({highlightColor:Ie()(M)?M.color:this.getLayerConfig().highlightColor}),this.pick({x:de,y:zt})}else this.updateLayerConfig({pickedFeatureID:A,highlightColor:Ie()(M)?M.color:this.getLayerConfig().highlightColor}),this.hooks.beforeSelect.call(Object(Me.l)(A)).then(function(){setTimeout(function(){U.reRender()},1)})}},{key:"select",value:function(A){var M={};return M.enableSelect=Ie()(A)?!0:A,Ie()(A)?(M.enableSelect=!0,A.color&&(M.selectColor=A.color)):M.enableSelect=!!A,this.updateLayerConfig(M),this}},{key:"setSelect",value:function(A,M){var U=this;if(Ie()(A)){var ie=A.x,de=ie===void 0?0:ie,Be=A.y,zt=Be===void 0?0:Be;this.updateLayerConfig({selectColor:Ie()(M)?M.color:this.getLayerConfig().selectColor}),this.pick({x:de,y:zt})}else this.updateLayerConfig({pickedFeatureID:A,selectColor:Ie()(M)?M.color:this.getLayerConfig().selectColor}),this.hooks.beforeSelect.call(Object(Me.l)(A)).then(function(){setTimeout(function(){U.reRender()},1)})}},{key:"setBlend",value:function(A){this.updateLayerConfig({blend:A}),this.layerModelNeedUpdate=!0,this.reRender()}},{key:"show",value:function(){return this.updateLayerConfig({visible:!0}),this.reRender(),this}},{key:"hide",value:function(){return this.updateLayerConfig({visible:!1}),this.reRender(),this}},{key:"setIndex",value:function(A){return this.zIndex=A,this.layerService.updateRenderOrder(),this}},{key:"setCurrentPickId",value:function(A){this.currentPickId=A}},{key:"getCurrentPickId",value:function(){return this.currentPickId}},{key:"setCurrentSelectedId",value:function(A){this.selectedFeatureID=A}},{key:"getCurrentSelectedId",value:function(){return this.selectedFeatureID}},{key:"isVisible",value:function(){var A=this.mapService.getZoom(),M=this.getLayerConfig(),U=M.visible,ie=M.minZoom,de=ie===void 0?-Infinity:ie,Be=M.maxZoom,zt=Be===void 0?Infinity:Be;return!!U&&A>=de&&A<=zt}},{key:"setMinZoom",value:function(A){return this.updateLayerConfig({minZoom:A}),this}},{key:"getMinZoom",value:function(){var A=this.getLayerConfig(),M=A.minZoom;return M}},{key:"getMaxZoom",value:function(){var A=this.getLayerConfig(),M=A.maxZoom;return M}},{key:"get",value:function(A){var M=this.getLayerConfig();return M[A]}},{key:"setMaxZoom",value:function(A){return this.updateLayerConfig({maxZoom:A}),this}},{key:"fitBounds",value:function(A){if(!this.inited)return this.updateLayerConfig({autoFit:!0}),this;var M=this.getSource(),U=M.extent,ie=U.some(function(de){return Math.abs(de)===Infinity});return ie?this:(this.mapService.fitBounds([[U[0],U[1]],[U[2],U[3]]],A),this)}},{key:"destroy",value:function(){this.hooks.beforeDestroy.call(),this.layerSource.off("update",this.sourceEvent),this.multiPassRenderer.destroy(),this.styleAttributeService.clearAllAttributes(),this.hooks.afterDestroy.call(),this.emit("remove",{target:this,type:"remove"}),this.removeAllListeners()}},{key:"clear",value:function(){this.styleAttributeService.clearAllAttributes()}},{key:"clearModels",value:function(){this.models.forEach(function(A){return A.destroy()}),this.layerModel.clearModels()}},{key:"isDirty",value:function(){return!!(this.styleAttributeService.getLayerStyleAttributes()||[]).filter(function(A){return A.needRescale||A.needRemapping||A.needRegenerateVertices}).length}},{key:"setSource",value:function(A){this.layerSource=A;var M=this.mapService.getZoom();this.layerSource.cluster&&this.layerSource.updateClusterData(M),this.layerSource.on("update",this.sourceEvent)}},{key:"getSource",value:function(){return this.layerSource}},{key:"getScaleOptions",value:function(){return this.scaleOptions}},{key:"setEncodedData",value:function(A){this.encodedData=A}},{key:"getEncodedData",value:function(){return this.encodedData}},{key:"getConfigSchemaForValidation",value:function(){return this.configSchema||(this.configSchema=Qt()([me,this.getConfigSchema()])),this.configSchema}},{key:"getLegendItems",value:function(A){var M=this.styleAttributeService.getLayerAttributeScale(A);if(M){if(M.ticks){var U=M.ticks().map(function(de){return Se()({value:de},A,M(de))});return U}else if(M.invertExtent){var ie=M.range().map(function(de){return Se()({value:M.invertExtent(de)},A,de)});return ie}}else return[]}},{key:"pick",value:function(A){var M=A.x,U=A.y;this.interactionService.triggerHover({x:M,y:U})}},{key:"buildLayerModel",value:function(A){var M=A.moduleName,U=A.vertexShader,ie=A.fragmentShader,de=A.triangulation,Be=Xe()(A,["moduleName","vertexShader","fragmentShader","triangulation"]);this.shaderModuleService.registerModule(M,{vs:U,fs:ie});var zt=this.shaderModuleService.getModule(M),er=zt.vs,Mr=zt.fs,kr=zt.uniforms,xn=this.rendererService.createModel,yn=this.styleAttributeService.createAttributesAndIndices(this.encodedData,de),Fn=yn.attributes,Sa=yn.elements;return xn(ot({attributes:Fn,uniforms:kr,fs:Mr,vs:er,elements:Sa,blend:Pt[E.BlendType.normal]},Be))}},{key:"getTime",value:function(){return this.layerService.clock.getDelta()}},{key:"setAnimateStartTime",value:function(){this.animateStartTime=this.layerService.clock.getElapsedTime()}},{key:"stopAnimate",value:function(){this.aniamateStatus&&(this.layerService.stopAnimate(),this.aniamateStatus=!1,this.updateLayerConfig({animateOption:{enable:!1}}))}},{key:"getLayerAnimateTime",value:function(){return this.layerService.clock.getElapsedTime()-this.animateStartTime}},{key:"needPick",value:function(A){var M=this.getLayerConfig(),U=M.enableHighlight,ie=U===void 0?!0:U,de=M.enableSelect,Be=de===void 0?!0:de,zt=this.eventNames().indexOf(A)!==-1||this.eventNames().indexOf("un"+A)!==-1;return(A==="click"||A==="dblclick")&&Be&&(zt=!0),A==="mousemove"&&(ie||this.eventNames().indexOf("mouseenter")!==-1||this.eventNames().indexOf("unmousemove")!==-1||this.eventNames().indexOf("mouseout")!==-1)&&(zt=!0),this.isVisible()&&zt}},{key:"buildModels",value:function(){throw new Error("Method not implemented.")}},{key:"rebuildModels",value:function(){throw new Error("Method not implemented.")}},{key:"renderModels",value:function(){var A=this;return this.layerModelNeedUpdate&&this.layerModel&&(this.models=this.layerModel.buildModels(),this.hooks.beforeRender.call(),this.layerModelNeedUpdate=!1),this.models.forEach(function(M){M.draw({uniforms:A.layerModel.getUninforms()})}),this}},{key:"getConfigSchema",value:function(){throw new Error("Method not implemented.")}},{key:"getModelType",value:function(){throw new Error("Method not implemented.")}},{key:"getDefaultConfig",value:function(){return{}}},{key:"reRender",value:function(){this.inited&&this.layerService.renderLayers()}},{key:"splitValuesAndCallbackInAttribute",value:function(A,M){return{values:Ve()(A)?void 0:A||M,callback:Ve()(A)?A:void 0}}},{key:"updateStyleAttribute",value:function(A,M,U,ie){this.inited?this.styleAttributeService.updateStyleAttribute(A,{scale:ot({field:M},this.splitValuesAndCallbackInAttribute(U,this.getLayerConfig()[M]))},ie):this.pendingStyleAttributes.push({attributeName:A,attributeField:M,attributeValues:U,updateOptions:ie})}}]),T}(ht.EventEmitter),q),gt=Je()(Oe.prototype,"logger",[ve],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C=Je()(Oe.prototype,"configService",[Ge],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),R=Je()(Oe.prototype,"shaderModuleService",[st],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Oe),tt,kt,pr,Ke,xt,bt,Et=(tt=Object(E.lazyInject)(E.TYPES.IGlobalConfigService),kt=Object(E.lazyInject)(E.TYPES.IShaderModuleService),pr=(bt=function(){function h(_){X()(this,h),this.triangulation=void 0,this.layer=void 0,Le()(this,"configService",Ke,this),Le()(this,"shaderModuleService",xt,this),this.rendererService=void 0,this.iconService=void 0,this.fontService=void 0,this.styleAttributeService=void 0,this.mapService=void 0,this.cameraService=void 0,this.layerService=void 0,this.layer=_,this.rendererService=_.getContainer().get(E.TYPES.IRendererService),this.styleAttributeService=_.getContainer().get(E.TYPES.IStyleAttributeService),this.mapService=_.getContainer().get(E.TYPES.IMapService),this.iconService=_.getContainer().get(E.TYPES.IIconService),this.fontService=_.getContainer().get(E.TYPES.IFontService),this.cameraService=_.getContainer().get(E.TYPES.ICameraService),this.layerService=_.getContainer().get(E.TYPES.ILayerService),this.registerBuiltinAttributes(),this.startModelAnimate()}return i()(h,[{key:"getBlend",value:function(){var T=this.layer.getLayerConfig(),x=T.blend,A=x===void 0?"normal":x;return Pt[E.BlendType[A]]}},{key:"getDefaultStyle",value:function(){return{}}},{key:"getUninforms",value:function(){throw new Error("Method not implemented.")}},{key:"getAnimateUniforms",value:function(){return{}}},{key:"needUpdate",value:function(){return!1}},{key:"buildModels",value:function(){throw new Error("Method not implemented.")}},{key:"initModels",value:function(){throw new Error("Method not implemented.")}},{key:"clearModels",value:function(){return}},{key:"getAttribute",value:function(){throw new Error("Method not implemented.")}},{key:"render",value:function(){throw new Error("Method not implemented.")}},{key:"registerBuiltinAttributes",value:function(){throw new Error("Method not implemented.")}},{key:"animateOption2Array",value:function(T){return[T.enable?0:1,T.duration||4,T.interval||.2,T.trailLength||.1]}},{key:"startModelAnimate",value:function(){var T=this.layer.getLayerConfig(),x=T.animateOption;x.enable&&this.layer.setAnimateStartTime()}}]),h}(),bt),Ke=Je()(pr.prototype,"configService",[tt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xt=Je()(pr.prototype,"shaderModuleService",[kt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pr),Fe=o("J4zp"),pt=o.n(Fe),yt=o("RIqP"),Ht=o.n(yt),hr=o("VmRL"),Zr=o.n(hr),yr=o("IOcx"),Vn=yr.c.create(),zn=yr.c.create(),oa=yr.c.create(),$n=yr.c.create(),Kn=yr.c.create();function Cn(h,_,T,x,A){yr.c.add(h,T,x),yr.c.normalize(h,h),_=yr.c.fromValues(-h[1],h[0]);var M=yr.c.fromValues(-T[1],T[0]);return[A/yr.c.dot(_,M),_]}function z(h,_){return yr.c.set(h,-_[1],_[0])}function W(h,_,T){return yr.c.sub(h,_,T),yr.c.normalize(h,h),h}function le(h,_){return h[0]===_[0]&&h[1]===_[1]}function xe(h){for(var _=new Map,T=0;T<h.length;T++){var x=h[0].toString()+"-"+h[1].toString();_.get(x)?(h.splice(T,1),T++):_.set(x,x)}return h}var ut=function(){function h(){var _=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};X()(this,h),this.complex=void 0,this.join=void 0,this.cap=void 0,this.miterLimit=void 0,this.thickness=void 0,this.normal=void 0,this.lastFlip=-1,this.miter=yr.c.fromValues(0,0),this.started=!1,this.dash=!1,this.totalDistance=0,this.join=_.join||"miter",this.cap=_.cap||"butt",this.miterLimit=_.miterLimit||10,this.thickness=_.thickness||1,this.dash=_.dash||!1,this.complex={positions:[],indices:[],normals:[],startIndex:0}}return i()(h,[{key:"extrude",value:function(T){var x=this.complex;if(T.length<=1)return x;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var A=T.length,M=x.startIndex,U=1;U<A;U++){var ie=T[U-1],de=T[U],Be=U<T.length-1?T[U+1]:null,zt=this.segment(x,M,ie,de,Be);M+=zt}if(this.dash)for(var er=0;er<x.positions.length/6;er++)x.positions[er*6+5]=this.totalDistance;return x.startIndex=x.positions.length/6,x}},{key:"segment",value:function(T,x,A,M,U){var ie=0,de=T.indices,Be=T.positions,zt=T.normals,er=this.cap==="square",Mr=this.join==="bevel",kr=Object(Me.d)([M[0],M[1]]),xn=Object(Me.d)([A[0],A[1]]);W(oa,kr,xn);var yn=0;if(this.dash&&(yn=this.lineSegmentDistance(kr,xn),this.totalDistance+=yn),this.normal||(this.normal=yr.c.create(),z(this.normal,oa)),!this.started)if(this.started=!0,er){var Fn=yr.c.create(),Sa=yr.c.create();yr.c.add(Fn,this.normal,oa),yr.c.add(Sa,this.normal,oa),zt.push(Sa[0],Sa[1],0),zt.push(Fn[0],Fn[1],0),Be.push(A[0],A[1],0,this.totalDistance-yn,-this.thickness,0),Be.push(A[0],A[1],0,this.totalDistance-yn,this.thickness,0)}else this.extrusions(Be,zt,A,this.normal,this.thickness,this.totalDistance-yn);if(de.push(x+0,x+1,x+2),U){var oi=Object(Me.d)([U[0],U[1]]);le(kr,oi)&&yr.c.add(oi,kr,yr.c.normalize(oi,yr.c.subtract(oi,kr,xn))),W($n,oi,kr);var si=Cn(Kn,yr.c.create(),oa,$n,this.thickness),Qi=pt()(si,2),Oa=Qi[0],qi=Qi[1],To=yr.c.dot(Kn,this.normal)<0?-1:1,Xs=Mr;if(!Xs&&this.join==="miter"){var Xa=Oa;Xa>this.miterLimit&&(Xs=!0)}Xs?(zt.push(this.normal[0],this.normal[1],0),zt.push(qi[0],qi[1],0),Be.push(M[0],M[1],0,this.totalDistance,-this.thickness*To,0),Be.push(M[0],M[1],0,this.totalDistance,this.thickness*To,0),de.push.apply(de,Ht()(this.lastFlip!==-To?[x,x+2,x+3]:[x+2,x+1,x+3])),de.push(x+2,x+3,x+4),z(Vn,$n),yr.c.copy(this.normal,Vn),zt.push(this.normal[0],this.normal[1],0),Be.push(M[0],M[1],0,this.totalDistance,-this.thickness*To,0),ie+=3):(this.extrusions(Be,zt,M,qi,Oa,this.totalDistance),de.push.apply(de,Ht()(this.lastFlip===1?[x,x+2,x+3]:[x+2,x+1,x+3])),To=-1,yr.c.copy(this.normal,qi),ie+=2),this.lastFlip=To}else{if(z(this.normal,oa),er){var wa=yr.c.create(),Ri=yr.c.create();yr.c.sub(Ri,oa,this.normal),yr.c.add(wa,oa,this.normal),zt.push(Ri[0],Ri[1],0),zt.push(wa[0],wa[1],0),Be.push(M[0],M[1],0,this.totalDistance,this.thickness,0),Be.push(M[0],M[1],0,this.totalDistance,this.thickness,0)}else this.extrusions(Be,zt,M,this.normal,this.thickness,this.totalDistance);de.push.apply(de,Ht()(this.lastFlip===1?[x,x+2,x+3]:[x+2,x+1,x+3])),ie+=2}return ie}},{key:"extrusions",value:function(T,x,A,M,U,ie){x.push(M[0],M[1],0),x.push(M[0],M[1],0),T.push(A[0],A[1],0,ie,-U,0),T.push(A[0],A[1],0,ie,U,0)}},{key:"lineSegmentDistance",value:function(T,x){var A=x[0]-T[0],M=x[1]-T[1];return Math.sqrt(A*A+M*M)}}]),h}(),Ot=o("UB5X"),Bt=o.n(Ot);function Ze(h){if(Bt()(h[0]))return h;if(Bt()(h[0][0]))throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8");if(Bt()(h[0][0][0])){var _=h,T=0,x=0,A=0;return _.forEach(function(M){M.forEach(function(U){T+=U[0],x+=U[1],A++})}),[T/A,x/A,0]}else throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8")}function Rt(h){var _=h[0][0],T=h[0][h[0].length-1];_[0]===T[0]&&_[1]===T[1]&&(h[0]=h[0].slice(0,h[0].length-1));for(var x=h[0].length,A=Zr.a.flatten(h),M=A.vertices,U=A.dimensions,ie=[],de=[],Be=0;Be<M.length/U;Be++)U===2?ie.push(M[Be*2],M[Be*2+1],1):ie.push(M[Be*3],M[Be*3+1],1);var zt=Zr()(A.vertices,A.holes,A.dimensions);de.push.apply(de,Ht()(zt));for(var er=function(xn){var yn=A.vertices.slice(xn*U,(xn+1)*U),Fn=A.vertices.slice((xn+1)*U,(xn+2)*U);Fn.length===0&&(Fn=A.vertices.slice(0,U));var Sa=ie.length/3;ie.push(yn[0],yn[1],1,Fn[0],Fn[1],1,yn[0],yn[1],0,Fn[0],Fn[1],0),de.push.apply(de,Ht()([0,2,1,2,3,1].map(function(wa){return wa+Sa})))},Mr=0;Mr<x;Mr++)er(Mr);return{positions:ie,index:de}}function lr(h){var _=Zr.a.flatten(h),T=Zr()(_.vertices,_.holes,_.dimensions);return{positions:_.vertices,index:T}}function Ur(h){var _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,T=h[0][0],x=h[0][h[0].length-1];T[0]===x[0]&&T[1]===x[1]&&(h[0]=h[0].slice(0,h[0].length-1));for(var A=h[0].length,M=Zr.a.flatten(h),U=M.vertices,ie=M.dimensions,de=[],Be=[],zt=[],er=0;er<U.length/ie;er++)ie===2?de.push(U[er*2],U[er*2+1],1,-1,-1):de.push(U[er*3],U[er*3+1],1,-1,-1),zt.push(0,0,1);var Mr=Zr()(M.vertices,M.holes,M.dimensions);Be.push.apply(Be,Ht()(Mr));for(var kr=function(Fn){var Sa=M.vertices.slice(Fn*ie,(Fn+1)*ie),wa=M.vertices.slice((Fn+1)*ie,(Fn+2)*ie);wa.length===0&&(wa=M.vertices.slice(0,ie));var Ri=de.length/5;de.push(Sa[0],Sa[1],1,0,0,wa[0],wa[1],1,.1,0,Sa[0],Sa[1],0,0,.8,wa[0],wa[1],0,.1,.8);var oi=Gr([wa[0],wa[1],1],[Sa[0],Sa[1],0],[Sa[0],Sa[1],1],_);zt.push.apply(zt,Ht()(oi).concat(Ht()(oi),Ht()(oi),Ht()(oi))),Be.push.apply(Be,Ht()([1,2,0,3,2,1].map(function(si){return si+Ri})))},xn=0;xn<A;xn++)kr(xn);return{positions:de,index:Be,normals:zt}}function Gr(h,_,T){var x=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,A=yr.d.create(),M=yr.d.create(),U=yr.d.create();x&&(h=Object(Me.p)(h),_=Object(Me.p)(_),T=Object(Me.p)(T));var ie=yr.d.fromValues.apply(yr.d,Ht()(h)),de=yr.d.fromValues.apply(yr.d,Ht()(_)),Be=yr.d.fromValues.apply(yr.d,Ht()(T));yr.d.sub(A,Be,de),yr.d.sub(M,ie,de),yr.d.cross(U,A,M);var zt=yr.d.create();return yr.d.normalize(zt,U),zt}var cr,Br;(function(h){h.CYLINDER="cylinder",h.SQUARECOLUMN="squareColumn",h.TRIANGLECOLUMN="triangleColumn",h.HEXAGONCOLUMN="hexagonColumn",h.PENTAGONCOLUMN="pentagonColumn"})(Br||(Br={}));var wn;(function(h){h.CIRCLE="circle",h.SQUARE="square",h.TRIANGLE="triangle",h.HEXAGON="hexagon",h.PENTAGON="pentagon"})(wn||(wn={}));function fn(h){for(var _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,T=Math.PI*2/h,x=[],A=0;A<h;A++)x.push(T*A+_*Math.PI/12);var M=x.map(function(U){var ie=Math.sin(U+Math.PI/4),de=Math.cos(U+Math.PI/4);return[ie,de,0]});return M}function tr(){return fn(30)}function rn(){return fn(4)}function dn(){return fn(3)}function En(){return fn(6,1)}function bn(){return fn(5)}var gn=(cr={},Se()(cr,wn.CIRCLE,tr),Se()(cr,wn.HEXAGON,En),Se()(cr,wn.TRIANGLE,dn),Se()(cr,wn.SQUARE,rn),Se()(cr,wn.PENTAGON,bn),Se()(cr,Br.CYLINDER,tr),Se()(cr,Br.HEXAGONCOLUMN,En),Se()(cr,Br.TRIANGLECOLUMN,dn),Se()(cr,Br.SQUARECOLUMN,rn),Se()(cr,Br.PENTAGONCOLUMN,bn),cr),Mn={};function Ga(h){var _=Ze(h.coordinates);return{vertices:[].concat(Ht()(_),Ht()(_),Ht()(_),Ht()(_)),indices:[0,1,2,2,3,0],size:_.length}}function ga(h){var _=h.shape,T=wi(_,!1),x=T.positions,A=T.index,M=T.normals;return{vertices:x,indices:A,normals:M,size:5}}function Ma(h){var _=Ze(h.coordinates);return{vertices:Ht()(_),indices:[0],size:_.length}}function Ia(h){var _=h.coordinates,T=_;Array.isArray(T[0][0])||(T=[_]);var x=new ut({dash:!0,join:"bevel"});T.forEach(function(M){x.extrude(M)});var A=x.complex;return{vertices:A.positions,indices:A.indices,normals:A.normals,size:6}}function Wi(h){var _=h.coordinates,T=Zr.a.flatten(_),x=T.vertices,A=T.dimensions,M=T.holes;return{indices:Zr()(x,M,A),vertices:x,size:A}}function da(h){var _=h.coordinates,T=Ur(_,!0),x=T.positions,A=T.index,M=T.normals;return{vertices:x,indices:A,normals:M,size:5}}function vi(h){var _=h.shape,T=Du(_),x=T.positions,A=T.index;return{vertices:x,indices:A,size:3}}function ya(h){var _=h.coordinates,T=[].concat(Ht()(_[0]),[0,0,1,_[1][0],_[0][1],0,1,1],Ht()(_[1]),[0,1,0],Ht()(_[0]),[0,0,1],Ht()(_[1]),[0,1,0,_[0][0],_[1][1],0,0,0]),x=[0,1,2,3,4,5];return{vertices:T,indices:x,size:5}}function ba(h){for(var _=30,T=h.coordinates,x=[],A=[],M=function(de){x.push(de,1,de,T[0][0],T[0][1],T[1][0],T[1][1],de,-1,de,T[0][0],T[0][1],T[1][0],T[1][1]),de!==_-1&&A.push.apply(A,Ht()([0,1,2,1,3,2].map(function(Be){return de*2+Be})))},U=0;U<_;U++)M(U);return{vertices:x,indices:A,size:7}}function ha(h){var _=h.coordinates;_.length===2&&_.push(0);var T=h.size,x=Ha(-1,1),A=Ha(1,1),M=Ha(-1,-1),U=Ha(1,-1),ie=[].concat(Ht()(_),Ht()(x),Ht()(_),Ht()(M),Ht()(_),Ht()(U),Ht()(_),Ht()(A)),de=[0,1,2,3,0,2];return{vertices:ie,indices:de,size:5}}function wi(h){var _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(Mn&&Mn[h])return Mn[h];var T=gn[h]?gn[h]():gn.cylinder(),x=Ur([T],_);return Mn[h]=x,x}function is(h,_){for(var T=arguments.length>2&&arguments[2]!==void 0?arguments[2]:3,x=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,A=new Float32Array(h.length/T*3),M,U,ie,de=yr.d.create(),Be=yr.d.create(),zt=yr.d.create(),er=0,Mr=_.length;er<Mr;er+=3){M=_[er+0]*3,U=_[er+1]*3,ie=_[er+2]*3;var kr=[h[M],h[M+1]],xn=[h[U],h[U+1]],yn=[h[ie],h[ie+1]];x&&(kr=Object(Me.p)(kr),xn=Object(Me.p)(xn),yn=Object(Me.p)(yn));var Fn=kr,Sa=pt()(Fn,2),wa=Sa[0],Ri=Sa[1],oi=yr.d.fromValues(wa,Ri,h[M+2]),si=xn,Qi=pt()(si,2),Oa=Qi[0],qi=Qi[1],To=yr.d.fromValues(Oa,qi,h[U+2]),Xs=yn,Xa=pt()(Xs,2),Ms=Xa[0],$o=Xa[1],ff=yr.d.fromValues(Ms,$o,h[ie+2]);yr.d.sub(de,ff,To),yr.d.sub(Be,oi,To),yr.d.cross(zt,de,Be),A[M]+=de[0],A[M+1]+=de[1],A[M+2]+=de[2],A[U]+=de[0],A[U+1]+=de[1],A[U+2]+=de[2],A[ie]+=de[0],A[ie+1]+=de[1],A[ie+2]+=de[2]}return Xi(A),A}function Xi(h){for(var _=0,T=h.length;_<T;_+=3){var x=yr.d.fromValues(h[_],h[_+1],h[_+2]),A=yr.d.create();yr.d.normalize(A,x),h.set(A,_)}}function Xo(h){var _=h[0][0],T=h[0][h[0].length-1];return _[0]===T[0]&&_[1]===T[1]}function Du(h){var _=["cylinder","triangleColumn","hexagonColumn","squareColumn"],T=gn[h]?gn[h]():gn.circle(),x=_.indexOf(h)===-1?lr([T]):Rt([T]);return x}function Ha(h,_){var T=(h+1)/2,x=(_+1)/2;return[T,x]}function Oi(h){var _=Jo();return function(){var x=Y()(h),A;if(_){var M=Y()(this).constructor;A=Reflect.construct(x,arguments,M)}else A=x.apply(this,arguments);return ee()(this,A)}}function Jo(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var ui=`uniform float u_opacity: 1.0;
uniform vec4 u_baseColor : [ 1.0, 0, 0, 1.0 ];
uniform vec4 u_brightColor : [ 1.0, 0, 0, 1.0 ];
uniform vec4 u_windowColor : [ 1.0, 0, 0, 1.0 ];
uniform float u_near : 0;
uniform float u_far : 1;
varying vec4 v_Color;
varying vec2 v_texCoord;
uniform float u_Zoom : 1;
uniform float u_time;

#pragma include "picking"

vec3 getWindowColor(float n, float hot, vec3 brightColor, vec3 darkColor) {
    float s = step(hot, n);
    vec3 color = mix(brightColor,vec3(0.9,0.9,1.0),n);

    return mix(darkColor, color, s);
}
float random (vec2 st) {
    return fract(sin(dot(st.xy, vec2(12.9898,78.233)))* 43758.5453123);
}

float LinearizeDepth()
{
    float z = gl_FragCoord.z * 2.0 - 1.0;
    return (2.0 * u_near * u_far) / (u_far + u_near - z * (u_far - u_near));
}

vec3 fog(vec3 color, vec3 fogColor, float depth){
    float fogFactor=clamp(depth,0.0,1.0);
    vec3 output_color=mix(fogColor,color,fogFactor);
    return output_color;
}

float sdRect(vec2 p, vec2 sz) {
  vec2 d = abs(p) - sz;
  float outside = length(max(d, 0.));
  float inside = min(max(d.x, d.y), 0.);
  return outside + inside;
}

void main() {
  gl_FragColor = v_Color;
  vec3 baseColor = u_baseColor.xyz;
  vec3 brightColor = u_brightColor.xyz;
  vec3 windowColor = u_windowColor.xyz;
  float targetColId = 5.;
  float depth = 1.0 - LinearizeDepth() / u_far * u_Zoom;
  vec3 fogColor = vec3(23.0/255.0,31.0/255.0,51.0/255.0);
  if(v_texCoord.x < 0.) { //\u9876\u90E8\u989C\u8272
       vec3 foggedColor = fog(baseColor.xyz + vec3(0.12*0.9,0.2*0.9,0.3*0.9),fogColor,depth);
       gl_FragColor = vec4( foggedColor, v_Color.w);
  }else { // \u4FA7\u9762\u989C\u8272
        vec2 st = v_texCoord;
        vec2  UvScale = v_texCoord;
        float tStep = min(0.08,max(0.05* (18.0-u_Zoom),0.02));
        float tStart = 0.25 * tStep;
        float tEnd = 0.75 * tStep;
        float u = mod(UvScale.x, tStep);
        float v = mod(UvScale.y, tStep);
        float ux = floor(UvScale.x/tStep);
        float uy = floor(UvScale.y/tStep);
        float n = random(vec2(ux,uy));
        float lightP = u_time;
        float head = 1.0- step(0.005,st.y);
        /*step3*/
        // \u5C06\u7A97\u6237\u989C\u8272\u548C\u5899\u9762\u989C\u8272\u533A\u522B\u5F00\u6765
        float sU = step(tStart, u) - step(tEnd, u);
        float sV = step(tStart, v) - step(tEnd, v);
        vec2 windowSize = vec2(abs(tEnd-tStart),abs(tEnd-tStart));
        float dist = sdRect(vec2(u,v), windowSize);
        float s = sU * sV;

        float curColId = floor(UvScale.x / tStep);
        float sCol = step(targetColId - 0.2, curColId) - step(targetColId + 0.2, curColId);

        float mLightP = mod(lightP, 2.);
        float sRow = step(mLightP - 0.2, st.y) - step(mLightP, st.y);
        if(ux == targetColId){
            n =0.;
        }
        float timeP = min(0.75, abs ( sin(u_time/3.0) ) );
        float hot = smoothstep(1.0,0.0,timeP);
        vec3 color = mix(baseColor, getWindowColor(n,hot,brightColor,windowColor), s);
        //vec3 color = mix(baseColor, getWindowColor(n,hot,brightColor,windowColor), 1.0);
        float sFinal = s * sCol * sRow;
        color += mix(baseColor, brightColor, sFinal*n);
        if (st.y<0.01){
        color = baseColor;
         }
        if(head ==1.0) { // \u9876\u90E8\u4EAE\u7EBF
            color = brightColor;
        }
        color = color * v_Color.rgb;

        vec3 foggedColor = fog(color,fogColor,depth);

        gl_FragColor = vec4(foggedColor,1.0);
  }
  gl_FragColor.a *= u_opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,Yi=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
uniform mat4 u_ModelMatrix;

attribute vec2 a_Uv;
varying vec2 v_texCoord;

varying vec4 v_Color;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  vec4 project_pos = project_position(pos);
   v_texCoord = a_Uv;
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  float lightWeight = calc_lighting(pos);
  // v_Color = a_Color;
  v_Color = vec4(a_Color.rgb * lightWeight, a_Color.w);

  setPickingColor(a_PickingColor);
}
`,Oo=function(h){D()(T,h);var _=Oi(T);function T(){return X()(this,T),_.apply(this,arguments)}return i()(T,[{key:"getUninforms",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity,U=M===void 0?1:M,ie=A.baseColor,de=ie===void 0?"rgb(16,16,16)":ie,Be=A.brightColor,zt=Be===void 0?"rgb(255,176,38)":Be,er=A.windowColor,Mr=er===void 0?"rgb(30,60,89)":er,kr=A.time,xn=kr===void 0?0:kr;return{u_opacity:U,u_baseColor:Object(Me.s)(de),u_brightColor:Object(Me.s)(zt),u_windowColor:Object(Me.s)(Mr),u_time:this.layer.getLayerAnimateTime()||xn}}},{key:"initModels",value:function(){return this.startModelAnimate(),[this.layer.buildLayerModel({moduleName:"cityBuilding",vertexShader:Yi,fragmentShader:ui,triangulation:da})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"normal",type:E.AttributeType.Attribute,descriptor:{name:"a_Normal",buffer:{usage:E.gl.STATIC_DRAW,data:[],type:E.gl.FLOAT},size:3,update:function(M,U,ie,de,Be){return Be}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:E.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:E.gl.DYNAMIC_DRAW,data:[],type:E.gl.FLOAT},size:1,update:function(M,U,ie,de){var Be=M.size,zt=Be===void 0?10:Be;return Array.isArray(zt)?[zt[0]]:[zt]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:E.AttributeType.Attribute,descriptor:{name:"a_Uv",buffer:{usage:E.gl.DYNAMIC_DRAW,data:[],type:E.gl.FLOAT},size:2,update:function(M,U,ie,de){var Be=M.size;return[ie[3],ie[4]]}}})}}]),T}(Et);function Za(h){var _=oo();return function(){var x=Y()(h),A;if(_){var M=Y()(this).constructor;A=Reflect.construct(x,arguments,M)}else A=x.apply(this,arguments);return ee()(this,A)}}function oo(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var so=function(h){D()(T,h);var _=Za(T);function T(){var x;X()(this,T);for(var A=arguments.length,M=new Array(A),U=0;U<A;U++)M[U]=arguments[U];return x=_.call.apply(_,[this].concat(M)),x.type="PolygonLayer",x}return i()(T,[{key:"buildModels",value:function(){this.layerModel=new Oo(this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"setLight",value:function(A){this.updateLayerConfig({time:A})}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getModelType",value:function(){return"citybuilding"}}]),T}(ae);function bu(h){var _=Qo();return function(){var x=Y()(h),A;if(_){var M=Y()(this).constructor;A=Reflect.construct(x,arguments,M)}else A=x.apply(this,arguments);return ee()(this,A)}}function Qo(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Xl=`precision highp float;\r
// \u591A\u8FB9\u5F62\u9876\u70B9\u5750\u6807\r
attribute vec3 a_Position;\r
// \u591A\u8FB9\u5F62\u7ECF\u7EAC\u5EA6\u5750\u6807\r
attribute vec3 a_Pos;\r
attribute float a_Size;\r
attribute vec4 a_Color;\r
uniform vec2 u_radius;\r
uniform float u_coverage: 0.9;\r
uniform float u_angle: 0;\r
uniform mat4 u_ModelMatrix;\r
varying vec4 v_color;\r
\r
#pragma include "projection"\r
#pragma include "project"\r
#pragma include "picking"\r
\r
void main() {\r
  v_color = a_Color;\r
\r
  mat2 rotationMatrix = mat2(cos(u_angle), sin(u_angle), -sin(u_angle), cos(u_angle));\r
  vec2 offset = a_Position.xy * u_radius * rotationMatrix * u_coverage ;\r
  vec2 lnglat = unProjectFlat(a_Pos.xy + offset);\r
  vec4 project_pos = project_position(vec4(lnglat, 0, 1.0));\r
  gl_Position = project_common_position_to_clipspace(project_pos);\r
\r
  setPickingColor(a_PickingColor);\r
}\r
`,js=`precision highp float;
varying vec4 v_color;
uniform float u_opacity: 1;

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  gl_FragColor.a *= u_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,ho=function(h){D()(T,h);var _=bu(T);function T(){return X()(this,T),_.apply(this,arguments)}return i()(T,[{key:"getUninforms",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity,U=A.coverage,ie=A.angle;return{u_opacity:M||1,u_coverage:U||.9,u_angle:ie||0,u_radius:[this.layer.getSource().data.xOffset,this.layer.getSource().data.yOffset]}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"gridheatmap",vertexShader:Xl,fragmentShader:js,triangulation:vi,depth:{enable:!1},primitive:E.gl.TRIANGLES,blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"pos",type:E.AttributeType.Attribute,descriptor:{name:"a_Pos",buffer:{usage:E.gl.DYNAMIC_DRAW,data:[],type:E.gl.FLOAT},size:3,update:function(M,U){var ie=M.coordinates;return[ie[0],ie[1],0]}}})}}]),T}(Et);function Vt(h){var _=Re();return function(){var x=Y()(h),A;if(_){var M=Y()(this).constructor;A=Reflect.construct(x,arguments,M)}else A=x.apply(this,arguments);return ee()(this,A)}}function Re(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Dt=`precision highp float;
// \u591A\u8FB9\u5F62\u9876\u70B9\u5750\u6807
attribute vec3 a_Position;
// \u591A\u8FB9\u5F62\u7ECF\u7EAC\u5EA6\u5750\u6807
attribute vec3 a_Pos;

attribute vec3 a_Normal;
attribute float a_Size;
attribute vec4 a_Color;
uniform vec2 u_radius;
uniform float u_coverage: 0.9;
uniform float u_angle: 0;
uniform mat4 u_ModelMatrix;
varying vec4 v_color;

#pragma include "projection"
#pragma include "project"
#pragma include "light"
#pragma include "picking"

void main() {
  mat2 rotationMatrix = mat2(cos(u_angle), sin(u_angle), -sin(u_angle), cos(u_angle));
  vec2 offset =(vec2(a_Position.xy * u_radius * rotationMatrix * u_coverage));
  vec2 lnglat = unProjectFlat(a_Pos.xy + offset);
  vec4 project_pos = project_position(vec4(lnglat, a_Position.z * a_Size, 1.0));
  float lightWeight = calc_lighting(project_pos);
  v_color =vec4(a_Color.rgb*lightWeight, a_Color.w);

  gl_Position = project_common_position_to_clipspace(project_pos);
  setPickingColor(a_PickingColor);
}
`,vr=`precision highp float;
varying vec4 v_color;
uniform float u_opacity: 1;

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  gl_FragColor.a *= u_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,en=function(h){D()(T,h);var _=Vt(T);function T(){return X()(this,T),_.apply(this,arguments)}return i()(T,[{key:"getUninforms",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity,U=A.coverage,ie=A.angle;return{u_opacity:M||1,u_coverage:U||1,u_angle:ie||0,u_radius:[this.layer.getSource().data.xOffset,this.layer.getSource().data.yOffset]}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"grid3dheatmap",vertexShader:Dt,fragmentShader:vr,triangulation:ga,depth:{enable:!0},blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:E.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:E.gl.DYNAMIC_DRAW,data:[],type:E.gl.FLOAT},size:1,update:function(M,U,ie,de){var Be=M.size;return Array.isArray(Be)?[Be[0]]:[Be]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:E.AttributeType.Attribute,descriptor:{name:"a_Normal",buffer:{usage:E.gl.STATIC_DRAW,data:[],type:E.gl.FLOAT},size:3,update:function(M,U,ie,de,Be){return Be}}}),this.styleAttributeService.registerStyleAttribute({name:"pos",type:E.AttributeType.Attribute,descriptor:{name:"a_Pos",buffer:{usage:E.gl.DYNAMIC_DRAW,data:[],type:E.gl.FLOAT},size:3,update:function(M,U){var ie=M.coordinates;return[ie[0],ie[1],0]}}})}}]),T}(Et);function Tn(h,_){for(var T=[],x=[],A=[],M=h+1,U=_+1,ie=h/2,de=_/2,Be=0;Be<U;Be++)for(var zt=Be-de,er=0;er<M;er++){var Mr=er-ie;x.push(Mr/ie,-zt/de,0),A.push(er/h),A.push(1-Be/_)}for(var kr=0;kr<_;kr++)for(var xn=0;xn<h;xn++){var yn=xn+M*kr,Fn=xn+M*(kr+1),Sa=xn+1+M*(kr+1),wa=xn+1+M*kr;T.push(yn,Fn,wa),T.push(Fn,Sa,wa)}return{vertices:x,indices:T,uvs:A}}function Gn(h,_){var T=Object.keys(h);if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(h);_&&(x=x.filter(function(A){return Object.getOwnPropertyDescriptor(h,A).enumerable})),T.push.apply(T,x)}return T}function Mi(h){for(var _=1;_<arguments.length;_++){var T=arguments[_]!=null?arguments[_]:{};_%2?Gn(Object(T),!0).forEach(function(x){Se()(h,x,T[x])}):Object.getOwnPropertyDescriptors?Object.defineProperties(h,Object.getOwnPropertyDescriptors(T)):Gn(Object(T)).forEach(function(x){Object.defineProperty(h,x,Object.getOwnPropertyDescriptor(T,x))})}return h}function po(h){var _=mo();return function(){var x=Y()(h),A;if(_){var M=Y()(this).constructor;A=Reflect.construct(x,arguments,M)}else A=x.apply(this,arguments);return ee()(this,A)}}function mo(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Mo=`uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;
uniform float u_opacity;
varying vec2 v_texCoord;
varying float v_intensity;

void main(){
   
     float intensity = texture2D(u_texture, v_texCoord).r;
    vec4 color = texture2D(u_colorTexture,vec2(intensity, 0));
    gl_FragColor = color;
    // gl_FragColor.a = color.a * smoothstep(0.1,0.2,intensity)* u_opacity;
     gl_FragColor.a = color.a * smoothstep(0.,0.1,intensity) * u_opacity;

}
`,Nu=`precision highp float;
attribute vec3 a_Position;
attribute vec2 a_Uv;
uniform sampler2D u_texture;
varying vec2 v_texCoord;
uniform mat4 u_ModelMatrix;
uniform mat4 u_InverseViewProjectionMatrix;
uniform mat4 u_ViewProjectionMatrixUncentered;
varying float v_intensity;

vec2 toBezier(float t, vec2 P0, vec2 P1, vec2 P2, vec2 P3) {
    float t2 = t * t;
    float one_minus_t = 1.0 - t;
    float one_minus_t2 = one_minus_t * one_minus_t;
    return (P0 * one_minus_t2 * one_minus_t + P1 * 3.0 * t * one_minus_t2 + P2 * 3.0 * t2 * one_minus_t + P3 * t2 * t);
}
vec2 toBezier(float t, vec4 p){
    return toBezier(t, vec2(0.0, 0.0), vec2(p.x, p.y), vec2(p.z, p.w), vec2(1.0, 1.0));
}
#pragma include "projection"
void main() {
  v_texCoord = a_Uv;

  vec2 pos =(a_Uv * vec2(2.0) - vec2(1.0));


  vec4 p1 = vec4(pos, 0.0, 1.0);
	vec4 p2 = vec4(pos, 1.0, 1.0);

	vec4 inverseP1 = u_InverseViewProjectionMatrix * p1;
	vec4 inverseP2 = u_InverseViewProjectionMatrix * p2;

  inverseP1 = inverseP1 / inverseP1.w;
	inverseP2 = inverseP2 / inverseP2.w;

	float zPos = (0.0 - inverseP1.z) / (inverseP2.z - inverseP1.z);
	vec4 position = inverseP1 + zPos * (inverseP2 - inverseP1);

  vec4 b= vec4(0.5000, 0, 1, 0.5000);
  float fh;

  v_intensity = texture2D(u_texture, v_texCoord).r;
  fh = toBezier(v_intensity, b).y;
  gl_Position = u_ViewProjectionMatrixUncentered * vec4(position.xy, fh * project_pixel(50.), 1.0);

}
`,Ol=`uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;
uniform float u_opacity;
varying vec2 v_texCoord;
varying float v_intensity;

void main(){
     float intensity = texture2D(u_texture, v_texCoord).r;
    vec4 color = texture2D(u_colorTexture,vec2(intensity, 0));
    gl_FragColor =color;
    gl_FragColor.a = color.a * smoothstep(0.,0.1,intensity) * u_opacity;

}
`,Ts=`precision highp float;
uniform float u_intensity;
varying float v_weight;
varying vec2 v_extrude;
#define GAUSS_COEF  0.3989422804014327
void main(){
    float d = -0.5 * 3.0 * 3.0 * dot(v_extrude, v_extrude);
    float val = v_weight * u_intensity * GAUSS_COEF * exp(d);
    gl_FragColor = vec4(val, 1., 1., 1.);
}
`,pc=`precision highp float;
attribute vec3 a_Position;
attribute float a_Size;
attribute vec2 a_Dir;
uniform float u_intensity;
uniform float u_radius;
varying vec2 v_extrude;
varying float v_weight;
uniform mat4 u_ModelMatrix;

#define GAUSS_COEF  0.3989422804014327

#pragma include "projection"

void main(){
    v_weight = a_Size;
    float ZERO = 1.0 / 255.0 / 16.0;
    float extrude_x = a_Dir.x * 2.0 -1.0;
    float extrude_y = a_Dir.y * 2.0 -1.0;
    vec2 extrude_dir = normalize(vec2(extrude_x,extrude_y));
    float S = sqrt(-2.0 * log(ZERO / a_Size / u_intensity / GAUSS_COEF)) / 3.0;
    v_extrude = extrude_dir * S;

    vec2 offset = project_pixel(v_extrude * u_radius);
    vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0));

    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));
}
`,xu=`precision highp float;
attribute vec3 a_Position;
attribute vec2 a_Uv;
uniform sampler2D u_texture;
varying vec2 v_texCoord;
varying float v_intensity;
void main() {
  v_texCoord = a_Uv;
  v_intensity = texture2D(u_texture, v_texCoord).r;
  gl_Position = vec4(a_Position.xy, 0, 1.);
}
`,Po=function(h){D()(T,h);var _=po(T);function T(){var x;X()(this,T);for(var A=arguments.length,M=new Array(A),U=0;U<A;U++)M[U]=arguments[U];return x=_.call.apply(_,[this].concat(M)),x.texture=void 0,x.colorTexture=void 0,x.heatmapFramerBuffer=void 0,x.intensityModel=void 0,x.colorModel=void 0,x.shapeType=void 0,x}return i()(T,[{key:"render",value:function(){var A=this,M=this.rendererService,U=M.clear,ie=M.useFramebuffer;ie(this.heatmapFramerBuffer,function(){U({color:[0,0,0,0],depth:1,stencil:0,framebuffer:A.heatmapFramerBuffer}),A.drawIntensityMode()}),this.layer.styleNeedUpdate&&this.updateColorTexture(),this.shapeType==="heatmap"?this.drawColorMode():this.draw3DHeatMap()}},{key:"getUninforms",value:function(){throw new Error("Method not implemented.")}},{key:"initModels",value:function(){var A,M=this.rendererService,U=M.createFramebuffer,ie=M.clear,de=M.getViewportSize,Be=M.createTexture2D,zt=M.useFramebuffer,er=this.styleAttributeService.getLayerStyleAttribute("shape"),Mr=(er==null||((A=er.scale)===null||A===void 0)?void 0:A.field)||"heatmap";this.shapeType=Mr,this.intensityModel=this.buildHeatMapIntensity(),this.colorModel=Mr==="heatmap"?this.buildHeatmapColor():this.build3dHeatMap();var kr=this.layer.getLayerConfig(),xn=kr.rampColors,yn=Object(Me.n)(xn),Fn=de(),Sa=Fn.width,wa=Fn.height;return this.heatmapFramerBuffer=U({color:Be({width:Math.floor(Sa/4),height:Math.floor(wa/4),wrapS:E.gl.CLAMP_TO_EDGE,wrapT:E.gl.CLAMP_TO_EDGE,min:E.gl.LINEAR,mag:E.gl.LINEAR}),depth:!1}),this.updateColorTexture(),[this.intensityModel,this.colorModel]}},{key:"buildModels",value:function(){return this.initModels()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"dir",type:E.AttributeType.Attribute,descriptor:{name:"a_Dir",buffer:{usage:E.gl.DYNAMIC_DRAW,data:[],type:E.gl.FLOAT},size:2,update:function(M,U,ie,de){return[ie[3],ie[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:E.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:E.gl.DYNAMIC_DRAW,data:[],type:E.gl.FLOAT},size:1,update:function(M,U,ie,de){var Be=M.size,zt=Be===void 0?1:Be;return[zt]}}})}},{key:"buildHeatMapIntensity",value:function(){return this.layer.buildLayerModel({moduleName:"heatmapintensity",vertexShader:pc,fragmentShader:Ts,triangulation:ha,depth:{enable:!1},blend:{enable:!0,func:{srcRGB:E.gl.ONE,srcAlpha:1,dstRGB:E.gl.ONE,dstAlpha:1}}})}},{key:"buildHeatmapColor",value:function(){this.shaderModuleService.registerModule("heatmapColor",{vs:xu,fs:Ol});var A=this.shaderModuleService.getModule("heatmapColor"),M=A.vs,U=A.fs,ie=A.uniforms,de=this.rendererService,Be=de.createAttribute,zt=de.createElements,er=de.createBuffer,Mr=de.createModel;return Mr({vs:M,fs:U,attributes:{a_Position:Be({buffer:er({data:[-1,1,0,1,1,0,-1,-1,0,1,-1,0],type:E.gl.FLOAT}),size:3}),a_Uv:Be({buffer:er({data:[0,1,1,1,0,0,1,0],type:E.gl.FLOAT}),size:2})},uniforms:Mi({},ie),depth:{enable:!1},blend:this.getBlend(),count:6,elements:zt({data:[0,2,1,2,3,1],type:E.gl.UNSIGNED_INT,count:6})})}},{key:"drawIntensityMode",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity,U=A.intensity,ie=U===void 0?10:U,de=A.radius,Be=de===void 0?5:de;this.intensityModel.draw({uniforms:{u_opacity:M||1,u_radius:Be,u_intensity:ie}})}},{key:"drawColorMode",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity;this.colorModel.draw({uniforms:{u_opacity:M||1,u_colorTexture:this.colorTexture,u_texture:this.heatmapFramerBuffer}})}},{key:"draw3DHeatMap",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity,U=yr.b.invert(yr.b.create(),yr.b.fromValues.apply(yr.b,Ht()(this.cameraService.getViewProjectionMatrixUncentered())));this.colorModel.draw({uniforms:{u_opacity:M||1,u_colorTexture:this.colorTexture,u_texture:this.heatmapFramerBuffer,u_ViewProjectionMatrixUncentered:this.cameraService.getViewProjectionMatrixUncentered(),u_InverseViewProjectionMatrix:Ht()(U)}})}},{key:"build3dHeatMap",value:function(){var A=this.rendererService.getViewportSize,M=A(),U=M.width,ie=M.height,de=Tn(U/4,ie/4);this.shaderModuleService.registerModule("heatmap3dColor",{vs:Nu,fs:Mo});var Be=this.shaderModuleService.getModule("heatmap3dColor"),zt=Be.vs,er=Be.fs,Mr=Be.uniforms,kr=this.rendererService,xn=kr.createAttribute,yn=kr.createElements,Fn=kr.createBuffer,Sa=kr.createModel;return Sa({vs:zt,fs:er,attributes:{a_Position:xn({buffer:Fn({data:de.vertices,type:E.gl.FLOAT}),size:3}),a_Uv:xn({buffer:Fn({data:de.uvs,type:E.gl.FLOAT}),size:2})},primitive:E.gl.TRIANGLES,uniforms:Mi({},Mr),depth:{enable:!0},blend:{enable:!0,func:{srcRGB:E.gl.SRC_ALPHA,srcAlpha:1,dstRGB:E.gl.ONE_MINUS_SRC_ALPHA,dstAlpha:1}},elements:yn({data:de.indices,type:E.gl.UNSIGNED_INT,count:de.indices.length})})}},{key:"updateStyle",value:function(){this.updateColorTexture()}},{key:"updateColorTexture",value:function(){var A=this.rendererService.createTexture2D;this.texture&&this.texture.destroy();var M=this.layer.getLayerConfig(),U=M.rampColors,ie=Object(Me.n)(U);this.colorTexture=A({data:new Uint8Array(ie.data),width:ie.width,height:ie.height,wrapS:E.gl.CLAMP_TO_EDGE,wrapT:E.gl.CLAMP_TO_EDGE,min:E.gl.NEAREST,mag:E.gl.NEAREST,flipY:!1})}}]),T}(Et);function ku(h){var _=_o();return function(){var x=Y()(h),A;if(_){var M=Y()(this).constructor;A=Reflect.construct(x,arguments,M)}else A=x.apply(this,arguments);return ee()(this,A)}}function _o(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var zi=`precision highp float;
varying vec4 v_color;
uniform float u_opacity: 1;

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  gl_FragColor.a *= u_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,Ys=`precision highp float;
// \u591A\u8FB9\u5F62\u9876\u70B9\u5750\u6807
attribute vec3 a_Position;
// \u591A\u8FB9\u5F62\u7ECF\u7EAC\u5EA6\u5750\u6807
attribute vec3 a_Pos;
attribute float a_Size;
attribute vec4 a_Color;
uniform vec2 u_radius;
uniform float u_coverage: 0.9;
uniform float u_angle: 0;
uniform mat4 u_ModelMatrix;
varying vec4 v_color;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

void main() {
  v_color = a_Color;
    
  mat2 rotationMatrix = mat2(cos(u_angle), sin(u_angle), -sin(u_angle), cos(u_angle));
  vec2 offset =(vec2(a_Position.xy * u_radius * rotationMatrix * u_coverage));
  vec2 lnglat = unProjectFlat(a_Pos.xy + offset);
  vec4 project_pos = project_position(vec4(lnglat, 0, 1.0));
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, 0., 1.0));
  setPickingColor(a_PickingColor);
}
`,Ks=function(h){D()(T,h);var _=ku(T);function T(){return X()(this,T),_.apply(this,arguments)}return i()(T,[{key:"getUninforms",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity,U=A.coverage,ie=A.angle;return{u_opacity:M||1,u_coverage:U||.9,u_angle:ie||0,u_radius:[this.layer.getSource().data.xOffset,this.layer.getSource().data.yOffset]}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"hexagonheatmap",vertexShader:Ys,fragmentShader:zi,triangulation:vi,depth:{enable:!1},primitive:E.gl.TRIANGLES,blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"pos",type:E.AttributeType.Attribute,descriptor:{name:"a_Pos",buffer:{usage:E.gl.DYNAMIC_DRAW,data:[],type:E.gl.FLOAT},size:3,update:function(M,U){var ie=M.coordinates;return[ie[0],ie[1],0]}}})}}]),T}(Et),Fs={heatmap:Po,heatmap3d:Po,grid:ho,grid3d:en,hexagon:Ks},Ii=Fs;function Gi(h){var _=_s();return function(){var x=Y()(h),A;if(_){var M=Y()(this).constructor;A=Reflect.construct(x,arguments,M)}else A=x.apply(this,arguments);return ee()(this,A)}}function _s(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var ml=function(h){D()(T,h);var _=Gi(T);function T(){var x;X()(this,T);for(var A=arguments.length,M=new Array(A),U=0;U<A;U++)M[U]=arguments[U];return x=_.call.apply(_,[this].concat(M)),x.type="HeatMapLayer",x}return i()(T,[{key:"buildModels",value:function(){var A=this.getModelType();this.layerModel=new Ii[A](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"renderModels",value:function(){var A=this,M=this.getModelType();return M==="heatmap"?(this.layerModel&&this.layerModel.render(),this):(this.layerModelNeedUpdate&&(this.models=this.layerModel.buildModels(),this.layerModelNeedUpdate=!1),this.models.forEach(function(U){return U.draw({uniforms:A.layerModel.getUninforms()})}),this)}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getModelType",value:function(){var A,M=this.styleAttributeService.getLayerStyleAttribute("shape"),U=this.getLayerConfig(),ie=U.shape3d,de=this.getSource(),Be=de.data.type,zt=(M==null||((A=M.scale)===null||A===void 0)?void 0:A.field)||"heatmap";return zt==="heatmap"||zt==="heatmap3d"?"heatmap":Be==="hexagon"?(ie==null?void 0:ie.indexOf(zt))===-1?"hexagon":"grid3d":Be==="grid"?(ie==null?void 0:ie.indexOf(zt))===-1?"grid":"grid3d":"heatmap"}}]),T}(ae);function $u(h){var _=It();return function(){var x=Y()(h),A;if(_){var M=Y()(this).constructor;A=Reflect.construct(x,arguments,M)}else A=x.apply(this,arguments);return ee()(this,A)}}function It(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var fr=`precision mediump float;
uniform float u_opacity: 1.0;
uniform sampler2D u_texture;
varying vec2 v_texCoord;
void main() {
  vec4 color = texture2D(u_texture,vec2(v_texCoord.x,v_texCoord.y));
  gl_FragColor = color;
  gl_FragColor.a *= u_opacity;
}
`,Pr=`precision highp float;
uniform mat4 u_ModelMatrix;
attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;
#pragma include "projection"
void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
}
`,Wn=function(h){D()(T,h);var _=$u(T);function T(){var x;X()(this,T);for(var A=arguments.length,M=new Array(A),U=0;U<A;U++)M[U]=arguments[U];return x=_.call.apply(_,[this].concat(M)),x.texture=void 0,x}return i()(T,[{key:"getUninforms",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity;return{u_opacity:M||1,u_texture:this.texture}}},{key:"initModels",value:function(){var A=this,M=this.layer.getSource(),U=this.rendererService.createTexture2D;return this.texture=U({height:0,width:0}),M.data.images.then(function(ie){A.texture=U({data:ie[0],width:ie[0].width,height:ie[0].height}),A.layerService.renderLayers()}),[this.layer.buildLayerModel({moduleName:"RasterImage",vertexShader:Pr,fragmentShader:fr,triangulation:ya,primitive:E.gl.TRIANGLES,depth:{enable:!1},blend:this.getBlend()})]}},{key:"buildModels",value:function(){return this.initModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:E.AttributeType.Attribute,descriptor:{name:"a_Uv",buffer:{usage:E.gl.DYNAMIC_DRAW,data:[],type:E.gl.FLOAT},size:2,update:function(M,U,ie,de){return[ie[3],ie[4]]}}})}}]),T}(Et),Ya={image:Wn},xi=Ya;function Ki(h){var _=Ka();return function(){var x=Y()(h),A;if(_){var M=Y()(this).constructor;A=Reflect.construct(x,arguments,M)}else A=x.apply(this,arguments);return ee()(this,A)}}function Ka(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Di=function(h){D()(T,h);var _=Ki(T);function T(){var x;X()(this,T);for(var A=arguments.length,M=new Array(A),U=0;U<A;U++)M[U]=arguments[U];return x=_.call.apply(_,[this].concat(M)),x.type="ImageLayer",x}return i()(T,[{key:"buildModels",value:function(){var A=this.getModelType();this.layerModel=new xi[A](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getDefaultConfig",value:function(){var A=this.getModelType(),M={image:{}};return M[A]}},{key:"getModelType",value:function(){return"image"}}]),T}(ae);function Yo(h){var _=Ps();return function(){var x=Y()(h),A;if(_){var M=Y()(this).constructor;A=Reflect.construct(x,arguments,M)}else A=x.apply(this,arguments);return ee()(this,A)}}function Ps(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var gi=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0

uniform float u_opacity;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
varying vec2 v_normal;
varying vec4 v_dash_array;
varying float v_distance_ratio;
varying vec4 v_color;

uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  // float blur = 1.- smoothstep(u_blur, 1., length(v_normal.xy));
  // float blur = smoothstep(1.0, u_blur, length(v_normal.xy));
  gl_FragColor.a *= u_opacity;
  if(u_line_type == LineTypeDash) {
   float flag = 0.;
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    gl_FragColor.a *=flag;
  }

  if(u_aimate.x == Animate) {
      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + u_time / u_aimate.y);
      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }
  gl_FragColor = filterColor(gl_FragColor);
}
`,Ml=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;
uniform float segmentNumber;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];
varying vec4 v_color;
varying vec2 v_normal;

varying float v_distance_ratio;
uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
varying vec4 v_dash_array;
#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float bezier3(vec3 arr, float t) {
  float ut = 1. - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}
vec2 midPoint(vec2 source, vec2 target) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = 0.314;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);
  return mid;
}
float getSegmentRatio(float index) {
    return smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
}
vec2 interpolate (vec2 source, vec2 target, float t) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  vec2 mid = midPoint(source, target);
  vec3 x = vec3(source.x, mid.x, target.x);
  vec3 y = vec3(source.y, mid.y, target.y);
  return vec2(bezier3(x ,t), bezier3(y,t));
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

void main() {
  v_color = a_Color;
  vec2 source = a_Instance.rg;
  vec2 target =  a_Instance.ba;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  if(u_line_type == LineTypeDash) {
      v_distance_ratio = segmentIndex / segmentNumber;
      float total_Distance = pixelDistance(a_Instance.rg, a_Instance.ba) / 2.0 * PI;
      v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
    }
  if(u_aimate.x == Animate) {
      v_distance_ratio = segmentIndex / segmentNumber;
  }
  vec4 curr = project_position(vec4(interpolate(source, target, segmentRatio), 0.0, 1.0));
  vec4 next = project_position(vec4(interpolate(source, target, nextSegmentRatio), 0.0, 1.0));
  v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));

  gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  setPickingColor(a_PickingColor);
}
`,$s={solid:0,dash:1},Ss=function(h){D()(T,h);var _=Yo(T);function T(){return X()(this,T),_.apply(this,arguments)}return i()(T,[{key:"getUninforms",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity,U=A.lineType,ie=U===void 0?"solid":U,de=A.dashArray,Be=de===void 0?[10,5]:de;return Be.length===2&&Be.push(0,0),{u_opacity:M||1,segmentNumber:30,u_line_type:$s[ie||"solid"],u_dash_array:Be,u_blur:.9}}},{key:"getAnimateUniforms",value:function(){var A=this.layer.getLayerConfig(),M=A.animateOption;return{u_aimate:this.animateOption2Array(M),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"arc2dline",vertexShader:Ml,fragmentShader:gi,triangulation:ba,depth:{enable:!1},blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:E.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:E.gl.DYNAMIC_DRAW,data:[],type:E.gl.FLOAT},size:1,update:function(M,U,ie,de){var Be=M.size,zt=Be===void 0?1:Be;return Array.isArray(zt)?[zt[0]]:[zt]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:E.AttributeType.Attribute,descriptor:{name:"a_Instance",buffer:{usage:E.gl.STATIC_DRAW,data:[],type:E.gl.FLOAT},size:4,update:function(M,U,ie,de){return[ie[3],ie[4],ie[5],ie[6]]}}})}}]),T}(Et);function vl(h){var _=cu();return function(){var x=Y()(h),A;if(_){var M=Y()(this).constructor;A=Reflect.construct(x,arguments,M)}else A=x.apply(this,arguments);return ee()(this,A)}}function cu(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Eu=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute vec4 a_Color;
attribute float a_Size;

uniform mat4 u_ModelMatrix;
uniform float segmentNumber;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];
varying vec4 v_color;
varying vec2 v_normal;
varying float v_distance_ratio;
uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
varying vec4 v_dash_array;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
  );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);

  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;

  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

void main() {
  v_color = a_Color;
  vec2 source = project_position(vec4(a_Instance.rg, 0, 0)).xy;
  vec2 target = project_position(vec4(a_Instance.ba, 0, 0)).xy;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

   if(u_line_type == LineTypeDash) {
    v_distance_ratio = segmentIndex / segmentNumber;
    float total_Distance = pixelDistance(a_Instance.rg, a_Instance.ba) / 2.0 * PI;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
    if(u_aimate.x == Animate) {
      v_distance_ratio = segmentIndex / segmentNumber;
  }

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  vec3 curr = getPos(source, target, segmentRatio);
  vec3 next = getPos(source, target, nextSegmentRatio);
  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y);
  v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);

  gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  setPickingColor(a_PickingColor);
}
`,fu=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0

uniform float u_opacity;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
varying vec2 v_normal;
varying vec4 v_dash_array;
varying float v_distance_ratio;
varying vec4 v_color;

uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  // float blur = 1.- smoothstep(u_blur, 1., length(v_normal.xy));
  // float blur = smoothstep(1.0, u_blur, length(v_normal.xy));
  gl_FragColor.a *= u_opacity;
  if(u_line_type == LineTypeDash) {
   float flag = 0.;
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    gl_FragColor.a *=flag;
  }

  if(u_aimate.x == Animate) {
      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + u_time / u_aimate.y);
      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }
  gl_FragColor = filterColor(gl_FragColor);
}
`,ju={solid:0,dash:1},Js=function(h){D()(T,h);var _=vl(T);function T(){return X()(this,T),_.apply(this,arguments)}return i()(T,[{key:"getUninforms",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity,U=A.lineType,ie=U===void 0?"solid":U,de=A.dashArray,Be=de===void 0?[10,5]:de;return Be.length===2&&Be.push(0,0),{u_opacity:M||1,segmentNumber:30,u_line_type:ju[ie]||0,u_dash_array:Be}}},{key:"getAnimateUniforms",value:function(){var A=this.layer.getLayerConfig(),M=A.animateOption;return{u_aimate:this.animateOption2Array(M),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"arc3Dline",vertexShader:Eu,fragmentShader:fu,triangulation:ba,blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:E.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:E.gl.DYNAMIC_DRAW,data:[],type:E.gl.FLOAT},size:1,update:function(M,U,ie,de){var Be=M.size,zt=Be===void 0?1:Be;return Array.isArray(zt)?[zt[0]]:[zt]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:E.AttributeType.Attribute,descriptor:{name:"a_Instance",buffer:{usage:E.gl.STATIC_DRAW,data:[],type:E.gl.FLOAT},size:4,update:function(M,U,ie,de){return[ie[3],ie[4],ie[5],ie[6]]}}})}}]),T}(Et);function Mc(h){var _=hf();return function(){var x=Y()(h),A;if(_){var M=Y()(this).constructor;A=Reflect.construct(x,arguments,M)}else A=x.apply(this,arguments);return ee()(this,A)}}function hf(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var pi=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0

uniform float u_opacity;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
varying vec2 v_normal;
varying vec4 v_dash_array;
varying float v_distance_ratio;
varying vec4 v_color;

uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  // float blur = 1.- smoothstep(u_blur, 1., length(v_normal.xy));
  // float blur = smoothstep(1.0, u_blur, length(v_normal.xy));
  gl_FragColor.a *= u_opacity;
  if(u_line_type == LineTypeDash) {
   float flag = 0.;
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    gl_FragColor.a *=flag;
  }

  if(u_aimate.x == Animate) {
      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + u_time / u_aimate.y);
      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }
  gl_FragColor = filterColor(gl_FragColor);
}
`,Pc=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;
uniform float segmentNumber;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];
varying vec4 v_color;
varying vec2 v_normal;

varying float v_distance_ratio;
uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
varying vec4 v_dash_array;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
    return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
    return smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
    vec2 x = mix(source, target, ratio);
    vec2 center = mix(source, target, 0.5);
    float dSourceCenter = distance(source, center);
    float dXCenter = distance(x, center);
    return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
     float vertex_height = paraboloid(source, target, segmentRatio);

    return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
    );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size)/ 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}
float getAngularDist (vec2 source, vec2 target) {
  vec2 delta = source - target;
  vec2 sin_half_delta = sin(delta / 2.0);
  float a =
    sin_half_delta.y * sin_half_delta.y +
    cos(source.y) * cos(target.y) *
    sin_half_delta.x * sin_half_delta.x;
  return 2.0 * atan(sqrt(a), sqrt(1.0 - a));
}
vec2 interpolate (vec2 source, vec2 target, float angularDist, float t) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  if(abs(angularDist - PI) < 0.001) {
    return (1.0 - t) * source + t * target;
  }
  float a = sin((1.0 - t) * angularDist) / sin(angularDist);
  float b = sin(t * angularDist) / sin(angularDist);
  vec2 sin_source = sin(source);
  vec2 cos_source = cos(source);
  vec2 sin_target = sin(target);
  vec2 cos_target = cos(target);
  float x = a * cos_source.y * cos_source.x + b * cos_target.y * cos_target.x;
  float y = a * cos_source.y * sin_source.x + b * cos_target.y * sin_target.x;
  float z = a * sin_source.y + b * sin_target.y;
  return vec2(atan(y, x), atan(z, sqrt(x * x + y * y)));
}

void main() {
  v_color = a_Color;
  vec2 source = radians(a_Instance.rg);
  vec2 target = radians(a_Instance.ba);
  float angularDist = getAngularDist(source, target);
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  if(u_line_type == LineTypeDash) {
    v_distance_ratio = segmentIndex / segmentNumber;
    float total_Distance = pixelDistance(a_Instance.rg, a_Instance.ba);
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
  if(u_aimate.x == Animate) {
      v_distance_ratio = segmentIndex / segmentNumber;
  }
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  v_distance_ratio = segmentIndex / segmentNumber;
  vec4 curr = project_position(vec4(degrees(interpolate(source, target, angularDist, segmentRatio)), 0.0, 1.0));
  vec4 next = project_position(vec4(degrees(interpolate(source, target, angularDist, nextSegmentRatio)), 0.0, 1.0));
  v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));
  //  vec4 project_pos = project_position(vec4(curr.xy, 0, 1.0));
  gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, curr.z, 1.0));
  setPickingColor(a_PickingColor);
}

`,mc={solid:0,dash:1},$c=function(h){D()(T,h);var _=Mc(T);function T(){return X()(this,T),_.apply(this,arguments)}return i()(T,[{key:"getUninforms",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity,U=A.lineType,ie=U===void 0?"solid":U,de=A.dashArray,Be=de===void 0?[10,5]:de;return Be.length===2&&Be.push(0,0),{u_opacity:M||1,segmentNumber:30,u_line_type:mc[ie]||0,u_dash_array:Be}}},{key:"getAnimateUniforms",value:function(){var A=this.layer.getLayerConfig(),M=A.animateOption;return{u_aimate:this.animateOption2Array(M),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"arc2dline",vertexShader:Pc,fragmentShader:pi,triangulation:ba,depth:{enable:!1},blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:E.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:E.gl.DYNAMIC_DRAW,data:[],type:E.gl.FLOAT},size:1,update:function(M,U,ie,de){var Be=M.size,zt=Be===void 0?1:Be;return Array.isArray(zt)?[zt[0]]:[zt]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:E.AttributeType.Attribute,descriptor:{name:"a_Instance",buffer:{usage:E.gl.STATIC_DRAW,data:[],type:E.gl.FLOAT},size:4,update:function(M,U,ie,de){return[ie[3],ie[4],ie[5],ie[6]]}}})}}]),T}(Et);function gl(h){var _=Jc();return function(){var x=Y()(h),A;if(_){var M=Y()(this).constructor;A=Reflect.construct(x,arguments,M)}else A=x.apply(this,arguments);return ee()(this,A)}}function Jc(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var $i=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
uniform float u_blur : 0.99;
uniform float u_line_type: 0.0;
uniform float u_opacity : 1.0;
varying vec4 v_color;
varying vec2 v_normal;


// dash
uniform float u_dash_offset : 0.0;
uniform float u_dash_ratio : 0.1;
varying float v_distance_ratio;
varying vec4 v_dash_array;
varying float v_side;


#pragma include "picking"

uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];
// [animate, duration, interval, trailLength],
void main() {
  gl_FragColor = v_color;
  // anti-alias
  // float blur = 1.0 - smoothstep(u_blur, 1., length(v_normal.xy));
  gl_FragColor.a *= u_opacity;
  if(u_aimate.x == Animate) {
      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + u_time / u_aimate.y);
      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }
 // dash line
  if(u_line_type == LineTypeDash) {
    float flag = 0.;
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    gl_FragColor.a *=flag;
    // gl_FragColor.a *=(1.0- step(v_dash_array.x, mod(v_distance_ratio, dashLength)));
  }

  gl_FragColor = filterColor(gl_FragColor);
}
`,Tu=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0

attribute float a_Miter;
attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec3 a_Normal;
attribute vec3 a_Position;

// dash line
attribute float a_Total_Distance;
attribute float a_Distance;

uniform mat4 u_ModelMatrix;
uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5.\uFF0C0, 0];
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];

#pragma include "projection"
#pragma include "picking"

varying vec4 v_color;
varying vec4 v_dash_array;
varying vec2 v_normal;
varying float v_distance_ratio;
varying float v_side;


void main() {

  if(u_line_type == LineTypeDash) {
    v_distance_ratio = a_Distance / a_Total_Distance;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / a_Total_Distance;
  }
  if(u_aimate.x == Animate) {
      v_distance_ratio = a_Distance / a_Total_Distance;
  }
  v_normal = vec2(reverse_offset_normal(a_Normal) * sign(a_Miter));
  v_color = a_Color;
  vec3 size = a_Miter * setPickingSize(a_Size.x) * reverse_offset_normal(a_Normal);
  vec2 offset = project_pixel(size.xy);
  v_side = a_Miter * a_Size.x;
  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, a_Size.y, 1.0));

  setPickingColor(a_PickingColor);
}
`,yl={solid:0,dash:1},os=function(h){D()(T,h);var _=gl(T);function T(){return X()(this,T),_.apply(this,arguments)}return i()(T,[{key:"getUninforms",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity,U=A.lineType,ie=U===void 0?"solid":U,de=A.dashArray,Be=de===void 0?[10,5,0,0]:de;return Be.length===2&&Be.push(0,0),{u_opacity:M||1,u_line_type:yl[ie],u_dash_array:Be}}},{key:"getAnimateUniforms",value:function(){var A=this.layer.getLayerConfig(),M=A.animateOption;return{u_aimate:this.animateOption2Array(M),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"line",vertexShader:Tu,fragmentShader:$i,triangulation:Ia,primitive:E.gl.TRIANGLES,blend:this.getBlend(),depth:{enable:!1}})]}},{key:"registerBuiltinAttributes",value:function(){var A=this.layer.getLayerConfig(),M=A.lineType,U=M===void 0?"solid":M;this.styleAttributeService.registerStyleAttribute({name:"distance",type:E.AttributeType.Attribute,descriptor:{name:"a_Distance",buffer:{usage:E.gl.STATIC_DRAW,data:[],type:E.gl.FLOAT},size:1,update:function(de,Be,zt,er){return[zt[3]]}}}),this.styleAttributeService.registerStyleAttribute({name:"total_distance",type:E.AttributeType.Attribute,descriptor:{name:"a_Total_Distance",buffer:{usage:E.gl.STATIC_DRAW,data:[],type:E.gl.FLOAT},size:1,update:function(de,Be,zt,er){return[zt[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:E.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:E.gl.DYNAMIC_DRAW,data:[],type:E.gl.FLOAT},size:2,update:function(de,Be,zt,er){var Mr=de.size,kr=Mr===void 0?1:Mr;return Array.isArray(kr)?[kr[0],kr[1]]:[kr,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:E.AttributeType.Attribute,descriptor:{name:"a_Normal",buffer:{usage:E.gl.STATIC_DRAW,data:[],type:E.gl.FLOAT},size:3,update:function(de,Be,zt,er,Mr){return Mr}}}),this.styleAttributeService.registerStyleAttribute({name:"miter",type:E.AttributeType.Attribute,descriptor:{name:"a_Miter",buffer:{usage:E.gl.STATIC_DRAW,data:[],type:E.gl.FLOAT},size:1,update:function(de,Be,zt,er){return[zt[4]]}}})}}]),T}(Et),Lc={arc:Ss,arc3d:Js,greatcircle:$c,line:os},vc=Lc;function Pl(h){var _=Ju();return function(){var x=Y()(h),A;if(_){var M=Y()(this).constructor;A=Reflect.construct(x,arguments,M)}else A=x.apply(this,arguments);return ee()(this,A)}}function Ju(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Rc=function(h){D()(T,h);var _=Pl(T);function T(){var x;X()(this,T);for(var A=arguments.length,M=new Array(A),U=0;U<A;U++)M[U]=arguments[U];return x=_.call.apply(_,[this].concat(M)),x.type="LineLayer",x}return i()(T,[{key:"buildModels",value:function(){var A=this.getModelType();this.layerModel=new vc[A](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getDefaultConfig",value:function(){var A=this.getModelType(),M={line:{},arc3d:{blend:"additive"},arc:{blend:"additive"},greatcircle:{blend:"additive"}};return M[A]}},{key:"getModelType",value:function(){var A,M=this.styleAttributeService.getLayerStyleAttribute("shape"),U=M==null||((A=M.scale)===null||A===void 0)?void 0:A.field;return U||"line"}}]),T}(ae);function hu(h){var _=_u();return function(){var x=Y()(h),A;if(_){var M=Y()(this).constructor;A=Reflect.construct(x,arguments,M)}else A=x.apply(this,arguments);return ee()(this,A)}}function _u(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Qc=`varying vec4 v_color;
uniform float u_opacity: 1.0;

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  gl_FragColor.a *= u_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,Yl=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec3 a_Position;
attribute vec3 a_Pos;
attribute vec4 a_Color;
attribute vec3 a_Size;
attribute vec3 a_Normal;

uniform mat4 u_ModelMatrix;
uniform vec2 u_offsets;
varying vec4 v_color;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  vec3 size = a_Size * a_Position;

  vec2 offset = project_pixel(size.xy);

  vec4 project_pos = project_position(vec4(a_Pos.xy, 0., 1.0));

  vec4 pos = vec4(project_pos.xy + offset, project_pixel(size.z), 1.0);

  float lightWeight = calc_lighting(pos);
  v_color =vec4(a_Color.rgb * lightWeight, a_Color.w);

  gl_Position = project_common_position_to_clipspace(pos);
  setPickingColor(a_PickingColor);
}
`,Si=function(h){D()(T,h);var _=hu(T);function T(){return X()(this,T),_.apply(this,arguments)}return i()(T,[{key:"getUninforms",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity,U=A.offsets;return{u_opacity:M||1,u_offsets:U||[0,0]}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"pointExtrude2",vertexShader:Yl,fragmentShader:Qc,triangulation:ga,blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:E.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:E.gl.DYNAMIC_DRAW,data:[],type:E.gl.FLOAT},size:3,update:function(M,U,ie,de){var Be=M.size;if(Be){var zt=[];return Array.isArray(Be)&&(zt=Be.length===2?[Be[0],Be[0],Be[1]]:Be),Array.isArray(Be)||(zt=[Be]),zt}else return[2,2,2]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:E.AttributeType.Attribute,descriptor:{name:"a_Normal",buffer:{usage:E.gl.STATIC_DRAW,data:[],type:E.gl.FLOAT},size:3,update:function(M,U,ie,de,Be){return Be}}}),this.styleAttributeService.registerStyleAttribute({name:"pos",type:E.AttributeType.Attribute,descriptor:{name:"a_Pos",buffer:{usage:E.gl.DYNAMIC_DRAW,data:[],type:E.gl.FLOAT},size:3,update:function(M,U){var ie=Ze(M.coordinates);return[ie[0],ie[1],0]}}})}}]),T}(Et);function qc(h){var _=df();return function(){var x=Y()(h),A;if(_){var M=Y()(this).constructor;A=Reflect.construct(x,arguments,M)}else A=x.apply(this,arguments);return ee()(this,A)}}function df(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Kl=`#define Animate 0.0

uniform float u_blur : 0;
uniform float u_opacity : 1;
uniform float u_stroke_width : 1;
uniform vec4 u_stroke_color : [0, 0, 0, 0];
uniform float u_stroke_opacity : 1;

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;
uniform float u_time;
uniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];

#pragma include "sdf_2d"
#pragma include "picking"

void main() {
  int shape = int(floor(v_data.w + 0.5));

  lowp float antialiasblur = v_data.z;
  float antialiased_blur = -max(u_blur, antialiasblur);
  float r = v_radius / (v_radius + u_stroke_width);

  float outer_df;
  float inner_df;
  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'
  if (shape == 0) {
    outer_df = sdCircle(v_data.xy, 1.0);
    inner_df = sdCircle(v_data.xy, r);
  } else if (shape == 1) {
    outer_df = sdEquilateralTriangle(1.1 * v_data.xy);
    inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);
  } else if (shape == 2) {
    outer_df = sdBox(v_data.xy, vec2(1.));
    inner_df = sdBox(v_data.xy, vec2(r));
  } else if (shape == 3) {
    outer_df = sdPentagon(v_data.xy, 0.8);
    inner_df = sdPentagon(v_data.xy, r * 0.8);
  } else if (shape == 4) {
    outer_df = sdHexagon(v_data.xy, 0.8);
    inner_df = sdHexagon(v_data.xy, r * 0.8);
  } else if (shape == 5) {
    outer_df = sdOctogon(v_data.xy, 1.0);
    inner_df = sdOctogon(v_data.xy, r);
  } else if (shape == 6) {
    outer_df = sdHexagram(v_data.xy, 0.52);
    inner_df = sdHexagram(v_data.xy, r * 0.52);
  } else if (shape == 7) {
    outer_df = sdRhombus(v_data.xy, vec2(1.0));
    inner_df = sdRhombus(v_data.xy, vec2(r));
  } else if (shape == 8) {
    outer_df = sdVesica(v_data.xy, 1.1, 0.8);
    inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);
  }

  float opacity_t = smoothstep(0.0, antialiased_blur, outer_df);
  float color_t = u_stroke_width < 0.01 ? 0.0 : smoothstep(
    antialiased_blur,
    0.0,
    inner_df
  );
  vec4 strokeColor = u_stroke_color == vec4(0) ? v_color : u_stroke_color;
  float PI = 3.14159;
  float N_RINGS = 3.0;
  float FREQ = 1.0;

  // gl_FragColor = v_color * color_t;
  // gl_FragColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), strokeColor * u_stroke_opacity, color_t);
  gl_FragColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), strokeColor * u_stroke_opacity, color_t);
  gl_FragColor.a = gl_FragColor.a * opacity_t;
  if(u_aimate.x == Animate) {
    float d = length(v_data.xy);
    float intensity = clamp(cos(d * PI), 0.0, 1.0) * clamp(cos(2.0 * PI * (d * 2.0 * u_aimate.z - u_aimate.y * u_time)), 0.0, 1.0);
    gl_FragColor = vec4(gl_FragColor.xyz, intensity);
  }

  gl_FragColor = filterColor(gl_FragColor);
}
`,Ic=`attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec2 a_Extrude;
attribute float a_Size;
attribute float a_Shape;
uniform mat4 u_ModelMatrix;

uniform float u_stroke_width : 2;
uniform vec2 u_offsets;

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;

#pragma include "projection"
#pragma include "picking"

void main() {
  // unpack color(vec2)
  v_color = a_Color;
  vec2 extrude = a_Extrude;

  float shape_type = a_Shape;

  float newSize = setPickingSize(a_Size);

  // radius(16-bit)
  v_radius = newSize;

  vec2 offset = project_pixel(extrude * (newSize + u_stroke_width) + u_offsets);
  vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0));

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));

  // TODO: billboard
  // anti-alias
  float antialiasblur = 1.0 / u_DevicePixelRatio / (newSize + u_stroke_width);

  // construct point coords
  v_data = vec4(extrude, antialiasblur,shape_type);

  setPickingColor(a_PickingColor);
}
`,$l=function(h){D()(T,h);var _=qc(T);function T(){return X()(this,T),_.apply(this,arguments)}return i()(T,[{key:"getUninforms",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity,U=M===void 0?1:M,ie=A.stroke,de=ie===void 0?"rgb(0,0,0,0)":ie,Be=A.strokeWidth,zt=Be===void 0?1:Be,er=A.strokeOpacity,Mr=er===void 0?1:er,kr=A.offsets,xn=kr===void 0?[0,0]:kr;return{u_opacity:U,u_stroke_width:zt,u_stroke_color:Object(Me.s)(de),u_stroke_opacity:Mr,u_offsets:[-xn[0],xn[1]]}}},{key:"getAnimateUniforms",value:function(){var A=this.layer.getLayerConfig(),M=A.animateOption;return{u_aimate:this.animateOption2Array(M),u_time:this.layer.getLayerAnimateTime()}}},{key:"getAttribute",value:function(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),Ga)}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"pointfill",vertexShader:Ic,fragmentShader:Kl,triangulation:Ga,depth:{enable:!1},blend:this.getBlend()})]}},{key:"animateOption2Array",value:function(A){return[A.enable?0:1,A.speed||1,A.rings||3,0]}},{key:"registerBuiltinAttributes",value:function(){var A=this;this.styleAttributeService.registerStyleAttribute({name:"extrude",type:E.AttributeType.Attribute,descriptor:{name:"a_Extrude",buffer:{usage:E.gl.DYNAMIC_DRAW,data:[],type:E.gl.FLOAT},size:2,update:function(U,ie,de,Be){var zt=[1,1,-1,1,-1,-1,1,-1],er=Be%4*2;return[zt[er],zt[er+1]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:E.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:E.gl.DYNAMIC_DRAW,data:[],type:E.gl.FLOAT},size:1,update:function(U,ie,de,Be){var zt=U.size,er=zt===void 0?5:zt;return Array.isArray(er)?[er[0]]:[er]}}}),this.styleAttributeService.registerStyleAttribute({name:"shape",type:E.AttributeType.Attribute,descriptor:{name:"a_Shape",buffer:{usage:E.gl.DYNAMIC_DRAW,data:[],type:E.gl.FLOAT},size:1,update:function(U,ie,de,Be){var zt=U.shape,er=zt===void 0?2:zt,Mr=A.layer.getLayerConfig().shape2d,kr=Mr.indexOf(er);return[kr]}}})}}]),T}(Et);function Qu(h){var _=Fu();return function(){var x=Y()(h),A;if(_){var M=Y()(this).constructor;A=Reflect.construct(x,arguments,M)}else A=x.apply(this,arguments);return ee()(this,A)}}function Fu(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var bl=`
uniform sampler2D u_texture;
varying vec4 v_color;
varying vec2 v_uv;
uniform vec2 u_textSize;
uniform float u_stroke_width : 1;
uniform vec4 u_stroke_color : [1, 1, 1, 1];
uniform float u_stroke_opacity : 1;
uniform float u_opacity : 1;

varying float v_size;
#pragma include "picking"
void main(){
vec2 pos= v_uv / u_textSize + gl_PointCoord / u_textSize * 64.;
vec2 fragmentPosition = 2.0*gl_PointCoord - 1.0;
float distance = length(fragmentPosition);
float distanceSqrd = distance * distance;
float radius = 1.;
float r = 1.0 - smoothstep(radius-(radius*0.01),
                         radius+(radius*0.01),
                         distanceSqrd);
  vec4 textureColor=texture2D(u_texture,pos);
  if(all(lessThan(v_color, vec4(1.0+0.00001))) && all(greaterThan(v_color, vec4(1.0-0.00001))) || v_color==vec4(1.0)){
        gl_FragColor= vec4(textureColor.xyz, textureColor.w);
  }else {
        gl_FragColor= step(0.01, textureColor.z) * v_color;
  }
  gl_FragColor.a =gl_FragColor.a * u_opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,Lo=`precision highp float;
attribute vec3 a_Position;
attribute vec4 a_Color;
attribute vec2 a_Uv;
attribute float a_Size;
varying vec4 v_color;
varying vec2 v_uv;
uniform mat4 u_ModelMatrix;
uniform float u_stroke_width : 1;
uniform vec2 u_offsets;
varying float v_size;

#pragma include "projection"
#pragma include "picking"

void main() {
   v_color = a_Color;
   v_uv = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   v_size = a_Size;
   vec2 offset = project_pixel(u_offsets);
   gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy + offset),project_pos.z, 1.0));
   gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;

  setPickingColor(a_PickingColor);

}
`,Jl=function(h){D()(T,h);var _=Qu(T);function T(){var x;X()(this,T);for(var A=arguments.length,M=new Array(A),U=0;U<A;U++)M[U]=arguments[U];return x=_.call.apply(_,[this].concat(M)),x.texture=void 0,x}return i()(T,[{key:"getUninforms",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity;return{u_opacity:M||1,u_texture:this.texture,u_textSize:[1024,this.iconService.canvasHeight||128]}}},{key:"initModels",value:function(){var A=this;return this.initIconFontGlyphs(),this.registerBuiltinAttributes(),this.updateTexture(),this.iconService.on("imageUpdate",function(){A.updateTexture(),A.layer.render()}),[this.layer.buildLayerModel({moduleName:"pointiconImage",vertexShader:Lo,fragmentShader:bl,triangulation:Ma,primitive:E.gl.POINTS,depth:{enable:!1},blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){var A=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:E.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:E.gl.DYNAMIC_DRAW,data:[],type:E.gl.FLOAT},size:1,update:function(U,ie,de,Be){var zt=U.size;return Array.isArray(zt)?[zt[0]]:[zt]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:E.AttributeType.Attribute,descriptor:{name:"a_Uv",buffer:{usage:E.gl.DYNAMIC_DRAW,data:[],type:E.gl.FLOAT},size:2,update:function(U,ie,de,Be){var zt=A.fontService.mapping,er=U.shape,Mr=A.fontService.getGlyph(er),kr=zt[Mr],xn=kr.x,yn=kr.y;return[xn,yn]}}})}},{key:"updateTexture",value:function(){var A=this.rendererService.createTexture2D,M=this.fontService.canvas;this.texture=A({data:M,mag:E.gl.LINEAR,min:E.gl.LINEAR,width:M.width,height:M.height})}},{key:"initIconFontGlyphs",value:function(){var A=this,M=this.layer.getLayerConfig(),U=M.fontWeight,ie=U===void 0?"normal":U,de=M.fontFamily,Be=de===void 0?"sans-serif":de,zt=this.layer.getEncodedData(),er=[];zt.forEach(function(Mr){var kr=Mr.shape,xn=kr===void 0?"":kr;xn=xn.toString();var yn=A.fontService.getGlyph(xn);er.indexOf(yn)===-1&&er.push(yn)}),this.fontService.setFontOptions({characterSet:er,fontWeight:ie,fontFamily:Be,fontSize:48})}}]),T}(Et);function Ll(h){var _=Rl();return function(){var x=Y()(h),A;if(_){var M=Y()(this).constructor;A=Reflect.construct(x,arguments,M)}else A=x.apply(this,arguments);return ee()(this,A)}}function Rl(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Dc=`
uniform sampler2D u_texture;
varying vec4 v_color;
varying vec2 v_uv;
uniform vec2 u_textSize;
uniform float u_stroke_width : 1;
uniform vec4 u_stroke_color : [1, 1, 1, 1];
uniform float u_stroke_opacity : 1;
uniform float u_opacity : 1;

varying float v_size;
#pragma include "picking"
void main(){
vec2 pos= v_uv / u_textSize + gl_PointCoord / u_textSize * 64.;
vec2 fragmentPosition = 2.0*gl_PointCoord - 1.0;
float distance = length(fragmentPosition);
float distanceSqrd = distance * distance;
float radius = 1.;
float r = 1.0 - smoothstep(radius-(radius*0.01),
                         radius+(radius*0.01),
                         distanceSqrd);
  vec4 textureColor=texture2D(u_texture,pos);
  if(all(lessThan(v_color, vec4(1.0+0.00001))) && all(greaterThan(v_color, vec4(1.0-0.00001))) || v_color==vec4(1.0)){
        gl_FragColor= vec4(textureColor.xyz, textureColor.w);
  }else {
        gl_FragColor= step(0.01, textureColor.z) * v_color;
  }
  gl_FragColor.a =gl_FragColor.a * u_opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,xl=`precision highp float;
attribute vec3 a_Position;
attribute vec4 a_Color;
attribute vec2 a_Uv;
attribute float a_Size;
varying vec4 v_color;
varying vec2 v_uv;
uniform mat4 u_ModelMatrix;
uniform float u_stroke_width : 1;
uniform vec2 u_offsets;
varying float v_size;

#pragma include "projection"
#pragma include "picking"

void main() {
   v_color = a_Color;
   v_uv = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   v_size = a_Size;
   vec2 offset = project_pixel(u_offsets);
   gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy + offset),project_pos.z, 1.0));
   gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;

  setPickingColor(a_PickingColor);

}
`,Qs=function(h){D()(T,h);var _=Ll(T);function T(){var x;X()(this,T);for(var A=arguments.length,M=new Array(A),U=0;U<A;U++)M[U]=arguments[U];return x=_.call.apply(_,[this].concat(M)),x.texture=void 0,x.updateTexture=function(){var ie=x.rendererService.createTexture2D;if(x.texture){x.texture.update({data:x.iconService.getCanvas()}),x.layer.render();return}x.texture=ie({data:x.iconService.getCanvas(),mag:E.gl.LINEAR,min:E.gl.LINEAR,width:1024,height:x.iconService.canvasHeight||128})},x}return i()(T,[{key:"getUninforms",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity,U=A.offsets,ie=U===void 0?[0,0]:U;return this.rendererService.getDirty()&&this.texture.bind(),{u_opacity:M||1,u_texture:this.texture,u_textSize:[1024,this.iconService.canvasHeight||128],u_offsets:[-ie[0],ie[1]]}}},{key:"initModels",value:function(){return this.registerBuiltinAttributes(),this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),this.buildModels()}},{key:"clearModels",value:function(){this.texture&&this.texture.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"pointImage",vertexShader:xl,fragmentShader:Dc,triangulation:Ma,primitive:E.gl.POINTS,depth:{enable:!1},blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){var A=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:E.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:E.gl.DYNAMIC_DRAW,data:[],type:E.gl.FLOAT},size:1,update:function(U,ie,de,Be){var zt=U.size,er=zt===void 0?5:zt;return Array.isArray(er)?[er[0]]:[er]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:E.AttributeType.Attribute,descriptor:{name:"a_Uv",buffer:{usage:E.gl.DYNAMIC_DRAW,data:[],type:E.gl.FLOAT},size:2,update:function(U,ie,de,Be){var zt=A.iconService.getIconMap(),er=U.shape,Mr=zt[er]||{x:0,y:0},kr=Mr.x,xn=Mr.y;return[kr,xn]}}})}}]),T}(Et);function eo(h){var _=pf();return function(){var x=Y()(h),A;if(_){var M=Y()(this).constructor;A=Reflect.construct(x,arguments,M)}else A=x.apply(this,arguments);return ee()(this,A)}}function pf(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var mf=`
uniform float u_opacity : 1;
uniform vec2 u_offsets;
varying vec4 v_color;

#pragma include "picking"
void main() {
  gl_FragColor = v_color;
  gl_FragColor.a =gl_FragColor.a * u_opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,El=`
attribute vec3 a_Position;
uniform mat4 u_ModelMatrix;
attribute float a_Size;
attribute vec4 a_Color;
varying vec4 v_color;

uniform vec2 u_offsets;

#pragma include "projection"
#pragma include "picking"
void main() {
  v_color = a_Color;
  vec2 offset = project_pixel(u_offsets);
  vec4 project_pos = project_position(vec4(a_Position, 1.0)) + vec4(a_Size / 2.,-a_Size /2.,0.,0.);
  gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy+offset),project_pos.z,project_pos.w));
  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;
    setPickingColor(a_PickingColor);
}
`;function Ql(h){var _=h.coordinates;return{vertices:Ht()(_),indices:[0],size:_.length}}var qu=function(h){D()(T,h);var _=eo(T);function T(){return X()(this,T),_.apply(this,arguments)}return i()(T,[{key:"getDefaultStyle",value:function(){return{blend:"additive"}}},{key:"getUninforms",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity,U=M===void 0?1:M,ie=A.stroke,de=ie===void 0?"rgb(0,0,0,0)":ie,Be=A.strokeWidth,zt=Be===void 0?1:Be,er=A.offsets,Mr=er===void 0?[0,0]:er;return{u_opacity:U,u_stroke_width:zt,u_stroke_color:Object(Me.s)(de),u_offsets:[-Mr[0],Mr[1]]}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"normalpoint",vertexShader:El,fragmentShader:mf,triangulation:Ql,depth:{enable:!1},primitive:E.gl.POINTS,blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:E.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:E.gl.DYNAMIC_DRAW,data:[],type:E.gl.FLOAT},size:1,update:function(M,U,ie,de){var Be=M.size,zt=Be===void 0?1:Be;return Array.isArray(zt)?[zt[0]]:[zt]}}})}},{key:"defaultStyleOptions",value:function(){return{blend:E.BlendType.additive}}}]),T}(Et);function Il(h,_){var T;if(typeof Symbol=="undefined"||h[Symbol.iterator]==null){if(Array.isArray(h)||(T=gc(h))||_&&h&&typeof h.length=="number"){T&&(h=T);var x=0,A=function(){};return{s:A,n:function(){return x>=h.length?{done:!0}:{done:!1,value:h[x++]}},e:function(Be){throw Be},f:A}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var M=!0,U=!1,ie;return{s:function(){T=h[Symbol.iterator]()},n:function(){var Be=T.next();return M=Be.done,Be},e:function(Be){U=!0,ie=Be},f:function(){try{!M&&T.return!=null&&T.return()}finally{if(U)throw ie}}}}function gc(h,_){if(!h)return;if(typeof h=="string")return yc(h,_);var T=Object.prototype.toString.call(h).slice(8,-1);if(T==="Object"&&h.constructor&&(T=h.constructor.name),T==="Map"||T==="Set")return Array.from(h);if(T==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(T))return yc(h,_)}function yc(h,_){(_==null||_>h.length)&&(_=h.length);for(var T=0,x=new Array(_);T<_;T++)x[T]=h[T];return x}var el=function(){function h(_,T,x){X()(this,h),this.boxCells=[],this.xCellCount=void 0,this.yCellCount=void 0,this.boxKeys=void 0,this.bboxes=void 0,this.width=void 0,this.height=void 0,this.xScale=void 0,this.yScale=void 0,this.boxUid=void 0;var A=this.boxCells;this.xCellCount=Math.ceil(_/x),this.yCellCount=Math.ceil(T/x);for(var M=0;M<this.xCellCount*this.yCellCount;M++)A.push([]);this.boxKeys=[],this.bboxes=[],this.width=_,this.height=T,this.xScale=this.xCellCount/_,this.yScale=this.yCellCount/T,this.boxUid=0}return i()(h,[{key:"insert",value:function(T,x,A,M,U){this.forEachCell(x,A,M,U,this.insertBoxCell,this.boxUid++),this.boxKeys.push(T),this.bboxes.push(x),this.bboxes.push(A),this.bboxes.push(M),this.bboxes.push(U)}},{key:"query",value:function(T,x,A,M,U){return this.queryHitTest(T,x,A,M,!1,U)}},{key:"hitTest",value:function(T,x,A,M,U){return this.queryHitTest(T,x,A,M,!0,U)}},{key:"insertBoxCell",value:function(T,x,A,M,U,ie){this.boxCells[U].push(ie)}},{key:"queryHitTest",value:function(T,x,A,M,U,ie){if(A<0||T>this.width||M<0||x>this.height)return U?!1:[];var de=[];if(T<=0&&x<=0&&this.width<=A&&this.height<=M){if(U)return!0;for(var Be=0;Be<this.boxKeys.length;Be++)de.push({key:this.boxKeys[Be],x1:this.bboxes[Be*4],y1:this.bboxes[Be*4+1],x2:this.bboxes[Be*4+2],y2:this.bboxes[Be*4+3]});return ie?de.filter(ie):de}var zt={hitTest:U,seenUids:{box:{},circle:{}}};return this.forEachCell(T,x,A,M,this.queryCell,de,zt,ie),U?de.length>0:de}},{key:"queryCell",value:function(T,x,A,M,U,ie,de,Be){var zt=de.seenUids,er=this.boxCells[U];if(er!==null){var Mr=this.bboxes,kr=Il(er),xn;try{for(kr.s();!(xn=kr.n()).done;){var yn=xn.value;if(!zt.box[yn]){zt.box[yn]=!0;var Fn=yn*4;if(T<=Mr[Fn+2]&&x<=Mr[Fn+3]&&A>=Mr[Fn+0]&&M>=Mr[Fn+1]&&(!Be||Be(this.boxKeys[yn]))){if(de.hitTest)return ie.push(!0),!0;ie.push({key:this.boxKeys[yn],x1:Mr[Fn],y1:Mr[Fn+1],x2:Mr[Fn+2],y2:Mr[Fn+3]})}}}}catch(Sa){kr.e(Sa)}finally{kr.f()}}return!1}},{key:"forEachCell",value:function(T,x,A,M,U,ie,de,Be){for(var zt=this.convertToXCellCoord(T),er=this.convertToYCellCoord(x),Mr=this.convertToXCellCoord(A),kr=this.convertToYCellCoord(M),xn=zt;xn<=Mr;xn++)for(var yn=er;yn<=kr;yn++){var Fn=this.xCellCount*yn+xn;if(U.call(this,T,x,A,M,Fn,ie,de,Be))return}}},{key:"convertToXCellCoord",value:function(T){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(T*this.xScale)))}},{key:"convertToYCellCoord",value:function(T){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(T*this.yScale)))}}]),h}(),ef=el,tl=function(){function h(_,T){X()(this,h),this.width=void 0,this.height=void 0,this.grid=void 0,this.viewportPadding=100,this.screenRightBoundary=void 0,this.screenBottomBoundary=void 0,this.gridRightBoundary=void 0,this.gridBottomBoundary=void 0,this.width=_,this.height=T,this.viewportPadding=Math.max(_,T),this.grid=new ef(_+this.viewportPadding,T+this.viewportPadding,25),this.screenRightBoundary=_+this.viewportPadding,this.screenBottomBoundary=T+this.viewportPadding,this.gridRightBoundary=_+2*this.viewportPadding,this.gridBottomBoundary=T+2*this.viewportPadding}return i()(h,[{key:"placeCollisionBox",value:function(T){var x=T.x1+T.anchorPointX+this.viewportPadding,A=T.y1+T.anchorPointY+this.viewportPadding,M=T.x2+T.anchorPointX+this.viewportPadding,U=T.y2+T.anchorPointY+this.viewportPadding;return!this.isInsideGrid(x,A,M,U)||this.grid.hitTest(x,A,M,U)?{box:[]}:{box:[x,A,M,U]}}},{key:"insertCollisionBox",value:function(T,x){var A={featureIndex:x};this.grid.insert(A,T[0],T[1],T[2],T[3])}},{key:"project",value:function(T,x,A){var M=yr.e.fromValues(x,A,0,1),U=yr.e.create(),ie=yr.b.fromValues.apply(yr.b,Ht()(T));return yr.e.transformMat4(U,M,ie),{x:(U[0]/U[3]+1)/2*this.width+this.viewportPadding,y:(-U[1]/U[3]+1)/2*this.height+this.viewportPadding}}},{key:"isInsideGrid",value:function(T,x,A,M){return A>=0&&T<this.gridRightBoundary&&M>=0&&x<this.gridBottomBoundary}}]),h}();function qs(h,_){var T;if(typeof Symbol=="undefined"||h[Symbol.iterator]==null){if(Array.isArray(h)||(T=Tl(h))||_&&h&&typeof h.length=="number"){T&&(h=T);var x=0,A=function(){};return{s:A,n:function(){return x>=h.length?{done:!0}:{done:!1,value:h[x++]}},e:function(Be){throw Be},f:A}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var M=!0,U=!1,ie;return{s:function(){T=h[Symbol.iterator]()},n:function(){var Be=T.next();return M=Be.done,Be},e:function(Be){U=!0,ie=Be},f:function(){try{!M&&T.return!=null&&T.return()}finally{if(U)throw ie}}}}function Tl(h,_){if(!h)return;if(typeof h=="string")return ql(h,_);var T=Object.prototype.toString.call(h).slice(8,-1);if(T==="Object"&&h.constructor&&(T=h.constructor.name),T==="Map"||T==="Set")return Array.from(h);if(T==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(T))return ql(h,_)}function ql(h,_){(_==null||_>h.length)&&(_=h.length);for(var T=0,x=new Array(_);T<_;T++)x[T]=h[T];return x}function Nc(h){var _=.5,T=.5;switch(h){case"right":case"top-right":case"bottom-right":_=1;break;case"left":case"top-left":case"bottom-left":_=0;break;default:_=.5}switch(h){case"bottom":case"bottom-right":case"bottom-left":T=1;break;case"top":case"top-right":case"top-left":T=0;break;default:T=.5}return{horizontalAlign:_,verticalAlign:T}}function tf(h,_,T,x,A){if(!A)return;var M=h[x],U=M.glyph;if(U)for(var ie=_[U].advance*M.scale,de=(h[x].x+ie)*A,Be=T;Be<=x;Be++)h[Be].x-=de}function zs(h,_,T,x,A,M,U){var ie=(_-T)*A,de=(-x*U+.5)*M,Be=qs(h),zt;try{for(Be.s();!(zt=Be.n()).done;){var er=zt.value;er.x+=ie,er.y+=de}}catch(Mr){Be.e(Mr)}finally{Be.f()}}function vf(h,_,T,x,A,M,U){var ie=-8,de=0,Be=ie,zt=0,er=h.positionedGlyphs,Mr=M==="right"?1:M==="left"?0:.5,kr=er.length;T.forEach(function(wa){if(wa.split("").forEach(function(oi){var si=_[oi],Qi=0;si&&(er.push({glyph:oi,x:de,y:Be+Qi,vertical:!1,scale:1,metrics:si}),de+=si.advance+U)}),er.length!==kr){var Ri=de-U;zt=Math.max(Ri,zt),tf(er,_,kr,er.length-1,Mr)}de=0,Be+=x});var xn=Nc(A),yn=xn.horizontalAlign,Fn=xn.verticalAlign;zs(er,Mr,yn,Fn,zt,x,T.length);var Sa=Be-ie;h.top+=-Fn*Sa,h.bottom=h.top+Sa,h.left+=-yn*zt,h.right=h.left+zt}function rl(h,_,T,x,A,M){var U=arguments.length>6&&arguments[6]!==void 0?arguments[6]:[0,0],ie=h.split(`
`),de=[],Be={positionedGlyphs:de,top:U[1],bottom:U[1],left:U[0],right:U[0],lineCount:ie.length,text:h};return vf(Be,_,ie,T,x,A,M),de.length?Be:!1}function Pi(h){var _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0],T=arguments.length>2?arguments[2]:void 0,x=h.positionedGlyphs,A=x===void 0?[]:x,M=[],U=qs(A),ie;try{for(U.s();!(ie=U.n()).done;){var de=ie.value,Be=de.metrics,zt=4,er=Be.advance*de.scale/2,Mr=T?[de.x+er,de.y]:[0,0],kr=T?[0,0]:[de.x+er+_[0],de.y+_[1]],xn=(0-zt)*de.scale-er+kr[0],yn=(0-zt)*de.scale+kr[1],Fn=xn+Be.width*de.scale,Sa=yn+Be.height*de.scale,wa={x:xn,y:yn},Ri={x:Fn,y:yn},oi={x:xn,y:Sa},si={x:Fn,y:Sa};M.push({tl:wa,tr:Ri,bl:oi,br:si,tex:Be,glyphOffset:Mr})}}catch(Qi){U.e(Qi)}finally{U.f()}return M}function nl(h,_){var T;if(typeof Symbol=="undefined"||h[Symbol.iterator]==null){if(Array.isArray(h)||(T=zu(h))||_&&h&&typeof h.length=="number"){T&&(h=T);var x=0,A=function(){};return{s:A,n:function(){return x>=h.length?{done:!0}:{done:!1,value:h[x++]}},e:function(Be){throw Be},f:A}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var M=!0,U=!1,ie;return{s:function(){T=h[Symbol.iterator]()},n:function(){var Be=T.next();return M=Be.done,Be},e:function(Be){U=!0,ie=Be},f:function(){try{!M&&T.return!=null&&T.return()}finally{if(U)throw ie}}}}function zu(h,_){if(!h)return;if(typeof h=="string")return fi(h,_);var T=Object.prototype.toString.call(h).slice(8,-1);if(T==="Object"&&h.constructor&&(T=h.constructor.name),T==="Map"||T==="Set")return Array.from(h);if(T==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(T))return fi(h,_)}function fi(h,_){(_==null||_>h.length)&&(_=h.length);for(var T=0,x=new Array(_);T<_;T++)x[T]=h[T];return x}function kn(h){var _=Li();return function(){var x=Y()(h),A;if(_){var M=Y()(this).constructor;A=Reflect.construct(x,arguments,M)}else A=x.apply(this,arguments);return ee()(this,A)}}function Li(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Ls=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 48.0
uniform sampler2D u_sdf_map;
uniform float u_gamma_scale : 0.5;
// uniform float u_font_size : 24.0;
uniform float u_opacity : 1.0;
uniform float u_stroke_opacity: 1.0;
uniform vec4 u_stroke : [0, 0, 0, 1];
uniform float u_strokeWidth : 2.0;
uniform float u_halo_blur : 0.5;
uniform float u_DevicePixelRatio;

varying vec4 v_color;
varying vec2 v_uv;
varying float v_gamma_scale;
varying float v_fontScale;

#pragma include "picking"
void main() {
  // get sdf from atlas
  float dist = texture2D(u_sdf_map, v_uv).a;

  // float fontScale = u_font_size / FONT_SIZE;

  lowp float buff = (6.0 - u_strokeWidth / v_fontScale) / SDF_PX;
  highp float gamma = (u_halo_blur * 1.19 / SDF_PX + EDGE_GAMMA) / (v_fontScale * u_gamma_scale) / 1.0;

  highp float gamma_scaled = gamma * v_gamma_scale;

  highp float alpha = smoothstep(buff - gamma_scaled, buff + gamma_scaled, dist);
  gl_FragColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), vec4(u_stroke.rgb, u_stroke.a * u_opacity), smoothstep(0., 0.5, 1. - dist));
  gl_FragColor.a= gl_FragColor.a * alpha;
  gl_FragColor = filterColor(gl_FragColor);
}
`,Dl=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 24.0
attribute vec3 a_Position;
attribute vec2 a_tex;
attribute vec2 a_textOffsets;
attribute vec4 a_Color;
attribute float a_Size;

uniform vec2 u_sdf_map_size;
uniform mat4 u_ModelMatrix;

varying vec2 v_uv;
varying float v_gamma_scale;
varying vec4 v_color;
varying float v_fontScale;

#pragma include "projection"
#pragma include "picking"

void main() {
  v_color = a_Color;
  v_uv = a_tex / u_sdf_map_size;

  // \u6587\u672C\u7F29\u653E\u6BD4\u4F8B
  float fontScale = a_Size / FONT_SIZE;
   v_fontScale = fontScale;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));

  vec4 projected_position  = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  gl_Position = vec4(projected_position.xy / projected_position.w
    + a_textOffsets * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);
  v_gamma_scale = gl_Position.w;
  setPickingColor(a_PickingColor);

}
`;function Uu(h){var _=this,T=h.id,x=[],A=[];if(!_.glyphInfoMap||!_.glyphInfoMap[T])return{vertices:[],indices:[],size:7};var M=_.glyphInfoMap[T].centroid,U=M.length===2?[M[0],M[1],0]:M;return _.glyphInfoMap[T].glyphQuads.forEach(function(ie,de){x.push.apply(x,Ht()(U).concat([ie.tex.x,ie.tex.y+ie.tex.height,ie.tl.x,ie.tl.y],Ht()(U),[ie.tex.x+ie.tex.width,ie.tex.y+ie.tex.height,ie.tr.x,ie.tr.y],Ht()(U),[ie.tex.x+ie.tex.width,ie.tex.y,ie.br.x,ie.br.y],Ht()(U),[ie.tex.x,ie.tex.y,ie.bl.x,ie.bl.y])),A.push(0+de*4,1+de*4,2+de*4,2+de*4,3+de*4,0+de*4)}),{vertices:x,indices:A,size:7}}var al=function(h){D()(T,h);var _=kn(T);function T(){var x;X()(this,T);for(var A=arguments.length,M=new Array(A),U=0;U<A;U++)M[U]=arguments[U];return x=_.call.apply(_,[this].concat(M)),x.glyphInfo=void 0,x.glyphInfoMap={},x.texture=void 0,x.currentZoom=-1,x.extent=void 0,x.textureHeight=0,x.textCount=0,x.preTextStyle={},x.buildModels=function(){return x.initGlyph(),x.updateTexture(),x.filterGlyphs(),[x.layer.buildLayerModel({moduleName:"pointText",vertexShader:Dl,fragmentShader:Ls,triangulation:Uu.bind(Ye()(x)),depth:{enable:!1},blend:x.getBlend()})]},x}return i()(T,[{key:"getUninforms",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity,U=M===void 0?1:M,ie=A.stroke,de=ie===void 0?"#fff":ie,Be=A.strokeWidth,zt=Be===void 0?0:Be,er=A.strokeOpacity,Mr=er===void 0?1:er,kr=A.textAnchor,xn=kr===void 0?"center":kr,yn=A.textAllowOverlap,Fn=yn===void 0?!1:yn,Sa=A.halo,wa=Sa===void 0?.5:Sa,Ri=A.gamma,oi=Ri===void 0?2:Ri,si=this.fontService,Qi=si.canvas,Oa=si.mapping;return Object.keys(Oa).length!==this.textCount&&(this.updateTexture(),this.textCount=Object.keys(Oa).length),this.preTextStyle={textAnchor:xn,textAllowOverlap:Fn},{u_opacity:U,u_stroke_opacity:Mr,u_sdf_map:this.texture,u_stroke:Object(Me.s)(de),u_halo_blur:wa,u_gamma_scale:oi,u_sdf_map_size:[Qi.width,Qi.height],u_strokeWidth:zt}}},{key:"initModels",value:function(){this.layer.on("remapping",this.buildModels),this.extent=this.textExtent();var A=this.layer.getLayerConfig(),M=A.textAnchor,U=M===void 0?"center":M,ie=A.textAllowOverlap,de=ie===void 0?!0:ie;return this.preTextStyle={textAnchor:U,textAllowOverlap:de},this.buildModels()}},{key:"needUpdate",value:function(){var A=this.layer.getLayerConfig(),M=A.textAllowOverlap,U=M===void 0?!1:M,ie=this.mapService.getZoom(),de=this.mapService.getBounds(),Be=Object(Me.j)(this.extent,de);return!U&&(Math.abs(this.currentZoom-ie)>1||!Be)||U!==this.preTextStyle.textAllowOverlap?(this.reBuildModel(),!0):!1}},{key:"clearModels",value:function(){this.layer.off("remapping",this.buildModels)}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"textOffsets",type:E.AttributeType.Attribute,descriptor:{name:"a_textOffsets",buffer:{usage:E.gl.STATIC_DRAW,data:[],type:E.gl.FLOAT},size:2,update:function(M,U,ie,de){return[ie[5],ie[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:E.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:E.gl.DYNAMIC_DRAW,data:[],type:E.gl.FLOAT},size:1,update:function(M,U,ie,de){var Be=M.size,zt=Be===void 0?12:Be;return Array.isArray(zt)?[zt[0]]:[zt]}}}),this.styleAttributeService.registerStyleAttribute({name:"textUv",type:E.AttributeType.Attribute,descriptor:{name:"a_tex",buffer:{usage:E.gl.DYNAMIC_DRAW,data:[],type:E.gl.FLOAT},size:2,update:function(M,U,ie,de){return[ie[3],ie[4]]}}})}},{key:"textExtent",value:function(){var A=this.mapService.getBounds();return Object(Me.r)(A,.5)}},{key:"initTextFont",value:function(){var A=this.layer.getLayerConfig(),M=A.fontWeight,U=M===void 0?"400":M,ie=A.fontFamily,de=ie===void 0?"sans-serif":ie,Be=this.layer.getEncodedData(),zt=[];Be.forEach(function(er){var Mr=er.shape,kr=Mr===void 0?"":Mr;kr=kr.toString();var xn=nl(kr),yn;try{for(xn.s();!(yn=xn.n()).done;){var Fn=yn.value;zt.indexOf(Fn)===-1&&zt.push(Fn)}}catch(Sa){xn.e(Sa)}finally{xn.f()}}),this.fontService.setFontOptions({characterSet:zt,fontWeight:U,fontFamily:de})}},{key:"generateGlyphLayout",value:function(){var A=this,M=this.fontService.mapping,U=this.layer.getLayerConfig(),ie=U.spacing,de=ie===void 0?2:ie,Be=U.textAnchor,zt=Be===void 0?"center":Be,er=U.textOffset,Mr=this.layer.getEncodedData();this.glyphInfo=Mr.map(function(kr){var xn=kr.shape,yn=xn===void 0?"":xn,Fn=kr.coordinates,Sa=kr.id,wa=kr.size,Ri=wa===void 0?1:wa,oi=rl(yn.toString(),M,Ri,zt,"center",de,er),si=Pi(oi,er,!1);return kr.shaping=oi,kr.glyphQuads=si,kr.centroid=Ze(Fn),A.glyphInfoMap[Sa]={shaping:oi,glyphQuads:si,centroid:Ze(Fn)},kr})}},{key:"filterGlyphs",value:function(){var A=this,M=this.layer.getLayerConfig(),U=M.padding,ie=U===void 0?[4,4]:U,de=M.textAllowOverlap,Be=de===void 0?!1:de;if(Be)return;this.glyphInfoMap={},this.currentZoom=this.mapService.getZoom(),this.extent=this.textExtent();var zt=this.rendererService.getViewportSize(),er=zt.width,Mr=zt.height,kr=new tl(er,Mr),xn=this.glyphInfo.filter(function(yn){var Fn=yn.shaping,Sa=yn.id,wa=Sa===void 0?0:Sa,Ri=yn.centroid,oi=yn.size,si=oi/24,Qi=A.mapService.lngLatToContainer(Ri),Oa=kr.placeCollisionBox({x1:Fn.left*si-ie[0],x2:Fn.right*si+ie[0],y1:Fn.top*si-ie[1],y2:Fn.bottom*si+ie[1],anchorPointX:Qi.x,anchorPointY:Qi.y}),qi=Oa.box;return qi&&qi.length?(kr.insertCollisionBox(qi,wa),!0):!1});xn.forEach(function(yn){A.glyphInfoMap[yn.id]=yn})}},{key:"initGlyph",value:function(){this.initTextFont(),this.generateGlyphLayout()}},{key:"updateTexture",value:function(){var A=this.rendererService.createTexture2D,M=this.fontService.canvas;this.textureHeight=M.height,this.texture&&this.texture.destroy(),this.texture=A({data:M,mag:E.gl.LINEAR,min:E.gl.LINEAR,width:M.width,height:M.height})}},{key:"reBuildModel",value:function(){this.filterGlyphs(),this.layer.models=[this.layer.buildLayerModel({moduleName:"pointText",vertexShader:Dl,fragmentShader:Ls,triangulation:Uu.bind(this),depth:{enable:!1},blend:this.getBlend()})]}}]),T}(Et),gf={fill:$l,image:Qs,normal:qu,extrude:Si,text:al,icon:Jl},ss=gf;function _l(h){var _=il();return function(){var x=Y()(h),A;if(_){var M=Y()(this).constructor;A=Reflect.construct(x,arguments,M)}else A=x.apply(this,arguments);return ee()(this,A)}}function il(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var ol=function(h){D()(T,h);var _=_l(T);function T(){var x;X()(this,T);for(var A=arguments.length,M=new Array(A),U=0;U<A;U++)M[U]=arguments[U];return x=_.call.apply(_,[this].concat(M)),x.type="PointLayer",x}return i()(T,[{key:"buildModels",value:function(){var A=this.getModelType();this.layerModel=new ss[A](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getDefaultConfig",value:function(){var A=this.getModelType(),M={normal:{blend:"additive"},fill:{blend:"normal"},extrude:{},image:{},icon:{},text:{blend:"normal"}};return M[A]}},{key:"getModelType",value:function(){var A=this.getEncodedData(),M=this.getLayerConfig(),U=M.shape2d,ie=M.shape3d,de=this.iconService.getIconMap(),Be=A.find(function(er){return er.hasOwnProperty("shape")});if(Be){var zt=Be.shape;return zt==="dot"?"normal":(U==null?void 0:U.indexOf(zt))!==-1?"fill":(ie==null?void 0:ie.indexOf(zt))!==-1?"extrude":de.hasOwnProperty(zt)?"image":this.fontService.getGlyph(zt)!==""?"icon":"text"}else return"normal"}}]),T}(ae);function Ui(h){var _=As();return function(){var x=Y()(h),A;if(_){var M=Y()(this).constructor;A=Reflect.construct(x,arguments,M)}else A=x.apply(this,arguments);return ee()(this,A)}}function As(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var Nl=`uniform float u_opacity: 1.0;
varying vec4 v_Color;

#pragma include "picking"

void main() {
  gl_FragColor = v_Color;
  gl_FragColor.a *= u_opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,to=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
uniform mat4 u_ModelMatrix;

varying vec4 v_Color;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  vec4 project_pos = project_position(pos);

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  float lightWeight = calc_lighting(pos);
  // v_Color = a_Color;
  v_Color = vec4(a_Color.rgb * lightWeight, a_Color.w);

  setPickingColor(a_PickingColor);
}
`,Rn=function(h){D()(T,h);var _=Ui(T);function T(){return X()(this,T),_.apply(this,arguments)}return i()(T,[{key:"getUninforms",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity,U=M===void 0?1:M;return{u_opacity:U}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"polygonExtrude",vertexShader:to,fragmentShader:Nl,triangulation:da})]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"normal",type:E.AttributeType.Attribute,descriptor:{name:"a_Normal",buffer:{usage:E.gl.STATIC_DRAW,data:[],type:E.gl.FLOAT},size:3,update:function(M,U,ie,de,Be){return Be}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:E.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:E.gl.DYNAMIC_DRAW,data:[],type:E.gl.FLOAT},size:1,update:function(M,U,ie,de){var Be=M.size,zt=Be===void 0?10:Be;return Array.isArray(zt)?[zt[0]]:[zt]}}})}}]),T}(Et);function Us(h){var _=ni();return function(){var x=Y()(h),A;if(_){var M=Y()(this).constructor;A=Reflect.construct(x,arguments,M)}else A=x.apply(this,arguments);return ee()(this,A)}}function ni(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var kl=`uniform float u_opacity: 1.0;
varying vec4 v_Color;

#pragma include "picking"

void main() {
  gl_FragColor = v_Color;
  gl_FragColor.a *= u_opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,du=`attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
uniform mat4 u_ModelMatrix;

varying vec4 v_Color;

#pragma include "projection"
#pragma include "picking"

void main() {
  v_Color = a_Color;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  setPickingColor(a_PickingColor);
}

`,Bs=function(h){D()(T,h);var _=Us(T);function T(){return X()(this,T),_.apply(this,arguments)}return i()(T,[{key:"getUninforms",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity,U=M===void 0?1:M;return{u_opacity:U}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"polygon",vertexShader:du,fragmentShader:kl,triangulation:Wi,blend:this.getBlend(),depth:{enable:!1}})]}},{key:"registerBuiltinAttributes",value:function(){}}]),T}(Et),sl={fill:Bs,line:os,extrude:Rn,text:al,point_fill:$l,point_image:Qs,point_normal:qu,point_extrude:Si},tn=sl;function bc(h){var _=us();return function(){var x=Y()(h),A;if(_){var M=Y()(this).constructor;A=Reflect.construct(x,arguments,M)}else A=x.apply(this,arguments);return ee()(this,A)}}function us(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var ro=function(h){D()(T,h);var _=bc(T);function T(){var x;X()(this,T);for(var A=arguments.length,M=new Array(A),U=0;U<A;U++)M[U]=arguments[U];return x=_.call.apply(_,[this].concat(M)),x.type="PolygonLayer",x}return i()(T,[{key:"buildModels",value:function(){var A=this.getModelType();this.layerModel=new tn[A](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getModelType",value:function(){var A,M=this.styleAttributeService.getLayerStyleAttribute("shape"),U=M==null||((A=M.scale)===null||A===void 0)?void 0:A.field;return U==="fill"?"fill":U==="extrude"?"extrude":U==="line"?"line":this.getPointModelType()}},{key:"getPointModelType",value:function(){var A=this.getEncodedData(),M=this.getLayerConfig(),U=M.shape2d,ie=M.shape3d,de=this.iconService.getIconMap(),Be=A.find(function(er){return er.hasOwnProperty("shape")});if(Be){var zt=Be.shape;return zt==="dot"?"point_normal":(U==null?void 0:U.indexOf(zt))!==-1?"point_fill":(ie==null?void 0:ie.indexOf(zt))!==-1?"point_extrude":de.hasOwnProperty(zt)?"point_image":"text"}else return"fill"}}]),T}(ae);function qo(h){var _=Rs();return function(){var x=Y()(h),A;if(_){var M=Y()(this).constructor;A=Reflect.construct(x,arguments,M)}else A=x.apply(this,arguments);return ee()(this,A)}}function Rs(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var jl=`precision mediump float;
uniform float u_opacity: 1.0;
uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;
uniform float u_min;
uniform float u_max;
uniform vec2 u_domain;
uniform float u_noDataValue;
uniform bool u_clampLow: true;
uniform bool u_clampHigh: true;
varying vec2 v_texCoord;

void main() {

  float value = texture2D(u_texture,vec2(v_texCoord.x,v_texCoord.y)).r;
  if (value == u_noDataValue)
    gl_FragColor = vec4(0.0, 0, 0, 0.0);
  else if ((!u_clampLow && value < u_domain[0]) || (!u_clampHigh && value > u_domain[1]))
    gl_FragColor = vec4(0, 0, 0, 0);
  else {
    float normalisedValue =(value - u_domain[0]) / (u_domain[1] -u_domain[0]);
    vec4 color = texture2D(u_colorTexture,vec2(normalisedValue, 0));
    gl_FragColor = color;
    gl_FragColor.a =  gl_FragColor.a * u_opacity ;
  }


}
`,kc=`precision highp float;
uniform mat4 u_ModelMatrix;
attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;
#pragma include "projection"
void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
}
`,Vs=function(h){D()(T,h);var _=qo(T);function T(){var x;X()(this,T);for(var A=arguments.length,M=new Array(A),U=0;U<A;U++)M[U]=arguments[U];return x=_.call.apply(_,[this].concat(M)),x.texture=void 0,x.colorTexture=void 0,x}return i()(T,[{key:"getUninforms",value:function(){var A=this.layer.getLayerConfig(),M=A.opacity,U=M===void 0?1:M,ie=A.clampLow,de=ie===void 0?!0:ie,Be=A.clampHigh,zt=Be===void 0?!0:Be,er=A.noDataValue,Mr=er===void 0?-9999999:er,kr=A.domain,xn=kr===void 0?[0,1]:kr;return this.updateColorTexure(),{u_opacity:U||1,u_texture:this.texture,u_domain:xn,u_clampLow:de,u_clampHigh:typeof zt!="undefined"?zt:de,u_noDataValue:Mr,u_colorTexture:this.colorTexture}}},{key:"initModels",value:function(){var A=this.layer.getSource(),M=this.rendererService.createTexture2D,U=A.data.dataArray[0];this.texture=M({data:U.data,width:U.width,height:U.height,format:E.gl.LUMINANCE,type:E.gl.FLOAT});var ie=this.layer.getLayerConfig(),de=ie.rampColors,Be=Object(Me.n)(de);return this.colorTexture=M({data:Be.data,width:Be.width,height:Be.height,flipY:!1}),[this.layer.buildLayerModel({moduleName:"RasterImageData",vertexShader:kc,fragmentShader:jl,triangulation:ya,primitive:E.gl.TRIANGLES,depth:{enable:!1},blend:this.getBlend()})]}},{key:"buildModels",value:function(){return this.initModels()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:E.AttributeType.Attribute,descriptor:{name:"a_Uv",buffer:{usage:E.gl.DYNAMIC_DRAW,data:[],type:E.gl.FLOAT},size:2,update:function(M,U,ie,de){return[ie[3],ie[4]]}}})}},{key:"updateColorTexure",value:function(){var A=this.rendererService.createTexture2D,M=this.layer.getLayerConfig(),U=M.rampColors,ie=Object(Me.n)(U);this.colorTexture=A({data:ie.data,width:ie.width,height:ie.height,flipY:!1})}}]),T}(Et),Su={raster:Vs,raster3d:Vs},Fl=Su;function zl(h){var _=rf();return function(){var x=Y()(h),A;if(_){var M=Y()(this).constructor;A=Reflect.construct(x,arguments,M)}else A=x.apply(this,arguments);return ee()(this,A)}}function rf(){if(typeof Reflect=="undefined"||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(h){return!1}}var jc=function(h){D()(T,h);var _=zl(T);function T(){var x;X()(this,T);for(var A=arguments.length,M=new Array(A),U=0;U<A;U++)M[U]=arguments[U];return x=_.call.apply(_,[this].concat(M)),x.type="RasterLayer",x}return i()(T,[{key:"buildModels",value:function(){var A=this.getModelType();this.layerModel=new Fl[A](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getDefaultConfig",value:function(){var A=this.getModelType(),M={raster:{},raster3d:{}};return M[A]}},{key:"getModelType",value:function(){return"raster"}}]),T}(ae),Ro,ls,Pa,eu,Io,So,Sl,ul;function pu(h,_){var T=Object.keys(h);if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(h);_&&(x=x.filter(function(A){return Object.getOwnPropertyDescriptor(h,A).enumerable})),T.push.apply(T,x)}return T}function Cs(h){for(var _=1;_<arguments.length;_++){var T=arguments[_]!=null?arguments[_]:{};_%2?pu(Object(T),!0).forEach(function(x){Se()(h,x,T[x])}):Object.getOwnPropertyDescriptors?Object.defineProperties(h,Object.getOwnPropertyDescriptors(T)):pu(Object(T)).forEach(function(x){Object.defineProperty(h,x,Object.getOwnPropertyDescriptor(T,x))})}return h}var xc=(Ro=Object(ur.injectable)(),ls=Object(ur.inject)(E.TYPES.IGlobalConfigService),Pa=Object(ur.inject)(E.TYPES.ILogService),Ro(eu=(Io=(ul=function(){function h(){X()(this,h),Le()(this,"configService",So,this),Le()(this,"logger",Sl,this)}return i()(h,[{key:"apply",value:function(T,x){var A=this,M=x.styleAttributeService;T.hooks.init.tap("DataMappingPlugin",function(){A.generateMaping(T,{styleAttributeService:M})}),T.hooks.beforeRenderData.tap("DataMappingPlugin",function(){return T.dataState.dataMappingNeedUpdate=!1,A.generateMaping(T,{styleAttributeService:M}),!0}),T.hooks.beforeRender.tap("DataMappingPlugin",function(){if(T.layerModelNeedUpdate)return;var U=M.getLayerStyleAttributes()||[],ie=M.getLayerStyleAttribute("filter"),de=T.getSource().data.dataArray,Be=U.filter(function(er){return er.needRemapping}),zt=de;(ie==null?void 0:ie.needRemapping)&&(ie==null?void 0:ie.scale)&&(zt=de.filter(function(er){return A.applyAttributeMapping(ie,er)[0]})),Be.length&&((ie==null?void 0:ie.needRemapping)?(T.setEncodedData(A.mapping(U,zt)),ie.needRemapping=!1):T.setEncodedData(A.mapping(Be,zt,T.getEncodedData())),A.logger.debug("remapping finished"),T.emit("remapping",null))})}},{key:"generateMaping",value:function(T,x){var A=this,M=x.styleAttributeService,U=M.getLayerStyleAttributes()||[],ie=M.getLayerStyleAttribute("filter"),de=T.getSource().data.dataArray,Be=de;(ie==null?void 0:ie.scale)&&(Be=de.filter(function(zt){return A.applyAttributeMapping(ie,zt)[0]})),T.setEncodedData(this.mapping(U,Be))}},{key:"mapping",value:function(T,x,A){var M=this;return x.map(function(U,ie){var de=A?A[ie]:{},Be=Cs({id:U._id,coordinates:U.coordinates},de);return T.filter(function(zt){return zt.scale!==void 0}).forEach(function(zt){var er=M.applyAttributeMapping(zt,U);zt.needRemapping=!1,zt.name==="color"&&(er=er.map(function(Mr){return Object(Me.s)(Mr)})),Be[zt.name]=Array.isArray(er)&&er.length===1?er[0]:er}),Be})}},{key:"applyAttributeMapping",value:function(T,x){var A;if(!T.scale)return[];var M=(T==null||((A=T.scale)===null||A===void 0)?void 0:A.scalers)||[],U=[];return M.forEach(function(ie){var de,Be=ie.field;(x.hasOwnProperty(Be)||((de=T.scale)===null||de===void 0?void 0:de.type)==="variable")&&U.push(x[Be])}),T.mapping?T.mapping(U):[]}}]),h}(),ul),So=Je()(Io.prototype,"configService",[ls],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Sl=Je()(Io.prototype,"logger",[Pa],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Io))||eu),Jn=o("rlAn"),jn,Ec,cs,Do=(jn=Object(ur.injectable)(),jn(Ec=(cs=function(){function h(){X()(this,h),this.mapService=void 0}return i()(h,[{key:"apply",value:function(T){var x=this;this.mapService=T.getContainer().get(E.TYPES.IMapService),T.hooks.init.tap("DataSourcePlugin",function(){var A=T.sourceOption,M=A.data,U=A.options;T.setSource(new Jn.default(M,U)),x.updateClusterData(T)}),T.hooks.beforeRenderData.tap("DataSourcePlugin",function(){var A=x.updateClusterData(T),M=T.dataState.dataSourceNeedUpdate;return T.dataState.dataSourceNeedUpdate=!1,A||M})}},{key:"updateClusterData",value:function(T){var x=T.getSource(),A=x.cluster,M=x.clusterOptions,U=M.zoom,ie=U===void 0?0:U,de=M.maxZoom,Be=de===void 0?16:de,zt=this.mapService.getZoom()-1;return A&&Math.abs(ie-zt)>1&&Be>ie?(x.updateClusterData(Math.floor(zt)),!0):!1}}]),h}(),cs))||Ec),vo=o("7tbW"),ws=o.n(vo),Au=o("4qC0"),ec=o.n(Au),$a=o("J2iB"),no=o.n($a),ll=function(h,_){return h<_?-1:h>_?1:h>=_?0:NaN},mu=function(h){return h.length===1&&(h=cl(h)),{left:function(T,x,A,M){for(A==null&&(A=0),M==null&&(M=T.length);A<M;){var U=A+M>>>1;h(T[U],x)<0?A=U+1:M=U}return A},right:function(T,x,A,M){for(A==null&&(A=0),M==null&&(M=T.length);A<M;){var U=A+M>>>1;h(T[U],x)>0?M=U:A=U+1}return A}}};function cl(h){return function(_,T){return ll(h(_),T)}}var Cu=mu(ll),Is=Cu.right,Fc=Cu.left,Gs=Is,yf=function(h,_){_==null&&(_=Ul);for(var T=0,x=h.length-1,A=h[0],M=new Array(x<0?0:x);T<x;)M[T]=_(A,A=h[++T]);return M};function Ul(h,_){return[h,_]}var Bl=function(h,_,T){var x=h.length,A=_.length,M=new Array(x*A),U,ie,de,Be;for(T==null&&(T=Ul),U=de=0;U<x;++U)for(Be=h[U],ie=0;ie<A;++ie,++de)M[de]=T(Be,_[ie]);return M},Tc=function(h,_){return _<h?-1:_>h?1:_>=h?0:NaN},fs=function(h){return h===null?NaN:+h},Bu=function(h,_){var T=h.length,x=0,A=-1,M=0,U,ie,de=0;if(_==null)for(;++A<T;)isNaN(U=fs(h[A]))||(ie=U-M,M+=ie/++x,de+=ie*(U-M));else for(;++A<T;)isNaN(U=fs(_(h[A],A,h)))||(ie=U-M,M+=ie/++x,de+=ie*(U-M));if(x>1)return de/(x-1)},zc=function(h,_){var T=Bu(h,_);return T&&Math.sqrt(T)},Al=function(h,_){var T=h.length,x=-1,A,M,U;if(_==null){for(;++x<T;)if((A=h[x])!=null&&A>=A)for(M=U=A;++x<T;)(A=h[x])!=null&&(M>A&&(M=A),U<A&&(U=A))}else for(;++x<T;)if((A=_(h[x],x,h))!=null&&A>=A)for(M=U=A;++x<T;)(A=_(h[x],x,h))!=null&&(M>A&&(M=A),U<A&&(U=A));return[M,U]},Vu=Array.prototype,tc=Vu.slice,Gu=Vu.map,Ds=function(h){return function(){return h}},nf=function(h){return h},rc=function(h,_,T){h=+h,_=+_,T=(A=arguments.length)<2?(_=h,h=0,1):A<3?1:+T;for(var x=-1,A=Math.max(0,Math.ceil((_-h)/T))|0,M=new Array(A);++x<A;)M[x]=h+x*T;return M},nc=Math.sqrt(50),ac=Math.sqrt(10),s=Math.sqrt(2),a=function(h,_,T){var x,A=-1,M,U,ie;if(_=+_,h=+h,T=+T,h===_&&T>0)return[h];if((x=_<h)&&(M=h,h=_,_=M),(ie=n(h,_,T))===0||!isFinite(ie))return[];if(ie>0)for(h=Math.ceil(h/ie),_=Math.floor(_/ie),U=new Array(M=Math.ceil(_-h+1));++A<M;)U[A]=(h+A)*ie;else for(h=Math.floor(h*ie),_=Math.ceil(_*ie),U=new Array(M=Math.ceil(h-_+1));++A<M;)U[A]=(h-A)/ie;return x&&U.reverse(),U};function n(h,_,T){var x=(_-h)/Math.max(0,T),A=Math.floor(Math.log(x)/Math.LN10),M=x/Math.pow(10,A);return A>=0?(M>=nc?10:M>=ac?5:M>=s?2:1)*Math.pow(10,A):-Math.pow(10,-A)/(M>=nc?10:M>=ac?5:M>=s?2:1)}function l(h,_,T){var x=Math.abs(_-h)/Math.max(0,T),A=Math.pow(10,Math.floor(Math.log(x)/Math.LN10)),M=x/A;return M>=nc?A*=10:M>=ac?A*=5:M>=s&&(A*=2),_<h?-A:A}var v=function(h){return Math.ceil(Math.log(h.length)/Math.LN2)+1},O=function(){var h=nf,_=Al,T=v;function x(A){var M,U=A.length,ie,de=new Array(U);for(M=0;M<U;++M)de[M]=h(A[M],M,A);var Be=_(de),zt=Be[0],er=Be[1],Mr=T(de,zt,er);Array.isArray(Mr)||(Mr=l(zt,er,Mr),Mr=rc(Math.ceil(zt/Mr)*Mr,er,Mr));for(var kr=Mr.length;Mr[0]<=zt;)Mr.shift(),--kr;for(;Mr[kr-1]>er;)Mr.pop(),--kr;var xn=new Array(kr+1),yn;for(M=0;M<=kr;++M)yn=xn[M]=[],yn.x0=M>0?Mr[M-1]:zt,yn.x1=M<kr?Mr[M]:er;for(M=0;M<U;++M)ie=de[M],zt<=ie&&ie<=er&&xn[Gs(Mr,ie,0,kr)].push(A[M]);return xn}return x.value=function(A){return arguments.length?(h=typeof A=="function"?A:Ds(A),x):h},x.domain=function(A){return arguments.length?(_=typeof A=="function"?A:Ds([A[0],A[1]]),x):_},x.thresholds=function(A){return arguments.length?(T=typeof A=="function"?A:Array.isArray(A)?Ds(tc.call(A)):Ds(A),x):T},x},L=function(h,_,T){if(T==null&&(T=fs),!(x=h.length))return;if((_=+_)<=0||x<2)return+T(h[0],0,h);if(_>=1)return+T(h[x-1],x-1,h);var x,A=(x-1)*_,M=Math.floor(A),U=+T(h[M],M,h),ie=+T(h[M+1],M+1,h);return U+(ie-U)*(A-M)},j=function(h,_,T){return h=Gu.call(h,fs).sort(ll),Math.ceil((T-_)/(2*(L(h,.75)-L(h,.25))*Math.pow(h.length,-1/3)))},ue=function(h,_,T){return Math.ceil((T-_)/(3.5*zc(h)*Math.pow(h.length,-1/3)))},Ee=function(h,_){var T=h.length,x=-1,A,M;if(_==null){for(;++x<T;)if((A=h[x])!=null&&A>=A)for(M=A;++x<T;)(A=h[x])!=null&&A>M&&(M=A)}else for(;++x<T;)if((A=_(h[x],x,h))!=null&&A>=A)for(M=A;++x<T;)(A=_(h[x],x,h))!=null&&A>M&&(M=A);return M},$e=function(h,_){var T=h.length,x=T,A=-1,M,U=0;if(_==null)for(;++A<T;)isNaN(M=fs(h[A]))?--x:U+=M;else for(;++A<T;)isNaN(M=fs(_(h[A],A,h)))?--x:U+=M;if(x)return U/x},nt=function(h,_){var T=h.length,x=-1,A,M=[];if(_==null)for(;++x<T;)isNaN(A=fs(h[x]))||M.push(A);else for(;++x<T;)isNaN(A=fs(_(h[x],x,h)))||M.push(A);return L(M.sort(ll),.5)},at=function(h){for(var _=h.length,T,x=-1,A=0,M,U;++x<_;)A+=h[x].length;for(M=new Array(A);--_>=0;)for(U=h[_],T=U.length;--T>=0;)M[--A]=U[T];return M},Ft=function(h,_){var T=h.length,x=-1,A,M;if(_==null){for(;++x<T;)if((A=h[x])!=null&&A>=A)for(M=A;++x<T;)(A=h[x])!=null&&M>A&&(M=A)}else for(;++x<T;)if((A=_(h[x],x,h))!=null&&A>=A)for(M=A;++x<T;)(A=_(h[x],x,h))!=null&&M>A&&(M=A);return M},Nt=function(h,_){for(var T=_.length,x=new Array(T);T--;)x[T]=h[_[T]];return x},Jt=function(h,_){if(!(T=h.length))return;var T,x=0,A=0,M,U=h[A];for(_==null&&(_=ll);++x<T;)(_(M=h[x],U)<0||_(U,U)!==0)&&(U=M,A=x);if(_(U,U)===0)return A},jt=function(h,_,T){for(var x=(T==null?h.length:T)-(_=_==null?0:+_),A,M;x;)M=Math.random()*x--|0,A=h[x+_],h[x+_]=h[M+_],h[M+_]=A;return h},Gt=function(h,_){var T=h.length,x=-1,A,M=0;if(_==null)for(;++x<T;)(A=+h[x])&&(M+=A);else for(;++x<T;)(A=+_(h[x],x,h))&&(M+=A);return M},ar=function(h){if(!(M=h.length))return[];for(var _=-1,T=Ft(h,nr),x=new Array(T);++_<T;)for(var A=-1,M,U=x[_]=new Array(M);++A<M;)U[A]=h[A][_];return x};function nr(h){return h.length}var Rr=function(){return ar(arguments)};function gr(h,_){switch(arguments.length){case 0:break;case 1:this.range(h);break;default:this.range(_).domain(h);break}return this}function Ar(h,_){switch(arguments.length){case 0:break;case 1:this.interpolator(h);break;default:this.interpolator(_).domain(h);break}return this}var Cr="$";function an(){}an.prototype=Yr.prototype={constructor:an,has:function(_){return Cr+_ in this},get:function(_){return this[Cr+_]},set:function(_,T){return this[Cr+_]=T,this},remove:function(_){var T=Cr+_;return T in this&&delete this[T]},clear:function(){for(var _ in this)_[0]===Cr&&delete this[_]},keys:function(){var _=[];for(var T in this)T[0]===Cr&&_.push(T.slice(1));return _},values:function(){var _=[];for(var T in this)T[0]===Cr&&_.push(this[T]);return _},entries:function(){var _=[];for(var T in this)T[0]===Cr&&_.push({key:T.slice(1),value:this[T]});return _},size:function(){var _=0;for(var T in this)T[0]===Cr&&++_;return _},empty:function(){for(var _ in this)if(_[0]===Cr)return!1;return!0},each:function(_){for(var T in this)T[0]===Cr&&_(this[T],T.slice(1),this)}};function Yr(h,_){var T=new an;if(h instanceof an)h.each(function(ie,de){T.set(de,ie)});else if(Array.isArray(h)){var x=-1,A=h.length,M;if(_==null)for(;++x<A;)T.set(x,h[x]);else for(;++x<A;)T.set(_(M=h[x],x,h),M)}else if(h)for(var U in h)T.set(U,h[U]);return T}var vn=Yr,Pn=function(){var h=[],_=[],T,x,A;function M(ie,de,Be,zt){if(de>=h.length)return T!=null&&ie.sort(T),x!=null?x(ie):ie;for(var er=-1,Mr=ie.length,kr=h[de++],xn,yn,Fn=vn(),Sa,wa=Be();++er<Mr;)(Sa=Fn.get(xn=kr(yn=ie[er])+""))?Sa.push(yn):Fn.set(xn,[yn]);return Fn.each(function(Ri,oi){zt(wa,oi,M(Ri,de,Be,zt))}),wa}function U(ie,de){if(++de>h.length)return ie;var Be,zt=_[de-1];return x!=null&&de>=h.length?Be=ie.entries():(Be=[],ie.each(function(er,Mr){Be.push({key:Mr,values:U(er,de)})})),zt!=null?Be.sort(function(er,Mr){return zt(er.key,Mr.key)}):Be}return A={object:function(de){return M(de,0,qn,sa)},map:function(de){return M(de,0,Aa,Wa)},entries:function(de){return U(M(de,0,Aa,Wa),0)},key:function(de){return h.push(de),A},sortKeys:function(de){return _[h.length-1]=de,A},sortValues:function(de){return T=de,A},rollup:function(de){return x=de,A}}};function qn(){return{}}function sa(h,_,T){h[_]=T}function Aa(){return vn()}function Wa(h,_,T){h.set(_,T)}function _n(){}var ua=vn.prototype;_n.prototype=xa.prototype={constructor:_n,has:ua.has,add:function(_){return _+="",this[Cr+_]=_,this},remove:ua.remove,clear:ua.clear,values:ua.keys,size:ua.size,empty:ua.empty,each:ua.each};function xa(h,_){var T=new _n;if(h instanceof _n)h.each(function(M){T.add(M)});else if(h){var x=-1,A=h.length;if(_==null)for(;++x<A;)T.add(h[x]);else for(;++x<A;)T.add(_(h[x],x,h))}return T}var Zn=xa,Ca=function(h){var _=[];for(var T in h)_.push(T);return _},ia=function(h){var _=[];for(var T in h)_.push(h[T]);return _},La=function(h){var _=[];for(var T in h)_.push({key:T,value:h[T]});return _},za=Array.prototype,Hi=za.map,Ai=za.slice,Ni={name:"implicit"};function Ei(){var h=vn(),_=[],T=[],x=Ni;function A(M){var U=M+"",ie=h.get(U);if(!ie){if(x!==Ni)return x;h.set(U,ie=_.push(M))}return T[(ie-1)%T.length]}return A.domain=function(M){if(!arguments.length)return _.slice();_=[],h=vn();for(var U=-1,ie=M.length,de,Be;++U<ie;)h.has(Be=(de=M[U])+"")||h.set(Be,_.push(de));return A},A.range=function(M){return arguments.length?(T=Ai.call(M),A):T.slice()},A.unknown=function(M){return arguments.length?(x=M,A):x},A.copy=function(){return Ei(_,T).unknown(x)},gr.apply(A,arguments),A}function Bi(){var h=Ei().unknown(void 0),_=h.domain,T=h.range,x=[0,1],A,M,U=!1,ie=0,de=0,Be=.5;delete h.unknown;function zt(){var er=_().length,Mr=x[1]<x[0],kr=x[Mr-0],xn=x[1-Mr];A=(xn-kr)/Math.max(1,er-ie+de*2),U&&(A=Math.floor(A)),kr+=(xn-kr-A*(er-ie))*Be,M=A*(1-ie),U&&(kr=Math.round(kr),M=Math.round(M));var yn=rc(er).map(function(Fn){return kr+A*Fn});return T(Mr?yn.reverse():yn)}return h.domain=function(er){return arguments.length?(_(er),zt()):_()},h.range=function(er){return arguments.length?(x=[+er[0],+er[1]],zt()):x.slice()},h.rangeRound=function(er){return x=[+er[0],+er[1]],U=!0,zt()},h.bandwidth=function(){return M},h.step=function(){return A},h.round=function(er){return arguments.length?(U=!!er,zt()):U},h.padding=function(er){return arguments.length?(ie=Math.min(1,de=+er),zt()):ie},h.paddingInner=function(er){return arguments.length?(ie=Math.min(1,er),zt()):ie},h.paddingOuter=function(er){return arguments.length?(de=+er,zt()):de},h.align=function(er){return arguments.length?(Be=Math.max(0,Math.min(1,er)),zt()):Be},h.copy=function(){return Bi(_(),x).round(U).paddingInner(ie).paddingOuter(de).align(Be)},gr.apply(zt(),arguments)}function es(h){var _=h.copy;return h.padding=h.paddingOuter,delete h.paddingInner,delete h.paddingOuter,h.copy=function(){return es(_())},h}function ts(){return es(Bi.apply(null,arguments).paddingInner(1))}var vu=o("FmoU");function wu(h,_,T,x,A){var M=h*h,U=M*h;return((1-3*h+3*M-U)*_+(4-6*M+3*U)*T+(1+3*h+3*M-3*U)*x+U*A)/6}var hs=function(h){var _=h.length-1;return function(T){var x=T<=0?T=0:T>=1?(T=1,_-1):Math.floor(T*_),A=h[x],M=h[x+1],U=x>0?h[x-1]:2*A-M,ie=x<_-1?h[x+2]:2*M-A;return wu((T-x/_)*_,U,A,M,ie)}},Hs=function(h){var _=h.length;return function(T){var x=Math.floor(((T%=1)<0?++T:T)*_),A=h[(x+_-1)%_],M=h[x%_],U=h[(x+1)%_],ie=h[(x+2)%_];return wu((T-x/_)*_,A,M,U,ie)}},Ou=function(h){return function(){return h}};function ic(h,_){return function(T){return h+T*_}}function tu(h,_,T){return h=Math.pow(h,T),_=Math.pow(_,T)-h,T=1/T,function(x){return Math.pow(h+x*_,T)}}function Hu(h,_){var T=_-h;return T?ic(h,T>180||T<-180?T-360*Math.round(T/360):T):Ou(isNaN(h)?_:h)}function oc(h){return(h=+h)===1?ru:function(_,T){return T-_?tu(_,T,h):Ou(isNaN(_)?T:_)}}function ru(h,_){var T=_-h;return T?ic(h,T):Ou(isNaN(h)?_:h)}var Mu=function h(_){var T=oc(_);function x(A,M){var U=T((A=Object(vu.b)(A)).r,(M=Object(vu.b)(M)).r),ie=T(A.g,M.g),de=T(A.b,M.b),Be=ru(A.opacity,M.opacity);return function(zt){return A.r=U(zt),A.g=ie(zt),A.b=de(zt),A.opacity=Be(zt),A+""}}return x.gamma=h,x}(1);function ds(h){return function(_){var T=_.length,x=new Array(T),A=new Array(T),M=new Array(T),U,ie;for(U=0;U<T;++U)ie=Object(vu.b)(_[U]),x[U]=ie.r||0,A[U]=ie.g||0,M[U]=ie.b||0;return x=h(x),A=h(A),M=h(M),ie.opacity=1,function(de){return ie.r=x(de),ie.g=A(de),ie.b=M(de),ie+""}}}var ao=ds(hs),Zu=ds(Hs),Vl=function(h,_){_||(_=[]);var T=h?Math.min(_.length,h.length):0,x=_.slice(),A;return function(M){for(A=0;A<T;++A)x[A]=h[A]*(1-M)+_[A]*M;return x}};function ps(h){return ArrayBuffer.isView(h)&&!(h instanceof DataView)}var No=function(h,_){return(ps(_)?Vl:ko)(h,_)};function ko(h,_){var T=_?_.length:0,x=h?Math.min(T,h.length):0,A=new Array(x),M=new Array(T),U;for(U=0;U<x;++U)A[U]=sc(h[U],_[U]);for(;U<T;++U)M[U]=_[U];return function(ie){for(U=0;U<x;++U)M[U]=A[U](ie);return M}}var Ko=function(h,_){var T=new Date;return h=+h,_=+_,function(x){return T.setTime(h*(1-x)+_*x),T}},Ao=function(h,_){return h=+h,_=+_,function(T){return h*(1-T)+_*T}},uo=function(h,_){var T={},x={},A;(h===null||typeof h!="object")&&(h={}),(_===null||typeof _!="object")&&(_={});for(A in _)A in h?T[A]=sc(h[A],_[A]):x[A]=_[A];return function(M){for(A in T)x[A]=T[A](M);return x}},Ns=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,nu=new RegExp(Ns.source,"g");function Gl(h){return function(){return h}}function Uc(h){return function(_){return h(_)+""}}var fl=function(h,_){var T=Ns.lastIndex=nu.lastIndex=0,x,A,M,U=-1,ie=[],de=[];for(h=h+"",_=_+"";(x=Ns.exec(h))&&(A=nu.exec(_));)(M=A.index)>T&&(M=_.slice(T,M),ie[U]?ie[U]+=M:ie[++U]=M),(x=x[0])===(A=A[0])?ie[U]?ie[U]+=A:ie[++U]=A:(ie[++U]=null,de.push({i:U,x:Ao(x,A)})),T=nu.lastIndex;return T<_.length&&(M=_.slice(T),ie[U]?ie[U]+=M:ie[++U]=M),ie.length<2?de[0]?Uc(de[0].x):Gl(_):(_=de.length,function(Be){for(var zt=0,er;zt<_;++zt)ie[(er=de[zt]).i]=er.x(Be);return ie.join("")})},sc=function(h,_){var T=typeof _,x;return _==null||T==="boolean"?Ou(_):(T==="number"?Ao:T==="string"?(x=Object(vu.a)(_))?(_=x,Mu):fl:_ instanceof vu.a?Mu:_ instanceof Date?Ko:ps(_)?Vl:Array.isArray(_)?ko:typeof _.valueOf!="function"&&typeof _.toString!="function"||isNaN(_)?uo:Ao)(h,_)},hl=function(h,_){return h=+h,_=+_,function(T){return Math.round(h*(1-T)+_*T)}},ks=function(h){return function(){return h}},go=function(h){return+h},_c=[0,1];function ms(h){return h}function af(h,_){return(_-=h=+h)?function(T){return(T-h)/_}:ks(isNaN(_)?NaN:.5)}function Sf(h){var _=h[0],T=h[h.length-1],x;return _>T&&(x=_,_=T,T=x),function(A){return Math.max(_,Math.min(T,A))}}function Af(h,_,T){var x=h[0],A=h[1],M=_[0],U=_[1];return A<x?(x=af(A,x),M=T(U,M)):(x=af(x,A),M=T(M,U)),function(ie){return M(x(ie))}}function Sc(h,_,T){var x=Math.min(h.length,_.length)-1,A=new Array(x),M=new Array(x),U=-1;for(h[x]<h[0]&&(h=h.slice().reverse(),_=_.slice().reverse());++U<x;)A[U]=af(h[U],h[U+1]),M[U]=T(_[U],_[U+1]);return function(ie){var de=Gs(h,ie,1,x)-1;return M[de](A[de](ie))}}function Wu(h,_){return _.domain(h.domain()).range(h.range()).interpolate(h.interpolate()).clamp(h.clamp()).unknown(h.unknown())}function bf(){var h=_c,_=_c,T=sc,x,A,M,U=ms,ie,de,Be;function zt(){return ie=Math.min(h.length,_.length)>2?Sc:Af,de=Be=null,er}function er(Mr){return isNaN(Mr=+Mr)?M:(de||(de=ie(h.map(x),_,T)))(x(U(Mr)))}return er.invert=function(Mr){return U(A((Be||(Be=ie(_,h.map(x),Ao)))(Mr)))},er.domain=function(Mr){return arguments.length?(h=Hi.call(Mr,go),U===ms||(U=Sf(h)),zt()):h.slice()},er.range=function(Mr){return arguments.length?(_=Ai.call(Mr),zt()):_.slice()},er.rangeRound=function(Mr){return _=Ai.call(Mr),T=hl,zt()},er.clamp=function(Mr){return arguments.length?(U=Mr?Sf(h):ms,er):U!==ms},er.interpolate=function(Mr){return arguments.length?(T=Mr,zt()):T},er.unknown=function(Mr){return arguments.length?(M=Mr,er):M},function(Mr,kr){return x=Mr,A=kr,zt()}}function of(h,_){return bf()(h,_)}var Cf=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Pu(h){if(!(_=Cf.exec(h)))throw new Error("invalid format: "+h);var _;return new uc({fill:_[1],align:_[2],sign:_[3],symbol:_[4],zero:_[5],width:_[6],comma:_[7],precision:_[8]&&_[8].slice(1),trim:_[9],type:_[10]})}Pu.prototype=uc.prototype;function uc(h){this.fill=h.fill===void 0?" ":h.fill+"",this.align=h.align===void 0?">":h.align+"",this.sign=h.sign===void 0?"-":h.sign+"",this.symbol=h.symbol===void 0?"":h.symbol+"",this.zero=!!h.zero,this.width=h.width===void 0?void 0:+h.width,this.comma=!!h.comma,this.precision=h.precision===void 0?void 0:+h.precision,this.trim=!!h.trim,this.type=h.type===void 0?"":h.type+""}uc.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};var If=function(h){return Math.abs(h=Math.round(h))>=1e21?h.toLocaleString("en").replace(/,/g,""):h.toString(10)};function Bc(h,_){if((T=(h=_?h.toExponential(_-1):h.toExponential()).indexOf("e"))<0)return null;var T,x=h.slice(0,T);return[x.length>1?x[0]+x.slice(2):x,+h.slice(T+1)]}var Ac=function(h){return h=Bc(Math.abs(h)),h?h[1]:NaN},$f=function(h,_){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Ac(_)/3)))*3-Ac(Math.abs(h)))},Jf=function(h,_){return function(T,x){for(var A=T.length,M=[],U=0,ie=h[0],de=0;A>0&&ie>0&&!(de+ie+1>x&&(ie=Math.max(1,x-de)),M.push(T.substring(A-=ie,A+ie)),(de+=ie+1)>x);)ie=h[U=(U+1)%h.length];return M.reverse().join(_)}},Qf=function(h){return function(_){return _.replace(/[0-9]/g,function(T){return h[+T]})}},qf=function(h){e:for(var _=h.length,T=1,x=-1,A;T<_;++T)switch(h[T]){case".":x=A=T;break;case"0":x===0&&(x=T),A=T;break;default:if(!+h[T])break e;x>0&&(x=0);break}return x>0?h.slice(0,x)+h.slice(A+1):h},wf,eh=function(h,_){var T=Bc(h,_);if(!T)return h+"";var x=T[0],A=T[1],M=A-(wf=Math.max(-8,Math.min(8,Math.floor(A/3)))*3)+1,U=x.length;return M===U?x:M>U?x+new Array(M-U+1).join("0"):M>0?x.slice(0,M)+"."+x.slice(M):"0."+new Array(1-M).join("0")+Bc(h,Math.max(0,_+M-1))[0]},Hl=function(h,_){var T=Bc(h,_);if(!T)return h+"";var x=T[0],A=T[1];return A<0?"0."+new Array(-A).join("0")+x:x.length>A+1?x.slice(0,A+1)+"."+x.slice(A+1):x+new Array(A-x.length+2).join("0")},sf={"%":function(_,T){return(_*100).toFixed(T)},b:function(_){return Math.round(_).toString(2)},c:function(_){return _+""},d:If,e:function(_,T){return _.toExponential(T)},f:function(_,T){return _.toFixed(T)},g:function(_,T){return _.toPrecision(T)},o:function(_){return Math.round(_).toString(8)},p:function(_,T){return Hl(_*100,T)},r:Hl,s:eh,X:function(_){return Math.round(_).toString(16).toUpperCase()},x:function(_){return Math.round(_).toString(16)}},io=function(h){return h},lc=Array.prototype.map,xf=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"],Cc=function(h){var _=h.grouping===void 0||h.thousands===void 0?io:Jf(lc.call(h.grouping,Number),h.thousands+""),T=h.currency===void 0?"":h.currency[0]+"",x=h.currency===void 0?"":h.currency[1]+"",A=h.decimal===void 0?".":h.decimal+"",M=h.numerals===void 0?io:Qf(lc.call(h.numerals,String)),U=h.percent===void 0?"%":h.percent+"",ie=h.minus===void 0?"-":h.minus+"",de=h.nan===void 0?"NaN":h.nan+"";function Be(er){er=Pu(er);var Mr=er.fill,kr=er.align,xn=er.sign,yn=er.symbol,Fn=er.zero,Sa=er.width,wa=er.comma,Ri=er.precision,oi=er.trim,si=er.type;si==="n"?(wa=!0,si="g"):sf[si]||(Ri===void 0&&(Ri=12),oi=!0,si="g"),(Fn||Mr==="0"&&kr==="=")&&(Fn=!0,Mr="0",kr="=");var Qi=yn==="$"?T:yn==="#"&&/[boxX]/.test(si)?"0"+si.toLowerCase():"",Oa=yn==="$"?x:/[%p]/.test(si)?U:"",qi=sf[si],To=/[defgprs%]/.test(si);Ri=Ri===void 0?6:/[gprs]/.test(si)?Math.max(1,Math.min(21,Ri)):Math.max(0,Math.min(20,Ri));function Xs(Xa){var Ms=Qi,$o=Oa,ff,Rh,wc;if(si==="c")$o=qi(Xa)+$o,Xa="";else{Xa=+Xa;var bh=Xa<0||1/Xa<0;if(Xa=isNaN(Xa)?de:qi(Math.abs(Xa),Ri),oi&&(Xa=qf(Xa)),bh&&+Xa===0&&xn!=="+"&&(bh=!1),Ms=(bh?xn==="("?xn:ie:xn==="-"||xn==="("?"":xn)+Ms,$o=(si==="s"?xf[8+wf/3]:"")+$o+(bh&&xn==="("?")":""),To){for(ff=-1,Rh=Xa.length;++ff<Rh;)if(wc=Xa.charCodeAt(ff),48>wc||wc>57){$o=(wc===46?A+Xa.slice(ff+1):Xa.slice(ff))+$o,Xa=Xa.slice(0,ff);break}}}wa&&!Fn&&(Xa=_(Xa,Infinity));var ah=Ms.length+Xa.length+$o.length,Xc=ah<Sa?new Array(Sa-ah+1).join(Mr):"";wa&&Fn&&(Xa=_(Xc+Xa,Xc.length?Sa-$o.length:Infinity),Xc="");switch(kr){case"<":Xa=Ms+Xa+$o+Xc;break;case"=":Xa=Ms+Xc+Xa+$o;break;case"^":Xa=Xc.slice(0,ah=Xc.length>>1)+Ms+Xa+$o+Xc.slice(ah);break;default:Xa=Xc+Ms+Xa+$o;break}return M(Xa)}return Xs.toString=function(){return er+""},Xs}function zt(er,Mr){var kr=Be((er=Pu(er),er.type="f",er)),xn=Math.max(-8,Math.min(8,Math.floor(Ac(Mr)/3)))*3,yn=Math.pow(10,-xn),Fn=xf[8+xn/3];return function(Sa){return kr(yn*Sa)+Fn}}return{format:Be,formatPrefix:zt}},au,Cl,Ef;Df({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});function Df(h){return au=Cc(h),Cl=au.format,Ef=au.formatPrefix,au}var Vc=function(h,_){return h=Math.abs(h),_=Math.abs(_)-h,Math.max(0,Ac(_)-Ac(h))+1},uf=function(h){return Math.max(0,-Ac(Math.abs(h)))},Gc=function(h,_,T,x){var A=l(h,_,T),M;x=Pu(x==null?",f":x);switch(x.type){case"s":{var U=Math.max(Math.abs(h),Math.abs(_));return x.precision==null&&!isNaN(M=$f(A,U))&&(x.precision=M),Ef(x,U)}case"":case"e":case"g":case"p":case"r":{x.precision==null&&!isNaN(M=Vc(A,Math.max(Math.abs(h),Math.abs(_))))&&(x.precision=M-(x.type==="e"));break}case"f":case"%":{x.precision==null&&!isNaN(M=uf(A))&&(x.precision=M-(x.type==="%")*2);break}}return Cl(x)};function dl(h){var _=h.domain;return h.ticks=function(T){var x=_();return a(x[0],x[x.length-1],T==null?10:T)},h.tickFormat=function(T,x){var A=_();return Gc(A[0],A[A.length-1],T==null?10:T,x)},h.nice=function(T){T==null&&(T=10);var x=_(),A=0,M=x.length-1,U=x[A],ie=x[M],de;return ie<U&&(de=U,U=ie,ie=de,de=A,A=M,M=de),de=n(U,ie,T),de>0?(U=Math.floor(U/de)*de,ie=Math.ceil(ie/de)*de,de=n(U,ie,T)):de<0&&(U=Math.ceil(U*de)/de,ie=Math.floor(ie*de)/de,de=n(U,ie,T)),de>0?(x[A]=Math.floor(U/de)*de,x[M]=Math.ceil(ie/de)*de,_(x)):de<0&&(x[A]=Math.ceil(U*de)/de,x[M]=Math.floor(ie*de)/de,_(x)),h},h}function ne(){var h=of(ms,ms);return h.copy=function(){return Wu(h,ne())},gr.apply(h,arguments),dl(h)}function se(h){var _;function T(x){return isNaN(x=+x)?_:x}return T.invert=T,T.domain=T.range=function(x){return arguments.length?(h=Hi.call(x,go),T):h.slice()},T.unknown=function(x){return arguments.length?(_=x,T):_},T.copy=function(){return se(h).unknown(_)},h=arguments.length?Hi.call(h,go):[0,1],dl(T)}var N=function(h,_){h=h.slice();var T=0,x=h.length-1,A=h[T],M=h[x],U;return M<A&&(U=T,T=x,x=U,U=A,A=M,M=U),h[T]=_.floor(A),h[x]=_.ceil(M),h};function G(h){return Math.log(h)}function Ce(h){return Math.exp(h)}function ft(h){return-Math.log(-h)}function Yt(h){return-Math.exp(-h)}function sr(h){return isFinite(h)?+("1e"+h):h<0?0:h}function or(h){return h===10?sr:h===Math.E?Math.exp:function(_){return Math.pow(h,_)}}function Dr(h){return h===Math.E?Math.log:h===10&&Math.log10||h===2&&Math.log2||(h=Math.log(h),function(_){return Math.log(_)/h})}function sn(h){return function(_){return-h(-_)}}function Hn(h){var _=h(G,Ce),T=_.domain,x=10,A,M;function U(){return A=Dr(x),M=or(x),T()[0]<0?(A=sn(A),M=sn(M),h(ft,Yt)):h(G,Ce),_}return _.base=function(ie){return arguments.length?(x=+ie,U()):x},_.domain=function(ie){return arguments.length?(T(ie),U()):T()},_.ticks=function(ie){var de=T(),Be=de[0],zt=de[de.length-1],er;(er=zt<Be)&&(Mr=Be,Be=zt,zt=Mr);var Mr=A(Be),kr=A(zt),xn,yn,Fn,Sa=ie==null?10:+ie,wa=[];if(!(x%1)&&kr-Mr<Sa)if(Mr=Math.round(Mr)-1,kr=Math.round(kr)+1,Be>0)for(;Mr<kr;++Mr)for(yn=1,xn=M(Mr);yn<x;++yn){if(Fn=xn*yn,Fn<Be)continue;if(Fn>zt)break;wa.push(Fn)}else for(;Mr<kr;++Mr)for(yn=x-1,xn=M(Mr);yn>=1;--yn){if(Fn=xn*yn,Fn<Be)continue;if(Fn>zt)break;wa.push(Fn)}else wa=a(Mr,kr,Math.min(kr-Mr,Sa)).map(M);return er?wa.reverse():wa},_.tickFormat=function(ie,de){if(de==null&&(de=x===10?".0e":","),typeof de!="function"&&(de=Cl(de)),ie===Infinity)return de;ie==null&&(ie=10);var Be=Math.max(1,x*ie/_.ticks().length);return function(zt){var er=zt/M(Math.round(A(zt)));return er*x<x-.5&&(er*=x),er<=Be?de(zt):""}},_.nice=function(){return T(N(T(),{floor:function(de){return M(Math.floor(A(de)))},ceil:function(de){return M(Math.ceil(A(de)))}}))},_}function ea(){var h=Hn(bf()).domain([1,10]);return h.copy=function(){return Wu(h,ea()).base(h.base())},gr.apply(h,arguments),h}function la(h){return function(_){return Math.sign(_)*Math.log1p(Math.abs(_/h))}}function ti(h){return function(_){return Math.sign(_)*Math.expm1(Math.abs(_))*h}}function ja(h){var _=1,T=h(la(_),ti(_));return T.constant=function(x){return arguments.length?h(la(_=+x),ti(_)):_},dl(T)}function Ti(){var h=ja(bf());return h.copy=function(){return Wu(h,Ti()).constant(h.constant())},gr.apply(h,arguments)}function Qa(h){return function(_){return _<0?-Math.pow(-_,h):Math.pow(_,h)}}function Vi(h){return h<0?-Math.sqrt(-h):Math.sqrt(h)}function Co(h){return h<0?-h*h:h*h}function yo(h){var _=h(ms,ms),T=1;function x(){return T===1?h(ms,ms):T===.5?h(Vi,Co):h(Qa(T),Qa(1/T))}return _.exponent=function(A){return arguments.length?(T=+A,x()):T},dl(_)}function Zi(){var h=yo(bf());return h.copy=function(){return Wu(h,Zi()).exponent(h.exponent())},gr.apply(h,arguments),h}function jo(){return Zi.apply(null,arguments).exponent(.5)}function qa(){var h=[],_=[],T=[],x;function A(){var U=0,ie=Math.max(1,_.length);for(T=new Array(ie-1);++U<ie;)T[U-1]=L(h,U/ie);return M}function M(U){return isNaN(U=+U)?x:_[Gs(T,U)]}return M.invertExtent=function(U){var ie=_.indexOf(U);return ie<0?[NaN,NaN]:[ie>0?T[ie-1]:h[0],ie<T.length?T[ie]:h[h.length-1]]},M.domain=function(U){if(!arguments.length)return h.slice();h=[];for(var ie=0,de=U.length,Be;ie<de;++ie)(Be=U[ie],Be!=null&&!isNaN(Be=+Be))&&h.push(Be);return h.sort(ll),A()},M.range=function(U){return arguments.length?(_=Ai.call(U),A()):_.slice()},M.unknown=function(U){return arguments.length?(x=U,M):x},M.quantiles=function(){return T.slice()},M.copy=function(){return qa().domain(h).range(_).unknown(x)},gr.apply(M,arguments)}function lo(){var h=0,_=1,T=1,x=[.5],A=[0,1],M;function U(de){return de<=de?A[Gs(x,de,0,T)]:M}function ie(){var de=-1;for(x=new Array(T);++de<T;)x[de]=((de+1)*_-(de-T)*h)/(T+1);return U}return U.domain=function(de){return arguments.length?(h=+de[0],_=+de[1],ie()):[h,_]},U.range=function(de){return arguments.length?(T=(A=Ai.call(de)).length-1,ie()):A.slice()},U.invertExtent=function(de){var Be=A.indexOf(de);return Be<0?[NaN,NaN]:Be<1?[h,x[0]]:Be>=T?[x[T-1],_]:[x[Be-1],x[Be]]},U.unknown=function(de){return arguments.length&&(M=de),U},U.thresholds=function(){return x.slice()},U.copy=function(){return lo().domain([h,_]).range(A).unknown(M)},gr.apply(dl(U),arguments)}function iu(){var h=[.5],_=[0,1],T,x=1;function A(M){return M<=M?_[Gs(h,M,0,x)]:T}return A.domain=function(M){return arguments.length?(h=Ai.call(M),x=Math.min(h.length,_.length-1),A):h.slice()},A.range=function(M){return arguments.length?(_=Ai.call(M),x=Math.min(h.length,_.length-1),A):_.slice()},A.invertExtent=function(M){var U=_.indexOf(M);return[h[U-1],h[U]]},A.unknown=function(M){return arguments.length?(T=M,A):T},A.copy=function(){return iu().domain(h).range(_).unknown(T)},gr.apply(A,arguments)}var _i=new Date,ki=new Date;function Ea(h,_,T,x){function A(M){return h(M=arguments.length===0?new Date:new Date(+M)),M}return A.floor=function(M){return h(M=new Date(+M)),M},A.ceil=function(M){return h(M=new Date(M-1)),_(M,1),h(M),M},A.round=function(M){var U=A(M),ie=A.ceil(M);return M-U<ie-M?U:ie},A.offset=function(M,U){return _(M=new Date(+M),U==null?1:Math.floor(U)),M},A.range=function(M,U,ie){var de=[],Be;if(M=A.ceil(M),ie=ie==null?1:Math.floor(ie),!(M<U)||!(ie>0))return de;do de.push(Be=new Date(+M)),_(M,ie),h(M);while(Be<M&&M<U);return de},A.filter=function(M){return Ea(function(U){if(U>=U)for(;h(U),!M(U);)U.setTime(U-1)},function(U,ie){if(U>=U)if(ie<0)for(;++ie<=0;)for(;_(U,-1),!M(U););else for(;--ie>=0;)for(;_(U,1),!M(U););})},T&&(A.count=function(M,U){return _i.setTime(+M),ki.setTime(+U),h(_i),h(ki),Math.floor(T(_i,ki))},A.every=function(M){return M=Math.floor(M),!isFinite(M)||!(M>0)?null:M>1?A.filter(x?function(U){return x(U)%M===0}:function(U){return A.count(0,U)%M===0}):A}),A}var wo=Ea(function(h){h.setMonth(0,1),h.setHours(0,0,0,0)},function(h,_){h.setFullYear(h.getFullYear()+_)},function(h,_){return _.getFullYear()-h.getFullYear()},function(h){return h.getFullYear()});wo.every=function(h){return!isFinite(h=Math.floor(h))||!(h>0)?null:Ea(function(_){_.setFullYear(Math.floor(_.getFullYear()/h)*h),_.setMonth(0,1),_.setHours(0,0,0,0)},function(_,T){_.setFullYear(_.getFullYear()+T*h)})};var cc=wo,Nf=wo.range,oh=Ea(function(h){h.setDate(1),h.setHours(0,0,0,0)},function(h,_){h.setMonth(h.getMonth()+_)},function(h,_){return _.getMonth()-h.getMonth()+(_.getFullYear()-h.getFullYear())*12},function(h){return h.getMonth()}),kf=oh,Lu=oh.range,jf=1e3,lf=6e4,Ff=36e5,Eh=864e5,sh=6048e5;function Tf(h){return Ea(function(_){_.setDate(_.getDate()-(_.getDay()+7-h)%7),_.setHours(0,0,0,0)},function(_,T){_.setDate(_.getDate()+T*7)},function(_,T){return(T-_-(T.getTimezoneOffset()-_.getTimezoneOffset())*lf)/sh})}var zf=Tf(0),Uf=Tf(1),uh=Tf(2),Bf=Tf(3),Of=Tf(4),Zl=Tf(5),Ih=Tf(6),ge=zf.range,je=Uf.range,Mt=uh.range,Er=Bf.range,Lr=Of.range,wr=Zl.range,Tr=Ih.range,Wr=Ea(function(h){h.setHours(0,0,0,0)},function(h,_){h.setDate(h.getDate()+_)},function(h,_){return(_-h-(_.getTimezoneOffset()-h.getTimezoneOffset())*lf)/Eh},function(h){return h.getDate()-1}),un=Wr,Jr=Wr.range,Qr=Ea(function(h){h.setTime(h-h.getMilliseconds()-h.getSeconds()*jf-h.getMinutes()*lf)},function(h,_){h.setTime(+h+_*Ff)},function(h,_){return(_-h)/Ff},function(h){return h.getHours()}),ln=Qr,Sn=Qr.range,pn=Ea(function(h){h.setTime(h-h.getMilliseconds()-h.getSeconds()*jf)},function(h,_){h.setTime(+h+_*lf)},function(h,_){return(_-h)/lf},function(h){return h.getMinutes()}),nn=pn,_r=pn.range,xr=Ea(function(h){h.setTime(h-h.getMilliseconds())},function(h,_){h.setTime(+h+_*jf)},function(h,_){return(_-h)/jf},function(h){return h.getUTCSeconds()}),Xr=xr,On=xr.range,Ir=Ea(function(){},function(h,_){h.setTime(+h+_)},function(h,_){return _-h});Ir.every=function(h){return h=Math.floor(h),!isFinite(h)||!(h>0)?null:h>1?Ea(function(_){_.setTime(Math.floor(_/h)*h)},function(_,T){_.setTime(+_+T*h)},function(_,T){return(T-_)/h}):Ir};var ta=Ir,qr=Ir.range;function zr(h){return Ea(function(_){_.setUTCDate(_.getUTCDate()-(_.getUTCDay()+7-h)%7),_.setUTCHours(0,0,0,0)},function(_,T){_.setUTCDate(_.getUTCDate()+T*7)},function(_,T){return(T-_)/sh})}var Vr=zr(0),Kr=zr(1),Xn=zr(2),na=zr(3),cn=zr(4),Hr=zr(5),jr=zr(6),ma=Vr.range,pa=Kr.range,Un=Xn.range,Ua=na.range,Ta=cn.range,Ba=Hr.range,hi=jr.range,Fo=Ea(function(h){h.setUTCHours(0,0,0,0)},function(h,_){h.setUTCDate(h.getUTCDate()+_)},function(h,_){return(_-h)/Eh},function(h){return h.getUTCDate()-1}),Os=Fo,ei=Fo.range,bo=Ea(function(h){h.setUTCMonth(0,1),h.setUTCHours(0,0,0,0)},function(h,_){h.setUTCFullYear(h.getUTCFullYear()+_)},function(h,_){return _.getUTCFullYear()-h.getUTCFullYear()},function(h){return h.getUTCFullYear()});bo.every=function(h){return!isFinite(h=Math.floor(h))||!(h>0)?null:Ea(function(_){_.setUTCFullYear(Math.floor(_.getUTCFullYear()/h)*h),_.setUTCMonth(0,1),_.setUTCHours(0,0,0,0)},function(_,T){_.setUTCFullYear(_.getUTCFullYear()+T*h)})};var Ci=bo,vs=bo.range;function zo(h){if(0<=h.y&&h.y<100){var _=new Date(-1,h.m,h.d,h.H,h.M,h.S,h.L);return _.setFullYear(h.y),_}return new Date(h.y,h.m,h.d,h.H,h.M,h.S,h.L)}function gs(h){if(0<=h.y&&h.y<100){var _=new Date(Date.UTC(-1,h.m,h.d,h.H,h.M,h.S,h.L));return _.setUTCFullYear(h.y),_}return new Date(Date.UTC(h.y,h.m,h.d,h.H,h.M,h.S,h.L))}function Uo(h,_,T){return{y:h,m:_,d:T,H:0,M:0,S:0,L:0}}function Bo(h){var _=h.dateTime,T=h.date,x=h.time,A=h.periods,M=h.days,U=h.shortDays,ie=h.months,de=h.shortMonths,Be=Va(A),zt=rs(A),er=Va(M),Mr=rs(M),kr=Va(U),xn=rs(U),yn=Va(ie),Fn=rs(ie),Sa=Va(de),wa=rs(de),Ri={a:bh,A:ah,b:Xc,B:dd,c:null,d:dr,e:dr,f:Bn,g:Wl,G:pl,H:rr,I:mr,j:Or,L:$r,m:on,M:Dn,p:sd,q:pd,Q:rd,s:ld,S:ca,u:Na,U:ri,V:Hc,w:ys,W:fc,x:null,X:null,y:xo,Y:Xu,Z:wl,"%":td},oi={a:md,A:ud,b:vd,B:Bh,c:null,d:Mf,e:Mf,f:Dh,g:Hh,G:Th,H:Fa,I:li,j:lh,L:th,m:hc,M:rh,p:gd,q:Qh,Q:rd,s:ld,S:Vh,u:ch,U:fh,V:Zs,w:Nh,W:Vf,x:null,X:null,y:Gh,Y:ed,Z:Gf,"%":td},si={a:Xs,A:Xa,b:Ms,B:$o,c:ff,d:We,e:We,f:vt,g:te,G:I,H:Pe,I:Pe,j:rt,L:ke,m:Q,M:Qe,p:To,q:k,Q:Zt,s:Kt,S:Tt,u:b,U:c,V:d,w,W:y,x:Rh,X:wc,y:te,Y:I,Z:B,"%":De};Ri.x=Qi(T,Ri),Ri.X=Qi(x,Ri),Ri.c=Qi(_,Ri),oi.x=Qi(T,oi),oi.X=Qi(x,oi),oi.c=Qi(_,oi);function Qi(ka,Fi){return function(ci){var In=[],Oc=-1,Es=0,Yc=ka.length,Kc,xh,yd;for(ci instanceof Date||(ci=new Date(+ci));++Oc<Yc;)ka.charCodeAt(Oc)===37&&(In.push(ka.slice(Es,Oc)),(xh=Vo[Kc=ka.charAt(++Oc)])!=null?Kc=ka.charAt(++Oc):xh=Kc==="e"?" ":"0",(yd=Fi[Kc])&&(Kc=yd(ci,xh)),In.push(Kc),Es=Oc+1);return In.push(ka.slice(Es,Oc)),In.join("")}}function Oa(ka,Fi){return function(ci){var In=Uo(1900,void 0,1),Oc=qi(In,ka,ci+="",0),Es,Yc;if(Oc!=ci.length)return null;if("Q"in In)return new Date(In.Q);if("s"in In)return new Date(In.s*1e3+("L"in In?In.L:0));if(Fi&&!("Z"in In)&&(In.Z=0),"p"in In&&(In.H=In.H%12+In.p*12),In.m===void 0&&(In.m="q"in In?In.q:0),"V"in In){if(In.V<1||In.V>53)return null;"w"in In||(In.w=1),"Z"in In?(Es=gs(Uo(In.y,0,1)),Yc=Es.getUTCDay(),Es=Yc>4||Yc===0?Kr.ceil(Es):Kr(Es),Es=Os.offset(Es,(In.V-1)*7),In.y=Es.getUTCFullYear(),In.m=Es.getUTCMonth(),In.d=Es.getUTCDate()+(In.w+6)%7):(Es=zo(Uo(In.y,0,1)),Yc=Es.getDay(),Es=Yc>4||Yc===0?Uf.ceil(Es):Uf(Es),Es=un.offset(Es,(In.V-1)*7),In.y=Es.getFullYear(),In.m=Es.getMonth(),In.d=Es.getDate()+(In.w+6)%7)}else("W"in In||"U"in In)&&("w"in In||(In.w="u"in In?In.u%7:"W"in In?1:0),Yc="Z"in In?gs(Uo(In.y,0,1)).getUTCDay():zo(Uo(In.y,0,1)).getDay(),In.m=0,In.d="W"in In?(In.w+6)%7+In.W*7-(Yc+5)%7:In.w+In.U*7-(Yc+6)%7);return"Z"in In?(In.H+=In.Z/100|0,In.M+=In.Z%100,gs(In)):zo(In)}}function qi(ka,Fi,ci,In){for(var Oc=0,Es=Fi.length,Yc=ci.length,Kc,xh;Oc<Es;){if(In>=Yc)return-1;if(Kc=Fi.charCodeAt(Oc++),Kc===37){if(Kc=Fi.charAt(Oc++),xh=si[Kc in Vo?Fi.charAt(Oc++):Kc],!xh||(In=xh(ka,ci,In))<0)return-1}else if(Kc!=ci.charCodeAt(In++))return-1}return In}function To(ka,Fi,ci){var In=Be.exec(Fi.slice(ci));return In?(ka.p=zt[In[0].toLowerCase()],ci+In[0].length):-1}function Xs(ka,Fi,ci){var In=kr.exec(Fi.slice(ci));return In?(ka.w=xn[In[0].toLowerCase()],ci+In[0].length):-1}function Xa(ka,Fi,ci){var In=er.exec(Fi.slice(ci));return In?(ka.w=Mr[In[0].toLowerCase()],ci+In[0].length):-1}function Ms(ka,Fi,ci){var In=Sa.exec(Fi.slice(ci));return In?(ka.m=wa[In[0].toLowerCase()],ci+In[0].length):-1}function $o(ka,Fi,ci){var In=yn.exec(Fi.slice(ci));return In?(ka.m=Fn[In[0].toLowerCase()],ci+In[0].length):-1}function ff(ka,Fi,ci){return qi(ka,_,Fi,ci)}function Rh(ka,Fi,ci){return qi(ka,T,Fi,ci)}function wc(ka,Fi,ci){return qi(ka,x,Fi,ci)}function bh(ka){return U[ka.getDay()]}function ah(ka){return M[ka.getDay()]}function Xc(ka){return de[ka.getMonth()]}function dd(ka){return ie[ka.getMonth()]}function sd(ka){return A[+(ka.getHours()>=12)]}function pd(ka){return 1+~~(ka.getMonth()/3)}function md(ka){return U[ka.getUTCDay()]}function ud(ka){return M[ka.getUTCDay()]}function vd(ka){return de[ka.getUTCMonth()]}function Bh(ka){return ie[ka.getUTCMonth()]}function gd(ka){return A[+(ka.getUTCHours()>=12)]}function Qh(ka){return 1+~~(ka.getUTCMonth()/3)}return{format:function(Fi){var ci=Qi(Fi+="",Ri);return ci.toString=function(){return Fi},ci},parse:function(Fi){var ci=Oa(Fi+="",!1);return ci.toString=function(){return Fi},ci},utcFormat:function(Fi){var ci=Qi(Fi+="",oi);return ci.toString=function(){return Fi},ci},utcParse:function(Fi){var ci=Oa(Fi+="",!0);return ci.toString=function(){return Fi},ci}}}var Vo={"-":"",_:" ","0":"0"},aa=/^\s*\d+/,ou=/^%/,yi=/[\\^$*+?|[\]().{}]/g;function An(h,_,T){var x=h<0?"-":"",A=(x?-h:h)+"",M=A.length;return x+(M<T?new Array(T-M+1).join(_)+A:A)}function Ra(h){return h.replace(yi,"\\$&")}function Va(h){return new RegExp("^(?:"+h.map(Ra).join("|")+")","i")}function rs(h){for(var _={},T=-1,x=h.length;++T<x;)_[h[T].toLowerCase()]=T;return _}function w(h,_,T){var x=aa.exec(_.slice(T,T+1));return x?(h.w=+x[0],T+x[0].length):-1}function b(h,_,T){var x=aa.exec(_.slice(T,T+1));return x?(h.u=+x[0],T+x[0].length):-1}function c(h,_,T){var x=aa.exec(_.slice(T,T+2));return x?(h.U=+x[0],T+x[0].length):-1}function d(h,_,T){var x=aa.exec(_.slice(T,T+2));return x?(h.V=+x[0],T+x[0].length):-1}function y(h,_,T){var x=aa.exec(_.slice(T,T+2));return x?(h.W=+x[0],T+x[0].length):-1}function I(h,_,T){var x=aa.exec(_.slice(T,T+4));return x?(h.y=+x[0],T+x[0].length):-1}function te(h,_,T){var x=aa.exec(_.slice(T,T+2));return x?(h.y=+x[0]+(+x[0]>68?1900:2e3),T+x[0].length):-1}function B(h,_,T){var x=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(_.slice(T,T+6));return x?(h.Z=x[1]?0:-(x[2]+(x[3]||"00")),T+x[0].length):-1}function k(h,_,T){var x=aa.exec(_.slice(T,T+1));return x?(h.q=x[0]*3-3,T+x[0].length):-1}function Q(h,_,T){var x=aa.exec(_.slice(T,T+2));return x?(h.m=x[0]-1,T+x[0].length):-1}function We(h,_,T){var x=aa.exec(_.slice(T,T+2));return x?(h.d=+x[0],T+x[0].length):-1}function rt(h,_,T){var x=aa.exec(_.slice(T,T+3));return x?(h.m=0,h.d=+x[0],T+x[0].length):-1}function Pe(h,_,T){var x=aa.exec(_.slice(T,T+2));return x?(h.H=+x[0],T+x[0].length):-1}function Qe(h,_,T){var x=aa.exec(_.slice(T,T+2));return x?(h.M=+x[0],T+x[0].length):-1}function Tt(h,_,T){var x=aa.exec(_.slice(T,T+2));return x?(h.S=+x[0],T+x[0].length):-1}function ke(h,_,T){var x=aa.exec(_.slice(T,T+3));return x?(h.L=+x[0],T+x[0].length):-1}function vt(h,_,T){var x=aa.exec(_.slice(T,T+6));return x?(h.L=Math.floor(x[0]/1e3),T+x[0].length):-1}function De(h,_,T){var x=ou.exec(_.slice(T,T+1));return x?T+x[0].length:-1}function Zt(h,_,T){var x=aa.exec(_.slice(T));return x?(h.Q=+x[0],T+x[0].length):-1}function Kt(h,_,T){var x=aa.exec(_.slice(T));return x?(h.s=+x[0],T+x[0].length):-1}function dr(h,_){return An(h.getDate(),_,2)}function rr(h,_){return An(h.getHours(),_,2)}function mr(h,_){return An(h.getHours()%12||12,_,2)}function Or(h,_){return An(1+un.count(cc(h),h),_,3)}function $r(h,_){return An(h.getMilliseconds(),_,3)}function Bn(h,_){return $r(h,_)+"000"}function on(h,_){return An(h.getMonth()+1,_,2)}function Dn(h,_){return An(h.getMinutes(),_,2)}function ca(h,_){return An(h.getSeconds(),_,2)}function Na(h){var _=h.getDay();return _===0?7:_}function ri(h,_){return An(zf.count(cc(h)-1,h),_,2)}function co(h){var _=h.getDay();return _>=4||_===0?Of(h):Of.ceil(h)}function Hc(h,_){return h=co(h),An(Of.count(cc(h),h)+(cc(h).getDay()===4),_,2)}function ys(h){return h.getDay()}function fc(h,_){return An(Uf.count(cc(h)-1,h),_,2)}function xo(h,_){return An(h.getFullYear()%100,_,2)}function Wl(h,_){return h=co(h),An(h.getFullYear()%100,_,2)}function Xu(h,_){return An(h.getFullYear()%1e4,_,4)}function pl(h,_){var T=h.getDay();return h=T>=4||T===0?Of(h):Of.ceil(h),An(h.getFullYear()%1e4,_,4)}function wl(h){var _=h.getTimezoneOffset();return(_>0?"-":(_*=-1,"+"))+An(_/60|0,"0",2)+An(_%60,"0",2)}function Mf(h,_){return An(h.getUTCDate(),_,2)}function Fa(h,_){return An(h.getUTCHours(),_,2)}function li(h,_){return An(h.getUTCHours()%12||12,_,2)}function lh(h,_){return An(1+Os.count(Ci(h),h),_,3)}function th(h,_){return An(h.getUTCMilliseconds(),_,3)}function Dh(h,_){return th(h,_)+"000"}function hc(h,_){return An(h.getUTCMonth()+1,_,2)}function rh(h,_){return An(h.getUTCMinutes(),_,2)}function Vh(h,_){return An(h.getUTCSeconds(),_,2)}function ch(h){var _=h.getUTCDay();return _===0?7:_}function fh(h,_){return An(Vr.count(Ci(h)-1,h),_,2)}function qh(h){var _=h.getUTCDay();return _>=4||_===0?cn(h):cn.ceil(h)}function Zs(h,_){return h=qh(h),An(cn.count(Ci(h),h)+(Ci(h).getUTCDay()===4),_,2)}function Nh(h){return h.getUTCDay()}function Vf(h,_){return An(Kr.count(Ci(h)-1,h),_,2)}function Gh(h,_){return An(h.getUTCFullYear()%100,_,2)}function Hh(h,_){return h=qh(h),An(h.getUTCFullYear()%100,_,2)}function ed(h,_){return An(h.getUTCFullYear()%1e4,_,4)}function Th(h,_){var T=h.getUTCDay();return h=T>=4||T===0?cn(h):cn.ceil(h),An(h.getUTCFullYear()%1e4,_,4)}function Gf(){return"+0000"}function td(){return"%"}function rd(h){return+h}function ld(h){return Math.floor(+h/1e3)}var bs,Hf,cd,e,t;r({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function r(h){return bs=Bo(h),Hf=bs.format,cd=bs.parse,e=bs.utcFormat,t=bs.utcParse,bs}var u=1e3,f=u*60,m=f*60,S=m*24,P=S*7,V=S*30,re=S*365;function he(h){return new Date(h)}function _e(h){return h instanceof Date?+h:+new Date(+h)}function we(h,_,T,x,A,M,U,ie,de){var Be=of(ms,ms),zt=Be.invert,er=Be.domain,Mr=de(".%L"),kr=de(":%S"),xn=de("%I:%M"),yn=de("%I %p"),Fn=de("%a %d"),Sa=de("%b %d"),wa=de("%B"),Ri=de("%Y"),oi=[[U,1,u],[U,5,5*u],[U,15,15*u],[U,30,30*u],[M,1,f],[M,5,5*f],[M,15,15*f],[M,30,30*f],[A,1,m],[A,3,3*m],[A,6,6*m],[A,12,12*m],[x,1,S],[x,2,2*S],[T,1,P],[_,1,V],[_,3,3*V],[h,1,re]];function si(Oa){return(U(Oa)<Oa?Mr:M(Oa)<Oa?kr:A(Oa)<Oa?xn:x(Oa)<Oa?yn:_(Oa)<Oa?T(Oa)<Oa?Fn:Sa:h(Oa)<Oa?wa:Ri)(Oa)}function Qi(Oa,qi,To,Xs){if(Oa==null&&(Oa=10),typeof Oa=="number"){var Xa=Math.abs(To-qi)/Oa,Ms=mu(function($o){return $o[2]}).right(oi,Xa);Ms===oi.length?(Xs=l(qi/re,To/re,Oa),Oa=h):Ms?(Ms=oi[Xa/oi[Ms-1][2]<oi[Ms][2]/Xa?Ms-1:Ms],Xs=Ms[1],Oa=Ms[0]):(Xs=Math.max(l(qi,To,Oa),1),Oa=ie)}return Xs==null?Oa:Oa.every(Xs)}return Be.invert=function(Oa){return new Date(zt(Oa))},Be.domain=function(Oa){return arguments.length?er(Hi.call(Oa,_e)):er().map(he)},Be.ticks=function(Oa,qi){var To=er(),Xs=To[0],Xa=To[To.length-1],Ms=Xa<Xs,$o;return Ms&&($o=Xs,Xs=Xa,Xa=$o),$o=Qi(Oa,Xs,Xa,qi),$o=$o?$o.range(Xs,Xa+1):[],Ms?$o.reverse():$o},Be.tickFormat=function(Oa,qi){return qi==null?si:de(qi)},Be.nice=function(Oa,qi){var To=er();return(Oa=Qi(Oa,To[0],To[To.length-1],qi))?er(N(To,Oa)):Be},Be.copy=function(){return Wu(Be,we(h,_,T,x,A,M,U,ie,de))},Be}var lt=function(){return gr.apply(we(cc,kf,zf,un,ln,nn,Xr,ta,Hf).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)},Lt=Ea(function(h){h.setUTCDate(1),h.setUTCHours(0,0,0,0)},function(h,_){h.setUTCMonth(h.getUTCMonth()+_)},function(h,_){return _.getUTCMonth()-h.getUTCMonth()+(_.getUTCFullYear()-h.getUTCFullYear())*12},function(h){return h.getUTCMonth()}),Ct=Lt,$t=Lt.range,Xt=Ea(function(h){h.setUTCMinutes(0,0,0)},function(h,_){h.setTime(+h+_*Ff)},function(h,_){return(_-h)/Ff},function(h){return h.getUTCHours()}),ir=Xt,br=Xt.range,Sr=Ea(function(h){h.setUTCSeconds(0,0)},function(h,_){h.setTime(+h+_*lf)},function(h,_){return(_-h)/lf},function(h){return h.getUTCMinutes()}),Fr=Sr,Nr=Sr.range,mn=function(){return gr.apply(we(Ci,Ct,Vr,Os,ir,Fr,Xr,ta,e).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)};function hn(){var h=0,_=1,T,x,A,M,U=ms,ie=!1,de;function Be(zt){return isNaN(zt=+zt)?de:U(A===0?.5:(zt=(M(zt)-T)*A,ie?Math.max(0,Math.min(1,zt)):zt))}return Be.domain=function(zt){return arguments.length?(T=M(h=+zt[0]),x=M(_=+zt[1]),A=T===x?0:1/(x-T),Be):[h,_]},Be.clamp=function(zt){return arguments.length?(ie=!!zt,Be):ie},Be.interpolator=function(zt){return arguments.length?(U=zt,Be):U},Be.unknown=function(zt){return arguments.length?(de=zt,Be):de},function(zt){return M=zt,T=zt(h),x=zt(_),A=T===x?0:1/(x-T),Be}}function Ln(h,_){return _.domain(h.domain()).interpolator(h.interpolator()).clamp(h.clamp()).unknown(h.unknown())}function Qn(){var h=dl(hn()(ms));return h.copy=function(){return Ln(h,Qn())},Ar.apply(h,arguments)}function Yn(){var h=Hn(hn()).domain([1,10]);return h.copy=function(){return Ln(h,Yn()).base(h.base())},Ar.apply(h,arguments)}function Nn(){var h=ja(hn());return h.copy=function(){return Ln(h,Nn()).constant(h.constant())},Ar.apply(h,arguments)}function _a(){var h=yo(hn());return h.copy=function(){return Ln(h,_a()).exponent(h.exponent())},Ar.apply(h,arguments)}function fa(){return _a.apply(null,arguments).exponent(.5)}function ra(){var h=[],_=ms;function T(x){if(!isNaN(x=+x))return _((Gs(h,x)-1)/(h.length-1))}return T.domain=function(x){if(!arguments.length)return h.slice();h=[];for(var A=0,M=x.length,U;A<M;++A)(U=x[A],U!=null&&!isNaN(U=+U))&&h.push(U);return h.sort(ll),T},T.interpolator=function(x){return arguments.length?(_=x,T):_},T.copy=function(){return ra(_).domain(h)},Ar.apply(T,arguments)}function Ja(){var h=0,_=.5,T=1,x,A,M,U,ie,de=ms,Be,zt=!1,er;function Mr(kr){return isNaN(kr=+kr)?er:(kr=.5+((kr=+Be(kr))-A)*(kr<A?U:ie),de(zt?Math.max(0,Math.min(1,kr)):kr))}return Mr.domain=function(kr){return arguments.length?(x=Be(h=+kr[0]),A=Be(_=+kr[1]),M=Be(T=+kr[2]),U=x===A?0:.5/(A-x),ie=A===M?0:.5/(M-A),Mr):[h,_,T]},Mr.clamp=function(kr){return arguments.length?(zt=!!kr,Mr):zt},Mr.interpolator=function(kr){return arguments.length?(de=kr,Mr):de},Mr.unknown=function(kr){return arguments.length?(er=kr,Mr):er},function(kr){return Be=kr,x=kr(h),A=kr(_),M=kr(T),U=x===A?0:.5/(A-x),ie=A===M?0:.5/(M-A),Mr}}function Da(){var h=dl(Ja()(ms));return h.copy=function(){return Ln(h,Da())},Ar.apply(h,arguments)}function ji(){var h=Hn(Ja()).domain([.1,1,10]);return h.copy=function(){return Ln(h,ji()).base(h.base())},Ar.apply(h,arguments)}function va(){var h=ja(Ja());return h.copy=function(){return Ln(h,va()).constant(h.constant())},Ar.apply(h,arguments)}function ai(){var h=yo(Ja());return h.copy=function(){return Ln(h,ai()).exponent(h.exponent())},Ar.apply(h,arguments)}function Go(){return ai.apply(null,arguments).exponent(.5)}var bi,Ho,Zo,ns,gu,as,Yu,su,Ku,uu=/^(?:(?!0000)[0-9]{4}([-/.]+)(?:(?:0?[1-9]|1[0-2])\1(?:0?[1-9]|1[0-9]|2[0-8])|(?:0?[13-9]|1[0-2])\1(?:29|30)|(?:0?[13578]|1[02])\1(?:31))|(?:[0-9]{2}(?:0[48]|[2468][048]|[13579][26])|(?:0[48]|[2468][048]|[13579][26])00)([-/.]?)0?2\2(?:29))(\s+([01]|([01][0-9]|2[0-3])):([0-9]|[0-5][0-9]):([0-9]|[0-5][0-9]))?$/,Ws=(bi={},Se()(bi,E.ScaleTypes.LINEAR,ne),Se()(bi,E.ScaleTypes.POWER,Zi),Se()(bi,E.ScaleTypes.LOG,ea),Se()(bi,E.ScaleTypes.IDENTITY,se),Se()(bi,E.ScaleTypes.TIME,lt),Se()(bi,E.ScaleTypes.QUANTILE,qa),Se()(bi,E.ScaleTypes.QUANTIZE,lo),Se()(bi,E.ScaleTypes.THRESHOLD,iu),Se()(bi,E.ScaleTypes.CAT,Ei),bi),lu=(Ho=Object(ur.injectable)(),Zo=Object(ur.inject)(E.TYPES.IGlobalConfigService),ns=Object(ur.inject)(E.TYPES.ILogService),Ho(gu=(as=(Ku=function(){function h(){X()(this,h),Le()(this,"configService",Yu,this),Le()(this,"logger",su,this),this.scaleCache={},this.scaleOptions={}}return i()(h,[{key:"apply",value:function(T,x){var A=this,M=x.styleAttributeService;T.hooks.init.tap("FeatureScalePlugin",function(){A.scaleOptions=T.getScaleOptions();var U=M.getLayerStyleAttributes(),ie=T.getSource().data.dataArray;if(ie.length===0)return;A.caculateScalesForAttributes(U||[],ie)}),T.hooks.beforeRenderData.tap("FeatureScalePlugin",function(){A.scaleOptions=T.getScaleOptions();var U=M.getLayerStyleAttributes(),ie=T.getSource().data.dataArray;return A.caculateScalesForAttributes(U||[],ie),T.layerModelNeedUpdate=!0,!0}),T.hooks.beforeRender.tap("FeatureScalePlugin",function(){if(T.layerModelNeedUpdate)return;A.scaleOptions=T.getScaleOptions();var U=M.getLayerStyleAttributes();if(U){var ie=T.getSource().data.dataArray;if(ie.length===0)return;var de=U.filter(function(Be){return Be.needRescale});de.length&&(A.caculateScalesForAttributes(de,ie),A.logger.debug("rescale finished"))}})}},{key:"isNumber",value:function(T){return!isNaN(parseFloat(T))&&isFinite(T)}},{key:"caculateScalesForAttributes",value:function(T,x){var A=this;this.scaleCache={},T.forEach(function(M){if(M.scale){var U=M.scale,ie=M.name;U.names=A.parseFields(M.scale.field||[]);var de=[];U.names.forEach(function(Be){de.push(A.getOrCreateScale(Be,M,x))}),de.some(function(Be){return Be.type===E.StyleScaleType.VARIABLE})?(U.type=E.StyleScaleType.VARIABLE,de.forEach(function(Be){if(!U.callback){var zt;if(U.values&&U.values!=="text"){var er;if(((er=Be.option)===null||er===void 0?void 0:er.type)==="linear"&&U.values.length>2){var Mr=Be.scale.ticks(U.values.length);ie==="color"&&Be.scale.domain(Mr)}Be.scale.range(U.values)}else((zt=Be.option)===null||zt===void 0?void 0:zt.type)==="cat"&&Be.scale.range(Be.option.domain)}})):(U.type=E.StyleScaleType.CONSTANT,U.defaultValues=de.map(function(Be,zt){return Be.scale(U.names[zt])})),U.scalers=de.map(function(Be){return{field:Be.field,func:Be.scale,option:Be.option}}),M.needRescale=!1}})}},{key:"getOrCreateScale",value:function(T,x,A){var M,U=[T,x.name].join("_"),ie=(M=x.scale)===null||M===void 0?void 0:M.values,de=this.createScale(T,x.name,ie,A);return de}},{key:"parseFields",value:function(T){return Array.isArray(T)?T:ec()(T)?T.split("*"):[T]}},{key:"createScale",value:function(T,x,A,M){var U,ie=this.scaleOptions[x]&&this.scaleOptions[x].field===T?this.scaleOptions[x]:this.scaleOptions[T],de={field:T,scale:void 0,type:E.StyleScaleType.VARIABLE,option:ie};if(!M||!M.length)return ie&&ie.type?de.scale=this.createDefaultScale(ie):(de.scale=Ei([T]),de.type=E.StyleScaleType.CONSTANT),de;var Be=(U=M.find(function(Mr){return!no()(Mr[T])}))===null||U===void 0?void 0:U[T];if(this.isNumber(T)||no()(Be)&&!ie)de.scale=Ei([T]),de.type=E.StyleScaleType.CONSTANT;else{var zt=ie&&ie.type||this.getDefaultType(Be);A==="text"&&(zt=E.ScaleTypes.CAT);var er=this.createDefaultScaleConfig(zt,T,M);Object.assign(er,ie),de.scale=this.createDefaultScale(er),de.option=er}return de}},{key:"getDefaultType",value:function(T){var x=E.ScaleTypes.LINEAR;return typeof T=="string"&&(x=uu.test(T)?E.ScaleTypes.TIME:E.ScaleTypes.CAT),x}},{key:"createDefaultScaleConfig",value:function(T,x,A){var M={type:T},U=(A==null?void 0:A.map(function(ie){return ie[x]}))||[];return T!==E.ScaleTypes.CAT&&T!==E.ScaleTypes.QUANTILE?M.domain=Al(U):T===E.ScaleTypes.CAT?M.domain=ws()(U):T===E.ScaleTypes.QUANTILE&&(M.domain=U),M}},{key:"createDefaultScale",value:function(T){var x=T.type,A=T.domain,M=Ws[x]();return A&&M.domain(A),M}}]),h}(),Ku),Yu=Je()(as.prototype,"configService",[Zo],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),su=Je()(as.prototype,"logger",[ns],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),as))||gu),mi,ii,Ji,fo,yu,Eo,Wo,Ru;function di(h,_){var T=Object.keys(h);if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(h);_&&(x=x.filter(function(A){return Object.getOwnPropertyDescriptor(h,A).enumerable})),T.push.apply(T,x)}return T}function Zf(h){for(var _=1;_<arguments.length;_++){var T=arguments[_]!=null?arguments[_]:{};_%2?di(Object(T),!0).forEach(function(x){Se()(h,x,T[x])}):Object.getOwnPropertyDescriptors?Object.defineProperties(h,Object.getOwnPropertyDescriptors(T)):di(Object(T)).forEach(function(x){Object.defineProperty(h,x,Object.getOwnPropertyDescriptor(T,x))})}return h}var Zc=(mi=Object(ur.injectable)(),ii=Object(ur.inject)(E.TYPES.ICameraService),Ji=Object(ur.inject)(E.TYPES.IRendererService),mi(fo=(yu=(Ru=function(){function h(){X()(this,h),Le()(this,"cameraService",Eo,this),Le()(this,"rendererService",Wo,this)}return i()(h,[{key:"apply",value:function(T){T.hooks.beforeRender.tap("LayerAnimateStylePlugin",function(){T.models.forEach(function(x){x.addUniforms(Zf({},T.layerModel.getAnimateUniforms()))})})}}]),h}(),Ru),Eo=Je()(yu.prototype,"cameraService",[ii],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Wo=Je()(yu.prototype,"rendererService",[Ji],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yu))||fo),cf,dc,Iu=(cf=Object(ur.injectable)(),cf(dc=function(){function h(){X()(this,h)}return i()(h,[{key:"apply",value:function(T){T.hooks.init.tap("LayerModelPlugin",function(){T.prepareBuildModel(),T.buildModels(),T.styleNeedUpdate=!1}),T.hooks.beforeRenderData.tap("DataSourcePlugin",function(){return T.prepareBuildModel(),T.clearModels(),T.buildModels(),T.layerModelNeedUpdate=!1,!1})}}]),h}())||dc),Pf,Lf,Wf=(Pf=Object(ur.injectable)(),Pf(Lf=function(){function h(){X()(this,h)}return i()(h,[{key:"apply",value:function(T){T.hooks.afterInit.tap("LayerStylePlugin",function(){T.updateLayerConfig({});var x=T.getLayerConfig(),A=x.autoFit,M=x.fitBoundsOptions;A&&setTimeout(function(){T.fitBounds(M)},100)})}}]),h}())||Lf),_h,_f;function Sh(h,_){var T=Object.keys(h);if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(h);_&&(x=x.filter(function(A){return Object.getOwnPropertyDescriptor(h,A).enumerable})),T.push.apply(T,x)}return T}function Xf(h){for(var _=1;_<arguments.length;_++){var T=arguments[_]!=null?arguments[_]:{};_%2?Sh(Object(T),!0).forEach(function(x){Se()(h,x,T[x])}):Object.getOwnPropertyDescriptors?Object.defineProperties(h,Object.getOwnPropertyDescriptors(T)):Sh(Object(T)).forEach(function(x){Object.defineProperty(h,x,Object.getOwnPropertyDescriptor(T,x))})}return h}var hh={directional:{lights:"u_DirectionalLights",num:"u_NumOfDirectionalLights"},spot:{lights:"u_SpotLights",num:"u_NumOfSpotLights"}},Zh={type:"directional",direction:[1,10.5,12],ambient:[.2,.2,.2],diffuse:[.6,.6,.6],specular:[.1,.1,.1]},kh={direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0]},Wh={position:[0,0,0],direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0],constant:1,linear:0,quadratic:0,angle:14,exponent:40,blur:5},dh=["ambient","diffuse","specular"];function Ah(h){var _={u_DirectionalLights:new Array(3).fill(Xf({},kh)),u_NumOfDirectionalLights:0,u_SpotLights:new Array(3).fill(Xf({},Wh)),u_NumOfSpotLights:0};return(!h||!h.length)&&(h=[Zh]),h.forEach(function(T,x){var A=T.type,M=A===void 0?"directional":A,U=Xe()(T,["type"]),ie=hh[M].lights,de=hh[M].num,Be=_[de];_[ie][Be]=Xf(Xf({},_[ie][Be]),U),_[de]++}),_}var Xh=(_h=Object(ur.injectable)(),_h(_f=function(){function h(){X()(this,h)}return i()(h,[{key:"apply",value:function(T){T.hooks.beforeRender.tap("LightingPlugin",function(){var x=T.getLayerConfig(),A=x.enableLighting;A&&T.models.forEach(function(M){return M.addUniforms(Xf({},Ah()))})})}}]),h}())||_f),ph,Yf,nh={NONE:0,ENCODE:1,HIGHLIGHT:2},Yh=(ph=Object(ur.injectable)(),ph(Yf=function(){function h(){X()(this,h)}return i()(h,[{key:"apply",value:function(T,x){var A=x.rendererService,M=x.styleAttributeService;T.hooks.init.tap("PixelPickingPlugin",function(){var U=T.getLayerConfig(),ie=U.enablePicking;M.registerStyleAttribute({name:"pickingColor",type:E.AttributeType.Attribute,descriptor:{name:"a_PickingColor",buffer:{data:[],type:E.gl.FLOAT},size:3,update:function(Be,zt){var er=Be.id;return ie?Object(Me.l)(er):[0,0,0]}}})}),T.hooks.beforePickingEncode.tap("PixelPickingPlugin",function(){var U=T.getLayerConfig(),ie=U.enablePicking;ie&&T.isVisible()&&T.models.forEach(function(de){return de.addUniforms({u_PickingStage:nh.ENCODE})})}),T.hooks.afterPickingEncode.tap("PixelPickingPlugin",function(){var U=T.getLayerConfig(),ie=U.enablePicking;ie&&T.isVisible()&&T.models.forEach(function(de){return de.addUniforms({u_PickingStage:nh.HIGHLIGHT})})}),T.hooks.beforeHighlight.tap("PixelPickingPlugin",function(U){var ie=T.getLayerConfig(),de=ie.highlightColor,Be=typeof de=="string"?Object(Me.s)(de):de||[1,0,0,1];T.updateLayerConfig({pickedFeatureID:Object(Me.k)(new Uint8Array(U))}),T.models.forEach(function(zt){return zt.addUniforms({u_PickingStage:nh.HIGHLIGHT,u_PickingColor:U,u_HighlightColor:Be.map(function(er){return er*255})})})}),T.hooks.beforeSelect.tap("PixelPickingPlugin",function(U){var ie=T.getLayerConfig(),de=ie.selectColor,Be=typeof de=="string"?Object(Me.s)(de):de||[1,0,0,1];T.updateLayerConfig({pickedFeatureID:Object(Me.k)(new Uint8Array(U))}),T.models.forEach(function(zt){return zt.addUniforms({u_PickingStage:nh.HIGHLIGHT,u_PickingColor:U,u_HighlightColor:Be.map(function(er){return er*255})})})})}}]),h}())||Yf),jh,mh,Fh,Ch,vh,zh,Uh=(jh=Object(ur.injectable)(),mh=Object(ur.inject)(E.TYPES.ILogService),jh(Fh=(Ch=(zh=function(){function h(){X()(this,h),Le()(this,"logger",vh,this)}return i()(h,[{key:"apply",value:function(T,x){var A=this,M=x.styleAttributeService;T.hooks.init.tap("RegisterStyleAttributePlugin",function(){A.registerBuiltinAttributes(M)})}},{key:"registerBuiltinAttributes",value:function(T){T.registerStyleAttribute({name:"position",type:E.AttributeType.Attribute,descriptor:{name:"a_Position",buffer:{data:[],type:E.gl.FLOAT},size:3,update:function(A,M,U){return U.length===2?[U[0],U[1],0]:[U[0],U[1],U[2]]}}}),T.registerStyleAttribute({name:"filter",type:E.AttributeType.Attribute,descriptor:{name:"filter",buffer:{usage:E.gl.DYNAMIC_DRAW,data:[],type:E.gl.FLOAT},size:1,update:function(A,M){var U=A.filter;return U?[1]:[0]}}}),T.registerStyleAttribute({name:"color",type:E.AttributeType.Attribute,descriptor:{name:"a_Color",buffer:{usage:E.gl.DYNAMIC_DRAW,data:[],type:E.gl.FLOAT},size:4,update:function(A,M){var U=A.color;return!U||!U.length?[1,1,1,1]:U}}})}}]),h}(),zh),vh=Je()(Ch.prototype,"logger",[mh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ch))||Fh),wh,Oh,gh,Mh,yh,Rf,Ph,Kh,$h,nd,ad=(wh=Object(ur.injectable)(),Oh=Object(ur.inject)(E.TYPES.ICameraService),gh=Object(ur.inject)(E.TYPES.ICoordinateSystemService),Mh=Object(ur.inject)(E.TYPES.IRendererService),wh(yh=(Rf=(nd=function(){function h(){X()(this,h),Le()(this,"cameraService",Ph,this),Le()(this,"coordinateSystemService",Kh,this),Le()(this,"rendererService",$h,this)}return i()(h,[{key:"apply",value:function(T){var x=this;T.hooks.beforeRender.tap("ShaderUniformPlugin",function(){x.coordinateSystemService.refresh();var A=x.rendererService.getViewportSize(),M=A.width,U=A.height;T.models.forEach(function(ie){var de;return ie.addUniforms((de={},Se()(de,E.CameraUniform.ProjectionMatrix,x.cameraService.getProjectionMatrix()),Se()(de,E.CameraUniform.ViewMatrix,x.cameraService.getViewMatrix()),Se()(de,E.CameraUniform.ViewProjectionMatrix,x.cameraService.getViewProjectionMatrix()),Se()(de,E.CameraUniform.Zoom,x.cameraService.getZoom()),Se()(de,E.CameraUniform.ZoomScale,x.cameraService.getZoomScale()),Se()(de,E.CameraUniform.FocalDistance,x.cameraService.getFocalDistance()),Se()(de,E.CameraUniform.CameraPosition,x.cameraService.getCameraPosition()),Se()(de,E.CoordinateUniform.CoordinateSystem,x.coordinateSystemService.getCoordinateSystem()),Se()(de,E.CoordinateUniform.ViewportCenter,x.coordinateSystemService.getViewportCenter()),Se()(de,E.CoordinateUniform.ViewportCenterProjection,x.coordinateSystemService.getViewportCenterProjection()),Se()(de,E.CoordinateUniform.PixelsPerDegree,x.coordinateSystemService.getPixelsPerDegree()),Se()(de,E.CoordinateUniform.PixelsPerDegree2,x.coordinateSystemService.getPixelsPerDegree2()),Se()(de,E.CoordinateUniform.PixelsPerMeter,x.coordinateSystemService.getPixelsPerMeter()),Se()(de,"u_ViewportSize",[M,U]),Se()(de,"u_DevicePixelRatio",window.devicePixelRatio),Se()(de,"u_ModelMatrix",[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),Se()(de,"u_PickingBuffer",T.getLayerConfig().pickingBuffer||0),de))})})}}]),h}(),nd),Ph=Je()(Rf.prototype,"cameraService",[Oh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Kh=Je()(Rf.prototype,"coordinateSystemService",[gh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$h=Je()(Rf.prototype,"rendererService",[Mh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Rf))||yh),id,Jh,Ed=(id=Object(ur.injectable)(),id(Jh=function(){function h(){X()(this,h)}return i()(h,[{key:"apply",value:function(T){T.hooks.beforeRender.tap("UpdateModelPlugin",function(){T.layerModel&&T.layerModel.needUpdate()})}}]),h}())||Jh),fd,Lh,xs,Wc,hd,Kf,od=(fd=Object(ur.injectable)(),Lh=Object(ur.inject)(E.TYPES.ILogService),fd(xs=(Wc=(Kf=function(){function h(){X()(this,h),Le()(this,"logger",hd,this)}return i()(h,[{key:"apply",value:function(T,x){var A=this,M=x.styleAttributeService;T.hooks.init.tap("UpdateStyleAttributePlugin",function(){A.initStyleAttribute(T,{styleAttributeService:M})}),T.hooks.beforeRender.tap("UpdateStyleAttributePlugin",function(){if(T.layerModelNeedUpdate)return;A.updateStyleAtrribute(T,{styleAttributeService:M})})}},{key:"updateStyleAtrribute",value:function(T,x){var A=this,M=x.styleAttributeService,U=M.getLayerStyleAttributes()||[],ie=M.getLayerStyleAttribute("filter"),de=M.getLayerStyleAttribute("shape");if(ie&&ie.needRegenerateVertices||de&&de.needRegenerateVertices){T.layerModelNeedUpdate=!0,U.forEach(function(Be){return Be.needRegenerateVertices=!1});return}U.filter(function(Be){return Be.needRegenerateVertices}).forEach(function(Be){M.updateAttributeByFeatureRange(Be.name,T.getEncodedData(),Be.featureRange.startIndex,Be.featureRange.endIndex),Be.needRegenerateVertices=!1,A.logger.debug("regenerate vertex attributes: ".concat(Be.name," finished"))})}},{key:"initStyleAttribute",value:function(T,x){var A=this,M=x.styleAttributeService,U=M.getLayerStyleAttributes()||[];U.filter(function(ie){return ie.needRegenerateVertices}).forEach(function(ie){M.updateAttributeByFeatureRange(ie.name,T.getEncodedData(),ie.featureRange.startIndex,ie.featureRange.endIndex),ie.needRegenerateVertices=!1,A.logger.debug("init vertex attributes: ".concat(ie.name," finished"))})}}]),h}(),Kf),hd=Je()(Wc.prototype,"logger",[Lh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Wc))||xs);E.container.bind(E.TYPES.ILayerPlugin).to(Do).inRequestScope(),E.container.bind(E.TYPES.ILayerPlugin).to(Uh).inRequestScope(),E.container.bind(E.TYPES.ILayerPlugin).to(lu).inRequestScope(),E.container.bind(E.TYPES.ILayerPlugin).to(xc).inRequestScope(),E.container.bind(E.TYPES.ILayerPlugin).to(Wf).inRequestScope(),E.container.bind(E.TYPES.ILayerPlugin).to(od).inRequestScope(),E.container.bind(E.TYPES.ILayerPlugin).to(Ed).inRequestScope(),E.container.bind(E.TYPES.ILayerPlugin).to(it).inRequestScope(),E.container.bind(E.TYPES.ILayerPlugin).to(ad).inRequestScope(),E.container.bind(E.TYPES.ILayerPlugin).to(Zc).inRequestScope(),E.container.bind(E.TYPES.ILayerPlugin).to(Xh).inRequestScope(),E.container.bind(E.TYPES.ILayerPlugin).to(Yh).inRequestScope(),E.container.bind(E.TYPES.ILayerPlugin).to(Iu).inRequestScope()},t2Dn:function(Ue,g,o){var E=o("hypo"),p=o("ljhN");function X(F,i,Z){(Z!==void 0&&!p(F[i],Z)||Z===void 0&&!(i in F))&&E(F,i,Z)}Ue.exports=X},u6S6:function(Ue,g,o){var E=o("6acW"),p=o("sgoq"),X=p(function(F,i,Z){return i=i.toLowerCase(),F+(Z?E(i):i)});Ue.exports=X},uhBA:function(Ue,g,o){"use strict";var E=Object.prototype.hasOwnProperty,p="~";function X(){}Object.create&&(X.prototype=Object.create(null),new X().__proto__||(p=!1));function F(J,ee,ce){this.fn=J,this.context=ee,this.once=ce||!1}function i(J,ee,ce,Y,ze){if(typeof ce!="function")throw new TypeError("The listener must be a function");var Xe=new F(ce,Y||J,ze),be=p?p+ee:ee;return J._events[be]?J._events[be].fn?J._events[be]=[J._events[be],Xe]:J._events[be].push(Xe):(J._events[be]=Xe,J._eventsCount++),J}function Z(J,ee){--J._eventsCount===0?J._events=new X:delete J._events[ee]}function D(){this._events=new X,this._eventsCount=0}D.prototype.eventNames=function(){var ee=[],ce,Y;if(this._eventsCount===0)return ee;for(Y in ce=this._events)E.call(ce,Y)&&ee.push(p?Y.slice(1):Y);return Object.getOwnPropertySymbols?ee.concat(Object.getOwnPropertySymbols(ce)):ee},D.prototype.listeners=function(ee){var ce=p?p+ee:ee,Y=this._events[ce];if(!Y)return[];if(Y.fn)return[Y.fn];for(var ze=0,Xe=Y.length,be=new Array(Xe);ze<Xe;ze++)be[ze]=Y[ze].fn;return be},D.prototype.listenerCount=function(ee){var ce=p?p+ee:ee,Y=this._events[ce];return Y?Y.fn?1:Y.length:0},D.prototype.emit=function(ee,ce,Y,ze,Xe,be){var Se=p?p+ee:ee;if(!this._events[Se])return!1;var mt=this._events[Se],Le=arguments.length,St,Ye;if(mt.fn){mt.once&&this.removeListener(ee,mt.fn,void 0,!0);switch(Le){case 1:return mt.fn.call(mt.context),!0;case 2:return mt.fn.call(mt.context,ce),!0;case 3:return mt.fn.call(mt.context,ce,Y),!0;case 4:return mt.fn.call(mt.context,ce,Y,ze),!0;case 5:return mt.fn.call(mt.context,ce,Y,ze,Xe),!0;case 6:return mt.fn.call(mt.context,ce,Y,ze,Xe,be),!0}for(Ye=1,St=new Array(Le-1);Ye<Le;Ye++)St[Ye-1]=arguments[Ye];mt.fn.apply(mt.context,St)}else{var dt=mt.length,Je;for(Ye=0;Ye<dt;Ye++){mt[Ye].once&&this.removeListener(ee,mt[Ye].fn,void 0,!0);switch(Le){case 1:mt[Ye].fn.call(mt[Ye].context);break;case 2:mt[Ye].fn.call(mt[Ye].context,ce);break;case 3:mt[Ye].fn.call(mt[Ye].context,ce,Y);break;case 4:mt[Ye].fn.call(mt[Ye].context,ce,Y,ze);break;default:if(!St)for(Je=1,St=new Array(Le-1);Je<Le;Je++)St[Je-1]=arguments[Je];mt[Ye].fn.apply(mt[Ye].context,St)}}}return!0},D.prototype.on=function(ee,ce,Y){return i(this,ee,ce,Y,!1)},D.prototype.once=function(ee,ce,Y){return i(this,ee,ce,Y,!0)},D.prototype.removeListener=function(ee,ce,Y,ze){var Xe=p?p+ee:ee;if(!this._events[Xe])return this;if(!ce)return Z(this,Xe),this;var be=this._events[Xe];if(be.fn)be.fn===ce&&(!ze||be.once)&&(!Y||be.context===Y)&&Z(this,Xe);else{for(var Se=0,mt=[],Le=be.length;Se<Le;Se++)(be[Se].fn!==ce||ze&&!be[Se].once||Y&&be[Se].context!==Y)&&mt.push(be[Se]);mt.length?this._events[Xe]=mt.length===1?mt[0]:mt:Z(this,Xe)}return this},D.prototype.removeAllListeners=function(ee){var ce;return ee?(ce=p?p+ee:ee,this._events[ce]&&Z(this,ce)):(this._events=new X,this._eventsCount=0),this},D.prototype.off=D.prototype.removeListener,D.prototype.addListener=D.prototype.on,D.prefixed=p,D.EventEmitter=D,Ue.exports=D},ujMp:function(Ue,g,o){"use strict";Object.defineProperty(g,"__esModule",{value:!0}),g.circularDependencyToException=g.listMetadataForTarget=g.listRegisteredBindingsForServiceIdentifier=g.getServiceIdentifierAsString=g.getFunctionName=void 0;var E=o("MON2");function p(ee){if(typeof ee=="function"){var ce=ee;return ce.name}else{if(typeof ee=="symbol")return ee.toString();var ce=ee;return ce}}g.getServiceIdentifierAsString=p;function X(ee,ce,Y){var ze="",Xe=Y(ee,ce);return Xe.length!==0&&(ze=`
Registered bindings:`,Xe.forEach(function(be){var Se="Object";be.implementationType!==null&&(Se=J(be.implementationType)),ze=ze+`
 `+Se,be.constraint.metaData&&(ze=ze+" - "+be.constraint.metaData)})),ze}g.listRegisteredBindingsForServiceIdentifier=X;function F(ee,ce){return ee.parentRequest===null?!1:ee.parentRequest.serviceIdentifier===ce?!0:F(ee.parentRequest,ce)}function i(ee){function ce(ze,Xe){Xe===void 0&&(Xe=[]);var be=p(ze.serviceIdentifier);return Xe.push(be),ze.parentRequest!==null?ce(ze.parentRequest,Xe):Xe}var Y=ce(ee);return Y.reverse().join(" --> ")}function Z(ee){ee.childRequests.forEach(function(ce){if(F(ce,ce.serviceIdentifier)){var Y=i(ce);throw new Error(E.CIRCULAR_DEPENDENCY+" "+Y)}else Z(ce)})}g.circularDependencyToException=Z;function D(ee,ce){if(ce.isTagged()||ce.isNamed()){var Y="",ze=ce.getNamedTag(),Xe=ce.getCustomTags();return ze!==null&&(Y+=ze.toString()+`
`),Xe!==null&&Xe.forEach(function(be){Y+=be.toString()+`
`})," "+ee+`
 `+ee+" - "+Y}else return" "+ee}g.listMetadataForTarget=D;function J(ee){if(ee.name)return ee.name;var ce=ee.toString(),Y=ce.match(/^function\s*([^\s(]+)/);return Y?Y[1]:"Anonymous function: "+ce}g.getFunctionName=J},"vN+2":function(Ue,g){function o(){}Ue.exports=o},"w/wX":function(Ue,g,o){var E=o("QqLw"),p=o("ExA7"),X="[object Set]";function F(i){return p(i)&&E(i)==X}Ue.exports=F},w26f:function(Ue,g,o){(function(E){var p=200,X="__lodash_hash_undefined__",F=1/0,i="[object Function]",Z="[object GeneratorFunction]",D=/[\\^$.*+?()[\]{}|]/g,J=/^\[object .+?Constructor\]$/,ee=typeof E=="object"&&E&&E.Object===Object&&E,ce=typeof self=="object"&&self&&self.Object===Object&&self,Y=ee||ce||Function("return this")();function ze(pt,yt){var Ht=pt?pt.length:0;return!!Ht&&Se(pt,yt,0)>-1}function Xe(pt,yt,Ht){for(var hr=-1,Zr=pt?pt.length:0;++hr<Zr;)if(Ht(yt,pt[hr]))return!0;return!1}function be(pt,yt,Ht,hr){for(var Zr=pt.length,yr=Ht+(hr?1:-1);hr?yr--:++yr<Zr;)if(yt(pt[yr],yr,pt))return yr;return-1}function Se(pt,yt,Ht){if(yt!==yt)return be(pt,mt,Ht);for(var hr=Ht-1,Zr=pt.length;++hr<Zr;)if(pt[hr]===yt)return hr;return-1}function mt(pt){return pt!==pt}function Le(pt,yt){return pt.has(yt)}function St(pt,yt){return pt==null?void 0:pt[yt]}function Ye(pt){var yt=!1;if(pt!=null&&typeof pt.toString!="function")try{yt=!!(pt+"")}catch(Ht){}return yt}function dt(pt){var yt=-1,Ht=Array(pt.size);return pt.forEach(function(hr){Ht[++yt]=hr}),Ht}var Je=Array.prototype,wt=Function.prototype,At=Object.prototype,Ie=Y["__core-js_shared__"],Ne=function(){var pt=/[^.]+$/.exec(Ie&&Ie.keys&&Ie.keys.IE_PROTO||"");return pt?"Symbol(src)_1."+pt:""}(),Ve=wt.toString,ct=At.hasOwnProperty,Me=At.toString,ht=RegExp("^"+Ve.call(ct).replace(D,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Wt=Je.splice,Qt=ae(Y,"Map"),ur=ae(Y,"Set"),oe=ae(Object,"create");function $(pt){var yt=-1,Ht=pt?pt.length:0;for(this.clear();++yt<Ht;){var hr=pt[yt];this.set(hr[0],hr[1])}}function H(){this.__data__=oe?oe(null):{}}function Ae(pt){return this.has(pt)&&delete this.__data__[pt]}function ye(pt){var yt=this.__data__;if(oe){var Ht=yt[pt];return Ht===X?void 0:Ht}return ct.call(yt,pt)?yt[pt]:void 0}function Te(pt){var yt=this.__data__;return oe?yt[pt]!==void 0:ct.call(yt,pt)}function pe(pt,yt){var Ht=this.__data__;return Ht[pt]=oe&&yt===void 0?X:yt,this}$.prototype.clear=H,$.prototype.delete=Ae,$.prototype.get=ye,$.prototype.has=Te,$.prototype.set=pe;function it(pt){var yt=-1,Ht=pt?pt.length:0;for(this.clear();++yt<Ht;){var hr=pt[yt];this.set(hr[0],hr[1])}}function qt(){this.__data__=[]}function Pt(pt){var yt=this.__data__,Ht=_t(yt,pt);if(Ht<0)return!1;var hr=yt.length-1;return Ht==hr?yt.pop():Wt.call(yt,Ht,1),!0}function me(pt){var yt=this.__data__,Ht=_t(yt,pt);return Ht<0?void 0:yt[Ht][1]}function ve(pt){return _t(this.__data__,pt)>-1}function Ge(pt,yt){var Ht=this.__data__,hr=_t(Ht,pt);return hr<0?Ht.push([pt,yt]):Ht[hr][1]=yt,this}it.prototype.clear=qt,it.prototype.delete=Pt,it.prototype.get=me,it.prototype.has=ve,it.prototype.set=Ge;function st(pt){var yt=-1,Ht=pt?pt.length:0;for(this.clear();++yt<Ht;){var hr=pt[yt];this.set(hr[0],hr[1])}}function Oe(){this.__data__={hash:new $,map:new(Qt||it),string:new $}}function gt(pt){return qe(this,pt).delete(pt)}function C(pt){return qe(this,pt).get(pt)}function R(pt){return qe(this,pt).has(pt)}function q(pt,yt){return qe(this,pt).set(pt,yt),this}st.prototype.clear=Oe,st.prototype.delete=gt,st.prototype.get=C,st.prototype.has=R,st.prototype.set=q;function fe(pt){var yt=-1,Ht=pt?pt.length:0;for(this.__data__=new st;++yt<Ht;)this.add(pt[yt])}function He(pt){return this.__data__.set(pt,X),this}function et(pt){return this.__data__.has(pt)}fe.prototype.add=fe.prototype.push=He,fe.prototype.has=et;function _t(pt,yt){for(var Ht=pt.length;Ht--;)if(xt(pt[Ht][0],yt))return Ht;return-1}function ot(pt){if(!Et(pt)||kt(pt))return!1;var yt=bt(pt)||Ye(pt)?ht:J;return yt.test(pr(pt))}function Ut(pt,yt,Ht){var hr=-1,Zr=ze,yr=pt.length,Vn=!0,zn=[],oa=zn;if(Ht)Vn=!1,Zr=Xe;else if(yr>=p){var $n=yt?null:K(pt);if($n)return dt($n);Vn=!1,Zr=Le,oa=new fe}else oa=yt?[]:zn;e:for(;++hr<yr;){var Kn=pt[hr],Cn=yt?yt(Kn):Kn;if(Kn=Ht||Kn!==0?Kn:0,Vn&&Cn===Cn){for(var z=oa.length;z--;)if(oa[z]===Cn)continue e;yt&&oa.push(Cn),zn.push(Kn)}else Zr(oa,Cn,Ht)||(oa!==zn&&oa.push(Cn),zn.push(Kn))}return zn}var K=ur&&1/dt(new ur([,-0]))[1]==F?function(pt){return new ur(pt)}:Fe;function qe(pt,yt){var Ht=pt.__data__;return tt(yt)?Ht[typeof yt=="string"?"string":"hash"]:Ht.map}function ae(pt,yt){var Ht=St(pt,yt);return ot(Ht)?Ht:void 0}function tt(pt){var yt=typeof pt;return yt=="string"||yt=="number"||yt=="symbol"||yt=="boolean"?pt!=="__proto__":pt===null}function kt(pt){return!!Ne&&Ne in pt}function pr(pt){if(pt!=null){try{return Ve.call(pt)}catch(yt){}try{return pt+""}catch(yt){}}return""}function Ke(pt){return pt&&pt.length?Ut(pt):[]}function xt(pt,yt){return pt===yt||pt!==pt&&yt!==yt}function bt(pt){var yt=Et(pt)?Me.call(pt):"";return yt==i||yt==Z}function Et(pt){var yt=typeof pt;return!!pt&&(yt=="object"||yt=="function")}function Fe(){}Ue.exports=Ke}).call(this,o("yLpj"))},wclG:function(Ue,g,o){var E=o("pFRH"),p=o("88Gu"),X=p(E);Ue.exports=X},wnjb:function(Ue,g,o){"use strict";Object.defineProperty(g,"__esModule",{value:!0}),g.MetadataReader=void 0;var E=o("xfSm"),p=function(){function X(){}return X.prototype.getConstructorMetadata=function(F){var i=Reflect.getMetadata(E.PARAM_TYPES,F),Z=Reflect.getMetadata(E.TAGGED,F);return{compilerGeneratedMetadata:i,userGeneratedMetadata:Z||{}}},X.prototype.getPropertiesMetadata=function(F){var i=Reflect.getMetadata(E.TAGGED_PROP,F)||[];return i},X}();g.MetadataReader=p},wrZu:function(Ue,g,o){var E=o("+K+b"),p=o("XYm9"),X=o("b2z7"),F=o("otv/"),i=o("yP5f"),Z="[object Boolean]",D="[object Date]",J="[object Map]",ee="[object Number]",ce="[object RegExp]",Y="[object Set]",ze="[object String]",Xe="[object Symbol]",be="[object ArrayBuffer]",Se="[object DataView]",mt="[object Float32Array]",Le="[object Float64Array]",St="[object Int8Array]",Ye="[object Int16Array]",dt="[object Int32Array]",Je="[object Uint8Array]",wt="[object Uint8ClampedArray]",At="[object Uint16Array]",Ie="[object Uint32Array]";function Ne(Ve,ct,Me){var ht=Ve.constructor;switch(ct){case be:return E(Ve);case Z:case D:return new ht(+Ve);case Se:return p(Ve,Me);case mt:case Le:case St:case Ye:case dt:case Je:case wt:case At:case Ie:return i(Ve,Me);case J:return new ht;case ee:case ze:return new ht(Ve);case ce:return X(Ve);case Y:return new ht;case Xe:return F(Ve)}}Ue.exports=Ne},wy8a:function(Ue,g,o){var E=o("KxBF");function p(X,F,i){var Z=X.length;return i=i===void 0?Z:i,!F&&i>=Z?X:E(X,F,i)}Ue.exports=p},xfSm:function(Ue,g,o){"use strict";Object.defineProperty(g,"__esModule",{value:!0}),g.POST_CONSTRUCT=g.DESIGN_PARAM_TYPES=g.PARAM_TYPES=g.TAGGED_PROP=g.TAGGED=g.MULTI_INJECT_TAG=g.INJECT_TAG=g.OPTIONAL_TAG=g.UNMANAGED_TAG=g.NAME_TAG=g.NAMED_TAG=void 0,g.NAMED_TAG="named",g.NAME_TAG="name",g.UNMANAGED_TAG="unmanaged",g.OPTIONAL_TAG="optional",g.INJECT_TAG="inject",g.MULTI_INJECT_TAG="multi_inject",g.TAGGED="inversify:tagged",g.TAGGED_PROP="inversify:tagged_props",g.PARAM_TYPES="inversify:paramtypes",g.DESIGN_PARAM_TYPES="design:paramtypes",g.POST_CONSTRUCT="post_construct"},xfeJ:function(Ue,g){function o(E){return Function.toString.call(E).indexOf("[native code]")!==-1}Ue.exports=o},xiII:function(Ue,g,o){"use strict";Object.defineProperty(g,"__esModule",{value:!0}),g.Request=void 0;var E=o("d9O0"),p=function(){function X(F,i,Z,D,J){this.id=E.id(),this.serviceIdentifier=F,this.parentContext=i,this.parentRequest=Z,this.target=J,this.childRequests=[],this.bindings=Array.isArray(D)?D:[D],this.requestScope=Z===null?new Map:null}return X.prototype.addChildRequest=function(F,i,Z){var D=new X(F,this.parentContext,this,i,Z);return this.childRequests.push(D),D},X}();g.Request=p},xp6e:function(Ue,g,o){"use strict";(function(E){o.d(g,"a",function(){return ye}),o.d(g,"b",function(){return qt}),o.d(g,"c",function(){return oe}),o.d(g,"d",function(){return it});/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function p(Pt,me,ve,Ge){function st(Oe){return Oe instanceof ve?Oe:new ve(function(gt){gt(Oe)})}return new(ve||(ve=Promise))(function(Oe,gt){function C(fe){try{q(Ge.next(fe))}catch(He){gt(He)}}function R(fe){try{q(Ge.throw(fe))}catch(He){gt(He)}}function q(fe){fe.done?Oe(fe.value):st(fe.value).then(C,R)}q((Ge=Ge.apply(Pt,me||[])).next())})}function X(Pt,me){var ve={label:0,sent:function(){if(Oe[0]&1)throw Oe[1];return Oe[1]},trys:[],ops:[]},Ge,st,Oe,gt;return gt={next:C(0),throw:C(1),return:C(2)},typeof Symbol=="function"&&(gt[Symbol.iterator]=function(){return this}),gt;function C(q){return function(fe){return R([q,fe])}}function R(q){if(Ge)throw new TypeError("Generator is already executing.");for(;ve;)try{if(Ge=1,st&&(Oe=q[0]&2?st.return:q[0]?st.throw||((Oe=st.return)&&Oe.call(st),0):st.next)&&!(Oe=Oe.call(st,q[1])).done)return Oe;(st=0,Oe)&&(q=[q[0]&2,Oe.value]);switch(q[0]){case 0:case 1:Oe=q;break;case 4:return ve.label++,{value:q[1],done:!1};case 5:ve.label++,st=q[1],q=[0];continue;case 7:q=ve.ops.pop(),ve.trys.pop();continue;default:if(!(Oe=ve.trys,Oe=Oe.length>0&&Oe[Oe.length-1])&&(q[0]===6||q[0]===2)){ve=0;continue}if(q[0]===3&&(!Oe||q[1]>Oe[0]&&q[1]<Oe[3])){ve.label=q[1];break}if(q[0]===6&&ve.label<Oe[1]){ve.label=Oe[1],Oe=q;break}if(Oe&&ve.label<Oe[2]){ve.label=Oe[2],ve.ops.push(q);break}Oe[2]&&ve.ops.pop(),ve.trys.pop();continue}q=me.call(Pt,ve)}catch(fe){q=[6,fe],st=0}finally{Ge=Oe=0}if(q[0]&5)throw q[1];return{value:q[0]?q[1]:void 0,done:!0}}}function F(Pt,me){var ve=typeof Symbol=="function"&&Pt[Symbol.iterator];if(!ve)return Pt;var Ge=ve.call(Pt),st,Oe=[],gt;try{for(;(me===void 0||me-- >0)&&!(st=Ge.next()).done;)Oe.push(st.value)}catch(C){gt={error:C}}finally{try{st&&!st.done&&(ve=Ge.return)&&ve.call(Ge)}finally{if(gt)throw gt.error}}return Oe}function i(){for(var Pt=[],me=0;me<arguments.length;me++)Pt=Pt.concat(F(arguments[me]));return Pt}function Z(Pt){return Pt&&Pt.__esModule&&Object.prototype.hasOwnProperty.call(Pt,"default")?Pt.default:Pt}function D(Pt,me){return me={exports:{}},Pt(me,me.exports),me.exports}var J=D(function(Pt,me){Object.defineProperty(me,"__esModule",{value:!0}),me.default=ve;function ve(Ge){return Ge&&typeof Ge.length=="number"&&Ge.length>=0&&Ge.length%1===0}Pt.exports=me.default});Z(J);var ee=D(function(Pt,me){Object.defineProperty(me,"__esModule",{value:!0}),me.default=function(ve){return function(){for(var Ge=[],st=arguments.length;st--;)Ge[st]=arguments[st];var Oe=Ge.pop();return ve.call(this,Ge,Oe)}},Pt.exports=me.default});Z(ee);var ce=D(function(Pt,me){Object.defineProperty(me,"__esModule",{value:!0}),me.fallback=st,me.wrap=Oe;var ve=me.hasSetImmediate=typeof setImmediate=="function"&&setImmediate,Ge=me.hasNextTick=typeof E=="object"&&typeof E.nextTick=="function";function st(C){setTimeout(C,0)}function Oe(C){return function(R){for(var q=[],fe=arguments.length-1;fe-- >0;)q[fe]=arguments[fe+1];return C(function(){return R.apply(void 0,q)})}}var gt;ve?gt=setImmediate:Ge?gt=E.nextTick:gt=st,me.default=Oe(gt)});Z(ce);var Y=ce.fallback,ze=ce.wrap,Xe=ce.hasSetImmediate,be=ce.hasNextTick,Se=D(function(Pt,me){Object.defineProperty(me,"__esModule",{value:!0}),me.default=Oe;var ve=st(ee),Ge=st(ce);function st(R){return R&&R.__esModule?R:{default:R}}function Oe(R){return(0,mt.isAsync)(R)?function(){for(var q=[],fe=arguments.length;fe--;)q[fe]=arguments[fe];var He=q.pop(),et=R.apply(this,q);return gt(et,He)}:(0,ve.default)(function(q,fe){var He;try{He=R.apply(this,q)}catch(et){return fe(et)}if(He&&typeof He.then=="function")return gt(He,fe);fe(null,He)})}function gt(R,q){return R.then(function(fe){C(q,null,fe)},function(fe){C(q,fe&&fe.message?fe:new Error(fe))})}function C(R,q,fe){try{R(q,fe)}catch(He){(0,Ge.default)(function(et){throw et},He)}}Pt.exports=me.default});Z(Se);var mt=D(function(Pt,me){Object.defineProperty(me,"__esModule",{value:!0}),me.isAsyncIterable=me.isAsyncGenerator=me.isAsync=void 0;var ve=Ge(Se);function Ge(R){return R&&R.__esModule?R:{default:R}}function st(R){return R[Symbol.toStringTag]==="AsyncFunction"}function Oe(R){return R[Symbol.toStringTag]==="AsyncGenerator"}function gt(R){return typeof R[Symbol.asyncIterator]=="function"}function C(R){if(typeof R!="function")throw new Error("expected a function");return st(R)?(0,ve.default)(R):R}me.default=C,me.isAsync=st,me.isAsyncGenerator=Oe,me.isAsyncIterable=gt});Z(mt);var Le=mt.isAsyncIterable,St=mt.isAsyncGenerator,Ye=mt.isAsync,dt=D(function(Pt,me){Object.defineProperty(me,"__esModule",{value:!0}),me.default=ve;function ve(Ge,st){if(st===void 0&&(st=Ge.length),!st)throw new Error("arity is undefined");function Oe(){for(var gt=this,C=[],R=arguments.length;R--;)C[R]=arguments[R];return typeof C[st-1]=="function"?Ge.apply(this,C):new Promise(function(q,fe){C[st-1]=function(He){for(var et=[],_t=arguments.length-1;_t-- >0;)et[_t]=arguments[_t+1];if(He)return fe(He);q(et.length>1?et:et[0])},Ge.apply(gt,C)})}return Object.defineProperty(Oe,"name",{configurable:!0,value:"awaitable("+Ge.name+")"}),Oe}Pt.exports=me.default});Z(dt);var Je=D(function(Pt,me){Object.defineProperty(me,"__esModule",{value:!0});var ve=Oe(J),Ge=Oe(mt),st=Oe(dt);function Oe(gt){return gt&&gt.__esModule?gt:{default:gt}}me.default=(0,st.default)(function(gt,C,R){var q=(0,ve.default)(C)?[]:{};gt(C,function(fe,He,et){(0,Ge.default)(fe)(function(_t){for(var ot,Ut=[],K=arguments.length-1;K-- >0;)Ut[K]=arguments[K+1];Ut.length<2&&(ot=Ut,Ut=ot[0]),q[He]=Ut,et(_t)})},function(fe){return R(fe,q)})},3),Pt.exports=me.default});Z(Je);var wt=D(function(Pt,me){Object.defineProperty(me,"__esModule",{value:!0}),me.default=ve;function ve(Ge){function st(){for(var Oe=[],gt=arguments.length;gt--;)Oe[gt]=arguments[gt];if(Ge===null)return;var C=Ge;Ge=null,C.apply(this,Oe)}return Object.assign(st,Ge),st}Pt.exports=me.default});Z(wt);var At=D(function(Pt,me){Object.defineProperty(me,"__esModule",{value:!0}),me.default=function(ve){return ve[Symbol.iterator]&&ve[Symbol.iterator]()},Pt.exports=me.default});Z(At);var Ie=D(function(Pt,me){Object.defineProperty(me,"__esModule",{value:!0}),me.default=R;var ve=st(J),Ge=st(At);function st(q){return q&&q.__esModule?q:{default:q}}function Oe(q){var fe=-1,He=q.length;return function(){return++fe<He?{value:q[fe],key:fe}:null}}function gt(q){var fe=-1;return function(){var et=q.next();return et.done?null:(fe++,{value:et.value,key:fe})}}function C(q){var fe=q?Object.keys(q):[],He=-1,et=fe.length;return function(){var ot=fe[++He];return He<et?{value:q[ot],key:ot}:null}}function R(q){if((0,ve.default)(q))return Oe(q);var fe=(0,Ge.default)(q);return fe?gt(fe):C(q)}Pt.exports=me.default});Z(Ie);var Ne=D(function(Pt,me){Object.defineProperty(me,"__esModule",{value:!0}),me.default=ve;function ve(Ge){return function(){for(var st=[],Oe=arguments.length;Oe--;)st[Oe]=arguments[Oe];if(Ge===null)throw new Error("Callback was already called.");var gt=Ge;Ge=null,gt.apply(this,st)}}Pt.exports=me.default});Z(Ne);var Ve=D(function(Pt,me){Object.defineProperty(me,"__esModule",{value:!0});var ve={};me.default=ve,Pt.exports=me.default});Z(Ve);var ct=D(function(Pt,me){Object.defineProperty(me,"__esModule",{value:!0}),me.default=st;var ve=Ge(Ve);function Ge(Oe){return Oe&&Oe.__esModule?Oe:{default:Oe}}function st(Oe,gt,C,R){var q=!1,fe=!1,He=!1,et=0,_t=0;function ot(){if(et>=gt||He||q)return;He=!0,Oe.next().then(function(qe){var ae=qe.value,tt=qe.done;if(fe||q)return;if(He=!1,tt){q=!0,et<=0&&R(null);return}et++,C(ae,_t,Ut),_t++,ot()}).catch(K)}function Ut(qe,ae){if(et-=1,fe)return;if(qe)return K(qe);if(qe===!1){q=!0,fe=!0;return}if(ae===ve.default||q&&et<=0)return q=!0,R(null);ot()}function K(qe){if(fe)return;He=!1,q=!0,R(qe)}ot()}Pt.exports=me.default});Z(ct);var Me=D(function(Pt,me){Object.defineProperty(me,"__esModule",{value:!0});var ve=C(wt),Ge=C(Ie),st=C(Ne),Oe=C(ct),gt=C(Ve);function C(R){return R&&R.__esModule?R:{default:R}}me.default=function(R){return function(q,fe,He){if(He=(0,ve.default)(He),R<=0)throw new RangeError("concurrency limit cannot be less than 1");if(!q)return He(null);if((0,mt.isAsyncGenerator)(q))return(0,Oe.default)(q,R,fe,He);if((0,mt.isAsyncIterable)(q))return(0,Oe.default)(q[Symbol.asyncIterator](),R,fe,He);var et=(0,Ge.default)(q),_t=!1,ot=!1,Ut=0,K=!1;function qe(tt,kt){if(ot)return;if(Ut-=1,tt)_t=!0,He(tt);else if(tt===!1)_t=!0,ot=!0;else{if(kt===gt.default||_t&&Ut<=0)return _t=!0,He(null);K||ae()}}function ae(){for(K=!0;Ut<R&&!_t;){var tt=et();if(tt===null){_t=!0,Ut<=0&&He(null);return}Ut+=1,fe(tt.value,tt.key,(0,st.default)(qe))}K=!1}ae()}},Pt.exports=me.default});Z(Me);var ht=D(function(Pt,me){Object.defineProperty(me,"__esModule",{value:!0});var ve=Oe(Me),Ge=Oe(mt),st=Oe(dt);function Oe(C){return C&&C.__esModule?C:{default:C}}function gt(C,R,q,fe){return(0,ve.default)(R)(C,(0,Ge.default)(q),fe)}me.default=(0,st.default)(gt,4),Pt.exports=me.default});Z(ht);var Wt=D(function(Pt,me){Object.defineProperty(me,"__esModule",{value:!0});var ve=st(ht),Ge=st(dt);function st(gt){return gt&&gt.__esModule?gt:{default:gt}}function Oe(gt,C,R){return(0,ve.default)(gt,1,C,R)}me.default=(0,Ge.default)(Oe,3),Pt.exports=me.default});Z(Wt);var Qt=D(function(Pt,me){Object.defineProperty(me,"__esModule",{value:!0}),me.default=Oe;var ve=st(Je),Ge=st(Wt);function st(gt){return gt&&gt.__esModule?gt:{default:gt}}function Oe(gt,C){return(0,ve.default)(Ge.default,gt,C)}Pt.exports=me.default}),ur=Z(Qt),oe=function(){function Pt(){for(var me=arguments,ve=[],Ge=0;Ge<arguments.length;Ge++)ve[Ge]=me[Ge];this.args=[],this.tasks=[]}return Pt.prototype.call=function(){for(var me=arguments,ve=[],Ge=0;Ge<arguments.length;Ge++)ve[Ge]=me[Ge];return this.args=ve,ur(this.tasks)},Pt.prototype.tap=function(me,ve){var Ge=this;this.tasks.push(function(st){ve.apply(void 0,i(Ge.args)),st(null,me)})},Pt}(),$=D(function(Pt,me){Object.defineProperty(me,"__esModule",{value:!0});var ve=q(J),Ge=q(Ve),st=q(ht),Oe=q(wt),gt=q(Ne),C=q(mt),R=q(dt);function q(_t){return _t&&_t.__esModule?_t:{default:_t}}function fe(_t,ot,Ut){Ut=(0,Oe.default)(Ut);var K=0,qe=0,ae=_t.length,tt=!1;ae===0&&Ut(null);function kt(pr,Ke){if(pr===!1&&(tt=!0),tt===!0)return;pr?Ut(pr):(++qe===ae||Ke===Ge.default)&&Ut(null)}for(;K<ae;K++)ot(_t[K],K,(0,gt.default)(kt))}function He(_t,ot,Ut){return(0,st.default)(_t,Infinity,ot,Ut)}function et(_t,ot,Ut){var K=(0,ve.default)(_t)?fe:He;return K(_t,(0,C.default)(ot),Ut)}me.default=(0,R.default)(et,3),Pt.exports=me.default});Z($);var H=D(function(Pt,me){Object.defineProperty(me,"__esModule",{value:!0}),me.default=Oe;var ve=st($),Ge=st(Je);function st(gt){return gt&&gt.__esModule?gt:{default:gt}}function Oe(gt,C){return(0,Ge.default)(ve.default,gt,C)}Pt.exports=me.default}),Ae=Z(H),ye=function(){function Pt(){for(var me=arguments,ve=[],Ge=0;Ge<arguments.length;Ge++)ve[Ge]=me[Ge];this.tasks=[]}return Pt.prototype.promise=function(){for(var me=arguments,ve=[],Ge=0;Ge<arguments.length;Ge++)ve[Ge]=me[Ge];return Ae(this.tasks)},Pt.prototype.tapPromise=function(me,ve){var Ge=this;this.tasks.push(function(st){return p(Ge,void 0,void 0,function(){return X(this,function(Oe){switch(Oe.label){case 0:return[4,ve()];case 1:return Oe.sent(),st(null,me),[2]}})})})},Pt}(),Te=D(function(Pt,me){Object.defineProperty(me,"__esModule",{value:!0});var ve=gt(wt),Ge=gt(Ne),st=gt(mt),Oe=gt(dt);function gt(R){return R&&R.__esModule?R:{default:R}}function C(R,q){if(q=(0,ve.default)(q),!Array.isArray(R))return q(new Error("First argument to waterfall must be an array of functions"));if(!R.length)return q();var fe=0;function He(_t){var ot=(0,st.default)(R[fe++]);ot.apply(void 0,_t.concat([(0,Ge.default)(et)]))}function et(_t){for(var ot=[],Ut=arguments.length-1;Ut-- >0;)ot[Ut]=arguments[Ut+1];if(_t===!1)return;if(_t||fe===R.length)return q.apply(void 0,[_t].concat(ot));He(ot)}He([])}me.default=(0,Oe.default)(C),Pt.exports=me.default}),pe=Z(Te),it=function(){function Pt(){for(var me=arguments,ve=[],Ge=0;Ge<arguments.length;Ge++)ve[Ge]=me[Ge];this.tasks=[]}return Pt.prototype.call=function(){for(var me=arguments,ve=[],Ge=0;Ge<arguments.length;Ge++)ve[Ge]=me[Ge];return pe(this.tasks)},Pt.prototype.tap=function(me,ve){this.tasks.length===0?this.tasks.push(function(Ge){var st=ve();Ge(st?null:!1,st)}):this.tasks.push(function(Ge,st){var Oe=ve();st(Oe?null:!1,me)})},Pt}(),qt=function(){function Pt(){for(var me=arguments,ve=[],Ge=0;Ge<arguments.length;Ge++)ve[Ge]=me[Ge];this.tasks=[]}return Pt.prototype.call=function(){for(var me=arguments,ve=[],Ge=0;Ge<arguments.length;Ge++)ve[Ge]=me[Ge];return ur(this.tasks)},Pt.prototype.tap=function(me,ve){this.tasks.push(function(Ge){var st=ve();Ge(st,me)})},Pt}()}).call(this,o("Q2Ig"))},yG8O:function(Ue,g){function o(E,p,X,F){if(!X)return;Object.defineProperty(E,p,{enumerable:X.enumerable,configurable:X.configurable,writable:X.writable,value:X.initializer?X.initializer.call(F):void 0})}Ue.exports=o},yHx3:function(Ue,g){var o=Object.prototype,E=o.hasOwnProperty;function p(X){var F=X.length,i=new X.constructor(F);return F&&typeof X[0]=="string"&&E.call(X,"index")&&(i.index=X.index,i.input=X.input),i}Ue.exports=p},yLV6:function(Ue,g,o){var E;/*! Hammer.JS - v2.0.7 - 2016-04-22
* http://hammerjs.github.io/
*
* Copyright (c) 2016 Jorik Tangelder;
* Licensed under the MIT license */(function(p,X,F,i){"use strict";var Z=["","webkit","Moz","MS","ms","o"],D=X.createElement("div"),J="function",ee=Math.round,ce=Math.abs,Y=Date.now;function ze(Vt,Re,Dt){return setTimeout(dt(Vt,Dt),Re)}function Xe(Vt,Re,Dt){return Array.isArray(Vt)?(be(Vt,Dt[Re],Dt),!0):!1}function be(Vt,Re,Dt){var vr;if(!Vt)return;if(Vt.forEach)Vt.forEach(Re,Dt);else if(Vt.length!==i)for(vr=0;vr<Vt.length;)Re.call(Dt,Vt[vr],vr,Vt),vr++;else for(vr in Vt)Vt.hasOwnProperty(vr)&&Re.call(Dt,Vt[vr],vr,Vt)}function Se(Vt,Re,Dt){var vr="DEPRECATED METHOD: "+Re+`
`+Dt+` AT 
`;return function(){var en=new Error("get-stack-trace"),Tn=en&&en.stack?en.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",Gn=p.console&&(p.console.warn||p.console.log);return Gn&&Gn.call(p.console,vr,Tn),Vt.apply(this,arguments)}}var mt;typeof Object.assign!="function"?mt=function(Re){if(Re===i||Re===null)throw new TypeError("Cannot convert undefined or null to object");for(var Dt=Object(Re),vr=1;vr<arguments.length;vr++){var en=arguments[vr];if(en!==i&&en!==null)for(var Tn in en)en.hasOwnProperty(Tn)&&(Dt[Tn]=en[Tn])}return Dt}:mt=Object.assign;var Le=Se(function(Re,Dt,vr){for(var en=Object.keys(Dt),Tn=0;Tn<en.length;)(!vr||vr&&Re[en[Tn]]===i)&&(Re[en[Tn]]=Dt[en[Tn]]),Tn++;return Re},"extend","Use `assign`."),St=Se(function(Re,Dt){return Le(Re,Dt,!0)},"merge","Use `assign`.");function Ye(Vt,Re,Dt){var vr=Re.prototype,en;en=Vt.prototype=Object.create(vr),en.constructor=Vt,en._super=vr,Dt&&mt(en,Dt)}function dt(Vt,Re){return function(){return Vt.apply(Re,arguments)}}function Je(Vt,Re){return typeof Vt==J?Vt.apply(Re&&Re[0]||i,Re):Vt}function wt(Vt,Re){return Vt===i?Re:Vt}function At(Vt,Re,Dt){be(ct(Re),function(vr){Vt.addEventListener(vr,Dt,!1)})}function Ie(Vt,Re,Dt){be(ct(Re),function(vr){Vt.removeEventListener(vr,Dt,!1)})}function Ne(Vt,Re){for(;Vt;){if(Vt==Re)return!0;Vt=Vt.parentNode}return!1}function Ve(Vt,Re){return Vt.indexOf(Re)>-1}function ct(Vt){return Vt.trim().split(/\s+/g)}function Me(Vt,Re,Dt){if(Vt.indexOf&&!Dt)return Vt.indexOf(Re);for(var vr=0;vr<Vt.length;){if(Dt&&Vt[vr][Dt]==Re||!Dt&&Vt[vr]===Re)return vr;vr++}return-1}function ht(Vt){return Array.prototype.slice.call(Vt,0)}function Wt(Vt,Re,Dt){for(var vr=[],en=[],Tn=0;Tn<Vt.length;){var Gn=Re?Vt[Tn][Re]:Vt[Tn];Me(en,Gn)<0&&vr.push(Vt[Tn]),en[Tn]=Gn,Tn++}return Dt&&(Re?vr=vr.sort(function(po,mo){return po[Re]>mo[Re]}):vr=vr.sort()),vr}function Qt(Vt,Re){for(var Dt,vr,en=Re[0].toUpperCase()+Re.slice(1),Tn=0;Tn<Z.length;){if(Dt=Z[Tn],vr=Dt?Dt+en:Re,vr in Vt)return vr;Tn++}return i}var ur=1;function oe(){return ur++}function $(Vt){var Re=Vt.ownerDocument||Vt;return Re.defaultView||Re.parentWindow||p}var H=/mobile|tablet|ip(ad|hone|od)|android/i,Ae="ontouchstart"in p,ye=Qt(p,"PointerEvent")!==i,Te=Ae&&H.test(navigator.userAgent),pe="touch",it="pen",qt="mouse",Pt="kinect",me=25,ve=1,Ge=2,st=4,Oe=8,gt=1,C=2,R=4,q=8,fe=16,He=C|R,et=q|fe,_t=He|et,ot=["x","y"],Ut=["clientX","clientY"];function K(Vt,Re){var Dt=this;this.manager=Vt,this.callback=Re,this.element=Vt.element,this.target=Vt.options.inputTarget,this.domHandler=function(vr){Je(Vt.options.enable,[Vt])&&Dt.handler(vr)},this.init()}K.prototype={handler:function(){},init:function(){this.evEl&&At(this.element,this.evEl,this.domHandler),this.evTarget&&At(this.target,this.evTarget,this.domHandler),this.evWin&&At($(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&Ie(this.element,this.evEl,this.domHandler),this.evTarget&&Ie(this.target,this.evTarget,this.domHandler),this.evWin&&Ie($(this.element),this.evWin,this.domHandler)}};function qe(Vt){var Re,Dt=Vt.options.inputClass;return Dt?Re=Dt:ye?Re=Cn:Te?Re=Ze:Ae?Re=Gr:Re=Vn,new Re(Vt,ae)}function ae(Vt,Re,Dt){var vr=Dt.pointers.length,en=Dt.changedPointers.length,Tn=Re&ve&&vr-en===0,Gn=Re&(st|Oe)&&vr-en===0;Dt.isFirst=!!Tn,Dt.isFinal=!!Gn,Tn&&(Vt.session={}),Dt.eventType=Re,tt(Vt,Dt),Vt.emit("hammer.input",Dt),Vt.recognize(Dt),Vt.session.prevInput=Dt}function tt(Vt,Re){var Dt=Vt.session,vr=Re.pointers,en=vr.length;Dt.firstInput||(Dt.firstInput=Ke(Re)),en>1&&!Dt.firstMultiple?Dt.firstMultiple=Ke(Re):en===1&&(Dt.firstMultiple=!1);var Tn=Dt.firstInput,Gn=Dt.firstMultiple,Mi=Gn?Gn.center:Tn.center,po=Re.center=xt(vr);Re.timeStamp=Y(),Re.deltaTime=Re.timeStamp-Tn.timeStamp,Re.angle=pt(Mi,po),Re.distance=Fe(Mi,po),kt(Dt,Re),Re.offsetDirection=Et(Re.deltaX,Re.deltaY);var mo=bt(Re.deltaTime,Re.deltaX,Re.deltaY);Re.overallVelocityX=mo.x,Re.overallVelocityY=mo.y,Re.overallVelocity=ce(mo.x)>ce(mo.y)?mo.x:mo.y,Re.scale=Gn?Ht(Gn.pointers,vr):1,Re.rotation=Gn?yt(Gn.pointers,vr):0,Re.maxPointers=Dt.prevInput?Re.pointers.length>Dt.prevInput.maxPointers?Re.pointers.length:Dt.prevInput.maxPointers:Re.pointers.length,pr(Dt,Re);var Mo=Vt.element;Ne(Re.srcEvent.target,Mo)&&(Mo=Re.srcEvent.target),Re.target=Mo}function kt(Vt,Re){var Dt=Re.center,vr=Vt.offsetDelta||{},en=Vt.prevDelta||{},Tn=Vt.prevInput||{};(Re.eventType===ve||Tn.eventType===st)&&(en=Vt.prevDelta={x:Tn.deltaX||0,y:Tn.deltaY||0},vr=Vt.offsetDelta={x:Dt.x,y:Dt.y}),Re.deltaX=en.x+(Dt.x-vr.x),Re.deltaY=en.y+(Dt.y-vr.y)}function pr(Vt,Re){var Dt=Vt.lastInterval||Re,vr=Re.timeStamp-Dt.timeStamp,en,Tn,Gn,Mi;if(Re.eventType!=Oe&&(vr>me||Dt.velocity===i)){var po=Re.deltaX-Dt.deltaX,mo=Re.deltaY-Dt.deltaY,Mo=bt(vr,po,mo);Tn=Mo.x,Gn=Mo.y,en=ce(Mo.x)>ce(Mo.y)?Mo.x:Mo.y,Mi=Et(po,mo),Vt.lastInterval=Re}else en=Dt.velocity,Tn=Dt.velocityX,Gn=Dt.velocityY,Mi=Dt.direction;Re.velocity=en,Re.velocityX=Tn,Re.velocityY=Gn,Re.direction=Mi}function Ke(Vt){for(var Re=[],Dt=0;Dt<Vt.pointers.length;)Re[Dt]={clientX:ee(Vt.pointers[Dt].clientX),clientY:ee(Vt.pointers[Dt].clientY)},Dt++;return{timeStamp:Y(),pointers:Re,center:xt(Re),deltaX:Vt.deltaX,deltaY:Vt.deltaY}}function xt(Vt){var Re=Vt.length;if(Re===1)return{x:ee(Vt[0].clientX),y:ee(Vt[0].clientY)};for(var Dt=0,vr=0,en=0;en<Re;)Dt+=Vt[en].clientX,vr+=Vt[en].clientY,en++;return{x:ee(Dt/Re),y:ee(vr/Re)}}function bt(Vt,Re,Dt){return{x:Re/Vt||0,y:Dt/Vt||0}}function Et(Vt,Re){return Vt===Re?gt:ce(Vt)>=ce(Re)?Vt<0?C:R:Re<0?q:fe}function Fe(Vt,Re,Dt){Dt||(Dt=ot);var vr=Re[Dt[0]]-Vt[Dt[0]],en=Re[Dt[1]]-Vt[Dt[1]];return Math.sqrt(vr*vr+en*en)}function pt(Vt,Re,Dt){Dt||(Dt=ot);var vr=Re[Dt[0]]-Vt[Dt[0]],en=Re[Dt[1]]-Vt[Dt[1]];return Math.atan2(en,vr)*180/Math.PI}function yt(Vt,Re){return pt(Re[1],Re[0],Ut)+pt(Vt[1],Vt[0],Ut)}function Ht(Vt,Re){return Fe(Re[0],Re[1],Ut)/Fe(Vt[0],Vt[1],Ut)}var hr={mousedown:ve,mousemove:Ge,mouseup:st},Zr="mousedown",yr="mousemove mouseup";function Vn(){this.evEl=Zr,this.evWin=yr,this.pressed=!1,K.apply(this,arguments)}Ye(Vn,K,{handler:function(Re){var Dt=hr[Re.type];if(Dt&ve&&Re.button===0&&(this.pressed=!0),Dt&Ge&&Re.which!==1&&(Dt=st),!this.pressed)return;Dt&st&&(this.pressed=!1),this.callback(this.manager,Dt,{pointers:[Re],changedPointers:[Re],pointerType:qt,srcEvent:Re})}});var zn={pointerdown:ve,pointermove:Ge,pointerup:st,pointercancel:Oe,pointerout:Oe},oa={2:pe,3:it,4:qt,5:Pt},$n="pointerdown",Kn="pointermove pointerup pointercancel";p.MSPointerEvent&&!p.PointerEvent&&($n="MSPointerDown",Kn="MSPointerMove MSPointerUp MSPointerCancel");function Cn(){this.evEl=$n,this.evWin=Kn,K.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}Ye(Cn,K,{handler:function(Re){var Dt=this.store,vr=!1,en=Re.type.toLowerCase().replace("ms",""),Tn=zn[en],Gn=oa[Re.pointerType]||Re.pointerType,Mi=Gn==pe,po=Me(Dt,Re.pointerId,"pointerId");if(Tn&ve&&(Re.button===0||Mi)?po<0&&(Dt.push(Re),po=Dt.length-1):Tn&(st|Oe)&&(vr=!0),po<0)return;Dt[po]=Re,this.callback(this.manager,Tn,{pointers:Dt,changedPointers:[Re],pointerType:Gn,srcEvent:Re}),vr&&Dt.splice(po,1)}});var z={touchstart:ve,touchmove:Ge,touchend:st,touchcancel:Oe},W="touchstart",le="touchstart touchmove touchend touchcancel";function xe(){this.evTarget=W,this.evWin=le,this.started=!1,K.apply(this,arguments)}Ye(xe,K,{handler:function(Re){var Dt=z[Re.type];if(Dt===ve&&(this.started=!0),!this.started)return;var vr=ut.call(this,Re,Dt);Dt&(st|Oe)&&vr[0].length-vr[1].length===0&&(this.started=!1),this.callback(this.manager,Dt,{pointers:vr[0],changedPointers:vr[1],pointerType:pe,srcEvent:Re})}});function ut(Vt,Re){var Dt=ht(Vt.touches),vr=ht(Vt.changedTouches);return Re&(st|Oe)&&(Dt=Wt(Dt.concat(vr),"identifier",!0)),[Dt,vr]}var Ot={touchstart:ve,touchmove:Ge,touchend:st,touchcancel:Oe},Bt="touchstart touchmove touchend touchcancel";function Ze(){this.evTarget=Bt,this.targetIds={},K.apply(this,arguments)}Ye(Ze,K,{handler:function(Re){var Dt=Ot[Re.type],vr=Rt.call(this,Re,Dt);if(!vr)return;this.callback(this.manager,Dt,{pointers:vr[0],changedPointers:vr[1],pointerType:pe,srcEvent:Re})}});function Rt(Vt,Re){var Dt=ht(Vt.touches),vr=this.targetIds;if(Re&(ve|Ge)&&Dt.length===1)return vr[Dt[0].identifier]=!0,[Dt,Dt];var en,Tn,Gn=ht(Vt.changedTouches),Mi=[],po=this.target;if(Tn=Dt.filter(function(mo){return Ne(mo.target,po)}),Re===ve)for(en=0;en<Tn.length;)vr[Tn[en].identifier]=!0,en++;for(en=0;en<Gn.length;)vr[Gn[en].identifier]&&Mi.push(Gn[en]),Re&(st|Oe)&&delete vr[Gn[en].identifier],en++;return Mi.length?[Wt(Tn.concat(Mi),"identifier",!0),Mi]:void 0}var lr=2500,Ur=25;function Gr(){K.apply(this,arguments);var Vt=dt(this.handler,this);this.touch=new Ze(this.manager,Vt),this.mouse=new Vn(this.manager,Vt),this.primaryTouch=null,this.lastTouches=[]}Ye(Gr,K,{handler:function(Re,Dt,vr){var en=vr.pointerType==pe,Tn=vr.pointerType==qt;if(Tn&&vr.sourceCapabilities&&vr.sourceCapabilities.firesTouchEvents)return;if(en)cr.call(this,Dt,vr);else if(Tn&&wn.call(this,vr))return;this.callback(Re,Dt,vr)},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function cr(Vt,Re){Vt&ve?(this.primaryTouch=Re.changedPointers[0].identifier,Br.call(this,Re)):Vt&(st|Oe)&&Br.call(this,Re)}function Br(Vt){var Re=Vt.changedPointers[0];if(Re.identifier===this.primaryTouch){var Dt={x:Re.clientX,y:Re.clientY};this.lastTouches.push(Dt);var vr=this.lastTouches,en=function(){var Gn=vr.indexOf(Dt);Gn>-1&&vr.splice(Gn,1)};setTimeout(en,lr)}}function wn(Vt){for(var Re=Vt.srcEvent.clientX,Dt=Vt.srcEvent.clientY,vr=0;vr<this.lastTouches.length;vr++){var en=this.lastTouches[vr],Tn=Math.abs(Re-en.x),Gn=Math.abs(Dt-en.y);if(Tn<=Ur&&Gn<=Ur)return!0}return!1}var fn=Qt(D.style,"touchAction"),tr=fn!==i,rn="compute",dn="auto",En="manipulation",bn="none",gn="pan-x",Mn="pan-y",Ga=Ia();function ga(Vt,Re){this.manager=Vt,this.set(Re)}ga.prototype={set:function(Re){Re==rn&&(Re=this.compute()),tr&&this.manager.element.style&&Ga[Re]&&(this.manager.element.style[fn]=Re),this.actions=Re.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var Re=[];return be(this.manager.recognizers,function(Dt){Je(Dt.options.enable,[Dt])&&(Re=Re.concat(Dt.getTouchAction()))}),Ma(Re.join(" "))},preventDefaults:function(Re){var Dt=Re.srcEvent,vr=Re.offsetDirection;if(this.manager.session.prevented){Dt.preventDefault();return}var en=this.actions,Tn=Ve(en,bn)&&!Ga[bn],Gn=Ve(en,Mn)&&!Ga[Mn],Mi=Ve(en,gn)&&!Ga[gn];if(Tn){var po=Re.pointers.length===1,mo=Re.distance<2,Mo=Re.deltaTime<250;if(po&&mo&&Mo)return}if(Mi&&Gn)return;if(Tn||Gn&&vr&He||Mi&&vr&et)return this.preventSrc(Dt)},preventSrc:function(Re){this.manager.session.prevented=!0,Re.preventDefault()}};function Ma(Vt){if(Ve(Vt,bn))return bn;var Re=Ve(Vt,gn),Dt=Ve(Vt,Mn);return Re&&Dt?bn:Re||Dt?Re?gn:Mn:Ve(Vt,En)?En:dn}function Ia(){if(!tr)return!1;var Vt={},Re=p.CSS&&p.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(Dt){Vt[Dt]=Re?p.CSS.supports("touch-action",Dt):!0}),Vt}var Wi=1,da=2,vi=4,ya=8,ba=ya,ha=16,wi=32;function is(Vt){this.options=mt({},this.defaults,Vt||{}),this.id=oe(),this.manager=null,this.options.enable=wt(this.options.enable,!0),this.state=Wi,this.simultaneous={},this.requireFail=[]}is.prototype={defaults:{},set:function(Re){return mt(this.options,Re),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(Re){if(Xe(Re,"recognizeWith",this))return this;var Dt=this.simultaneous;return Re=Du(Re,this),Dt[Re.id]||(Dt[Re.id]=Re,Re.recognizeWith(this)),this},dropRecognizeWith:function(Re){return Xe(Re,"dropRecognizeWith",this)?this:(Re=Du(Re,this),delete this.simultaneous[Re.id],this)},requireFailure:function(Re){if(Xe(Re,"requireFailure",this))return this;var Dt=this.requireFail;return Re=Du(Re,this),Me(Dt,Re)===-1&&(Dt.push(Re),Re.requireFailure(this)),this},dropRequireFailure:function(Re){if(Xe(Re,"dropRequireFailure",this))return this;Re=Du(Re,this);var Dt=Me(this.requireFail,Re);return Dt>-1&&this.requireFail.splice(Dt,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(Re){return!!this.simultaneous[Re.id]},emit:function(Re){var Dt=this,vr=this.state;function en(Tn){Dt.manager.emit(Tn,Re)}vr<ya&&en(Dt.options.event+Xi(vr)),en(Dt.options.event),Re.additionalEvent&&en(Re.additionalEvent),vr>=ya&&en(Dt.options.event+Xi(vr))},tryEmit:function(Re){if(this.canEmit())return this.emit(Re);this.state=wi},canEmit:function(){for(var Re=0;Re<this.requireFail.length;){if(!(this.requireFail[Re].state&(wi|Wi)))return!1;Re++}return!0},recognize:function(Re){var Dt=mt({},Re);if(!Je(this.options.enable,[this,Dt])){this.reset(),this.state=wi;return}this.state&(ba|ha|wi)&&(this.state=Wi),this.state=this.process(Dt),this.state&(da|vi|ya|ha)&&this.tryEmit(Dt)},process:function(Re){},getTouchAction:function(){},reset:function(){}};function Xi(Vt){return Vt&ha?"cancel":Vt&ya?"end":Vt&vi?"move":Vt&da?"start":""}function Xo(Vt){return Vt==fe?"down":Vt==q?"up":Vt==C?"left":Vt==R?"right":""}function Du(Vt,Re){var Dt=Re.manager;return Dt?Dt.get(Vt):Vt}function Ha(){is.apply(this,arguments)}Ye(Ha,is,{defaults:{pointers:1},attrTest:function(Re){var Dt=this.options.pointers;return Dt===0||Re.pointers.length===Dt},process:function(Re){var Dt=this.state,vr=Re.eventType,en=Dt&(da|vi),Tn=this.attrTest(Re);return en&&(vr&Oe||!Tn)?Dt|ha:en||Tn?vr&st?Dt|ya:Dt&da?Dt|vi:da:wi}});function Oi(){Ha.apply(this,arguments),this.pX=null,this.pY=null}Ye(Oi,Ha,{defaults:{event:"pan",threshold:10,pointers:1,direction:_t},getTouchAction:function(){var Re=this.options.direction,Dt=[];return Re&He&&Dt.push(Mn),Re&et&&Dt.push(gn),Dt},directionTest:function(Re){var Dt=this.options,vr=!0,en=Re.distance,Tn=Re.direction,Gn=Re.deltaX,Mi=Re.deltaY;return Tn&Dt.direction||(Dt.direction&He?(Tn=Gn===0?gt:Gn<0?C:R,vr=Gn!=this.pX,en=Math.abs(Re.deltaX)):(Tn=Mi===0?gt:Mi<0?q:fe,vr=Mi!=this.pY,en=Math.abs(Re.deltaY))),Re.direction=Tn,vr&&en>Dt.threshold&&Tn&Dt.direction},attrTest:function(Re){return Ha.prototype.attrTest.call(this,Re)&&(this.state&da||!(this.state&da)&&this.directionTest(Re))},emit:function(Re){this.pX=Re.deltaX,this.pY=Re.deltaY;var Dt=Xo(Re.direction);Dt&&(Re.additionalEvent=this.options.event+Dt),this._super.emit.call(this,Re)}});function Jo(){Ha.apply(this,arguments)}Ye(Jo,Ha,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[bn]},attrTest:function(Re){return this._super.attrTest.call(this,Re)&&(Math.abs(Re.scale-1)>this.options.threshold||this.state&da)},emit:function(Re){if(Re.scale!==1){var Dt=Re.scale<1?"in":"out";Re.additionalEvent=this.options.event+Dt}this._super.emit.call(this,Re)}});function ui(){is.apply(this,arguments),this._timer=null,this._input=null}Ye(ui,is,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[dn]},process:function(Re){var Dt=this.options,vr=Re.pointers.length===Dt.pointers,en=Re.distance<Dt.threshold,Tn=Re.deltaTime>Dt.time;if(this._input=Re,!en||!vr||Re.eventType&(st|Oe)&&!Tn)this.reset();else if(Re.eventType&ve)this.reset(),this._timer=ze(function(){this.state=ba,this.tryEmit()},Dt.time,this);else if(Re.eventType&st)return ba;return wi},reset:function(){clearTimeout(this._timer)},emit:function(Re){if(this.state!==ba)return;Re&&Re.eventType&st?this.manager.emit(this.options.event+"up",Re):(this._input.timeStamp=Y(),this.manager.emit(this.options.event,this._input))}});function Yi(){Ha.apply(this,arguments)}Ye(Yi,Ha,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[bn]},attrTest:function(Re){return this._super.attrTest.call(this,Re)&&(Math.abs(Re.rotation)>this.options.threshold||this.state&da)}});function Oo(){Ha.apply(this,arguments)}Ye(Oo,Ha,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:He|et,pointers:1},getTouchAction:function(){return Oi.prototype.getTouchAction.call(this)},attrTest:function(Re){var Dt=this.options.direction,vr;return Dt&(He|et)?vr=Re.overallVelocity:Dt&He?vr=Re.overallVelocityX:Dt&et&&(vr=Re.overallVelocityY),this._super.attrTest.call(this,Re)&&Dt&Re.offsetDirection&&Re.distance>this.options.threshold&&Re.maxPointers==this.options.pointers&&ce(vr)>this.options.velocity&&Re.eventType&st},emit:function(Re){var Dt=Xo(Re.offsetDirection);Dt&&this.manager.emit(this.options.event+Dt,Re),this.manager.emit(this.options.event,Re)}});function Za(){is.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}Ye(Za,is,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[En]},process:function(Re){var Dt=this.options,vr=Re.pointers.length===Dt.pointers,en=Re.distance<Dt.threshold,Tn=Re.deltaTime<Dt.time;if(this.reset(),Re.eventType&ve&&this.count===0)return this.failTimeout();if(en&&Tn&&vr){if(Re.eventType!=st)return this.failTimeout();var Gn=this.pTime?Re.timeStamp-this.pTime<Dt.interval:!0,Mi=!this.pCenter||Fe(this.pCenter,Re.center)<Dt.posThreshold;this.pTime=Re.timeStamp,this.pCenter=Re.center,!Mi||!Gn?this.count=1:this.count+=1,this._input=Re;var po=this.count%Dt.taps;if(po===0)return this.hasRequireFailures()?(this._timer=ze(function(){this.state=ba,this.tryEmit()},Dt.interval,this),da):ba}return wi},failTimeout:function(){return this._timer=ze(function(){this.state=wi},this.options.interval,this),wi},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==ba&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function oo(Vt,Re){return Re=Re||{},Re.recognizers=wt(Re.recognizers,oo.defaults.preset),new Qo(Vt,Re)}oo.VERSION="2.0.7",oo.defaults={domEvents:!1,touchAction:rn,enable:!0,inputTarget:null,inputClass:null,preset:[[Yi,{enable:!1}],[Jo,{enable:!1},["rotate"]],[Oo,{direction:He}],[Oi,{direction:He},["swipe"]],[Za],[Za,{event:"doubletap",taps:2},["tap"]],[ui]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var so=1,bu=2;function Qo(Vt,Re){this.options=mt({},oo.defaults,Re||{}),this.options.inputTarget=this.options.inputTarget||Vt,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=Vt,this.input=qe(this),this.touchAction=new ga(this,this.options.touchAction),Xl(this,!0),be(this.options.recognizers,function(Dt){var vr=this.add(new Dt[0](Dt[1]));Dt[2]&&vr.recognizeWith(Dt[2]),Dt[3]&&vr.requireFailure(Dt[3])},this)}Qo.prototype={set:function(Re){return mt(this.options,Re),Re.touchAction&&this.touchAction.update(),Re.inputTarget&&(this.input.destroy(),this.input.target=Re.inputTarget,this.input.init()),this},stop:function(Re){this.session.stopped=Re?bu:so},recognize:function(Re){var Dt=this.session;if(Dt.stopped)return;this.touchAction.preventDefaults(Re);var vr,en=this.recognizers,Tn=Dt.curRecognizer;(!Tn||Tn&&Tn.state&ba)&&(Tn=Dt.curRecognizer=null);for(var Gn=0;Gn<en.length;)vr=en[Gn],Dt.stopped!==bu&&(!Tn||vr==Tn||vr.canRecognizeWith(Tn))?vr.recognize(Re):vr.reset(),!Tn&&vr.state&(da|vi|ya)&&(Tn=Dt.curRecognizer=vr),Gn++},get:function(Re){if(Re instanceof is)return Re;for(var Dt=this.recognizers,vr=0;vr<Dt.length;vr++)if(Dt[vr].options.event==Re)return Dt[vr];return null},add:function(Re){if(Xe(Re,"add",this))return this;var Dt=this.get(Re.options.event);return Dt&&this.remove(Dt),this.recognizers.push(Re),Re.manager=this,this.touchAction.update(),Re},remove:function(Re){if(Xe(Re,"remove",this))return this;if(Re=this.get(Re),Re){var Dt=this.recognizers,vr=Me(Dt,Re);vr!==-1&&(Dt.splice(vr,1),this.touchAction.update())}return this},on:function(Re,Dt){if(Re===i)return;if(Dt===i)return;var vr=this.handlers;return be(ct(Re),function(en){vr[en]=vr[en]||[],vr[en].push(Dt)}),this},off:function(Re,Dt){if(Re===i)return;var vr=this.handlers;return be(ct(Re),function(en){Dt?vr[en]&&vr[en].splice(Me(vr[en],Dt),1):delete vr[en]}),this},emit:function(Re,Dt){this.options.domEvents&&js(Re,Dt);var vr=this.handlers[Re]&&this.handlers[Re].slice();if(!vr||!vr.length)return;Dt.type=Re,Dt.preventDefault=function(){Dt.srcEvent.preventDefault()};for(var en=0;en<vr.length;)vr[en](Dt),en++},destroy:function(){this.element&&Xl(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function Xl(Vt,Re){var Dt=Vt.element;if(!Dt.style)return;var vr;be(Vt.options.cssProps,function(en,Tn){vr=Qt(Dt.style,Tn),Re?(Vt.oldCssProps[vr]=Dt.style[vr],Dt.style[vr]=en):Dt.style[vr]=Vt.oldCssProps[vr]||""}),Re||(Vt.oldCssProps={})}function js(Vt,Re){var Dt=X.createEvent("Event");Dt.initEvent(Vt,!0,!0),Dt.gesture=Re,Re.target.dispatchEvent(Dt)}mt(oo,{INPUT_START:ve,INPUT_MOVE:Ge,INPUT_END:st,INPUT_CANCEL:Oe,STATE_POSSIBLE:Wi,STATE_BEGAN:da,STATE_CHANGED:vi,STATE_ENDED:ya,STATE_RECOGNIZED:ba,STATE_CANCELLED:ha,STATE_FAILED:wi,DIRECTION_NONE:gt,DIRECTION_LEFT:C,DIRECTION_RIGHT:R,DIRECTION_UP:q,DIRECTION_DOWN:fe,DIRECTION_HORIZONTAL:He,DIRECTION_VERTICAL:et,DIRECTION_ALL:_t,Manager:Qo,Input:K,TouchAction:ga,TouchInput:Ze,MouseInput:Vn,PointerEventInput:Cn,TouchMouseInput:Gr,SingleTouchInput:xe,Recognizer:is,AttrRecognizer:Ha,Tap:Za,Pan:Oi,Swipe:Oo,Pinch:Jo,Rotate:Yi,Press:ui,on:At,off:Ie,each:be,merge:St,extend:Le,assign:mt,inherit:Ye,bindFn:dt,prefixed:Qt});var ho=typeof p!="undefined"?p:typeof self!="undefined"?self:{};ho.Hammer=oo,!(E=function(){return oo}.call(g,o,g,Ue),E!==i&&(Ue.exports=E))})(window,document,"Hammer")},yMAV:function(Ue,g,o){"use strict";Object.defineProperty(g,"__esModule",{value:!0}),g.Plan=void 0;var E=function(){function p(X,F){this.parentContext=X,this.rootRequest=F}return p}();g.Plan=E},yP5f:function(Ue,g,o){var E=o("+K+b");function p(X,F){var i=F?E(X.buffer):X.buffer;return new X.constructor(i,X.byteOffset,X.length)}Ue.exports=p},yU0y:function(Ue,g,o){"use strict";o.d(g,"b",function(){return E}),o.d(g,"a",function(){return p}),o.d(g,"c",function(){return X});var E=1e-6,p=typeof Float32Array!="undefined"?Float32Array:Array,X=Math.random;function F(J){p=J}var i=Math.PI/180;function Z(J){return J*i}function D(J,ee){return Math.abs(J-ee)<=E*Math.max(1,Math.abs(J),Math.abs(ee))}Math.hypot||(Math.hypot=function(){for(var J=0,ee=arguments.length;ee--;)J+=arguments[ee]*arguments[ee];return Math.sqrt(J)})},yXPU:function(Ue,g){function o(p,X,F,i,Z,D,J){try{var ee=p[D](J),ce=ee.value}catch(Y){F(Y);return}ee.done?X(ce):Promise.resolve(ce).then(i,Z)}function E(p){return function(){var X=this,F=arguments;return new Promise(function(i,Z){var D=p.apply(X,F);function J(ce){o(D,i,Z,J,ee,"next",ce)}function ee(ce){o(D,i,Z,J,ee,"throw",ce)}J(void 0)})}}Ue.exports=E},ycre:function(Ue,g,o){var E=o("711d"),p=E("length");Ue.exports=p},z4Hk:function(Ue,g,o){"use strict";Object.defineProperty(g,"__esModule",{value:!0}),g.BindingWhenSyntax=void 0;var E=o("406g"),p=o("RR/i"),X=function(){function F(i){this._binding=i}return F.prototype.when=function(i){return this._binding.constraint=i,new E.BindingOnSyntax(this._binding)},F.prototype.whenTargetNamed=function(i){return this._binding.constraint=p.namedConstraint(i),new E.BindingOnSyntax(this._binding)},F.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(i){var Z=i.target!==null&&!i.target.isNamed()&&!i.target.isTagged();return Z},new E.BindingOnSyntax(this._binding)},F.prototype.whenTargetTagged=function(i,Z){return this._binding.constraint=p.taggedConstraint(i)(Z),new E.BindingOnSyntax(this._binding)},F.prototype.whenInjectedInto=function(i){return this._binding.constraint=function(Z){return p.typeConstraint(i)(Z.parentRequest)},new E.BindingOnSyntax(this._binding)},F.prototype.whenParentNamed=function(i){return this._binding.constraint=function(Z){return p.namedConstraint(i)(Z.parentRequest)},new E.BindingOnSyntax(this._binding)},F.prototype.whenParentTagged=function(i,Z){return this._binding.constraint=function(D){return p.taggedConstraint(i)(Z)(D.parentRequest)},new E.BindingOnSyntax(this._binding)},F.prototype.whenAnyAncestorIs=function(i){return this._binding.constraint=function(Z){return p.traverseAncerstors(Z,p.typeConstraint(i))},new E.BindingOnSyntax(this._binding)},F.prototype.whenNoAncestorIs=function(i){return this._binding.constraint=function(Z){return!p.traverseAncerstors(Z,p.typeConstraint(i))},new E.BindingOnSyntax(this._binding)},F.prototype.whenAnyAncestorNamed=function(i){return this._binding.constraint=function(Z){return p.traverseAncerstors(Z,p.namedConstraint(i))},new E.BindingOnSyntax(this._binding)},F.prototype.whenNoAncestorNamed=function(i){return this._binding.constraint=function(Z){return!p.traverseAncerstors(Z,p.namedConstraint(i))},new E.BindingOnSyntax(this._binding)},F.prototype.whenAnyAncestorTagged=function(i,Z){return this._binding.constraint=function(D){return p.traverseAncerstors(D,p.taggedConstraint(i)(Z))},new E.BindingOnSyntax(this._binding)},F.prototype.whenNoAncestorTagged=function(i,Z){return this._binding.constraint=function(D){return!p.traverseAncerstors(D,p.taggedConstraint(i)(Z))},new E.BindingOnSyntax(this._binding)},F.prototype.whenAnyAncestorMatches=function(i){return this._binding.constraint=function(Z){return p.traverseAncerstors(Z,i)},new E.BindingOnSyntax(this._binding)},F.prototype.whenNoAncestorMatches=function(i){return this._binding.constraint=function(Z){return!p.traverseAncerstors(Z,i)},new E.BindingOnSyntax(this._binding)},F}();g.BindingWhenSyntax=X},zEVN:function(Ue,g,o){var E=o("Gi0A"),p=o("sEf8"),X=o("mdPL"),F=X&&X.isMap,i=F?p(F):E;Ue.exports=i},zZ0H:function(Ue,g){function o(E){return E}Ue.exports=o},zZPE:function(Ue,g){var o="[object Object]";function E(ze){var Xe=!1;if(ze!=null&&typeof ze.toString!="function")try{Xe=!!(ze+"")}catch(be){}return Xe}function p(ze,Xe){return function(be){return ze(Xe(be))}}var X=Function.prototype,F=Object.prototype,i=X.toString,Z=F.hasOwnProperty,D=i.call(Object),J=F.toString,ee=p(Object.getPrototypeOf,Object);function ce(ze){return!!ze&&typeof ze=="object"}function Y(ze){if(!ce(ze)||J.call(ze)!=o||E(ze))return!1;var Xe=ee(ze);if(Xe===null)return!0;var be=Z.call(Xe,"constructor")&&Xe.constructor;return typeof be=="function"&&be instanceof be&&i.call(be)==D}Ue.exports=Y},zoYe:function(Ue,g,o){var E=o("nmnc"),p=o("eUgh"),X=o("Z0cm"),F=o("/9aa"),i=1/0,Z=E?E.prototype:void 0,D=Z?Z.toString:void 0;function J(ee){if(typeof ee=="string")return ee;if(X(ee))return p(ee,J)+"";if(F(ee))return D?D.call(ee):"";var ce=ee+"";return ce=="0"&&1/ee==-i?"-0":ce}Ue.exports=J},zvhG:function(Ue,g){Ue.exports=o;function o(E,p,X,F){this.cx=3*E,this.bx=3*(X-E)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*p,this.by=3*(F-p)-this.cy,this.ay=1-this.cy-this.by,this.p1x=E,this.p1y=F,this.p2x=X,this.p2y=F}o.prototype.sampleCurveX=function(E){return((this.ax*E+this.bx)*E+this.cx)*E},o.prototype.sampleCurveY=function(E){return((this.ay*E+this.by)*E+this.cy)*E},o.prototype.sampleCurveDerivativeX=function(E){return(3*this.ax*E+2*this.bx)*E+this.cx},o.prototype.solveCurveX=function(E,p){typeof p=="undefined"&&(p=1e-6);var X,F,i,Z,D;for(i=E,D=0;D<8;D++){if(Z=this.sampleCurveX(i)-E,Math.abs(Z)<p)return i;var J=this.sampleCurveDerivativeX(i);if(Math.abs(J)<1e-6)break;i=i-Z/J}if(X=0,F=1,i=E,i<X)return X;if(i>F)return F;for(;X<F;){if(Z=this.sampleCurveX(i),Math.abs(Z-E)<p)return i;E>Z?X=i:F=i,i=(F-X)*.5+X}return i},o.prototype.solve=function(E,p){return this.sampleCurveY(this.solveCurveX(E,p))}},zxMA:function(Ue,g,o){"use strict";Object.defineProperty(g,"__esModule",{value:!0}),g.QueryableString=void 0;var E=function(){function p(X){this.str=X}return p.prototype.startsWith=function(X){return this.str.indexOf(X)===0},p.prototype.endsWith=function(X){var F="",i=X.split("").reverse().join("");return F=this.str.split("").reverse().join(""),this.startsWith.call({str:F},i)},p.prototype.contains=function(X){return this.str.indexOf(X)!==-1},p.prototype.equals=function(X){return this.str===X},p.prototype.value=function(){return this.str},p}();g.QueryableString=E}}]);
